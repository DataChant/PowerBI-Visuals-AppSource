/*! For license information please see visual.js.LICENSE.txt */
var floorPlanVisualizationA490C0576F6341F78AFFF9E2E83E7396;(()=>{var t={869:(t,e,n)=>{"use strict";n.d(e,{Et:()=>dp});var i=n(907),r=Object.defineProperty,o=Object.defineProperties,s=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,u=Object.prototype.propertyIsEnumerable,h=(t,e,n)=>e in t?r(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,c=(t,e)=>{for(var n in e||(e={}))l.call(e,n)&&h(t,n,e[n]);if(a)for(var n of a(e))u.call(e,n)&&h(t,n,e[n]);return t},p=(t,e)=>o(t,s(e));const d=3.28084,f=(t,e=1/64)=>{const n=1/e;return Math.round(t*n)/n};function m(t){return Math.sign(t)*Math.floor(Math.abs(t))}const y=" ";function g(t,e=.5,n=1/64){return!(t%e)||e<=n?[t/e,1/e]:g(t,e/2)}const v=(t=0,e="metric",n=3)=>{if("imperial"===e){const{feet:e,inches:n,fraction:i,isNegative:r}=function(t){const e=t*d,n=Math.abs(e),i=f(n%1*12);return{feet:m(n),inches:m(i),fraction:f(i%1),isNegative:Math.sign(t)<0}}(t);let o="";if(i>0){const[t,e]=g(f(i));o=`${y}${t}/${e}`}return`${r?"-":""}${e}′${y}${n}${o}″`}const i=Math.pow(10,n);return`${Math.round(t*i)/i}${y}m`},_=(t=0,e="metric",n=0,i=!0)=>{let r="",o="";const s=Math.pow(10,n);if("imperial"===e){const e=function(t){return t*d*d}(t);r=""+Math.round(e*s)/s,o=`${y}ft²`}else r=""+Math.round(t*s)/s,o=`${y}m²`;return i&&(r+=o),r};function x(t){const e=function(t){return"#"===t.slice(0,1)&&(t=t.slice(1)),t}(t);return 3===e.length?`#${e.split("").map((t=>t+t)).join("")}`:t}function b(t){return t>=0&&t<=255}function w(t){return JSON.parse(JSON.stringify(t))}function P(...t){let e={};for(const n of t)if(n instanceof Array)e instanceof Array||(e=[]),e=[...e,...n];else if(n instanceof Object)for(const t of Object.entries(n)){const n=t[0];let i=t[1];i instanceof Object&&n in e&&(i=P(e[n],i)),e=p(c({},e),{[n]:i})}return e}function E(){return typeof window<"u"&&typeof navigator<"u"&&typeof document<"u"}!E()||!/iPad|iPhone|iPod/.test(navigator.platform)&&navigator.maxTouchPoints&&navigator.maxTouchPoints>2&&/MacIntel/.test(navigator.platform),E()&&navigator.maxTouchPoints&&navigator.maxTouchPoints>2&&/MacIntel/.test(navigator.platform),E()&&/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),!E()||window.self===window.top||window.location.ancestorOrigins&&window.location.ancestorOrigins[0]||document.referrer,E()&&/^((?!chrome|android).)*safari/i.test(navigator.userAgent),E()&&navigator.platform.toUpperCase().indexOf("MAC");var T=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},S={},C={},I={};Object.defineProperty(I,"__esModule",{value:!0}),I.default=function(){if(!A)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return A(O)};var A=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),O=new Uint8Array(16),N={};Object.defineProperty(N,"__esModule",{value:!0}),N.default=void 0;for(var L=[],M=0;M<256;++M)L[M]=(M+256).toString(16).substr(1);N.default=function(t,e){var n=e||0,i=L;return[i[t[n++]],i[t[n++]],i[t[n++]],i[t[n++]],"-",i[t[n++]],i[t[n++]],"-",i[t[n++]],i[t[n++]],"-",i[t[n++]],i[t[n++]],"-",i[t[n++]],i[t[n++]],i[t[n++]],i[t[n++]],i[t[n++]],i[t[n++]]].join("")},Object.defineProperty(C,"__esModule",{value:!0}),C.default=void 0;var R=D(I),k=D(N);function D(t){return t&&t.__esModule?t:{default:t}}var F,B,U=0,z=0;C.default=function(t,e,n){var i=e&&n||0,r=e||[],o=(t=t||{}).node||F,s=void 0!==t.clockseq?t.clockseq:B;if(null==o||null==s){var a=t.random||(t.rng||R.default)();null==o&&(o=F=[1|a[0],a[1],a[2],a[3],a[4],a[5]]),null==s&&(s=B=16383&(a[6]<<8|a[7]))}var l=void 0!==t.msecs?t.msecs:(new Date).getTime(),u=void 0!==t.nsecs?t.nsecs:z+1,h=l-U+(u-z)/1e4;if(h<0&&void 0===t.clockseq&&(s=s+1&16383),(h<0||l>U)&&void 0===t.nsecs&&(u=0),u>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");U=l,z=u,B=s;var c=(1e4*(268435455&(l+=122192928e5))+u)%4294967296;r[i++]=c>>>24&255,r[i++]=c>>>16&255,r[i++]=c>>>8&255,r[i++]=255&c;var p=l/4294967296*1e4&268435455;r[i++]=p>>>8&255,r[i++]=255&p,r[i++]=p>>>24&15|16,r[i++]=p>>>16&255,r[i++]=s>>>8|128,r[i++]=255&s;for(var d=0;d<6;++d)r[i+d]=o[d];return e||(0,k.default)(r)};var X={},Y={};Object.defineProperty(Y,"__esModule",{value:!0}),Y.default=function(t,e,n){var i=function(t,i,r,o){var s=r&&o||0;if("string"==typeof t&&(t=function(t){t=unescape(encodeURIComponent(t));for(var e=new Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(t)),"string"==typeof i&&(i=function(t){var e=[];return t.replace(/[a-fA-F0-9]{2}/g,(function(t){e.push(parseInt(t,16))})),e}(i)),!Array.isArray(t))throw TypeError("value must be an array of bytes");if(!Array.isArray(i)||16!==i.length)throw TypeError("namespace must be uuid string or an Array of 16 byte values");var a=n(i.concat(t));if(a[6]=15&a[6]|e,a[8]=63&a[8]|128,r)for(var l=0;l<16;++l)r[s+l]=a[l];return r||(0,H.default)(a)};try{i.name=t}catch{}return i.DNS=W,i.URL=j,i},Y.URL=Y.DNS=void 0;var G,H=(G=N)&&G.__esModule?G:{default:G};const W="6ba7b810-9dad-11d1-80b4-00c04fd430c8";Y.DNS=W;const j="6ba7b811-9dad-11d1-80b4-00c04fd430c8";Y.URL=j;var V={};function q(t,e){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}function $(t,e,n,i,r,o){return q(function(t,e){return t<<e|t>>>32-e}(q(q(e,t),q(i,o)),r),n)}function Z(t,e,n,i,r,o,s){return $(e&n|~e&i,t,e,r,o,s)}function K(t,e,n,i,r,o,s){return $(e&i|n&~i,t,e,r,o,s)}function Q(t,e,n,i,r,o,s){return $(e^n^i,t,e,r,o,s)}function J(t,e,n,i,r,o,s){return $(n^(e|~i),t,e,r,o,s)}Object.defineProperty(V,"__esModule",{value:!0}),V.default=void 0;V.default=function(t){if("string"==typeof t){var e=unescape(encodeURIComponent(t));t=new Array(e.length);for(var n=0;n<e.length;n++)t[n]=e.charCodeAt(n)}return function(t){var e,n,i,r=[],o=32*t.length,s="0123456789abcdef";for(e=0;e<o;e+=8)n=t[e>>5]>>>e%32&255,i=parseInt(s.charAt(n>>>4&15)+s.charAt(15&n),16),r.push(i);return r}(function(t,e){t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;var n,i,r,o,s,a=1732584193,l=-271733879,u=-1732584194,h=271733878;for(n=0;n<t.length;n+=16)i=a,r=l,o=u,s=h,a=Z(a,l,u,h,t[n],7,-680876936),h=Z(h,a,l,u,t[n+1],12,-389564586),u=Z(u,h,a,l,t[n+2],17,606105819),l=Z(l,u,h,a,t[n+3],22,-1044525330),a=Z(a,l,u,h,t[n+4],7,-176418897),h=Z(h,a,l,u,t[n+5],12,1200080426),u=Z(u,h,a,l,t[n+6],17,-1473231341),l=Z(l,u,h,a,t[n+7],22,-45705983),a=Z(a,l,u,h,t[n+8],7,1770035416),h=Z(h,a,l,u,t[n+9],12,-1958414417),u=Z(u,h,a,l,t[n+10],17,-42063),l=Z(l,u,h,a,t[n+11],22,-1990404162),a=Z(a,l,u,h,t[n+12],7,1804603682),h=Z(h,a,l,u,t[n+13],12,-40341101),u=Z(u,h,a,l,t[n+14],17,-1502002290),a=K(a,l=Z(l,u,h,a,t[n+15],22,1236535329),u,h,t[n+1],5,-165796510),h=K(h,a,l,u,t[n+6],9,-1069501632),u=K(u,h,a,l,t[n+11],14,643717713),l=K(l,u,h,a,t[n],20,-373897302),a=K(a,l,u,h,t[n+5],5,-701558691),h=K(h,a,l,u,t[n+10],9,38016083),u=K(u,h,a,l,t[n+15],14,-660478335),l=K(l,u,h,a,t[n+4],20,-405537848),a=K(a,l,u,h,t[n+9],5,568446438),h=K(h,a,l,u,t[n+14],9,-1019803690),u=K(u,h,a,l,t[n+3],14,-187363961),l=K(l,u,h,a,t[n+8],20,1163531501),a=K(a,l,u,h,t[n+13],5,-1444681467),h=K(h,a,l,u,t[n+2],9,-51403784),u=K(u,h,a,l,t[n+7],14,1735328473),a=Q(a,l=K(l,u,h,a,t[n+12],20,-1926607734),u,h,t[n+5],4,-378558),h=Q(h,a,l,u,t[n+8],11,-2022574463),u=Q(u,h,a,l,t[n+11],16,1839030562),l=Q(l,u,h,a,t[n+14],23,-35309556),a=Q(a,l,u,h,t[n+1],4,-1530992060),h=Q(h,a,l,u,t[n+4],11,1272893353),u=Q(u,h,a,l,t[n+7],16,-155497632),l=Q(l,u,h,a,t[n+10],23,-1094730640),a=Q(a,l,u,h,t[n+13],4,681279174),h=Q(h,a,l,u,t[n],11,-358537222),u=Q(u,h,a,l,t[n+3],16,-722521979),l=Q(l,u,h,a,t[n+6],23,76029189),a=Q(a,l,u,h,t[n+9],4,-640364487),h=Q(h,a,l,u,t[n+12],11,-421815835),u=Q(u,h,a,l,t[n+15],16,530742520),a=J(a,l=Q(l,u,h,a,t[n+2],23,-995338651),u,h,t[n],6,-198630844),h=J(h,a,l,u,t[n+7],10,1126891415),u=J(u,h,a,l,t[n+14],15,-1416354905),l=J(l,u,h,a,t[n+5],21,-57434055),a=J(a,l,u,h,t[n+12],6,1700485571),h=J(h,a,l,u,t[n+3],10,-1894986606),u=J(u,h,a,l,t[n+10],15,-1051523),l=J(l,u,h,a,t[n+1],21,-2054922799),a=J(a,l,u,h,t[n+8],6,1873313359),h=J(h,a,l,u,t[n+15],10,-30611744),u=J(u,h,a,l,t[n+6],15,-1560198380),l=J(l,u,h,a,t[n+13],21,1309151649),a=J(a,l,u,h,t[n+4],6,-145523070),h=J(h,a,l,u,t[n+11],10,-1120210379),u=J(u,h,a,l,t[n+2],15,718787259),l=J(l,u,h,a,t[n+9],21,-343485551),a=q(a,i),l=q(l,r),u=q(u,o),h=q(h,s);return[a,l,u,h]}(function(t){var e,n=[];for(n[(t.length>>2)-1]=void 0,e=0;e<n.length;e+=1)n[e]=0;var i=8*t.length;for(e=0;e<i;e+=8)n[e>>5]|=(255&t[e/8])<<e%32;return n}(t),8*t.length))},Object.defineProperty(X,"__esModule",{value:!0}),X.default=void 0;var tt=nt(Y),et=nt(V);function nt(t){return t&&t.__esModule?t:{default:t}}var it=(0,tt.default)("v3",48,et.default);X.default=it;var rt={};Object.defineProperty(rt,"__esModule",{value:!0}),rt.default=void 0;var ot=at(I),st=at(N);function at(t){return t&&t.__esModule?t:{default:t}}rt.default=function(t,e,n){var i=e&&n||0;"string"==typeof t&&(e="binary"===t?new Array(16):null,t=null);var r=(t=t||{}).random||(t.rng||ot.default)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,e)for(var o=0;o<16;++o)e[i+o]=r[o];return e||(0,st.default)(r)};var lt={},ut={};function ht(t,e,n,i){switch(t){case 0:return e&n^~e&i;case 1:case 3:return e^n^i;case 2:return e&n^e&i^n&i}}function ct(t,e){return t<<e|t>>>32-e}Object.defineProperty(ut,"__esModule",{value:!0}),ut.default=void 0;ut.default=function(t){var e=[1518500249,1859775393,2400959708,3395469782],n=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof t){var i=unescape(encodeURIComponent(t));t=new Array(i.length);for(var r=0;r<i.length;r++)t[r]=i.charCodeAt(r)}t.push(128);var o=t.length/4+2,s=Math.ceil(o/16),a=new Array(s);for(r=0;r<s;r++){a[r]=new Array(16);for(var l=0;l<16;l++)a[r][l]=t[64*r+4*l]<<24|t[64*r+4*l+1]<<16|t[64*r+4*l+2]<<8|t[64*r+4*l+3]}for(a[s-1][14]=8*(t.length-1)/Math.pow(2,32),a[s-1][14]=Math.floor(a[s-1][14]),a[s-1][15]=8*(t.length-1)&4294967295,r=0;r<s;r++){for(var u=new Array(80),h=0;h<16;h++)u[h]=a[r][h];for(h=16;h<80;h++)u[h]=ct(u[h-3]^u[h-8]^u[h-14]^u[h-16],1);var c=n[0],p=n[1],d=n[2],f=n[3],m=n[4];for(h=0;h<80;h++){var y=Math.floor(h/20),g=ct(c,5)+ht(y,p,d,f)+m+e[y]+u[h]>>>0;m=f,f=d,d=ct(p,30)>>>0,p=c,c=g}n[0]=n[0]+c>>>0,n[1]=n[1]+p>>>0,n[2]=n[2]+d>>>0,n[3]=n[3]+f>>>0,n[4]=n[4]+m>>>0}return[n[0]>>24&255,n[0]>>16&255,n[0]>>8&255,255&n[0],n[1]>>24&255,n[1]>>16&255,n[1]>>8&255,255&n[1],n[2]>>24&255,n[2]>>16&255,n[2]>>8&255,255&n[2],n[3]>>24&255,n[3]>>16&255,n[3]>>8&255,255&n[3],n[4]>>24&255,n[4]>>16&255,n[4]>>8&255,255&n[4]]},Object.defineProperty(lt,"__esModule",{value:!0}),lt.default=void 0;var pt=ft(Y),dt=ft(ut);function ft(t){return t&&t.__esModule?t:{default:t}}var mt=(0,pt.default)("v5",80,dt.default);lt.default=mt,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"v1",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(t,"v3",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(t,"v4",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"v5",{enumerable:!0,get:function(){return r.default}});var e=o(C),n=o(X),i=o(rt),r=o(lt);function o(t){return t&&t.__esModule?t:{default:t}}}(S);var yt=function(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}(S);yt.v1,yt.v3;const gt=yt.v4;var vt,_t,xt,bt,wt,Pt,Et,Tt,St,Ct,It,At,Ot,Nt,Lt,Mt,Rt,kt,Dt;yt.v5,function(t){t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2"}(vt||(vt={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS"}(_t||(_t={})),function(t){t[t.COLOR=16384]="COLOR",t[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL"}(xt||(xt={})),function(t){t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR"}(bt||(bt={})),function(t){t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(wt||(wt={})),function(t){t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.RG=33319]="RG",t[t.RED=6403]="RED",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(Pt||(Pt={})),function(t){t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(Et||(Et={})),function(t){t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.BYTE=5120]="BYTE",t[t.SHORT=5122]="SHORT",t[t.INT=5124]="INT",t[t.FLOAT=5126]="FLOAT",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.HALF_FLOAT=36193]="HALF_FLOAT"}(Tt||(Tt={})),function(t){t[t.FLOAT=0]="FLOAT",t[t.INT=1]="INT",t[t.UINT=2]="UINT"}(St||(St={})),function(t){t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR"}(Ct||(Ct={})),function(t){t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(It||(It={})),function(t){t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON",t[t.ON_MANUAL=3]="ON_MANUAL"}(At||(At={})),function(t){t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",t[t.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA"}(Ot||(Ot={})),function(t){t[t.NO=0]="NO",t[t.YES=1]="YES",t[t.AUTO=2]="AUTO",t[t.BLEND=0]="BLEND",t[t.CLEAR=1]="CLEAR",t[t.BLIT=2]="BLIT"}(Nt||(Nt={})),function(t){t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL"}(Lt||(Lt={})),function(t){t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp"}(Mt||(Mt={})),function(t){t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE"}(Rt||(Rt={})),function(t){t[t.NONE=0]="NONE",t[t.LOW=2]="LOW",t[t.MEDIUM=4]="MEDIUM",t[t.HIGH=8]="HIGH"}(kt||(kt={})),function(t){t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER"}(Dt||(Dt={}));var Ft,Bt,Ut,zt,Xt,Yt,Gt,Ht,Wt,jt,Vt,qt,$t,Zt,Kt,Qt,Jt,te,ee,ne=/iPhone/i,ie=/iPod/i,re=/iPad/i,oe=/\biOS-universal(?:.+)Mac\b/i,se=/\bAndroid(?:.+)Mobile\b/i,ae=/Android/i,le=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,ue=/Silk/i,he=/Windows Phone/i,ce=/\bWindows(?:.+)ARM\b/i,pe=/BlackBerry/i,de=/BB10/i,fe=/Opera Mini/i,me=/\b(CriOS|Chrome)(?:.+)Mobile/i,ye=/Mobile(?:.+)Firefox\b/i,ge=function(t){return typeof t<"u"&&"MacIntel"===t.platform&&"number"==typeof t.maxTouchPoints&&t.maxTouchPoints>1&&typeof MSStream>"u"},ve=function(t){var e={userAgent:"",platform:"",maxTouchPoints:0};!t&&typeof navigator<"u"?e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:"string"==typeof t?e.userAgent=t:t&&t.userAgent&&(e={userAgent:t.userAgent,platform:t.platform,maxTouchPoints:t.maxTouchPoints||0});var n=e.userAgent,i=n.split("[FBAN");typeof i[1]<"u"&&(n=i[0]),typeof(i=n.split("Twitter"))[1]<"u"&&(n=i[0]);var r=function(t){return function(e){return e.test(t)}}(n),o={apple:{phone:r(ne)&&!r(he),ipod:r(ie),tablet:!r(ne)&&(r(re)||ge(e))&&!r(he),universal:r(oe),device:(r(ne)||r(ie)||r(re)||r(oe)||ge(e))&&!r(he)},amazon:{phone:r(le),tablet:!r(le)&&r(ue),device:r(le)||r(ue)},android:{phone:!r(he)&&r(le)||!r(he)&&r(se),tablet:!r(he)&&!r(le)&&!r(se)&&(r(ue)||r(ae)),device:!r(he)&&(r(le)||r(ue)||r(se)||r(ae))||r(/\bokhttp\b/i)},windows:{phone:r(he),tablet:r(ce),device:r(he)||r(ce)},other:{blackberry:r(pe),blackberry10:r(de),opera:r(fe),firefox:r(ye),chrome:r(me),device:r(pe)||r(de)||r(fe)||r(ye)||r(me)},any:!1,phone:!1,tablet:!1};return o.any=o.apple.device||o.android.device||o.windows.device||o.other.device,o.phone=o.apple.phone||o.android.phone||o.windows.phone,o.tablet=o.apple.tablet||o.android.tablet||o.windows.tablet,o}(self.navigator);!function(t){t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2"}(Ft||(Ft={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS"}(Bt||(Bt={})),function(t){t[t.COLOR=16384]="COLOR",t[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL"}(Ut||(Ut={})),function(t){t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR"}(zt||(zt={})),function(t){t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(Xt||(Xt={})),function(t){t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.RG=33319]="RG",t[t.RED=6403]="RED",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(Yt||(Yt={})),function(t){t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(Gt||(Gt={})),function(t){t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.BYTE=5120]="BYTE",t[t.SHORT=5122]="SHORT",t[t.INT=5124]="INT",t[t.FLOAT=5126]="FLOAT",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.HALF_FLOAT=36193]="HALF_FLOAT"}(Ht||(Ht={})),function(t){t[t.FLOAT=0]="FLOAT",t[t.INT=1]="INT",t[t.UINT=2]="UINT"}(Wt||(Wt={})),function(t){t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR"}(jt||(jt={})),function(t){t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(Vt||(Vt={})),function(t){t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON",t[t.ON_MANUAL=3]="ON_MANUAL"}(qt||(qt={})),function(t){t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",t[t.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA"}($t||($t={})),function(t){t[t.NO=0]="NO",t[t.YES=1]="YES",t[t.AUTO=2]="AUTO",t[t.BLEND=0]="BLEND",t[t.CLEAR=1]="CLEAR",t[t.BLIT=2]="BLIT"}(Zt||(Zt={})),function(t){t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL"}(Kt||(Kt={})),function(t){t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp"}(Qt||(Qt={})),function(t){t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE"}(Jt||(Jt={})),function(t){t[t.NONE=0]="NONE",t[t.LOW=2]="LOW",t[t.MEDIUM=4]="MEDIUM",t[t.HIGH=8]="HIGH"}(te||(te={})),function(t){t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER"}(ee||(ee={}));var _e,xe={MIPMAP_TEXTURES:qt.POW2,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,FILTER_MULTISAMPLE:te.NONE,SPRITE_MAX_TEXTURES:function(){var t,e=!0;(ve.tablet||ve.phone)&&(ve.apple.device&&(t=navigator.userAgent.match(/OS (\d+)_(\d+)?/))&&parseInt(t[1],10)<11&&(e=!1),ve.android.device&&(t=navigator.userAgent.match(/Android\s([0-9.]*)/))&&parseInt(t[1],10)<7&&(e=!1));return e?32:4}(),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,autoDensity:!1,backgroundColor:0,backgroundAlpha:1,useContextAlpha:!0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:Kt.AUTO,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:Vt.CLAMP,SCALE_MODE:jt.LINEAR,PRECISION_VERTEX:Qt.HIGH,PRECISION_FRAGMENT:ve.apple.device?Qt.HIGH:Qt.MEDIUM,CAN_UPLOAD_SAME_BUFFER:!ve.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1,TARGET_FPMS:.06};(function(t){t[t.INTERACTION=50]="INTERACTION",t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY"})(_e||(_e={}));var be=function(){function t(t,e,n,i){void 0===e&&(e=null),void 0===n&&(n=0),void 0===i&&(i=!1),this.next=null,this.previous=null,this._destroyed=!1,this.fn=t,this.context=e,this.priority=n,this.once=i}return t.prototype.match=function(t,e){return void 0===e&&(e=null),this.fn===t&&this.context===e},t.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e},t.prototype.connect=function(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this},t.prototype.destroy=function(t){void 0===t&&(t=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=t?null:e,this.previous=null,e},t}(),we=function(){function t(){var t=this;this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new be(null,null,1/0),this.deltaMS=1/xe.TARGET_FPMS,this.elapsedMS=1/xe.TARGET_FPMS,this._tick=function(e){t._requestId=null,t.started&&(t.update(e),t.started&&null===t._requestId&&t._head.next&&(t._requestId=requestAnimationFrame(t._tick)))}}return t.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},t.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},t.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},t.prototype.add=function(t,e,n){return void 0===n&&(n=_e.NORMAL),this._addListener(new be(t,e,n))},t.prototype.addOnce=function(t,e,n){return void 0===n&&(n=_e.NORMAL),this._addListener(new be(t,e,n,!0))},t.prototype._addListener=function(t){var e=this._head.next,n=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(n);break}n=e,e=e.next}t.previous||t.connect(n)}else t.connect(n);return this._startIfPossible(),this},t.prototype.remove=function(t,e){for(var n=this._head.next;n;)n=n.match(t,e)?n.destroy():n.next;return this._head.next||this._cancelIfNeeded(),this},Object.defineProperty(t.prototype,"count",{get:function(){if(!this._head)return 0;for(var t=0,e=this._head;e=e.next;)t++;return t},enumerable:!1,configurable:!0}),t.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},t.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},t.prototype.destroy=function(){if(!this._protected){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}},t.prototype.update=function(t){var e;if(void 0===t&&(t=performance.now()),t>this.lastTime){if((e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){var n=t-this._lastFrame|0;if(n<this._minElapsedMS)return;this._lastFrame=t-n%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*xe.TARGET_FPMS;for(var i=this._head,r=i.next;r;)r=r.emit(this.deltaTime);i.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t},Object.defineProperty(t.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(this.maxFPS,t),n=Math.min(Math.max(0,e)/1e3,xe.TARGET_FPMS);this._maxElapsedMS=1/n},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(t){if(0===t)this._minElapsedMS=0;else{var e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}},enumerable:!1,configurable:!0}),Object.defineProperty(t,"shared",{get:function(){if(!t._shared){var e=t._shared=new t;e.autoStart=!0,e._protected=!0}return t._shared},enumerable:!1,configurable:!0}),Object.defineProperty(t,"system",{get:function(){if(!t._system){var e=t._system=new t;e.autoStart=!0,e._protected=!0}return t._system},enumerable:!1,configurable:!0}),t}(),Pe={exports:{}};!function(t){var e=Object.prototype.hasOwnProperty,n="~";function i(){}function r(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function o(t,e,i,o,s){if("function"!=typeof i)throw new TypeError("The listener must be a function");var a=new r(i,o||t,s),l=n?n+e:e;return t._events[l]?t._events[l].fn?t._events[l]=[t._events[l],a]:t._events[l].push(a):(t._events[l]=a,t._eventsCount++),t}function s(t,e){0==--t._eventsCount?t._events=new i:delete t._events[e]}function a(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(n=!1)),a.prototype.eventNames=function(){var t,i,r=[];if(0===this._eventsCount)return r;for(i in t=this._events)e.call(t,i)&&r.push(n?i.slice(1):i);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(t)):r},a.prototype.listeners=function(t){var e=n?n+t:t,i=this._events[e];if(!i)return[];if(i.fn)return[i.fn];for(var r=0,o=i.length,s=new Array(o);r<o;r++)s[r]=i[r].fn;return s},a.prototype.listenerCount=function(t){var e=n?n+t:t,i=this._events[e];return i?i.fn?1:i.length:0},a.prototype.emit=function(t,e,i,r,o,s){var a=n?n+t:t;if(!this._events[a])return!1;var l,u,h=this._events[a],c=arguments.length;if(h.fn){switch(h.once&&this.removeListener(t,h.fn,void 0,!0),c){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,e),!0;case 3:return h.fn.call(h.context,e,i),!0;case 4:return h.fn.call(h.context,e,i,r),!0;case 5:return h.fn.call(h.context,e,i,r,o),!0;case 6:return h.fn.call(h.context,e,i,r,o,s),!0}for(u=1,l=new Array(c-1);u<c;u++)l[u-1]=arguments[u];h.fn.apply(h.context,l)}else{var p,d=h.length;for(u=0;u<d;u++)switch(h[u].once&&this.removeListener(t,h[u].fn,void 0,!0),c){case 1:h[u].fn.call(h[u].context);break;case 2:h[u].fn.call(h[u].context,e);break;case 3:h[u].fn.call(h[u].context,e,i);break;case 4:h[u].fn.call(h[u].context,e,i,r);break;default:if(!l)for(p=1,l=new Array(c-1);p<c;p++)l[p-1]=arguments[p];h[u].fn.apply(h[u].context,l)}}return!0},a.prototype.on=function(t,e,n){return o(this,t,e,n,!1)},a.prototype.once=function(t,e,n){return o(this,t,e,n,!0)},a.prototype.removeListener=function(t,e,i,r){var o=n?n+t:t;if(!this._events[o])return this;if(!e)return s(this,o),this;var a=this._events[o];if(a.fn)a.fn===e&&(!r||a.once)&&(!i||a.context===i)&&s(this,o);else{for(var l=0,u=[],h=a.length;l<h;l++)(a[l].fn!==e||r&&!a[l].once||i&&a[l].context!==i)&&u.push(a[l]);u.length?this._events[o]=1===u.length?u[0]:u:s(this,o)}return this},a.prototype.removeAllListeners=function(t){var e;return t?(e=n?n+t:t,this._events[e]&&s(this,e)):(this._events=new i,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,t.exports=a}(Pe);var Ee=Pe.exports,Te={exports:{}};function Se(t,e,n){n=n||2;var i,r,o,s,a,l,u,h=e&&e.length,c=h?e[0]*n:t.length,p=Ce(t,0,c,n,!0),d=[];if(!p||p.next===p.prev)return d;if(h&&(p=function(t,e,n,i){var r,o,s,a=[];for(r=0,o=e.length;r<o;r++)(s=Ce(t,e[r]*i,r<o-1?e[r+1]*i:t.length,i,!1))===s.next&&(s.steiner=!0),a.push(Be(s));for(a.sort(Re),r=0;r<a.length;r++)n=ke(a[r],n);return n}(t,e,p,n)),t.length>80*n){i=o=t[0],r=s=t[1];for(var f=n;f<c;f+=n)(a=t[f])<i&&(i=a),(l=t[f+1])<r&&(r=l),a>o&&(o=a),l>s&&(s=l);u=0!==(u=Math.max(o-i,s-r))?32767/u:0}return Ae(p,d,n,i,r,u,0),d}function Ce(t,e,n,i,r){var o,s;if(r===Ke(t,e,n,i)>0)for(o=e;o<n;o+=i)s=qe(o,t[o],t[o+1],s);else for(o=n-i;o>=e;o-=i)s=qe(o,t[o],t[o+1],s);return s&&Ye(s,s.next)&&($e(s),s=s.next),s}function Ie(t,e){if(!t)return t;e||(e=t);var n,i=t;do{if(n=!1,i.steiner||!Ye(i,i.next)&&0!==Xe(i.prev,i,i.next))i=i.next;else{if($e(i),(i=e=i.prev)===i.next)break;n=!0}}while(n||i!==e);return e}function Ae(t,e,n,i,r,o,s){if(t){!s&&o&&function(t,e,n,i){var r=t;do{0===r.z&&(r.z=Fe(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){var e,n,i,r,o,s,a,l,u=1;do{for(n=t,t=null,o=null,s=0;n;){for(s++,i=n,a=0,e=0;e<u&&(a++,i=i.nextZ);e++);for(l=u;a>0||l>0&&i;)0!==a&&(0===l||!i||n.z<=i.z)?(r=n,n=n.nextZ,a--):(r=i,i=i.nextZ,l--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;n=i}o.nextZ=null,u*=2}while(s>1)}(r)}(t,i,r,o);for(var a,l,u=t;t.prev!==t.next;)if(a=t.prev,l=t.next,o?Ne(t,i,r,o):Oe(t))e.push(a.i/n|0),e.push(t.i/n|0),e.push(l.i/n|0),$e(t),t=l.next,u=l.next;else if((t=l)===u){s?1===s?Ae(t=Le(Ie(t),e,n),e,n,i,r,o,2):2===s&&Me(t,e,n,i,r,o):Ae(Ie(t),e,n,i,r,o,1);break}}}function Oe(t){var e=t.prev,n=t,i=t.next;if(Xe(e,n,i)>=0)return!1;for(var r=e.x,o=n.x,s=i.x,a=e.y,l=n.y,u=i.y,h=r<o?r<s?r:s:o<s?o:s,c=a<l?a<u?a:u:l<u?l:u,p=r>o?r>s?r:s:o>s?o:s,d=a>l?a>u?a:u:l>u?l:u,f=i.next;f!==e;){if(f.x>=h&&f.x<=p&&f.y>=c&&f.y<=d&&Ue(r,a,o,l,s,u,f.x,f.y)&&Xe(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function Ne(t,e,n,i){var r=t.prev,o=t,s=t.next;if(Xe(r,o,s)>=0)return!1;for(var a=r.x,l=o.x,u=s.x,h=r.y,c=o.y,p=s.y,d=a<l?a<u?a:u:l<u?l:u,f=h<c?h<p?h:p:c<p?c:p,m=a>l?a>u?a:u:l>u?l:u,y=h>c?h>p?h:p:c>p?c:p,g=Fe(d,f,e,n,i),v=Fe(m,y,e,n,i),_=t.prevZ,x=t.nextZ;_&&_.z>=g&&x&&x.z<=v;){if(_.x>=d&&_.x<=m&&_.y>=f&&_.y<=y&&_!==r&&_!==s&&Ue(a,h,l,c,u,p,_.x,_.y)&&Xe(_.prev,_,_.next)>=0||(_=_.prevZ,x.x>=d&&x.x<=m&&x.y>=f&&x.y<=y&&x!==r&&x!==s&&Ue(a,h,l,c,u,p,x.x,x.y)&&Xe(x.prev,x,x.next)>=0))return!1;x=x.nextZ}for(;_&&_.z>=g;){if(_.x>=d&&_.x<=m&&_.y>=f&&_.y<=y&&_!==r&&_!==s&&Ue(a,h,l,c,u,p,_.x,_.y)&&Xe(_.prev,_,_.next)>=0)return!1;_=_.prevZ}for(;x&&x.z<=v;){if(x.x>=d&&x.x<=m&&x.y>=f&&x.y<=y&&x!==r&&x!==s&&Ue(a,h,l,c,u,p,x.x,x.y)&&Xe(x.prev,x,x.next)>=0)return!1;x=x.nextZ}return!0}function Le(t,e,n){var i=t;do{var r=i.prev,o=i.next.next;!Ye(r,o)&&Ge(r,i,i.next,o)&&je(r,o)&&je(o,r)&&(e.push(r.i/n|0),e.push(i.i/n|0),e.push(o.i/n|0),$e(i),$e(i.next),i=t=o),i=i.next}while(i!==t);return Ie(i)}function Me(t,e,n,i,r,o){var s=t;do{for(var a=s.next.next;a!==s.prev;){if(s.i!==a.i&&ze(s,a)){var l=Ve(s,a);return s=Ie(s,s.next),l=Ie(l,l.next),Ae(s,e,n,i,r,o,0),void Ae(l,e,n,i,r,o,0)}a=a.next}s=s.next}while(s!==t)}function Re(t,e){return t.x-e.x}function ke(t,e){var n=function(t,e){var n,i=e,r=t.x,o=t.y,s=-1/0;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){var a=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(a<=r&&a>s&&(s=a,n=i.x<i.next.x?i:i.next,a===r))return n}i=i.next}while(i!==e);if(!n)return null;var l,u=n,h=n.x,c=n.y,p=1/0;i=n;do{r>=i.x&&i.x>=h&&r!==i.x&&Ue(o<c?r:s,o,h,c,o<c?s:r,o,i.x,i.y)&&(l=Math.abs(o-i.y)/(r-i.x),je(i,t)&&(l<p||l===p&&(i.x>n.x||i.x===n.x&&De(n,i)))&&(n=i,p=l)),i=i.next}while(i!==u);return n}(t,e);if(!n)return e;var i=Ve(n,t);return Ie(i,i.next),Ie(n,n.next)}function De(t,e){return Xe(t.prev,t,e.prev)<0&&Xe(e.next,t,t.next)<0}function Fe(t,e,n,i,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*r|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-i)*r|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Be(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function Ue(t,e,n,i,r,o,s,a){return(r-s)*(e-a)>=(t-s)*(o-a)&&(t-s)*(i-a)>=(n-s)*(e-a)&&(n-s)*(o-a)>=(r-s)*(i-a)}function ze(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&Ge(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(je(t,e)&&je(e,t)&&function(t,e){var n=t,i=!1,r=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&r<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==t);return i}(t,e)&&(Xe(t.prev,t,e.prev)||Xe(t,e.prev,e))||Ye(t,e)&&Xe(t.prev,t,t.next)>0&&Xe(e.prev,e,e.next)>0)}function Xe(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function Ye(t,e){return t.x===e.x&&t.y===e.y}function Ge(t,e,n,i){var r=We(Xe(t,e,n)),o=We(Xe(t,e,i)),s=We(Xe(n,i,t)),a=We(Xe(n,i,e));return!!(r!==o&&s!==a||0===r&&He(t,n,e)||0===o&&He(t,i,e)||0===s&&He(n,t,i)||0===a&&He(n,e,i))}function He(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function We(t){return t>0?1:t<0?-1:0}function je(t,e){return Xe(t.prev,t,t.next)<0?Xe(t,e,t.next)>=0&&Xe(t,t.prev,e)>=0:Xe(t,e,t.prev)<0||Xe(t,t.next,e)<0}function Ve(t,e){var n=new Ze(t.i,t.x,t.y),i=new Ze(e.i,e.x,e.y),r=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,o.next=i,i.prev=o,i}function qe(t,e,n,i){var r=new Ze(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function $e(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Ze(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Ke(t,e,n,i){for(var r=0,o=e,s=n-i;o<n;o+=i)r+=(t[s]-t[o])*(t[o+1]+t[s+1]),s=o;return r}Te.exports=Se,Te.exports.default=Se,Se.deviation=function(t,e,n,i){var r=e&&e.length,o=r?e[0]*n:t.length,s=Math.abs(Ke(t,0,o,n));if(r)for(var a=0,l=e.length;a<l;a++){var u=e[a]*n,h=a<l-1?e[a+1]*n:t.length;s-=Math.abs(Ke(t,u,h,n))}var c=0;for(a=0;a<i.length;a+=3){var p=i[a]*n,d=i[a+1]*n,f=i[a+2]*n;c+=Math.abs((t[p]-t[f])*(t[d+1]-t[p+1])-(t[p]-t[d])*(t[f+1]-t[p+1]))}return 0===s&&0===c?0:Math.abs((c-s)/s)},Se.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,r=0;r<t.length;r++){for(var o=0;o<t[r].length;o++)for(var s=0;s<e;s++)n.vertices.push(t[r][o][s]);r>0&&(i+=t[r-1].length,n.holes.push(i))}return n};var Qe=2147483647,Je=/[^\x20-\x7E]/,tn=/[\x2E\u3002\uFF0E\uFF61]/g,en={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},nn=Math.floor,rn=String.fromCharCode;function on(t){throw new RangeError(en[t])}function sn(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function an(t,e,n){var i=0;for(t=n?nn(t/700):t>>1,t+=nn(t/e);t>455;i+=36)t=nn(t/35);return nn(i+36*t/(t+38))}function ln(t){return function(t){var e=t.split("@"),n="";e.length>1&&(n=e[0]+"@",t=e[1]);var i=function(t,e){for(var n=t.length,i=[];n--;)i[n]=e(t[n]);return i}((t=t.replace(tn,".")).split("."),(function(t){return Je.test(t)?"xn--"+function(t){var e,n,i,r,o,s,a,l,u,h,c,p,d,f,m,y=[];for(t=function(t){for(var e,n,i=[],r=0,o=t.length;r<o;)(e=t.charCodeAt(r++))>=55296&&e<=56319&&r<o?56320==(64512&(n=t.charCodeAt(r++)))?i.push(((1023&e)<<10)+(1023&n)+65536):(i.push(e),r--):i.push(e);return i}(t),p=t.length,e=128,n=0,o=72,s=0;s<p;++s)(c=t[s])<128&&y.push(rn(c));for(i=r=y.length,r&&y.push("-");i<p;){for(a=Qe,s=0;s<p;++s)(c=t[s])>=e&&c<a&&(a=c);for(a-e>nn((Qe-n)/(d=i+1))&&on("overflow"),n+=(a-e)*d,e=a,s=0;s<p;++s)if((c=t[s])<e&&++n>Qe&&on("overflow"),c==e){for(l=n,u=36;!(l<(h=u<=o?1:u>=o+26?26:u-o));u+=36)m=l-h,f=36-h,y.push(rn(sn(h+m%f,0))),l=nn(m/f);y.push(rn(sn(l,0))),o=an(n,d,i==r),n=0,++i}++n,++e}return y.join("")}(t):t})).join(".");return n+i}(t)}function un(t){return null===t}function hn(t){return"string"==typeof t}function cn(t){return"object"==typeof t&&null!==t}function pn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var dn=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function fn(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}}function mn(t,e){if(t.map)return t.map(e);for(var n=[],i=0;i<t.length;i++)n.push(e(t[i],i));return n}var yn=Object.keys||function(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(n);return e};function gn(t,e,n,i){e=e||"&",n=n||"=";var r={};if("string"!=typeof t||0===t.length)return r;var o=/\+/g;t=t.split(e);var s=1e3;i&&"number"==typeof i.maxKeys&&(s=i.maxKeys);var a=t.length;s>0&&a>s&&(a=s);for(var l=0;l<a;++l){var u,h,c,p,d=t[l].replace(o,"%20"),f=d.indexOf(n);f>=0?(u=d.substr(0,f),h=d.substr(f+1)):(u=d,h=""),c=decodeURIComponent(u),p=decodeURIComponent(h),pn(r,c)?dn(r[c])?r[c].push(p):r[c]=[r[c],p]:r[c]=p}return r}function vn(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var _n=/^([a-z0-9.+-]+:)/i,xn=/:[0-9]*$/,bn=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,wn=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),Pn=["'"].concat(wn),En=["%","/","?",";","#"].concat(Pn),Tn=["/","?","#"],Sn=/^[+a-z0-9A-Z_-]{0,63}$/,Cn=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,In={javascript:!0,"javascript:":!0},An={javascript:!0,"javascript:":!0},On={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function Nn(t,e,n){if(t&&cn(t)&&t instanceof vn)return t;var i=new vn;return i.parse(t,e,n),i}function Ln(t,e,n,i){if(!hn(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var r=e.indexOf("?"),o=-1!==r&&r<e.indexOf("#")?"?":"#",s=e.split(o);s[0]=s[0].replace(/\\/g,"/");var a=e=s.join(o);if(a=a.trim(),!i&&1===e.split("#").length){var l=bn.exec(a);if(l)return t.path=a,t.href=a,t.pathname=l[1],l[2]?(t.search=l[2],t.query=n?gn(t.search.substr(1)):t.search.substr(1)):n&&(t.search="",t.query={}),t}var u,h,c,p,d=_n.exec(a);if(d){var f=(d=d[0]).toLowerCase();t.protocol=f,a=a.substr(d.length)}if(i||d||a.match(/^\/\/[^@\/]+@[^@\/]+/)){var m="//"===a.substr(0,2);m&&(!d||!An[d])&&(a=a.substr(2),t.slashes=!0)}if(!An[d]&&(m||d&&!On[d])){var y,g,v=-1;for(u=0;u<Tn.length;u++)-1!==(h=a.indexOf(Tn[u]))&&(-1===v||h<v)&&(v=h);for(-1!==(g=-1===v?a.lastIndexOf("@"):a.lastIndexOf("@",v))&&(y=a.slice(0,g),a=a.slice(g+1),t.auth=decodeURIComponent(y)),v=-1,u=0;u<En.length;u++)-1!==(h=a.indexOf(En[u]))&&(-1===v||h<v)&&(v=h);-1===v&&(v=a.length),t.host=a.slice(0,v),a=a.slice(v),Rn(t),t.hostname=t.hostname||"";var _="["===t.hostname[0]&&"]"===t.hostname[t.hostname.length-1];if(!_){var x=t.hostname.split(/\./);for(u=0,c=x.length;u<c;u++){var b=x[u];if(b&&!b.match(Sn)){for(var w="",P=0,E=b.length;P<E;P++)b.charCodeAt(P)>127?w+="x":w+=b[P];if(!w.match(Sn)){var T=x.slice(0,u),S=x.slice(u+1),C=b.match(Cn);C&&(T.push(C[1]),S.unshift(C[2])),S.length&&(a="/"+S.join(".")+a),t.hostname=T.join(".");break}}}}t.hostname.length>255?t.hostname="":t.hostname=t.hostname.toLowerCase(),_||(t.hostname=ln(t.hostname)),p=t.port?":"+t.port:"";var I=t.hostname||"";t.host=I+p,t.href+=t.host,_&&(t.hostname=t.hostname.substr(1,t.hostname.length-2),"/"!==a[0]&&(a="/"+a))}if(!In[f])for(u=0,c=Pn.length;u<c;u++){var A=Pn[u];if(-1!==a.indexOf(A)){var O=encodeURIComponent(A);O===A&&(O=escape(A)),a=a.split(A).join(O)}}var N=a.indexOf("#");-1!==N&&(t.hash=a.substr(N),a=a.slice(0,N));var L=a.indexOf("?");if(-1!==L?(t.search=a.substr(L),t.query=a.substr(L+1),n&&(t.query=gn(t.query)),a=a.slice(0,L)):n&&(t.search="",t.query={}),a&&(t.pathname=a),On[f]&&t.hostname&&!t.pathname&&(t.pathname="/"),t.pathname||t.search){p=t.pathname||"";var M=t.search||"";t.path=p+M}return t.href=Mn(t),t}function Mn(t){var e=t.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var n=t.protocol||"",i=t.pathname||"",r=t.hash||"",o=!1,s="";t.host?o=e+t.host:t.hostname&&(o=e+(-1===t.hostname.indexOf(":")?t.hostname:"["+this.hostname+"]"),t.port&&(o+=":"+t.port)),t.query&&cn(t.query)&&Object.keys(t.query).length&&(s=function(t,e,n){return e=e||"&",n=n||"=",null===t&&(t=void 0),"object"==typeof t?mn(yn(t),(function(i){var r=encodeURIComponent(fn(i))+n;return dn(t[i])?mn(t[i],(function(t){return r+encodeURIComponent(fn(t))})).join(e):r+encodeURIComponent(fn(t[i]))})).join(e):""}(t.query));var a=t.search||s&&"?"+s||"";return n&&":"!==n.substr(-1)&&(n+=":"),t.slashes||(!n||On[n])&&!1!==o?(o="//"+(o||""),i&&"/"!==i.charAt(0)&&(i="/"+i)):o||(o=""),r&&"#"!==r.charAt(0)&&(r="#"+r),a&&"?"!==a.charAt(0)&&(a="?"+a),n+o+(i=i.replace(/[?#]/g,(function(t){return encodeURIComponent(t)})))+(a=a.replace("#","%23"))+r}function Rn(t){var e=t.host,n=xn.exec(e);n&&(":"!==(n=n[0])&&(t.port=n.substr(1)),e=e.substr(0,e.length-n.length)),e&&(t.hostname=e)}vn.prototype.parse=function(t,e,n){return Ln(this,t,e,n)},vn.prototype.format=function(){return Mn(this)},vn.prototype.resolve=function(t){return this.resolveObject(Nn(t,!1,!0)).format()},vn.prototype.resolveObject=function(t){if(hn(t)){var e=new vn;e.parse(t,!1,!0),t=e}for(var n=new vn,i=Object.keys(this),r=0;r<i.length;r++){var o=i[r];n[o]=this[o]}if(n.hash=t.hash,""===t.href)return n.href=n.format(),n;if(t.slashes&&!t.protocol){for(var s=Object.keys(t),a=0;a<s.length;a++){var l=s[a];"protocol"!==l&&(n[l]=t[l])}return On[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}var u;if(t.protocol&&t.protocol!==n.protocol){if(!On[t.protocol]){for(var h=Object.keys(t),c=0;c<h.length;c++){var p=h[c];n[p]=t[p]}return n.href=n.format(),n}if(n.protocol=t.protocol,t.host||An[t.protocol])n.pathname=t.pathname;else{for(u=(t.pathname||"").split("/");u.length&&!(t.host=u.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==u[0]&&u.unshift(""),u.length<2&&u.unshift(""),n.pathname=u.join("/")}if(n.search=t.search,n.query=t.query,n.host=t.host||"",n.auth=t.auth,n.hostname=t.hostname||t.host,n.port=t.port,n.pathname||n.search){var d=n.pathname||"",f=n.search||"";n.path=d+f}return n.slashes=n.slashes||t.slashes,n.href=n.format(),n}var m,y=n.pathname&&"/"===n.pathname.charAt(0),g=t.host||t.pathname&&"/"===t.pathname.charAt(0),v=g||y||n.host&&t.pathname,_=v,x=n.pathname&&n.pathname.split("/")||[],b=n.protocol&&!On[n.protocol];if(u=t.pathname&&t.pathname.split("/")||[],b&&(n.hostname="",n.port=null,n.host&&(""===x[0]?x[0]=n.host:x.unshift(n.host)),n.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===u[0]?u[0]=t.host:u.unshift(t.host)),t.host=null),v=v&&(""===u[0]||""===x[0])),g)n.host=t.host||""===t.host?t.host:n.host,n.hostname=t.hostname||""===t.hostname?t.hostname:n.hostname,n.search=t.search,n.query=t.query,x=u;else if(u.length)x||(x=[]),x.pop(),x=x.concat(u),n.search=t.search,n.query=t.query;else if(!function(t){return null==t}(t.search))return b&&(n.hostname=n.host=x.shift(),(m=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=m.shift(),n.host=n.hostname=m.shift())),n.search=t.search,n.query=t.query,(!un(n.pathname)||!un(n.search))&&(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n;if(!x.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var w=x.slice(-1)[0],P=(n.host||t.host||x.length>1)&&("."===w||".."===w)||""===w,E=0,T=x.length;T>=0;T--)"."===(w=x[T])?x.splice(T,1):".."===w?(x.splice(T,1),E++):E&&(x.splice(T,1),E--);if(!v&&!_)for(;E--;E)x.unshift("..");v&&""!==x[0]&&(!x[0]||"/"!==x[0].charAt(0))&&x.unshift(""),P&&"/"!==x.join("/").substr(-1)&&x.push("");var S=""===x[0]||x[0]&&"/"===x[0].charAt(0);return b&&(n.hostname=n.host=S?"":x.length?x.shift():"",(m=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=m.shift(),n.host=n.hostname=m.shift())),(v=v||n.host&&x.length)&&!S&&x.unshift(""),x.length?n.pathname=x.join("/"):(n.pathname=null,n.path=null),(!un(n.pathname)||!un(n.search))&&(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=t.auth||n.auth,n.slashes=n.slashes||t.slashes,n.href=n.format(),n},vn.prototype.parseHost=function(){return Rn(this)};var kn={parse:Nn,format:function(t){return hn(t)&&(t=Ln({},t)),Mn(t)},resolve:function(t,e){return Nn(t,!1,!0).resolve(e)}};xe.RETINA_PREFIX=/@([0-9\.]+)x/,xe.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var Dn,Fn=!1;function Bn(){Fn=!0}function Un(t){var e;if(!Fn){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var n=["\n %c %c %c PixiJS 6.2.2 - ✰ "+t+" ✰  %c  %c  http://www.pixijs.com/  %c %c ♥%c♥%c♥ \n\n","background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];(e=self.console).log.apply(e,n)}else self.console&&self.console.log("PixiJS 6.2.2 - "+t+" - http://www.pixijs.com/");Fn=!0}}function zn(){return typeof Dn>"u"&&(Dn=function(){var t={stencil:!0,failIfMajorPerformanceCaveat:xe.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!self.WebGLRenderingContext)return!1;var e=document.createElement("canvas"),n=e.getContext("webgl",t)||e.getContext("experimental-webgl",t),i=!(!n||!n.getContextAttributes().stencil);if(n){var r=n.getExtension("WEBGL_lose_context");r&&r.loseContext()}return n=null,i}catch{return!1}}()),Dn}var Xn={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function Yn(t,e){return void 0===e&&(e=[]),e[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255,e}function Gn(t){var e=t.toString(16);return"#"+("000000".substr(0,6-e.length)+e)}function Hn(t){return"string"==typeof t&&"#"===(t=Xn[t.toLowerCase()]||t)[0]&&(t=t.substr(1)),parseInt(t,16)}function Wn(t){return(255*t[0]<<16)+(255*t[1]<<8)+(255*t[2]|0)}var jn=function(){for(var t=[],e=[],n=0;n<32;n++)t[n]=n,e[n]=n;t[bt.NORMAL_NPM]=bt.NORMAL,t[bt.ADD_NPM]=bt.ADD,t[bt.SCREEN_NPM]=bt.SCREEN,e[bt.NORMAL]=bt.NORMAL_NPM,e[bt.ADD]=bt.ADD_NPM,e[bt.SCREEN]=bt.SCREEN_NPM;var i=[];return i.push(e),i.push(t),i}();function Vn(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0;var n=t>>16&255,i=t>>8&255,r=255&t;return(255*e<<24)+((n=n*e+.5|0)<<16)+((i=i*e+.5|0)<<8)+(r*e+.5|0)}function qn(t){if(4===t.BYTES_PER_ELEMENT)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array";return null}var $n={Float32Array,Uint32Array,Int32Array,Uint8Array};function Zn(t){return t+=0===t?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,1+(t|=t>>>16)}function Kn(t){return!(t&t-1||!t)}function Qn(t){var e=(t>65535?1:0)<<4,n=((t>>>=e)>255?1:0)<<3;return e|=n,e|=n=((t>>>=n)>15?1:0)<<2,(e|=n=((t>>>=n)>3?1:0)<<1)|(t>>>=n)>>1}function Jn(t,e,n){var i,r=t.length;if(!(e>=r||0===n)){var o=r-(n=e+n>r?r-e:n);for(i=e;i<o;++i)t[i]=t[i+n];t.length=o}}function ti(t){return 0===t?0:t<0?-1:1}var ei=0;function ni(){return++ei}var ii={};function ri(t,e,n){if(void 0===n&&(n=3),!ii[e]){var i=(new Error).stack;typeof i>"u"?console.warn("PixiJS Deprecation Warning: ",e+"\nDeprecated since v"+t):(i=i.split("\n").splice(n).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",e+"\nDeprecated since v"+t),console.warn(i),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",e+"\nDeprecated since v"+t),console.warn(i))),ii[e]=!0}}var oi={},si=Object.create(null),ai=Object.create(null);function li(){var t;for(t in si)delete si[t];for(t in ai)delete ai[t]}var ui=function(){function t(t,e,n){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=n||xe.RESOLUTION,this.resize(t,e)}return t.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},t.prototype.resize=function(t,e){this.canvas.width=Math.round(t*this.resolution),this.canvas.height=Math.round(e*this.resolution)},t.prototype.destroy=function(){this.context=null,this.canvas=null},Object.defineProperty(t.prototype,"width",{get:function(){return this.canvas.width},set:function(t){this.canvas.width=Math.round(t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.canvas.height},set:function(t){this.canvas.height=Math.round(t)},enumerable:!1,configurable:!0}),t}();function hi(t){var e,n,i,r=t.width,o=t.height,s=t.getContext("2d"),a=s.getImageData(0,0,r,o).data,l=a.length,u={top:null,left:null,right:null,bottom:null},h=null;for(e=0;e<l;e+=4)0!==a[e+3]&&(n=e/4%r,i=~~(e/4/r),null===u.top&&(u.top=i),(null===u.left||n<u.left)&&(u.left=n),(null===u.right||u.right<n)&&(u.right=n+1),(null===u.bottom||u.bottom<i)&&(u.bottom=i));return null!==u.top&&(r=u.right-u.left,o=u.bottom-u.top+1,h=s.getImageData(u.left,u.top,r,o)),{height:o,width:r,data:h}}var ci,pi=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i;function di(t,e){if(void 0===e&&(e=self.location),0===t.indexOf("data:"))return"";e=e||self.location,ci||(ci=document.createElement("a")),ci.href=t;var n=kn.parse(ci.href),i=!n.port&&""===e.port||n.port===e.port;return n.hostname===e.hostname&&i&&n.protocol===e.protocol?"":"anonymous"}function fi(t,e){var n=xe.RETINA_PREFIX.exec(t);return n?parseFloat(n[1]):void 0!==e?e:1}var mi,yi=Object.freeze({__proto__:null,BaseTextureCache:ai,CanvasRenderTarget:ui,DATA_URI:pi,ProgramCache:oi,TextureCache:si,clearTextureCache:li,correctBlendMode:function(t,e){return jn[e?1:0][t]},createIndicesForQuads:function(t,e){void 0===e&&(e=null);var n=6*t;if((e=e||new Uint16Array(n)).length!==n)throw new Error("Out buffer length is incorrect, got "+e.length+" and expected "+n);for(var i=0,r=0;i<n;i+=6,r+=4)e[i+0]=r+0,e[i+1]=r+1,e[i+2]=r+2,e[i+3]=r+0,e[i+4]=r+2,e[i+5]=r+3;return e},decomposeDataUri:function(t){var e=pi.exec(t);if(e)return{mediaType:e[1]?e[1].toLowerCase():void 0,subType:e[2]?e[2].toLowerCase():void 0,charset:e[3]?e[3].toLowerCase():void 0,encoding:e[4]?e[4].toLowerCase():void 0,data:e[5]}},deprecation:ri,destroyTextureCache:function(){var t;for(t in si)si[t].destroy();for(t in ai)ai[t].destroy()},determineCrossOrigin:di,getBufferType:qn,getResolutionOfUrl:fi,hex2rgb:Yn,hex2string:Gn,interleaveTypedArrays:function(t,e){for(var n=0,i=0,r={},o=0;o<t.length;o++)i+=e[o],n+=t[o].length;var s=new ArrayBuffer(4*n),a=null,l=0;for(o=0;o<t.length;o++){var u=e[o],h=t[o],c=qn(h);r[c]||(r[c]=new $n[c](s)),a=r[c];for(var p=0;p<h.length;p++)a[(p/u|0)*i+l+p%u]=h[p];l+=u}return new Float32Array(s)},isPow2:Kn,isWebGLSupported:zn,log2:Qn,nextPow2:Zn,premultiplyBlendMode:jn,premultiplyRgba:function(t,e,n,i){return n=n||new Float32Array(4),i||void 0===i?(n[0]=t[0]*e,n[1]=t[1]*e,n[2]=t[2]*e):(n[0]=t[0],n[1]=t[1],n[2]=t[2]),n[3]=e,n},premultiplyTint:Vn,premultiplyTintToRgba:function(t,e,n,i){return(n=n||new Float32Array(4))[0]=(t>>16&255)/255,n[1]=(t>>8&255)/255,n[2]=(255&t)/255,(i||void 0===i)&&(n[0]*=e,n[1]*=e,n[2]*=e),n[3]=e,n},removeItems:Jn,rgb2hex:Wn,sayHello:Un,sign:ti,skipHello:Bn,string2hex:Hn,trimCanvas:hi,uid:ni,url:kn,isMobile:ve,EventEmitter:Ee,earcut:Te.exports}),gi=2*Math.PI,vi=180/Math.PI,_i=Math.PI/180;!function(t){t[t.POLY=0]="POLY",t[t.RECT=1]="RECT",t[t.CIRC=2]="CIRC",t[t.ELIP=3]="ELIP",t[t.RREC=4]="RREC"}(mi||(mi={}));var xi=function(){function t(t,e,n,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),this.x=Number(t),this.y=Number(e),this.width=Number(n),this.height=Number(i),this.type=mi.RECT}return Object.defineProperty(t.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(t,"EMPTY",{get:function(){return new t(0,0,0,0)},enumerable:!1,configurable:!0}),t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},t.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},t.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0)&&t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height},t.prototype.pad=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},t.prototype.fit=function(t){var e=Math.max(this.x,t.x),n=Math.min(this.x+this.width,t.x+t.width),i=Math.max(this.y,t.y),r=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(n-e,0),this.y=i,this.height=Math.max(r-i,0),this},t.prototype.ceil=function(t,e){void 0===t&&(t=1),void 0===e&&(e=.001);var n=Math.ceil((this.x+this.width-e)*t)/t,i=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=n-this.x,this.height=i-this.y,this},t.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),n=Math.max(this.x+this.width,t.x+t.width),i=Math.min(this.y,t.y),r=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=n-e,this.y=i,this.height=r-i,this},t.prototype.toString=function(){return"[@pixi/math:Rectangle x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+"]"},t}(),bi=function(){function t(t,e,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),this.x=t,this.y=e,this.radius=n,this.type=mi.CIRC}return t.prototype.clone=function(){return new t(this.x,this.y,this.radius)},t.prototype.contains=function(t,e){if(this.radius<=0)return!1;var n=this.radius*this.radius,i=this.x-t,r=this.y-e;return(i*=i)+(r*=r)<=n},t.prototype.getBounds=function(){return new xi(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)},t.prototype.toString=function(){return"[@pixi/math:Circle x="+this.x+" y="+this.y+" radius="+this.radius+"]"},t}(),wi=function(){function t(t,e,n,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),this.x=t,this.y=e,this.width=n,this.height=i,this.type=mi.ELIP}return t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var n=(t-this.x)/this.width,i=(e-this.y)/this.height;return(n*=n)+(i*=i)<=1},t.prototype.getBounds=function(){return new xi(this.x-this.width,this.y-this.height,this.width,this.height)},t.prototype.toString=function(){return"[@pixi/math:Ellipse x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+"]"},t}(),Pi=function(){function t(){for(var t=arguments,e=[],n=0;n<arguments.length;n++)e[n]=t[n];var i=Array.isArray(e[0])?e[0]:e;if("number"!=typeof i[0]){for(var r=[],o=0,s=i.length;o<s;o++)r.push(i[o].x,i[o].y);i=r}this.points=i,this.type=mi.POLY,this.closeStroke=!0}return t.prototype.clone=function(){var e=new t(this.points.slice());return e.closeStroke=this.closeStroke,e},t.prototype.contains=function(t,e){for(var n=!1,i=this.points.length/2,r=0,o=i-1;r<i;o=r++){var s=this.points[2*r],a=this.points[2*r+1],l=this.points[2*o],u=this.points[2*o+1];a>e!=u>e&&t<(e-a)/(u-a)*(l-s)+s&&(n=!n)}return n},t.prototype.toString=function(){return"[@pixi/math:PolygoncloseStroke="+this.closeStroke+"points="+this.points.reduce((function(t,e){return t+", "+e}),"")+"]"},t}(),Ei=function(){function t(t,e,n,i,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),void 0===r&&(r=20),this.x=t,this.y=e,this.width=n,this.height=i,this.radius=r,this.type=mi.RREC}return t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height,this.radius)},t.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){var n=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+n&&e<=this.y+this.height-n||t>=this.x+n&&t<=this.x+this.width-n)return!0;var i=t-(this.x+n),r=e-(this.y+n),o=n*n;if(i*i+r*r<=o||(i=t-(this.x+this.width-n))*i+r*r<=o||i*i+(r=e-(this.y+this.height-n))*r<=o||(i=t-(this.x+n))*i+r*r<=o)return!0}return!1},t.prototype.toString=function(){return"[@pixi/math:RoundedRectangle x="+this.x+" y="+this.y+"width="+this.width+" height="+this.height+" radius="+this.radius+"]"},t}(),Ti=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=0,this.y=0,this.x=t,this.y=e}return t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},t.prototype.copyTo=function(t){return t.set(this.x,this.y),t},t.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},t.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x=t,this.y=e,this},t.prototype.toString=function(){return"[@pixi/math:Point x="+this.x+" y="+this.y+"]"},t}(),Si=function(){function t(t,e,n,i){void 0===n&&(n=0),void 0===i&&(i=0),this._x=n,this._y=i,this.cb=t,this.scope=e}return t.prototype.clone=function(e,n){return void 0===e&&(e=this.cb),void 0===n&&(n=this.scope),new t(e,n,this._x,this._y)},t.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),(this._x!==t||this._y!==e)&&(this._x=t,this._y=e,this.cb.call(this.scope)),this},t.prototype.copyFrom=function(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this},t.prototype.copyTo=function(t){return t.set(this._x,this._y),t},t.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},t.prototype.toString=function(){return"[@pixi/math:ObservablePoint x=0 y=0 scope="+this.scope+"]"},Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),t}(),Ci=function(){function t(t,e,n,i,r,o){void 0===t&&(t=1),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=1),void 0===r&&(r=0),void 0===o&&(o=0),this.array=null,this.a=t,this.b=e,this.c=n,this.d=i,this.tx=r,this.ty=o}return t.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},t.prototype.set=function(t,e,n,i,r,o){return this.a=t,this.b=e,this.c=n,this.d=i,this.tx=r,this.ty=o,this},t.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var n=e||this.array;return t?(n[0]=this.a,n[1]=this.b,n[2]=0,n[3]=this.c,n[4]=this.d,n[5]=0,n[6]=this.tx,n[7]=this.ty,n[8]=1):(n[0]=this.a,n[1]=this.c,n[2]=this.tx,n[3]=this.b,n[4]=this.d,n[5]=this.ty,n[6]=0,n[7]=0,n[8]=1),n},t.prototype.apply=function(t,e){e=e||new Ti;var n=t.x,i=t.y;return e.x=this.a*n+this.c*i+this.tx,e.y=this.b*n+this.d*i+this.ty,e},t.prototype.applyInverse=function(t,e){e=e||new Ti;var n=1/(this.a*this.d+this.c*-this.b),i=t.x,r=t.y;return e.x=this.d*n*i+-this.c*n*r+(this.ty*this.c-this.tx*this.d)*n,e.y=this.a*n*r+-this.b*n*i+(-this.ty*this.a+this.tx*this.b)*n,e},t.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},t.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},t.prototype.rotate=function(t){var e=Math.cos(t),n=Math.sin(t),i=this.a,r=this.c,o=this.tx;return this.a=i*e-this.b*n,this.b=i*n+this.b*e,this.c=r*e-this.d*n,this.d=r*n+this.d*e,this.tx=o*e-this.ty*n,this.ty=o*n+this.ty*e,this},t.prototype.append=function(t){var e=this.a,n=this.b,i=this.c,r=this.d;return this.a=t.a*e+t.b*i,this.b=t.a*n+t.b*r,this.c=t.c*e+t.d*i,this.d=t.c*n+t.d*r,this.tx=t.tx*e+t.ty*i+this.tx,this.ty=t.tx*n+t.ty*r+this.ty,this},t.prototype.setTransform=function(t,e,n,i,r,o,s,a,l){return this.a=Math.cos(s+l)*r,this.b=Math.sin(s+l)*r,this.c=-Math.sin(s-a)*o,this.d=Math.cos(s-a)*o,this.tx=t-(n*this.a+i*this.c),this.ty=e-(n*this.b+i*this.d),this},t.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var n=this.a,i=this.c;this.a=n*t.a+this.b*t.c,this.b=n*t.b+this.b*t.d,this.c=i*t.a+this.d*t.c,this.d=i*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},t.prototype.decompose=function(t){var e=this.a,n=this.b,i=this.c,r=this.d,o=t.pivot,s=-Math.atan2(-i,r),a=Math.atan2(n,e),l=Math.abs(s+a);return l<1e-5||Math.abs(gi-l)<1e-5?(t.rotation=a,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=s,t.skew.y=a),t.scale.x=Math.sqrt(e*e+n*n),t.scale.y=Math.sqrt(i*i+r*r),t.position.x=this.tx+(o.x*e+o.y*i),t.position.y=this.ty+(o.x*n+o.y*r),t},t.prototype.invert=function(){var t=this.a,e=this.b,n=this.c,i=this.d,r=this.tx,o=t*i-e*n;return this.a=i/o,this.b=-e/o,this.c=-n/o,this.d=t/o,this.tx=(n*this.ty-i*r)/o,this.ty=-(t*this.ty-e*r)/o,this},t.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},t.prototype.clone=function(){var e=new t;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e},t.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},t.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},t.prototype.toString=function(){return"[@pixi/math:Matrix a="+this.a+" b="+this.b+" c="+this.c+" d="+this.d+" tx="+this.tx+" ty="+this.ty+"]"},Object.defineProperty(t,"IDENTITY",{get:function(){return new t},enumerable:!1,configurable:!0}),Object.defineProperty(t,"TEMP_MATRIX",{get:function(){return new t},enumerable:!1,configurable:!0}),t}(),Ii=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Ai=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Oi=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Ni=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Li=[],Mi=[],Ri=Math.sign;!function(){for(var t=0;t<16;t++){var e=[];Li.push(e);for(var n=0;n<16;n++)for(var i=Ri(Ii[t]*Ii[n]+Oi[t]*Ai[n]),r=Ri(Ai[t]*Ii[n]+Ni[t]*Ai[n]),o=Ri(Ii[t]*Oi[n]+Oi[t]*Ni[n]),s=Ri(Ai[t]*Oi[n]+Ni[t]*Ni[n]),a=0;a<16;a++)if(Ii[a]===i&&Ai[a]===r&&Oi[a]===o&&Ni[a]===s){e.push(a);break}}for(t=0;t<16;t++){var l=new Ci;l.set(Ii[t],Ai[t],Oi[t],Ni[t],0,0),Mi.push(l)}}();var ki={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(t){return Ii[t]},uY:function(t){return Ai[t]},vX:function(t){return Oi[t]},vY:function(t){return Ni[t]},inv:function(t){return 8&t?15&t:7&-t},add:function(t,e){return Li[t][e]},sub:function(t,e){return Li[t][ki.inv(e)]},rotate180:function(t){return 4^t},isVertical:function(t){return 2==(3&t)},byDirection:function(t,e){return 2*Math.abs(t)<=Math.abs(e)?e>=0?ki.S:ki.N:2*Math.abs(e)<=Math.abs(t)?t>0?ki.E:ki.W:e>0?t>0?ki.SE:ki.SW:t>0?ki.NE:ki.NW},matrixAppendRotationInv:function(t,e,n,i){void 0===n&&(n=0),void 0===i&&(i=0);var r=Mi[ki.inv(e)];r.tx=n,r.ty=i,t.append(r)}},Di=function(){function t(){this.worldTransform=new Ci,this.localTransform=new Ci,this.position=new Si(this.onChange,this,0,0),this.scale=new Si(this.onChange,this,1,1),this.pivot=new Si(this.onChange,this,0,0),this.skew=new Si(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}return t.prototype.onChange=function(){this._localID++},t.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},t.prototype.toString=function(){return"[@pixi/math:Transform position=("+this.position.x+", "+this.position.y+") rotation="+this.rotation+" scale=("+this.scale.x+", "+this.scale.y+") skew=("+this.skew.x+", "+this.skew.y+") ]"},t.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},t.prototype.updateTransform=function(t){var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var n=t.worldTransform,i=this.worldTransform;i.a=e.a*n.a+e.b*n.c,i.b=e.a*n.b+e.b*n.d,i.c=e.c*n.a+e.d*n.c,i.d=e.c*n.b+e.d*n.d,i.tx=e.tx*n.a+e.ty*n.c+n.tx,i.ty=e.tx*n.b+e.ty*n.d+n.ty,this._parentID=t._worldID,this._worldID++}},t.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(t.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!1,configurable:!0}),t.IDENTITY=new t,t}();xe.SORTABLE_CHILDREN=!1;var Fi=function(){function t(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}return t.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},t.prototype.clear=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},t.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?xi.EMPTY:((t=t||new xi(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},t.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)},t.prototype.addPointMatrix=function(t,e){var n=t.a,i=t.b,r=t.c,o=t.d,s=t.tx,a=t.ty,l=n*e.x+r*e.y+s,u=i*e.x+o*e.y+a;this.minX=Math.min(this.minX,l),this.maxX=Math.max(this.maxX,l),this.minY=Math.min(this.minY,u),this.maxY=Math.max(this.maxY,u)},t.prototype.addQuad=function(t){var e=this.minX,n=this.minY,i=this.maxX,r=this.maxY,o=t[0],s=t[1];e=o<e?o:e,n=s<n?s:n,i=o>i?o:i,r=s>r?s:r,e=(o=t[2])<e?o:e,n=(s=t[3])<n?s:n,i=o>i?o:i,r=s>r?s:r,e=(o=t[4])<e?o:e,n=(s=t[5])<n?s:n,i=o>i?o:i,r=s>r?s:r,e=(o=t[6])<e?o:e,n=(s=t[7])<n?s:n,i=o>i?o:i,r=s>r?s:r,this.minX=e,this.minY=n,this.maxX=i,this.maxY=r},t.prototype.addFrame=function(t,e,n,i,r){this.addFrameMatrix(t.worldTransform,e,n,i,r)},t.prototype.addFrameMatrix=function(t,e,n,i,r){var o=t.a,s=t.b,a=t.c,l=t.d,u=t.tx,h=t.ty,c=this.minX,p=this.minY,d=this.maxX,f=this.maxY,m=o*e+a*n+u,y=s*e+l*n+h;c=m<c?m:c,p=y<p?y:p,d=m>d?m:d,f=y>f?y:f,c=(m=o*i+a*n+u)<c?m:c,p=(y=s*i+l*n+h)<p?y:p,d=m>d?m:d,f=y>f?y:f,c=(m=o*e+a*r+u)<c?m:c,p=(y=s*e+l*r+h)<p?y:p,d=m>d?m:d,f=y>f?y:f,c=(m=o*i+a*r+u)<c?m:c,p=(y=s*i+l*r+h)<p?y:p,d=m>d?m:d,f=y>f?y:f,this.minX=c,this.minY=p,this.maxX=d,this.maxY=f},t.prototype.addVertexData=function(t,e,n){for(var i=this.minX,r=this.minY,o=this.maxX,s=this.maxY,a=e;a<n;a+=2){var l=t[a],u=t[a+1];i=l<i?l:i,r=u<r?u:r,o=l>o?l:o,s=u>s?u:s}this.minX=i,this.minY=r,this.maxX=o,this.maxY=s},t.prototype.addVertices=function(t,e,n,i){this.addVerticesMatrix(t.worldTransform,e,n,i)},t.prototype.addVerticesMatrix=function(t,e,n,i,r,o){void 0===r&&(r=0),void 0===o&&(o=r);for(var s=t.a,a=t.b,l=t.c,u=t.d,h=t.tx,c=t.ty,p=this.minX,d=this.minY,f=this.maxX,m=this.maxY,y=n;y<i;y+=2){var g=e[y],v=e[y+1],_=s*g+l*v+h,x=u*v+a*g+c;p=Math.min(p,_-r),f=Math.max(f,_+r),d=Math.min(d,x-o),m=Math.max(m,x+o)}this.minX=p,this.minY=d,this.maxX=f,this.maxY=m},t.prototype.addBounds=function(t){var e=this.minX,n=this.minY,i=this.maxX,r=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<n?t.minY:n,this.maxX=t.maxX>i?t.maxX:i,this.maxY=t.maxY>r?t.maxY:r},t.prototype.addBoundsMask=function(t,e){var n=t.minX>e.minX?t.minX:e.minX,i=t.minY>e.minY?t.minY:e.minY,r=t.maxX<e.maxX?t.maxX:e.maxX,o=t.maxY<e.maxY?t.maxY:e.maxY;if(n<=r&&i<=o){var s=this.minX,a=this.minY,l=this.maxX,u=this.maxY;this.minX=n<s?n:s,this.minY=i<a?i:a,this.maxX=r>l?r:l,this.maxY=o>u?o:u}},t.prototype.addBoundsMatrix=function(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},t.prototype.addBoundsArea=function(t,e){var n=t.minX>e.x?t.minX:e.x,i=t.minY>e.y?t.minY:e.y,r=t.maxX<e.x+e.width?t.maxX:e.x+e.width,o=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(n<=r&&i<=o){var s=this.minX,a=this.minY,l=this.maxX,u=this.maxY;this.minX=n<s?n:s,this.minY=i<a?i:a,this.maxX=r>l?r:l,this.maxY=o>u?o:u}},t.prototype.pad=function(t,e){void 0===t&&(t=0),void 0===e&&(e=t),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},t.prototype.addFramePad=function(t,e,n,i,r,o){t-=r,e-=o,n+=r,i+=o,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>n?this.maxX:n,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>i?this.maxY:i},t}(),Bi=function(t,e){return(Bi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function Ui(t,e){function n(){this.constructor=t}Bi(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var zi,Xi,Yi,Gi,Hi,Wi,ji,Vi,qi,$i,Zi,Ki,Qi,Ji,tr,er,nr,ir,rr,or=function(t){function e(){var e=t.call(this)||this;return e.tempDisplayObjectParent=null,e.transform=new Di,e.alpha=1,e.visible=!0,e.renderable=!0,e.parent=null,e.worldAlpha=1,e._lastSortedIndex=0,e._zIndex=0,e.filterArea=null,e.filters=null,e._enabledFilters=null,e._bounds=new Fi,e._localBounds=null,e._boundsID=0,e._boundsRect=null,e._localBoundsRect=null,e._mask=null,e._maskRefCount=0,e._destroyed=!1,e.isSprite=!1,e.isMask=!1,e}return Ui(e,t),e.mixin=function(t){for(var n=Object.keys(t),i=0;i<n.length;++i){var r=n[i];Object.defineProperty(e.prototype,r,Object.getOwnPropertyDescriptor(t,r))}},Object.defineProperty(e.prototype,"destroyed",{get:function(){return this._destroyed},enumerable:!1,configurable:!0}),e.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},e.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha},e.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new xi),e=this._boundsRect),this._bounds.getRectangle(e)},e.prototype.getLocalBounds=function(t){t||(this._localBoundsRect||(this._localBoundsRect=new xi),t=this._localBoundsRect),this._localBounds||(this._localBounds=new Fi);var e=this.transform,n=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;var i=this._bounds,r=this._boundsID;this._bounds=this._localBounds;var o=this.getBounds(!1,t);return this.parent=n,this.transform=e,this._bounds=i,this._bounds.updateID+=this._boundsID-r,o},e.prototype.toGlobal=function(t,e,n){return void 0===n&&(n=!1),n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)},e.prototype.toLocal=function(t,e,n,i){return e&&(t=e.toGlobal(t,n,i)),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,n)},e.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t},e.prototype.setTransform=function(t,e,n,i,r,o,s,a,l){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=1),void 0===i&&(i=1),void 0===r&&(r=0),void 0===o&&(o=0),void 0===s&&(s=0),void 0===a&&(a=0),void 0===l&&(l=0),this.position.x=t,this.position.y=e,this.scale.x=n||1,this.scale.y=i||1,this.rotation=r,this.skew.x=o,this.skew.y=s,this.pivot.x=a,this.pivot.y=l,this},e.prototype.destroy=function(t){this.parent&&this.parent.removeChild(this),this.emit("destroyed"),this.removeAllListeners(),this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},Object.defineProperty(e.prototype,"_tempDisplayObjectParent",{get:function(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new sr),this.tempDisplayObjectParent},enumerable:!1,configurable:!0}),e.prototype.enableTempParent=function(){var t=this.parent;return this.parent=this._tempDisplayObjectParent,t},e.prototype.disableTempParent=function(t){this.parent=t},Object.defineProperty(e.prototype,"x",{get:function(){return this.position.x},set:function(t){this.transform.position.x=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.position.y},set:function(t){this.transform.position.y=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"worldTransform",{get:function(){return this.transform.worldTransform},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"localTransform",{get:function(){return this.transform.localTransform},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"position",{get:function(){return this.transform.position},set:function(t){this.transform.position.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scale",{get:function(){return this.transform.scale},set:function(t){this.transform.scale.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pivot",{get:function(){return this.transform.pivot},set:function(t){this.transform.pivot.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"skew",{get:function(){return this.transform.skew},set:function(t){this.transform.skew.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotation",{get:function(){return this.transform.rotation},set:function(t){this.transform.rotation=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"angle",{get:function(){return this.transform.rotation*vi},set:function(t){this.transform.rotation=t*_i},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"zIndex",{get:function(){return this._zIndex},set:function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"worldVisible",{get:function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mask",{get:function(){return this._mask},set:function(t){var e;this._mask!==t&&(this._mask&&((e=this._mask.maskObject||this._mask)._maskRefCount--,0===e._maskRefCount&&(e.renderable=!0,e.isMask=!1)),this._mask=t,this._mask&&(0===(e=this._mask.maskObject||this._mask)._maskRefCount&&(e.renderable=!1,e.isMask=!0),e._maskRefCount++))},enumerable:!1,configurable:!0}),e}(Ee),sr=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sortDirty=null,e}return Ui(e,t),e}(or);function ar(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}or.prototype.displayObjectUpdateTransform=or.prototype.updateTransform,function(t){t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2"}(zi||(zi={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS"}(Xi||(Xi={})),function(t){t[t.COLOR=16384]="COLOR",t[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL"}(Yi||(Yi={})),function(t){t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR"}(Gi||(Gi={})),function(t){t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(Hi||(Hi={})),function(t){t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.RG=33319]="RG",t[t.RED=6403]="RED",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(Wi||(Wi={})),function(t){t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(ji||(ji={})),function(t){t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.BYTE=5120]="BYTE",t[t.SHORT=5122]="SHORT",t[t.INT=5124]="INT",t[t.FLOAT=5126]="FLOAT",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.HALF_FLOAT=36193]="HALF_FLOAT"}(Vi||(Vi={})),function(t){t[t.FLOAT=0]="FLOAT",t[t.INT=1]="INT",t[t.UINT=2]="UINT"}(qi||(qi={})),function(t){t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR"}($i||($i={})),function(t){t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(Zi||(Zi={})),function(t){t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON",t[t.ON_MANUAL=3]="ON_MANUAL"}(Ki||(Ki={})),function(t){t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",t[t.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA"}(Qi||(Qi={})),function(t){t[t.NO=0]="NO",t[t.YES=1]="YES",t[t.AUTO=2]="AUTO",t[t.BLEND=0]="BLEND",t[t.CLEAR=1]="CLEAR",t[t.BLIT=2]="BLIT"}(Ji||(Ji={})),function(t){t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL"}(tr||(tr={})),function(t){t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp"}(er||(er={})),function(t){t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE"}(nr||(nr={})),function(t){t[t.NONE=0]="NONE",t[t.LOW=2]="LOW",t[t.MEDIUM=4]="MEDIUM",t[t.HIGH=8]="HIGH"}(ir||(ir={})),function(t){t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER"}(rr||(rr={}));var lr=function(t){function e(){var e=t.call(this)||this;return e.children=[],e.sortableChildren=xe.SORTABLE_CHILDREN,e.sortDirty=!1,e}return Ui(e,t),e.prototype.onChildrenChange=function(t){},e.prototype.addChild=function(){for(var t=arguments,e=[],n=0;n<arguments.length;n++)e[n]=t[n];if(e.length>1)for(var i=0;i<e.length;i++)this.addChild(e[i]);else{var r=e[0];r.parent&&r.parent.removeChild(r),r.parent=this,this.sortDirty=!0,r.transform._parentID=-1,this.children.push(r),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",r,this,this.children.length-1),r.emit("added",this)}return e[0]},e.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),this.emit("childAdded",t,this,e),t},e.prototype.swapChildren=function(t,e){if(t!==e){var n=this.getChildIndex(t),i=this.getChildIndex(e);this.children[n]=e,this.children[i]=t,this.onChildrenChange(n<i?n:i)}},e.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},e.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error("The index "+e+" supplied is out of bounds "+this.children.length);var n=this.getChildIndex(t);Jn(this.children,n,1),this.children.splice(e,0,t),this.onChildrenChange(e)},e.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error("getChildAt: Index ("+t+") does not exist.");return this.children[t]},e.prototype.removeChild=function(){for(var t=arguments,e=[],n=0;n<arguments.length;n++)e[n]=t[n];if(e.length>1)for(var i=0;i<e.length;i++)this.removeChild(e[i]);else{var r=e[0],o=this.children.indexOf(r);if(-1===o)return null;r.parent=null,r.transform._parentID=-1,Jn(this.children,o,1),this._boundsID++,this.onChildrenChange(o),r.emit("removed",this),this.emit("childRemoved",r,this,o)}return e[0]},e.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,Jn(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e},e.prototype.removeChildren=function(t,e){void 0===t&&(t=0),void 0===e&&(e=this.children.length);var n,i=t,r=e-i;if(r>0&&r<=e){n=this.children.splice(i,r);for(var o=0;o<n.length;++o)n[o].parent=null,n[o].transform&&(n[o].transform._parentID=-1);for(this._boundsID++,this.onChildrenChange(t),o=0;o<n.length;++o)n[o].emit("removed",this),this.emit("childRemoved",n[o],this,o);return n}if(0===r&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},e.prototype.sortChildren=function(){for(var t=!1,e=0,n=this.children.length;e<n;++e){var i=this.children[e];i._lastSortedIndex=e,!t&&0!==i.zIndex&&(t=!0)}t&&this.children.length>1&&this.children.sort(ar),this.sortDirty=!1},e.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var n=this.children[t];n.visible&&n.updateTransform()}},e.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){var n=e._mask.maskObject||e._mask;n.calculateBounds(),this._bounds.addBoundsMask(e._bounds,n._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._bounds.updateID=this._boundsID},e.prototype.getLocalBounds=function(e,n){void 0===n&&(n=!1);var i=t.prototype.getLocalBounds.call(this,e);if(!n)for(var r=0,o=this.children.length;r<o;++r){var s=this.children[r];s.visible&&s.updateTransform()}return i},e.prototype._calculateBounds=function(){},e.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else{this._render(t);for(var e=0,n=this.children.length;e<n;++e)this.children[e].render(t)}},e.prototype.renderAdvanced=function(t){var e=this.filters,n=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var i=0;i<e.length;i++)e[i].enabled&&this._enabledFilters.push(e[i])}var r=e&&this._enabledFilters&&this._enabledFilters.length||n&&(!n.isMaskData||n.enabled&&(n.autoDetect||n.type!==nr.NONE));r&&t.batch.flush(),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.push(this,this._enabledFilters),n&&t.mask.push(this,this._mask),this._render(t),i=0;for(var o=this.children.length;i<o;i++)this.children[i].render(t);r&&t.batch.flush(),n&&t.mask.pop(this),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()},e.prototype._render=function(t){},e.prototype.destroy=function(e){t.prototype.destroy.call(this),this.sortDirty=!1;var n="boolean"==typeof e?e:e&&e.children,i=this.removeChildren(0,this.children.length);if(n)for(var r=0;r<i.length;++r)i[r].destroy(e)},Object.defineProperty(e.prototype,"width",{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(t){var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.scale.y*this.getLocalBounds().height},set:function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t},enumerable:!1,configurable:!0}),e}(or);lr.prototype.containerUpdateTransform=lr.prototype.updateTransform;var ur=function(){function t(t){this.items=[],this._name=t,this._aliasCount=0}return t.prototype.emit=function(t,e,n,i,r,o,s,a){if(arguments.length>8)throw new Error("max arguments reached");var l=this.name,u=this.items;this._aliasCount++;for(var h=0,c=u.length;h<c;h++)u[h][l](t,e,n,i,r,o,s,a);return u===this.items&&this._aliasCount--,this},t.prototype.ensureNonAliasedItems=function(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))},t.prototype.add=function(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this},t.prototype.remove=function(t){var e=this.items.indexOf(t);return-1!==e&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this},t.prototype.contains=function(t){return-1!==this.items.indexOf(t)},t.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},t.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.items.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),t}();Object.defineProperties(ur.prototype,{dispatch:{value:ur.prototype.emit},run:{value:ur.prototype.emit}}),xe.PREFER_ENV=ve.any?vt.WEBGL:vt.WEBGL2,xe.STRICT_TEXTURE_CACHE=!1;var hr=[];function cr(t,e){if(!t)return null;var n="";if("string"==typeof t){var i=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);i&&(n=i[1].toLowerCase())}for(var r=hr.length-1;r>=0;--r){var o=hr[r];if(o.test&&o.test(t,n))return new o(t,e)}throw new Error("Unrecognized source type to auto-detect Resource")}var pr=function(t,e){return(pr=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function dr(t,e){function n(){this.constructor=t}pr(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var fr=function(){return fr=Object.assign||function(t){for(var e,n=arguments,i=1,r=arguments.length;i<r;i++)for(var o in e=n[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},fr.apply(this,arguments)},mr=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new ur("setRealSize"),this.onUpdate=new ur("update"),this.onError=new ur("onError")}return t.prototype.bind=function(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.emit(this._width,this._height)},t.prototype.unbind=function(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)},t.prototype.resize=function(t,e){(t!==this._width||e!==this._height)&&(this._width=t,this._height=e,this.onResize.emit(t,e))},Object.defineProperty(t.prototype,"valid",{get:function(){return!!this._width&&!!this._height},enumerable:!1,configurable:!0}),t.prototype.update=function(){this.destroyed||this.onUpdate.emit()},t.prototype.load=function(){return Promise.resolve(this)},Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!1,configurable:!0}),t.prototype.style=function(t,e,n){return!1},t.prototype.dispose=function(){},t.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},t.test=function(t,e){return!1},t}(),yr=function(t){function e(e,n){var i=this,r=n||{},o=r.width,s=r.height;if(!o||!s)throw new Error("BufferResource width or height invalid");return(i=t.call(this,o,s)||this).data=e,i}return dr(e,t),e.prototype.upload=function(t,e,n){var i=t.gl;i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===Ot.UNPACK);var r=e.realWidth,o=e.realHeight;return n.width===r&&n.height===o?i.texSubImage2D(e.target,0,0,0,r,o,e.format,n.type,this.data):(n.width=r,n.height=o,i.texImage2D(e.target,0,n.internalFormat,r,o,0,e.format,n.type,this.data)),!0},e.prototype.dispose=function(){this.data=null},e.test=function(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array},e}(mr),gr={scaleMode:Ct.NEAREST,format:Pt.RGBA,alphaMode:Ot.NPM},vr=function(t){function e(e,n){void 0===e&&(e=null),void 0===n&&(n=null);var i=t.call(this)||this,r=(n=n||{}).alphaMode,o=n.mipmap,s=n.anisotropicLevel,a=n.scaleMode,l=n.width,u=n.height,h=n.wrapMode,c=n.format,p=n.type,d=n.target,f=n.resolution,m=n.resourceOptions;return e&&!(e instanceof mr)&&((e=cr(e,m)).internal=!0),i.resolution=f||xe.RESOLUTION,i.width=Math.round((l||0)*i.resolution)/i.resolution,i.height=Math.round((u||0)*i.resolution)/i.resolution,i._mipmap=void 0!==o?o:xe.MIPMAP_TEXTURES,i.anisotropicLevel=void 0!==s?s:xe.ANISOTROPIC_LEVEL,i._wrapMode=h||xe.WRAP_MODE,i._scaleMode=void 0!==a?a:xe.SCALE_MODE,i.format=c||Pt.RGBA,i.type=p||Tt.UNSIGNED_BYTE,i.target=d||Et.TEXTURE_2D,i.alphaMode=void 0!==r?r:Ot.UNPACK,i.uid=ni(),i.touched=0,i.isPowerOfTwo=!1,i._refreshPOT(),i._glTextures={},i.dirtyId=0,i.dirtyStyleId=0,i.cacheId=null,i.valid=l>0&&u>0,i.textureCacheIds=[],i.destroyed=!1,i.resource=null,i._batchEnabled=0,i._batchLocation=0,i.parentTextureArray=null,i.setResource(e),i}return dr(e,t),Object.defineProperty(e.prototype,"realWidth",{get:function(){return Math.round(this.width*this.resolution)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"realHeight",{get:function(){return Math.round(this.height*this.resolution)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mipmap",{get:function(){return this._mipmap},set:function(t){this._mipmap!==t&&(this._mipmap=t,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scaleMode",{get:function(){return this._scaleMode},set:function(t){this._scaleMode!==t&&(this._scaleMode=t,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"wrapMode",{get:function(){return this._wrapMode},set:function(t){this._wrapMode!==t&&(this._wrapMode=t,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),e.prototype.setStyle=function(t,e){var n;return void 0!==t&&t!==this.scaleMode&&(this.scaleMode=t,n=!0),void 0!==e&&e!==this.mipmap&&(this.mipmap=e,n=!0),n&&this.dirtyStyleId++,this},e.prototype.setSize=function(t,e,n){return n=n||this.resolution,this.setRealSize(t*n,e*n,n)},e.prototype.setRealSize=function(t,e,n){return this.resolution=n||this.resolution,this.width=Math.round(t)/this.resolution,this.height=Math.round(e)/this.resolution,this._refreshPOT(),this.update(),this},e.prototype._refreshPOT=function(){this.isPowerOfTwo=Kn(this.realWidth)&&Kn(this.realHeight)},e.prototype.setResolution=function(t){var e=this.resolution;return e===t||(this.resolution=t,this.valid&&(this.width=Math.round(this.width*e)/t,this.height=Math.round(this.height*e)/t,this.emit("update",this)),this._refreshPOT()),this},e.prototype.setResource=function(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this},e.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},e.prototype.onError=function(t){this.emit("error",this,t)},e.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete ai[this.cacheId],delete si[this.cacheId],this.cacheId=null),this.dispose(),e.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},e.prototype.dispose=function(){this.emit("dispose",this)},e.prototype.castToBaseTexture=function(){return this},e.from=function(t,n,i){void 0===i&&(i=xe.STRICT_TEXTURE_CACHE);var r="string"==typeof t,o=null;if(r)o=t;else{if(!t._pixiId){var s=n&&n.pixiIdPrefix||"pixiid";t._pixiId=s+"_"+ni()}o=t._pixiId}var a=ai[o];if(r&&i&&!a)throw new Error('The cacheId "'+o+'" does not exist in BaseTextureCache.');return a||((a=new e(t,n)).cacheId=o,e.addToCache(a,o)),a},e.fromBuffer=function(t,n,i,r){t=t||new Float32Array(n*i*4);var o=new yr(t,{width:n,height:i}),s=t instanceof Float32Array?Tt.FLOAT:Tt.UNSIGNED_BYTE;return new e(o,Object.assign(gr,r||{width:n,height:i,type:s}))},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),ai[e]&&console.warn("BaseTexture added to the cache with an id ["+e+"] that already had an entry"),ai[e]=t)},e.removeFromCache=function(t){if("string"==typeof t){var e=ai[t];if(e){var n=e.textureCacheIds.indexOf(t);return n>-1&&e.textureCacheIds.splice(n,1),delete ai[t],e}}else if(t&&t.textureCacheIds){for(var i=0;i<t.textureCacheIds.length;++i)delete ai[t.textureCacheIds[i]];return t.textureCacheIds.length=0,t}return null},e._globalBatch=0,e}(Ee),_r=function(t){function e(e,n){var i=this,r=n||{},o=r.width,s=r.height;(i=t.call(this,o,s)||this).items=[],i.itemDirtyIds=[];for(var a=0;a<e;a++){var l=new vr;i.items.push(l),i.itemDirtyIds.push(-2)}return i.length=e,i._load=null,i.baseTexture=null,i}return dr(e,t),e.prototype.initFromArray=function(t,e){for(var n=0;n<this.length;n++)!t[n]||(t[n].castToBaseTexture?this.addBaseTextureAt(t[n].castToBaseTexture(),n):t[n]instanceof mr?this.addResourceAt(t[n],n):this.addResourceAt(cr(t[n],e),n))},e.prototype.dispose=function(){for(var t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},e.prototype.addResourceAt=function(t,e){if(!this.items[e])throw new Error("Index "+e+" is out of bounds");return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this},e.prototype.bind=function(e){if(null!==this.baseTexture)throw new Error("Only one base texture per TextureArray is allowed");t.prototype.bind.call(this,e);for(var n=0;n<this.length;n++)this.items[n].parentTextureArray=e,this.items[n].on("update",e.update,e)},e.prototype.unbind=function(e){t.prototype.unbind.call(this,e);for(var n=0;n<this.length;n++)this.items[n].parentTextureArray=null,this.items[n].off("update",e.update,e)},e.prototype.load=function(){var t=this;if(this._load)return this._load;var e=this.items.map((function(t){return t.resource})).filter((function(t){return t})).map((function(t){return t.load()}));return this._load=Promise.all(e).then((function(){var e=t.items[0],n=e.realWidth,i=e.realHeight;return t.resize(n,i),Promise.resolve(t)})),this._load},e}(mr),xr=function(t){function e(e,n){var i,r,o=this,s=n||{},a=s.width,l=s.height;return Array.isArray(e)?(i=e,r=e.length):r=e,o=t.call(this,r,{width:a,height:l})||this,i&&o.initFromArray(i,n),o}return dr(e,t),e.prototype.addBaseTextureAt=function(t,e){if(!t.resource)throw new Error("ArrayResource does not support RenderTexture");return this.addResourceAt(t.resource,e),this},e.prototype.bind=function(e){t.prototype.bind.call(this,e),e.target=Et.TEXTURE_2D_ARRAY},e.prototype.upload=function(t,e,n){var i=this,r=i.length,o=i.itemDirtyIds,s=i.items,a=t.gl;n.dirtyId<0&&a.texImage3D(a.TEXTURE_2D_ARRAY,0,n.internalFormat,this._width,this._height,r,0,e.format,n.type,null);for(var l=0;l<r;l++){var u=s[l];o[l]<u.dirtyId&&(o[l]=u.dirtyId,u.valid&&a.texSubImage3D(a.TEXTURE_2D_ARRAY,0,0,0,l,u.resource.width,u.resource.height,1,e.format,n.type,u.resource.source))}return!0},e}(_r),br=function(t){function e(e){var n=this,i=e,r=i.naturalWidth||i.videoWidth||i.width,o=i.naturalHeight||i.videoHeight||i.height;return(n=t.call(this,r,o)||this).source=e,n.noSubImage=!1,n}return dr(e,t),e.crossOrigin=function(t,e,n){void 0===n&&0!==e.indexOf("data:")?t.crossOrigin=di(e):!1!==n&&(t.crossOrigin="string"==typeof n?n:"anonymous")},e.prototype.upload=function(t,e,n,i){var r=t.gl,o=e.realWidth,s=e.realHeight;return i=i||this.source,r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===Ot.UNPACK),this.noSubImage||e.target!==r.TEXTURE_2D||n.width!==o||n.height!==s?(n.width=o,n.height=s,r.texImage2D(e.target,0,n.internalFormat,e.format,n.type,i)):r.texSubImage2D(r.TEXTURE_2D,0,0,0,e.format,n.type,i),!0},e.prototype.update=function(){if(!this.destroyed){var e=this.source,n=e.naturalWidth||e.videoWidth||e.width,i=e.naturalHeight||e.videoHeight||e.height;this.resize(n,i),t.prototype.update.call(this)}},e.prototype.dispose=function(){this.source=null},e}(mr),wr=function(t){function e(e){return t.call(this,e)||this}return dr(e,t),e.test=function(t){var e=self.OffscreenCanvas;return!!(e&&t instanceof e)||self.HTMLCanvasElement&&t instanceof HTMLCanvasElement},e}(br),Pr=function(t){function e(n,i){var r=this,o=i||{},s=o.width,a=o.height,l=o.autoLoad,u=o.linkBaseTexture;if(n&&n.length!==e.SIDES)throw new Error("Invalid length. Got "+n.length+", expected 6");r=t.call(this,6,{width:s,height:a})||this;for(var h=0;h<e.SIDES;h++)r.items[h].target=Et.TEXTURE_CUBE_MAP_POSITIVE_X+h;return r.linkBaseTexture=!1!==u,n&&r.initFromArray(n,i),!1!==l&&r.load(),r}return dr(e,t),e.prototype.bind=function(e){t.prototype.bind.call(this,e),e.target=Et.TEXTURE_CUBE_MAP},e.prototype.addBaseTextureAt=function(t,e,n){if(void 0===n&&(n=this.linkBaseTexture),!this.items[e])throw new Error("Index "+e+" is out of bounds");if(!this.linkBaseTexture||t.parentTextureArray||Object.keys(t._glTextures).length>0){if(!t.resource)throw new Error("CubeResource does not support copying of renderTexture.");this.addResourceAt(t.resource,e)}else t.target=Et.TEXTURE_CUBE_MAP_POSITIVE_X+e,t.parentTextureArray=this.baseTexture,this.items[e]=t;return t.valid&&!this.valid&&this.resize(t.realWidth,t.realHeight),this.items[e]=t,this},e.prototype.upload=function(t,n,i){for(var r=this.itemDirtyIds,o=0;o<e.SIDES;o++){var s=this.items[o];r[o]<s.dirtyId&&(s.valid&&s.resource?(s.resource.upload(t,s,i),r[o]=s.dirtyId):r[o]<-1&&(t.gl.texImage2D(s.target,0,i.internalFormat,n.realWidth,n.realHeight,0,n.format,i.type,null),r[o]=-1))}return!0},e.test=function(t){return Array.isArray(t)&&t.length===e.SIDES},e.SIDES=6,e}(_r),Er=function(t){function e(e,n){var i=this;if(n=n||{},!(e instanceof HTMLImageElement)){var r=new Image;br.crossOrigin(r,e,n.crossorigin),r.src=e,e=r}return i=t.call(this,e)||this,!e.complete&&!!i._width&&!!i._height&&(i._width=0,i._height=0),i.url=e.src,i._process=null,i.preserveBitmap=!1,i.createBitmap=(void 0!==n.createBitmap?n.createBitmap:xe.CREATE_IMAGE_BITMAP)&&!!self.createImageBitmap,i.alphaMode="number"==typeof n.alphaMode?n.alphaMode:null,i.bitmap=null,i._load=null,!1!==n.autoLoad&&i.load(),i}return dr(e,t),e.prototype.load=function(t){var e=this;return this._load||(void 0!==t&&(this.createBitmap=t),this._load=new Promise((function(t,n){var i=e.source;e.url=i.src;var r=function(){e.destroyed||(i.onload=null,i.onerror=null,e.resize(i.width,i.height),e._load=null,e.createBitmap?t(e.process()):t(e))};i.complete&&i.src?r():(i.onload=r,i.onerror=function(t){n(t),e.onError.emit(t)})}))),this._load},e.prototype.process=function(){var t=this,e=this.source;if(null!==this._process)return this._process;if(null!==this.bitmap||!self.createImageBitmap)return Promise.resolve(this);var n=self.createImageBitmap,i=!e.crossOrigin||"anonymous"===e.crossOrigin;return this._process=fetch(e.src,{mode:i?"cors":"no-cors"}).then((function(t){return t.blob()})).then((function(i){return n(i,0,0,e.width,e.height,{premultiplyAlpha:t.alphaMode===Ot.UNPACK?"premultiply":"none"})})).then((function(e){return t.destroyed?Promise.reject():(t.bitmap=e,t.update(),t._process=null,Promise.resolve(t))})),this._process},e.prototype.upload=function(e,n,i){if("number"==typeof this.alphaMode&&(n.alphaMode=this.alphaMode),!this.createBitmap)return t.prototype.upload.call(this,e,n,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(t.prototype.upload.call(this,e,n,i,this.bitmap),!this.preserveBitmap){var r=!0,o=n._glTextures;for(var s in o){var a=o[s];if(a!==i&&a.dirtyId!==n.dirtyId){r=!1;break}}r&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},e.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,t.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},e.test=function(t){return"string"==typeof t||t instanceof HTMLImageElement},e}(br),Tr=function(t){function e(e,n){var i=this;return n=n||{},(i=t.call(this,document.createElement("canvas"))||this)._width=0,i._height=0,i.svg=e,i.scale=n.scale||1,i._overrideWidth=n.width,i._overrideHeight=n.height,i._resolve=null,i._crossorigin=n.crossorigin,i._load=null,!1!==n.autoLoad&&i.load(),i}return dr(e,t),e.prototype.load=function(){var t=this;return this._load||(this._load=new Promise((function(n){if(t._resolve=function(){t.resize(t.source.width,t.source.height),n(t)},e.SVG_XML.test(t.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");t.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(t.svg)))}t._loadSvg()}))),this._load},e.prototype._loadSvg=function(){var t=this,e=new Image;br.crossOrigin(e,this.svg,this._crossorigin),e.src=this.svg,e.onerror=function(n){!t._resolve||(e.onerror=null,t.onError.emit(n))},e.onload=function(){if(t._resolve){var n=e.width,i=e.height;if(!n||!i)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var r=n*t.scale,o=i*t.scale;(t._overrideWidth||t._overrideHeight)&&(r=t._overrideWidth||t._overrideHeight/i*n,o=t._overrideHeight||t._overrideWidth/n*i),r=Math.round(r),o=Math.round(o);var s=t.source;s.width=r,s.height=o,s._pixiId="canvas_"+ni(),s.getContext("2d").drawImage(e,0,0,n,i,0,0,r,o),t._resolve(),t._resolve=null}}},e.getSize=function(t){var n=e.SVG_SIZE.exec(t),i={};return n&&(i[n[1]]=Math.round(parseFloat(n[3])),i[n[5]]=Math.round(parseFloat(n[7]))),i},e.prototype.dispose=function(){t.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},e.test=function(t,n){return"svg"===n||"string"==typeof t&&/^data:image\/svg\+xml(;(charset=utf8|utf8))?;base64/.test(t)||"string"==typeof t&&e.SVG_XML.test(t)},e.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,e.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i,e}(br),Sr=function(t){function e(n,i){var r=this;if(i=i||{},!(n instanceof HTMLVideoElement)){var o=document.createElement("video");o.setAttribute("preload","auto"),o.setAttribute("webkit-playsinline",""),o.setAttribute("playsinline",""),"string"==typeof n&&(n=[n]);var s=n[0].src||n[0];br.crossOrigin(o,s,i.crossorigin);for(var a=0;a<n.length;++a){var l=document.createElement("source"),u=n[a],h=u.src,c=u.mime,p=(h=h||n[a]).split("?").shift().toLowerCase(),d=p.substr(p.lastIndexOf(".")+1);c=c||e.MIME_TYPES[d]||"video/"+d,l.src=h,l.type=c,o.appendChild(l)}n=o}return(r=t.call(this,n)||this).noSubImage=!0,r._autoUpdate=!0,r._isConnectedToTicker=!1,r._updateFPS=i.updateFPS||0,r._msToNextUpdate=0,r.autoPlay=!1!==i.autoPlay,r._load=null,r._resolve=null,r._onCanPlay=r._onCanPlay.bind(r),r._onError=r._onError.bind(r),!1!==i.autoLoad&&r.load(),r}return dr(e,t),e.prototype.update=function(e){if(!this.destroyed){var n=we.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-n),(!this._updateFPS||this._msToNextUpdate<=0)&&(t.prototype.update.call(this),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},e.prototype.load=function(){var t=this;if(this._load)return this._load;var e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart.bind(this)),e.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay),e.addEventListener("error",this._onError,!0)),this._load=new Promise((function(n){t.valid?n(t):(t._resolve=n,e.load())})),this._load},e.prototype._onError=function(t){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(t)},e.prototype._isSourcePlaying=function(){var t=this.source;return t.currentTime>0&&!1===t.paused&&!1===t.ended&&t.readyState>2},e.prototype._isSourceReady=function(){var t=this.source;return 3===t.readyState||4===t.readyState},e.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(we.shared.add(this.update,this),this._isConnectedToTicker=!0)},e.prototype._onPlayStop=function(){this._isConnectedToTicker&&(we.shared.remove(this.update,this),this._isConnectedToTicker=!1)},e.prototype._onCanPlay=function(){var t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);var e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()},e.prototype.dispose=function(){this._isConnectedToTicker&&(we.shared.remove(this.update,this),this._isConnectedToTicker=!1);var e=this.source;e&&(e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),t.prototype.dispose.call(this)},Object.defineProperty(e.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(we.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(we.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"updateFPS",{get:function(){return this._updateFPS},set:function(t){t!==this._updateFPS&&(this._updateFPS=t)},enumerable:!1,configurable:!0}),e.test=function(t,n){return self.HTMLVideoElement&&t instanceof HTMLVideoElement||e.TYPES.indexOf(n)>-1},e.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],e.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"},e}(br),Cr=function(t){function e(e){return t.call(this,e)||this}return dr(e,t),e.test=function(t){return!!self.createImageBitmap&&t instanceof ImageBitmap},e}(br);hr.push(Er,Cr,wr,Sr,Tr,yr,Pr,xr);var Ir=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return dr(e,t),e.prototype.upload=function(t,e,n){var i=t.gl;i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===Ot.UNPACK);var r=e.realWidth,o=e.realHeight;return n.width===r&&n.height===o?i.texSubImage2D(e.target,0,0,0,r,o,e.format,n.type,this.data):(n.width=r,n.height=o,i.texImage2D(e.target,0,n.internalFormat,r,o,0,e.format,n.type,this.data)),!0},e}(yr),Ar=function(){function t(t,e){this.width=Math.round(t||100),this.height=Math.round(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new ur("disposeFramebuffer"),this.multisample=kt.NONE}return Object.defineProperty(t.prototype,"colorTexture",{get:function(){return this.colorTextures[0]},enumerable:!1,configurable:!0}),t.prototype.addColorTexture=function(t,e){return void 0===t&&(t=0),this.colorTextures[t]=e||new vr(null,{scaleMode:Ct.NEAREST,resolution:1,mipmap:At.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},t.prototype.addDepthTexture=function(t){return this.depthTexture=t||new vr(new Ir(null,{width:this.width,height:this.height}),{scaleMode:Ct.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:At.OFF,format:Pt.DEPTH_COMPONENT,type:Tt.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},t.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},t.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},t.prototype.resize=function(t,e){if(t=Math.round(t),e=Math.round(e),t!==this.width||e!==this.height){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(var n=0;n<this.colorTextures.length;n++){var i=this.colorTextures[n],r=i.resolution;i.setSize(t/r,e/r)}this.depthTexture&&(r=this.depthTexture.resolution,this.depthTexture.setSize(t/r,e/r))}},t.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},t.prototype.destroyDepthTexture=function(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)},t}(),Or=function(t){function e(e){var n=this;return"number"==typeof e&&(e={width:arguments[0],height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]}),e.width=e.width||100,e.height=e.height||100,e.multisample=void 0!==e.multisample?e.multisample:kt.NONE,(n=t.call(this,null,e)||this).mipmap=At.OFF,n.valid=!0,n.clearColor=[0,0,0,0],n.framebuffer=new Ar(n.realWidth,n.realHeight).addColorTexture(0,n),n.framebuffer.multisample=e.multisample,n.maskStack=[],n.filterStack=[{}],n}return dr(e,t),e.prototype.resize=function(t,e){this.framebuffer.resize(t*this.resolution,e*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)},e.prototype.dispose=function(){this.framebuffer.dispose(),t.prototype.dispose.call(this)},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.framebuffer.destroyDepthTexture(),this.framebuffer=null},e}(vr),Nr=function(){function t(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}return t.prototype.set=function(t,e,n){var i=e.width,r=e.height;if(n){var o=t.width/2/i,s=t.height/2/r,a=t.x/i+o,l=t.y/r+s;n=ki.add(n,ki.NW),this.x0=a+o*ki.uX(n),this.y0=l+s*ki.uY(n),n=ki.add(n,2),this.x1=a+o*ki.uX(n),this.y1=l+s*ki.uY(n),n=ki.add(n,2),this.x2=a+o*ki.uX(n),this.y2=l+s*ki.uY(n),n=ki.add(n,2),this.x3=a+o*ki.uX(n),this.y3=l+s*ki.uY(n)}else this.x0=t.x/i,this.y0=t.y/r,this.x1=(t.x+t.width)/i,this.y1=t.y/r,this.x2=(t.x+t.width)/i,this.y2=(t.y+t.height)/r,this.x3=t.x/i,this.y3=(t.y+t.height)/r;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3},t.prototype.toString=function(){return"[@pixi/core:TextureUvs x0="+this.x0+" y0="+this.y0+" x1="+this.x1+" y1="+this.y1+" x2="+this.x2+" y2="+this.y2+" x3="+this.x3+" y3="+this.y3+"]"},t}(),Lr=new Nr,Mr=function(t){function e(n,i,r,o,s,a){var l=t.call(this)||this;if(l.noFrame=!1,i||(l.noFrame=!0,i=new xi(0,0,1,1)),n instanceof e&&(n=n.baseTexture),l.baseTexture=n,l._frame=i,l.trim=o,l.valid=!1,l._uvs=Lr,l.uvMatrix=null,l.orig=r||i,l._rotate=Number(s||0),!0===s)l._rotate=2;else if(l._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");return l.defaultAnchor=a?new Ti(a.x,a.y):new Ti(0,0),l._updateID=0,l.textureCacheIds=[],n.valid?l.noFrame?n.valid&&l.onBaseTextureUpdated(n):l.frame=i:n.once("loaded",l.onBaseTextureUpdated,l),l.noFrame&&n.on("update",l.onBaseTextureUpdated,l),l}return dr(e,t),e.prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},e.prototype.onBaseTextureUpdated=function(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},e.prototype.destroy=function(t){if(this.baseTexture){if(t){var n=this.baseTexture.resource;n&&n.url&&si[n.url]&&e.removeFromCache(n.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,e.removeFromCache(this),this.textureCacheIds=null},e.prototype.clone=function(){var t=this._frame.clone(),n=this._frame===this.orig?t:this.orig.clone(),i=new e(this.baseTexture,!this.noFrame&&t,n,this.trim&&this.trim.clone(),this.rotate,this.defaultAnchor);return this.noFrame&&(i._frame=t),i},e.prototype.updateUvs=function(){this._uvs===Lr&&(this._uvs=new Nr),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},e.from=function(t,n,i){void 0===n&&(n={}),void 0===i&&(i=xe.STRICT_TEXTURE_CACHE);var r="string"==typeof t,o=null;if(r)o=t;else if(t instanceof vr){if(!t.cacheId){var s=n&&n.pixiIdPrefix||"pixiid";t.cacheId=s+"-"+ni(),vr.addToCache(t,t.cacheId)}o=t.cacheId}else t._pixiId||(s=n&&n.pixiIdPrefix||"pixiid",t._pixiId=s+"_"+ni()),o=t._pixiId;var a=si[o];if(r&&i&&!a)throw new Error('The cacheId "'+o+'" does not exist in TextureCache.');return a||t instanceof vr?!a&&t instanceof vr&&(a=new e(t),e.addToCache(a,o)):(n.resolution||(n.resolution=fi(t)),(a=new e(new vr(t,n))).baseTexture.cacheId=o,vr.addToCache(a.baseTexture,o),e.addToCache(a,o)),a},e.fromURL=function(t,n){var i=Object.assign({autoLoad:!1},n?.resourceOptions),r=e.from(t,Object.assign({resourceOptions:i},n),!1),o=r.baseTexture.resource;return r.baseTexture.valid?Promise.resolve(r):o.load().then((function(){return Promise.resolve(r)}))},e.fromBuffer=function(t,n,i,r){return new e(vr.fromBuffer(t,n,i,r))},e.fromLoader=function(t,n,i,r){var o=new vr(t,Object.assign({scaleMode:xe.SCALE_MODE,resolution:fi(n)},r)),s=o.resource;s instanceof Er&&(s.url=n);var a=new e(o);return i||(i=n),vr.addToCache(a.baseTexture,i),e.addToCache(a,i),i!==n&&(vr.addToCache(a.baseTexture,n),e.addToCache(a,n)),a.baseTexture.valid?Promise.resolve(a):new Promise((function(t){a.baseTexture.once("loaded",(function(){return t(a)}))}))},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),si[e]&&console.warn("Texture added to the cache with an id ["+e+"] that already had an entry"),si[e]=t)},e.removeFromCache=function(t){if("string"==typeof t){var e=si[t];if(e){var n=e.textureCacheIds.indexOf(t);return n>-1&&e.textureCacheIds.splice(n,1),delete si[t],e}}else if(t&&t.textureCacheIds){for(var i=0;i<t.textureCacheIds.length;++i)si[t.textureCacheIds[i]]===t&&delete si[t.textureCacheIds[i]];return t.textureCacheIds.length=0,t}return null},Object.defineProperty(e.prototype,"resolution",{get:function(){return this.baseTexture.resolution},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"frame",{get:function(){return this._frame},set:function(t){this._frame=t,this.noFrame=!1;var e=t.x,n=t.y,i=t.width,r=t.height,o=e+i>this.baseTexture.width,s=n+r>this.baseTexture.height;if(o||s){var a=o&&s?"and":"or",l="X: "+e+" + "+i+" = "+(e+i)+" > "+this.baseTexture.width,u="Y: "+n+" + "+r+" = "+(n+r)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+l+" "+a+" "+u)}this.valid=i&&r&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=t),this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotate",{get:function(){return this._rotate},set:function(t){this._rotate=t,this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.orig.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.orig.height},enumerable:!1,configurable:!0}),e.prototype.castToBaseTexture=function(){return this.baseTexture},e}(Ee);function Rr(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}Mr.EMPTY=new Mr(new vr),Rr(Mr.EMPTY),Rr(Mr.EMPTY.baseTexture),Mr.WHITE=function(){var t=document.createElement("canvas");t.width=16,t.height=16;var e=t.getContext("2d");return e.fillStyle="white",e.fillRect(0,0,16,16),new Mr(new vr(new wr(t)))}(),Rr(Mr.WHITE),Rr(Mr.WHITE.baseTexture);var kr=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.valid=!0,i.filterFrame=null,i.filterPoolKey=null,i.updateUvs(),i}return dr(e,t),Object.defineProperty(e.prototype,"framebuffer",{get:function(){return this.baseTexture.framebuffer},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"multisample",{get:function(){return this.framebuffer.multisample},set:function(t){this.framebuffer.multisample=t},enumerable:!1,configurable:!0}),e.prototype.resize=function(t,e,n){void 0===n&&(n=!0);var i=this.baseTexture.resolution,r=Math.round(t*i)/i,o=Math.round(e*i)/i;this.valid=r>0&&o>0,this._frame.width=this.orig.width=r,this._frame.height=this.orig.height=o,n&&this.baseTexture.resize(r,o),this.updateUvs()},e.prototype.setResolution=function(t){var e=this.baseTexture;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))},e.create=function(t){for(var n=arguments,i=[],r=1;r<arguments.length;r++)i[r-1]=n[r];return"number"==typeof t&&(ri("6.0.0","Arguments (width, height, scaleMode, resolution) have been deprecated."),t={width:t,height:i[0],scaleMode:i[1],resolution:i[2]}),new e(new Or(t))},e}(Mr),Dr=function(){function t(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}return t.prototype.createTexture=function(t,e,n){void 0===n&&(n=kt.NONE);var i=new Or(Object.assign({width:t,height:e,resolution:1,multisample:n},this.textureOptions));return new kr(i)},t.prototype.getOptimalTexture=function(t,e,n,i){var r;void 0===n&&(n=1),void 0===i&&(i=kt.NONE),t=Math.ceil(t*n),e=Math.ceil(e*n),this.enableFullScreen&&t===this._pixelsWidth&&e===this._pixelsHeight?r=i>1?-i:-1:(r=((65535&(t=Zn(t)))<<16|65535&(e=Zn(e)))>>>0,i>1&&(r+=4294967296*i)),this.texturePool[r]||(this.texturePool[r]=[]);var o=this.texturePool[r].pop();return o||(o=this.createTexture(t,e,i)),o.filterPoolKey=r,o.setResolution(n),o},t.prototype.getFilterTexture=function(t,e,n){var i=this.getOptimalTexture(t.width,t.height,e||t.resolution,n||kt.NONE);return i.filterFrame=t.filterFrame,i},t.prototype.returnTexture=function(t){var e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)},t.prototype.returnFilterTexture=function(t){this.returnTexture(t)},t.prototype.clear=function(t){if(t=!1!==t)for(var e in this.texturePool){var n=this.texturePool[e];if(n)for(var i=0;i<n.length;i++)n[i].destroy(!0)}this.texturePool={}},t.prototype.setScreenSize=function(t){if(t.width!==this._pixelsWidth||t.height!==this._pixelsHeight){for(var e in this.enableFullScreen=t.width>0&&t.height>0,this.texturePool)if(Number(e)<0){var n=this.texturePool[e];if(n)for(var i=0;i<n.length;i++)n[i].destroy(!0);this.texturePool[e]=[]}this._pixelsWidth=t.width,this._pixelsHeight=t.height}},t.SCREEN_KEY=-1,t}(),Fr=function(){function t(t,e,n,i,r,o,s){void 0===e&&(e=0),void 0===n&&(n=!1),void 0===i&&(i=Tt.FLOAT),this.buffer=t,this.size=e,this.normalized=n,this.type=i,this.stride=r,this.start=o,this.instance=s}return t.prototype.destroy=function(){this.buffer=null},t.from=function(e,n,i,r,o){return new t(e,n,i,r,o)},t}(),Br=0,Ur=function(){function t(t,e,n){void 0===e&&(e=!0),void 0===n&&(n=!1),this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=n,this.static=e,this.id=Br++,this.disposeRunner=new ur("disposeBuffer")}return t.prototype.update=function(t){t instanceof Array&&(t=new Float32Array(t)),this.data=t||this.data,this._updateID++},t.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},t.prototype.destroy=function(){this.dispose(),this.data=null},Object.defineProperty(t.prototype,"index",{get:function(){return this.type===Dt.ELEMENT_ARRAY_BUFFER},set:function(t){this.type=t?Dt.ELEMENT_ARRAY_BUFFER:Dt.ARRAY_BUFFER},enumerable:!1,configurable:!0}),t.from=function(e){return e instanceof Array&&(e=new Float32Array(e)),new t(e)},t}(),zr={Float32Array,Uint32Array,Int32Array,Uint8Array},Xr={5126:4,5123:2,5121:1},Yr=0,Gr={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array},Hr=function(){function t(t,e){void 0===t&&(t=[]),void 0===e&&(e={}),this.buffers=t,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=Yr++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new ur("disposeGeometry"),this.refCount=0}return t.prototype.addAttribute=function(t,e,n,i,r,o,s,a){if(void 0===n&&(n=0),void 0===i&&(i=!1),void 0===a&&(a=!1),!e)throw new Error("You must pass a buffer when creating an attribute");e instanceof Ur||(e instanceof Array&&(e=new Float32Array(e)),e=new Ur(e));var l=t.split("|");if(l.length>1){for(var u=0;u<l.length;u++)this.addAttribute(l[u],e,n,i,r);return this}var h=this.buffers.indexOf(e);return-1===h&&(this.buffers.push(e),h=this.buffers.length-1),this.attributes[t]=new Fr(h,n,i,r,o,s,a),this.instanced=this.instanced||a,this},t.prototype.getAttribute=function(t){return this.attributes[t]},t.prototype.getBuffer=function(t){return this.buffers[this.getAttribute(t).buffer]},t.prototype.addIndex=function(t){return t instanceof Ur||(t instanceof Array&&(t=new Uint16Array(t)),t=new Ur(t)),t.type=Dt.ELEMENT_ARRAY_BUFFER,this.indexBuffer=t,-1===this.buffers.indexOf(t)&&this.buffers.push(t),this},t.prototype.getIndex=function(){return this.indexBuffer},t.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var t,e=[],n=[],i=new Ur;for(t in this.attributes){var r=this.attributes[t],o=this.buffers[r.buffer];e.push(o.data),n.push(r.size*Xr[r.type]/4),r.buffer=0}for(i.data=function(t,e){for(var n=0,i=0,r={},o=0;o<t.length;o++)i+=e[o],n+=t[o].length;var s=new ArrayBuffer(4*n),a=null,l=0;for(o=0;o<t.length;o++){var u=e[o],h=t[o],c=qn(h);r[c]||(r[c]=new zr[c](s)),a=r[c];for(var p=0;p<h.length;p++)a[(p/u|0)*i+l+p%u]=h[p];l+=u}return new Float32Array(s)}(e,n),t=0;t<this.buffers.length;t++)this.buffers[t]!==this.indexBuffer&&this.buffers[t].destroy();return this.buffers=[i],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},t.prototype.getSize=function(){for(var t in this.attributes){var e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0},t.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},t.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},t.prototype.clone=function(){for(var e=new t,n=0;n<this.buffers.length;n++)e.buffers[n]=new Ur(this.buffers[n].data.slice(0));for(var n in this.attributes){var i=this.attributes[n];e.attributes[n]=new Fr(i.buffer,i.size,i.normalized,i.type,i.stride,i.start,i.instance)}return this.indexBuffer&&(e.indexBuffer=e.buffers[this.buffers.indexOf(this.indexBuffer)],e.indexBuffer.type=Dt.ELEMENT_ARRAY_BUFFER),e},t.merge=function(e){for(var n,i=new t,r=[],o=[],s=[],a=0;a<e.length;a++){n=e[a];for(var l=0;l<n.buffers.length;l++)o[l]=o[l]||0,o[l]+=n.buffers[l].data.length,s[l]=0}for(a=0;a<n.buffers.length;a++)r[a]=new(Gr[qn(n.buffers[a].data)])(o[a]),i.buffers[a]=new Ur(r[a]);for(a=0;a<e.length;a++)for(n=e[a],l=0;l<n.buffers.length;l++)r[l].set(n.buffers[l].data,s[l]),s[l]+=n.buffers[l].data.length;if(i.attributes=n.attributes,n.indexBuffer){i.indexBuffer=i.buffers[n.buffers.indexOf(n.indexBuffer)],i.indexBuffer.type=Dt.ELEMENT_ARRAY_BUFFER;var u=0,h=0,c=0,p=0;for(a=0;a<n.buffers.length;a++)if(n.buffers[a]!==n.indexBuffer){p=a;break}for(var a in n.attributes){var d=n.attributes[a];(0|d.buffer)===p&&(h+=d.size*Xr[d.type]/4)}for(a=0;a<e.length;a++){var f=e[a].indexBuffer.data;for(l=0;l<f.length;l++)i.indexBuffer.data[l+c]+=u;u+=e[a].buffers[p].data.length/h,c+=f.length}}return i},t}(),Wr=function(t){function e(){var e=t.call(this)||this;return e.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2]),e}return dr(e,t),e}(Hr),jr=function(t){function e(){var e=t.call(this)||this;return e.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),e.uvs=new Float32Array([0,0,1,0,1,1,0,1]),e.vertexBuffer=new Ur(e.vertices),e.uvBuffer=new Ur(e.uvs),e.addAttribute("aVertexPosition",e.vertexBuffer).addAttribute("aTextureCoord",e.uvBuffer).addIndex([0,1,2,0,2,3]),e}return dr(e,t),e.prototype.map=function(t,e){var n=0,i=0;return this.uvs[0]=n,this.uvs[1]=i,this.uvs[2]=n+e.width/t.width,this.uvs[3]=i,this.uvs[4]=n+e.width/t.width,this.uvs[5]=i+e.height/t.height,this.uvs[6]=n,this.uvs[7]=i+e.height/t.height,n=e.x,i=e.y,this.vertices[0]=n,this.vertices[1]=i,this.vertices[2]=n+e.width,this.vertices[3]=i,this.vertices[4]=n+e.width,this.vertices[5]=i+e.height,this.vertices[6]=n,this.vertices[7]=i+e.height,this.invalidate(),this},e.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},e}(Hr),Vr=0,qr=function(){function t(t,e,n){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=Vr++,this.static=!!e,this.ubo=!!n,t instanceof Ur?(this.buffer=t,this.buffer.type=Dt.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=t,this.ubo&&(this.buffer=new Ur(new Float32Array(1)),this.buffer.type=Dt.UNIFORM_BUFFER,this.autoManage=!0))}return t.prototype.update=function(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()},t.prototype.add=function(e,n,i){if(this.ubo)throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them");this.uniforms[e]=new t(n,i)},t.from=function(e,n,i){return new t(e,n,i)},t.uboFrom=function(e,n){return new t(e,n??!0,!0)},t}(),$r=function(){function t(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=kt.NONE,this.sourceFrame=new xi,this.destinationFrame=new xi,this.bindingSourceFrame=new xi,this.bindingDestinationFrame=new xi,this.filters=[],this.transform=null}return t.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null},t}(),Zr=[new Ti,new Ti,new Ti,new Ti],Kr=new Ci,Qr=function(){function t(t){this.renderer=t,this.defaultFilterStack=[{}],this.texturePool=new Dr,this.texturePool.setScreenSize(t.view),this.statePool=[],this.quad=new Wr,this.quadUv=new jr,this.tempRect=new xi,this.activeState={},this.globalUniforms=new qr({outputFrame:new xi,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}return t.prototype.push=function(t,e){for(var n,i,r=this.renderer,o=this.defaultFilterStack,s=this.statePool.pop()||new $r,a=this.renderer.renderTexture,l=e[0].resolution,u=e[0].multisample,h=e[0].padding,c=e[0].autoFit,p=null===(n=e[0].legacy)||void 0===n||n,d=1;d<e.length;d++){var f=e[d];l=Math.min(l,f.resolution),u=Math.min(u,f.multisample),h=this.useMaxPadding?Math.max(h,f.padding):h+f.padding,c=c&&f.autoFit,p=p||null===(i=f.legacy)||void 0===i||i}if(1===o.length&&(this.defaultFilterStack[0].renderTexture=a.current),o.push(s),s.resolution=l,s.multisample=u,s.legacy=p,s.target=t,s.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),s.sourceFrame.pad(h),c){var m=this.tempRect.copyFrom(a.sourceFrame);r.projection.transform&&this.transformAABB(Kr.copyFrom(r.projection.transform).invert(),m),s.sourceFrame.fit(m)}this.roundFrame(s.sourceFrame,a.current?a.current.resolution:r.resolution,a.sourceFrame,a.destinationFrame,r.projection.transform),s.renderTexture=this.getOptimalFilterTexture(s.sourceFrame.width,s.sourceFrame.height,l,u),s.filters=e,s.destinationFrame.width=s.renderTexture.width,s.destinationFrame.height=s.renderTexture.height;var y=this.tempRect;y.x=0,y.y=0,y.width=s.sourceFrame.width,y.height=s.sourceFrame.height,s.renderTexture.filterFrame=s.sourceFrame,s.bindingSourceFrame.copyFrom(a.sourceFrame),s.bindingDestinationFrame.copyFrom(a.destinationFrame),s.transform=r.projection.transform,r.projection.transform=null,a.bind(s.renderTexture,s.sourceFrame,y),r.framebuffer.clear(0,0,0,0)},t.prototype.pop=function(){var t=this.defaultFilterStack,e=t.pop(),n=e.filters;this.activeState=e;var i=this.globalUniforms.uniforms;i.outputFrame=e.sourceFrame,i.resolution=e.resolution;var r=i.inputSize,o=i.inputPixel,s=i.inputClamp;if(r[0]=e.destinationFrame.width,r[1]=e.destinationFrame.height,r[2]=1/r[0],r[3]=1/r[1],o[0]=Math.round(r[0]*e.resolution),o[1]=Math.round(r[1]*e.resolution),o[2]=1/o[0],o[3]=1/o[1],s[0]=.5*o[2],s[1]=.5*o[3],s[2]=e.sourceFrame.width*r[2]-.5*o[2],s[3]=e.sourceFrame.height*r[3]-.5*o[3],e.legacy){var a=i.filterArea;a[0]=e.destinationFrame.width,a[1]=e.destinationFrame.height,a[2]=e.sourceFrame.x,a[3]=e.sourceFrame.y,i.filterClamp=i.inputClamp}this.globalUniforms.update();var l=t[t.length-1];if(this.renderer.framebuffer.blit(),1===n.length)n[0].apply(this,e.renderTexture,l.renderTexture,Nt.BLEND,e),this.returnFilterTexture(e.renderTexture);else{var u=e.renderTexture,h=this.getOptimalFilterTexture(u.width,u.height,e.resolution);h.filterFrame=u.filterFrame;var c=0;for(c=0;c<n.length-1;++c){1===c&&e.multisample>1&&((h=this.getOptimalFilterTexture(u.width,u.height,e.resolution)).filterFrame=u.filterFrame),n[c].apply(this,u,h,Nt.CLEAR,e);var p=u;u=h,h=p}n[c].apply(this,u,l.renderTexture,Nt.BLEND,e),c>1&&e.multisample>1&&this.returnFilterTexture(e.renderTexture),this.returnFilterTexture(u),this.returnFilterTexture(h)}e.clear(),this.statePool.push(e)},t.prototype.bindAndClear=function(t,e){void 0===e&&(e=Nt.CLEAR);var n=this.renderer,i=n.renderTexture,r=n.state;if(t===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,t&&t.filterFrame){var o=this.tempRect;o.x=0,o.y=0,o.width=t.filterFrame.width,o.height=t.filterFrame.height,i.bind(t,t.filterFrame,o)}else t!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?i.bind(t):this.renderer.renderTexture.bind(t,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);var s=1&r.stateId||this.forceClear;(e===Nt.CLEAR||e===Nt.BLIT&&s)&&this.renderer.framebuffer.clear(0,0,0,0)},t.prototype.applyFilter=function(t,e,n,i){var r=this.renderer;r.state.set(t.state),this.bindAndClear(n,i),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,r.shader.bind(t),t.legacy=!!t.program.attributeData.aTextureCoord,t.legacy?(this.quadUv.map(e._frame,e.filterFrame),r.geometry.bind(this.quadUv),r.geometry.draw(wt.TRIANGLES)):(r.geometry.bind(this.quad),r.geometry.draw(wt.TRIANGLE_STRIP))},t.prototype.calculateSpriteMatrix=function(t,e){var n=this.activeState,i=n.sourceFrame,r=n.destinationFrame,o=e._texture.orig,s=t.set(r.width,0,0,r.height,i.x,i.y),a=e.worldTransform.copyTo(Ci.TEMP_MATRIX);return a.invert(),s.prepend(a),s.scale(1/o.width,1/o.height),s.translate(e.anchor.x,e.anchor.y),s},t.prototype.destroy=function(){this.renderer=null,this.texturePool.clear(!1)},t.prototype.getOptimalFilterTexture=function(t,e,n,i){return void 0===n&&(n=1),void 0===i&&(i=kt.NONE),this.texturePool.getOptimalTexture(t,e,n,i)},t.prototype.getFilterTexture=function(t,e,n){if("number"==typeof t){var i=t;t=e,e=i}t=t||this.activeState.renderTexture;var r=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution,n||kt.NONE);return r.filterFrame=t.filterFrame,r},t.prototype.returnFilterTexture=function(t){this.texturePool.returnTexture(t)},t.prototype.emptyPool=function(){this.texturePool.clear(!0)},t.prototype.resize=function(){this.texturePool.setScreenSize(this.renderer.view)},t.prototype.transformAABB=function(t,e){var n=Zr[0],i=Zr[1],r=Zr[2],o=Zr[3];n.set(e.left,e.top),i.set(e.left,e.bottom),r.set(e.right,e.top),o.set(e.right,e.bottom),t.apply(n,n),t.apply(i,i),t.apply(r,r),t.apply(o,o);var s=Math.min(n.x,i.x,r.x,o.x),a=Math.min(n.y,i.y,r.y,o.y),l=Math.max(n.x,i.x,r.x,o.x),u=Math.max(n.y,i.y,r.y,o.y);e.x=s,e.y=a,e.width=l-s,e.height=u-a},t.prototype.roundFrame=function(t,e,n,i,r){if(!(t.width<=0||t.height<=0||n.width<=0||n.height<=0)){if(r){var o=r.a,s=r.b,a=r.c,l=r.d;if((Math.abs(s)>1e-4||Math.abs(a)>1e-4)&&(Math.abs(o)>1e-4||Math.abs(l)>1e-4))return}(r=r?Kr.copyFrom(r):Kr.identity()).translate(-n.x,-n.y).scale(i.width/n.width,i.height/n.height).translate(i.x,i.y),this.transformAABB(r,t),t.ceil(e),this.transformAABB(r.invert(),t)}},t}(),Jr=function(){function t(t){this.renderer=t}return t.prototype.flush=function(){},t.prototype.destroy=function(){this.renderer=null},t.prototype.start=function(){},t.prototype.stop=function(){this.flush()},t.prototype.render=function(t){},t}(),to=function(){function t(t){this.renderer=t,this.emptyRenderer=new Jr(t),this.currentRenderer=this.emptyRenderer}return t.prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},t.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},t.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},t.prototype.copyBoundTextures=function(t,e){for(var n=this.renderer.texture.boundTextures,i=e-1;i>=0;--i)t[i]=n[i]||null,t[i]&&(t[i]._batchLocation=i)},t.prototype.boundArray=function(t,e,n,i){for(var r=t.elements,o=t.ids,s=t.count,a=0,l=0;l<s;l++){var u=r[l],h=u._batchLocation;if(h>=0&&h<i&&e[h]===u)o[l]=h;else for(;a<i;){var c=e[a];if(!c||c._batchEnabled!==n||c._batchLocation!==a){o[l]=a,u._batchLocation=a,e[a]=u;break}a++}}},t.prototype.destroy=function(){this.renderer=null},t}(),eo=0,no=function(){function t(t){this.renderer=t,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),t.view.addEventListener("webglcontextlost",this.handleContextLost,!1),t.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}return Object.defineProperty(t.prototype,"isLost",{get:function(){return!this.gl||this.gl.isContextLost()},enumerable:!1,configurable:!0}),t.prototype.contextChange=function(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=eo++,t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension("WEBGL_lose_context").restoreContext()},t.prototype.initFromContext=function(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=eo++,this.renderer.runners.contextChange.emit(t)},t.prototype.initFromOptions=function(t){var e=this.createContext(this.renderer.view,t);this.initFromContext(e)},t.prototype.createContext=function(t,e){var n;if(xe.PREFER_ENV>=vt.WEBGL2&&(n=t.getContext("webgl2",e)),n)this.webGLVersion=2;else if(this.webGLVersion=1,!(n=t.getContext("webgl",e)||t.getContext("experimental-webgl",e)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=n,this.getExtensions(),this.gl},t.prototype.getExtensions=function(){var t=this.gl,e={anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc")};1===this.webGLVersion?Object.assign(this.extensions,e,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),loseContext:t.getExtension("WEBGL_lose_context"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,e,{colorBufferFloat:t.getExtension("EXT_color_buffer_float")})},t.prototype.handleContextLost=function(t){t.preventDefault()},t.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.emit(this.gl)},t.prototype.destroy=function(){var t=this.renderer.view;this.renderer=null,t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},t.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},t.prototype.validateContext=function(t){var e=t.getContextAttributes(),n="WebGL2RenderingContext"in self&&t instanceof self.WebGL2RenderingContext;n&&(this.webGLVersion=2),e.stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");var i=n||!!t.getExtension("OES_element_index_uint");this.supports.uint32Indices=i,i||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")},t}(),io=function(t){this.framebuffer=t,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=kt.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0},ro=new xi,oo=function(){function t(t){this.renderer=t,this.managedFramebuffers=[],this.unknownFramebuffer=new Ar(10,10),this.msaaSamples=null}return t.prototype.contextChange=function(){var t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new xi,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){var e=this.renderer.context.extensions.drawBuffers,n=this.renderer.context.extensions.depthTexture;xe.PREFER_ENV===vt.WEBGL_LEGACY&&(e=null,n=null),e?t.drawBuffers=function(t){return e.drawBuffersWEBGL(t)}:(this.hasMRT=!1,t.drawBuffers=function(){}),n||(this.writeDepthTexture=!1)}else this.msaaSamples=t.getInternalformatParameter(t.RENDERBUFFER,t.RGBA8,t.SAMPLES)},t.prototype.bind=function(t,e,n){void 0===n&&(n=0);var i=this.gl;if(t){var r=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,i.bindFramebuffer(i.FRAMEBUFFER,r.framebuffer)),r.mipLevel!==n&&(t.dirtyId++,t.dirtyFormat++,r.mipLevel=n),r.dirtyId!==t.dirtyId&&(r.dirtyId=t.dirtyId,r.dirtyFormat!==t.dirtyFormat?(r.dirtyFormat=t.dirtyFormat,r.dirtySize=t.dirtySize,this.updateFramebuffer(t,n)):r.dirtySize!==t.dirtySize&&(r.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(var o=0;o<t.colorTextures.length;o++){var s=t.colorTextures[o];this.renderer.texture.unbind(s.parentTextureArray||s)}if(t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e){var a=e.width>>n,l=e.height>>n,u=a/e.width;this.setViewport(e.x*u,e.y*u,a,l)}else a=t.width>>n,l=t.height>>n,this.setViewport(0,0,a,l)}else this.current&&(this.current=null,i.bindFramebuffer(i.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},t.prototype.setViewport=function(t,e,n,i){var r=this.viewport;t=Math.round(t),e=Math.round(e),n=Math.round(n),i=Math.round(i),(r.width!==n||r.height!==i||r.x!==t||r.y!==e)&&(r.x=t,r.y=e,r.width=n,r.height=i,this.gl.viewport(t,e,n,i))},Object.defineProperty(t.prototype,"size",{get:function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},enumerable:!1,configurable:!0}),t.prototype.clear=function(t,e,n,i,r){void 0===r&&(r=xt.COLOR|xt.DEPTH);var o=this.gl;o.clearColor(t,e,n,i),o.clear(r)},t.prototype.initFramebuffer=function(t){var e=this.gl,n=new io(e.createFramebuffer());return n.multisample=this.detectSamples(t.multisample),t.glFramebuffers[this.CONTEXT_UID]=n,this.managedFramebuffers.push(t),t.disposeRunner.add(this),n},t.prototype.resizeFramebuffer=function(t){var e=this.gl,n=t.glFramebuffers[this.CONTEXT_UID];n.msaaBuffer&&(e.bindRenderbuffer(e.RENDERBUFFER,n.msaaBuffer),e.renderbufferStorageMultisample(e.RENDERBUFFER,n.multisample,e.RGBA8,t.width,t.height)),n.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,n.stencil),n.msaaBuffer?e.renderbufferStorageMultisample(e.RENDERBUFFER,n.multisample,e.DEPTH24_STENCIL8,t.width,t.height):e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));var i=t.colorTextures,r=i.length;e.drawBuffers||(r=Math.min(r,1));for(var o=0;o<r;o++){var s=i[o],a=s.parentTextureArray||s;this.renderer.texture.bind(a,0)}t.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(t.depthTexture,0)},t.prototype.updateFramebuffer=function(t,e){var n=this.gl,i=t.glFramebuffers[this.CONTEXT_UID],r=t.colorTextures,o=r.length;n.drawBuffers||(o=Math.min(o,1)),i.multisample>1&&this.canMultisampleFramebuffer(t)?(i.msaaBuffer=i.msaaBuffer||n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,i.msaaBuffer),n.renderbufferStorageMultisample(n.RENDERBUFFER,i.multisample,n.RGBA8,t.width,t.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,i.msaaBuffer)):i.msaaBuffer&&(n.deleteRenderbuffer(i.msaaBuffer),i.msaaBuffer=null,i.blitFramebuffer&&(i.blitFramebuffer.dispose(),i.blitFramebuffer=null));for(var s=[],a=0;a<o;a++){var l=r[a],u=l.parentTextureArray||l;this.renderer.texture.bind(u,0),(0!==a||!i.msaaBuffer)&&(n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+a,l.target,u._glTextures[this.CONTEXT_UID].texture,e),s.push(n.COLOR_ATTACHMENT0+a))}if(s.length>1&&n.drawBuffers(s),t.depthTexture&&this.writeDepthTexture){var h=t.depthTexture;this.renderer.texture.bind(h,0),n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,h._glTextures[this.CONTEXT_UID].texture,e)}!t.stencil&&!t.depth||t.depthTexture&&this.writeDepthTexture?i.stencil&&(n.deleteRenderbuffer(i.stencil),i.stencil=null):(i.stencil=i.stencil||n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,i.stencil),i.msaaBuffer?n.renderbufferStorageMultisample(n.RENDERBUFFER,i.multisample,n.DEPTH24_STENCIL8,t.width,t.height):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,t.width,t.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,i.stencil))},t.prototype.canMultisampleFramebuffer=function(t){return 1!==this.renderer.context.webGLVersion&&t.colorTextures.length<=1&&!t.depthTexture},t.prototype.detectSamples=function(t){var e=this.msaaSamples,n=kt.NONE;if(t<=1||null===e)return n;for(var i=0;i<e.length;i++)if(e[i]<=t){n=e[i];break}return 1===n&&(n=kt.NONE),n},t.prototype.blit=function(t,e,n){var i=this,r=i.current,o=i.renderer,s=i.gl,a=i.CONTEXT_UID;if(2===o.context.webGLVersion&&r){var l=r.glFramebuffers[a];if(l){if(!t){if(!l.msaaBuffer)return;var u=r.colorTextures[0];if(!u)return;l.blitFramebuffer||(l.blitFramebuffer=new Ar(r.width,r.height),l.blitFramebuffer.addColorTexture(0,u)),(t=l.blitFramebuffer).colorTextures[0]!==u&&(t.colorTextures[0]=u,t.dirtyId++,t.dirtyFormat++),(t.width!==r.width||t.height!==r.height)&&(t.width=r.width,t.height=r.height,t.dirtyId++,t.dirtySize++)}e||((e=ro).width=r.width,e.height=r.height),n||(n=e);var h=e.width===n.width&&e.height===n.height;this.bind(t),s.bindFramebuffer(s.READ_FRAMEBUFFER,l.framebuffer),s.blitFramebuffer(e.x,e.y,e.width,e.height,n.x,n.y,n.width,n.height,s.COLOR_BUFFER_BIT,h?s.NEAREST:s.LINEAR)}}},t.prototype.disposeFramebuffer=function(t,e){var n=t.glFramebuffers[this.CONTEXT_UID],i=this.gl;if(n){delete t.glFramebuffers[this.CONTEXT_UID];var r=this.managedFramebuffers.indexOf(t);r>=0&&this.managedFramebuffers.splice(r,1),t.disposeRunner.remove(this),e||(i.deleteFramebuffer(n.framebuffer),n.msaaBuffer&&i.deleteRenderbuffer(n.msaaBuffer),n.stencil&&i.deleteRenderbuffer(n.stencil)),n.blitFramebuffer&&n.blitFramebuffer.dispose()}},t.prototype.disposeAll=function(t){var e=this.managedFramebuffers;this.managedFramebuffers=[];for(var n=0;n<e.length;n++)this.disposeFramebuffer(e[n],t)},t.prototype.forceStencil=function(){var t=this.current;if(t){var e=t.glFramebuffers[this.CONTEXT_UID];if(e&&!e.stencil){t.stencil=!0;var n=t.width,i=t.height,r=this.gl,o=r.createRenderbuffer();r.bindRenderbuffer(r.RENDERBUFFER,o),e.msaaBuffer?r.renderbufferStorageMultisample(r.RENDERBUFFER,e.multisample,r.DEPTH24_STENCIL8,n,i):r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_STENCIL,n,i),e.stencil=o,r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.RENDERBUFFER,o)}}},t.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new xi},t.prototype.destroy=function(){this.renderer=null},t}(),so={5126:4,5123:2,5121:1},ao=function(){function t(t){this.renderer=t,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}return t.prototype.contextChange=function(){this.disposeAll(!0);var t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,2!==e.webGLVersion){var n=this.renderer.context.extensions.vertexArrayObject;xe.PREFER_ENV===vt.WEBGL_LEGACY&&(n=null),n?(t.createVertexArray=function(){return n.createVertexArrayOES()},t.bindVertexArray=function(t){return n.bindVertexArrayOES(t)},t.deleteVertexArray=function(t){return n.deleteVertexArrayOES(t)}):(this.hasVao=!1,t.createVertexArray=function(){return null},t.bindVertexArray=function(){return null},t.deleteVertexArray=function(){return null})}if(2!==e.webGLVersion){var i=t.getExtension("ANGLE_instanced_arrays");i?(t.vertexAttribDivisor=function(t,e){return i.vertexAttribDivisorANGLE(t,e)},t.drawElementsInstanced=function(t,e,n,r,o){return i.drawElementsInstancedANGLE(t,e,n,r,o)},t.drawArraysInstanced=function(t,e,n,r){return i.drawArraysInstancedANGLE(t,e,n,r)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===e.webGLVersion||!!e.extensions.uint32ElementIndex},t.prototype.bind=function(t,e){e=e||this.renderer.shader.shader;var n=this.gl,i=t.glVertexArrayObjects[this.CONTEXT_UID],r=!1;i||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=i={},r=!0);var o=i[e.program.id]||this.initGeometryVao(t,e,r);this._activeGeometry=t,this._activeVao!==o&&(this._activeVao=o,this.hasVao?n.bindVertexArray(o):this.activateVao(t,e.program)),this.updateBuffers()},t.prototype.reset=function(){this.unbind()},t.prototype.updateBuffers=function(){for(var t=this._activeGeometry,e=this.renderer.buffer,n=0;n<t.buffers.length;n++){var i=t.buffers[n];e.update(i)}},t.prototype.checkCompatibility=function(t,e){var n=t.attributes,i=e.attributeData;for(var r in i)if(!n[r])throw new Error('shader and geometry incompatible, geometry missing the "'+r+'" attribute')},t.prototype.getSignature=function(t,e){var n=t.attributes,i=e.attributeData,r=["g",t.id];for(var o in n)i[o]&&r.push(o,i[o].location);return r.join("-")},t.prototype.initGeometryVao=function(t,e,n){void 0===n&&(n=!0);var i=this.gl,r=this.CONTEXT_UID,o=this.renderer.buffer,s=e.program;s.glPrograms[r]||this.renderer.shader.generateProgram(e),this.checkCompatibility(t,s);var a=this.getSignature(t,s),l=t.glVertexArrayObjects[this.CONTEXT_UID],u=l[a];if(u)return l[s.id]=u,u;var h=t.buffers,c=t.attributes,p={},d={};for(var f in h)p[f]=0,d[f]=0;for(var f in c)!c[f].size&&s.attributeData[f]?c[f].size=s.attributeData[f].size:c[f].size||console.warn("PIXI Geometry attribute '"+f+"' size cannot be determined (likely the bound shader does not have the attribute)"),p[c[f].buffer]+=c[f].size*so[c[f].type];for(var f in c){var m=c[f],y=m.size;void 0===m.stride&&(p[m.buffer]===y*so[m.type]?m.stride=0:m.stride=p[m.buffer]),void 0===m.start&&(m.start=d[m.buffer],d[m.buffer]+=y*so[m.type])}u=i.createVertexArray(),i.bindVertexArray(u);for(var g=0;g<h.length;g++){var v=h[g];o.bind(v),n&&v._glBuffers[r].refCount++}return this.activateVao(t,s),this._activeVao=u,l[s.id]=u,l[a]=u,u},t.prototype.disposeGeometry=function(t,e){var n;if(this.managedGeometries[t.id]){delete this.managedGeometries[t.id];var i=t.glVertexArrayObjects[this.CONTEXT_UID],r=this.gl,o=t.buffers,s=null===(n=this.renderer)||void 0===n?void 0:n.buffer;if(t.disposeRunner.remove(this),i){if(s)for(var a=0;a<o.length;a++){var l=o[a]._glBuffers[this.CONTEXT_UID];l&&(l.refCount--,0===l.refCount&&!e&&s.dispose(o[a],e))}if(!e)for(var u in i)if("g"===u[0]){var h=i[u];this._activeVao===h&&this.unbind(),r.deleteVertexArray(h)}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}},t.prototype.disposeAll=function(t){for(var e=Object.keys(this.managedGeometries),n=0;n<e.length;n++)this.disposeGeometry(this.managedGeometries[e[n]],t)},t.prototype.activateVao=function(t,e){var n=this.gl,i=this.CONTEXT_UID,r=this.renderer.buffer,o=t.buffers,s=t.attributes;t.indexBuffer&&r.bind(t.indexBuffer);var a=null;for(var l in s){var u=s[l],h=o[u.buffer],c=h._glBuffers[i];if(e.attributeData[l]){a!==c&&(r.bind(h),a=c);var p=e.attributeData[l].location;if(n.enableVertexAttribArray(p),n.vertexAttribPointer(p,u.size,u.type||n.FLOAT,u.normalized,u.stride,u.start),u.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");n.vertexAttribDivisor(p,1)}}}},t.prototype.draw=function(t,e,n,i){var r=this.gl,o=this._activeGeometry;if(o.indexBuffer){var s=o.indexBuffer.data.BYTES_PER_ELEMENT,a=2===s?r.UNSIGNED_SHORT:r.UNSIGNED_INT;2===s||4===s&&this.canUseUInt32ElementIndex?o.instanced?r.drawElementsInstanced(t,e||o.indexBuffer.data.length,a,(n||0)*s,i||1):r.drawElements(t,e||o.indexBuffer.data.length,a,(n||0)*s):console.warn("unsupported index buffer type: uint32")}else o.instanced?r.drawArraysInstanced(t,n,e||o.getSize(),i||1):r.drawArrays(t,n,e||o.getSize());return this},t.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},t.prototype.destroy=function(){this.renderer=null},t}(),lo=function(){function t(t){void 0===t&&(t=null),this.type=Rt.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=xe.FILTER_MULTISAMPLE,this.enabled=!0,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._target=null}return Object.defineProperty(t.prototype,"filter",{get:function(){return this._filters?this._filters[0]:null},set:function(t){t?this._filters?this._filters[0]=t:this._filters=[t]:this._filters=null},enumerable:!1,configurable:!0}),t.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=Rt.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null},t.prototype.copyCountersOrReset=function(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)},t}();function uo(t,e,n){var i=t.createShader(e);return t.shaderSource(i,n),t.compileShader(i),i}function ho(t,e){var n=t.getShaderSource(e).split("\n").map((function(t,e){return e+": "+t})),i=t.getShaderInfoLog(e),r=i.split("\n"),o={},s=r.map((function(t){return parseFloat(t.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))})).filter((function(t){return!(!t||o[t]||(o[t]=!0,0))})),a=[""];s.forEach((function(t){n[t-1]="%c"+n[t-1]+"%c",a.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")}));var l=n.join("\n");a[0]=l,console.error(i),console.groupCollapsed("click to view full shader code"),console.warn.apply(console,a),console.groupEnd()}function co(t){for(var e=new Array(t),n=0;n<e.length;n++)e[n]=!1;return e}function po(t,e){switch(t){case"float":case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"uvec2":return new Uint32Array(2*e);case"uvec3":return new Uint32Array(3*e);case"uvec4":return new Uint32Array(4*e);case"bool":return!1;case"bvec2":return co(2*e);case"bvec3":return co(3*e);case"bvec4":return co(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}var fo,mo={},yo=mo;function go(t,e,n){if("precision"!==t.substring(0,9)){var i=e;return e===Mt.HIGH&&n!==Mt.HIGH&&(i=Mt.MEDIUM),"precision "+i+" float;\n"+t}return n!==Mt.HIGH&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t}var vo={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function _o(t){return vo[t]}var xo=null,bo={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function wo(t,e){if(!xo){var n=Object.keys(bo);xo={};for(var i=0;i<n.length;++i){var r=n[i];xo[t[r]]=bo[r]}}return xo[e]}var Po,Eo=[{test:function(t){return"float"===t.type&&1===t.size},code:function(t){return'\n            if(uv["'+t+'"] !== ud["'+t+'"].value)\n            {\n                ud["'+t+'"].value = uv["'+t+'"]\n                gl.uniform1f(ud["'+t+'"].location, uv["'+t+'"])\n            }\n            '}},{test:function(t){return("sampler2D"===t.type||"samplerCube"===t.type||"sampler2DArray"===t.type)&&1===t.size&&!t.isArray},code:function(t){return't = syncData.textureCount++;\n\n            renderer.texture.bind(uv["'+t+'"], t);\n\n            if(ud["'+t+'"].value !== t)\n            {\n                ud["'+t+'"].value = t;\n                gl.uniform1i(ud["'+t+'"].location, t);\n; // eslint-disable-line max-len\n            }'}},{test:function(t,e){return"mat3"===t.type&&1===t.size&&void 0!==e.a},code:function(t){return'\n            gl.uniformMatrix3fv(ud["'+t+'"].location, false, uv["'+t+'"].toArray(true));\n            '},codeUbo:function(t){return"\n                var "+t+"_matrix = uv."+t+".toArray(true);\n\n                data[offset] = "+t+"_matrix[0];\n                data[offset+1] = "+t+"_matrix[1];\n                data[offset+2] = "+t+"_matrix[2];\n        \n                data[offset + 4] = "+t+"_matrix[3];\n                data[offset + 5] = "+t+"_matrix[4];\n                data[offset + 6] = "+t+"_matrix[5];\n        \n                data[offset + 8] = "+t+"_matrix[6];\n                data[offset + 9] = "+t+"_matrix[7];\n                data[offset + 10] = "+t+"_matrix[8];\n            "}},{test:function(t,e){return"vec2"===t.type&&1===t.size&&void 0!==e.x},code:function(t){return'\n                cv = ud["'+t+'"].value;\n                v = uv["'+t+'"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud["'+t+'"].location, v.x, v.y);\n                }'},codeUbo:function(t){return"\n                v = uv."+t+";\n\n                data[offset] = v.x;\n                data[offset+1] = v.y;\n            "}},{test:function(t){return"vec2"===t.type&&1===t.size},code:function(t){return'\n                cv = ud["'+t+'"].value;\n                v = uv["'+t+'"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud["'+t+'"].location, v[0], v[1]);\n                }\n            '}},{test:function(t,e){return"vec4"===t.type&&1===t.size&&void 0!==e.width},code:function(t){return'\n                cv = ud["'+t+'"].value;\n                v = uv["'+t+'"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud["'+t+'"].location, v.x, v.y, v.width, v.height)\n                }'},codeUbo:function(t){return"\n                    v = uv."+t+";\n\n                    data[offset] = v.x;\n                    data[offset+1] = v.y;\n                    data[offset+2] = v.width;\n                    data[offset+3] = v.height;\n                "}},{test:function(t){return"vec4"===t.type&&1===t.size},code:function(t){return'\n                cv = ud["'+t+'"].value;\n                v = uv["'+t+'"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud["'+t+'"].location, v[0], v[1], v[2], v[3])\n                }'}}],To={float:"\n    if (cv !== v)\n    {\n        cu.value = v;\n        gl.uniform1f(location, v);\n    }",vec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2f(location, v[0], v[1])\n    }",vec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",vec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4f(location, v[0], v[1], v[2], v[3]);\n    }",int:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }",ivec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2i(location, v[0], v[1]);\n    }",ivec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3i(location, v[0], v[1], v[2]);\n    }",ivec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n    }",uint:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1ui(location, v);\n    }",uvec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2ui(location, v[0], v[1]);\n    }",uvec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3ui(location, v[0], v[1], v[2]);\n    }",uvec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);\n    }",bool:"\n    if (cv !== v)\n    {\n        cu.value = v;\n        gl.uniform1i(location, v);\n    }",bvec2:"\n    if (cv[0] != v[0] || cv[1] != v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2i(location, v[0], v[1]);\n    }",bvec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3i(location, v[0], v[1], v[2]);\n    }",bvec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n    }",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},So={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"},Co=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function Io(t){for(var e="",n=0;n<t;++n)n>0&&(e+="\nelse "),n<t-1&&(e+="if(test == "+n+".0){}");return e}var Ao=0,Oo={},No=function(){function t(e,n,i){void 0===i&&(i="pixi-shader"),this.id=Ao++,this.vertexSrc=e||t.defaultVertexSrc,this.fragmentSrc=n||t.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(i=i.replace(/\s+/g,"-"),Oo[i]?(Oo[i]++,i+="-"+Oo[i]):Oo[i]=1,this.vertexSrc="#define SHADER_NAME "+i+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+i+"\n"+this.fragmentSrc,this.vertexSrc=go(this.vertexSrc,xe.PRECISION_VERTEX,Mt.HIGH),this.fragmentSrc=go(this.fragmentSrc,xe.PRECISION_FRAGMENT,function(){if(!fo){fo=Mt.MEDIUM;var t=function(){if(yo===mo||yo&&yo.isContextLost()){var t=document.createElement("canvas"),e=void 0;xe.PREFER_ENV>=vt.WEBGL2&&(e=t.getContext("webgl2",{})),e||((e=t.getContext("webgl",{})||t.getContext("experimental-webgl",{}))?e.getExtension("WEBGL_draw_buffers"):e=null),yo=e}return yo}();if(t&&t.getShaderPrecisionFormat){var e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);fo=e.precision?Mt.HIGH:Mt.MEDIUM}}return fo}())),this.glPrograms={},this.syncUniforms=null}return Object.defineProperty(t,"defaultVertexSrc",{get:function(){return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultFragmentSrc",{get:function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"},enumerable:!1,configurable:!0}),t.from=function(e,n,i){var r=e+n,o=oi[r];return o||(oi[r]=o=new t(e,n,i)),o},t}(),Lo=function(){function t(t,e){this.uniformBindCount=0,this.program=t,this.uniformGroup=e?e instanceof qr?e:new qr(e):new qr({})}return t.prototype.checkUniformExists=function(t,e){if(e.uniforms[t])return!0;for(var n in e.uniforms){var i=e.uniforms[n];if(i.group&&this.checkUniformExists(t,i))return!0}return!1},t.prototype.destroy=function(){this.uniformGroup=null},Object.defineProperty(t.prototype,"uniforms",{get:function(){return this.uniformGroup.uniforms},enumerable:!1,configurable:!0}),t.from=function(e,n,i){return new t(No.from(e,n),i)},t}(),Mo=function(){function t(){this.data=0,this.blendMode=bt.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}return Object.defineProperty(t.prototype,"blend",{get:function(){return!!(1&this.data)},set:function(t){!!(1&this.data)!==t&&(this.data^=1)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"offsets",{get:function(){return!!(2&this.data)},set:function(t){!!(2&this.data)!==t&&(this.data^=2)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"culling",{get:function(){return!!(4&this.data)},set:function(t){!!(4&this.data)!==t&&(this.data^=4)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"depthTest",{get:function(){return!!(8&this.data)},set:function(t){!!(8&this.data)!==t&&(this.data^=8)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"depthMask",{get:function(){return!!(32&this.data)},set:function(t){!!(32&this.data)!==t&&(this.data^=32)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"clockwiseFrontFace",{get:function(){return!!(16&this.data)},set:function(t){!!(16&this.data)!==t&&(this.data^=16)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"blendMode",{get:function(){return this._blendMode},set:function(t){this.blend=t!==bt.NONE,this._blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"polygonOffset",{get:function(){return this._polygonOffset},set:function(t){this.offsets=!!t,this._polygonOffset=t},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return"[@pixi/core:State blendMode="+this.blendMode+" clockwiseFrontFace="+this.clockwiseFrontFace+" culling="+this.culling+" depthMask="+this.depthMask+" polygonOffset="+this.polygonOffset+"]"},t.for2d=function(){var e=new t;return e.depthTest=!1,e.blend=!0,e},t}(),Ro=function(t){function e(n,i,r){var o=this,s=No.from(n||e.defaultVertexSrc,i||e.defaultFragmentSrc);return(o=t.call(this,s,r)||this).padding=0,o.resolution=xe.FILTER_RESOLUTION,o.multisample=xe.FILTER_MULTISAMPLE,o.enabled=!0,o.autoFit=!0,o.state=new Mo,o}return dr(e,t),e.prototype.apply=function(t,e,n,i,r){t.applyFilter(this,e,n,i)},Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resolution",{get:function(){return this._resolution},set:function(t){this._resolution=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultVertexSrc",{get:function(){return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultFragmentSrc",{get:function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"},enumerable:!1,configurable:!0}),e}(Lo),ko=new Ci,Do=function(){function t(t,e){this._texture=t,this.mapCoord=new Ci,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof e>"u"?.5:e,this.isSimple=!1}return Object.defineProperty(t.prototype,"texture",{get:function(){return this._texture},set:function(t){this._texture=t,this._textureID=-1},enumerable:!1,configurable:!0}),t.prototype.multiplyUvs=function(t,e){void 0===e&&(e=t);for(var n=this.mapCoord,i=0;i<t.length;i+=2){var r=t[i],o=t[i+1];e[i]=r*n.a+o*n.c+n.tx,e[i+1]=r*n.b+o*n.d+n.ty}return e},t.prototype.update=function(t){var e=this._texture;if(!e||!e.valid||!t&&this._textureID===e._updateID)return!1;this._textureID=e._updateID,this._updateID++;var n=e._uvs;this.mapCoord.set(n.x1-n.x0,n.y1-n.y0,n.x3-n.x0,n.y3-n.y0,n.x0,n.y0);var i=e.orig,r=e.trim;r&&(ko.set(i.width/r.width,0,0,i.height/r.height,-r.x/r.width,-r.y/r.height),this.mapCoord.append(ko));var o=e.baseTexture,s=this.uClampFrame,a=this.clampMargin/o.resolution,l=this.clampOffset;return s[0]=(e._frame.x+a+l)/o.width,s[1]=(e._frame.y+a+l)/o.height,s[2]=(e._frame.x+e._frame.width-a+l)/o.width,s[3]=(e._frame.y+e._frame.height-a+l)/o.height,this.uClampOffset[0]=l/o.realWidth,this.uClampOffset[1]=l/o.realHeight,this.isSimple=e._frame.width===o.width&&e._frame.height===o.height&&0===e.rotate,!0},t}(),Fo=function(t){function e(e,n,i){var r=this,o=null;return"string"!=typeof e&&void 0===n&&void 0===i&&(o=e,e=void 0,n=void 0,i=void 0),(r=t.call(this,e||"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n",n||"varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n",i)||this).maskSprite=o,r.maskMatrix=new Ci,r}return dr(e,t),Object.defineProperty(e.prototype,"maskSprite",{get:function(){return this._maskSprite},set:function(t){this._maskSprite=t,this._maskSprite&&(this._maskSprite.renderable=!1)},enumerable:!1,configurable:!0}),e.prototype.apply=function(t,e,n,i){var r=this._maskSprite,o=r._texture;!o.valid||(o.uvMatrix||(o.uvMatrix=new Do(o,0)),o.uvMatrix.update(),this.uniforms.npmAlpha=o.baseTexture.alphaMode?0:1,this.uniforms.mask=o,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,r).prepend(o.uvMatrix.mapCoord),this.uniforms.alpha=r.worldAlpha,this.uniforms.maskClamp=o.uvMatrix.uClampFrame,t.applyFilter(this,e,n,i))},e}(Ro),Bo=function(){function t(t){this.renderer=t,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}return t.prototype.setMaskStack=function(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)},t.prototype.push=function(t,e){var n=e;if(!n.isMaskData){var i=this.maskDataPool.pop()||new lo;i.pooled=!0,i.maskObject=e,n=i}var r=0!==this.maskStack.length?this.maskStack[this.maskStack.length-1]:null;if(n.copyCountersOrReset(r),n.autoDetect&&this.detect(n),n._target=t,n.type!==Rt.SPRITE&&this.maskStack.push(n),n.enabled)switch(n.type){case Rt.SCISSOR:this.renderer.scissor.push(n);break;case Rt.STENCIL:this.renderer.stencil.push(n);break;case Rt.SPRITE:n.copyCountersOrReset(null),this.pushSpriteMask(n)}n.type===Rt.SPRITE&&this.maskStack.push(n)},t.prototype.pop=function(t){var e=this.maskStack.pop();if(e&&e._target===t){if(e.enabled)switch(e.type){case Rt.SCISSOR:this.renderer.scissor.pop();break;case Rt.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case Rt.SPRITE:this.popSpriteMask(e)}if(e.reset(),e.pooled&&this.maskDataPool.push(e),0!==this.maskStack.length){var n=this.maskStack[this.maskStack.length-1];n.type===Rt.SPRITE&&n._filters&&(n._filters[0].maskSprite=n.maskObject)}}},t.prototype.detect=function(t){t.maskObject.isSprite?t.type=Rt.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(t)?t.type=Rt.SCISSOR:t.type=Rt.STENCIL},t.prototype.pushSpriteMask=function(t){var e,n,i=t.maskObject,r=t._target,o=t._filters;o||(o=this.alphaMaskPool[this.alphaMaskIndex])||(o=this.alphaMaskPool[this.alphaMaskIndex]=[new Fo]);var s,a,l=this.renderer,u=l.renderTexture;if(u.current){var h=u.current;s=t.resolution||h.resolution,a=null!==(e=t.multisample)&&void 0!==e?e:h.multisample}else s=t.resolution||l.resolution,a=null!==(n=t.multisample)&&void 0!==n?n:l.multisample;o[0].resolution=s,o[0].multisample=a,o[0].maskSprite=i;var c=r.filterArea;r.filterArea=i.getBounds(!0),l.filter.push(r,o),r.filterArea=c,t._filters||this.alphaMaskIndex++},t.prototype.popSpriteMask=function(t){this.renderer.filter.pop(),t._filters?t._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)},t.prototype.destroy=function(){this.renderer=null},t}(),Uo=function(){function t(t){this.renderer=t,this.maskStack=[],this.glConst=0}return t.prototype.getStackLength=function(){return this.maskStack.length},t.prototype.setMaskStack=function(t){var e=this.renderer.gl,n=this.getStackLength();this.maskStack=t;var i=this.getStackLength();i!==n&&(0===i?e.disable(this.glConst):(e.enable(this.glConst),this._useCurrent()))},t.prototype._useCurrent=function(){},t.prototype.destroy=function(){this.renderer=null,this.maskStack=null},t}(),zo=new Ci,Xo=function(t){function e(e){var n=t.call(this,e)||this;return n.glConst=WebGLRenderingContext.SCISSOR_TEST,n}return dr(e,t),e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0},e.prototype.calcScissorRect=function(t){if(!t._scissorRectLocal){var e=t._scissorRect,n=t.maskObject,i=this.renderer,r=i.renderTexture;n.renderable=!0;var o=n.getBounds();this.roundFrameToPixels(o,r.current?r.current.resolution:i.resolution,r.sourceFrame,r.destinationFrame,i.projection.transform),n.renderable=!1,e&&o.fit(e),t._scissorRectLocal=o}},e.isMatrixRotated=function(t){if(!t)return!1;var e=t.a,n=t.b,i=t.c,r=t.d;return(Math.abs(n)>1e-4||Math.abs(i)>1e-4)&&(Math.abs(e)>1e-4||Math.abs(r)>1e-4)},e.prototype.testScissor=function(t){var n=t.maskObject;if(!n.isFastRect||!n.isFastRect()||e.isMatrixRotated(n.worldTransform)||e.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(t);var i=t._scissorRectLocal;return i.width>0&&i.height>0},e.prototype.roundFrameToPixels=function(t,n,i,r,o){e.isMatrixRotated(o)||((o=o?zo.copyFrom(o):zo.identity()).translate(-i.x,-i.y).scale(r.width/i.width,r.height/i.height).translate(r.x,r.y),this.renderer.filter.transformAABB(o,t),t.fit(r),t.x=Math.round(t.x*n),t.y=Math.round(t.y*n),t.width=Math.round(t.width*n),t.height=Math.round(t.height*n))},e.prototype.push=function(t){t._scissorRectLocal||this.calcScissorRect(t);var e=this.renderer.gl;t._scissorRect||e.enable(e.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=t._scissorRectLocal,this._useCurrent()},e.prototype.pop=function(){var t=this.renderer.gl;this.getStackLength()>0?this._useCurrent():t.disable(t.SCISSOR_TEST)},e.prototype._useCurrent=function(){var t,e=this.maskStack[this.maskStack.length-1]._scissorRect;t=this.renderer.renderTexture.current?e.y:this.renderer.height-e.height-e.y,this.renderer.gl.scissor(e.x,t,e.width,e.height)},e}(Uo),Yo=function(t){function e(e){var n=t.call(this,e)||this;return n.glConst=WebGLRenderingContext.STENCIL_TEST,n}return dr(e,t),e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0},e.prototype.push=function(t){var e=t.maskObject,n=this.renderer.gl,i=t._stencilCounter;0===i&&(this.renderer.framebuffer.forceStencil(),n.clearStencil(0),n.clear(n.STENCIL_BUFFER_BIT),n.enable(n.STENCIL_TEST)),t._stencilCounter++,n.colorMask(!1,!1,!1,!1),n.stencilFunc(n.EQUAL,i,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,this._useCurrent()},e.prototype.pop=function(t){var e=this.renderer.gl;0===this.getStackLength()?e.disable(e.STENCIL_TEST):(e.colorMask(!1,!1,!1,!1),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,this._useCurrent())},e.prototype._useCurrent=function(){var t=this.renderer.gl;t.colorMask(!0,!0,!0,!0),t.stencilFunc(t.EQUAL,this.getStackLength(),4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},e}(Uo),Go=function(){function t(t){this.renderer=t,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new Ci,this.transform=null}return t.prototype.update=function(t,e,n,i){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,n,i),this.transform&&this.projectionMatrix.append(this.transform);var r=this.renderer;r.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,r.globalUniforms.update(),r.shader.shader&&r.shader.syncUniformGroup(r.shader.shader.uniforms.globals)},t.prototype.calculateProjection=function(t,e,n,i){var r=this.projectionMatrix,o=i?-1:1;r.identity(),r.a=1/e.width*2,r.d=o*(1/e.height*2),r.tx=-1-e.x*r.a,r.ty=-o-e.y*r.d},t.prototype.setTransform=function(t){},t.prototype.destroy=function(){this.renderer=null},t}(),Ho=new xi,Wo=new xi,jo=function(){function t(t){this.renderer=t,this.clearColor=t._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new xi,this.destinationFrame=new xi,this.viewportFrame=new xi}return t.prototype.bind=function(t,e,n){void 0===t&&(t=null);var i,r,o,s=this.renderer;this.current=t,t?(o=(i=t.baseTexture).resolution,e||(Ho.width=t.frame.width,Ho.height=t.frame.height,e=Ho),n||(Wo.x=t.frame.x,Wo.y=t.frame.y,Wo.width=e.width,Wo.height=e.height,n=Wo),r=i.framebuffer):(o=s.resolution,e||(Ho.width=s.screen.width,Ho.height=s.screen.height,e=Ho),n||((n=Ho).width=e.width,n.height=e.height));var a=this.viewportFrame;a.x=n.x*o,a.y=n.y*o,a.width=n.width*o,a.height=n.height*o,t||(a.y=s.view.height-(a.y+a.height)),a.ceil(),this.renderer.framebuffer.bind(r,a),this.renderer.projection.update(n,e,o,!r),t?this.renderer.mask.setMaskStack(i.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(e),this.destinationFrame.copyFrom(n)},t.prototype.clear=function(t,e){t=this.current?t||this.current.baseTexture.clearColor:t||this.clearColor;var n=this.destinationFrame,i=this.current?this.current.baseTexture:this.renderer.screen,r=n.width!==i.width||n.height!==i.height;if(r){var o=this.viewportFrame,s=o.x,a=o.y,l=o.width,u=o.height;s=Math.round(s),a=Math.round(a),l=Math.round(l),u=Math.round(u),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(s,a,l,u)}this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3],e),r&&this.renderer.scissor.pop()},t.prototype.resize=function(){this.bind(null)},t.prototype.reset=function(){this.bind(null)},t.prototype.destroy=function(){this.renderer=null},t}();function Vo(t,e,n,i,r){n.buffer.update(r)}var qo={float:"\n        data[offset] = v;\n    ",vec2:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n    ",vec3:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n    ",vec4:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n        data[offset+3] = v[3];\n    ",mat2:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n\n        data[offset+4] = v[2];\n        data[offset+5] = v[3];\n    ",mat3:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n        data[offset + 4] = v[3];\n        data[offset + 5] = v[4];\n        data[offset + 6] = v[5];\n\n        data[offset + 8] = v[6];\n        data[offset + 9] = v[7];\n        data[offset + 10] = v[8];\n    ",mat4:"\n        for(var i = 0; i < 16; i++)\n        {\n            data[offset + i] = v[i];\n        }\n    "},$o={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:32,mat3:48,mat4:64};var Zo=function(){function t(t,e){this.program=t,this.uniformData=e,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}return t.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null},t}();var Ko=0,Qo={textureCount:0,uboCount:0},Jo=function(){function t(t){this.destroyed=!1,this.renderer=t,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=Ko++}return t.prototype.systemCheck=function(){if(!function(){if("boolean"==typeof Po)return Po;try{var t=new Function("param1","param2","param3","return param1[param2] === param3;");Po=!0===t({a:"b"},"a","b")}catch{Po=!1}return Po}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},t.prototype.contextChange=function(t){this.gl=t,this.reset()},t.prototype.bind=function(t,e){t.uniforms.globals=this.renderer.globalUniforms;var n=t.program,i=n.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(t);return this.shader=t,this.program!==n&&(this.program=n,this.gl.useProgram(i.program)),e||(Qo.textureCount=0,Qo.uboCount=0,this.syncUniformGroup(t.uniformGroup,Qo)),i},t.prototype.setUniforms=function(t){var e=this.shader.program,n=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(n.uniformData,t,this.renderer)},t.prototype.syncUniformGroup=function(t,e){var n=this.getGlProgram();(!t.static||t.dirtyId!==n.uniformDirtyGroups[t.id])&&(n.uniformDirtyGroups[t.id]=t.dirtyId,this.syncUniforms(t,n,e))},t.prototype.syncUniforms=function(t,e,n){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,t.uniforms,this.renderer,n)},t.prototype.createSyncGroups=function(t){var e=this.getSignature(t,this.shader.program.uniformData,"u");return this.cache[e]||(this.cache[e]=function(t,e){var n,i=["\n        var v = null;\n        var cv = null;\n        var cu = null;\n        var t = 0;\n        var gl = renderer.gl;\n    "];for(var r in t.uniforms){var o=e[r];if(o){for(var s=t.uniforms[r],a=!1,l=0;l<Eo.length;l++)if(Eo[l].test(o,s)){i.push(Eo[l].code(r,s)),a=!0;break}if(!a){var u=(1===o.size?To:So)[o.type].replace("location",'ud["'+r+'"].location');i.push('\n            cu = ud["'+r+'"];\n            cv = cu.value;\n            v = uv["'+r+'"];\n            '+u+";")}}else null!==(n=t.uniforms[r])&&void 0!==n&&n.group&&(t.uniforms[r].ubo?i.push("\n                        renderer.shader.syncUniformBufferGroup(uv."+r+", '"+r+"');\n                    "):i.push("\n                        renderer.shader.syncUniformGroup(uv."+r+", syncData);\n                    "))}return new Function("ud","uv","renderer","syncData",i.join("\n"))}(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id]},t.prototype.syncUniformBufferGroup=function(t,e){var n=this.getGlProgram();if(!t.static||0!==t.dirtyId||!n.uniformGroups[t.id]){t.dirtyId=0;var i=n.uniformGroups[t.id]||this.createSyncBufferGroup(t,n,e);t.buffer.update(),i(n.uniformData,t.uniforms,this.renderer,Qo,t.buffer)}this.renderer.buffer.bindBufferBase(t.buffer,n.uniformBufferBindings[e])},t.prototype.createSyncBufferGroup=function(t,e,n){var i=this.renderer.gl;this.renderer.buffer.bind(t.buffer);var r=this.gl.getUniformBlockIndex(e.program,n);e.uniformBufferBindings[n]=this.shader.uniformBindCount,i.uniformBlockBinding(e.program,r,this.shader.uniformBindCount),this.shader.uniformBindCount++;var o=this.getSignature(t,this.shader.program.uniformData,"ubo"),s=this._uboCache[o];if(s||(s=this._uboCache[o]=function(t,e){if(!t.autoManage)return{size:0,syncFunc:Vo};for(var n=function(t,e){var n=[];for(var i in t)e[i]&&n.push(e[i]);return n.sort((function(t,e){return t.index-e.index})),n}(t.uniforms,e),i=function(t){for(var e=t.map((function(t){return{data:t,offset:0,dataLen:0,dirty:0}})),n=0,i=0,r=0,o=0;o<e.length;o++){var s=e[o];if(n=$o[s.data.type],s.data.size>1&&(n=Math.max(n,16)*s.data.size),s.dataLen=n,i%n!=0&&i<16){var a=i%n%16;i+=a,r+=a}i+n>16?(r=16*Math.ceil(r/16),s.offset=r,r+=n,i=n):(s.offset=r,i+=n,r+=n)}return{uboElements:e,size:r=16*Math.ceil(r/16)}}(n),r=i.uboElements,o=i.size,s=["\n    var v = null;\n    var v2 = null;\n    var cv = null;\n    var t = 0;\n    var gl = renderer.gl\n    var index = 0;\n    var data = buffer.data;\n    "],a=0;a<r.length;a++){for(var l=r[a],u=t.uniforms[l.data.name],h=l.data.name,c=!1,p=0;p<Eo.length;p++){var d=Eo[p];if(d.codeUbo&&d.test(l.data,u)){s.push("offset = "+l.offset/4+";",Eo[p].codeUbo(l.data.name,u)),c=!0;break}}if(!c)if(l.data.size>1){var f=_o(l.data.type),m=Math.max($o[l.data.type]/16,1),y=f/m,g=(4-y%4)%4;s.push("\n                cv = ud."+h+".value;\n                v = uv."+h+";\n                offset = "+l.offset/4+";\n\n                t = 0;\n\n                for(var i=0; i < "+l.data.size*m+"; i++)\n                {\n                    for(var j = 0; j < "+y+"; j++)\n                    {\n                        data[offset++] = v[t++];\n                    }\n                    offset += "+g+";\n                }\n\n                ")}else{var v=qo[l.data.type];s.push("\n                cv = ud."+h+".value;\n                v = uv."+h+";\n                offset = "+l.offset/4+";\n                "+v+";\n                ")}}return s.push("\n       renderer.buffer.update(buffer);\n    "),{size:o,syncFunc:new Function("ud","uv","renderer","syncData","buffer",s.join("\n"))}}(t,this.shader.program.uniformData)),t.autoManage){var a=new Float32Array(s.size/4);t.buffer.update(a)}return e.uniformGroups[t.id]=s.syncFunc,e.uniformGroups[t.id]},t.prototype.getSignature=function(t,e,n){var i=t.uniforms,r=[n+"-"];for(var o in i)r.push(o),e[o]&&r.push(e[o].type);return r.join("-")},t.prototype.getGlProgram=function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},t.prototype.generateProgram=function(t){var e=this.gl,n=t.program,i=function(t,e){var n=uo(t,t.VERTEX_SHADER,e.vertexSrc),i=uo(t,t.FRAGMENT_SHADER,e.fragmentSrc),r=t.createProgram();if(t.attachShader(r,n),t.attachShader(r,i),t.linkProgram(r),t.getProgramParameter(r,t.LINK_STATUS)||function(t,e,n,i){t.getProgramParameter(e,t.LINK_STATUS)||(t.getShaderParameter(n,t.COMPILE_STATUS)||ho(t,n),t.getShaderParameter(i,t.COMPILE_STATUS)||ho(t,i),console.error("PixiJS Error: Could not initialize shader."),""!==t.getProgramInfoLog(e)&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(e)))}(t,r,n,i),e.attributeData=function(t,e){for(var n={},i=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),r=0;r<i;r++){var o=e.getActiveAttrib(t,r);if(0!==o.name.indexOf("gl_")){var s=wo(e,o.type),a={type:s,name:o.name,size:_o(s),location:e.getAttribLocation(t,o.name)};n[o.name]=a}}return n}(r,t),e.uniformData=function(t,e){for(var n={},i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),r=0;r<i;r++){var o=e.getActiveUniform(t,r),s=o.name.replace(/\[.*?\]$/,""),a=!!o.name.match(/\[.*?\]$/),l=wo(e,o.type);n[s]={name:s,index:r,type:l,size:o.size,isArray:a,value:po(l,o.size)}}return n}(r,t),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(e.vertexSrc)){var o=Object.keys(e.attributeData);o.sort((function(t,e){return t>e?1:-1}));for(var s=0;s<o.length;s++)e.attributeData[o[s]].location=s,t.bindAttribLocation(r,s,o[s]);t.linkProgram(r)}t.deleteShader(n),t.deleteShader(i);var a={};for(var s in e.uniformData){var l=e.uniformData[s];a[s]={location:t.getUniformLocation(r,s),value:po(l.type,l.size)}}return new Zo(r,a)}(e,n);return n.glPrograms[this.renderer.CONTEXT_UID]=i,i},t.prototype.reset=function(){this.program=null,this.shader=null},t.prototype.destroy=function(){this.renderer=null,this.destroyed=!0},t}(),ts=function(){function t(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=bt.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,this.map[4]=this.setFrontFace,this.map[5]=this.setDepthMask,this.checks=[],this.defaultState=new Mo,this.defaultState.blend=!0}return t.prototype.contextChange=function(t){this.gl=t,this.blendModes=function(t,e){return void 0===e&&(e=[]),e[bt.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[bt.ADD]=[t.ONE,t.ONE],e[bt.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[bt.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[bt.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[bt.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[bt.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[bt.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[bt.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[bt.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[bt.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[bt.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[bt.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[bt.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[bt.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[bt.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[bt.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[bt.NONE]=[0,0],e[bt.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[bt.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE],e[bt.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[bt.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[bt.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[bt.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[bt.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE],e[bt.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[bt.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[bt.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[bt.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[bt.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,t.FUNC_ADD],e}(t),this.set(this.defaultState),this.reset()},t.prototype.set=function(t){if(t=t||this.defaultState,this.stateId!==t.data){for(var e=this.stateId^t.data,n=0;e;)1&e&&this.map[n].call(this,!!(t.data&1<<n)),e>>=1,n++;this.stateId=t.data}for(n=0;n<this.checks.length;n++)this.checks[n](this,t)},t.prototype.forceState=function(t){t=t||this.defaultState;for(var e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(e=0;e<this.checks.length;e++)this.checks[e](this,t);this.stateId=t.data},t.prototype.setBlend=function(e){this.updateCheck(t.checkBlendMode,e),this.gl[e?"enable":"disable"](this.gl.BLEND)},t.prototype.setOffset=function(e){this.updateCheck(t.checkPolygonOffset,e),this.gl[e?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},t.prototype.setDepthTest=function(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)},t.prototype.setDepthMask=function(t){this.gl.depthMask(t)},t.prototype.setCullFace=function(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)},t.prototype.setFrontFace=function(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])},t.prototype.setBlendMode=function(t){if(t!==this.blendMode){this.blendMode=t;var e=this.blendModes[t],n=this.gl;2===e.length?n.blendFunc(e[0],e[1]):n.blendFuncSeparate(e[0],e[1],e[2],e[3]),6===e.length?(this._blendEq=!0,n.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,n.blendEquationSeparate(n.FUNC_ADD,n.FUNC_ADD))}},t.prototype.setPolygonOffset=function(t,e){this.gl.polygonOffset(t,e)},t.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},t.prototype.updateCheck=function(t,e){var n=this.checks.indexOf(t);e&&-1===n?this.checks.push(t):!e&&-1!==n&&this.checks.splice(n,1)},t.checkBlendMode=function(t,e){t.setBlendMode(e.blendMode)},t.checkPolygonOffset=function(t,e){t.setPolygonOffset(1,e.polygonOffset)},t.prototype.destroy=function(){this.gl=null},t}(),es=function(){function t(t){this.renderer=t,this.count=0,this.checkCount=0,this.maxIdle=xe.GC_MAX_IDLE,this.checkCountMax=xe.GC_MAX_CHECK_COUNT,this.mode=xe.GC_MODE}return t.prototype.postrender=function(){!this.renderer.renderingToScreen||(this.count++,this.mode!==Lt.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},t.prototype.run=function(){for(var t=this.renderer.texture,e=t.managedTextures,n=!1,i=0;i<e.length;i++){var r=e[i];!r.framebuffer&&this.count-r.touched>this.maxIdle&&(t.destroyTexture(r,!0),e[i]=null,n=!0)}if(n){var o=0;for(i=0;i<e.length;i++)null!==e[i]&&(e[o++]=e[i]);e.length=o}},t.prototype.unload=function(t){var e=this.renderer.texture,n=t._texture;n&&!n.framebuffer&&e.destroyTexture(n);for(var i=t.children.length-1;i>=0;i--)this.unload(t.children[i])},t.prototype.destroy=function(){this.renderer=null},t}(),ns=function(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=Tt.UNSIGNED_BYTE,this.internalFormat=Pt.RGBA,this.samplerType=0},is=function(){function t(t){this.renderer=t,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new vr,this.hasIntegerTextures=!1}return t.prototype.contextChange=function(){var t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=function(t){var e,n,i,r,o,s,a,l,u,h,c,p,d,f,m,y,g,v,_,x,b,w,P;return"WebGL2RenderingContext"in self&&t instanceof self.WebGL2RenderingContext?((e={})[Tt.UNSIGNED_BYTE]=((n={})[Pt.RGBA]=t.RGBA8,n[Pt.RGB]=t.RGB8,n[Pt.RG]=t.RG8,n[Pt.RED]=t.R8,n[Pt.RGBA_INTEGER]=t.RGBA8UI,n[Pt.RGB_INTEGER]=t.RGB8UI,n[Pt.RG_INTEGER]=t.RG8UI,n[Pt.RED_INTEGER]=t.R8UI,n[Pt.ALPHA]=t.ALPHA,n[Pt.LUMINANCE]=t.LUMINANCE,n[Pt.LUMINANCE_ALPHA]=t.LUMINANCE_ALPHA,n),e[Tt.BYTE]=((i={})[Pt.RGBA]=t.RGBA8_SNORM,i[Pt.RGB]=t.RGB8_SNORM,i[Pt.RG]=t.RG8_SNORM,i[Pt.RED]=t.R8_SNORM,i[Pt.RGBA_INTEGER]=t.RGBA8I,i[Pt.RGB_INTEGER]=t.RGB8I,i[Pt.RG_INTEGER]=t.RG8I,i[Pt.RED_INTEGER]=t.R8I,i),e[Tt.UNSIGNED_SHORT]=((r={})[Pt.RGBA_INTEGER]=t.RGBA16UI,r[Pt.RGB_INTEGER]=t.RGB16UI,r[Pt.RG_INTEGER]=t.RG16UI,r[Pt.RED_INTEGER]=t.R16UI,r[Pt.DEPTH_COMPONENT]=t.DEPTH_COMPONENT16,r),e[Tt.SHORT]=((o={})[Pt.RGBA_INTEGER]=t.RGBA16I,o[Pt.RGB_INTEGER]=t.RGB16I,o[Pt.RG_INTEGER]=t.RG16I,o[Pt.RED_INTEGER]=t.R16I,o),e[Tt.UNSIGNED_INT]=((s={})[Pt.RGBA_INTEGER]=t.RGBA32UI,s[Pt.RGB_INTEGER]=t.RGB32UI,s[Pt.RG_INTEGER]=t.RG32UI,s[Pt.RED_INTEGER]=t.R32UI,s[Pt.DEPTH_COMPONENT]=t.DEPTH_COMPONENT24,s),e[Tt.INT]=((a={})[Pt.RGBA_INTEGER]=t.RGBA32I,a[Pt.RGB_INTEGER]=t.RGB32I,a[Pt.RG_INTEGER]=t.RG32I,a[Pt.RED_INTEGER]=t.R32I,a),e[Tt.FLOAT]=((l={})[Pt.RGBA]=t.RGBA32F,l[Pt.RGB]=t.RGB32F,l[Pt.RG]=t.RG32F,l[Pt.RED]=t.R32F,l[Pt.DEPTH_COMPONENT]=t.DEPTH_COMPONENT32F,l),e[Tt.HALF_FLOAT]=((u={})[Pt.RGBA]=t.RGBA16F,u[Pt.RGB]=t.RGB16F,u[Pt.RG]=t.RG16F,u[Pt.RED]=t.R16F,u),e[Tt.UNSIGNED_SHORT_5_6_5]=((h={})[Pt.RGB]=t.RGB565,h),e[Tt.UNSIGNED_SHORT_4_4_4_4]=((c={})[Pt.RGBA]=t.RGBA4,c),e[Tt.UNSIGNED_SHORT_5_5_5_1]=((p={})[Pt.RGBA]=t.RGB5_A1,p),e[Tt.UNSIGNED_INT_2_10_10_10_REV]=((d={})[Pt.RGBA]=t.RGB10_A2,d[Pt.RGBA_INTEGER]=t.RGB10_A2UI,d),e[Tt.UNSIGNED_INT_10F_11F_11F_REV]=((f={})[Pt.RGB]=t.R11F_G11F_B10F,f),e[Tt.UNSIGNED_INT_5_9_9_9_REV]=((m={})[Pt.RGB]=t.RGB9_E5,m),e[Tt.UNSIGNED_INT_24_8]=((y={})[Pt.DEPTH_STENCIL]=t.DEPTH24_STENCIL8,y),e[Tt.FLOAT_32_UNSIGNED_INT_24_8_REV]=((g={})[Pt.DEPTH_STENCIL]=t.DEPTH32F_STENCIL8,g),P=e):((v={})[Tt.UNSIGNED_BYTE]=((_={})[Pt.RGBA]=t.RGBA,_[Pt.RGB]=t.RGB,_[Pt.ALPHA]=t.ALPHA,_[Pt.LUMINANCE]=t.LUMINANCE,_[Pt.LUMINANCE_ALPHA]=t.LUMINANCE_ALPHA,_),v[Tt.UNSIGNED_SHORT_5_6_5]=((x={})[Pt.RGB]=t.RGB,x),v[Tt.UNSIGNED_SHORT_4_4_4_4]=((b={})[Pt.RGBA]=t.RGBA,b),v[Tt.UNSIGNED_SHORT_5_5_5_1]=((w={})[Pt.RGBA]=t.RGBA,w),P=v),P}(t);var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(var n=0;n<e;n++)this.boundTextures[n]=null;this.emptyTextures={};var i=new ns(t.createTexture());for(t.bindTexture(t.TEXTURE_2D,i.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=i,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new ns(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture),n=0;n<6;n++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);for(t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR),n=0;n<this.boundTextures.length;n++)this.bind(null,n)},t.prototype.bind=function(t,e){void 0===e&&(e=0);var n=this.gl;if(t=t?.castToBaseTexture(),t&&t.valid&&!t.parentTextureArray){t.touched=this.renderer.textureGC.count;var i=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,n.activeTexture(n.TEXTURE0+e)),n.bindTexture(t.target,i.texture)),i.dirtyId!==t.dirtyId&&(this.currentLocation!==e&&(this.currentLocation=e,n.activeTexture(n.TEXTURE0+e)),this.updateTexture(t)),this.boundTextures[e]=t}else this.currentLocation!==e&&(this.currentLocation=e,n.activeTexture(n.TEXTURE0+e)),n.bindTexture(n.TEXTURE_2D,this.emptyTextures[n.TEXTURE_2D].texture),this.boundTextures[e]=null},t.prototype.reset=function(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture},t.prototype.unbind=function(t){var e=this.gl,n=this.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var i=0;i<n.length;i++)n[i]===this.unknownTexture&&this.bind(null,i)}for(i=0;i<n.length;i++)n[i]===t&&(this.currentLocation!==i&&(e.activeTexture(e.TEXTURE0+i),this.currentLocation=i),e.bindTexture(t.target,this.emptyTextures[t.target].texture),n[i]=null)},t.prototype.ensureSamplerType=function(t){var e=this,n=e.boundTextures,i=e.hasIntegerTextures,r=e.CONTEXT_UID;if(i)for(var o=t-1;o>=0;--o){var s=n[o];s&&s._glTextures[r].samplerType!==St.FLOAT&&this.renderer.texture.unbind(s)}},t.prototype.initTexture=function(t){var e=new ns(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e},t.prototype.initTextureType=function(t,e){var n,i;e.internalFormat=null!==(i=null===(n=this.internalFormats[t.type])||void 0===n?void 0:n[t.format])&&void 0!==i?i:t.format,2===this.webGLVersion&&t.type===Tt.HALF_FLOAT?e.type=this.gl.HALF_FLOAT:e.type=t.type},t.prototype.updateTexture=function(t){var e=t._glTextures[this.CONTEXT_UID];if(e){var n=this.renderer;if(this.initTextureType(t,e),t.resource&&t.resource.upload(n,t,e))e.samplerType!==St.FLOAT&&(this.hasIntegerTextures=!0);else{var i=t.realWidth,r=t.realHeight,o=n.gl;(e.width!==i||e.height!==r||e.dirtyId<0)&&(e.width=i,e.height=r,o.texImage2D(t.target,0,e.internalFormat,i,r,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId}},t.prototype.destroyTexture=function(t,e){var n=this.gl;if((t=t.castToBaseTexture())._glTextures[this.CONTEXT_UID]&&(this.unbind(t),n.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){var i=this.managedTextures.indexOf(t);-1!==i&&Jn(this.managedTextures,i,1)}},t.prototype.updateTextureStyle=function(t){var e=t._glTextures[this.CONTEXT_UID];!e||(t.mipmap!==At.POW2&&2===this.webGLVersion||t.isPowerOfTwo?e.mipmap=t.mipmap>=1:e.mipmap=!1,2===this.webGLVersion||t.isPowerOfTwo?e.wrapMode=t.wrapMode:e.wrapMode=It.CLAMP,t.resource&&t.resource.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId)},t.prototype.setStyle=function(t,e){var n=this.gl;if(e.mipmap&&t.mipmap!==At.ON_MANUAL&&n.generateMipmap(t.target),n.texParameteri(t.target,n.TEXTURE_WRAP_S,e.wrapMode),n.texParameteri(t.target,n.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){n.texParameteri(t.target,n.TEXTURE_MIN_FILTER,t.scaleMode===Ct.LINEAR?n.LINEAR_MIPMAP_LINEAR:n.NEAREST_MIPMAP_NEAREST);var i=this.renderer.context.extensions.anisotropicFiltering;if(i&&t.anisotropicLevel>0&&t.scaleMode===Ct.LINEAR){var r=Math.min(t.anisotropicLevel,n.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT));n.texParameterf(t.target,i.TEXTURE_MAX_ANISOTROPY_EXT,r)}}else n.texParameteri(t.target,n.TEXTURE_MIN_FILTER,t.scaleMode===Ct.LINEAR?n.LINEAR:n.NEAREST);n.texParameteri(t.target,n.TEXTURE_MAG_FILTER,t.scaleMode===Ct.LINEAR?n.LINEAR:n.NEAREST)},t.prototype.destroy=function(){this.renderer=null},t}(),rs=new Ci,os=function(t){function e(e,n){void 0===e&&(e=_t.UNKNOWN);var i=t.call(this)||this;return n=Object.assign({},xe.RENDER_OPTIONS,n),i.options=n,i.type=e,i.screen=new xi(0,0,n.width,n.height),i.view=n.view||document.createElement("canvas"),i.resolution=n.resolution||xe.RESOLUTION,i.useContextAlpha=n.useContextAlpha,i.autoDensity=!!n.autoDensity,i.preserveDrawingBuffer=n.preserveDrawingBuffer,i.clearBeforeRender=n.clearBeforeRender,i._backgroundColor=0,i._backgroundColorRgba=[0,0,0,1],i._backgroundColorString="#000000",i.backgroundColor=n.backgroundColor||i._backgroundColor,i.backgroundAlpha=n.backgroundAlpha,void 0!==n.transparent&&(ri("6.0.0","Option transparent is deprecated, please use backgroundAlpha instead."),i.useContextAlpha=n.transparent,i.backgroundAlpha=n.transparent?0:1),i._lastObjectRendered=null,i.plugins={},i}return dr(e,t),e.prototype.initPlugins=function(t){for(var e in t)this.plugins[e]=new t[e](this)},Object.defineProperty(e.prototype,"width",{get:function(){return this.view.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.view.height},enumerable:!1,configurable:!0}),e.prototype.resize=function(t,e){this.view.width=Math.round(t*this.resolution),this.view.height=Math.round(e*this.resolution);var n=this.view.width/this.resolution,i=this.view.height/this.resolution;this.screen.width=n,this.screen.height=i,this.autoDensity&&(this.view.style.width=n+"px",this.view.style.height=i+"px"),this.emit("resize",n,i)},e.prototype.generateTexture=function(t,e,n,i){void 0===e&&(e={}),"number"==typeof e&&(ri("6.1.0","generateTexture options (scaleMode, resolution, region) are now object options."),e={scaleMode:e,resolution:n,region:i});var r=e.region,o=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&(n[i[r]]=t[i[r]])}return n}(e,["region"]);0===(i=r||t.getLocalBounds(null,!0)).width&&(i.width=1),0===i.height&&(i.height=1);var s=kr.create(fr({width:i.width,height:i.height},o));return rs.tx=-i.x,rs.ty=-i.y,this.render(t,{renderTexture:s,clear:!1,transform:rs,skipUpdateTransform:!!t.parent}),s},e.prototype.destroy=function(t){for(var e in this.plugins)this.plugins[e].destroy(),this.plugins[e]=null;t&&this.view.parentNode&&this.view.parentNode.removeChild(this.view);var n=this;n.plugins=null,n.type=_t.UNKNOWN,n.view=null,n.screen=null,n._tempDisplayObjectParent=null,n.options=null,this._backgroundColorRgba=null,this._backgroundColorString=null,this._lastObjectRendered=null},Object.defineProperty(e.prototype,"backgroundColor",{get:function(){return this._backgroundColor},set:function(t){this._backgroundColor=t,this._backgroundColorString=Gn(t),Yn(t,this._backgroundColorRgba)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"backgroundAlpha",{get:function(){return this._backgroundColorRgba[3]},set:function(t){this._backgroundColorRgba[3]=t},enumerable:!1,configurable:!0}),e}(Ee),ss=function(t){this.buffer=t||null,this.updateID=-1,this.byteLength=-1,this.refCount=0},as=function(){function t(t){this.renderer=t,this.managedBuffers={},this.boundBufferBases={}}return t.prototype.destroy=function(){this.renderer=null},t.prototype.contextChange=function(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID},t.prototype.bind=function(t){var e=this.gl,n=this.CONTEXT_UID,i=t._glBuffers[n]||this.createGLBuffer(t);e.bindBuffer(t.type,i.buffer)},t.prototype.bindBufferBase=function(t,e){var n=this.gl,i=this.CONTEXT_UID;if(this.boundBufferBases[e]!==t){var r=t._glBuffers[i]||this.createGLBuffer(t);this.boundBufferBases[e]=t,n.bindBufferBase(n.UNIFORM_BUFFER,e,r.buffer)}},t.prototype.bindBufferRange=function(t,e,n){var i=this.gl,r=this.CONTEXT_UID;n=n||0;var o=t._glBuffers[r]||this.createGLBuffer(t);i.bindBufferRange(i.UNIFORM_BUFFER,e||0,o.buffer,256*n,256)},t.prototype.update=function(t){var e=this.gl,n=this.CONTEXT_UID,i=t._glBuffers[n];if(t._updateID!==i.updateID)if(i.updateID=t._updateID,e.bindBuffer(t.type,i.buffer),i.byteLength>=t.data.byteLength)e.bufferSubData(t.type,0,t.data);else{var r=t.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;i.byteLength=t.data.byteLength,e.bufferData(t.type,t.data,r)}},t.prototype.dispose=function(t,e){if(this.managedBuffers[t.id]){delete this.managedBuffers[t.id];var n=t._glBuffers[this.CONTEXT_UID],i=this.gl;t.disposeRunner.remove(this),n&&(e||i.deleteBuffer(n.buffer),delete t._glBuffers[this.CONTEXT_UID])}},t.prototype.disposeAll=function(t){for(var e=Object.keys(this.managedBuffers),n=0;n<e.length;n++)this.dispose(this.managedBuffers[e[n]],t)},t.prototype.createGLBuffer=function(t){var e=this.CONTEXT_UID,n=this.gl;return t._glBuffers[e]=new ss(n.createBuffer()),this.managedBuffers[t.id]=t,t.disposeRunner.add(this),t._glBuffers[e]},t}(),ls=function(t){function e(n){var i=t.call(this,_t.WEBGL,n)||this;return n=i.options,i.gl=null,i.CONTEXT_UID=0,i.runners={destroy:new ur("destroy"),contextChange:new ur("contextChange"),reset:new ur("reset"),update:new ur("update"),postrender:new ur("postrender"),prerender:new ur("prerender"),resize:new ur("resize")},i.runners.contextChange.add(i),i.globalUniforms=new qr({projectionMatrix:new Ci},!0),i.addSystem(Bo,"mask").addSystem(no,"context").addSystem(ts,"state").addSystem(Jo,"shader").addSystem(is,"texture").addSystem(as,"buffer").addSystem(ao,"geometry").addSystem(oo,"framebuffer").addSystem(Xo,"scissor").addSystem(Yo,"stencil").addSystem(Go,"projection").addSystem(es,"textureGC").addSystem(Qr,"filter").addSystem(jo,"renderTexture").addSystem(to,"batch"),i.initPlugins(e.__plugins),i.multisample=void 0,n.context?i.context.initFromContext(n.context):i.context.initFromOptions({alpha:!!i.useContextAlpha,antialias:n.antialias,premultipliedAlpha:i.useContextAlpha&&"notMultiplied"!==i.useContextAlpha,stencil:!0,preserveDrawingBuffer:n.preserveDrawingBuffer,powerPreference:i.options.powerPreference}),i.renderingToScreen=!0,Un(2===i.context.webGLVersion?"WebGL 2":"WebGL 1"),i.resize(i.options.width,i.options.height),i}return dr(e,t),e.create=function(t){if(zn())return new e(t);throw new Error('WebGL unsupported in this browser, use "pixi.js-legacy" for fallback canvas2d support.')},e.prototype.contextChange=function(){var t,e=this.gl;if(1===this.context.webGLVersion){var n=e.getParameter(e.FRAMEBUFFER_BINDING);e.bindFramebuffer(e.FRAMEBUFFER,null),t=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.FRAMEBUFFER,n)}else n=e.getParameter(e.DRAW_FRAMEBUFFER_BINDING),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),t=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,n);t>=kt.HIGH?this.multisample=kt.HIGH:t>=kt.MEDIUM?this.multisample=kt.MEDIUM:t>=kt.LOW?this.multisample=kt.LOW:this.multisample=kt.NONE},e.prototype.addSystem=function(t,e){var n=new t(this);if(this[e])throw new Error('Whoops! The name "'+e+'" is already in use');for(var i in this[e]=n,this.runners)this.runners[i].add(n);return this},e.prototype.render=function(t,e){var n,i,r,o;if(e&&(e instanceof kr?(ri("6.0.0","Renderer#render arguments changed, use options instead."),n=e,i=arguments[2],r=arguments[3],o=arguments[4]):(n=e.renderTexture,i=e.clear,r=e.transform,o=e.skipUpdateTransform)),this.renderingToScreen=!n,this.runners.prerender.emit(),this.emit("prerender"),this.projection.transform=r,!this.context.isLost){if(n||(this._lastObjectRendered=t),!o){var s=t.enableTempParent();t.updateTransform(),t.disableTempParent(s)}this.renderTexture.bind(n),this.batch.currentRenderer.start(),(void 0!==i?i:this.clearBeforeRender)&&this.renderTexture.clear(),t.render(this),this.batch.currentRenderer.flush(),n&&n.baseTexture.update(),this.runners.postrender.emit(),this.projection.transform=null,this.emit("postrender")}},e.prototype.generateTexture=function(e,n,i,r){void 0===n&&(n={});var o=t.prototype.generateTexture.call(this,e,n,i,r);return this.framebuffer.blit(),o},e.prototype.resize=function(e,n){t.prototype.resize.call(this,e,n),this.runners.resize.emit(this.screen.height,this.screen.width)},e.prototype.reset=function(){return this.runners.reset.emit(),this},e.prototype.clear=function(){this.renderTexture.bind(),this.renderTexture.clear()},e.prototype.destroy=function(e){for(var n in this.runners.destroy.emit(),this.runners)this.runners[n].destroy();t.prototype.destroy.call(this,e),this.gl=null},Object.defineProperty(e.prototype,"extract",{get:function(){return ri("6.0.0","Renderer#extract has been deprecated, please use Renderer#plugins.extract instead."),this.plugins.extract},enumerable:!1,configurable:!0}),e.registerPlugin=function(t,n){e.__plugins=e.__plugins||{},e.__plugins[t]=n},e}(os),us=function(){this.texArray=null,this.blend=0,this.type=wt.TRIANGLES,this.start=0,this.size=0,this.data=null},hs=function(){function t(){this.elements=[],this.ids=[],this.count=0}return t.prototype.clear=function(){for(var t=0;t<this.count;t++)this.elements[t]=null;this.count=0},t}(),cs=function(){function t(t){"number"==typeof t?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}return Object.defineProperty(t.prototype,"int8View",{get:function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"uint8View",{get:function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"int16View",{get:function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"uint16View",{get:function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"int32View",{get:function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},enumerable:!1,configurable:!0}),t.prototype.view=function(t){return this[t+"View"]},t.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},t.sizeOf=function(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(t+" isn't a valid view type")}},t}(),ps=function(t){function e(e){var n=t.call(this,e)||this;return n.shaderGenerator=null,n.geometryClass=null,n.vertexSize=null,n.state=Mo.for2d(),n.size=4*xe.SPRITE_BATCH_SIZE,n._vertexCount=0,n._indexCount=0,n._bufferedElements=[],n._bufferedTextures=[],n._bufferSize=0,n._shader=null,n._packedGeometries=[],n._packedGeometryPoolSize=2,n._flushId=0,n._aBuffers={},n._iBuffers={},n.MAX_TEXTURES=1,n.renderer.on("prerender",n.onPrerender,n),e.runners.contextChange.add(n),n._dcIndex=0,n._aIndex=0,n._iIndex=0,n._attributeBuffer=null,n._indexBuffer=null,n._tempBoundTextures=[],n}return dr(e,t),e.prototype.contextChange=function(){var t=this.renderer.gl;xe.PREFER_ENV===vt.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),xe.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=function(t,e){if(0===t)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var n=e.createShader(e.FRAGMENT_SHADER);;){var i=Co.replace(/%forloop%/gi,Io(t));if(e.shaderSource(n,i),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS))break;t=t/2|0}return t}(this.MAX_TEXTURES,t)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()},e.prototype.initFlushBuffers=function(){for(var t=e._drawCallPool,n=e._textureArrayPool,i=this.size/4,r=Math.floor(i/this.MAX_TEXTURES)+1;t.length<i;)t.push(new us);for(;n.length<r;)n.push(new hs);for(var o=0;o<this.MAX_TEXTURES;o++)this._tempBoundTextures[o]=null},e.prototype.onPrerender=function(){this._flushId=0},e.prototype.render=function(t){!t._texture.valid||(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)},e.prototype.buildTexturesAndDrawCalls=function(){var t=this._bufferedTextures,n=this.MAX_TEXTURES,i=e._textureArrayPool,r=this.renderer.batch,o=this._tempBoundTextures,s=this.renderer.textureGC.count,a=++vr._globalBatch,l=0,u=i[0],h=0;r.copyBoundTextures(o,n);for(var c=0;c<this._bufferSize;++c){var p=t[c];t[c]=null,p._batchEnabled!==a&&(u.count>=n&&(r.boundArray(u,o,a,n),this.buildDrawCalls(u,h,c),h=c,u=i[++l],++a),p._batchEnabled=a,p.touched=s,u.elements[u.count++]=p)}for(u.count>0&&(r.boundArray(u,o,a,n),this.buildDrawCalls(u,h,this._bufferSize),++l,++a),c=0;c<o.length;c++)o[c]=null;vr._globalBatch=a},e.prototype.buildDrawCalls=function(t,n,i){var r=this,o=r._bufferedElements,s=r._attributeBuffer,a=r._indexBuffer,l=r.vertexSize,u=e._drawCallPool,h=this._dcIndex,c=this._aIndex,p=this._iIndex,d=u[h];d.start=this._iIndex,d.texArray=t;for(var f=n;f<i;++f){var m=o[f],y=m._texture.baseTexture,g=jn[y.alphaMode?1:0][m.blendMode];o[f]=null,n<f&&d.blend!==g&&(d.size=p-d.start,n=f,(d=u[++h]).texArray=t,d.start=p),this.packInterleavedGeometry(m,s,a,c,p),c+=m.vertexData.length/2*l,p+=m.indices.length,d.blend=g}n<i&&(d.size=p-d.start,++h),this._dcIndex=h,this._aIndex=c,this._iIndex=p},e.prototype.bindAndClearTexArray=function(t){for(var e=this.renderer.texture,n=0;n<t.count;n++)e.bind(t.elements[n],t.ids[n]),t.elements[n]=null;t.count=0},e.prototype.updateGeometry=function(){var t=this,e=t._packedGeometries,n=t._attributeBuffer,i=t._indexBuffer;xe.CAN_UPLOAD_SAME_BUFFER?(e[this._flushId]._buffer.update(n.rawBinaryData),e[this._flushId]._indexBuffer.update(i),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,e[this._flushId]=new this.geometryClass),e[this._flushId]._buffer.update(n.rawBinaryData),e[this._flushId]._indexBuffer.update(i),this.renderer.geometry.bind(e[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},e.prototype.drawBatches=function(){for(var t=this._dcIndex,n=this.renderer,i=n.gl,r=n.state,o=e._drawCallPool,s=null,a=0;a<t;a++){var l=o[a],u=l.texArray,h=l.type,c=l.size,p=l.start,d=l.blend;s!==u&&(s=u,this.bindAndClearTexArray(u)),this.state.blendMode=d,r.set(this.state),i.drawElements(h,c,i.UNSIGNED_SHORT,2*p)}},e.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},e.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.MAX_TEXTURES),this.renderer.shader.bind(this._shader),xe.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},e.prototype.stop=function(){this.flush()},e.prototype.destroy=function(){for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),t.prototype.destroy.call(this)},e.prototype.getAttributeBuffer=function(t){var e=Zn(Math.ceil(t/8)),n=Qn(e),i=8*e;this._aBuffers.length<=n&&(this._iBuffers.length=n+1);var r=this._aBuffers[i];return r||(this._aBuffers[i]=r=new cs(i*this.vertexSize*4)),r},e.prototype.getIndexBuffer=function(t){var e=Zn(Math.ceil(t/12)),n=Qn(e),i=12*e;this._iBuffers.length<=n&&(this._iBuffers.length=n+1);var r=this._iBuffers[n];return r||(this._iBuffers[n]=r=new Uint16Array(i)),r},e.prototype.packInterleavedGeometry=function(t,e,n,i,r){for(var o=e.uint32View,s=e.float32View,a=i/this.vertexSize,l=t.uvs,u=t.indices,h=t.vertexData,c=t._texture.baseTexture._batchLocation,p=Math.min(t.worldAlpha,1),d=p<1&&t._texture.baseTexture.alphaMode?Vn(t._tintRGB,p):t._tintRGB+(255*p<<24),f=0;f<h.length;f+=2)s[i++]=h[f],s[i++]=h[f+1],s[i++]=l[f],s[i++]=l[f+1],o[i++]=d,s[i++]=c;for(f=0;f<u.length;f++)n[r++]=a+u[f]},e._drawCallPool=[],e._textureArrayPool=[],e}(Jr),ds=function(){function t(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},e.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(e.indexOf("%forloop%")<0)throw new Error('Fragment template must contain "%forloop%".')}return t.prototype.generateShader=function(t){if(!this.programCache[t]){for(var e=new Int32Array(t),n=0;n<t;n++)e[n]=n;this.defaultGroupCache[t]=qr.from({uSamplers:e},!0);var i=this.fragTemplate;i=(i=i.replace(/%count%/gi,""+t)).replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new No(this.vertexSrc,i)}var r={tint:new Float32Array([1,1,1,1]),translationMatrix:new Ci,default:this.defaultGroupCache[t]};return new Lo(this.programCache[t],r)},t.prototype.generateSampleSrc=function(t){var e="";e+="\n",e+="\n";for(var n=0;n<t;n++)n>0&&(e+="\nelse "),n<t-1&&(e+="if(vTextureId < "+n+".5)"),e+="\n{",e+="\n\tcolor = texture2D(uSamplers["+n+"], vTextureCoord);",e+="\n}";return(e+="\n")+"\n"},t}(),fs=function(t){function e(e){void 0===e&&(e=!1);var n=t.call(this)||this;return n._buffer=new Ur(null,e,!1),n._indexBuffer=new Ur(null,e,!0),n.addAttribute("aVertexPosition",n._buffer,2,!1,Tt.FLOAT).addAttribute("aTextureCoord",n._buffer,2,!1,Tt.FLOAT).addAttribute("aColor",n._buffer,4,!0,Tt.UNSIGNED_BYTE).addAttribute("aTextureId",n._buffer,1,!0,Tt.FLOAT).addIndex(n._indexBuffer),n}return dr(e,t),e}(Hr),ms="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n",ys="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",gs=function(){function t(){}return t.create=function(t){var e=Object.assign({vertex:ms,fragment:ys,geometryClass:fs,vertexSize:6},t),n=e.vertex,i=e.fragment,r=e.vertexSize,o=e.geometryClass;return function(t){function e(e){var s=t.call(this,e)||this;return s.shaderGenerator=new ds(n,i),s.geometryClass=o,s.vertexSize=r,s}return dr(e,t),e}(ps)},Object.defineProperty(t,"defaultVertexSrc",{get:function(){return ms},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultFragmentTemplate",{get:function(){return ys},enumerable:!1,configurable:!0}),t}(),vs=gs.create();lr.prototype._renderCanvas=function(t){},lr.prototype.renderCanvas=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable){this._mask&&t.maskManager.pushMask(this._mask),this._renderCanvas(t);for(var e=0,n=this.children.length;e<n;++e)this.children[e].renderCanvas(t);this._mask&&t.maskManager.popMask(t)}},or.prototype.renderCanvas=function(t){};var _s,xs,bs=function(t,e){return(bs=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},ws=new Ti,Ps=new Uint16Array([0,1,2,0,2,3]),Es=function(t){function e(e){var n=t.call(this)||this;return n._anchor=new Si(n._onAnchorUpdate,n,e?e.defaultAnchor.x:0,e?e.defaultAnchor.y:0),n._texture=null,n._width=0,n._height=0,n._tint=null,n._tintRGB=null,n.tint=16777215,n.blendMode=bt.NORMAL,n._cachedTint=16777215,n.uvs=null,n.texture=e||Mr.EMPTY,n.vertexData=new Float32Array(8),n.vertexTrimmedData=null,n._transformID=-1,n._textureID=-1,n._transformTrimmedID=-1,n._textureTrimmedID=-1,n.indices=Ps,n.pluginName="batch",n.isSprite=!0,n._roundPixels=xe.ROUND_PIXELS,n}return function(t,e){function n(){this.constructor=t}bs(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype._onTextureUpdate=function(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=ti(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=ti(this.scale.y)*this._height/this._texture.orig.height)},e.prototype._onAnchorUpdate=function(){this._transformID=-1,this._transformTrimmedID=-1},e.prototype.calculateVertices=function(){var t=this._texture;if(this._transformID!==this.transform._worldID||this._textureID!==t._updateID){this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;var e=this.transform.worldTransform,n=e.a,i=e.b,r=e.c,o=e.d,s=e.tx,a=e.ty,l=this.vertexData,u=t.trim,h=t.orig,c=this._anchor,p=0,d=0,f=0,m=0;if(u?(p=(d=u.x-c._x*h.width)+u.width,f=(m=u.y-c._y*h.height)+u.height):(p=(d=-c._x*h.width)+h.width,f=(m=-c._y*h.height)+h.height),l[0]=n*d+r*m+s,l[1]=o*m+i*d+a,l[2]=n*p+r*m+s,l[3]=o*m+i*p+a,l[4]=n*p+r*f+s,l[5]=o*f+i*p+a,l[6]=n*d+r*f+s,l[7]=o*f+i*d+a,this._roundPixels)for(var y=xe.RESOLUTION,g=0;g<l.length;++g)l[g]=Math.round((l[g]*y|0)/y)}},e.prototype.calculateTrimmedVertices=function(){if(this.vertexTrimmedData){if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;var t=this._texture,e=this.vertexTrimmedData,n=t.orig,i=this._anchor,r=this.transform.worldTransform,o=r.a,s=r.b,a=r.c,l=r.d,u=r.tx,h=r.ty,c=-i._x*n.width,p=c+n.width,d=-i._y*n.height,f=d+n.height;e[0]=o*c+a*d+u,e[1]=l*d+s*c+h,e[2]=o*p+a*d+u,e[3]=l*d+s*p+h,e[4]=o*p+a*f+u,e[5]=l*f+s*p+h,e[6]=o*c+a*f+u,e[7]=l*f+s*c+h},e.prototype._render=function(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)},e.prototype._calculateBounds=function(){var t=this._texture.trim,e=this._texture.orig;!t||t.width===e.width&&t.height===e.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))},e.prototype.getLocalBounds=function(e){return 0===this.children.length?(this._localBounds||(this._localBounds=new Fi),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new xi),e=this._localBoundsRect),this._localBounds.getRectangle(e)):t.prototype.getLocalBounds.call(this,e)},e.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,ws);var e=this._texture.orig.width,n=this._texture.orig.height,i=-e*this.anchor.x,r=0;return ws.x>=i&&ws.x<i+e&&(r=-n*this.anchor.y,ws.y>=r&&ws.y<r+n)},e.prototype.destroy=function(e){if(t.prototype.destroy.call(this,e),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,"boolean"==typeof e?e:e&&e.texture){var n="boolean"==typeof e?e:e&&e.baseTexture;this._texture.destroy(!!n)}this._texture=null},e.from=function(t,n){return new e(t instanceof Mr?t:Mr.from(t,n))},Object.defineProperty(e.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return Math.abs(this.scale.x)*this._texture.orig.width},set:function(t){var e=ti(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return Math.abs(this.scale.y)*this._texture.orig.height},set:function(t){var e=ti(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"anchor",{get:function(){return this._anchor},set:function(t){this._anchor.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){this._tint=t,this._tintRGB=(t>>16)+(65280&t)+((255&t)<<16)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"texture",{get:function(){return this._texture},set:function(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||Mr.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))},enumerable:!1,configurable:!0}),e}(lr);!function(t){t.MITER="miter",t.BEVEL="bevel",t.ROUND="round"}(_s||(_s={})),function(t){t.BUTT="butt",t.ROUND="round",t.SQUARE="square"}(xs||(xs={}));var Ts={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount:function(t,e){if(void 0===e&&(e=20),!this.adaptive||!t||isNaN(t))return e;var n=Math.ceil(t/this.maxLength);return n<this.minSegments?n=this.minSegments:n>this.maxSegments&&(n=this.maxSegments),n}},Ss=function(){function t(){this.color=16777215,this.alpha=1,this.texture=Mr.WHITE,this.matrix=null,this.visible=!1,this.reset()}return t.prototype.clone=function(){var e=new t;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e},t.prototype.reset=function(){this.color=16777215,this.alpha=1,this.texture=Mr.WHITE,this.matrix=null,this.visible=!1},t.prototype.destroy=function(){this.texture=null,this.matrix=null},t}(),Cs=function(t,e){return(Cs=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function Is(t,e){function n(){this.constructor=t}Cs(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var As={build:function(t){t.points=t.shape.points.slice()},triangulate:function(t,e){var n=t.points,i=t.holes,r=e.points,o=e.indices;if(n.length>=6){for(var s=[],a=0;a<i.length;a++){var l=i[a];s.push(n.length/2),n=n.concat(l.points)}var u=Te.exports(n,s,2);if(!u)return;var h=r.length/2;for(a=0;a<u.length;a+=3)o.push(u[a]+h),o.push(u[a+1]+h),o.push(u[a+2]+h);for(a=0;a<n.length;a++)r.push(n[a])}}},Os={build:function(t){var e,n,i=t.shape,r=t.points,o=i.x,s=i.y;if(r.length=0,t.type===mi.CIRC)e=i.radius,n=i.radius;else{var a=t.shape;e=a.width,n=a.height}if(0!==e&&0!==n){var l=Math.floor(30*Math.sqrt(i.radius))||Math.floor(15*Math.sqrt(e+n));l/=2.3;for(var u=2*Math.PI/l,h=0;h<l-.5;h++)r.push(o+Math.sin(-u*h)*e,s+Math.cos(-u*h)*n);r.push(r[0],r[1])}},triangulate:function(t,e){var n=t.points,i=e.points,r=e.indices,o=i.length/2,s=o,a=t.shape,l=t.matrix,u=a.x,h=a.y;i.push(t.matrix?l.a*u+l.c*h+l.tx:u,t.matrix?l.b*u+l.d*h+l.ty:h);for(var c=0;c<n.length;c+=2)i.push(n[c],n[c+1]),r.push(o++,s,o)}};function Ns(t,e,n){return t+(e-t)*n}function Ls(t,e,n,i,r,o,s){void 0===s&&(s=[]);for(var a=s,l=0,u=0,h=0,c=0,p=0,d=0,f=0,m=0;f<=20;++f)l=Ns(t,n,m=f/20),u=Ns(e,i,m),h=Ns(n,r,m),c=Ns(i,o,m),p=Ns(l,h,m),d=Ns(u,c,m),(0!==f||a[a.length-2]!==p||a[a.length-1]!==d)&&a.push(p,d);return a}var Ms={build:function(t){var e=t.shape,n=t.points,i=e.x,r=e.y,o=e.width,s=e.height,a=Math.max(0,Math.min(e.radius,Math.min(o,s)/2));n.length=0,a?(Ls(i,r+a,i,r,i+a,r,n),Ls(i+o-a,r,i+o,r,i+o,r+a,n),Ls(i+o,r+s-a,i+o,r+s,i+o-a,r+s,n),Ls(i+a,r+s,i,r+s,i,r+s-a,n)):n.push(i,r,i+o,r,i+o,r+s,i,r+s)},triangulate:function(t,e){for(var n=t.points,i=e.points,r=e.indices,o=i.length/2,s=Te.exports(n,null,2),a=0,l=s.length;a<l;a+=3)r.push(s[a]+o),r.push(s[a+1]+o),r.push(s[a+2]+o);for(a=0,l=n.length;a<l;a++)i.push(n[a],n[++a])}};function Rs(t,e,n,i,r,o,s,a){var l,u;s?(l=i,u=-n):(l=-i,u=n);var h=t-n*r+l,c=e-i*r+u,p=t+n*o+l,d=e+i*o+u;return a.push(h,c),a.push(p,d),2}function ks(t,e,n,i,r,o,s,a){var l=n-t,u=i-e,h=Math.atan2(l,u),c=Math.atan2(r-t,o-e);a&&h<c?h+=2*Math.PI:!a&&h>c&&(c+=2*Math.PI);var p=h,d=c-h,f=Math.abs(d),m=Math.sqrt(l*l+u*u),y=1+(15*f*Math.sqrt(m)/Math.PI|0),g=d/y;if(p+=g,a){s.push(t,e),s.push(n,i);for(var v=1,_=p;v<y;v++,_+=g)s.push(t,e),s.push(t+Math.sin(_)*m,e+Math.cos(_)*m);s.push(t,e),s.push(r,o)}else{for(s.push(n,i),s.push(t,e),v=1,_=p;v<y;v++,_+=g)s.push(t+Math.sin(_)*m,e+Math.cos(_)*m),s.push(t,e);s.push(r,o),s.push(t,e)}return 2*y}function Ds(t,e){t.lineStyle.native?function(t,e){var n=0,i=t.shape,r=t.points||i.points,o=i.type!==mi.POLY||i.closeStroke;if(0!==r.length){var s=e.points,a=e.indices,l=r.length/2,u=s.length/2,h=u;for(s.push(r[0],r[1]),n=1;n<l;n++)s.push(r[2*n],r[2*n+1]),a.push(h,h+1),h++;o&&a.push(h,u)}}(t,e):function(t,e){var n=t.shape,i=t.points||n.points.slice(),r=e.closePointEps;if(0!==i.length){var o=t.lineStyle,s=new Ti(i[0],i[1]),a=new Ti(i[i.length-2],i[i.length-1]),l=n.type!==mi.POLY||n.closeStroke,u=Math.abs(s.x-a.x)<r&&Math.abs(s.y-a.y)<r;if(l){i=i.slice(),u&&(i.pop(),i.pop(),a.set(i[i.length-2],i[i.length-1]));var h=.5*(s.x+a.x),c=.5*(a.y+s.y);i.unshift(h,c),i.push(h,c)}var p=e.points,d=i.length/2,f=i.length,m=p.length/2,y=o.width/2,g=y*y,v=o.miterLimit*o.miterLimit,_=i[0],x=i[1],b=i[2],w=i[3],P=0,E=0,T=-(x-w),S=_-b,C=0,I=0,A=Math.sqrt(T*T+S*S);T/=A,S/=A,T*=y,S*=y;var O=o.alignment,N=2*(1-O),L=2*O;l||(o.cap===xs.ROUND?f+=ks(_-T*(N-L)*.5,x-S*(N-L)*.5,_-T*N,x-S*N,_+T*L,x+S*L,p,!0)+2:o.cap===xs.SQUARE&&(f+=Rs(_,x,T,S,N,L,!0,p))),p.push(_-T*N,x-S*N),p.push(_+T*L,x+S*L);for(var M=1;M<d-1;++M){_=i[2*(M-1)],x=i[2*(M-1)+1],b=i[2*M],w=i[2*M+1],P=i[2*(M+1)],E=i[2*(M+1)+1],T=-(x-w),S=_-b,T/=A=Math.sqrt(T*T+S*S),S/=A,T*=y,S*=y,C=-(w-E),I=b-P,C/=A=Math.sqrt(C*C+I*I),I/=A,C*=y,I*=y;var R=b-_,k=x-w,D=b-P,F=E-w,B=k*D-F*R,U=B<0;if(Math.abs(B)<.1)p.push(b-T*N,w-S*N),p.push(b+T*L,w+S*L);else{var z=(-T+_)*(-S+w)-(-T+b)*(-S+x),X=(-C+P)*(-I+w)-(-C+b)*(-I+E),Y=(R*X-D*z)/B,G=(F*z-k*X)/B,H=(Y-b)*(Y-b)+(G-w)*(G-w),W=b+(Y-b)*N,j=w+(G-w)*N,V=b-(Y-b)*L,q=w-(G-w)*L,$=U?N:L;H<=Math.min(R*R+k*k,D*D+F*F)+$*$*g?o.join===_s.BEVEL||H/g>v?(U?(p.push(W,j),p.push(b+T*L,w+S*L),p.push(W,j),p.push(b+C*L,w+I*L)):(p.push(b-T*N,w-S*N),p.push(V,q),p.push(b-C*N,w-I*N),p.push(V,q)),f+=2):o.join===_s.ROUND?U?(p.push(W,j),p.push(b+T*L,w+S*L),f+=ks(b,w,b+T*L,w+S*L,b+C*L,w+I*L,p,!0)+4,p.push(W,j),p.push(b+C*L,w+I*L)):(p.push(b-T*N,w-S*N),p.push(V,q),f+=ks(b,w,b-T*N,w-S*N,b-C*N,w-I*N,p,!1)+4,p.push(b-C*N,w-I*N),p.push(V,q)):(p.push(W,j),p.push(V,q)):(p.push(b-T*N,w-S*N),p.push(b+T*L,w+S*L),o.join===_s.BEVEL||H/g>v||(o.join===_s.ROUND?f+=U?ks(b,w,b+T*L,w+S*L,b+C*L,w+I*L,p,!0)+2:ks(b,w,b-T*N,w-S*N,b-C*N,w-I*N,p,!1)+2:(U?(p.push(V,q),p.push(V,q)):(p.push(W,j),p.push(W,j)),f+=2)),p.push(b-C*N,w-I*N),p.push(b+C*L,w+I*L),f+=2)}}_=i[2*(d-2)],x=i[2*(d-2)+1],b=i[2*(d-1)],T=-(x-(w=i[2*(d-1)+1])),S=_-b,T/=A=Math.sqrt(T*T+S*S),S/=A,T*=y,S*=y,p.push(b-T*N,w-S*N),p.push(b+T*L,w+S*L),l||(o.cap===xs.ROUND?f+=ks(b-T*(N-L)*.5,w-S*(N-L)*.5,b-T*N,w-S*N,b+T*L,w+S*L,p,!1)+2:o.cap===xs.SQUARE&&(f+=Rs(b,w,T,S,N,L,!1,p)));var Z=e.indices,K=Ts.epsilon*Ts.epsilon;for(M=m;M<f+m-2;++M)_=p[2*M],x=p[2*M+1],b=p[2*(M+1)],w=p[2*(M+1)+1],P=p[2*(M+2)],E=p[2*(M+2)+1],!(Math.abs(_*(w-E)+b*(E-x)+P*(x-w))<K)&&Z.push(M,M+1,M+2)}}(t,e)}var Fs,Bs=function(){function t(){}return t.curveTo=function(t,e,n,i,r,o){var s=o[o.length-2],a=o[o.length-1]-e,l=s-t,u=i-e,h=n-t,c=Math.abs(a*h-l*u);if(c<1e-8||0===r)return(o[o.length-2]!==t||o[o.length-1]!==e)&&o.push(t,e),null;var p=a*a+l*l,d=u*u+h*h,f=a*u+l*h,m=r*Math.sqrt(p)/c,y=r*Math.sqrt(d)/c,g=m*f/p,v=y*f/d,_=m*h+y*l,x=m*u+y*a,b=l*(y+g),w=a*(y+g),P=h*(m+v),E=u*(m+v);return{cx:_+t,cy:x+e,radius:r,startAngle:Math.atan2(w-x,b-_),endAngle:Math.atan2(E-x,P-_),anticlockwise:l*u>h*a}},t.arc=function(t,e,n,i,r,o,s,a,l){for(var u=s-o,h=Ts._segmentsCount(Math.abs(u)*r,40*Math.ceil(Math.abs(u)/gi)),c=u/(2*h),p=2*c,d=Math.cos(c),f=Math.sin(c),m=h-1,y=m%1/m,g=0;g<=m;++g){var v=c+o+p*(g+y*g),_=Math.cos(v),x=-Math.sin(v);l.push((d*_+f*x)*r+n,(d*-x+f*_)*r+i)}},t}(),Us=function(){function t(){}return t.curveLength=function(t,e,n,i,r,o,s,a){for(var l=0,u=0,h=0,c=0,p=0,d=0,f=0,m=0,y=0,g=0,v=0,_=t,x=e,b=1;b<=10;++b)g=_-(m=(f=(d=(p=1-(u=b/10))*p)*p)*t+3*d*u*n+3*p*(h=u*u)*r+(c=h*u)*s),v=x-(y=f*e+3*d*u*i+3*p*h*o+c*a),_=m,x=y,l+=Math.sqrt(g*g+v*v);return l},t.curveTo=function(e,n,i,r,o,s,a){var l=a[a.length-2],u=a[a.length-1];a.length-=2;var h=Ts._segmentsCount(t.curveLength(l,u,e,n,i,r,o,s)),c=0,p=0,d=0,f=0,m=0;a.push(l,u);for(var y=1,g=0;y<=h;++y)d=(p=(c=1-(g=y/h))*c)*c,m=(f=g*g)*g,a.push(d*l+3*p*g*e+3*c*f*i+m*o,d*u+3*p*g*n+3*c*f*r+m*s)},t}(),zs=function(){function t(){}return t.curveLength=function(t,e,n,i,r,o){var s=t-2*n+r,a=e-2*i+o,l=2*n-2*t,u=2*i-2*e,h=4*(s*s+a*a),c=4*(s*l+a*u),p=l*l+u*u,d=2*Math.sqrt(h+c+p),f=Math.sqrt(h),m=2*h*f,y=2*Math.sqrt(p),g=c/f;return(m*d+f*c*(d-y)+(4*p*h-c*c)*Math.log((2*f+g+d)/(g+y)))/(4*m)},t.curveTo=function(e,n,i,r,o){for(var s=o[o.length-2],a=o[o.length-1],l=Ts._segmentsCount(t.curveLength(s,a,e,n,i,r)),u=0,h=0,c=1;c<=l;++c){var p=c/l;u=s+(e-s)*p,h=a+(n-a)*p,o.push(u+(e+(i-e)*p-u)*p,h+(n+(r-n)*p-h)*p)}},t}(),Xs=function(){function t(){this.reset()}return t.prototype.begin=function(t,e,n){this.reset(),this.style=t,this.start=e,this.attribStart=n},t.prototype.end=function(t,e){this.attribSize=e-this.attribStart,this.size=t-this.start},t.prototype.reset=function(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0},t}(),Ys=((Fs={})[mi.POLY]=As,Fs[mi.CIRC]=Os,Fs[mi.ELIP]=Os,Fs[mi.RECT]={build:function(t){var e=t.shape,n=e.x,i=e.y,r=e.width,o=e.height,s=t.points;s.length=0,s.push(n,i,n+r,i,n+r,i+o,n,i+o)},triangulate:function(t,e){var n=t.points,i=e.points,r=i.length/2;i.push(n[0],n[1],n[2],n[3],n[6],n[7],n[4],n[5]),e.indices.push(r,r+1,r+2,r+1,r+2,r+3)}},Fs[mi.RREC]=Ms,Fs),Gs=[],Hs=[];function Ws(t){for(var e=t.points,n=0,i=0;i<e.length-2;i+=2)n+=(e[i+2]-e[i])*(e[i+3]+e[i+1]);return n>0}var js,Vs=function(){function t(t,e,n,i){void 0===e&&(e=null),void 0===n&&(n=null),void 0===i&&(i=null),this.points=[],this.holes=[],this.shape=t,this.lineStyle=n,this.fillStyle=e,this.matrix=i,this.type=t.type}return t.prototype.clone=function(){return new t(this.shape,this.fillStyle,this.lineStyle,this.matrix)},t.prototype.destroy=function(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null},t}(),qs=new Ti,$s=new Fi,Zs=function(t){function e(){var e=t.call(this)||this;return e.closePointEps=1e-4,e.boundsPadding=0,e.uvsFloat32=null,e.indicesUint16=null,e.batchable=!1,e.points=[],e.colors=[],e.uvs=[],e.indices=[],e.textureIds=[],e.graphicsData=[],e.drawCalls=[],e.batchDirty=-1,e.batches=[],e.dirty=0,e.cacheDirty=-1,e.clearDirty=0,e.shapeIndex=0,e._bounds=new Fi,e.boundsDirty=-1,e}return Is(e,t),Object.defineProperty(e.prototype,"bounds",{get:function(){return this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds},enumerable:!1,configurable:!0}),e.prototype.invalidate=function(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(var t=0;t<this.drawCalls.length;t++)this.drawCalls[t].texArray.clear(),Hs.push(this.drawCalls[t]);for(this.drawCalls.length=0,t=0;t<this.batches.length;t++){var e=this.batches[t];e.reset(),Gs.push(e)}this.batches.length=0},e.prototype.clear=function(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this},e.prototype.drawShape=function(t,e,n,i){void 0===e&&(e=null),void 0===n&&(n=null),void 0===i&&(i=null);var r=new Vs(t,e,n,i);return this.graphicsData.push(r),this.dirty++,this},e.prototype.drawHole=function(t,e){if(void 0===e&&(e=null),!this.graphicsData.length)return null;var n=new Vs(t,null,null,e),i=this.graphicsData[this.graphicsData.length-1];return n.lineStyle=i.lineStyle,i.holes.push(n),this.dirty++,this},e.prototype.destroy=function(){t.prototype.destroy.call(this);for(var e=0;e<this.graphicsData.length;++e)this.graphicsData[e].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null},e.prototype.containsPoint=function(t){for(var e=this.graphicsData,n=0;n<e.length;++n){var i=e[n];if(i.fillStyle.visible&&i.shape&&(i.matrix?i.matrix.applyInverse(t,qs):qs.copyFrom(t),i.shape.contains(qs.x,qs.y))){var r=!1;if(i.holes)for(var o=0;o<i.holes.length;o++)if(i.holes[o].shape.contains(qs.x,qs.y)){r=!0;break}if(!r)return!0}}return!1},e.prototype.updateBatches=function(t){if(this.graphicsData.length){if(this.validateBatching()){this.cacheDirty=this.dirty;var e=this.uvs,n=this.graphicsData,i=null,r=null;this.batches.length>0&&(r=(i=this.batches[this.batches.length-1]).style);for(var o=this.shapeIndex;o<n.length;o++){this.shapeIndex++;var s=n[o],a=s.fillStyle,l=s.lineStyle;Ys[s.type].build(s),s.matrix&&this.transformPoints(s.points,s.matrix);for(var u=0;u<2;u++){var h=0===u?a:l;if(h.visible){var c=h.texture.baseTexture,p=this.indices.length,d=this.points.length/2;c.wrapMode=It.REPEAT,0===u?this.processFill(s):this.processLine(s);var f=this.points.length/2-d;0!==f&&(i&&!this._compareStyles(r,h)&&(i.end(p,d),i=null),i||((i=Gs.pop()||new Xs).begin(h,p,d),this.batches.push(i),r=h),this.addUvs(this.points,e,h.texture,d,f,h.matrix))}}}var m=this.indices.length,y=this.points.length/2;if(i&&i.end(m,y),0===this.batches.length)return void(this.batchable=!0);if(this.indicesUint16&&this.indices.length===this.indicesUint16.length)this.indicesUint16.set(this.indices);else{var g=y>65535&&t;this.indicesUint16=g?new Uint32Array(this.indices):new Uint16Array(this.indices)}this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}}else this.batchable=!0},e.prototype._compareStyles=function(t,e){return!(!t||!e||t.texture.baseTexture!==e.texture.baseTexture||t.color+t.alpha!==e.color+e.alpha||!!t.native!=!!e.native)},e.prototype.validateBatching=function(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(var t=0,e=this.graphicsData.length;t<e;t++){var n=this.graphicsData[t],i=n.fillStyle,r=n.lineStyle;if(i&&!i.texture.baseTexture.valid||r&&!r.texture.baseTexture.valid)return!1}return!0},e.prototype.packBatches=function(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);for(var t=this.batches,e=0,n=t.length;e<n;e++)for(var i=t[e],r=0;r<i.size;r++){var o=i.start+r;this.indicesUint16[o]=this.indicesUint16[o]-i.attribStart}},e.prototype.isBatchable=function(){if(this.points.length>131070)return!1;for(var t=this.batches,n=0;n<t.length;n++)if(t[n].style.native)return!1;return this.points.length<2*e.BATCHABLE_SIZE},e.prototype.buildDrawCalls=function(){for(var t=++vr._globalBatch,e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),Hs.push(this.drawCalls[e]);this.drawCalls.length=0;var n=this.colors,i=this.textureIds,r=Hs.pop();r||((r=new us).texArray=new hs),r.texArray.count=0,r.start=0,r.size=0,r.type=wt.TRIANGLES;var o=0,s=null,a=0,l=!1,u=wt.TRIANGLES,h=0;for(this.drawCalls.push(r),e=0;e<this.batches.length;e++){var c=this.batches[e],p=c.style,d=p.texture.baseTexture;l!==!!p.native&&(u=(l=!!p.native)?wt.LINES:wt.TRIANGLES,s=null,o=8,t++),s!==d&&(s=d,d._batchEnabled!==t&&(8===o&&(t++,o=0,r.size>0&&((r=Hs.pop())||((r=new us).texArray=new hs),this.drawCalls.push(r)),r.start=h,r.size=0,r.texArray.count=0,r.type=u),d.touched=1,d._batchEnabled=t,d._batchLocation=o,d.wrapMode=It.REPEAT,r.texArray.elements[r.texArray.count++]=d,o++)),r.size+=c.size,h+=c.size,a=d._batchLocation,this.addColors(n,p.color,p.alpha,c.attribSize,c.attribStart),this.addTextureIds(i,a,c.attribSize,c.attribStart)}vr._globalBatch=t,this.packAttributes()},e.prototype.packAttributes=function(){for(var t=this.points,e=this.uvs,n=this.colors,i=this.textureIds,r=new ArrayBuffer(3*t.length*4),o=new Float32Array(r),s=new Uint32Array(r),a=0,l=0;l<t.length/2;l++)o[a++]=t[2*l],o[a++]=t[2*l+1],o[a++]=e[2*l],o[a++]=e[2*l+1],s[a++]=n[l],o[a++]=i[l];this._buffer.update(r),this._indexBuffer.update(this.indicesUint16)},e.prototype.processFill=function(t){t.holes.length?(this.processHoles(t.holes),As.triangulate(t,this)):Ys[t.type].triangulate(t,this)},e.prototype.processLine=function(t){Ds(t,this);for(var e=0;e<t.holes.length;e++)Ds(t.holes[e],this)},e.prototype.processHoles=function(t){for(var e=0;e<t.length;e++){var n=t[e];Ys[n.type].build(n),n.matrix&&this.transformPoints(n.points,n.matrix)}},e.prototype.calculateBounds=function(){var t=this._bounds,e=$s,n=Ci.IDENTITY;this._bounds.clear(),e.clear();for(var i=0;i<this.graphicsData.length;i++){var r=this.graphicsData[i],o=r.shape,s=r.type,a=r.lineStyle,l=r.matrix||Ci.IDENTITY,u=0;if(a&&a.visible){var h=a.alignment;u=a.width,s===mi.POLY?Ws(o)?u*=1-h:u*=h:u*=Math.max(0,h)}if(n!==l&&(e.isEmpty()||(t.addBoundsMatrix(e,n),e.clear()),n=l),s===mi.RECT||s===mi.RREC){var c=o;e.addFramePad(c.x,c.y,c.x+c.width,c.y+c.height,u,u)}else if(s===mi.CIRC){var p=o;e.addFramePad(p.x,p.y,p.x,p.y,p.radius+u,p.radius+u)}else if(s===mi.ELIP){var d=o;e.addFramePad(d.x,d.y,d.x,d.y,d.width+u,d.height+u)}else{var f=o;t.addVerticesMatrix(n,f.points,0,f.points.length,u,u)}}e.isEmpty()||t.addBoundsMatrix(e,n),t.pad(this.boundsPadding,this.boundsPadding)},e.prototype.transformPoints=function(t,e){for(var n=0;n<t.length/2;n++){var i=t[2*n],r=t[2*n+1];t[2*n]=e.a*i+e.c*r+e.tx,t[2*n+1]=e.b*i+e.d*r+e.ty}},e.prototype.addColors=function(t,e,n,i,r){void 0===r&&(r=0);var o=Vn((e>>16)+(65280&e)+((255&e)<<16),n);t.length=Math.max(t.length,r+i);for(var s=0;s<i;s++)t[r+s]=o},e.prototype.addTextureIds=function(t,e,n,i){void 0===i&&(i=0),t.length=Math.max(t.length,i+n);for(var r=0;r<n;r++)t[i+r]=e},e.prototype.addUvs=function(t,e,n,i,r,o){void 0===o&&(o=null);for(var s=0,a=e.length,l=n.frame;s<r;){var u=t[2*(i+s)],h=t[2*(i+s)+1];if(o){var c=o.a*u+o.c*h+o.tx;h=o.b*u+o.d*h+o.ty,u=c}s++,e.push(u/l.width,h/l.height)}var p=n.baseTexture;(l.width<p.width||l.height<p.height)&&this.adjustUvs(e,n,a,r)},e.prototype.adjustUvs=function(t,e,n,i){for(var r=e.baseTexture,o=1e-6,s=n+2*i,a=e.frame,l=a.width/r.width,u=a.height/r.height,h=a.x/a.width,c=a.y/a.height,p=Math.floor(t[n]+o),d=Math.floor(t[n+1]+o),f=n+2;f<s;f+=2)p=Math.min(p,Math.floor(t[f]+o)),d=Math.min(d,Math.floor(t[f+1]+o));for(h-=p,c-=d,f=n;f<s;f+=2)t[f]=(t[f]+h)*l,t[f+1]=(t[f+1]+c)*u},e.BATCHABLE_SIZE=100,e}(fs),Ks=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.width=0,e.alignment=.5,e.native=!1,e.cap=xs.BUTT,e.join=_s.MITER,e.miterLimit=10,e}return Is(e,t),e.prototype.clone=function(){var t=new e;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t},e.prototype.reset=function(){t.prototype.reset.call(this),this.color=0,this.alignment=.5,this.width=0,this.native=!1},e}(Ss),Qs=new Float32Array(3),Js={},ta=function(t){function e(e){void 0===e&&(e=null);var n=t.call(this)||this;return n.shader=null,n.pluginName="batch",n.currentPath=null,n.batches=[],n.batchTint=-1,n.batchDirty=-1,n.vertexData=null,n._fillStyle=new Ss,n._lineStyle=new Ks,n._matrix=null,n._holeMode=!1,n.state=Mo.for2d(),n._geometry=e||new Zs,n._geometry.refCount++,n._transformID=-1,n.tint=16777215,n.blendMode=bt.NORMAL,n}return Is(e,t),Object.defineProperty(e.prototype,"geometry",{get:function(){return this._geometry},enumerable:!1,configurable:!0}),e.prototype.clone=function(){return this.finishPoly(),new e(this._geometry)},Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){this._tint=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fill",{get:function(){return this._fillStyle},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"line",{get:function(){return this._lineStyle},enumerable:!1,configurable:!0}),e.prototype.lineStyle=function(t,e,n,i,r){return void 0===t&&(t=null),void 0===e&&(e=0),void 0===n&&(n=1),void 0===i&&(i=.5),void 0===r&&(r=!1),"number"==typeof t&&(t={width:t,color:e,alpha:n,alignment:i,native:r}),this.lineTextureStyle(t)},e.prototype.lineTextureStyle=function(t){t=Object.assign({width:0,texture:Mr.WHITE,color:t&&t.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1,cap:xs.BUTT,join:_s.MITER,miterLimit:10},t),this.currentPath&&this.startPoly();var e=t.width>0&&t.alpha>0;return e?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._lineStyle,{visible:e},t)):this._lineStyle.reset(),this},e.prototype.startPoly=function(){if(this.currentPath){var t=this.currentPath.points,e=this.currentPath.points.length;e>2&&(this.drawShape(this.currentPath),this.currentPath=new Pi,this.currentPath.closeStroke=!1,this.currentPath.points.push(t[e-2],t[e-1]))}else this.currentPath=new Pi,this.currentPath.closeStroke=!1},e.prototype.finishPoly=function(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)},e.prototype.moveTo=function(t,e){return this.startPoly(),this.currentPath.points[0]=t,this.currentPath.points[1]=e,this},e.prototype.lineTo=function(t,e){this.currentPath||this.moveTo(0,0);var n=this.currentPath.points,i=n[n.length-2],r=n[n.length-1];return(i!==t||r!==e)&&n.push(t,e),this},e.prototype._initCurve=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.currentPath?0===this.currentPath.points.length&&(this.currentPath.points=[t,e]):this.moveTo(t,e)},e.prototype.quadraticCurveTo=function(t,e,n,i){this._initCurve();var r=this.currentPath.points;return 0===r.length&&this.moveTo(0,0),zs.curveTo(t,e,n,i,r),this},e.prototype.bezierCurveTo=function(t,e,n,i,r,o){return this._initCurve(),Us.curveTo(t,e,n,i,r,o,this.currentPath.points),this},e.prototype.arcTo=function(t,e,n,i,r){this._initCurve(t,e);var o=this.currentPath.points,s=Bs.curveTo(t,e,n,i,r,o);if(s){var a=s.cx,l=s.cy,u=s.radius,h=s.startAngle,c=s.endAngle,p=s.anticlockwise;this.arc(a,l,u,h,c,p)}return this},e.prototype.arc=function(t,e,n,i,r,o){if(void 0===o&&(o=!1),i===r)return this;if(!o&&r<=i?r+=gi:o&&i<=r&&(i+=gi),0==r-i)return this;var s=t+Math.cos(i)*n,a=e+Math.sin(i)*n,l=this._geometry.closePointEps,u=this.currentPath?this.currentPath.points:null;if(u){var h=Math.abs(u[u.length-2]-s),c=Math.abs(u[u.length-1]-a);h<l&&c<l||u.push(s,a)}else this.moveTo(s,a),u=this.currentPath.points;return Bs.arc(s,a,t,e,n,i,r,o,u),this},e.prototype.beginFill=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=1),this.beginTextureFill({texture:Mr.WHITE,color:t,alpha:e})},e.prototype.beginTextureFill=function(t){t=Object.assign({texture:Mr.WHITE,color:16777215,alpha:1,matrix:null},t),this.currentPath&&this.startPoly();var e=t.alpha>0;return e?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._fillStyle,{visible:e},t)):this._fillStyle.reset(),this},e.prototype.endFill=function(){return this.finishPoly(),this._fillStyle.reset(),this},e.prototype.drawRect=function(t,e,n,i){return this.drawShape(new xi(t,e,n,i))},e.prototype.drawRoundedRect=function(t,e,n,i,r){return this.drawShape(new Ei(t,e,n,i,r))},e.prototype.drawCircle=function(t,e,n){return this.drawShape(new bi(t,e,n))},e.prototype.drawEllipse=function(t,e,n,i){return this.drawShape(new wi(t,e,n,i))},e.prototype.drawPolygon=function(){for(var t=arguments,e=[],n=0;n<arguments.length;n++)e[n]=t[n];var i,r=!0,o=e[0];o.points?(r=o.closeStroke,i=o.points):i=Array.isArray(e[0])?e[0]:e;var s=new Pi(i);return s.closeStroke=r,this.drawShape(s),this},e.prototype.drawShape=function(t){return this._holeMode?this._geometry.drawHole(t,this._matrix):this._geometry.drawShape(t,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this},e.prototype.clear=function(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this},e.prototype.isFastRect=function(){var t=this._geometry.graphicsData;return!(1!==t.length||t[0].shape.type!==mi.RECT||t[0].matrix||t[0].holes.length||t[0].lineStyle.visible&&t[0].lineStyle.width)},e.prototype._render=function(t){this.finishPoly();var e=this._geometry,n=t.context.supports.uint32Indices;e.updateBatches(n),e.batchable?(this.batchDirty!==e.batchDirty&&this._populateBatches(),this._renderBatched(t)):(t.batch.flush(),this._renderDirect(t))},e.prototype._populateBatches=function(){var t=this._geometry,e=this.blendMode,n=t.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=t.batchDirty,this.batches.length=n,this.vertexData=new Float32Array(t.points);for(var i=0;i<n;i++){var r=t.batches[i],o=r.style.color,s=new Float32Array(this.vertexData.buffer,4*r.attribStart*2,2*r.attribSize),a=new Float32Array(t.uvsFloat32.buffer,4*r.attribStart*2,2*r.attribSize),l={vertexData:s,blendMode:e,indices:new Uint16Array(t.indicesUint16.buffer,2*r.start,r.size),uvs:a,_batchRGB:Yn(o),_tintRGB:o,_texture:r.style.texture,alpha:r.style.alpha,worldAlpha:1};this.batches[i]=l}},e.prototype._renderBatched=function(t){if(this.batches.length){t.batch.setObjectRenderer(t.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(var e=0,n=this.batches.length;e<n;e++){var i=this.batches[e];i.worldAlpha=this.worldAlpha*i.alpha,t.plugins[this.pluginName].render(i)}}},e.prototype._renderDirect=function(t){var e=this._resolveDirectShader(t),n=this._geometry,i=this.tint,r=this.worldAlpha,o=e.uniforms,s=n.drawCalls;o.translationMatrix=this.transform.worldTransform,o.tint[0]=(i>>16&255)/255*r,o.tint[1]=(i>>8&255)/255*r,o.tint[2]=(255&i)/255*r,o.tint[3]=r,t.shader.bind(e),t.geometry.bind(n,e),t.state.set(this.state);for(var a=0,l=s.length;a<l;a++)this._renderDrawCallDirect(t,n.drawCalls[a])},e.prototype._renderDrawCallDirect=function(t,e){for(var n=e.texArray,i=e.type,r=e.size,o=e.start,s=n.count,a=0;a<s;a++)t.texture.bind(n.elements[a],a);t.geometry.draw(i,r,o)},e.prototype._resolveDirectShader=function(t){var e=this.shader,n=this.pluginName;if(!e){if(!Js[n]){for(var i=t.plugins.batch.MAX_TEXTURES,r=new Int32Array(i),o=0;o<i;o++)r[o]=o;var s={tint:new Float32Array([1,1,1,1]),translationMatrix:new Ci,default:qr.from({uSamplers:r},!0)},a=t.plugins[n]._shader.program;Js[n]=new Lo(a,s)}e=Js[n]}return e},e.prototype._calculateBounds=function(){this.finishPoly();var t=this._geometry;if(t.graphicsData.length){var e=t.bounds,n=e.minX,i=e.minY,r=e.maxX,o=e.maxY;this._bounds.addFrame(this.transform,n,i,r,o)}},e.prototype.containsPoint=function(t){return this.worldTransform.applyInverse(t,e._TEMP_POINT),this._geometry.containsPoint(e._TEMP_POINT)},e.prototype.calculateTints=function(){if(this.batchTint!==this.tint){this.batchTint=this.tint;for(var t=Yn(this.tint,Qs),e=0;e<this.batches.length;e++){var n=this.batches[e],i=n._batchRGB,r=(t[0]*i[0]*255<<16)+(t[1]*i[1]*255<<8)+(0|t[2]*i[2]*255);n._tintRGB=(r>>16)+(65280&r)+((255&r)<<16)}}},e.prototype.calculateVertices=function(){var t=this.transform._worldID;if(this._transformID!==t){this._transformID=t;for(var e=this.transform.worldTransform,n=e.a,i=e.b,r=e.c,o=e.d,s=e.tx,a=e.ty,l=this._geometry.points,u=this.vertexData,h=0,c=0;c<l.length;c+=2){var p=l[c],d=l[c+1];u[h++]=n*p+r*d+s,u[h++]=o*d+i*p+a}}},e.prototype.closePath=function(){var t=this.currentPath;return t&&(t.closeStroke=!0,this.finishPoly()),this},e.prototype.setMatrix=function(t){return this._matrix=t,this},e.prototype.beginHole=function(){return this.finishPoly(),this._holeMode=!0,this},e.prototype.endHole=function(){return this.finishPoly(),this._holeMode=!1,this},e.prototype.destroy=function(e){this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,t.prototype.destroy.call(this,e)},e._TEMP_POINT=new Ti,e}(lr),ea=function(t,e){return(ea=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};!function(t){t[t.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",t[t.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL"}(js||(js={}));var na={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:js.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100,leading:0},ia=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],ra=function(){function t(t){this.styleID=0,this.reset(),aa(this,t,t)}return t.prototype.clone=function(){var e={};return aa(e,this,na),new t(e)},t.prototype.reset=function(){aa(this,na,na)},Object.defineProperty(t.prototype,"align",{get:function(){return this._align},set:function(t){this._align!==t&&(this._align=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"breakWords",{get:function(){return this._breakWords},set:function(t){this._breakWords!==t&&(this._breakWords=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadow",{get:function(){return this._dropShadow},set:function(t){this._dropShadow!==t&&(this._dropShadow=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowAlpha",{get:function(){return this._dropShadowAlpha},set:function(t){this._dropShadowAlpha!==t&&(this._dropShadowAlpha=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowAngle",{get:function(){return this._dropShadowAngle},set:function(t){this._dropShadowAngle!==t&&(this._dropShadowAngle=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowBlur",{get:function(){return this._dropShadowBlur},set:function(t){this._dropShadowBlur!==t&&(this._dropShadowBlur=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowColor",{get:function(){return this._dropShadowColor},set:function(t){var e=sa(t);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowDistance",{get:function(){return this._dropShadowDistance},set:function(t){this._dropShadowDistance!==t&&(this._dropShadowDistance=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fill",{get:function(){return this._fill},set:function(t){var e=sa(t);this._fill!==e&&(this._fill=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fillGradientType",{get:function(){return this._fillGradientType},set:function(t){this._fillGradientType!==t&&(this._fillGradientType=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fillGradientStops",{get:function(){return this._fillGradientStops},set:function(t){(function(t,e){if(!Array.isArray(t)||!Array.isArray(e)||t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0})(this._fillGradientStops,t)||(this._fillGradientStops=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontFamily",{get:function(){return this._fontFamily},set:function(t){this.fontFamily!==t&&(this._fontFamily=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontSize",{get:function(){return this._fontSize},set:function(t){this._fontSize!==t&&(this._fontSize=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontStyle",{get:function(){return this._fontStyle},set:function(t){this._fontStyle!==t&&(this._fontStyle=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontVariant",{get:function(){return this._fontVariant},set:function(t){this._fontVariant!==t&&(this._fontVariant=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(t){this._fontWeight!==t&&(this._fontWeight=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lineHeight",{get:function(){return this._lineHeight},set:function(t){this._lineHeight!==t&&(this._lineHeight=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"leading",{get:function(){return this._leading},set:function(t){this._leading!==t&&(this._leading=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lineJoin",{get:function(){return this._lineJoin},set:function(t){this._lineJoin!==t&&(this._lineJoin=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"miterLimit",{get:function(){return this._miterLimit},set:function(t){this._miterLimit!==t&&(this._miterLimit=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"padding",{get:function(){return this._padding},set:function(t){this._padding!==t&&(this._padding=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"stroke",{get:function(){return this._stroke},set:function(t){var e=sa(t);this._stroke!==e&&(this._stroke=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"strokeThickness",{get:function(){return this._strokeThickness},set:function(t){this._strokeThickness!==t&&(this._strokeThickness=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textBaseline",{get:function(){return this._textBaseline},set:function(t){this._textBaseline!==t&&(this._textBaseline=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"trim",{get:function(){return this._trim},set:function(t){this._trim!==t&&(this._trim=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"whiteSpace",{get:function(){return this._whiteSpace},set:function(t){this._whiteSpace!==t&&(this._whiteSpace=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wordWrap",{get:function(){return this._wordWrap},set:function(t){this._wordWrap!==t&&(this._wordWrap=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wordWrapWidth",{get:function(){return this._wordWrapWidth},set:function(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.styleID++)},enumerable:!1,configurable:!0}),t.prototype.toFontString=function(){var t="number"==typeof this.fontSize?this.fontSize+"px":this.fontSize,e=this.fontFamily;Array.isArray(this.fontFamily)||(e=this.fontFamily.split(","));for(var n=e.length-1;n>=0;n--){var i=e[n].trim();!/([\"\'])[^\'\"]+\1/.test(i)&&ia.indexOf(i)<0&&(i='"'+i+'"'),e[n]=i}return this.fontStyle+" "+this.fontVariant+" "+this.fontWeight+" "+t+" "+e.join(",")},t}();function oa(t){return"number"==typeof t?Gn(t):("string"==typeof t&&0===t.indexOf("0x")&&(t=t.replace("0x","#")),t)}function sa(t){if(Array.isArray(t)){for(var e=0;e<t.length;++e)t[e]=oa(t[e]);return t}return oa(t)}function aa(t,e,n){for(var i in n)Array.isArray(e[i])?t[i]=e[i].slice():t[i]=e[i]}var la=function(){function t(t,e,n,i,r,o,s,a,l){this.text=t,this.style=e,this.width=n,this.height=i,this.lines=r,this.lineWidths=o,this.lineHeight=s,this.maxLineWidth=a,this.fontProperties=l}return t.measureText=function(e,n,i,r){void 0===r&&(r=t._canvas),i=i??n.wordWrap;var o=n.toFontString(),s=t.measureFont(o);0===s.fontSize&&(s.fontSize=n.fontSize,s.ascent=n.fontSize);var a=r.getContext("2d");a.font=o;for(var l=(i?t.wordWrap(e,n,r):e).split(/(?:\r\n|\r|\n)/),u=new Array(l.length),h=0,c=0;c<l.length;c++){var p=a.measureText(l[c]).width+(l[c].length-1)*n.letterSpacing;u[c]=p,h=Math.max(h,p)}var d=h+n.strokeThickness;n.dropShadow&&(d+=n.dropShadowDistance);var f=n.lineHeight||s.fontSize+n.strokeThickness,m=Math.max(f,s.fontSize+n.strokeThickness)+(l.length-1)*(f+n.leading);return n.dropShadow&&(m+=n.dropShadowDistance),new t(e,n,d,m,l,u,f+n.leading,h,s)},t.wordWrap=function(e,n,i){void 0===i&&(i=t._canvas);for(var r=i.getContext("2d"),o=0,s="",a="",l=Object.create(null),u=n.letterSpacing,h=n.whiteSpace,c=t.collapseSpaces(h),p=t.collapseNewlines(h),d=!c,f=n.wordWrapWidth+u,m=t.tokenize(e),y=0;y<m.length;y++){var g=m[y];if(t.isNewline(g)){if(!p){a+=t.addLine(s),d=!c,s="",o=0;continue}g=" "}if(c){var v=t.isBreakingSpace(g),_=t.isBreakingSpace(s[s.length-1]);if(v&&_)continue}var x=t.getFromCache(g,u,l,r);if(x>f)if(""!==s&&(a+=t.addLine(s),s="",o=0),t.canBreakWords(g,n.breakWords))for(var b=t.wordWrapSplit(g),w=0;w<b.length;w++){for(var P=b[w],E=1;b[w+E];){var T=b[w+E],S=P[P.length-1];if(t.canBreakChars(S,T,g,w,n.breakWords))break;P+=T,E++}w+=P.length-1;var C=t.getFromCache(P,u,l,r);C+o>f&&(a+=t.addLine(s),d=!1,s="",o=0),s+=P,o+=C}else{s.length>0&&(a+=t.addLine(s),s="",o=0);var I=y===m.length-1;a+=t.addLine(g,!I),d=!1,s="",o=0}else x+o>f&&(d=!1,a+=t.addLine(s),s="",o=0),(s.length>0||!t.isBreakingSpace(g)||d)&&(s+=g,o+=x)}return a+t.addLine(s,!1)},t.addLine=function(e,n){return void 0===n&&(n=!0),e=t.trimRight(e),n?e+"\n":e},t.getFromCache=function(t,e,n,i){var r=n[t];if("number"!=typeof r){var o=t.length*e;r=i.measureText(t).width+o,n[t]=r}return r},t.collapseSpaces=function(t){return"normal"===t||"pre-line"===t},t.collapseNewlines=function(t){return"normal"===t},t.trimRight=function(e){if("string"!=typeof e)return"";for(var n=e.length-1;n>=0;n--){var i=e[n];if(!t.isBreakingSpace(i))break;e=e.slice(0,-1)}return e},t.isNewline=function(e){return"string"==typeof e&&t._newlines.indexOf(e.charCodeAt(0))>=0},t.isBreakingSpace=function(e,n){return"string"==typeof e&&t._breakingSpaces.indexOf(e.charCodeAt(0))>=0},t.tokenize=function(e){var n=[],i="";if("string"!=typeof e)return n;for(var r=0;r<e.length;r++){var o=e[r],s=e[r+1];t.isBreakingSpace(o,s)||t.isNewline(o)?(""!==i&&(n.push(i),i=""),n.push(o)):i+=o}return""!==i&&n.push(i),n},t.canBreakWords=function(t,e){return e},t.canBreakChars=function(t,e,n,i,r){return!0},t.wordWrapSplit=function(t){return t.split("")},t.measureFont=function(e){if(t._fonts[e])return t._fonts[e];var n={ascent:0,descent:0,fontSize:0},i=t._canvas,r=t._context;r.font=e;var o=t.METRICS_STRING+t.BASELINE_SYMBOL,s=Math.ceil(r.measureText(o).width),a=Math.ceil(r.measureText(t.BASELINE_SYMBOL).width),l=Math.ceil(t.HEIGHT_MULTIPLIER*a);a=a*t.BASELINE_MULTIPLIER|0,i.width=s,i.height=l,r.fillStyle="#f00",r.fillRect(0,0,s,l),r.font=e,r.textBaseline="alphabetic",r.fillStyle="#000",r.fillText(o,0,a);var u=r.getImageData(0,0,s,l).data,h=u.length,c=4*s,p=0,d=0,f=!1;for(p=0;p<a;++p){for(var m=0;m<c;m+=4)if(255!==u[d+m]){f=!0;break}if(f)break;d+=c}for(n.ascent=a-p,d=h-c,f=!1,p=l;p>a;--p){for(m=0;m<c;m+=4)if(255!==u[d+m]){f=!0;break}if(f)break;d-=c}return n.descent=p-a,n.fontSize=n.ascent+n.descent,t._fonts[e]=n,n},t.clearMetrics=function(e){void 0===e&&(e=""),e?delete t._fonts[e]:t._fonts={}},t}(),ua=function(){try{var t=new OffscreenCanvas(0,0),e=t.getContext("2d");return e&&e.measureText?t:document.createElement("canvas")}catch{return document.createElement("canvas")}}();ua.width=ua.height=10,la._canvas=ua,la._context=ua.getContext("2d"),la._fonts={},la.METRICS_STRING="|ÉqÅ",la.BASELINE_SYMBOL="M",la.BASELINE_MULTIPLIER=1.4,la.HEIGHT_MULTIPLIER=2,la._newlines=[10,13],la._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];var ha={texture:!0,children:!1,baseTexture:!0},ca=function(t){function e(e,n,i){var r=this,o=!1;i||(i=document.createElement("canvas"),o=!0),i.width=3,i.height=3;var s=Mr.from(i);return s.orig=new xi,s.trim=new xi,(r=t.call(this,s)||this)._ownCanvas=o,r.canvas=i,r.context=r.canvas.getContext("2d"),r._resolution=xe.RESOLUTION,r._autoResolution=!0,r._text=null,r._style=null,r._styleListener=null,r._font="",r.text=e,r.style=n,r.localStyleID=-1,r}return function(t,e){function n(){this.constructor=t}ea(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.updateText=function(t){var n=this._style;if(this.localStyleID!==n.styleID&&(this.dirty=!0,this.localStyleID=n.styleID),this.dirty||!t){this._font=this._style.toFontString();var i=this.context,r=la.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),o=r.width,s=r.height,a=r.lines,l=r.lineHeight,u=r.lineWidths,h=r.maxLineWidth,c=r.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,o)+2*n.padding)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,s)+2*n.padding)*this._resolution),i.scale(this._resolution,this._resolution),i.clearRect(0,0,this.canvas.width,this.canvas.height),i.font=this._font,i.lineWidth=n.strokeThickness,i.textBaseline=n.textBaseline,i.lineJoin=n.lineJoin,i.miterLimit=n.miterLimit;for(var p,d,f=n.dropShadow?2:1,m=0;m<f;++m){var y=n.dropShadow&&0===m,g=y?Math.ceil(Math.max(1,s)+2*n.padding):0,v=g*this._resolution;if(y){i.fillStyle="black",i.strokeStyle="black";var _=n.dropShadowColor,x=Yn("number"==typeof _?_:Hn(_)),b=n.dropShadowBlur*this._resolution,w=n.dropShadowDistance*this._resolution;i.shadowColor="rgba("+255*x[0]+","+255*x[1]+","+255*x[2]+","+n.dropShadowAlpha+")",i.shadowBlur=b,i.shadowOffsetX=Math.cos(n.dropShadowAngle)*w,i.shadowOffsetY=Math.sin(n.dropShadowAngle)*w+v}else i.fillStyle=this._generateFillStyle(n,a,r),i.strokeStyle=n.stroke,i.shadowColor="black",i.shadowBlur=0,i.shadowOffsetX=0,i.shadowOffsetY=0;var P=(l-c.fontSize)/2;(!e.nextLineHeightBehavior||l-c.fontSize<0)&&(P=0);for(var E=0;E<a.length;E++)p=n.strokeThickness/2,d=n.strokeThickness/2+E*l+c.ascent+P,"right"===n.align?p+=h-u[E]:"center"===n.align&&(p+=(h-u[E])/2),n.stroke&&n.strokeThickness&&this.drawLetterSpacing(a[E],p+n.padding,d+n.padding-g,!0),n.fill&&this.drawLetterSpacing(a[E],p+n.padding,d+n.padding-g)}this.updateTexture()}},e.prototype.drawLetterSpacing=function(t,e,n,i){void 0===i&&(i=!1);var r=this._style.letterSpacing,o="letterSpacing"in CanvasRenderingContext2D.prototype||"textLetterSpacing"in CanvasRenderingContext2D.prototype;if(0===r||o)return o&&(this.context.letterSpacing=r,this.context.textLetterSpacing=r),void(i?this.context.strokeText(t,e,n):this.context.fillText(t,e,n));for(var s=e,a=Array.from?Array.from(t):t.split(""),l=this.context.measureText(t).width,u=0,h=0;h<a.length;++h){var c=a[h];i?this.context.strokeText(c,s,n):this.context.fillText(c,s,n);for(var p="",d=h+1;d<a.length;++d)p+=a[d];s+=l-(u=this.context.measureText(p).width)+r,l=u}},e.prototype.updateTexture=function(){var t=this.canvas;if(this._style.trim){var e=hi(t);e.data&&(t.width=e.width,t.height=e.height,this.context.putImageData(e.data,0,0))}var n=this._texture,i=this._style,r=i.trim?0:i.padding,o=n.baseTexture;n.trim.width=n._frame.width=t.width/this._resolution,n.trim.height=n._frame.height=t.height/this._resolution,n.trim.x=-r,n.trim.y=-r,n.orig.width=n._frame.width-2*r,n.orig.height=n._frame.height-2*r,this._onTextureUpdate(),o.setRealSize(t.width,t.height,this._resolution),n.updateUvs(),this._recursivePostUpdateTransform(),this.dirty=!1},e.prototype._render=function(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),t.prototype._render.call(this,e)},e.prototype.getLocalBounds=function(e){return this.updateText(!0),t.prototype.getLocalBounds.call(this,e)},e.prototype._calculateBounds=function(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)},e.prototype._generateFillStyle=function(t,e,n){var i=t.fill;if(!Array.isArray(i))return i;if(1===i.length)return i[0];var r,o=t.dropShadow?t.dropShadowDistance:0,s=t.padding||0,a=this.canvas.width/this._resolution-o-2*s,l=this.canvas.height/this._resolution-o-2*s,u=i.slice(),h=t.fillGradientStops.slice();if(!h.length)for(var c=u.length+1,p=1;p<c;++p)h.push(p/c);if(u.unshift(i[0]),h.unshift(0),u.push(i[i.length-1]),h.push(1),t.fillGradientType===js.LINEAR_VERTICAL){r=this.context.createLinearGradient(a/2,s,a/2,l+s);var d=n.fontProperties.fontSize+t.strokeThickness;for(p=0;p<e.length;p++){var f=n.lineHeight*(p-1)+d,m=n.lineHeight*p,y=m;p>0&&f>m&&(y=(m+f)/2);var g=m+d,v=n.lineHeight*(p+1),_=g;p+1<e.length&&v<g&&(_=(g+v)/2);for(var x=(_-y)/l,b=0;b<u.length;b++){var w;w="number"==typeof h[b]?h[b]:b/u.length;var P=Math.min(1,Math.max(0,y/l+w*x));P=Number(P.toFixed(5)),r.addColorStop(P,u[b])}}}else{r=this.context.createLinearGradient(s,l/2,a+s,l/2);var E=u.length+1,T=1;for(p=0;p<u.length;p++){var S;S="number"==typeof h[p]?h[p]:T/E,r.addColorStop(S,u[p]),T++}}return r},e.prototype.destroy=function(e){"boolean"==typeof e&&(e={children:e}),e=Object.assign({},ha,e),t.prototype.destroy.call(this,e),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null},Object.defineProperty(e.prototype,"width",{get:function(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width},set:function(t){this.updateText(!0);var e=ti(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height},set:function(t){this.updateText(!0);var e=ti(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"style",{get:function(){return this._style},set:function(t){t=t||{},this._style=t instanceof ra?t:new ra(t),this.localStyleID=-1,this.dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this._text},set:function(t){t=String(t??""),this._text!==t&&(this._text=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resolution",{get:function(){return this._resolution},set:function(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)},enumerable:!1,configurable:!0}),e.nextLineHeightBehavior=!1,e}(Es);ca.prototype._renderCanvas=function(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),Es.prototype._renderCanvas.call(this,t)},or.prototype.name=null,lr.prototype.getChildByName=function(t,e){for(var n=0,i=this.children.length;n<i;n++)if(this.children[n].name===t)return this.children[n];if(e)for(n=0,i=this.children.length;n<i;n++)if(this.children[n].getChildByName){var r=this.children[n].getChildByName(t,!0);if(r)return r}return null};var pa={float:function(t,e,n,i){n!==i&&(n.v=i,t.uniform1f(e,i))},vec2:function(t,e,n,i){(n[0]!==i[0]||n[1]!==i[1])&&(n[0]=i[0],n[1]=i[1],t.uniform2f(e,i[0],i[1]))},vec3:function(t,e,n,i){(n[0]!==i[0]||n[1]!==i[1]||n[2]!==i[2])&&(n[0]=i[0],n[1]=i[1],n[2]=i[2],t.uniform3f(e,i[0],i[1],i[2]))},int:function(t,e,n,i){t.uniform1i(e,i)},ivec2:function(t,e,n,i){t.uniform2i(e,i[0],i[1])},ivec3:function(t,e,n,i){t.uniform3i(e,i[0],i[1],i[2])},ivec4:function(t,e,n,i){t.uniform4i(e,i[0],i[1],i[2],i[3])},uint:function(t,e,n,i){t.uniform1ui(e,i)},uvec2:function(t,e,n,i){t.uniform2ui(e,i[0],i[1])},uvec3:function(t,e,n,i){t.uniform3ui(e,i[0],i[1],i[2])},uvec4:function(t,e,n,i){t.uniform4ui(e,i[0],i[1],i[2],i[3])},bool:function(t,e,n,i){n!==i&&(n.v=i,t.uniform1i(e,Number(i)))},bvec2:function(t,e,n,i){t.uniform2i(e,i[0],i[1])},bvec3:function(t,e,n,i){t.uniform3i(e,i[0],i[1],i[2])},bvec4:function(t,e,n,i){t.uniform4i(e,i[0],i[1],i[2],i[3])},mat2:function(t,e,n,i){t.uniformMatrix2fv(e,!1,i)},mat3:function(t,e,n,i){t.uniformMatrix3fv(e,!1,i)},mat4:function(t,e,n,i){t.uniformMatrix4fv(e,!1,i)},sampler2D:function(t,e,n,i){t.uniform1i(e,i)},samplerCube:function(t,e,n,i){t.uniform1i(e,i)},sampler2DArray:function(t,e,n,i){t.uniform1i(e,i)}},da={float:function(t,e,n,i){t.uniform1fv(e,i)},vec2:function(t,e,n,i){t.uniform2fv(e,i)},vec3:function(t,e,n,i){t.uniform3fv(e,i)},vec4:function(t,e,n,i){t.uniform4fv(e,i)},int:function(t,e,n,i){t.uniform1iv(e,i)},ivec2:function(t,e,n,i){t.uniform2iv(e,i)},ivec3:function(t,e,n,i){t.uniform3iv(e,i)},ivec4:function(t,e,n,i){t.uniform4iv(e,i)},uint:function(t,e,n,i){t.uniform1uiv(e,i)},uvec2:function(t,e,n,i){t.uniform2uiv(e,i)},uvec3:function(t,e,n,i){t.uniform3uiv(e,i)},uvec4:function(t,e,n,i){t.uniform4uiv(e,i)},bool:function(t,e,n,i){t.uniform1iv(e,i)},bvec2:function(t,e,n,i){t.uniform2iv(e,i)},bvec3:function(t,e,n,i){t.uniform3iv(e,i)},bvec4:function(t,e,n,i){t.uniform4iv(e,i)},sampler2D:function(t,e,n,i){t.uniform1iv(e,i)},samplerCube:function(t,e,n,i){t.uniform1iv(e,i)},sampler2DArray:function(t,e,n,i){t.uniform1iv(e,i)}},fa=function(){function t(){this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0,this.global=new Ti,this.target=null,this.originalEvent=null,this.identifier=null,this.isPrimary=!1,this.button=0,this.buttons=0,this.width=0,this.height=0,this.tiltX=0,this.tiltY=0,this.pointerType=null,this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0}return Object.defineProperty(t.prototype,"pointerId",{get:function(){return this.identifier},enumerable:!1,configurable:!0}),t.prototype.getLocalPosition=function(t,e,n){return t.worldTransform.applyInverse(n||this.global,e)},t.prototype.copyEvent=function(t){"isPrimary"in t&&t.isPrimary&&(this.isPrimary=!0),this.button="button"in t&&t.button;var e="buttons"in t&&t.buttons;this.buttons=Number.isInteger(e)?e:"which"in t&&t.which,this.width="width"in t&&t.width,this.height="height"in t&&t.height,this.tiltX="tiltX"in t&&t.tiltX,this.tiltY="tiltY"in t&&t.tiltY,this.pointerType="pointerType"in t&&t.pointerType,this.pressure="pressure"in t&&t.pressure,this.rotationAngle="rotationAngle"in t&&t.rotationAngle,this.twist="twist"in t&&t.twist||0,this.tangentialPressure="tangentialPressure"in t&&t.tangentialPressure||0},t.prototype.reset=function(){this.isPrimary=!1},t}(),ma=function(t,e){return(ma=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},ya=function(){function t(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.target=null,this.currentTarget=null,this.type=null,this.data=null}return t.prototype.stopPropagation=function(){this.stopped=!0,this.stopPropagationHint=!0,this.stopsPropagatingAt=this.currentTarget},t.prototype.reset=function(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.currentTarget=null,this.target=null},t}(),ga=function(){function t(e){this._pointerId=e,this._flags=t.FLAGS.NONE}return t.prototype._doSet=function(t,e){this._flags=e?this._flags|t:this._flags&~t},Object.defineProperty(t.prototype,"pointerId",{get:function(){return this._pointerId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"flags",{get:function(){return this._flags},set:function(t){this._flags=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"none",{get:function(){return this._flags===t.FLAGS.NONE},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"over",{get:function(){return!!(this._flags&t.FLAGS.OVER)},set:function(e){this._doSet(t.FLAGS.OVER,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rightDown",{get:function(){return!!(this._flags&t.FLAGS.RIGHT_DOWN)},set:function(e){this._doSet(t.FLAGS.RIGHT_DOWN,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"leftDown",{get:function(){return!!(this._flags&t.FLAGS.LEFT_DOWN)},set:function(e){this._doSet(t.FLAGS.LEFT_DOWN,e)},enumerable:!1,configurable:!0}),t.FLAGS=Object.freeze({NONE:0,OVER:1,LEFT_DOWN:2,RIGHT_DOWN:4}),t}(),va=function(){function t(){this._tempPoint=new Ti}return t.prototype.recursiveFindHit=function(t,e,n,i,r){if(!e||!e.visible)return!1;var o=t.data.global,s=!1,a=r=e.interactive||r,l=!0;if(e.hitArea?(i&&(e.worldTransform.applyInverse(o,this._tempPoint),e.hitArea.contains(this._tempPoint.x,this._tempPoint.y)?s=!0:(i=!1,l=!1)),a=!1):e._mask&&i&&(e._mask.containsPoint&&e._mask.containsPoint(o)||(i=!1)),l&&e.interactiveChildren&&e.children)for(var u=e.children,h=u.length-1;h>=0;h--){var c=u[h],p=this.recursiveFindHit(t,c,n,i,a);if(p){if(!c.parent)continue;a=!1,p&&(t.target&&(i=!1),s=!0)}}return r&&(i&&!t.target&&!e.hitArea&&e.containsPoint&&e.containsPoint(o)&&(s=!0),e.interactive&&(s&&!t.target&&(t.target=e),n&&n(t,e,!!s))),s},t.prototype.findHit=function(t,e,n,i){this.recursiveFindHit(t,e,n,i,!1)},t}(),_a={interactive:!1,interactiveChildren:!0,hitArea:null,get buttonMode(){return"pointer"===this.cursor},set buttonMode(t){t?this.cursor="pointer":"pointer"===this.cursor&&(this.cursor=null)},cursor:null,get trackedPointers(){return void 0===this._trackedPointers&&(this._trackedPointers={}),this._trackedPointers},_trackedPointers:void 0};or.mixin(_a);var xa={target:null,data:{global:null}},ba=function(t){function e(e,n){var i=t.call(this)||this;return n=n||{},i.renderer=e,i.autoPreventDefault=void 0===n.autoPreventDefault||n.autoPreventDefault,i.interactionFrequency=n.interactionFrequency||10,i.mouse=new fa,i.mouse.identifier=1,i.mouse.global.set(-999999),i.activeInteractionData={},i.activeInteractionData[1]=i.mouse,i.interactionDataPool=[],i.eventData=new ya,i.interactionDOMElement=null,i.moveWhenInside=!1,i.eventsAdded=!1,i.tickerAdded=!1,i.mouseOverRenderer=!("PointerEvent"in self),i.supportsTouchEvents="ontouchstart"in self,i.supportsPointerEvents=!!self.PointerEvent,i.onPointerUp=i.onPointerUp.bind(i),i.processPointerUp=i.processPointerUp.bind(i),i.onPointerCancel=i.onPointerCancel.bind(i),i.processPointerCancel=i.processPointerCancel.bind(i),i.onPointerDown=i.onPointerDown.bind(i),i.processPointerDown=i.processPointerDown.bind(i),i.onPointerMove=i.onPointerMove.bind(i),i.processPointerMove=i.processPointerMove.bind(i),i.onPointerOut=i.onPointerOut.bind(i),i.processPointerOverOut=i.processPointerOverOut.bind(i),i.onPointerOver=i.onPointerOver.bind(i),i.cursorStyles={default:"inherit",pointer:"pointer"},i.currentCursorMode=null,i.cursor=null,i.resolution=1,i.delayedEvents=[],i.search=new va,i._tempDisplayObject=new sr,i._eventListenerOptions={capture:!0,passive:!1},i._useSystemTicker=void 0===n.useSystemTicker||n.useSystemTicker,i.setTargetElement(i.renderer.view,i.renderer.resolution),i}return function(t,e){function n(){this.constructor=t}ma(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),Object.defineProperty(e.prototype,"useSystemTicker",{get:function(){return this._useSystemTicker},set:function(t){this._useSystemTicker=t,t?this.addTickerListener():this.removeTickerListener()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastObjectRendered",{get:function(){return this.renderer._lastObjectRendered||this._tempDisplayObject},enumerable:!1,configurable:!0}),e.prototype.hitTest=function(t,e){return xa.target=null,xa.data.global=t,e||(e=this.lastObjectRendered),this.processInteractive(xa,e,null,!0),xa.target},e.prototype.setTargetElement=function(t,e){void 0===e&&(e=1),this.removeTickerListener(),this.removeEvents(),this.interactionDOMElement=t,this.resolution=e,this.addEvents(),this.addTickerListener()},e.prototype.addTickerListener=function(){this.tickerAdded||!this.interactionDOMElement||!this._useSystemTicker||(we.system.add(this.tickerUpdate,this,_e.INTERACTION),this.tickerAdded=!0)},e.prototype.removeTickerListener=function(){!this.tickerAdded||(we.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)},e.prototype.addEvents=function(){if(!this.eventsAdded&&this.interactionDOMElement){var t=this.interactionDOMElement.style;self.navigator.msPointerEnabled?(t.msContentZooming="none",t.msTouchAction="none"):this.supportsPointerEvents&&(t.touchAction="none"),this.supportsPointerEvents?(self.document.addEventListener("pointermove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerdown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerleave",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerover",this.onPointerOver,this._eventListenerOptions),self.addEventListener("pointercancel",this.onPointerCancel,this._eventListenerOptions),self.addEventListener("pointerup",this.onPointerUp,this._eventListenerOptions)):(self.document.addEventListener("mousemove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mousedown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mouseout",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mouseover",this.onPointerOver,this._eventListenerOptions),self.addEventListener("mouseup",this.onPointerUp,this._eventListenerOptions)),this.supportsTouchEvents&&(this.interactionDOMElement.addEventListener("touchstart",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchcancel",this.onPointerCancel,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchend",this.onPointerUp,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchmove",this.onPointerMove,this._eventListenerOptions)),this.eventsAdded=!0}},e.prototype.removeEvents=function(){if(this.eventsAdded&&this.interactionDOMElement){var t=this.interactionDOMElement.style;self.navigator.msPointerEnabled?(t.msContentZooming="",t.msTouchAction=""):this.supportsPointerEvents&&(t.touchAction=""),this.supportsPointerEvents?(self.document.removeEventListener("pointermove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerdown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerleave",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerover",this.onPointerOver,this._eventListenerOptions),self.removeEventListener("pointercancel",this.onPointerCancel,this._eventListenerOptions),self.removeEventListener("pointerup",this.onPointerUp,this._eventListenerOptions)):(self.document.removeEventListener("mousemove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mousedown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mouseout",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mouseover",this.onPointerOver,this._eventListenerOptions),self.removeEventListener("mouseup",this.onPointerUp,this._eventListenerOptions)),this.supportsTouchEvents&&(this.interactionDOMElement.removeEventListener("touchstart",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchcancel",this.onPointerCancel,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchend",this.onPointerUp,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchmove",this.onPointerMove,this._eventListenerOptions)),this.interactionDOMElement=null,this.eventsAdded=!1}},e.prototype.tickerUpdate=function(t){this._deltaTime+=t,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())},e.prototype.update=function(){if(this.interactionDOMElement){if(this._didMove)return void(this._didMove=!1);for(var t in this.cursor=null,this.activeInteractionData)if(this.activeInteractionData.hasOwnProperty(t)){var e=this.activeInteractionData[t];if(e.originalEvent&&"touch"!==e.pointerType){var n=this.configureInteractionEventForDOMEvent(this.eventData,e.originalEvent,e);this.processInteractive(n,this.lastObjectRendered,this.processPointerOverOut,!0)}}this.setCursorMode(this.cursor)}},e.prototype.setCursorMode=function(t){t=t||"default";var e=!0;if(self.OffscreenCanvas&&this.interactionDOMElement instanceof OffscreenCanvas&&(e=!1),this.currentCursorMode!==t){this.currentCursorMode=t;var n=this.cursorStyles[t];if(n)switch(typeof n){case"string":e&&(this.interactionDOMElement.style.cursor=n);break;case"function":n(t);break;case"object":e&&Object.assign(this.interactionDOMElement.style,n)}else e&&"string"==typeof t&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,t)&&(this.interactionDOMElement.style.cursor=t)}},e.prototype.dispatchEvent=function(t,e,n){(!n.stopPropagationHint||t===n.stopsPropagatingAt)&&(n.currentTarget=t,n.type=e,t.emit(e,n),t[e]&&t[e](n))},e.prototype.delayDispatchEvent=function(t,e,n){this.delayedEvents.push({displayObject:t,eventString:e,eventData:n})},e.prototype.mapPositionToPoint=function(t,e,n){var i;i=this.interactionDOMElement.parentElement?this.interactionDOMElement.getBoundingClientRect():{x:0,y:0,width:this.interactionDOMElement.width,height:this.interactionDOMElement.height,left:0,top:0};var r=1/this.resolution;t.x=(e-i.left)*(this.interactionDOMElement.width/i.width)*r,t.y=(n-i.top)*(this.interactionDOMElement.height/i.height)*r},e.prototype.processInteractive=function(t,e,n,i){var r=this.search.findHit(t,e,n,i),o=this.delayedEvents;if(!o.length)return r;t.stopPropagationHint=!1;var s=o.length;this.delayedEvents=[];for(var a=0;a<s;a++){var l=o[a],u=l.displayObject,h=l.eventString,c=l.eventData;c.stopsPropagatingAt===u&&(c.stopPropagationHint=!0),this.dispatchEvent(u,h,c)}return r},e.prototype.onPointerDown=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t);this.autoPreventDefault&&e[0].isNormalized&&(t.cancelable||!("cancelable"in t))&&t.preventDefault();for(var n=e.length,i=0;i<n;i++){var r=e[i],o=this.getInteractionDataForPointerId(r),s=this.configureInteractionEventForDOMEvent(this.eventData,r,o);if(s.data.originalEvent=t,this.processInteractive(s,this.lastObjectRendered,this.processPointerDown,!0),this.emit("pointerdown",s),"touch"===r.pointerType)this.emit("touchstart",s);else if("mouse"===r.pointerType||"pen"===r.pointerType){var a=2===r.button;this.emit(a?"rightdown":"mousedown",this.eventData)}}}},e.prototype.processPointerDown=function(t,e,n){var i=t.data,r=t.data.identifier;if(n)if(e.trackedPointers[r]||(e.trackedPointers[r]=new ga(r)),this.dispatchEvent(e,"pointerdown",t),"touch"===i.pointerType)this.dispatchEvent(e,"touchstart",t);else if("mouse"===i.pointerType||"pen"===i.pointerType){var o=2===i.button;o?e.trackedPointers[r].rightDown=!0:e.trackedPointers[r].leftDown=!0,this.dispatchEvent(e,o?"rightdown":"mousedown",t)}},e.prototype.onPointerComplete=function(t,e,n){for(var i=this.normalizeToPointerData(t),r=i.length,o=t.target!==this.interactionDOMElement?"outside":"",s=0;s<r;s++){var a=i[s],l=this.getInteractionDataForPointerId(a),u=this.configureInteractionEventForDOMEvent(this.eventData,a,l);if(u.data.originalEvent=t,this.processInteractive(u,this.lastObjectRendered,n,e||!o),this.emit(e?"pointercancel":"pointerup"+o,u),"mouse"===a.pointerType||"pen"===a.pointerType){var h=2===a.button;this.emit(h?"rightup"+o:"mouseup"+o,u)}else"touch"===a.pointerType&&(this.emit(e?"touchcancel":"touchend"+o,u),this.releaseInteractionDataForPointerId(a.pointerId))}},e.prototype.onPointerCancel=function(t){this.supportsTouchEvents&&"touch"===t.pointerType||this.onPointerComplete(t,!0,this.processPointerCancel)},e.prototype.processPointerCancel=function(t,e){var n=t.data,i=t.data.identifier;void 0!==e.trackedPointers[i]&&(delete e.trackedPointers[i],this.dispatchEvent(e,"pointercancel",t),"touch"===n.pointerType&&this.dispatchEvent(e,"touchcancel",t))},e.prototype.onPointerUp=function(t){this.supportsTouchEvents&&"touch"===t.pointerType||this.onPointerComplete(t,!1,this.processPointerUp)},e.prototype.processPointerUp=function(t,e,n){var i=t.data,r=t.data.identifier,o=e.trackedPointers[r],s="touch"===i.pointerType,a="mouse"===i.pointerType||"pen"===i.pointerType,l=!1;if(a){var u=2===i.button,h=ga.FLAGS,c=u?h.RIGHT_DOWN:h.LEFT_DOWN,p=void 0!==o&&o.flags&c;n?(this.dispatchEvent(e,u?"rightup":"mouseup",t),p&&(this.dispatchEvent(e,u?"rightclick":"click",t),l=!0)):p&&this.dispatchEvent(e,u?"rightupoutside":"mouseupoutside",t),o&&(u?o.rightDown=!1:o.leftDown=!1)}n?(this.dispatchEvent(e,"pointerup",t),s&&this.dispatchEvent(e,"touchend",t),o&&((!a||l)&&this.dispatchEvent(e,"pointertap",t),s&&(this.dispatchEvent(e,"tap",t),o.over=!1))):o&&(this.dispatchEvent(e,"pointerupoutside",t),s&&this.dispatchEvent(e,"touchendoutside",t)),o&&o.none&&delete e.trackedPointers[r]},e.prototype.onPointerMove=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t);("mouse"===e[0].pointerType||"pen"===e[0].pointerType)&&(this._didMove=!0,this.cursor=null);for(var n=e.length,i=0;i<n;i++){var r=e[i],o=this.getInteractionDataForPointerId(r),s=this.configureInteractionEventForDOMEvent(this.eventData,r,o);s.data.originalEvent=t,this.processInteractive(s,this.lastObjectRendered,this.processPointerMove,!0),this.emit("pointermove",s),"touch"===r.pointerType&&this.emit("touchmove",s),("mouse"===r.pointerType||"pen"===r.pointerType)&&this.emit("mousemove",s)}"mouse"===e[0].pointerType&&this.setCursorMode(this.cursor)}},e.prototype.processPointerMove=function(t,e,n){var i=t.data,r="touch"===i.pointerType,o="mouse"===i.pointerType||"pen"===i.pointerType;o&&this.processPointerOverOut(t,e,n),(!this.moveWhenInside||n)&&(this.dispatchEvent(e,"pointermove",t),r&&this.dispatchEvent(e,"touchmove",t),o&&this.dispatchEvent(e,"mousemove",t))},e.prototype.onPointerOut=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t)[0];"mouse"===e.pointerType&&(this.mouseOverRenderer=!1,this.setCursorMode(null));var n=this.getInteractionDataForPointerId(e),i=this.configureInteractionEventForDOMEvent(this.eventData,e,n);i.data.originalEvent=e,this.processInteractive(i,this.lastObjectRendered,this.processPointerOverOut,!1),this.emit("pointerout",i),"mouse"===e.pointerType||"pen"===e.pointerType?this.emit("mouseout",i):this.releaseInteractionDataForPointerId(n.identifier)}},e.prototype.processPointerOverOut=function(t,e,n){var i=t.data,r=t.data.identifier,o="mouse"===i.pointerType||"pen"===i.pointerType,s=e.trackedPointers[r];n&&!s&&(s=e.trackedPointers[r]=new ga(r)),void 0!==s&&(n&&this.mouseOverRenderer?(s.over||(s.over=!0,this.delayDispatchEvent(e,"pointerover",t),o&&this.delayDispatchEvent(e,"mouseover",t)),o&&null===this.cursor&&(this.cursor=e.cursor)):s.over&&(s.over=!1,this.dispatchEvent(e,"pointerout",this.eventData),o&&this.dispatchEvent(e,"mouseout",t),s.none&&delete e.trackedPointers[r]))},e.prototype.onPointerOver=function(t){var e=this.normalizeToPointerData(t)[0],n=this.getInteractionDataForPointerId(e),i=this.configureInteractionEventForDOMEvent(this.eventData,e,n);i.data.originalEvent=e,"mouse"===e.pointerType&&(this.mouseOverRenderer=!0),this.emit("pointerover",i),("mouse"===e.pointerType||"pen"===e.pointerType)&&this.emit("mouseover",i)},e.prototype.getInteractionDataForPointerId=function(t){var e,n=t.pointerId;return 1===n||"mouse"===t.pointerType?e=this.mouse:this.activeInteractionData[n]?e=this.activeInteractionData[n]:((e=this.interactionDataPool.pop()||new fa).identifier=n,this.activeInteractionData[n]=e),e.copyEvent(t),e},e.prototype.releaseInteractionDataForPointerId=function(t){var e=this.activeInteractionData[t];e&&(delete this.activeInteractionData[t],e.reset(),this.interactionDataPool.push(e))},e.prototype.configureInteractionEventForDOMEvent=function(t,e,n){return t.data=n,this.mapPositionToPoint(n.global,e.clientX,e.clientY),"touch"===e.pointerType&&(e.globalX=n.global.x,e.globalY=n.global.y),n.originalEvent=e,t.reset(),t},e.prototype.normalizeToPointerData=function(t){var e=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(var n=0,i=t.changedTouches.length;n<i;n++){var r=t.changedTouches[n];typeof r.button>"u"&&(r.button=t.touches.length?1:0),typeof r.buttons>"u"&&(r.buttons=t.touches.length?1:0),typeof r.isPrimary>"u"&&(r.isPrimary=1===t.touches.length&&"touchstart"===t.type),typeof r.width>"u"&&(r.width=r.radiusX||1),typeof r.height>"u"&&(r.height=r.radiusY||1),typeof r.tiltX>"u"&&(r.tiltX=0),typeof r.tiltY>"u"&&(r.tiltY=0),typeof r.pointerType>"u"&&(r.pointerType="touch"),typeof r.pointerId>"u"&&(r.pointerId=r.identifier||0),typeof r.pressure>"u"&&(r.pressure=r.force||.5),typeof r.twist>"u"&&(r.twist=0),typeof r.tangentialPressure>"u"&&(r.tangentialPressure=0),typeof r.layerX>"u"&&(r.layerX=r.offsetX=r.clientX),typeof r.layerY>"u"&&(r.layerY=r.offsetY=r.clientY),r.isNormalized=!0,e.push(r)}else if(!self.MouseEvent||t instanceof MouseEvent&&!(this.supportsPointerEvents&&t instanceof self.PointerEvent)){var o=t;typeof o.isPrimary>"u"&&(o.isPrimary=!0),typeof o.width>"u"&&(o.width=1),typeof o.height>"u"&&(o.height=1),typeof o.tiltX>"u"&&(o.tiltX=0),typeof o.tiltY>"u"&&(o.tiltY=0),typeof o.pointerType>"u"&&(o.pointerType="mouse"),typeof o.pointerId>"u"&&(o.pointerId=1),typeof o.pressure>"u"&&(o.pressure=.5),typeof o.twist>"u"&&(o.twist=0),typeof o.tangentialPressure>"u"&&(o.tangentialPressure=0),o.isNormalized=!0,e.push(o)}else e.push(t);return e},e.prototype.destroy=function(){this.removeEvents(),this.removeTickerListener(),this.removeAllListeners(),this.renderer=null,this.mouse=null,this.eventData=null,this.interactionDOMElement=null,this.onPointerDown=null,this.processPointerDown=null,this.onPointerUp=null,this.processPointerUp=null,this.onPointerCancel=null,this.processPointerCancel=null,this.onPointerMove=null,this.processPointerMove=null,this.onPointerOut=null,this.processPointerOverOut=null,this.onPointerOver=null,this.search=null},e}(Ee),wa=function(t,e){return(wa=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},Pa=function(){function t(t){this._foundShapes=[],this.renderer=t}return t.prototype.pushMask=function(t){var e=this.renderer,n=t.maskObject||t;e.context.save();var i=this._foundShapes;if(this.recursiveFindShapes(n,i),i.length>0){var r=e.context;r.beginPath();for(var o=0;o<i.length;o++){var s=i[o],a=s.transform.worldTransform;this.renderer.setContextTransform(a),this.renderGraphicsShape(s)}i.length=0,r.clip()}},t.prototype.recursiveFindShapes=function(t,e){t.geometry&&t.geometry.graphicsData&&e.push(t);var n=t.children;if(n)for(var i=0;i<n.length;i++)this.recursiveFindShapes(n[i],e)},t.prototype.renderGraphicsShape=function(t){t.finishPoly();var e=this.renderer.context,n=t.geometry.graphicsData,i=n.length;if(0!==i)for(var r=0;r<i;r++){var o=n[r],s=o.shape;if(s.type===mi.POLY){var a=s.points,l=o.holes,u=void 0,h=void 0,c=void 0,p=void 0;e.moveTo(a[0],a[1]);for(var d=1;d<a.length/2;d++)e.lineTo(a[2*d],a[2*d+1]);if(l.length>0){for(u=0,c=a[0],p=a[1],d=2;d+2<a.length;d+=2)u+=(a[d]-c)*(a[d+3]-p)-(a[d+2]-c)*(a[d+1]-p);for(var f=0;f<l.length;f++)if(a=l[f].shape.points){for(h=0,c=a[0],p=a[1],d=2;d+2<a.length;d+=2)h+=(a[d]-c)*(a[d+3]-p)-(a[d+2]-c)*(a[d+1]-p);if(h*u<0)for(e.moveTo(a[0],a[1]),d=2;d<a.length;d+=2)e.lineTo(a[d],a[d+1]);else for(e.moveTo(a[a.length-2],a[a.length-1]),d=a.length-4;d>=0;d-=2)e.lineTo(a[d],a[d+1]);l[f].shape.closeStroke&&e.closePath()}}a[0]===a[a.length-2]&&a[1]===a[a.length-1]&&e.closePath()}else if(s.type===mi.RECT)e.rect(s.x,s.y,s.width,s.height),e.closePath();else if(s.type===mi.CIRC)e.arc(s.x,s.y,s.radius,0,2*Math.PI),e.closePath();else if(s.type===mi.ELIP){var m=2*s.width,y=2*s.height,g=s.x-m/2,v=s.y-y/2,_=.5522848,x=m/2*_,b=y/2*_,w=g+m,P=v+y,E=g+m/2,T=v+y/2;e.moveTo(g,T),e.bezierCurveTo(g,T-b,E-x,v,E,v),e.bezierCurveTo(E+x,v,w,T-b,w,T),e.bezierCurveTo(w,T+b,E+x,P,E,P),e.bezierCurveTo(E-x,P,g,T+b,g,T),e.closePath()}else if(s.type===mi.RREC){var S=s.x,C=s.y,I=s.width,A=s.height,O=s.radius,N=Math.min(I,A)/2;O=O>N?N:O,e.moveTo(S,C+O),e.lineTo(S,C+A-O),e.quadraticCurveTo(S,C+A,S+O,C+A),e.lineTo(S+I-O,C+A),e.quadraticCurveTo(S+I,C+A,S+I,C+A-O),e.lineTo(S+I,C+O),e.quadraticCurveTo(S+I,C,S+I-O,C),e.lineTo(S+O,C),e.quadraticCurveTo(S,C,S,C+O),e.closePath()}}},t.prototype.popMask=function(t){t.context.restore(),t.invalidateBlendMode()},t.prototype.destroy=function(){},t}();function Ea(t){var e=document.createElement("canvas");e.width=6,e.height=1;var n=e.getContext("2d");return n.fillStyle=t,n.fillRect(0,0,6,1),e}function Ta(){if(typeof document>"u")return!1;var t=Ea("#ff00ff"),e=Ea("#ffff00"),n=document.createElement("canvas");n.width=6,n.height=1;var i=n.getContext("2d");i.globalCompositeOperation="multiply",i.drawImage(t,0,0),i.drawImage(e,2,0);var r=i.getImageData(2,0,1,1);if(!r)return!1;var o=r.data;return 255===o[0]&&0===o[1]&&0===o[2]}var Sa=new Ci,Ca=function(t){function e(n){var i=t.call(this,_t.CANVAS,n)||this;if(i.refresh=!0,i.maskManager=new Pa(i),i.smoothProperty="imageSmoothingEnabled",i.blendModes=function(t){return void 0===t&&(t=[]),Ta()?(t[bt.NORMAL]="source-over",t[bt.ADD]="lighter",t[bt.MULTIPLY]="multiply",t[bt.SCREEN]="screen",t[bt.OVERLAY]="overlay",t[bt.DARKEN]="darken",t[bt.LIGHTEN]="lighten",t[bt.COLOR_DODGE]="color-dodge",t[bt.COLOR_BURN]="color-burn",t[bt.HARD_LIGHT]="hard-light",t[bt.SOFT_LIGHT]="soft-light",t[bt.DIFFERENCE]="difference",t[bt.EXCLUSION]="exclusion",t[bt.HUE]="hue",t[bt.SATURATION]="saturate",t[bt.COLOR]="color",t[bt.LUMINOSITY]="luminosity"):(t[bt.NORMAL]="source-over",t[bt.ADD]="lighter",t[bt.MULTIPLY]="source-over",t[bt.SCREEN]="source-over",t[bt.OVERLAY]="source-over",t[bt.DARKEN]="source-over",t[bt.LIGHTEN]="source-over",t[bt.COLOR_DODGE]="source-over",t[bt.COLOR_BURN]="source-over",t[bt.HARD_LIGHT]="source-over",t[bt.SOFT_LIGHT]="source-over",t[bt.DIFFERENCE]="source-over",t[bt.EXCLUSION]="source-over",t[bt.HUE]="source-over",t[bt.SATURATION]="source-over",t[bt.COLOR]="source-over",t[bt.LUMINOSITY]="source-over"),t[bt.NORMAL_NPM]=t[bt.NORMAL],t[bt.ADD_NPM]=t[bt.ADD],t[bt.SCREEN_NPM]=t[bt.SCREEN],t[bt.SRC_IN]="source-in",t[bt.SRC_OUT]="source-out",t[bt.SRC_ATOP]="source-atop",t[bt.DST_OVER]="destination-over",t[bt.DST_IN]="destination-in",t[bt.DST_OUT]="destination-out",t[bt.DST_ATOP]="destination-atop",t[bt.XOR]="xor",t[bt.SUBTRACT]="source-over",t}(),i.renderingToScreen=!1,i._activeBlendMode=null,i._projTransform=null,i._outerBlend=!1,i.rootContext=i.view.getContext("2d",{alpha:i.useContextAlpha}),i.context=i.rootContext,!i.rootContext.imageSmoothingEnabled){var r=i.rootContext;r.webkitImageSmoothingEnabled?i.smoothProperty="webkitImageSmoothingEnabled":r.mozImageSmoothingEnabled?i.smoothProperty="mozImageSmoothingEnabled":r.oImageSmoothingEnabled?i.smoothProperty="oImageSmoothingEnabled":r.msImageSmoothingEnabled&&(i.smoothProperty="msImageSmoothingEnabled")}return i.initPlugins(e.__plugins),Un("Canvas"),i.resize(i.options.width,i.options.height),i}return function(t,e){function n(){this.constructor=t}wa(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.render=function(t,e){if(this.view){var n,i,r,o;e&&(e instanceof kr||e instanceof Or?(ri("6.0.0","CanvasRenderer#render arguments changed, use options instead."),n=e,i=arguments[2],r=arguments[3],o=arguments[4]):(n=e.renderTexture,i=e.clear,r=e.transform,o=e.skipUpdateTransform)),this.renderingToScreen=!n,this.emit("prerender");var s=this.resolution;n?((n=n.castToBaseTexture())._canvasRenderTarget||(n._canvasRenderTarget=new ui(n.width,n.height,n.resolution),n.resource=new wr(n._canvasRenderTarget.canvas),n.valid=!0),this.context=n._canvasRenderTarget.context,this.resolution=n._canvasRenderTarget.resolution):this.context=this.rootContext;var a=this.context;if(this._projTransform=r||null,n||(this._lastObjectRendered=t),!o){var l=t.enableTempParent();t.updateTransform(),t.disableTempParent(l)}if(a.save(),a.setTransform(1,0,0,1,0,0),a.globalAlpha=1,this._activeBlendMode=bt.NORMAL,this._outerBlend=!1,a.globalCompositeOperation=this.blendModes[bt.NORMAL],void 0!==i?i:this.clearBeforeRender)if(this.renderingToScreen)a.clearRect(0,0,this.width,this.height),this.backgroundAlpha>0&&(a.globalAlpha=this.useContextAlpha?this.backgroundAlpha:1,a.fillStyle=this._backgroundColorString,a.fillRect(0,0,this.width,this.height),a.globalAlpha=1);else{n._canvasRenderTarget.clear();var u=n.clearColor;u[3]>0&&(a.globalAlpha=this.useContextAlpha?u[3]:1,a.fillStyle=Gn(Wn(u)),a.fillRect(0,0,n.realWidth,n.realHeight),a.globalAlpha=1)}var h=this.context;this.context=a,t.renderCanvas(this),this.context=h,a.restore(),this.resolution=s,this._projTransform=null,this.emit("postrender")}},e.prototype.setContextTransform=function(t,e,n){var i=t,r=this._projTransform,o=this.resolution;n=n||o,r&&((i=Sa).copyFrom(t),i.prepend(r)),e?this.context.setTransform(i.a*n,i.b*n,i.c*n,i.d*n,i.tx*o|0,i.ty*o|0):this.context.setTransform(i.a*n,i.b*n,i.c*n,i.d*n,i.tx*o,i.ty*o)},e.prototype.clear=function(t,e){void 0===t&&(t=this._backgroundColorString),void 0===e&&(e=this.backgroundAlpha);var n=this.context;n.clearRect(0,0,this.width,this.height),t&&(n.globalAlpha=this.useContextAlpha?e:1,n.fillStyle=t,n.fillRect(0,0,this.width,this.height),n.globalAlpha=1)},e.prototype.setBlendMode=function(t,e){var n=t===bt.SRC_IN||t===bt.SRC_OUT||t===bt.DST_IN||t===bt.DST_ATOP;!e&&n&&(t=bt.NORMAL),this._activeBlendMode!==t&&(this._activeBlendMode=t,this._outerBlend=n,this.context.globalCompositeOperation=this.blendModes[t])},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this.context=null,this.refresh=!0,this.maskManager.destroy(),this.maskManager=null,this.smoothProperty=null},e.prototype.resize=function(e,n){t.prototype.resize.call(this,e,n),this.smoothProperty&&(this.rootContext[this.smoothProperty]=xe.SCALE_MODE===Ct.LINEAR)},e.prototype.invalidateBlendMode=function(){this._activeBlendMode=this.blendModes.indexOf(this.context.globalCompositeOperation)},e.registerPlugin=function(t,n){e.__plugins=e.__plugins||{},e.__plugins[t]=n},e}(os),Ia={canvas:null,getTintedCanvas:function(t,e){var n=t.texture,i="#"+("00000"+(0|(e=Ia.roundColor(e))).toString(16)).substr(-6);n.tintCache=n.tintCache||{};var r,o=n.tintCache[i];if(o){if(o.tintId===n._updateID)return n.tintCache[i];r=n.tintCache[i]}else r=document.createElement("canvas");return Ia.tintMethod(n,e,r),r.tintId=n._updateID,n.tintCache[i]=r,r},getTintedPattern:function(t,e){var n="#"+("00000"+(0|(e=Ia.roundColor(e))).toString(16)).substr(-6);t.patternCache=t.patternCache||{};var i=t.patternCache[n];return i&&i.tintId===t._updateID||(Ia.canvas||(Ia.canvas=document.createElement("canvas")),Ia.tintMethod(t,e,Ia.canvas),(i=Ia.canvas.getContext("2d").createPattern(Ia.canvas,"repeat")).tintId=t._updateID,t.patternCache[n]=i),i},tintWithMultiply:function(t,e,n){var i=n.getContext("2d"),r=t._frame.clone(),o=t.baseTexture.resolution;r.x*=o,r.y*=o,r.width*=o,r.height*=o,n.width=Math.ceil(r.width),n.height=Math.ceil(r.height),i.save(),i.fillStyle="#"+("00000"+(0|e).toString(16)).substr(-6),i.fillRect(0,0,r.width,r.height),i.globalCompositeOperation="multiply";var s=t.baseTexture.getDrawableSource();i.drawImage(s,r.x,r.y,r.width,r.height,0,0,r.width,r.height),i.globalCompositeOperation="destination-atop",i.drawImage(s,r.x,r.y,r.width,r.height,0,0,r.width,r.height),i.restore()},tintWithOverlay:function(t,e,n){var i=n.getContext("2d"),r=t._frame.clone(),o=t.baseTexture.resolution;r.x*=o,r.y*=o,r.width*=o,r.height*=o,n.width=Math.ceil(r.width),n.height=Math.ceil(r.height),i.save(),i.globalCompositeOperation="copy",i.fillStyle="#"+("00000"+(0|e).toString(16)).substr(-6),i.fillRect(0,0,r.width,r.height),i.globalCompositeOperation="destination-atop",i.drawImage(t.baseTexture.getDrawableSource(),r.x,r.y,r.width,r.height,0,0,r.width,r.height),i.restore()},tintWithPerPixel:function(t,e,n){var i=n.getContext("2d"),r=t._frame.clone(),o=t.baseTexture.resolution;r.x*=o,r.y*=o,r.width*=o,r.height*=o,n.width=Math.ceil(r.width),n.height=Math.ceil(r.height),i.save(),i.globalCompositeOperation="copy",i.drawImage(t.baseTexture.getDrawableSource(),r.x,r.y,r.width,r.height,0,0,r.width,r.height),i.restore();for(var s=Yn(e),a=s[0],l=s[1],u=s[2],h=i.getImageData(0,0,r.width,r.height),c=h.data,p=0;p<c.length;p+=4)c[p+0]*=a,c[p+1]*=l,c[p+2]*=u;i.putImageData(h,0,0)},roundColor:function(t){var e=Ia.cacheStepsPerColorChannel,n=Yn(t);return n[0]=Math.min(255,n[0]/e*e),n[1]=Math.min(255,n[1]/e*e),n[2]=Math.min(255,n[2]/e*e),Wn(n)},cacheStepsPerColorChannel:8,convertTintToImage:!1,canUseMultiply:Ta(),tintMethod:null};Ia.tintMethod=Ia.canUseMultiply?Ia.tintWithMultiply:Ia.tintWithPerPixel;var Aa=ls.create;ls.create=function(t){if(!t||!t.forceCanvas)try{return Aa(t)}catch{}return new Ca(t)},vr.prototype.getDrawableSource=function(){var t=this.resource;return t?t.bitmap||t.source:null},Or.prototype._canvasRenderTarget=null,Mr.prototype.patternCache=null,Mr.prototype.tintCache=null;var Oa,Na=new xi,La=function(){function t(t){this.renderer=t}return t.prototype.image=function(t,e,n){var i=new Image;return i.src=this.base64(t,e,n),i},t.prototype.base64=function(t,e,n){return this.canvas(t).toDataURL(e,n)},t.prototype.canvas=function(t){var e,n,i,r,o=this.renderer;t&&(r=t instanceof kr?t:o.generateTexture(t)),r?(e=r.baseTexture._canvasRenderTarget.context,n=r.baseTexture._canvasRenderTarget.resolution,i=r.frame):(e=o.rootContext,n=o.resolution,(i=Na).width=this.renderer.width,i.height=this.renderer.height);var s=Math.floor(i.width*n+1e-4),a=Math.floor(i.height*n+1e-4),l=new ui(s,a,1),u=e.getImageData(i.x*n,i.y*n,s,a);return l.context.putImageData(u,0,0),l.canvas},t.prototype.pixels=function(t){var e,n,i,r,o=this.renderer;t&&(r=t instanceof kr?t:o.generateTexture(t)),r?(e=r.baseTexture._canvasRenderTarget.context,n=r.baseTexture._canvasRenderTarget.resolution,i=r.frame):(e=o.rootContext,n=o.resolution,(i=Na).width=o.width,i.height=o.height);var s=i.x*n,a=i.y*n,l=i.width*n,u=i.height*n;return e.getImageData(s,a,l,u).data},t.prototype.destroy=function(){this.renderer=null},t}(),Ma=function(){function t(){}return t.offsetPolygon=function(e,n){var i=[],r=e.length;n=t.isPolygonClockwise(e)?n:-1*n;for(var o=0;o<r;o+=2){var s=o-2;s<0&&(s+=r);var a=(o+2)%r,l=e[o]-e[s],u=e[o+1]-e[s+1],h=Math.sqrt(l*l+u*u);l/=h,u/=h;var c=-(u*=n),p=l*=n,d=[e[s]+c,e[s+1]+p],f=[e[o]+c,e[o+1]+p],m=e[a]-e[o],y=e[a+1]-e[o+1];m/=h=Math.sqrt(m*m+y*y),y/=h;var g=-(y*=n),v=m*=n,_=[e[o]+g,e[o+1]+v],x=[e[a]+g,e[a+1]+v],b=t.findIntersection(d[0],d[1],f[0],f[1],_[0],_[1],x[0],x[1]);b&&i.push.apply(i,b)}return i},t.findIntersection=function(t,e,n,i,r,o,s,a){var l=(a-o)*(n-t)-(s-r)*(i-e),u=(s-r)*(e-o)-(a-o)*(t-r);if(0===l)return 0===u&&0==(n-t)*(e-o)-(i-e)*(t-r)?[(t+n)/2,(e+i)/2]:null;var h=u/l;return[t+h*(n-t),e+h*(i-e)]},t.isPolygonClockwise=function(t){for(var e=0,n=0;n<t.length-2;n+=2)e+=(t[n+2]-t[n])*(t[n+3]+t[n+1]);return e>0},t}(),Ra=function(){function t(t){this._svgMatrix=null,this._tempMatrix=new Ci,this.renderer=t}return t.prototype._calcCanvasStyle=function(t,e){var n;return t.texture&&t.texture.baseTexture!==Mr.WHITE.baseTexture?t.texture.valid?(n=Ia.getTintedPattern(t.texture,e),this.setPatternTransform(n,t.matrix||Ci.IDENTITY)):n="#808080":n="#"+("00000"+(0|e).toString(16)).substr(-6),n},t.prototype.render=function(t){var e=this.renderer,n=e.context,i=t.worldAlpha,r=t.transform.worldTransform;e.setContextTransform(r),e.setBlendMode(t.blendMode);for(var o,s,a=t.geometry.graphicsData,l=(t.tint>>16&255)/255,u=(t.tint>>8&255)/255,h=(255&t.tint)/255,c=0;c<a.length;c++){var p=a[c],d=p.shape,f=p.fillStyle,m=p.lineStyle,y=0|p.fillStyle.color,g=0|p.lineStyle.color;if(p.matrix&&e.setContextTransform(r.copyTo(this._tempMatrix).append(p.matrix)),f.visible){var v=((y>>16&255)/255*l*255<<16)+((y>>8&255)/255*u*255<<8)+(255&y)/255*h*255;o=this._calcCanvasStyle(f,v)}if(m.visible){var _=((g>>16&255)/255*l*255<<16)+((g>>8&255)/255*u*255<<8)+(255&g)/255*h*255;s=this._calcCanvasStyle(m,_)}if(n.lineWidth=m.width,n.lineCap=m.cap,n.lineJoin=m.join,n.miterLimit=m.miterLimit,p.type===mi.POLY){n.beginPath();var x=(A=d).points,b=p.holes,w=void 0,P=void 0,E=void 0,T=void 0,S=void 0;n.moveTo(x[0],x[1]);for(var C=2;C<x.length;C+=2)n.lineTo(x[C],x[C+1]);if(A.closeStroke&&n.closePath(),b.length>0){for(S=[],w=0,E=x[0],T=x[1],C=2;C+2<x.length;C+=2)w+=(x[C]-E)*(x[C+3]-T)-(x[C+2]-E)*(x[C+1]-T);for(var I=0;I<b.length;I++)if(x=b[I].shape.points){for(P=0,E=x[0],T=x[1],C=2;C+2<x.length;C+=2)P+=(x[C]-E)*(x[C+3]-T)-(x[C+2]-E)*(x[C+1]-T);if(P*w<0)for(n.moveTo(x[0],x[1]),C=2;C<x.length;C+=2)n.lineTo(x[C],x[C+1]);else for(n.moveTo(x[x.length-2],x[x.length-1]),C=x.length-4;C>=0;C-=2)n.lineTo(x[C],x[C+1]);b[I].shape.closeStroke&&n.closePath(),S[I]=P*w<0}}f.visible&&(n.globalAlpha=f.alpha*i,n.fillStyle=o,n.fill()),m.visible&&this.paintPolygonStroke(A,m,s,b,S,i,n)}else if(p.type===mi.RECT){var A=d;if(f.visible&&(n.globalAlpha=f.alpha*i,n.fillStyle=o,n.fillRect(A.x,A.y,A.width,A.height)),m.visible){var O=m.width*(.5-(1-m.alignment)),N=A.width+2*O,L=A.height+2*O;n.globalAlpha=m.alpha*i,n.strokeStyle=s,n.strokeRect(A.x-O,A.y-O,N,L)}}else if(p.type===mi.CIRC)A=d,n.beginPath(),n.arc(A.x,A.y,A.radius,0,2*Math.PI),n.closePath(),f.visible&&(n.globalAlpha=f.alpha*i,n.fillStyle=o,n.fill()),m.visible&&(.5!==m.alignment&&(O=m.width*(.5-(1-m.alignment)),n.beginPath(),n.arc(A.x,A.y,A.radius+O,0,2*Math.PI),n.closePath()),n.globalAlpha=m.alpha*i,n.strokeStyle=s,n.stroke());else if(p.type===mi.ELIP){if(A=d,(H=1===m.alignment)||this.paintEllipse(A,f,m,o,i,n),m.visible){if(.5!==m.alignment){var M=.5522848,R=(O=m.width*(.5-(1-m.alignment)),2*(A.width+O)),k=2*(A.height+O),D=A.x-R/2,F=A.y-k/2,B=R/2*M,U=k/2*M,z=D+R,X=F+k,Y=D+R/2,G=F+k/2;n.beginPath(),n.moveTo(D,G),n.bezierCurveTo(D,G-U,Y-B,F,Y,F),n.bezierCurveTo(Y+B,F,z,G-U,z,G),n.bezierCurveTo(z,G+U,Y+B,X,Y,X),n.bezierCurveTo(Y-B,X,D,G+U,D,G),n.closePath()}n.globalAlpha=m.alpha*i,n.strokeStyle=s,n.stroke()}H&&this.paintEllipse(A,f,m,o,i,n)}else if(p.type===mi.RREC){var H;if(A=d,(H=1===m.alignment)||this.paintRoundedRectangle(A,f,m,o,i,n),m.visible){if(.5!==m.alignment){N=A.width,L=A.height,O=m.width*(.5-(1-m.alignment));var W=A.x-O,j=A.y-O,V=A.width+2*O,q=A.height+2*O,$=O*(m.alignment>=1?Math.min(V/N,q/L):Math.min(N/V,L/q)),Z=A.radius+$,K=Math.min(V,q)/2;Z=Z>K?K:Z,n.beginPath(),n.moveTo(W,j+Z),n.lineTo(W,j+q-Z),n.quadraticCurveTo(W,j+q,W+Z,j+q),n.lineTo(W+V-Z,j+q),n.quadraticCurveTo(W+V,j+q,W+V,j+q-Z),n.lineTo(W+V,j+Z),n.quadraticCurveTo(W+V,j,W+V-Z,j),n.lineTo(W+Z,j),n.quadraticCurveTo(W,j,W,j+Z),n.closePath()}n.globalAlpha=m.alpha*i,n.strokeStyle=s,n.stroke()}H&&this.paintRoundedRectangle(A,f,m,o,i,n)}}},t.prototype.paintPolygonStroke=function(t,e,n,i,r,o,s){if(.5!==e.alignment){var a=e.width*(.5-(1-e.alignment)),l=Ma.offsetPolygon(t.points,a),u=void 0;s.beginPath(),s.moveTo(l[0],l[1]);for(var h=2;h<l.length;h+=2)s.lineTo(l[h],l[h+1]);t.closeStroke&&s.closePath();for(var c=0;c<i.length;c++){if(u=i[c].shape.points,l=Ma.offsetPolygon(u,a),r[c])for(s.moveTo(l[0],l[1]),h=2;h<l.length;h+=2)s.lineTo(l[h],l[h+1]);else for(s.moveTo(l[l.length-2],l[l.length-1]),h=l.length-4;h>=0;h-=2)s.lineTo(l[h],l[h+1]);i[c].shape.closeStroke&&s.closePath()}}s.globalAlpha=e.alpha*o,s.strokeStyle=n,s.stroke()},t.prototype.paintEllipse=function(t,e,n,i,r,o){var s=2*t.width,a=2*t.height,l=t.x-s/2,u=t.y-a/2,h=.5522848,c=s/2*h,p=a/2*h,d=l+s,f=u+a,m=l+s/2,y=u+a/2;0===n.alignment&&o.save(),o.beginPath(),o.moveTo(l,y),o.bezierCurveTo(l,y-p,m-c,u,m,u),o.bezierCurveTo(m+c,u,d,y-p,d,y),o.bezierCurveTo(d,y+p,m+c,f,m,f),o.bezierCurveTo(m-c,f,l,y+p,l,y),o.closePath(),0===n.alignment&&o.clip(),e.visible&&(o.globalAlpha=e.alpha*r,o.fillStyle=i,o.fill()),0===n.alignment&&o.restore()},t.prototype.paintRoundedRectangle=function(t,e,n,i,r,o){var s=t.x,a=t.y,l=t.width,u=t.height,h=t.radius,c=Math.min(l,u)/2;h=h>c?c:h,0===n.alignment&&o.save(),o.beginPath(),o.moveTo(s,a+h),o.lineTo(s,a+u-h),o.quadraticCurveTo(s,a+u,s+h,a+u),o.lineTo(s+l-h,a+u),o.quadraticCurveTo(s+l,a+u,s+l,a+u-h),o.lineTo(s+l,a+h),o.quadraticCurveTo(s+l,a,s+l-h,a),o.lineTo(s+h,a),o.quadraticCurveTo(s,a,s,a+h),o.closePath(),0===n.alignment&&o.clip(),e.visible&&(o.globalAlpha=e.alpha*r,o.fillStyle=i,o.fill()),0===n.alignment&&o.restore()},t.prototype.setPatternTransform=function(t,e){if(!1!==this._svgMatrix){if(!this._svgMatrix){var n=document.createElementNS("http://www.w3.org/2000/svg","svg");if(n&&n.createSVGMatrix&&(this._svgMatrix=n.createSVGMatrix()),!this._svgMatrix||!t.setTransform)return void(this._svgMatrix=!1)}this._svgMatrix.a=e.a,this._svgMatrix.b=e.b,this._svgMatrix.c=e.c,this._svgMatrix.d=e.d,this._svgMatrix.e=e.tx,this._svgMatrix.f=e.ty,t.setTransform(this._svgMatrix.inverse())}},t.prototype.destroy=function(){this.renderer=null,this._svgMatrix=null,this._tempMatrix=null},t}(),ka=new Ci;ta.prototype.generateCanvasTexture=function(t,e){void 0===e&&(e=1);var n=this.getLocalBounds(),i=kr.create({width:n.width,height:n.height,scaleMode:t,resolution:e});Oa||(Oa=new Ca),this.transform.updateLocalTransform(),this.transform.localTransform.copyTo(ka),ka.invert(),ka.tx-=n.x,ka.ty-=n.y,Oa.render(this,{renderTexture:i,clear:!0,transform:ka});var r=Mr.from(i.baseTexture._canvasRenderTarget.canvas,{scaleMode:t});return r.baseTexture.setResolution(e),r},ta.prototype.cachedGraphicsData=[],ta.prototype._renderCanvas=function(t){!0!==this.isMask&&(this.finishPoly(),t.plugins.graphics.render(this))},xe.UPLOADS_PER_FRAME=4;var Da=function(t,e){return(Da=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},Fa=function(){function t(t){this.maxItemsPerFrame=t,this.itemsLeft=0}return t.prototype.beginFrame=function(){this.itemsLeft=this.maxItemsPerFrame},t.prototype.allowedToUpload=function(){return this.itemsLeft-- >0},t}();function Ba(t,e){var n=!1;if(t&&t._textures&&t._textures.length)for(var i=0;i<t._textures.length;i++)if(t._textures[i]instanceof Mr){var r=t._textures[i].baseTexture;-1===e.indexOf(r)&&(e.push(r),n=!0)}return n}function Ua(t,e){if(t.baseTexture instanceof vr){var n=t.baseTexture;return-1===e.indexOf(n)&&e.push(n),!0}return!1}function za(t,e){if(t._texture&&t._texture instanceof Mr){var n=t._texture.baseTexture;return-1===e.indexOf(n)&&e.push(n),!0}return!1}function Xa(t,e){return e instanceof ca&&(e.updateText(!0),!0)}function Ya(t,e){if(e instanceof ra){var n=e.toFontString();return la.measureFont(n),!0}return!1}function Ga(t,e){if(t instanceof ca){-1===e.indexOf(t.style)&&e.push(t.style),-1===e.indexOf(t)&&e.push(t);var n=t._texture.baseTexture;return-1===e.indexOf(n)&&e.push(n),!0}return!1}function Ha(t,e){return t instanceof ra&&(-1===e.indexOf(t)&&e.push(t),!0)}var Wa=function(){function t(t){var e=this;this.limiter=new Fa(xe.UPLOADS_PER_FRAME),this.renderer=t,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=function(){!e.queue||e.prepareItems()},this.registerFindHook(Ga),this.registerFindHook(Ha),this.registerFindHook(Ba),this.registerFindHook(Ua),this.registerFindHook(za),this.registerUploadHook(Xa),this.registerUploadHook(Ya)}return t.prototype.upload=function(t,e){"function"==typeof t&&(e=t,t=null),t&&this.add(t),this.queue.length?(e&&this.completes.push(e),this.ticking||(this.ticking=!0,we.system.addOnce(this.tick,this,_e.UTILITY))):e&&e()},t.prototype.tick=function(){setTimeout(this.delayedTick,0)},t.prototype.prepareItems=function(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){var t=this.queue[0],e=!1;if(t&&!t._destroyed)for(var n=0,i=this.uploadHooks.length;n<i;n++)if(this.uploadHooks[n](this.uploadHookHelper,t)){this.queue.shift(),e=!0;break}e||this.queue.shift()}if(this.queue.length)we.system.addOnce(this.tick,this,_e.UTILITY);else{this.ticking=!1;var r=this.completes.slice(0);for(this.completes.length=0,n=0,i=r.length;n<i;n++)r[n]()}},t.prototype.registerFindHook=function(t){return t&&this.addHooks.push(t),this},t.prototype.registerUploadHook=function(t){return t&&this.uploadHooks.push(t),this},t.prototype.add=function(t){for(var e=0,n=this.addHooks.length;e<n&&!this.addHooks[e](t,this.queue);e++);if(t instanceof lr)for(e=t.children.length-1;e>=0;e--)this.add(t.children[e]);return this},t.prototype.destroy=function(){this.ticking&&we.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null},t}();function ja(t,e){return e instanceof vr&&(e._glTextures[t.CONTEXT_UID]||t.texture.bind(e),!0)}function Va(t,e){if(!(e instanceof ta))return!1;var n=e.geometry;e.finishPoly(),n.updateBatches();for(var i=n.batches,r=0;r<i.length;r++){var o=i[r].style.texture;o&&ja(t,o.baseTexture)}return n.batchable||t.geometry.bind(n,e._resolveDirectShader(t)),!0}function qa(t,e){return t instanceof ta&&(e.push(t),!0)}!function(t){!function(t,e){function n(){this.constructor=t}Da(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}((function(e){var n=t.call(this,e)||this;return n.uploadHookHelper=n.renderer,n.registerFindHook(qa),n.registerUploadHook(ja),n.registerUploadHook(Va),n}),t)}(Wa);var $a=function(t,e){return($a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function Za(t,e){var n=t;if(e instanceof vr){var i=e.source,r=0===i.width?n.canvas.width:Math.min(n.canvas.width,i.width),o=0===i.height?n.canvas.height:Math.min(n.canvas.height,i.height);return n.ctx.drawImage(i,0,0,r,o,0,0,n.canvas.width,n.canvas.height),!0}return!1}var Ka=function(t){function e(e){var n=t.call(this,e)||this;return n.uploadHookHelper=n,n.canvas=document.createElement("canvas"),n.canvas.width=16,n.canvas.height=16,n.ctx=n.canvas.getContext("2d"),n.registerUploadHook(Za),n}return function(t,e){function n(){this.constructor=t}$a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.destroy=function(){t.prototype.destroy.call(this),this.ctx=null,this.canvas=null},e}(Wa),Qa=new Ci,Ja=function(){function t(t){this.renderer=t}return t.prototype.render=function(t){var e=t._texture,n=this.renderer,i=n.context;if(e.valid){var r=e._frame.width,o=e._frame.height,s=t.transform.worldTransform,a=0,l=0,u=e.baseTexture.getDrawableSource();if(!(e.orig.width<=0||e.orig.height<=0)&&e.valid&&u){n.setBlendMode(t.blendMode,!0),n.context.globalAlpha=t.worldAlpha;var h=e.baseTexture.scaleMode===Ct.LINEAR;n.smoothProperty&&n.context[n.smoothProperty]!==h&&(i[n.smoothProperty]=h),e.trim?(a=e.trim.width/2+e.trim.x-t.anchor.x*e.orig.width,l=e.trim.height/2+e.trim.y-t.anchor.y*e.orig.height):(a=(.5-t.anchor.x)*e.orig.width,l=(.5-t.anchor.y)*e.orig.height),e.rotate&&(s.copyTo(Qa),s=Qa,ki.matrixAppendRotationInv(s,e.rotate,a,l),a=0,l=0),a-=r/2,l-=o/2,n.setContextTransform(s,t.roundPixels,1),t.roundPixels&&(a|=0,l|=0);var c=e.baseTexture.resolution,p=n._outerBlend;p&&(i.save(),i.beginPath(),i.rect(a*n.resolution,l*n.resolution,r*n.resolution,o*n.resolution),i.clip()),16777215!==t.tint?((t._cachedTint!==t.tint||t._tintedCanvas.tintId!==t._texture._updateID)&&(t._cachedTint=t.tint,t._tintedCanvas=Ia.getTintedCanvas(t,t.tint)),i.drawImage(t._tintedCanvas,0,0,Math.floor(r*c),Math.floor(o*c),Math.floor(a*n.resolution),Math.floor(l*n.resolution),Math.floor(r*n.resolution),Math.floor(o*n.resolution))):i.drawImage(u,e._frame.x*c,e._frame.y*c,Math.floor(r*c),Math.floor(o*c),Math.floor(a*n.resolution),Math.floor(l*n.resolution),Math.floor(r*n.resolution),Math.floor(o*n.resolution)),p&&i.restore(),n.setBlendMode(bt.NORMAL)}}},t.prototype.destroy=function(){this.renderer=null},t}();Es.prototype._tintedCanvas=null,Es.prototype._renderCanvas=function(t){t.plugins.sprite.render(this)};var tl=function(t,e){return(tl=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},el=function(t){function e(){var e=this,n={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};return(e=t.call(this,"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n","varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float m[20];\nuniform float uAlpha;\n\nvoid main(void)\n{\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    if (uAlpha == 0.0) {\n        gl_FragColor = c;\n        return;\n    }\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (c.a > 0.0) {\n      c.rgb /= c.a;\n    }\n\n    vec4 result;\n\n    result.r = (m[0] * c.r);\n        result.r += (m[1] * c.g);\n        result.r += (m[2] * c.b);\n        result.r += (m[3] * c.a);\n        result.r += m[4];\n\n    result.g = (m[5] * c.r);\n        result.g += (m[6] * c.g);\n        result.g += (m[7] * c.b);\n        result.g += (m[8] * c.a);\n        result.g += m[9];\n\n    result.b = (m[10] * c.r);\n       result.b += (m[11] * c.g);\n       result.b += (m[12] * c.b);\n       result.b += (m[13] * c.a);\n       result.b += m[14];\n\n    result.a = (m[15] * c.r);\n       result.a += (m[16] * c.g);\n       result.a += (m[17] * c.b);\n       result.a += (m[18] * c.a);\n       result.a += m[19];\n\n    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);\n\n    // Premultiply alpha again.\n    rgb *= result.a;\n\n    gl_FragColor = vec4(rgb, result.a);\n}\n",n)||this).alpha=1,e}return function(t,e){function n(){this.constructor=t}tl(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype._loadMatrix=function(t,e){void 0===e&&(e=!1);var n=t;e&&(this._multiply(n,this.uniforms.m,t),n=this._colorMatrix(n)),this.uniforms.m=n},e.prototype._multiply=function(t,e,n){return t[0]=e[0]*n[0]+e[1]*n[5]+e[2]*n[10]+e[3]*n[15],t[1]=e[0]*n[1]+e[1]*n[6]+e[2]*n[11]+e[3]*n[16],t[2]=e[0]*n[2]+e[1]*n[7]+e[2]*n[12]+e[3]*n[17],t[3]=e[0]*n[3]+e[1]*n[8]+e[2]*n[13]+e[3]*n[18],t[4]=e[0]*n[4]+e[1]*n[9]+e[2]*n[14]+e[3]*n[19]+e[4],t[5]=e[5]*n[0]+e[6]*n[5]+e[7]*n[10]+e[8]*n[15],t[6]=e[5]*n[1]+e[6]*n[6]+e[7]*n[11]+e[8]*n[16],t[7]=e[5]*n[2]+e[6]*n[7]+e[7]*n[12]+e[8]*n[17],t[8]=e[5]*n[3]+e[6]*n[8]+e[7]*n[13]+e[8]*n[18],t[9]=e[5]*n[4]+e[6]*n[9]+e[7]*n[14]+e[8]*n[19]+e[9],t[10]=e[10]*n[0]+e[11]*n[5]+e[12]*n[10]+e[13]*n[15],t[11]=e[10]*n[1]+e[11]*n[6]+e[12]*n[11]+e[13]*n[16],t[12]=e[10]*n[2]+e[11]*n[7]+e[12]*n[12]+e[13]*n[17],t[13]=e[10]*n[3]+e[11]*n[8]+e[12]*n[13]+e[13]*n[18],t[14]=e[10]*n[4]+e[11]*n[9]+e[12]*n[14]+e[13]*n[19]+e[14],t[15]=e[15]*n[0]+e[16]*n[5]+e[17]*n[10]+e[18]*n[15],t[16]=e[15]*n[1]+e[16]*n[6]+e[17]*n[11]+e[18]*n[16],t[17]=e[15]*n[2]+e[16]*n[7]+e[17]*n[12]+e[18]*n[17],t[18]=e[15]*n[3]+e[16]*n[8]+e[17]*n[13]+e[18]*n[18],t[19]=e[15]*n[4]+e[16]*n[9]+e[17]*n[14]+e[18]*n[19]+e[19],t},e.prototype._colorMatrix=function(t){var e=new Float32Array(t);return e[4]/=255,e[9]/=255,e[14]/=255,e[19]/=255,e},e.prototype.brightness=function(t,e){var n=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(n,e)},e.prototype.tint=function(t,e){var n=[(t>>16&255)/255,0,0,0,0,0,(t>>8&255)/255,0,0,0,0,0,(255&t)/255,0,0,0,0,0,1,0];this._loadMatrix(n,e)},e.prototype.greyscale=function(t,e){var n=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(n,e)},e.prototype.blackAndWhite=function(t){this._loadMatrix([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],t)},e.prototype.hue=function(t,e){t=(t||0)/180*Math.PI;var n=Math.cos(t),i=Math.sin(t),r=1/3,o=(0,Math.sqrt)(r),s=[n+(1-n)*r,r*(1-n)-o*i,r*(1-n)+o*i,0,0,r*(1-n)+o*i,n+r*(1-n),r*(1-n)-o*i,0,0,r*(1-n)-o*i,r*(1-n)+o*i,n+r*(1-n),0,0,0,0,0,1,0];this._loadMatrix(s,e)},e.prototype.contrast=function(t,e){var n=(t||0)+1,i=-.5*(n-1),r=[n,0,0,0,i,0,n,0,0,i,0,0,n,0,i,0,0,0,1,0];this._loadMatrix(r,e)},e.prototype.saturate=function(t,e){void 0===t&&(t=0);var n=2*t/3+1,i=-.5*(n-1),r=[n,i,i,0,0,i,n,i,0,0,i,i,n,0,0,0,0,0,1,0];this._loadMatrix(r,e)},e.prototype.desaturate=function(){this.saturate(-1)},e.prototype.negative=function(t){this._loadMatrix([-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0],t)},e.prototype.sepia=function(t){this._loadMatrix([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],t)},e.prototype.technicolor=function(t){this._loadMatrix([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],t)},e.prototype.polaroid=function(t){this._loadMatrix([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],t)},e.prototype.toBGR=function(t){this._loadMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],t)},e.prototype.kodachrome=function(t){this._loadMatrix([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],t)},e.prototype.browni=function(t){this._loadMatrix([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],t)},e.prototype.vintage=function(t){this._loadMatrix([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],t)},e.prototype.colorTone=function(t,e,n,i,r){var o=((n=n||16770432)>>16&255)/255,s=(n>>8&255)/255,a=(255&n)/255,l=((i=i||3375104)>>16&255)/255,u=(i>>8&255)/255,h=(255&i)/255,c=[.3,.59,.11,0,0,o,s,a,t=t||.2,0,l,u,h,e=e||.15,0,o-l,s-u,a-h,0,0];this._loadMatrix(c,r)},e.prototype.night=function(t,e){var n=[-2*(t=t||.1),-t,0,0,0,-t,0,t,0,0,0,t,2*t,0,0,0,0,0,1,0];this._loadMatrix(n,e)},e.prototype.predator=function(t,e){var n=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(n,e)},e.prototype.lsd=function(t){this._loadMatrix([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],t)},e.prototype.reset=function(){this._loadMatrix([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],!1)},Object.defineProperty(e.prototype,"matrix",{get:function(){return this.uniforms.m},set:function(t){this.uniforms.m=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this.uniforms.uAlpha},set:function(t){this.uniforms.uAlpha=t},enumerable:!1,configurable:!0}),e}(Ro);function nl(t){if(!this._activeParentLayer||this._activeParentLayer===t._activeLayer){if(!this.visible)return void(this.displayOrder=0);this.displayOrder=t.incDisplayOrder(),!(this.worldAlpha<=0)&&this.renderable&&(t._activeLayer=null,this.containerRenderWebGL(t),t._activeLayer=this._activeParentLayer)}}el.prototype.grayscale=el.prototype.greyscale;class il{constructor(){this._tempPoint=new Ti,this._queue=[[],[]],this._eventDisplayOrder=0,this.worksWithLayers=!0}recursiveFindHit(t,e,n,i,r){if(!e||!e.visible)return 0;let o=0,s=i=e.interactive||i;e.hitArea&&(s=!1),e._activeParentLayer&&(r=!1);const a=e._mask;n<1/0&&a&&a.containsPoint&&!a.containsPoint(t)&&(r=!0),n<1/0&&e.filterArea&&(e.filterArea.contains(t.x,t.y)||(r=!0));const l=e.children;if(e.interactiveChildren&&l)for(let e=l.length-1;e>=0;e--){const i=l[e],a=this.recursiveFindHit(t,i,n,s,r);if(a){if(!i.parent)continue;o=a,n=a}}return i&&(r?e.interactive&&this._queueAdd(e,0):(n<e.displayOrder&&(e.hitArea?(e.worldTransform.applyInverse(t,this._tempPoint),e.hitArea.contains(this._tempPoint.x,this._tempPoint.y)&&(o=e.displayOrder)):e.containsPoint&&e.containsPoint(t)&&(o=e.displayOrder)),e.interactive&&this._queueAdd(e,o===1/0?0:o))),o}findHit(t,e,n,i){const r=t.data.global;this._startInteractionProcess(),this.recursiveFindHit(r,e,i?0:1/0,!1,!1),this._finishInteractionProcess(t,n)}_startInteractionProcess(){this._eventDisplayOrder=1,this._queue||(this._queue=[[],[]]),this._queue[0].length=0,this._queue[1].length=0}_queueAdd(t,e){const n=this._queue;if(e<this._eventDisplayOrder)n[0].push(t);else{if(e>this._eventDisplayOrder){this._eventDisplayOrder=e;const t=n[1];for(let e=0,i=t.length;e<i;e++)n[0].push(t[e]);n[1].length=0}n[1].push(t)}}_finishInteractionProcess(t,e){const n=this._queue;let i=n[0];for(let n=0,r=i.length;n<r;n++)e&&e(t,i[n],!1);i=n[1];for(let n=0,r=i.length;n<r;n++)t.target||(t.target=i[n]),e&&e(t,i[n],!0)}}function rl(t){const e=t.prototype;e._oldRender||(Object.assign(e,{_lastDisplayOrder:0,_activeLayer:null,incDisplayOrder(){return++this._lastDisplayOrder},_oldRender:ls.prototype.render}),e._oldRender=e.render,e.render=function(t){return function(e,n,i,r,o){(!n||!n.renderTexture&&!n.baseTexture)&&(this._lastDisplayOrder=0),this._activeLayer=null,e.isStage&&e.updateStage(),this.plugins.interaction&&!this.plugins.interaction.search.worksWithLayers&&(this.plugins.interaction.search=new il),t.call(this,e,n,i,r,o)}}(e.render))}class ol extends Ee{constructor(t=0,e=!1){super(),this.useRenderTexture=!1,this.useDoubleBuffer=!1,this.sortPriority=0,this.clearColor=new Float32Array([0,0,0,0]),this.canDrawWithoutLayer=!1,this.canDrawInParentStage=!0,this._activeLayer=null,this._activeStage=null,this._activeChildren=[],this._lastUpdateId=-1,this.zIndex=t||0,this.enableSort=!!e,"function"==typeof e&&this.on("sort",e)}doSort(t,e){if(this.listeners("sort",!0))for(let t=0;t<e.length;t++)this.emit("sort",e[t]);e.sort(ol.compareZIndex)}static compareZIndex(t,e){return t.zOrder<e.zOrder?-1:t.zOrder>e.zOrder?1:t.updateOrder-e.updateOrder}clear(){this._activeLayer=null,this._activeStage=null,this._activeChildren.length=0}_resolveChildDisplayObject(t,e){this.check(t),e._activeParentLayer=this._activeLayer,this._activeLayer?this._activeLayer._activeChildren.push(e):this._activeChildren.push(e)}_resolveLayer(t,e){this.check(t),this._activeLayer&&ol.conflict(),this._activeLayer=e,this._activeStage=t}check(t){if(this._lastUpdateId<ol._layerUpdateId)this._lastUpdateId=ol._layerUpdateId,this.clear(),this._activeStage=t;else if(this.canDrawInParentStage){let e=this._activeStage;for(;e&&e!==t;)e=e._activeParentStage;this._activeStage=e,null===e&&this.clear()}}static conflict(){ol._lastLayerConflict+5e3<Date.now()&&(ol._lastLayerConflict=Date.now(),console.log("@pixi/layers found two layers with the same group in one stage - that's not healthy. Please place a breakpoint here and debug it"))}}ol._layerUpdateId=0,ol._lastLayerConflict=0;class sl{constructor(t){this.layer=t,this.renderTexture=null,this.doubleBuffer=null,this.currentBufferIndex=0,this._tempRenderTarget=null,this._tempRenderTargetSource=new xi,this._tempRenderTargetDestination=new xi}init(t){const e=t?t.screen.width:100,n=t?t.screen.height:100,i=t?t.resolution:xe.RESOLUTION;this.renderTexture=kr.create({width:e,height:n,resolution:i}),this.layer.group.useDoubleBuffer&&(this.doubleBuffer=[kr.create({width:e,height:n,resolution:i}),kr.create({width:e,height:n,resolution:i})])}getRenderTexture(){return this.renderTexture||this.init(),this.renderTexture}pushTexture(t){const e=t.screen;this.renderTexture||this.init(t);const n=this.renderTexture,i=this.layer.group,r=this.doubleBuffer;if((n.width!==e.width||n.height!==e.height||n.baseTexture.resolution!==t.resolution)&&(n.baseTexture.resolution=t.resolution,n.resize(e.width,e.height),r&&(r[0].baseTexture.resolution=t.resolution,r[0].resize(e.width,e.height),r[1].baseTexture.resolution=t.resolution,r[1].resize(e.width,e.height))),r&&(r[0].framebuffer.multisample=n.framebuffer.multisample,r[1].framebuffer.multisample=n.framebuffer.multisample),this._tempRenderTarget=t.renderTexture.current,this._tempRenderTargetSource.copyFrom(t.renderTexture.sourceFrame),this._tempRenderTargetDestination.copyFrom(t.renderTexture.destinationFrame),t.batch.flush(),i.useDoubleBuffer){let e=r[this.currentBufferIndex];e.baseTexture._glTextures[t.CONTEXT_UID]||(t.renderTexture.bind(e,void 0,void 0),t.texture.bind(e),i.clearColor&&t.renderTexture.clear(i.clearColor)),t.texture.unbind(n.baseTexture),n.baseTexture._glTextures=e.baseTexture._glTextures,n.baseTexture.framebuffer=e.baseTexture.framebuffer,e=r[1-this.currentBufferIndex],t.renderTexture.bind(e,void 0,void 0)}else t.renderTexture.bind(n,void 0,void 0);i.clearColor&&t.renderTexture.clear(i.clearColor);const o=t.filter.defaultFilterStack;o.length>1&&(o[o.length-1].renderTexture=t.renderTexture.current)}popTexture(t){t.batch.flush(),t.framebuffer.blit();const e=t.filter.defaultFilterStack;e.length>1&&(e[e.length-1].renderTexture=this._tempRenderTarget),t.renderTexture.bind(this._tempRenderTarget,this._tempRenderTargetSource,this._tempRenderTargetDestination),this._tempRenderTarget=null;const n=this.renderTexture,i=this.layer.group,r=this.doubleBuffer;if(i.useDoubleBuffer){t.texture.unbind(n.baseTexture),this.currentBufferIndex=1-this.currentBufferIndex;const e=r[this.currentBufferIndex];n.baseTexture._glTextures=e.baseTexture._glTextures,n.baseTexture.framebuffer=e.baseTexture.framebuffer}}destroy(){this.renderTexture&&(this.renderTexture.destroy(),this.doubleBuffer&&(this.doubleBuffer[0].destroy(!0),this.doubleBuffer[1].destroy(!0)))}}class al extends lr{constructor(t=null){super(),this.isLayer=!0,this.group=null,this._activeChildren=[],this._tempChildren=null,this._activeStageParent=null,this._sortedChildren=[],this._tempLayerParent=null,this.insertChildrenBeforeActive=!0,this.insertChildrenAfterActive=!0,t?(this.group=t,this.zIndex=t.zIndex):this.group=new ol(0,!1),this._tempChildren=this.children}get useRenderTexture(){return this.group.useRenderTexture}set useRenderTexture(t){this.group.useRenderTexture=t}get useDoubleBuffer(){return this.group.useDoubleBuffer}set useDoubleBuffer(t){this.group.useDoubleBuffer=t}get clearColor(){return this.group.clearColor}set clearColor(t){this.group.clearColor=t}get sortPriority(){return this.group.sortPriority}set sortPriority(t){this.group.sortPriority=t}getRenderTexture(){return this.textureCache||(this.textureCache=new sl(this)),this.textureCache.getRenderTexture()}doSort(){this.group.doSort(this,this._sortedChildren)}destroy(t){this.textureCache&&(this.textureCache.destroy(),this.textureCache=null),super.destroy(t)}render(t){!this.prerender(t)||(this.group.useRenderTexture&&(this.textureCache||(this.textureCache=new sl(this)),this.textureCache.pushTexture(t)),this.containerRenderWebGL(t),this.postrender(t),this.group.useRenderTexture&&this.textureCache.popTexture(t))}layerRenderCanvas(t){this.prerender(t)&&(this.containerRenderCanvas(t),this.postrender(t))}_onBeginLayerSubtreeTraversal(t){const e=this._activeChildren;this._activeStageParent=t,this.group._resolveLayer(t,this);const n=this.group._activeChildren;e.length=0;for(let t=0;t<n.length;t++)n[t]._activeParentLayer=this,e.push(n[t]);n.length=0}_onEndLayerSubtreeTraversal(){const t=this.children,e=this._activeChildren,n=this._sortedChildren;for(let t=0;t<e.length;t++)this.emit("display",e[t]);if(n.length=0,this.insertChildrenBeforeActive)for(let e=0;e<t.length;e++)n.push(t[e]);for(let t=0;t<e.length;t++)n.push(e[t]);if(!this.insertChildrenBeforeActive&&this.insertChildrenAfterActive)for(let e=0;e<t.length;e++)n.push(t[e]);this.group.enableSort&&this.doSort()}prerender(t){return!(this._activeParentLayer&&this._activeParentLayer!=t._activeLayer||(this.visible?(this.displayOrder=t.incDisplayOrder(),this.worldAlpha<=0||!this.renderable||(this.children!==this._sortedChildren&&this._tempChildren!==this.children&&(this._tempChildren=this.children),this._boundsID++,this.children=this._sortedChildren,this._tempLayerParent=t._activeLayer,t._activeLayer=this,0)):(this.displayOrder=0,1)))}postrender(t){this.children=this._tempChildren,t._activeLayer=this._tempLayerParent,this._tempLayerParent=null}}al.prototype.renderCanvas=al.prototype.layerRenderCanvas;class ll extends al{constructor(){super(...arguments),this.isStage=!0,this._tempGroups=[],this._activeLayers=[],this._activeParentStage=null}clear(){this._activeLayers.length=0,this._tempGroups.length=0}destroy(t){this.clear(),super.destroy(t)}updateStage(){this._activeParentStage=null,ol._layerUpdateId++,this._updateStageInner()}updateAsChildStage(t){this._activeParentStage=t,ll._updateOrderCounter=0,this._updateStageInner()}_updateStageInner(){this.clear(),this._addRecursive(this);const t=this._activeLayers;for(let e=0;e<t.length;e++){const n=t[e];if(n.group.sortPriority){n._onEndLayerSubtreeTraversal();const t=n._sortedChildren;for(let e=0;e<t.length;e++)this._addRecursiveChildren(t[e])}}for(let e=0;e<t.length;e++){const n=t[e];n.group.sortPriority||n._onEndLayerSubtreeTraversal()}}_addRecursive(t){if(!t.visible)return;if(t.isLayer){const e=t;this._activeLayers.push(e),e._onBeginLayerSubtreeTraversal(this)}if(t!==this&&t.isStage)return void t.updateAsChildStage(this);t._activeParentLayer=null;let e=t.parentGroup;e&&e._resolveChildDisplayObject(this,t);const n=t.parentLayer;if(n&&(e=n.group,e._resolveChildDisplayObject(this,t)),t.updateOrder=++ll._updateOrderCounter,t.alpha<=0||!t.renderable||!t.layerableChildren||e&&e.sortPriority)return;const i=t.children;if(i&&i.length)for(let t=0;t<i.length;t++)this._addRecursive(i[t])}_addRecursiveChildren(t){if(t.alpha<=0||!t.renderable||!t.layerableChildren)return;const e=t.children;if(e&&e.length)for(let t=0;t<e.length;t++)this._addRecursive(e[t])}}ll._updateOrderCounter=0,function(){if(void 0!==or.prototype.displayOrder)return;Object.assign(or.prototype,{parentLayer:null,_activeParentLayer:null,parentGroup:null,zOrder:0,zIndex:0,updateOrder:0,displayOrder:0,layerableChildren:!0,isLayer:!1});const t=lr.prototype;t.containerRenderWebGL=t.render,t.render=nl}(),rl(ls);var ul,hl,cl={},pl={},dl={};function fl(){if(ul)return dl;ul=1;var t=T&&T.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(r,o){function s(t){try{l(i.next(t))}catch(t){o(t)}}function a(t){try{l(i.throw(t))}catch(t){o(t)}}function l(t){t.done?r(t.value):function(t){return t instanceof n?t:new n((function(e){e(t)}))}(t.value).then(s,a)}l((i=i.apply(t,e||[])).next())}))};Object.defineProperty(dl,"__esModule",{value:!0}),dl.SpaceApiError=dl.callSpaceAPIWithConfig=dl.getRequestHeaders=void 0;const e=ml();function n(t){var e;const n=new Headers;switch(t.type){case"secret":n.set("authorization",`AL-Secret-Token ${t.secretAccessToken}`);break;case"temporary":n.set("authorization",`${null===(e=t.temporaryAccessToken)||void 0===e?void 0:e.authorization}`)}return t.sdkVersion&&n.set("x-sdk-version",t.sdkVersion),n}function i(t){return t.status>=200&&t.status<400?t:t.json().then((e=>{const n=e?.message||e?.error||e;switch(typeof n){case"string":return Promise.reject(new r(n,t.status,void 0));case"object":return Promise.reject(new r(n.message,t.status,n.data));default:return Promise.reject(new r(null,null,e))}}))}dl.getRequestHeaders=n,dl.callSpaceAPIWithConfig=function(o,s,a={},l){return t(this,void 0,void 0,(function*(){const t=new URL(e.spaceApiUrl+s),u=n(l);let h=!1;switch("publishable"===l.type&&t.searchParams.set("pubtoken",l.publishableAccessToken),o){case"GET":a&&"object"==typeof a&&Object.entries(a).forEach((([e,n])=>{typeof n<"u"&&t.searchParams.set(e,n.toString())}));break;case"POST":case"PUT":u.set("content-type","application/json"),h=!0;break;case"DELETE":break;default:return Promise.reject(new r("Programming error, unsupported method: "+o,void 0,void 0))}return fetch(t.toString(),{method:o,headers:u,body:h?JSON.stringify(a):void 0}).then(i,(t=>{throw t})).then((t=>t.json())).catch((t=>Promise.reject(t)))}))};class r extends Error{constructor(t,e,n){super(t||"There was a problem. Please check your internet connection and try again."),this.name="SpaceApiError",this.stack=(new Error).stack,this.code=e,this.data=n}}return dl.SpaceApiError=r,dl}function ml(){if(hl)return pl;hl=1,Object.defineProperty(pl,"__esModule",{value:!0}),pl.getTokenConfig=pl.setSpaceApiUrl=pl.spaceApiUrl=void 0;const t=fl();return pl.spaceApiUrl="https://api.archilogic.com",pl.setSpaceApiUrl=t=>{pl.spaceApiUrl=t},pl.getTokenConfig=function(e){let n;if(e.secretAccessToken)n={type:"secret",secretAccessToken:e.secretAccessToken};else if(e.temporaryAccessToken||e.temporaryAccessTokenFunction)n={type:"temporary",temporaryAccessToken:e.temporaryAccessToken};else{if(!e.publishableAccessToken)throw new t.SpaceApiError("Programming error: token is not provided.",void 0,void 0);n={type:"publishable",publishableAccessToken:e.publishableAccessToken}}return e.sdkVersion&&(n.sdkVersion=e.sdkVersion),n},pl}var yl={},gl=T&&T.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(r,o){function s(t){try{l(i.next(t))}catch(t){o(t)}}function a(t){try{l(i.throw(t))}catch(t){o(t)}}function l(t){t.done?r(t.value):function(t){return t instanceof n?t:new n((function(e){e(t)}))}(t.value).then(s,a)}l((i=i.apply(t,e||[])).next())}))};Object.defineProperty(yl,"__esModule",{value:!0}),yl.Connection=void 0;const vl=ml(),_l=fl();yl.Connection=class{constructor(t){this.tempScopes=[{resource:"floor",action:"readPublic"},{resource:"floor",action:"readPrivate"},{resource:"floor",action:"queryPublic"},{resource:"floor",action:"queryPrivate"},{resource:"floor",action:"archive"},{resource:"customFields",action:"readPublic"},{resource:"customFields",action:"readPrivate"},{resource:"customFields",action:"write"}],this.durationSeconds=3600,this.getTemporaryAccessToken=()=>gl(this,void 0,void 0,(function*(){this.temporaryAccessTokenPromise||(this.temporaryAccessTokenPromise=new Promise(((t,e)=>gl(this,void 0,void 0,(function*(){var n;let i=this.initialTemporaryAccessToken;if(i&&i.expiresAt>(new Date).getTime()/1e3?t(i):this.initialTemporaryAccessToken=void 0,this.temporaryAccessTokenFunction&&(i=yield null===(n=this.temporaryAccessTokenFunction)||void 0===n?void 0:n.call(this,{scopes:this.tempScopes,durationSeconds:this.durationSeconds}),i&&i.expiresAt>(new Date).getTime()/1e3&&t(i)),i){const t=new Date;t.setTime(1e3*i.expiresAt),e(new _l.SpaceApiError(`Temporary access token expired at ${t.toString()}`,void 0,void 0))}else e(new _l.SpaceApiError("Temporary access token not defined",void 0,void 0))})))));try{return yield this.temporaryAccessTokenPromise}catch(t){throw this.temporaryAccessTokenPromise=void 0,t}})),this.config=vl.getTokenConfig(t),(t.temporaryAccessToken||t.temporaryAccessTokenFunction)&&(this.temporaryAccessTokenFunction=t.temporaryAccessTokenFunction,this.initialTemporaryAccessToken=t.temporaryAccessToken),t.temporaryAccessTokenScopes&&(this.tempScopes=t.temporaryAccessTokenScopes)}callSpaceAPI(t,e,n={},i=this.config){return gl(this,void 0,void 0,(function*(){switch(i.type){case"secret":case"publishable":return _l.callSpaceAPIWithConfig(t,e,n,i);case"temporary":const r=yield this.getTemporaryAccessToken(),o=Object.assign(Object.assign({},i),{temporaryAccessToken:r});return _l.callSpaceAPIWithConfig(t,e,n,o)}}))}};var xl={};Object.defineProperty(xl,"__esModule",{value:!0}),xl.SpaceAPI=void 0;const bl=yl;xl.SpaceAPI=class{constructor(t,e={}){this.connection=new bl.Connection(t);for(const[t,n]of Object.entries(e))this[t]=n}getFloorById(t,e=!1){return this.connection.callSpaceAPI("GET",`/v2/floor/${t}/${e?"geo-json":""}`)}queryFloors(t){return this.connection.callSpaceAPI("GET","/v2/floor",t)}getFloorplanImage(t,e){return this.connection.callSpaceAPI("POST",`/v2/floor/${t}/2d-image`,e)}getSceneStructure(t,e=!1){return this.connection.callSpaceAPI("GET",`/v2/floor/${t}/scene-structure`,{includeMetadata:e})}getSpaceById(t,e=!1){return this.connection.callSpaceAPI("GET",`/v2/space/${t}/${e?"geo-json":""}`)}querySpaces(t){return this.connection.callSpaceAPI("GET","/v2/space",t)}getAllSpacesByFloorId(t,e=!1){return this.querySpaces({floorId:t,geometry:e})}getAssetById(t,e=!1){return this.connection.callSpaceAPI("GET",`/v2/asset/${t}/${e?"geo-json":""}`)}queryAssets(t){return this.connection.callSpaceAPI("GET","/v2/asset",t)}getAllAssetsByFloorId(t,e=!1){return this.queryAssets({floorId:t,geometry:e})}getAllAssetsBySpaceId(t,e=!1){return this.queryAssets({spaceId:t,geometry:e})}getCustomField(t,e,n){return this.connection.callSpaceAPI("GET",`/v2/${t}/${e}/custom-field/${n}`)}getAllCustomFields(t,e){return this.connection.callSpaceAPI("GET",`/v2/${t}/${e}/custom-field`)}setCustomField(t,e,n,i){return this.connection.callSpaceAPI("PUT",`/v2/${t}/${e}/custom-field/${n}`,i)}deleteCustomField(t,e,n){return this.connection.callSpaceAPI("DELETE",`/v2/${t}/${e}/custom-field/${n}`)}},function(t){var e=T&&T.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]}),n=T&&T.__exportStar||function(t,n){for(var i in t)"default"!==i&&!Object.prototype.hasOwnProperty.call(n,i)&&e(n,t,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(ml(),t),n(fl(),t),n(yl,t),n(xl,t)}(cl);var wl={version:"6.4.2.2",use_lines:!0,use_xyz:!1},Pl=function(t,e){var n;if(typeof Object.getOwnPropertyNames>"u"){for(n in e.prototype)(typeof t.prototype[n]>"u"||t.prototype[n]===Object.prototype[n])&&(t.prototype[n]=e.prototype[n]);for(n in e)typeof t[n]>"u"&&(t[n]=e[n]);t.$baseCtor=e}else{for(var i=Object.getOwnPropertyNames(e.prototype),r=0;r<i.length;r++)typeof Object.getOwnPropertyDescriptor(t.prototype,i[r])>"u"&&Object.defineProperty(t.prototype,i[r],Object.getOwnPropertyDescriptor(e.prototype,i[r]));for(n in e)typeof t[n]>"u"&&(t[n]=e[n]);t.$baseCtor=e}};wl.Path=function(){return[]},wl.Path.prototype.push=Array.prototype.push,wl.Paths=function(){return[]},wl.Paths.prototype.push=Array.prototype.push,wl.PolyNode=function(){this.m_Parent=null,this.m_polygon=new wl.Path,this.m_Index=0,this.m_jointype=0,this.m_endtype=0,this.m_Childs=[],this.IsOpen=!1},wl.PolyNode.prototype.IsHoleNode=function(){for(var t=!0,e=this.m_Parent;null!==e;)t=!t,e=e.m_Parent;return t},wl.PolyNode.prototype.ChildCount=function(){return this.m_Childs.length},wl.PolyNode.prototype.Contour=function(){return this.m_polygon},wl.PolyNode.prototype.AddChild=function(t){var e=this.m_Childs.length;this.m_Childs.push(t),t.m_Parent=this,t.m_Index=e},wl.PolyNode.prototype.GetNext=function(){return this.m_Childs.length>0?this.m_Childs[0]:this.GetNextSiblingUp()},wl.PolyNode.prototype.GetNextSiblingUp=function(){return null===this.m_Parent?null:this.m_Index===this.m_Parent.m_Childs.length-1?this.m_Parent.GetNextSiblingUp():this.m_Parent.m_Childs[this.m_Index+1]},wl.PolyNode.prototype.Childs=function(){return this.m_Childs},wl.PolyNode.prototype.Parent=function(){return this.m_Parent},wl.PolyNode.prototype.IsHole=function(){return this.IsHoleNode()},wl.PolyTree=function(){this.m_AllPolys=[],wl.PolyNode.call(this)},wl.PolyTree.prototype.Clear=function(){for(var t=0,e=this.m_AllPolys.length;t<e;t++)this.m_AllPolys[t]=null;this.m_AllPolys.length=0,this.m_Childs.length=0},wl.PolyTree.prototype.GetFirst=function(){return this.m_Childs.length>0?this.m_Childs[0]:null},wl.PolyTree.prototype.Total=function(){var t=this.m_AllPolys.length;return t>0&&this.m_Childs[0]!==this.m_AllPolys[0]&&t--,t},Pl(wl.PolyTree,wl.PolyNode),wl.Clear=function(t){t.length=0},wl.PI=3.141592653589793,wl.PI2=6.283185307179586,wl.FPoint=function(){var t=arguments,e=t.length;if(this.X=0,this.Y=0,wl.use_xyz)if(this.Z=0,3===e)this.X=t[0],this.Y=t[1],this.Z=t[2];else if(2===e)this.X=t[0],this.Y=t[1],this.Z=0;else if(1===e)if(t[0]instanceof wl.FPoint){var n=t[0];this.X=n.X,this.Y=n.Y,this.Z=0}else typeof(i=t[0]).Z>"u"&&(i.Z=0),this.X=i.X,this.Y=i.Y,this.Z=i.Z;else this.X=0,this.Y=0,this.Z=0;else if(2===e)this.X=t[0],this.Y=t[1];else if(1===e)if(t[0]instanceof wl.FPoint)n=t[0],this.X=n.X,this.Y=n.Y;else{var i=t[0];this.X=i.X,this.Y=i.Y}else this.X=0,this.Y=0},wl.FPoint.op_Equality=function(t,e){return t.X===e.X&&t.Y===e.Y},wl.FPoint.op_Inequality=function(t,e){return t.X!==e.X||t.Y!==e.Y},wl.FPoint0=function(){this.X=0,this.Y=0,wl.use_xyz&&(this.Z=0)},wl.FPoint0.prototype=wl.FPoint.prototype,wl.FPoint1=function(t){this.X=t.X,this.Y=t.Y,wl.use_xyz&&(typeof t.Z>"u"?this.Z=0:this.Z=t.Z)},wl.FPoint1.prototype=wl.FPoint.prototype,wl.FPoint1dp=function(t){this.X=t.X,this.Y=t.Y,wl.use_xyz&&(this.Z=0)},wl.FPoint1dp.prototype=wl.FPoint.prototype,wl.FPoint2=function(t,e,n){this.X=t,this.Y=e,wl.use_xyz&&(this.Z=typeof n>"u"?0:n)},wl.FPoint2.prototype=wl.FPoint.prototype,wl.FRect=function(){var t=arguments,e=t.length;if(4===e)this.left=t[0],this.top=t[1],this.right=t[2],this.bottom=t[3];else if(1===e){var n=t[0];this.left=n.left,this.top=n.top,this.right=n.right,this.bottom=n.bottom}else this.left=0,this.top=0,this.right=0,this.bottom=0},wl.FRect0=function(){this.left=0,this.top=0,this.right=0,this.bottom=0},wl.FRect0.prototype=wl.FRect.prototype,wl.FRect1=function(t){this.left=t.left,this.top=t.top,this.right=t.right,this.bottom=t.bottom},wl.FRect1.prototype=wl.FRect.prototype,wl.FRect4=function(t,e,n,i){this.left=t,this.top=e,this.right=n,this.bottom=i},wl.FRect4.prototype=wl.FRect.prototype,wl.ClipType={ctIntersection:0,ctUnion:1,ctDifference:2,ctXor:3},wl.PolyType={ptSubject:0,ptClip:1},wl.PolyFillType={pftEvenOdd:0,pftNonZero:1,pftPositive:2,pftNegative:3},wl.JoinType={jtSquare:0,jtRound:1,jtMiter:2},wl.EndType={etOpenSquare:0,etOpenRound:1,etOpenButt:2,etClosedLine:3,etClosedPolygon:4},wl.EdgeSide={esLeft:0,esRight:1},wl.Direction={dRightToLeft:0,dLeftToRight:1},wl.TEdge=function(){this.Bot=new wl.FPoint0,this.Curr=new wl.FPoint0,this.Top=new wl.FPoint0,this.Delta=new wl.FPoint0,this.Dx=0,this.PolyTyp=wl.PolyType.ptSubject,this.Side=wl.EdgeSide.esLeft,this.WindDelta=0,this.WindCnt=0,this.WindCnt2=0,this.OutIdx=0,this.Next=null,this.Prev=null,this.NextInLML=null,this.NextInAEL=null,this.PrevInAEL=null,this.NextInSEL=null,this.PrevInSEL=null},wl.IntersectNode=function(){this.Edge1=null,this.Edge2=null,this.Pt=new wl.FPoint0},wl.MyIntersectNodeSort=function(){},wl.MyIntersectNodeSort.Compare=function(t,e){var n=e.Pt.Y-t.Pt.Y;return n>0?1:n<0?-1:0},wl.LocalMinima=function(){this.Y=0,this.LeftBound=null,this.RightBound=null,this.Next=null},wl.Scanbeam=function(){this.Y=0,this.Next=null},wl.Maxima=function(){this.X=0,this.Next=null,this.Prev=null},wl.OutRec=function(){this.Idx=0,this.IsHole=!1,this.IsOpen=!1,this.FirstLeft=null,this.Pts=null,this.BottomPt=null,this.PolyNode=null},wl.OutPt=function(){this.Idx=0,this.Pt=new wl.FPoint0,this.Next=null,this.Prev=null},wl.Join=function(){this.OutPt1=null,this.OutPt2=null,this.OffPt=new wl.FPoint0},wl.ClipperBase=function(){this.m_MinimaList=null,this.m_CurrentLM=null,this.m_edges=new Array,this.m_HasOpenPaths=!1,this.PreserveCollinear=!1,this.m_Scanbeam=null,this.m_PolyOuts=null,this.m_ActiveEdges=null},wl.ClipperBase.horizontal=-34e37,wl.ClipperBase.Skip=-2,wl.ClipperBase.Unassigned=-1,wl.ClipperBase.tolerance=1e-20,wl.ClipperBase.maxValue=Math.sqrt(Number.MAX_VALUE),wl.ClipperBase.minValue=Math.sqrt(Number.MIN_VALUE),wl.ClipperBase.near_zero=function(t){return t>-wl.ClipperBase.tolerance&&t<wl.ClipperBase.tolerance},wl.ClipperBase.IsHorizontal=function(t){return 0===t.Delta.Y},wl.ClipperBase.prototype.PointIsVertex=function(t,e){var n=e;do{if(wl.FPoint.op_Equality(n.Pt,t))return!0;n=n.Next}while(n!==e);return!1},wl.ClipperBase.prototype.PointOnLineSegment=function(t,e,n){return t.X===e.X&&t.Y===e.Y||t.X===n.X&&t.Y===n.Y||t.X>e.X==t.X<n.X&&t.Y>e.Y==t.Y<n.Y&&(t.X-e.X)*(n.Y-e.Y)==(n.X-e.X)*(t.Y-e.Y)},wl.ClipperBase.prototype.PointOnPolygon=function(t,e){for(var n=e;;){if(this.PointOnLineSegment(t,n.Pt,n.Next.Pt))return!0;if((n=n.Next)===e)break}return!1},wl.ClipperBase.prototype.SlopesEqual=wl.ClipperBase.SlopesEqual=function(){var t,e,n,i,r,o,s=arguments,a=s.length;return 2===a?(e=s[1],(t=s[0]).Delta.Y*e.Delta.X==t.Delta.X*e.Delta.Y):3===a?(i=s[1],r=s[2],((n=s[0]).Y-i.Y)*(i.X-r.X)-(n.X-i.X)*(i.Y-r.Y)==0):(i=s[1],r=s[2],o=s[3],((n=s[0]).Y-i.Y)*(r.X-o.X)-(n.X-i.X)*(r.Y-o.Y)==0)},wl.ClipperBase.SlopesEqual3=function(t,e){return t.Delta.Y*e.Delta.X==t.Delta.X*e.Delta.Y},wl.ClipperBase.SlopesEqual4=function(t,e,n){return(t.Y-e.Y)*(e.X-n.X)-(t.X-e.X)*(e.Y-n.Y)==0},wl.ClipperBase.SlopesEqual5=function(t,e,n,i){return(t.Y-e.Y)*(n.X-i.X)-(t.X-e.X)*(n.Y-i.Y)==0},wl.ClipperBase.prototype.Clear=function(){this.DisposeLocalMinimaList();for(var t=0,e=this.m_edges.length;t<e;++t){for(var n=0,i=this.m_edges[t].length;n<i;++n)this.m_edges[t][n]=null;wl.Clear(this.m_edges[t])}wl.Clear(this.m_edges),this.m_HasOpenPaths=!1},wl.ClipperBase.prototype.DisposeLocalMinimaList=function(){for(var t=this;null!==this.m_MinimaList;){var e=t.m_MinimaList.Next;t.m_MinimaList=null,t.m_MinimaList=e}this.m_CurrentLM=null},wl.ClipperBase.prototype.RangeTest=function(t){(t.X>wl.ClipperBase.maxValue||t.X<-wl.ClipperBase.maxValue||t.Y>wl.ClipperBase.maxValue||t.Y<-wl.ClipperBase.maxValue||t.X>0&&t.X<wl.ClipperBase.minValue||t.Y>0&&t.Y<wl.ClipperBase.minValue||t.X<0&&t.X>-wl.ClipperBase.minValue||t.Y<0&&t.Y>-wl.ClipperBase.minValue)&&wl.Error("Coordinate outside allowed range in RangeTest().")},wl.ClipperBase.prototype.InitEdge=function(t,e,n,i){t.Next=e,t.Prev=n,t.Curr.X=i.X,t.Curr.Y=i.Y,wl.use_xyz&&(t.Curr.Z=i.Z),t.OutIdx=-1},wl.ClipperBase.prototype.InitEdge2=function(t,e){t.Curr.Y>=t.Next.Curr.Y?(t.Bot.X=t.Curr.X,t.Bot.Y=t.Curr.Y,wl.use_xyz&&(t.Bot.Z=t.Curr.Z),t.Top.X=t.Next.Curr.X,t.Top.Y=t.Next.Curr.Y,wl.use_xyz&&(t.Top.Z=t.Next.Curr.Z)):(t.Top.X=t.Curr.X,t.Top.Y=t.Curr.Y,wl.use_xyz&&(t.Top.Z=t.Curr.Z),t.Bot.X=t.Next.Curr.X,t.Bot.Y=t.Next.Curr.Y,wl.use_xyz&&(t.Bot.Z=t.Next.Curr.Z)),this.SetDx(t),t.PolyTyp=e},wl.ClipperBase.prototype.FindNextLocMin=function(t){for(var e;;){for(;wl.FPoint.op_Inequality(t.Bot,t.Prev.Bot)||wl.FPoint.op_Equality(t.Curr,t.Top);)t=t.Next;if(t.Dx!==wl.ClipperBase.horizontal&&t.Prev.Dx!==wl.ClipperBase.horizontal)break;for(;t.Prev.Dx===wl.ClipperBase.horizontal;)t=t.Prev;for(e=t;t.Dx===wl.ClipperBase.horizontal;)t=t.Next;if(t.Top.Y!==t.Prev.Bot.Y){e.Prev.Bot.X<t.Bot.X&&(t=e);break}}return t},wl.ClipperBase.prototype.ProcessBound=function(t,e){var n,i,r=t;if(r.OutIdx===wl.ClipperBase.Skip){if(t=r,e){for(;t.Top.Y===t.Next.Bot.Y;)t=t.Next;for(;t!==r&&t.Dx===wl.ClipperBase.horizontal;)t=t.Prev}else{for(;t.Top.Y===t.Prev.Bot.Y;)t=t.Prev;for(;t!==r&&t.Dx===wl.ClipperBase.horizontal;)t=t.Next}if(t===r)r=e?t.Next:t.Prev;else{t=e?r.Next:r.Prev;var o=new wl.LocalMinima;o.Next=null,o.Y=t.Bot.Y,o.LeftBound=null,o.RightBound=t,t.WindDelta=0,r=this.ProcessBound(t,e),this.InsertLocalMinima(o)}return r}if(t.Dx===wl.ClipperBase.horizontal&&((n=e?t.Prev:t.Next).Dx===wl.ClipperBase.horizontal?n.Bot.X!==t.Bot.X&&n.Top.X!==t.Bot.X&&this.ReverseHorizontal(t):n.Bot.X!==t.Bot.X&&this.ReverseHorizontal(t)),n=t,e){for(;r.Top.Y===r.Next.Bot.Y&&r.Next.OutIdx!==wl.ClipperBase.Skip;)r=r.Next;if(r.Dx===wl.ClipperBase.horizontal&&r.Next.OutIdx!==wl.ClipperBase.Skip){for(i=r;i.Prev.Dx===wl.ClipperBase.horizontal;)i=i.Prev;i.Prev.Top.X>r.Next.Top.X&&(r=i.Prev)}for(;t!==r;)t.NextInLML=t.Next,t.Dx===wl.ClipperBase.horizontal&&t!==n&&t.Bot.X!==t.Prev.Top.X&&this.ReverseHorizontal(t),t=t.Next;t.Dx===wl.ClipperBase.horizontal&&t!==n&&t.Bot.X!==t.Prev.Top.X&&this.ReverseHorizontal(t),r=r.Next}else{for(;r.Top.Y===r.Prev.Bot.Y&&r.Prev.OutIdx!==wl.ClipperBase.Skip;)r=r.Prev;if(r.Dx===wl.ClipperBase.horizontal&&r.Prev.OutIdx!==wl.ClipperBase.Skip){for(i=r;i.Next.Dx===wl.ClipperBase.horizontal;)i=i.Next;(i.Next.Top.X===r.Prev.Top.X||i.Next.Top.X>r.Prev.Top.X)&&(r=i.Next)}for(;t!==r;)t.NextInLML=t.Prev,t.Dx===wl.ClipperBase.horizontal&&t!==n&&t.Bot.X!==t.Next.Top.X&&this.ReverseHorizontal(t),t=t.Prev;t.Dx===wl.ClipperBase.horizontal&&t!==n&&t.Bot.X!==t.Next.Top.X&&this.ReverseHorizontal(t),r=r.Prev}return r},wl.ClipperBase.prototype.AddPath=function(t,e,n){var i=this;wl.use_lines?!n&&e===wl.PolyType.ptClip&&wl.Error("AddPath: Open paths must be subject."):n||wl.Error("AddPath: Open paths have been disabled.");var r=t.length-1;if(n)for(;r>0&&wl.FPoint.op_Equality(t[r],t[0]);)--r;for(;r>0&&wl.FPoint.op_Equality(t[r],t[r-1]);)--r;if(n&&r<2||!n&&r<1)return!1;for(var o=new Array,s=0;s<=r;s++)o.push(new wl.TEdge);var a=!0;for(o[1].Curr.X=t[1].X,o[1].Curr.Y=t[1].Y,wl.use_xyz&&(o[1].Curr.Z=t[1].Z),this.RangeTest(t[0]),this.RangeTest(t[r]),this.InitEdge(o[0],o[1],o[r],t[0]),this.InitEdge(o[r],o[0],o[r-1],t[r]),s=r-1;s>=1;--s)i.RangeTest(t[s]),i.InitEdge(o[s],o[s+1],o[s-1],t[s]);for(var l=o[0],u=l,h=l;;)if(u.Curr!==u.Next.Curr||!n&&u.Next===l){if(u.Prev===u.Next)break;if(!n||!wl.ClipperBase.SlopesEqual4(u.Prev.Curr,u.Curr,u.Next.Curr)||i.PreserveCollinear&&i.Pt2IsBetweenPt1AndPt3(u.Prev.Curr,u.Curr,u.Next.Curr)){if((u=u.Next)===h||!n&&u.Next===l)break}else u===l&&(l=u.Next),h=u=(u=i.RemoveEdge(u)).Prev}else{if(u===u.Next)break;u===l&&(l=u.Next),h=u=i.RemoveEdge(u)}if(!n&&u===u.Next||n&&u.Prev===u.Next)return!1;n||(this.m_HasOpenPaths=!0,l.Prev.OutIdx=wl.ClipperBase.Skip),u=l;do{i.InitEdge2(u,e),u=u.Next,a&&u.Curr.Y!==l.Curr.Y&&(a=!1)}while(u!==l);if(a){if(n)return!1;for(u.Prev.OutIdx=wl.ClipperBase.Skip,(d=new wl.LocalMinima).Next=null,d.Y=u.Bot.Y,d.LeftBound=null,d.RightBound=u,d.RightBound.Side=wl.EdgeSide.esRight,d.RightBound.WindDelta=0;u.Bot.X!==u.Prev.Top.X&&i.ReverseHorizontal(u),u.Next.OutIdx!==wl.ClipperBase.Skip;)u.NextInLML=u.Next,u=u.Next;return this.InsertLocalMinima(d),this.m_edges.push(o),!0}this.m_edges.push(o);var c,p=null;for(wl.FPoint.op_Equality(u.Prev.Bot,u.Prev.Top)&&(u=u.Next);(u=i.FindNextLocMin(u))!==p;){var d;null===p&&(p=u),(d=new wl.LocalMinima).Next=null,d.Y=u.Bot.Y,u.Dx<u.Prev.Dx?(d.LeftBound=u.Prev,d.RightBound=u,c=!1):(d.LeftBound=u,d.RightBound=u.Prev,c=!0),d.LeftBound.Side=wl.EdgeSide.esLeft,d.RightBound.Side=wl.EdgeSide.esRight,n?d.LeftBound.Next===d.RightBound?d.LeftBound.WindDelta=-1:d.LeftBound.WindDelta=1:d.LeftBound.WindDelta=0,d.RightBound.WindDelta=-d.LeftBound.WindDelta,(u=i.ProcessBound(d.LeftBound,c)).OutIdx===wl.ClipperBase.Skip&&(u=i.ProcessBound(u,c));var f=i.ProcessBound(d.RightBound,!c);f.OutIdx===wl.ClipperBase.Skip&&(f=i.ProcessBound(f,!c)),d.LeftBound.OutIdx===wl.ClipperBase.Skip?d.LeftBound=null:d.RightBound.OutIdx===wl.ClipperBase.Skip&&(d.RightBound=null),i.InsertLocalMinima(d),c||(u=f)}return!0},wl.ClipperBase.prototype.AddPaths=function(t,e,n){for(var i=!1,r=0,o=t.length;r<o;++r)this.AddPath(t[r],e,n)&&(i=!0);return i},wl.ClipperBase.prototype.Pt2IsBetweenPt1AndPt3=function(t,e,n){return!(wl.FPoint.op_Equality(t,n)||wl.FPoint.op_Equality(t,e)||wl.FPoint.op_Equality(n,e))&&(t.X!==n.X?e.X>t.X==e.X<n.X:e.Y>t.Y==e.Y<n.Y)},wl.ClipperBase.prototype.RemoveEdge=function(t){t.Prev.Next=t.Next,t.Next.Prev=t.Prev;var e=t.Next;return t.Prev=null,e},wl.ClipperBase.prototype.SetDx=function(t){t.Delta.X=t.Top.X-t.Bot.X,t.Delta.Y=t.Top.Y-t.Bot.Y,0===t.Delta.Y?t.Dx=wl.ClipperBase.horizontal:t.Dx=t.Delta.X/t.Delta.Y},wl.ClipperBase.prototype.InsertLocalMinima=function(t){if(null===this.m_MinimaList)this.m_MinimaList=t;else if(t.Y>=this.m_MinimaList.Y)t.Next=this.m_MinimaList,this.m_MinimaList=t;else{for(var e=this.m_MinimaList;null!==e.Next&&t.Y<e.Next.Y;)e=e.Next;t.Next=e.Next,e.Next=t}},wl.ClipperBase.prototype.PopLocalMinima=function(t,e){return e.v=this.m_CurrentLM,null!==this.m_CurrentLM&&this.m_CurrentLM.Y===t&&(this.m_CurrentLM=this.m_CurrentLM.Next,!0)},wl.ClipperBase.prototype.ReverseHorizontal=function(t){var e=t.Top.X;t.Top.X=t.Bot.X,t.Bot.X=e,wl.use_xyz&&(e=t.Top.Z,t.Top.Z=t.Bot.Z,t.Bot.Z=e)},wl.ClipperBase.prototype.Reset=function(){if(this.m_CurrentLM=this.m_MinimaList,null!==this.m_CurrentLM){this.m_Scanbeam=null;for(var t=this.m_MinimaList;null!==t;){this.InsertScanbeam(t.Y);var e=t.LeftBound;null!==e&&(e.Curr.X=e.Bot.X,e.Curr.Y=e.Bot.Y,wl.use_xyz&&(e.Curr.Z=e.Bot.Z),e.OutIdx=wl.ClipperBase.Unassigned),null!==(e=t.RightBound)&&(e.Curr.X=e.Bot.X,e.Curr.Y=e.Bot.Y,wl.use_xyz&&(e.Curr.Z=e.Bot.Z),e.OutIdx=wl.ClipperBase.Unassigned),t=t.Next}this.m_ActiveEdges=null}},wl.ClipperBase.prototype.InsertScanbeam=function(t){if(null===this.m_Scanbeam)this.m_Scanbeam=new wl.Scanbeam,this.m_Scanbeam.Next=null,this.m_Scanbeam.Y=t;else if(t>this.m_Scanbeam.Y){var e=new wl.Scanbeam;e.Y=t,e.Next=this.m_Scanbeam,this.m_Scanbeam=e}else{for(var n=this.m_Scanbeam;null!==n.Next&&t<=n.Next.Y;)n=n.Next;if(t===n.Y)return;var i=new wl.Scanbeam;i.Y=t,i.Next=n.Next,n.Next=i}},wl.ClipperBase.prototype.PopScanbeam=function(t){return null===this.m_Scanbeam?(t.v=0,!1):(t.v=this.m_Scanbeam.Y,this.m_Scanbeam=this.m_Scanbeam.Next,!0)},wl.ClipperBase.prototype.LocalMinimaPending=function(){return null!==this.m_CurrentLM},wl.ClipperBase.prototype.CreateOutRec=function(){var t=new wl.OutRec;return t.Idx=wl.ClipperBase.Unassigned,t.IsHole=!1,t.IsOpen=!1,t.FirstLeft=null,t.Pts=null,t.BottomPt=null,t.PolyNode=null,this.m_PolyOuts.push(t),t.Idx=this.m_PolyOuts.length-1,t},wl.ClipperBase.prototype.DisposeOutRec=function(t){var e=this.m_PolyOuts[t];e.Pts=null,e=null,this.m_PolyOuts[t]=null},wl.ClipperBase.prototype.UpdateEdgeIntoAEL=function(t){null===t.NextInLML&&wl.Error("UpdateEdgeIntoAEL: invalid call");var e=t.PrevInAEL,n=t.NextInAEL;return t.NextInLML.OutIdx=t.OutIdx,null!==e?e.NextInAEL=t.NextInLML:this.m_ActiveEdges=t.NextInLML,null!==n&&(n.PrevInAEL=t.NextInLML),t.NextInLML.Side=t.Side,t.NextInLML.WindDelta=t.WindDelta,t.NextInLML.WindCnt=t.WindCnt,t.NextInLML.WindCnt2=t.WindCnt2,(t=t.NextInLML).Curr.X=t.Bot.X,t.Curr.Y=t.Bot.Y,t.PrevInAEL=e,t.NextInAEL=n,wl.ClipperBase.IsHorizontal(t)||this.InsertScanbeam(t.Top.Y),t},wl.ClipperBase.prototype.SwapPositionsInAEL=function(t,e){if(t.NextInAEL!==t.PrevInAEL&&e.NextInAEL!==e.PrevInAEL){if(t.NextInAEL===e){var n=e.NextInAEL;null!==n&&(n.PrevInAEL=t);var i=t.PrevInAEL;null!==i&&(i.NextInAEL=e),e.PrevInAEL=i,e.NextInAEL=t,t.PrevInAEL=e,t.NextInAEL=n}else if(e.NextInAEL===t){var r=t.NextInAEL;null!==r&&(r.PrevInAEL=e);var o=e.PrevInAEL;null!==o&&(o.NextInAEL=t),t.PrevInAEL=o,t.NextInAEL=e,e.PrevInAEL=t,e.NextInAEL=r}else{var s=t.NextInAEL,a=t.PrevInAEL;t.NextInAEL=e.NextInAEL,null!==t.NextInAEL&&(t.NextInAEL.PrevInAEL=t),t.PrevInAEL=e.PrevInAEL,null!==t.PrevInAEL&&(t.PrevInAEL.NextInAEL=t),e.NextInAEL=s,null!==e.NextInAEL&&(e.NextInAEL.PrevInAEL=e),e.PrevInAEL=a,null!==e.PrevInAEL&&(e.PrevInAEL.NextInAEL=e)}null===t.PrevInAEL?this.m_ActiveEdges=t:null===e.PrevInAEL&&(this.m_ActiveEdges=e)}},wl.ClipperBase.prototype.DeleteFromAEL=function(t){var e=t.PrevInAEL,n=t.NextInAEL;null===e&&null===n&&t!==this.m_ActiveEdges||(null!==e?e.NextInAEL=n:this.m_ActiveEdges=n,null!==n&&(n.PrevInAEL=e),t.NextInAEL=null,t.PrevInAEL=null)},wl.Clipper=function(t){typeof t>"u"&&(t=0),this.m_PolyOuts=null,this.m_ClipType=wl.ClipType.ctIntersection,this.m_Scanbeam=null,this.m_Maxima=null,this.m_ActiveEdges=null,this.m_SortedEdges=null,this.m_IntersectList=null,this.m_IntersectNodeComparer=null,this.m_ExecuteLocked=!1,this.m_ClipFillType=wl.PolyFillType.pftEvenOdd,this.m_SubjFillType=wl.PolyFillType.pftEvenOdd,this.m_Joins=null,this.m_GhostJoins=null,this.m_UsingPolyTree=!1,this.ReverseSolution=!1,this.StrictlySimple=!1,wl.ClipperBase.call(this),this.m_Scanbeam=null,this.m_Maxima=null,this.m_ActiveEdges=null,this.m_SortedEdges=null,this.m_IntersectList=new Array,this.m_IntersectNodeComparer=wl.MyIntersectNodeSort.Compare,this.m_ExecuteLocked=!1,this.m_UsingPolyTree=!1,this.m_PolyOuts=new Array,this.m_Joins=new Array,this.m_GhostJoins=new Array,this.ReverseSolution=!!(1&t),this.StrictlySimple=!!(2&t),this.PreserveCollinear=!!(4&t),wl.use_xyz&&(this.ZFillFunction=null)},wl.Clipper.ioReverseSolution=1,wl.Clipper.ioStrictlySimple=2,wl.Clipper.ioPreserveCollinear=4,wl.Clipper.prototype.Clear=function(){0!==this.m_edges.length&&(this.DisposeAllPolyPts(),wl.ClipperBase.prototype.Clear.call(this))},wl.Clipper.prototype.InsertMaxima=function(t){var e=new wl.Maxima;if(e.X=t,null===this.m_Maxima)this.m_Maxima=e,this.m_Maxima.Next=null,this.m_Maxima.Prev=null;else if(t<this.m_Maxima.X)e.Next=this.m_Maxima,e.Prev=null,this.m_Maxima=e;else{for(var n=this.m_Maxima;null!==n.Next&&t>=n.Next.X;)n=n.Next;if(t===n.X)return;e.Next=n.Next,e.Prev=n,null!==n.Next&&(n.Next.Prev=e),n.Next=e}},wl.Clipper.prototype.Execute=function(){var t=arguments,e=t.length,n=t[1]instanceof wl.PolyTree;if(4===e&&!n){var i=t[0],r=t[1],o=t[2],s=t[3];if(this.m_ExecuteLocked)return!1;this.m_HasOpenPaths&&wl.Error("Error: PolyTree struct is needed for open path clipping."),this.m_ExecuteLocked=!0,wl.Clear(r),this.m_SubjFillType=o,this.m_ClipFillType=s,this.m_ClipType=i,this.m_UsingPolyTree=!1;try{(l=this.ExecuteInternal())&&this.BuildResult(r)}finally{this.DisposeAllPolyPts(),this.m_ExecuteLocked=!1}return l}if(4===e&&n){i=t[0];var a=t[1];if(o=t[2],s=t[3],this.m_ExecuteLocked)return!1;this.m_ExecuteLocked=!0,this.m_SubjFillType=o,this.m_ClipFillType=s,this.m_ClipType=i,this.m_UsingPolyTree=!0;try{var l;(l=this.ExecuteInternal())&&this.BuildResult2(a)}finally{this.DisposeAllPolyPts(),this.m_ExecuteLocked=!1}return l}return 2!==e||n?2===e&&n?(i=t[0],a=t[1],this.Execute(i,a,wl.PolyFillType.pftEvenOdd,wl.PolyFillType.pftEvenOdd)):void 0:(i=t[0],r=t[1],this.Execute(i,r,wl.PolyFillType.pftEvenOdd,wl.PolyFillType.pftEvenOdd))},wl.Clipper.prototype.FixHoleLinkage=function(t){if(null!==t.FirstLeft&&(t.IsHole===t.FirstLeft.IsHole||null===t.FirstLeft.Pts)){for(var e=t.FirstLeft;null!==e&&(e.IsHole===t.IsHole||null===e.Pts);)e=e.FirstLeft;t.FirstLeft=e}},wl.Clipper.prototype.ExecuteInternal=function(){var t=this;try{this.Reset(),this.m_SortedEdges=null,this.m_Maxima=null;var e,n,i,r={},o={};if(!this.PopScanbeam(r))return!1;for(this.InsertLocalMinimaIntoAEL(r.v);this.PopScanbeam(o)||this.LocalMinimaPending();){if(t.ProcessHorizontals(),t.m_GhostJoins.length=0,!t.ProcessIntersections(o.v))return!1;t.ProcessEdgesAtTopOfScanbeam(o.v),r.v=o.v,t.InsertLocalMinimaIntoAEL(r.v)}for(n=0,i=this.m_PolyOuts.length;n<i;n++)null!==(e=t.m_PolyOuts[n]).Pts&&!e.IsOpen&&(e.IsHole^t.ReverseSolution)==t.Area$1(e)>0&&t.ReversePolyPtLinks(e.Pts);for(this.JoinCommonEdges(),n=0,i=this.m_PolyOuts.length;n<i;n++)null!==(e=t.m_PolyOuts[n]).Pts&&(e.IsOpen?t.FixupOutPolyline(e):t.FixupOutPolygon(e));return this.StrictlySimple&&this.DoSimplePolygons(),!0}finally{this.m_Joins.length=0,this.m_GhostJoins.length=0}},wl.Clipper.prototype.DisposeAllPolyPts=function(){for(var t=0,e=this.m_PolyOuts.length;t<e;++t)this.DisposeOutRec(t);wl.Clear(this.m_PolyOuts)},wl.Clipper.prototype.AddJoin=function(t,e,n){var i=new wl.Join;i.OutPt1=t,i.OutPt2=e,i.OffPt.X=n.X,i.OffPt.Y=n.Y,wl.use_xyz&&(i.OffPt.Z=n.Z),this.m_Joins.push(i)},wl.Clipper.prototype.AddGhostJoin=function(t,e){var n=new wl.Join;n.OutPt1=t,n.OffPt.X=e.X,n.OffPt.Y=e.Y,wl.use_xyz&&(n.OffPt.Z=e.Z),this.m_GhostJoins.push(n)},wl.Clipper.prototype.SetZ=function(t,e,n){if(null!==this.ZFillFunction){if(0!==t.Z||null===this.ZFillFunction)return;wl.FPoint.op_Equality(t,e.Bot)?t.Z=e.Bot.Z:wl.FPoint.op_Equality(t,e.Top)?t.Z=e.Top.Z:wl.FPoint.op_Equality(t,n.Bot)?t.Z=n.Bot.Z:wl.FPoint.op_Equality(t,n.Top)?t.Z=n.Top.Z:this.ZFillFunction(e.Bot,e.Top,n.Bot,n.Top,t)}},wl.Clipper.prototype.InsertLocalMinimaIntoAEL=function(t){for(var e,n,i=this,r={};this.PopLocalMinima(t,r);){e=r.v.LeftBound,n=r.v.RightBound;var o=null;if(null===e?(i.InsertEdgeIntoAEL(n,null),i.SetWindingCount(n),i.IsContributing(n)&&(o=i.AddOutPt(n,n.Bot))):null===n?(i.InsertEdgeIntoAEL(e,null),i.SetWindingCount(e),i.IsContributing(e)&&(o=i.AddOutPt(e,e.Bot)),i.InsertScanbeam(e.Top.Y)):(i.InsertEdgeIntoAEL(e,null),i.InsertEdgeIntoAEL(n,e),i.SetWindingCount(e),n.WindCnt=e.WindCnt,n.WindCnt2=e.WindCnt2,i.IsContributing(e)&&(o=i.AddLocalMinPoly(e,n,e.Bot)),i.InsertScanbeam(e.Top.Y)),null!==n&&(wl.ClipperBase.IsHorizontal(n)?(null!==n.NextInLML&&i.InsertScanbeam(n.NextInLML.Top.Y),i.AddEdgeToSEL(n)):i.InsertScanbeam(n.Top.Y)),null!==e&&null!==n){if(null!==o&&wl.ClipperBase.IsHorizontal(n)&&i.m_GhostJoins.length>0&&0!==n.WindDelta)for(var s=0,a=this.m_GhostJoins.length;s<a;s++){var l=i.m_GhostJoins[s];i.HorzSegmentsOverlap(l.OutPt1.Pt.X,l.OffPt.X,n.Bot.X,n.Top.X)&&i.AddJoin(l.OutPt1,o,l.OffPt)}if(e.OutIdx>=0&&null!==e.PrevInAEL&&e.PrevInAEL.Curr.X===e.Bot.X&&e.PrevInAEL.OutIdx>=0&&wl.ClipperBase.SlopesEqual5(e.PrevInAEL.Curr,e.PrevInAEL.Top,e.Curr,e.Top)&&0!==e.WindDelta&&0!==e.PrevInAEL.WindDelta){var u=i.AddOutPt(e.PrevInAEL,e.Bot);i.AddJoin(o,u,e.Top)}if(e.NextInAEL!==n){n.OutIdx>=0&&n.PrevInAEL.OutIdx>=0&&wl.ClipperBase.SlopesEqual5(n.PrevInAEL.Curr,n.PrevInAEL.Top,n.Curr,n.Top)&&0!==n.WindDelta&&0!==n.PrevInAEL.WindDelta&&(u=i.AddOutPt(n.PrevInAEL,n.Bot),i.AddJoin(o,u,n.Top));var h=e.NextInAEL;if(null!==h)for(;h!==n;)i.IntersectEdges(n,h,e.Curr),h=h.NextInAEL}}}},wl.Clipper.prototype.InsertEdgeIntoAEL=function(t,e){if(null===this.m_ActiveEdges)t.PrevInAEL=null,t.NextInAEL=null,this.m_ActiveEdges=t;else if(null===e&&this.E2InsertsBeforeE1(this.m_ActiveEdges,t))t.PrevInAEL=null,t.NextInAEL=this.m_ActiveEdges,this.m_ActiveEdges.PrevInAEL=t,this.m_ActiveEdges=t;else{for(null===e&&(e=this.m_ActiveEdges);null!==e.NextInAEL&&!this.E2InsertsBeforeE1(e.NextInAEL,t);)e=e.NextInAEL;t.NextInAEL=e.NextInAEL,null!==e.NextInAEL&&(e.NextInAEL.PrevInAEL=t),t.PrevInAEL=e,e.NextInAEL=t}},wl.Clipper.prototype.E2InsertsBeforeE1=function(t,e){return e.Curr.X===t.Curr.X?e.Top.Y>t.Top.Y?e.Top.X<wl.Clipper.TopX(t,e.Top.Y):t.Top.X>wl.Clipper.TopX(e,t.Top.Y):e.Curr.X<t.Curr.X},wl.Clipper.prototype.IsEvenOddFillType=function(t){return t.PolyTyp===wl.PolyType.ptSubject?this.m_SubjFillType===wl.PolyFillType.pftEvenOdd:this.m_ClipFillType===wl.PolyFillType.pftEvenOdd},wl.Clipper.prototype.IsEvenOddAltFillType=function(t){return t.PolyTyp===wl.PolyType.ptSubject?this.m_ClipFillType===wl.PolyFillType.pftEvenOdd:this.m_SubjFillType===wl.PolyFillType.pftEvenOdd},wl.Clipper.prototype.IsContributing=function(t){var e,n;switch(t.PolyTyp===wl.PolyType.ptSubject?(e=this.m_SubjFillType,n=this.m_ClipFillType):(e=this.m_ClipFillType,n=this.m_SubjFillType),e){case wl.PolyFillType.pftEvenOdd:if(0===t.WindDelta&&1!==t.WindCnt)return!1;break;case wl.PolyFillType.pftNonZero:if(1!==Math.abs(t.WindCnt))return!1;break;case wl.PolyFillType.pftPositive:if(1!==t.WindCnt)return!1;break;default:if(-1!==t.WindCnt)return!1}switch(this.m_ClipType){case wl.ClipType.ctIntersection:switch(n){case wl.PolyFillType.pftEvenOdd:case wl.PolyFillType.pftNonZero:return 0!==t.WindCnt2;case wl.PolyFillType.pftPositive:return t.WindCnt2>0;default:return t.WindCnt2<0}case wl.ClipType.ctUnion:switch(n){case wl.PolyFillType.pftEvenOdd:case wl.PolyFillType.pftNonZero:return 0===t.WindCnt2;case wl.PolyFillType.pftPositive:return t.WindCnt2<=0;default:return t.WindCnt2>=0}case wl.ClipType.ctDifference:if(t.PolyTyp===wl.PolyType.ptSubject)switch(n){case wl.PolyFillType.pftEvenOdd:case wl.PolyFillType.pftNonZero:return 0===t.WindCnt2;case wl.PolyFillType.pftPositive:return t.WindCnt2<=0;default:return t.WindCnt2>=0}else switch(n){case wl.PolyFillType.pftEvenOdd:case wl.PolyFillType.pftNonZero:return 0!==t.WindCnt2;case wl.PolyFillType.pftPositive:return t.WindCnt2>0;default:return t.WindCnt2<0}case wl.ClipType.ctXor:if(0!==t.WindDelta)return!0;switch(n){case wl.PolyFillType.pftEvenOdd:case wl.PolyFillType.pftNonZero:return 0===t.WindCnt2;case wl.PolyFillType.pftPositive:return t.WindCnt2<=0;default:return t.WindCnt2>=0}}return!0},wl.Clipper.prototype.SetWindingCount=function(t){for(var e=t.PrevInAEL;null!==e&&(e.PolyTyp!==t.PolyTyp||0===e.WindDelta);)e=e.PrevInAEL;if(null===e){var n=t.PolyTyp===wl.PolyType.ptSubject?this.m_SubjFillType:this.m_ClipFillType;0===t.WindDelta?t.WindCnt=n===wl.PolyFillType.pftNegative?-1:1:t.WindCnt=t.WindDelta,t.WindCnt2=0,e=this.m_ActiveEdges}else if(0===t.WindDelta&&this.m_ClipType!==wl.ClipType.ctUnion)t.WindCnt=1,t.WindCnt2=e.WindCnt2,e=e.NextInAEL;else if(this.IsEvenOddFillType(t)){if(0===t.WindDelta){for(var i=!0,r=e.PrevInAEL;null!==r;)r.PolyTyp===e.PolyTyp&&0!==r.WindDelta&&(i=!i),r=r.PrevInAEL;t.WindCnt=i?0:1}else t.WindCnt=t.WindDelta;t.WindCnt2=e.WindCnt2,e=e.NextInAEL}else e.WindCnt*e.WindDelta<0?Math.abs(e.WindCnt)>1?e.WindDelta*t.WindDelta<0?t.WindCnt=e.WindCnt:t.WindCnt=e.WindCnt+t.WindDelta:t.WindCnt=0===t.WindDelta?1:t.WindDelta:0===t.WindDelta?t.WindCnt=e.WindCnt<0?e.WindCnt-1:e.WindCnt+1:e.WindDelta*t.WindDelta<0?t.WindCnt=e.WindCnt:t.WindCnt=e.WindCnt+t.WindDelta,t.WindCnt2=e.WindCnt2,e=e.NextInAEL;if(this.IsEvenOddAltFillType(t))for(;e!==t;)0!==e.WindDelta&&(t.WindCnt2=0===t.WindCnt2?1:0),e=e.NextInAEL;else for(;e!==t;)t.WindCnt2+=e.WindDelta,e=e.NextInAEL},wl.Clipper.prototype.AddEdgeToSEL=function(t){null===this.m_SortedEdges?(this.m_SortedEdges=t,t.PrevInSEL=null,t.NextInSEL=null):(t.NextInSEL=this.m_SortedEdges,t.PrevInSEL=null,this.m_SortedEdges.PrevInSEL=t,this.m_SortedEdges=t)},wl.Clipper.prototype.PopEdgeFromSEL=function(t){if(t.v=this.m_SortedEdges,null===t.v)return!1;var e=t.v;return this.m_SortedEdges=t.v.NextInSEL,null!==this.m_SortedEdges&&(this.m_SortedEdges.PrevInSEL=null),e.NextInSEL=null,e.PrevInSEL=null,!0},wl.Clipper.prototype.CopyAELToSEL=function(){var t=this.m_ActiveEdges;for(this.m_SortedEdges=t;null!==t;)t.PrevInSEL=t.PrevInAEL,t.NextInSEL=t.NextInAEL,t=t.NextInAEL},wl.Clipper.prototype.SwapPositionsInSEL=function(t,e){if(!(null===t.NextInSEL&&null===t.PrevInSEL||null===e.NextInSEL&&null===e.PrevInSEL)){if(t.NextInSEL===e)null!==(n=e.NextInSEL)&&(n.PrevInSEL=t),null!==(i=t.PrevInSEL)&&(i.NextInSEL=e),e.PrevInSEL=i,e.NextInSEL=t,t.PrevInSEL=e,t.NextInSEL=n;else if(e.NextInSEL===t)null!==(n=t.NextInSEL)&&(n.PrevInSEL=e),null!==(i=e.PrevInSEL)&&(i.NextInSEL=t),t.PrevInSEL=i,t.NextInSEL=e,e.PrevInSEL=t,e.NextInSEL=n;else{var n=t.NextInSEL,i=t.PrevInSEL;t.NextInSEL=e.NextInSEL,null!==t.NextInSEL&&(t.NextInSEL.PrevInSEL=t),t.PrevInSEL=e.PrevInSEL,null!==t.PrevInSEL&&(t.PrevInSEL.NextInSEL=t),e.NextInSEL=n,null!==e.NextInSEL&&(e.NextInSEL.PrevInSEL=e),e.PrevInSEL=i,null!==e.PrevInSEL&&(e.PrevInSEL.NextInSEL=e)}null===t.PrevInSEL?this.m_SortedEdges=t:null===e.PrevInSEL&&(this.m_SortedEdges=e)}},wl.Clipper.prototype.AddLocalMaxPoly=function(t,e,n){this.AddOutPt(t,n),0===e.WindDelta&&this.AddOutPt(e,n),t.OutIdx===e.OutIdx?(t.OutIdx=-1,e.OutIdx=-1):t.OutIdx<e.OutIdx?this.AppendPolygon(t,e):this.AppendPolygon(e,t)},wl.Clipper.prototype.AddLocalMinPoly=function(t,e,n){var i,r,o;if(wl.ClipperBase.IsHorizontal(e)||t.Dx>e.Dx?(i=this.AddOutPt(t,n),e.OutIdx=t.OutIdx,t.Side=wl.EdgeSide.esLeft,e.Side=wl.EdgeSide.esRight,o=(r=t).PrevInAEL===e?e.PrevInAEL:r.PrevInAEL):(i=this.AddOutPt(e,n),t.OutIdx=e.OutIdx,t.Side=wl.EdgeSide.esRight,e.Side=wl.EdgeSide.esLeft,o=(r=e).PrevInAEL===t?t.PrevInAEL:r.PrevInAEL),null!==o&&o.OutIdx>=0&&o.Top.Y<n.Y&&r.Top.Y<n.Y){var s=wl.Clipper.TopX(o,n.Y),a=wl.Clipper.TopX(r,n.Y);if(s===a&&0!==r.WindDelta&&0!==o.WindDelta&&wl.ClipperBase.SlopesEqual5(new wl.FPoint2(s,n.Y),o.Top,new wl.FPoint2(a,n.Y),r.Top)){var l=this.AddOutPt(o,n);this.AddJoin(i,l,r.Top)}}return i},wl.Clipper.prototype.AddOutPt=function(t,e){if(t.OutIdx<0){(i=this.CreateOutRec()).IsOpen=0===t.WindDelta;var n=new wl.OutPt;return i.Pts=n,n.Idx=i.Idx,n.Pt.X=e.X,n.Pt.Y=e.Y,wl.use_xyz&&(n.Pt.Z=e.Z),n.Next=n,n.Prev=n,i.IsOpen||this.SetHoleState(t,i),t.OutIdx=i.Idx,n}var i,r=(i=this.m_PolyOuts[t.OutIdx]).Pts,o=t.Side===wl.EdgeSide.esLeft;return o&&wl.FPoint.op_Equality(e,r.Pt)?r:!o&&wl.FPoint.op_Equality(e,r.Prev.Pt)?r.Prev:((n=new wl.OutPt).Idx=i.Idx,n.Pt.X=e.X,n.Pt.Y=e.Y,wl.use_xyz&&(n.Pt.Z=e.Z),n.Next=r,n.Prev=r.Prev,n.Prev.Next=n,r.Prev=n,o&&(i.Pts=n),n)},wl.Clipper.prototype.GetLastOutPt=function(t){var e=this.m_PolyOuts[t.OutIdx];return t.Side===wl.EdgeSide.esLeft?e.Pts:e.Pts.Prev},wl.Clipper.prototype.SwapPoints=function(t,e){var n=new wl.FPoint1(t.Value);t.Value.X=e.Value.X,t.Value.Y=e.Value.Y,wl.use_xyz&&(t.Value.Z=e.Value.Z),e.Value.X=n.X,e.Value.Y=n.Y,wl.use_xyz&&(e.Value.Z=n.Z)},wl.Clipper.prototype.HorzSegmentsOverlap=function(t,e,n,i){var r;return t>e&&(r=t,t=e,e=r),n>i&&(r=n,n=i,i=r),t<i&&n<e},wl.Clipper.prototype.SetHoleState=function(t,e){for(var n=t.PrevInAEL,i=null;null!==n;)n.OutIdx>=0&&0!==n.WindDelta&&(null===i?i=n:i.OutIdx===n.OutIdx&&(i=null)),n=n.PrevInAEL;null===i?(e.FirstLeft=null,e.IsHole=!1):(e.FirstLeft=this.m_PolyOuts[i.OutIdx],e.IsHole=!e.FirstLeft.IsHole)},wl.Clipper.prototype.GetDx=function(t,e){return t.Y===e.Y?wl.ClipperBase.horizontal:(e.X-t.X)/(e.Y-t.Y)},wl.Clipper.prototype.FirstIsBottomPt=function(t,e){for(var n=t.Prev;wl.FPoint.op_Equality(n.Pt,t.Pt)&&n!==t;)n=n.Prev;var i=Math.abs(this.GetDx(t.Pt,n.Pt));for(n=t.Next;wl.FPoint.op_Equality(n.Pt,t.Pt)&&n!==t;)n=n.Next;var r=Math.abs(this.GetDx(t.Pt,n.Pt));for(n=e.Prev;wl.FPoint.op_Equality(n.Pt,e.Pt)&&n!==e;)n=n.Prev;var o=Math.abs(this.GetDx(e.Pt,n.Pt));for(n=e.Next;wl.FPoint.op_Equality(n.Pt,e.Pt)&&n!==e;)n=n.Next;var s=Math.abs(this.GetDx(e.Pt,n.Pt));return Math.max(i,r)===Math.max(o,s)&&Math.min(i,r)===Math.min(o,s)?this.Area(t)>0:i>=o&&i>=s||r>=o&&r>=s},wl.Clipper.prototype.GetBottomPt=function(t){for(var e=null,n=t.Next;n!==t;)n.Pt.Y>t.Pt.Y?(t=n,e=null):n.Pt.Y===t.Pt.Y&&n.Pt.X<=t.Pt.X&&(n.Pt.X<t.Pt.X?(e=null,t=n):n.Next!==t&&n.Prev!==t&&(e=n)),n=n.Next;if(null!==e)for(;e!==n;)for(this.FirstIsBottomPt(n,e)||(t=e),e=e.Next;wl.FPoint.op_Inequality(e.Pt,t.Pt);)e=e.Next;return t},wl.Clipper.prototype.GetLowermostRec=function(t,e){null===t.BottomPt&&(t.BottomPt=this.GetBottomPt(t.Pts)),null===e.BottomPt&&(e.BottomPt=this.GetBottomPt(e.Pts));var n=t.BottomPt,i=e.BottomPt;return n.Pt.Y>i.Pt.Y?t:n.Pt.Y<i.Pt.Y?e:n.Pt.X<i.Pt.X?t:n.Pt.X>i.Pt.X||n.Next===n?e:i.Next===i||this.FirstIsBottomPt(n,i)?t:e},wl.Clipper.prototype.OutRec1RightOfOutRec2=function(t,e){do{if((t=t.FirstLeft)===e)return!0}while(null!==t);return!1},wl.Clipper.prototype.GetOutRec=function(t){for(var e=this.m_PolyOuts[t];e!==this.m_PolyOuts[e.Idx];)e=this.m_PolyOuts[e.Idx];return e},wl.Clipper.prototype.AppendPolygon=function(t,e){var n,i=this.m_PolyOuts[t.OutIdx],r=this.m_PolyOuts[e.OutIdx];n=this.OutRec1RightOfOutRec2(i,r)?r:this.OutRec1RightOfOutRec2(r,i)?i:this.GetLowermostRec(i,r);var o=i.Pts,s=o.Prev,a=r.Pts,l=a.Prev;t.Side===wl.EdgeSide.esLeft?e.Side===wl.EdgeSide.esLeft?(this.ReversePolyPtLinks(a),a.Next=o,o.Prev=a,s.Next=l,l.Prev=s,i.Pts=l):(l.Next=o,o.Prev=l,a.Prev=s,s.Next=a,i.Pts=a):e.Side===wl.EdgeSide.esRight?(this.ReversePolyPtLinks(a),s.Next=l,l.Prev=s,a.Next=o,o.Prev=a):(s.Next=a,a.Prev=s,o.Prev=l,l.Next=o),i.BottomPt=null,n===r&&(r.FirstLeft!==i&&(i.FirstLeft=r.FirstLeft),i.IsHole=r.IsHole),r.Pts=null,r.BottomPt=null,r.FirstLeft=i;var u=t.OutIdx,h=e.OutIdx;t.OutIdx=-1,e.OutIdx=-1;for(var c=this.m_ActiveEdges;null!==c;){if(c.OutIdx===h){c.OutIdx=u,c.Side=t.Side;break}c=c.NextInAEL}r.Idx=i.Idx},wl.Clipper.prototype.ReversePolyPtLinks=function(t){if(null!==t){var e,n;e=t;do{n=e.Next,e.Next=e.Prev,e.Prev=n,e=n}while(e!==t)}},wl.Clipper.SwapSides=function(t,e){var n=t.Side;t.Side=e.Side,e.Side=n},wl.Clipper.SwapPolyIndexes=function(t,e){var n=t.OutIdx;t.OutIdx=e.OutIdx,e.OutIdx=n},wl.Clipper.prototype.IntersectEdges=function(t,e,n){var i=t.OutIdx>=0,r=e.OutIdx>=0;if(wl.use_xyz&&this.SetZ(n,t,e),!wl.use_lines||0!==t.WindDelta&&0!==e.WindDelta){if(t.PolyTyp===e.PolyTyp)if(this.IsEvenOddFillType(t)){var o=t.WindCnt;t.WindCnt=e.WindCnt,e.WindCnt=o}else t.WindCnt+e.WindDelta===0?t.WindCnt=-t.WindCnt:t.WindCnt+=e.WindDelta,e.WindCnt-t.WindDelta==0?e.WindCnt=-e.WindCnt:e.WindCnt-=t.WindDelta;else this.IsEvenOddFillType(e)?t.WindCnt2=0===t.WindCnt2?1:0:t.WindCnt2+=e.WindDelta,this.IsEvenOddFillType(t)?e.WindCnt2=0===e.WindCnt2?1:0:e.WindCnt2-=t.WindDelta;var s,a,l,u,h,c;switch(t.PolyTyp===wl.PolyType.ptSubject?(s=this.m_SubjFillType,l=this.m_ClipFillType):(s=this.m_ClipFillType,l=this.m_SubjFillType),e.PolyTyp===wl.PolyType.ptSubject?(a=this.m_SubjFillType,u=this.m_ClipFillType):(a=this.m_ClipFillType,u=this.m_SubjFillType),s){case wl.PolyFillType.pftPositive:h=t.WindCnt;break;case wl.PolyFillType.pftNegative:h=-t.WindCnt;break;default:h=Math.abs(t.WindCnt)}switch(a){case wl.PolyFillType.pftPositive:c=e.WindCnt;break;case wl.PolyFillType.pftNegative:c=-e.WindCnt;break;default:c=Math.abs(e.WindCnt)}if(i&&r)0!==h&&1!==h||0!==c&&1!==c||t.PolyTyp!==e.PolyTyp&&this.m_ClipType!==wl.ClipType.ctXor?this.AddLocalMaxPoly(t,e,n):(this.AddOutPt(t,n),this.AddOutPt(e,n),wl.Clipper.SwapSides(t,e),wl.Clipper.SwapPolyIndexes(t,e));else if(i)(0===c||1===c)&&(this.AddOutPt(t,n),wl.Clipper.SwapSides(t,e),wl.Clipper.SwapPolyIndexes(t,e));else if(r)(0===h||1===h)&&(this.AddOutPt(e,n),wl.Clipper.SwapSides(t,e),wl.Clipper.SwapPolyIndexes(t,e));else if(!(0!==h&&1!==h||0!==c&&1!==c)){var p,d;switch(l){case wl.PolyFillType.pftPositive:p=t.WindCnt2;break;case wl.PolyFillType.pftNegative:p=-t.WindCnt2;break;default:p=Math.abs(t.WindCnt2)}switch(u){case wl.PolyFillType.pftPositive:d=e.WindCnt2;break;case wl.PolyFillType.pftNegative:d=-e.WindCnt2;break;default:d=Math.abs(e.WindCnt2)}if(t.PolyTyp!==e.PolyTyp)this.AddLocalMinPoly(t,e,n);else if(1===h&&1===c)switch(this.m_ClipType){case wl.ClipType.ctIntersection:p>0&&d>0&&this.AddLocalMinPoly(t,e,n);break;case wl.ClipType.ctUnion:p<=0&&d<=0&&this.AddLocalMinPoly(t,e,n);break;case wl.ClipType.ctDifference:(t.PolyTyp===wl.PolyType.ptClip&&p>0&&d>0||t.PolyTyp===wl.PolyType.ptSubject&&p<=0&&d<=0)&&this.AddLocalMinPoly(t,e,n);break;case wl.ClipType.ctXor:this.AddLocalMinPoly(t,e,n)}else wl.Clipper.SwapSides(t,e)}}else{if(0===t.WindDelta&&0===e.WindDelta)return;t.PolyTyp===e.PolyTyp&&t.WindDelta!==e.WindDelta&&this.m_ClipType===wl.ClipType.ctUnion?0===t.WindDelta?r&&(this.AddOutPt(t,n),i&&(t.OutIdx=-1)):i&&(this.AddOutPt(e,n),r&&(e.OutIdx=-1)):t.PolyTyp!==e.PolyTyp&&(0!==t.WindDelta||1!==Math.abs(e.WindCnt)||this.m_ClipType===wl.ClipType.ctUnion&&0!==e.WindCnt2?0===e.WindDelta&&1===Math.abs(t.WindCnt)&&(this.m_ClipType!==wl.ClipType.ctUnion||0===t.WindCnt2)&&(this.AddOutPt(e,n),r&&(e.OutIdx=-1)):(this.AddOutPt(t,n),i&&(t.OutIdx=-1)))}},wl.Clipper.prototype.DeleteFromSEL=function(t){var e=t.PrevInSEL,n=t.NextInSEL;null===e&&null===n&&t!==this.m_SortedEdges||(null!==e?e.NextInSEL=n:this.m_SortedEdges=n,null!==n&&(n.PrevInSEL=e),t.NextInSEL=null,t.PrevInSEL=null)},wl.Clipper.prototype.ProcessHorizontals=function(){for(var t={};this.PopEdgeFromSEL(t);)this.ProcessHorizontal(t.v)},wl.Clipper.prototype.GetHorzDirection=function(t,e){t.Bot.X<t.Top.X?(e.Left=t.Bot.X,e.Right=t.Top.X,e.Dir=wl.Direction.dLeftToRight):(e.Left=t.Top.X,e.Right=t.Bot.X,e.Dir=wl.Direction.dRightToLeft)},wl.Clipper.prototype.ProcessHorizontal=function(t){var e=this,n={Dir:null,Left:null,Right:null};this.GetHorzDirection(t,n);for(var i=n.Dir,r=n.Left,o=n.Right,s=0===t.WindDelta,a=t,l=null;null!==a.NextInLML&&wl.ClipperBase.IsHorizontal(a.NextInLML);)a=a.NextInLML;null===a.NextInLML&&(l=this.GetMaximaPair(a));var u=this.m_Maxima;if(null!==u)if(i===wl.Direction.dLeftToRight){for(;null!==u&&u.X<=t.Bot.X;)u=u.Next;null!==u&&u.X>=a.Top.X&&(u=null)}else{for(;null!==u.Next&&u.Next.X<t.Bot.X;)u=u.Next;u.X<=a.Top.X&&(u=null)}for(var h=null;;){for(var c=t===a,p=e.GetNextInAEL(t,i);null!==p;){if(null!==u)if(i===wl.Direction.dLeftToRight)for(;null!==u&&u.X<p.Curr.X;)t.OutIdx>=0&&!s&&e.AddOutPt(t,new wl.FPoint2(u.X,t.Bot.Y)),u=u.Next;else for(;null!==u&&u.X>p.Curr.X;)t.OutIdx>=0&&!s&&e.AddOutPt(t,new wl.FPoint2(u.X,t.Bot.Y)),u=u.Prev;if(i===wl.Direction.dLeftToRight&&p.Curr.X>o||i===wl.Direction.dRightToLeft&&p.Curr.X<r||p.Curr.X===t.Top.X&&null!==t.NextInLML&&p.Dx<t.NextInLML.Dx)break;if(t.OutIdx>=0&&!s){wl.use_xyz&&(i===wl.Direction.dLeftToRight?e.SetZ(p.Curr,t,p):e.SetZ(p.Curr,p,t)),h=e.AddOutPt(t,p.Curr);for(var d=e.m_SortedEdges;null!==d;){if(d.OutIdx>=0&&e.HorzSegmentsOverlap(t.Bot.X,t.Top.X,d.Bot.X,d.Top.X)){var f=e.GetLastOutPt(d);e.AddJoin(f,h,d.Top)}d=d.NextInSEL}e.AddGhostJoin(h,t.Bot)}if(p===l&&c)return t.OutIdx>=0&&e.AddLocalMaxPoly(t,l,t.Top),e.DeleteFromAEL(t),void e.DeleteFromAEL(l);if(i===wl.Direction.dLeftToRight){var m=new wl.FPoint2(p.Curr.X,t.Curr.Y);e.IntersectEdges(t,p,m)}else m=new wl.FPoint2(p.Curr.X,t.Curr.Y),e.IntersectEdges(p,t,m);var y=e.GetNextInAEL(p,i);e.SwapPositionsInAEL(t,p),p=y}if(null===t.NextInLML||!wl.ClipperBase.IsHorizontal(t.NextInLML))break;(t=e.UpdateEdgeIntoAEL(t)).OutIdx>=0&&e.AddOutPt(t,t.Bot),n={Dir:i,Left:r,Right:o},e.GetHorzDirection(t,n),i=n.Dir,r=n.Left,o=n.Right}if(t.OutIdx>=0&&null===h){for(h=this.GetLastOutPt(t),d=this.m_SortedEdges;null!==d;)d.OutIdx>=0&&e.HorzSegmentsOverlap(t.Bot.X,t.Top.X,d.Bot.X,d.Top.X)&&(f=e.GetLastOutPt(d),e.AddJoin(f,h,d.Top)),d=d.NextInSEL;this.AddGhostJoin(h,t.Top)}if(null!==t.NextInLML)if(t.OutIdx>=0){if(h=this.AddOutPt(t,t.Top),0===(t=this.UpdateEdgeIntoAEL(t)).WindDelta)return;var g=t.PrevInAEL;y=t.NextInAEL,null!==g&&g.Curr.X===t.Bot.X&&g.Curr.Y===t.Bot.Y&&0===g.WindDelta&&g.OutIdx>=0&&g.Curr.Y>g.Top.Y&&wl.ClipperBase.SlopesEqual3(t,g)?(f=this.AddOutPt(g,t.Bot),this.AddJoin(h,f,t.Top)):null!==y&&y.Curr.X===t.Bot.X&&y.Curr.Y===t.Bot.Y&&0!==y.WindDelta&&y.OutIdx>=0&&y.Curr.Y>y.Top.Y&&wl.ClipperBase.SlopesEqual3(t,y)&&(f=this.AddOutPt(y,t.Bot),this.AddJoin(h,f,t.Top))}else t=this.UpdateEdgeIntoAEL(t);else t.OutIdx>=0&&this.AddOutPt(t,t.Top),this.DeleteFromAEL(t)},wl.Clipper.prototype.GetNextInAEL=function(t,e){return e===wl.Direction.dLeftToRight?t.NextInAEL:t.PrevInAEL},wl.Clipper.prototype.IsMinima=function(t){return null!==t&&t.Prev.NextInLML!==t&&t.Next.NextInLML!==t},wl.Clipper.prototype.IsMaxima=function(t,e){return null!==t&&t.Top.Y===e&&null===t.NextInLML},wl.Clipper.prototype.IsIntermediate=function(t,e){return t.Top.Y===e&&null!==t.NextInLML},wl.Clipper.prototype.GetMaximaPair=function(t){return wl.FPoint.op_Equality(t.Next.Top,t.Top)&&null===t.Next.NextInLML?t.Next:wl.FPoint.op_Equality(t.Prev.Top,t.Top)&&null===t.Prev.NextInLML?t.Prev:null},wl.Clipper.prototype.GetMaximaPairEx=function(t){var e=this.GetMaximaPair(t);return null===e||e.OutIdx===wl.ClipperBase.Skip||e.NextInAEL===e.PrevInAEL&&!wl.ClipperBase.IsHorizontal(e)?null:e},wl.Clipper.prototype.ProcessIntersections=function(t){if(null===this.m_ActiveEdges)return!0;try{if(this.BuildIntersectList(t),0===this.m_IntersectList.length)return!0;if(1!==this.m_IntersectList.length&&!this.FixupIntersectionOrder())return!1;this.ProcessIntersectList()}catch{this.m_SortedEdges=null,this.m_IntersectList.length=0,wl.Error("ProcessIntersections error")}return this.m_SortedEdges=null,!0},wl.Clipper.prototype.BuildIntersectList=function(t){var e=this;if(null!==this.m_ActiveEdges){var n=this.m_ActiveEdges;for(this.m_SortedEdges=n;null!==n;)n.PrevInSEL=n.PrevInAEL,n.NextInSEL=n.NextInAEL,n.Curr.X=wl.Clipper.TopX(n,t),n=n.NextInAEL;for(var i=!0;i&&null!==this.m_SortedEdges;){for(i=!1,n=e.m_SortedEdges;null!==n.NextInSEL;){var r=n.NextInSEL,o=new wl.FPoint0;if(n.Curr.X>r.Curr.X){e.IntersectPoint(n,r,o),o.Y<t&&(o=new wl.FPoint2(wl.Clipper.TopX(n,t),t));var s=new wl.IntersectNode;s.Edge1=n,s.Edge2=r,s.Pt.X=o.X,s.Pt.Y=o.Y,wl.use_xyz&&(s.Pt.Z=o.Z),e.m_IntersectList.push(s),e.SwapPositionsInSEL(n,r),i=!0}else n=r}if(null===n.PrevInSEL)break;n.PrevInSEL.NextInSEL=null}this.m_SortedEdges=null}},wl.Clipper.prototype.EdgesAdjacent=function(t){return t.Edge1.NextInSEL===t.Edge2||t.Edge1.PrevInSEL===t.Edge2},wl.Clipper.IntersectNodeSort=function(t,e){return e.Pt.Y-t.Pt.Y},wl.Clipper.prototype.FixupIntersectionOrder=function(){var t=this;this.m_IntersectList.sort(this.m_IntersectNodeComparer),this.CopyAELToSEL();for(var e=this.m_IntersectList.length,n=0;n<e;n++){if(!t.EdgesAdjacent(t.m_IntersectList[n])){for(var i=n+1;i<e&&!this.EdgesAdjacent(this.m_IntersectList[i]);)i++;if(i===e)return!1;var r=t.m_IntersectList[n];t.m_IntersectList[n]=t.m_IntersectList[i],t.m_IntersectList[i]=r}t.SwapPositionsInSEL(t.m_IntersectList[n].Edge1,t.m_IntersectList[n].Edge2)}return!0},wl.Clipper.prototype.ProcessIntersectList=function(){for(var t=this,e=0,n=this.m_IntersectList.length;e<n;e++){var i=t.m_IntersectList[e];t.IntersectEdges(i.Edge1,i.Edge2,i.Pt),t.SwapPositionsInAEL(i.Edge1,i.Edge2)}this.m_IntersectList.length=0},wl.Clipper.TopX=function(t,e){return e===t.Top.Y?t.Top.X:t.Bot.X+t.Dx*(e-t.Bot.Y)},wl.Clipper.prototype.IntersectPoint=function(t,e,n){var i,r;if(n.X=0,n.Y=0,t.Dx===e.Dx)return n.Y=t.Curr.Y,void(n.X=wl.Clipper.TopX(t,n.Y));if(0===t.Delta.X)n.X=t.Bot.X,wl.ClipperBase.IsHorizontal(e)?n.Y=e.Bot.Y:(r=e.Bot.Y-e.Bot.X/e.Dx,n.Y=n.X/e.Dx+r);else if(0===e.Delta.X)n.X=e.Bot.X,wl.ClipperBase.IsHorizontal(t)?n.Y=t.Bot.Y:(i=t.Bot.Y-t.Bot.X/t.Dx,n.Y=n.X/t.Dx+i);else{i=t.Bot.X-t.Bot.Y*t.Dx;var o=((r=e.Bot.X-e.Bot.Y*e.Dx)-i)/(t.Dx-e.Dx);n.Y=o,Math.abs(t.Dx)<Math.abs(e.Dx)?n.X=t.Dx*o+i:n.X=e.Dx*o+r}if(n.Y<t.Top.Y||n.Y<e.Top.Y){if(t.Top.Y>e.Top.Y)return n.Y=t.Top.Y,n.X=wl.Clipper.TopX(e,t.Top.Y),n.X<t.Top.X;n.Y=e.Top.Y,Math.abs(t.Dx)<Math.abs(e.Dx)?n.X=wl.Clipper.TopX(t,n.Y):n.X=wl.Clipper.TopX(e,n.Y)}n.Y>t.Curr.Y&&(n.Y=t.Curr.Y,Math.abs(t.Dx)>Math.abs(e.Dx)?n.X=wl.Clipper.TopX(e,n.Y):n.X=wl.Clipper.TopX(t,n.Y))},wl.Clipper.prototype.ProcessEdgesAtTopOfScanbeam=function(t){for(var e=this,n=this.m_ActiveEdges;null!==n;){var i=e.IsMaxima(n,t);if(i){var r=e.GetMaximaPairEx(n);i=null===r||!wl.ClipperBase.IsHorizontal(r)}if(i){e.StrictlySimple&&e.InsertMaxima(n.Top.X);var o=n.PrevInAEL;e.DoMaxima(n),n=null===o?e.m_ActiveEdges:o.NextInAEL}else{if(e.IsIntermediate(n,t)&&wl.ClipperBase.IsHorizontal(n.NextInLML)?((n=e.UpdateEdgeIntoAEL(n)).OutIdx>=0&&e.AddOutPt(n,n.Bot),e.AddEdgeToSEL(n)):(n.Curr.X=wl.Clipper.TopX(n,t),n.Curr.Y=t),wl.use_xyz&&(n.Top.Y===t?n.Curr.Z=n.Top.Z:n.Bot.Y===t?n.Curr.Z=n.Bot.Z:n.Curr.Z=0),e.StrictlySimple&&(o=n.PrevInAEL,n.OutIdx>=0&&0!==n.WindDelta&&null!==o&&o.OutIdx>=0&&o.Curr.X===n.Curr.X&&0!==o.WindDelta)){var s=new wl.FPoint1(n.Curr);wl.use_xyz&&e.SetZ(s,o,n);var a=e.AddOutPt(o,s),l=e.AddOutPt(n,s);e.AddJoin(a,l,s)}n=n.NextInAEL}}for(this.ProcessHorizontals(),this.m_Maxima=null,n=this.m_ActiveEdges;null!==n;){if(e.IsIntermediate(n,t)){a=null,n.OutIdx>=0&&(a=e.AddOutPt(n,n.Top)),o=(n=e.UpdateEdgeIntoAEL(n)).PrevInAEL;var u=n.NextInAEL;null!==o&&o.Curr.X===n.Bot.X&&o.Curr.Y===n.Bot.Y&&null!==a&&o.OutIdx>=0&&o.Curr.Y===o.Top.Y&&wl.ClipperBase.SlopesEqual5(n.Curr,n.Top,o.Curr,o.Top)&&0!==n.WindDelta&&0!==o.WindDelta?(l=e.AddOutPt(ePrev2,n.Bot),e.AddJoin(a,l,n.Top)):null!==u&&u.Curr.X===n.Bot.X&&u.Curr.Y===n.Bot.Y&&null!==a&&u.OutIdx>=0&&u.Curr.Y===u.Top.Y&&wl.ClipperBase.SlopesEqual5(n.Curr,n.Top,u.Curr,u.Top)&&0!==n.WindDelta&&0!==u.WindDelta&&(l=e.AddOutPt(u,n.Bot),e.AddJoin(a,l,n.Top))}n=n.NextInAEL}},wl.Clipper.prototype.DoMaxima=function(t){var e=this.GetMaximaPairEx(t);if(null===e)return t.OutIdx>=0&&this.AddOutPt(t,t.Top),void this.DeleteFromAEL(t);for(var n=t.NextInAEL;null!==n&&n!==e;)this.IntersectEdges(t,n,t.Top),this.SwapPositionsInAEL(t,n),n=t.NextInAEL;-1===t.OutIdx&&-1===e.OutIdx?(this.DeleteFromAEL(t),this.DeleteFromAEL(e)):t.OutIdx>=0&&e.OutIdx>=0?(t.OutIdx>=0&&this.AddLocalMaxPoly(t,e,t.Top),this.DeleteFromAEL(t),this.DeleteFromAEL(e)):wl.use_lines&&0===t.WindDelta?(t.OutIdx>=0&&(this.AddOutPt(t,t.Top),t.OutIdx=wl.ClipperBase.Unassigned),this.DeleteFromAEL(t),e.OutIdx>=0&&(this.AddOutPt(e,t.Top),e.OutIdx=wl.ClipperBase.Unassigned),this.DeleteFromAEL(e)):wl.Error("DoMaxima error")},wl.Clipper.ReversePaths=function(t){for(var e=0,n=t.length;e<n;e++)t[e].reverse()},wl.Clipper.Orientation=function(t){return wl.Clipper.Area(t)>=0},wl.Clipper.prototype.PointCount=function(t){if(null===t)return 0;var e=0,n=t;do{e++,n=n.Next}while(n!==t);return e},wl.Clipper.prototype.BuildResult=function(t){wl.Clear(t);for(var e=0,n=this.m_PolyOuts.length;e<n;e++){var i=this.m_PolyOuts[e];if(null!==i.Pts){var r=i.Pts.Prev,o=this.PointCount(r);if(!(o<2)){for(var s=new Array(o),a=0;a<o;a++)s[a]=r.Pt,r=r.Prev;t.push(s)}}}},wl.Clipper.prototype.BuildResult2=function(t){var e=this;t.Clear();for(var n=0,i=this.m_PolyOuts.length;n<i;n++){var r=e.m_PolyOuts[n],o=e.PointCount(r.Pts);if(!(r.IsOpen&&o<2||!r.IsOpen&&o<3)){e.FixHoleLinkage(r);var s=new wl.PolyNode;t.m_AllPolys.push(s),r.PolyNode=s,s.m_polygon.length=o;for(var a=r.Pts.Prev,l=0;l<o;l++)s.m_polygon[l]=a.Pt,a=a.Prev}}for(n=0,i=this.m_PolyOuts.length;n<i;n++)null!==(r=e.m_PolyOuts[n]).PolyNode&&(r.IsOpen?(r.PolyNode.IsOpen=!0,t.AddChild(r.PolyNode)):null!==r.FirstLeft&&null!==r.FirstLeft.PolyNode?r.FirstLeft.PolyNode.AddChild(r.PolyNode):t.AddChild(r.PolyNode))},wl.Clipper.prototype.FixupOutPolyline=function(t){for(var e=t.Pts,n=e.Prev;e!==n;)if(e=e.Next,wl.FPoint.op_Equality(e.Pt,e.Prev.Pt)){e===n&&(n=e.Prev);var i=e.Prev;i.Next=e.Next,e.Next.Prev=i,e=i}e===e.Prev&&(t.Pts=null)},wl.Clipper.prototype.FixupOutPolygon=function(t){var e=null;t.BottomPt=null;for(var n=t.Pts,i=this.PreserveCollinear||this.StrictlySimple;;){if(n.Prev===n||n.Prev===n.Next)return void(t.Pts=null);if(wl.FPoint.op_Equality(n.Pt,n.Next.Pt)||wl.FPoint.op_Equality(n.Pt,n.Prev.Pt)||wl.ClipperBase.SlopesEqual4(n.Prev.Pt,n.Pt,n.Next.Pt)&&(!i||!this.Pt2IsBetweenPt1AndPt3(n.Prev.Pt,n.Pt,n.Next.Pt)))e=null,n.Prev.Next=n.Next,n.Next.Prev=n.Prev,n=n.Prev;else{if(n===e)break;null===e&&(e=n),n=n.Next}}t.Pts=n},wl.Clipper.prototype.DupOutPt=function(t,e){var n=new wl.OutPt;return n.Pt.X=t.Pt.X,n.Pt.Y=t.Pt.Y,wl.use_xyz&&(n.Pt.Z=t.Pt.Z),n.Idx=t.Idx,e?(n.Next=t.Next,n.Prev=t,t.Next.Prev=n,t.Next=n):(n.Prev=t.Prev,n.Next=t,t.Prev.Next=n,t.Prev=n),n},wl.Clipper.prototype.GetOverlap=function(t,e,n,i,r){return t<e?n<i?(r.Left=Math.max(t,n),r.Right=Math.min(e,i)):(r.Left=Math.max(t,i),r.Right=Math.min(e,n)):n<i?(r.Left=Math.max(e,n),r.Right=Math.min(t,i)):(r.Left=Math.max(e,i),r.Right=Math.min(t,n)),r.Left<r.Right},wl.Clipper.prototype.JoinHorz=function(t,e,n,i,r,o){var s=t.Pt.X>e.Pt.X?wl.Direction.dRightToLeft:wl.Direction.dLeftToRight,a=n.Pt.X>i.Pt.X?wl.Direction.dRightToLeft:wl.Direction.dLeftToRight;if(s===a)return!1;if(s===wl.Direction.dLeftToRight){for(;t.Next.Pt.X<=r.X&&t.Next.Pt.X>=t.Pt.X&&t.Next.Pt.Y===r.Y;)t=t.Next;o&&t.Pt.X!==r.X&&(t=t.Next),e=this.DupOutPt(t,!o),wl.FPoint.op_Inequality(e.Pt,r)&&((t=e).Pt.X=r.X,t.Pt.Y=r.Y,wl.use_xyz&&(t.Pt.Z=r.Z),e=this.DupOutPt(t,!o))}else{for(;t.Next.Pt.X>=r.X&&t.Next.Pt.X<=t.Pt.X&&t.Next.Pt.Y===r.Y;)t=t.Next;!o&&t.Pt.X!==r.X&&(t=t.Next),e=this.DupOutPt(t,o),wl.FPoint.op_Inequality(e.Pt,r)&&((t=e).Pt.X=r.X,t.Pt.Y=r.Y,wl.use_xyz&&(t.Pt.Z=r.Z),e=this.DupOutPt(t,o))}if(a===wl.Direction.dLeftToRight){for(;n.Next.Pt.X<=r.X&&n.Next.Pt.X>=n.Pt.X&&n.Next.Pt.Y===r.Y;)n=n.Next;o&&n.Pt.X!==r.X&&(n=n.Next),i=this.DupOutPt(n,!o),wl.FPoint.op_Inequality(i.Pt,r)&&((n=i).Pt.X=r.X,n.Pt.Y=r.Y,wl.use_xyz&&(n.Pt.Z=r.Z),i=this.DupOutPt(n,!o))}else{for(;n.Next.Pt.X>=r.X&&n.Next.Pt.X<=n.Pt.X&&n.Next.Pt.Y===r.Y;)n=n.Next;!o&&n.Pt.X!==r.X&&(n=n.Next),i=this.DupOutPt(n,o),wl.FPoint.op_Inequality(i.Pt,r)&&((n=i).Pt.X=r.X,n.Pt.Y=r.Y,wl.use_xyz&&(n.Pt.Z=r.Z),i=this.DupOutPt(n,o))}return s===wl.Direction.dLeftToRight===o?(t.Prev=n,n.Next=t,e.Next=i,i.Prev=e):(t.Next=n,n.Prev=t,e.Prev=i,i.Next=e),!0},wl.Clipper.prototype.JoinPoints=function(t,e,n){var i=t.OutPt1,r=new wl.OutPt,o=t.OutPt2,s=new wl.OutPt,a=t.OutPt1.Pt.Y===t.OffPt.Y;if(a&&wl.FPoint.op_Equality(t.OffPt,t.OutPt1.Pt)&&wl.FPoint.op_Equality(t.OffPt,t.OutPt2.Pt)){if(e!==n)return!1;for(r=t.OutPt1.Next;r!==i&&wl.FPoint.op_Equality(r.Pt,t.OffPt);)r=r.Next;var l=r.Pt.Y>t.OffPt.Y;for(s=t.OutPt2.Next;s!==o&&wl.FPoint.op_Equality(s.Pt,t.OffPt);)s=s.Next;return l!==s.Pt.Y>t.OffPt.Y&&(l?(r=this.DupOutPt(i,!1),s=this.DupOutPt(o,!0),i.Prev=o,o.Next=i,r.Next=s,s.Prev=r,t.OutPt1=i,t.OutPt2=r,!0):(r=this.DupOutPt(i,!0),s=this.DupOutPt(o,!1),i.Next=o,o.Prev=i,r.Prev=s,s.Next=r,t.OutPt1=i,t.OutPt2=r,!0))}if(a){for(r=i;i.Prev.Pt.Y===i.Pt.Y&&i.Prev!==r&&i.Prev!==o;)i=i.Prev;for(;r.Next.Pt.Y===r.Pt.Y&&r.Next!==i&&r.Next!==o;)r=r.Next;if(r.Next===i||r.Next===o)return!1;for(s=o;o.Prev.Pt.Y===o.Pt.Y&&o.Prev!==s&&o.Prev!==r;)o=o.Prev;for(;s.Next.Pt.Y===s.Pt.Y&&s.Next!==o&&s.Next!==i;)s=s.Next;if(s.Next===o||s.Next===i)return!1;var u={Left:null,Right:null};if(!this.GetOverlap(i.Pt.X,r.Pt.X,o.Pt.X,s.Pt.X,u))return!1;var h,c=u.Left,p=u.Right,d=new wl.FPoint0;return i.Pt.X>=c&&i.Pt.X<=p?(d.X=i.Pt.X,d.Y=i.Pt.Y,wl.use_xyz&&(d.Z=i.Pt.Z),h=i.Pt.X>r.Pt.X):o.Pt.X>=c&&o.Pt.X<=p?(d.X=o.Pt.X,d.Y=o.Pt.Y,wl.use_xyz&&(d.Z=o.Pt.Z),h=o.Pt.X>s.Pt.X):r.Pt.X>=c&&r.Pt.X<=p?(d.X=r.Pt.X,d.Y=r.Pt.Y,wl.use_xyz&&(d.Z=r.Pt.Z),h=r.Pt.X>i.Pt.X):(d.X=s.Pt.X,d.Y=s.Pt.Y,wl.use_xyz&&(d.Z=s.Pt.Z),h=s.Pt.X>o.Pt.X),t.OutPt1=i,t.OutPt2=o,this.JoinHorz(i,r,o,s,d,h)}for(r=i.Next;wl.FPoint.op_Equality(r.Pt,i.Pt)&&r!==i;)r=r.Next;var f=r.Pt.Y>i.Pt.Y||!wl.ClipperBase.SlopesEqual4(i.Pt,r.Pt,t.OffPt);if(f){for(r=i.Prev;wl.FPoint.op_Equality(r.Pt,i.Pt)&&r!==i;)r=r.Prev;if(r.Pt.Y>i.Pt.Y||!wl.ClipperBase.SlopesEqual4(i.Pt,r.Pt,t.OffPt))return!1}for(s=o.Next;wl.FPoint.op_Equality(s.Pt,o.Pt)&&s!==o;)s=s.Next;var m=s.Pt.Y>o.Pt.Y||!wl.ClipperBase.SlopesEqual4(o.Pt,s.Pt,t.OffPt);if(m){for(s=o.Prev;wl.FPoint.op_Equality(s.Pt,o.Pt)&&s!==o;)s=s.Prev;if(s.Pt.Y>o.Pt.Y||!wl.ClipperBase.SlopesEqual4(o.Pt,s.Pt,t.OffPt))return!1}return!(r===i||s===o||r===s||e===n&&f===m||(f?(r=this.DupOutPt(i,!1),s=this.DupOutPt(o,!0),i.Prev=o,o.Next=i,r.Next=s,s.Prev=r,t.OutPt1=i,t.OutPt2=r,0):(r=this.DupOutPt(i,!0),s=this.DupOutPt(o,!1),i.Next=o,o.Prev=i,r.Prev=s,s.Next=r,t.OutPt1=i,t.OutPt2=r,0)))},wl.Clipper.GetBounds=function(t){for(var e=0,n=t.length;e<n&&0===t[e].length;)e++;if(e===n)return new wl.FRect(0,0,0,0);var i=new wl.FRect;for(i.left=t[e][0].X,i.right=i.left,i.top=t[e][0].Y,i.bottom=i.top;e<n;e++)for(var r=0,o=t[e].length;r<o;r++)t[e][r].X<i.left?i.left=t[e][r].X:t[e][r].X>i.right&&(i.right=t[e][r].X),t[e][r].Y<i.top?i.top=t[e][r].Y:t[e][r].Y>i.bottom&&(i.bottom=t[e][r].Y);return i},wl.Clipper.prototype.GetBounds2=function(t){var e=t,n=new wl.FRect;for(n.left=t.Pt.X,n.right=t.Pt.X,n.top=t.Pt.Y,n.bottom=t.Pt.Y,t=t.Next;t!==e;)t.Pt.X<n.left&&(n.left=t.Pt.X),t.Pt.X>n.right&&(n.right=t.Pt.X),t.Pt.Y<n.top&&(n.top=t.Pt.Y),t.Pt.Y>n.bottom&&(n.bottom=t.Pt.Y),t=t.Next;return n},wl.Clipper.PointInPolygon=function(t,e){var n=0,i=e.length;if(i<3)return 0;for(var r=e[0],o=1;o<=i;++o){var s=o===i?e[0]:e[o];if(s.Y===t.Y&&(s.X===t.X||r.Y===t.Y&&s.X>t.X==r.X<t.X))return-1;if(r.Y<t.Y!=s.Y<t.Y)if(r.X>=t.X)if(s.X>t.X)n=1-n;else{if(0==(a=(r.X-t.X)*(s.Y-t.Y)-(s.X-t.X)*(r.Y-t.Y)))return-1;a>0==s.Y>r.Y&&(n=1-n)}else if(s.X>t.X){var a;if(0==(a=(r.X-t.X)*(s.Y-t.Y)-(s.X-t.X)*(r.Y-t.Y)))return-1;a>0==s.Y>r.Y&&(n=1-n)}r=s}return n},wl.Clipper.prototype.PointInPolygon=function(t,e){var n=0,i=e,r=t.X,o=t.Y,s=e.Pt.X,a=e.Pt.Y;do{var l=(e=e.Next).Pt.X,u=e.Pt.Y;if(u===o&&(l===r||a===o&&l>r==s<r))return-1;if(a<o!=u<o)if(s>=r)if(l>r)n=1-n;else{if(0==(h=(s-r)*(u-o)-(l-r)*(a-o)))return-1;h>0==u>a&&(n=1-n)}else if(l>r){var h;if(0==(h=(s-r)*(u-o)-(l-r)*(a-o)))return-1;h>0==u>a&&(n=1-n)}s=l,a=u}while(i!==e);return n},wl.Clipper.prototype.Poly2ContainsPoly1=function(t,e){var n=t;do{var i=this.PointInPolygon(n.Pt,e);if(i>=0)return i>0;n=n.Next}while(n!==t);return!0},wl.Clipper.prototype.FixupFirstLefts1=function(t,e){for(var n,i,r=0,o=this.m_PolyOuts.length;r<o;r++)n=this.m_PolyOuts[r],i=wl.Clipper.ParseFirstLeft(n.FirstLeft),null!==n.Pts&&i===t&&this.Poly2ContainsPoly1(n.Pts,e.Pts)&&(n.FirstLeft=e)},wl.Clipper.prototype.FixupFirstLefts2=function(t,e){for(var n,i,r=this,o=e.FirstLeft,s=0,a=this.m_PolyOuts.length;s<a;s++)null!==(n=r.m_PolyOuts[s]).Pts&&n!==e&&n!==t&&((i=wl.Clipper.ParseFirstLeft(n.FirstLeft))===o||i===t||i===e)&&(r.Poly2ContainsPoly1(n.Pts,t.Pts)?n.FirstLeft=t:r.Poly2ContainsPoly1(n.Pts,e.Pts)?n.FirstLeft=e:(n.FirstLeft===t||n.FirstLeft===e)&&(n.FirstLeft=o))},wl.Clipper.prototype.FixupFirstLefts3=function(t,e){for(var n,i,r=0,o=this.m_PolyOuts.length;r<o;r++)n=this.m_PolyOuts[r],i=wl.Clipper.ParseFirstLeft(n.FirstLeft),null!==n.Pts&&i===t&&(n.FirstLeft=e)},wl.Clipper.ParseFirstLeft=function(t){for(;null!==t&&null===t.Pts;)t=t.FirstLeft;return t},wl.Clipper.prototype.JoinCommonEdges=function(){for(var t=this,e=0,n=this.m_Joins.length;e<n;e++){var i,r=t.m_Joins[e],o=t.GetOutRec(r.OutPt1.Idx),s=t.GetOutRec(r.OutPt2.Idx);null===o.Pts||null===s.Pts||o.IsOpen||s.IsOpen||(i=o===s?o:t.OutRec1RightOfOutRec2(o,s)?s:t.OutRec1RightOfOutRec2(s,o)?o:t.GetLowermostRec(o,s),t.JoinPoints(r,o,s)&&(o===s?(o.Pts=r.OutPt1,o.BottomPt=null,(s=t.CreateOutRec()).Pts=r.OutPt2,t.UpdateOutPtIdxs(s),t.Poly2ContainsPoly1(s.Pts,o.Pts)?(s.IsHole=!o.IsHole,s.FirstLeft=o,t.m_UsingPolyTree&&t.FixupFirstLefts2(s,o),(s.IsHole^t.ReverseSolution)==t.Area$1(s)>0&&t.ReversePolyPtLinks(s.Pts)):t.Poly2ContainsPoly1(o.Pts,s.Pts)?(s.IsHole=o.IsHole,o.IsHole=!s.IsHole,s.FirstLeft=o.FirstLeft,o.FirstLeft=s,t.m_UsingPolyTree&&t.FixupFirstLefts2(o,s),(o.IsHole^t.ReverseSolution)==t.Area$1(o)>0&&t.ReversePolyPtLinks(o.Pts)):(s.IsHole=o.IsHole,s.FirstLeft=o.FirstLeft,t.m_UsingPolyTree&&t.FixupFirstLefts1(o,s))):(s.Pts=null,s.BottomPt=null,s.Idx=o.Idx,o.IsHole=i.IsHole,i===s&&(o.FirstLeft=s.FirstLeft),s.FirstLeft=o,t.m_UsingPolyTree&&t.FixupFirstLefts3(s,o))))}},wl.Clipper.prototype.UpdateOutPtIdxs=function(t){var e=t.Pts;do{e.Idx=t.Idx,e=e.Prev}while(e!==t.Pts)},wl.Clipper.prototype.DoSimplePolygons=function(){for(var t=this,e=0;e<this.m_PolyOuts.length;){var n=t.m_PolyOuts[e++],i=n.Pts;if(null!==i&&!n.IsOpen)do{for(var r=i.Next;r!==n.Pts;){if(wl.FPoint.op_Equality(i.Pt,r.Pt)&&r.Next!==i&&r.Prev!==i){var o=i.Prev,s=r.Prev;i.Prev=s,s.Next=i,r.Prev=o,o.Next=r,n.Pts=i;var a=t.CreateOutRec();a.Pts=r,t.UpdateOutPtIdxs(a),t.Poly2ContainsPoly1(a.Pts,n.Pts)?(a.IsHole=!n.IsHole,a.FirstLeft=n,t.m_UsingPolyTree&&t.FixupFirstLefts2(a,n)):t.Poly2ContainsPoly1(n.Pts,a.Pts)?(a.IsHole=n.IsHole,n.IsHole=!a.IsHole,a.FirstLeft=n.FirstLeft,n.FirstLeft=a,t.m_UsingPolyTree&&t.FixupFirstLefts2(n,a)):(a.IsHole=n.IsHole,a.FirstLeft=n.FirstLeft,t.m_UsingPolyTree&&t.FixupFirstLefts1(n,a)),r=i}r=r.Next}i=i.Next}while(i!==n.Pts)}},wl.Clipper.Area=function(t){if(!Array.isArray(t))return 0;var e=t.length;if(e<3)return 0;for(var n=0,i=0,r=e-1;i<e;++i)n+=(t[r].X+t[i].X)*(t[r].Y-t[i].Y),r=i;return.5*-n},wl.Clipper.prototype.Area=function(t){var e=t;if(null===t)return 0;var n=0;do{n+=(t.Prev.Pt.X+t.Pt.X)*(t.Prev.Pt.Y-t.Pt.Y),t=t.Next}while(t!==e);return.5*n},wl.Clipper.prototype.Area$1=function(t){return this.Area(t.Pts)},wl.Clipper.SimplifyPolygon=function(t,e){var n=new Array,i=new wl.Clipper(0);return i.StrictlySimple=!0,i.AddPath(t,wl.PolyType.ptSubject,!0),i.Execute(wl.ClipType.ctUnion,n,e,e),n},wl.Clipper.SimplifyPolygons=function(t,e){typeof e>"u"&&(e=wl.PolyFillType.pftEvenOdd);var n=new Array,i=new wl.Clipper(0);return i.StrictlySimple=!0,i.AddPaths(t,wl.PolyType.ptSubject,!0),i.Execute(wl.ClipType.ctUnion,n,e,e),n},wl.Clipper.DistanceSqrd=function(t,e){var n=t.X-e.X,i=t.Y-e.Y;return n*n+i*i},wl.Clipper.DistanceFromLineSqrd=function(t,e,n){var i=e.Y-n.Y,r=n.X-e.X,o=i*e.X+r*e.Y;return(o=i*t.X+r*t.Y-o)*o/(i*i+r*r)},wl.Clipper.SlopesNearCollinear=function(t,e,n,i){return Math.abs(t.X-e.X)>Math.abs(t.Y-e.Y)?t.X>e.X==t.X<n.X?wl.Clipper.DistanceFromLineSqrd(t,e,n)<i:e.X>t.X==e.X<n.X?wl.Clipper.DistanceFromLineSqrd(e,t,n)<i:wl.Clipper.DistanceFromLineSqrd(n,t,e)<i:t.Y>e.Y==t.Y<n.Y?wl.Clipper.DistanceFromLineSqrd(t,e,n)<i:e.Y>t.Y==e.Y<n.Y?wl.Clipper.DistanceFromLineSqrd(e,t,n)<i:wl.Clipper.DistanceFromLineSqrd(n,t,e)<i},wl.Clipper.PointsAreClose=function(t,e,n){var i=t.X-e.X,r=t.Y-e.Y;return i*i+r*r<=n},wl.Clipper.ExcludeOp=function(t){var e=t.Prev;return e.Next=t.Next,t.Next.Prev=e,e.Idx=0,e},wl.Clipper.CleanPolygon=function(t,e){typeof e>"u"&&(e=1.415);var n=t.length;if(0===n)return new Array;for(var i=new Array(n),r=0;r<n;++r)i[r]=new wl.OutPt;for(r=0;r<n;++r)i[r].Pt=t[r],i[r].Next=i[(r+1)%n],i[r].Next.Prev=i[r],i[r].Idx=0;for(var o=e*e,s=i[0];0===s.Idx&&s.Next!==s.Prev;)wl.Clipper.PointsAreClose(s.Pt,s.Prev.Pt,o)?(s=wl.Clipper.ExcludeOp(s),n--):wl.Clipper.PointsAreClose(s.Prev.Pt,s.Next.Pt,o)?(wl.Clipper.ExcludeOp(s.Next),s=wl.Clipper.ExcludeOp(s),n-=2):wl.Clipper.SlopesNearCollinear(s.Prev.Pt,s.Pt,s.Next.Pt,o)?(s=wl.Clipper.ExcludeOp(s),n--):(s.Idx=1,s=s.Next);n<3&&(n=0);var a=new Array(n);for(r=0;r<n;++r)a[r]=new wl.FPoint1(s.Pt),s=s.Next;return i=null,a},wl.Clipper.CleanPolygons=function(t,e){for(var n=new Array(t.length),i=0,r=t.length;i<r;i++)n[i]=wl.Clipper.CleanPolygon(t[i],e);return n},wl.Clipper.Minkowski=function(t,e,n,i){var r=i?1:0,o=t.length,s=e.length,a=new Array;if(n)for(var l=0;l<s;l++){for(var u=new Array(o),h=0,c=t.length,p=t[h];h<c;p=t[++h])u[h]=new wl.FPoint2(e[l].X+p.X,e[l].Y+p.Y);a.push(u)}else for(l=0;l<s;l++){for(u=new Array(o),h=0,c=t.length,p=t[h];h<c;p=t[++h])u[h]=new wl.FPoint2(e[l].X-p.X,e[l].Y-p.Y);a.push(u)}var d=new Array;for(l=0;l<s-1+r;l++)for(h=0;h<o;h++){var f=new Array;f.push(a[l%s][h%o]),f.push(a[(l+1)%s][h%o]),f.push(a[(l+1)%s][(h+1)%o]),f.push(a[l%s][(h+1)%o]),wl.Clipper.Orientation(f)||f.reverse(),d.push(f)}return d},wl.Clipper.MinkowskiSum=function(t,e,n){if(e[0]instanceof Array){for(var i=e,r=new wl.Paths,o=new wl.Clipper,s=0;s<i.length;++s){var a=wl.Clipper.Minkowski(t,i[s],!0,n);if(o.AddPaths(a,wl.PolyType.ptSubject,!0),n){var l=wl.Clipper.TranslatePath(i[s],t[0]);o.AddPath(l,wl.PolyType.ptClip,!0)}}return o.Execute(wl.ClipType.ctUnion,r,wl.PolyFillType.pftNonZero,wl.PolyFillType.pftNonZero),r}return l=e,i=wl.Clipper.Minkowski(t,l,!0,n),(o=new wl.Clipper).AddPaths(i,wl.PolyType.ptSubject,!0),o.Execute(wl.ClipType.ctUnion,i,wl.PolyFillType.pftNonZero,wl.PolyFillType.pftNonZero),i},wl.Clipper.TranslatePath=function(t,e){for(var n=new wl.Path,i=0;i<t.length;i++)n.push(new wl.FPoint2(t[i].X+e.X,t[i].Y+e.Y));return n},wl.Clipper.MinkowskiDiff=function(t,e){var n=wl.Clipper.Minkowski(t,e,!1,!0),i=new wl.Clipper;return i.AddPaths(n,wl.PolyType.ptSubject,!0),i.Execute(wl.ClipType.ctUnion,n,wl.PolyFillType.pftNonZero,wl.PolyFillType.pftNonZero),n},wl.Clipper.PolyTreeToPaths=function(t){var e=new Array;return wl.Clipper.AddPolyNodeToPaths(t,wl.Clipper.NodeType.ntAny,e),e},wl.Clipper.AddPolyNodeToPaths=function(t,e,n){var i=!0;switch(e){case wl.Clipper.NodeType.ntOpen:return;case wl.Clipper.NodeType.ntClosed:i=!t.IsOpen}t.m_polygon.length>0&&i&&n.push(t.m_polygon);for(var r=0,o=t.Childs(),s=o.length,a=o[r];r<s;a=o[++r])wl.Clipper.AddPolyNodeToPaths(a,e,n)},wl.Clipper.OpenPathsFromPolyTree=function(t){for(var e=new wl.Paths,n=0,i=t.ChildCount();n<i;n++)t.Childs()[n].IsOpen&&e.push(t.Childs()[n].m_polygon);return e},wl.Clipper.ClosedPathsFromPolyTree=function(t){var e=new wl.Paths;return wl.Clipper.AddPolyNodeToPaths(t,wl.Clipper.NodeType.ntClosed,e),e},Pl(wl.Clipper,wl.ClipperBase),wl.Clipper.NodeType={ntAny:0,ntOpen:1,ntClosed:2},wl.ClipperOffset=function(t,e){typeof t>"u"&&(t=2),typeof e>"u"&&(e=wl.ClipperOffset.def_arc_tolerance),this.m_destPolys=new wl.Paths,this.m_srcPoly=new wl.Path,this.m_destPoly=new wl.Path,this.m_normals=new Array,this.m_delta=0,this.m_sinA=0,this.m_sin=0,this.m_cos=0,this.m_miterLim=0,this.m_StepsPerRad=0,this.m_lowest=new wl.FPoint0,this.m_polyNodes=new wl.PolyNode,this.MiterLimit=t,this.ArcTolerance=e,this.m_lowest.X=-1},wl.ClipperOffset.two_pi=6.28318530717959,wl.ClipperOffset.def_arc_tolerance=.25,wl.ClipperOffset.prototype.Clear=function(){wl.Clear(this.m_polyNodes.Childs()),this.m_lowest.X=-1},wl.ClipperOffset.prototype.AddPath=function(t,e,n){var i=t.length-1;if(!(i<0)){var r=new wl.PolyNode;if(r.m_jointype=e,r.m_endtype=n,n===wl.EndType.etClosedLine||n===wl.EndType.etClosedPolygon)for(;i>0&&wl.FPoint.op_Equality(t[0],t[i]);)i--;r.m_polygon.push(t[0]);for(var o=0,s=0,a=1;a<=i;a++)wl.FPoint.op_Inequality(r.m_polygon[o],t[a])&&(o++,r.m_polygon.push(t[a]),(t[a].Y>r.m_polygon[s].Y||t[a].Y===r.m_polygon[s].Y&&t[a].X<r.m_polygon[s].X)&&(s=o));if(!(n===wl.EndType.etClosedPolygon&&o<2)&&(this.m_polyNodes.AddChild(r),n===wl.EndType.etClosedPolygon))if(this.m_lowest.X<0)this.m_lowest=new wl.FPoint2(this.m_polyNodes.ChildCount()-1,s);else{var l=this.m_polyNodes.Childs()[this.m_lowest.X].m_polygon[this.m_lowest.Y];(r.m_polygon[s].Y>l.Y||r.m_polygon[s].Y===l.Y&&r.m_polygon[s].X<l.X)&&(this.m_lowest=new wl.FPoint2(this.m_polyNodes.ChildCount()-1,s))}}},wl.ClipperOffset.prototype.AddPaths=function(t,e,n){for(var i=0,r=t.length;i<r;i++)this.AddPath(t[i],e,n)},wl.ClipperOffset.prototype.FixOrientations=function(){if(this.m_lowest.X>=0&&!wl.Clipper.Orientation(this.m_polyNodes.Childs()[this.m_lowest.X].m_polygon))for(var t=0;t<this.m_polyNodes.ChildCount();t++)((e=this.m_polyNodes.Childs()[t]).m_endtype===wl.EndType.etClosedPolygon||e.m_endtype===wl.EndType.etClosedLine&&wl.Clipper.Orientation(e.m_polygon))&&e.m_polygon.reverse();else for(t=0;t<this.m_polyNodes.ChildCount();t++){var e;(e=this.m_polyNodes.Childs()[t]).m_endtype===wl.EndType.etClosedLine&&!wl.Clipper.Orientation(e.m_polygon)&&e.m_polygon.reverse()}},wl.ClipperOffset.GetUnitNormal=function(t,e){var n=e.X-t.X,i=e.Y-t.Y;if(0===n&&0===i)return new wl.FPoint2(0,0);var r=1/Math.sqrt(n*n+i*i);return n*=r,i*=r,new wl.FPoint2(i,-n)},wl.ClipperOffset.prototype.DoOffset=function(t){var e=this;if(this.m_destPolys=new Array,this.m_delta=t,wl.ClipperBase.near_zero(t))for(var n=0;n<this.m_polyNodes.ChildCount();n++)(o=e.m_polyNodes.Childs()[n]).m_endtype===wl.EndType.etClosedPolygon&&e.m_destPolys.push(o.m_polygon);else{var i;this.MiterLimit>2?this.m_miterLim=2/(this.MiterLimit*this.MiterLimit):this.m_miterLim=.5,i=this.ArcTolerance<=0?wl.ClipperOffset.def_arc_tolerance:this.ArcTolerance>Math.abs(t)*wl.ClipperOffset.def_arc_tolerance?Math.abs(t)*wl.ClipperOffset.def_arc_tolerance:this.ArcTolerance;var r=3.14159265358979/Math.acos(1-i/Math.abs(t));for(this.m_sin=Math.sin(wl.ClipperOffset.two_pi/r),this.m_cos=Math.cos(wl.ClipperOffset.two_pi/r),this.m_StepsPerRad=r/wl.ClipperOffset.two_pi,t<0&&(this.m_sin=-this.m_sin),n=0;n<this.m_polyNodes.ChildCount();n++){var o=e.m_polyNodes.Childs()[n];e.m_srcPoly=o.m_polygon;var s=e.m_srcPoly.length;if(!(0===s||t<=0&&(s<3||o.m_endtype!==wl.EndType.etClosedPolygon))){if(e.m_destPoly=new Array,1===s){if(o.m_jointype===wl.JoinType.jtRound)for(var a=1,l=0,u=1;u<=r;u++){e.m_destPoly.push(new wl.FPoint2(e.m_srcPoly[0].X+a*t,e.m_srcPoly[0].Y+l*t));var h=a;a=a*e.m_cos-e.m_sin*l,l=h*e.m_sin+l*e.m_cos}else for(a=-1,l=-1,u=0;u<4;++u)e.m_destPoly.push(new wl.FPoint2(e.m_srcPoly[0].X+a*t,e.m_srcPoly[0].Y+l*t)),a<0?a=1:l<0?l=1:a=-1;e.m_destPolys.push(e.m_destPoly);continue}for(e.m_normals.length=0,u=0;u<s-1;u++)e.m_normals.push(wl.ClipperOffset.GetUnitNormal(e.m_srcPoly[u],e.m_srcPoly[u+1]));if(o.m_endtype===wl.EndType.etClosedLine||o.m_endtype===wl.EndType.etClosedPolygon?e.m_normals.push(wl.ClipperOffset.GetUnitNormal(e.m_srcPoly[s-1],e.m_srcPoly[0])):e.m_normals.push(new wl.FPoint1(e.m_normals[s-2])),o.m_endtype===wl.EndType.etClosedPolygon){var c=s-1;for(u=0;u<s;u++)c=e.OffsetPoint(u,c,o.m_jointype);e.m_destPolys.push(e.m_destPoly)}else if(o.m_endtype===wl.EndType.etClosedLine){for(c=s-1,u=0;u<s;u++)c=e.OffsetPoint(u,c,o.m_jointype);e.m_destPolys.push(e.m_destPoly),e.m_destPoly=new Array;var p=e.m_normals[s-1];for(u=s-1;u>0;u--)e.m_normals[u]=new wl.FPoint2(-e.m_normals[u-1].X,-e.m_normals[u-1].Y);for(e.m_normals[0]=new wl.FPoint2(-p.X,-p.Y),c=0,u=s-1;u>=0;u--)c=e.OffsetPoint(u,c,o.m_jointype);e.m_destPolys.push(e.m_destPoly)}else{for(c=0,u=1;u<s-1;++u)c=e.OffsetPoint(u,c,o.m_jointype);var d;for(o.m_endtype===wl.EndType.etOpenButt?(u=s-1,d=new wl.FPoint2(e.m_srcPoly[u].X+e.m_normals[u].X*t,e.m_srcPoly[u].Y+e.m_normals[u].Y*t),e.m_destPoly.push(d),d=new wl.FPoint2(e.m_srcPoly[u].X-e.m_normals[u].X*t,e.m_srcPoly[u].Y-e.m_normals[u].Y*t),e.m_destPoly.push(d)):(u=s-1,c=s-2,e.m_sinA=0,e.m_normals[u]=new wl.FPoint2(-e.m_normals[u].X,-e.m_normals[u].Y),o.m_endtype===wl.EndType.etOpenSquare?e.DoSquare(u,c):e.DoRound(u,c)),u=s-1;u>0;u--)e.m_normals[u]=new wl.FPoint2(-e.m_normals[u-1].X,-e.m_normals[u-1].Y);for(e.m_normals[0]=new wl.FPoint2(-e.m_normals[1].X,-e.m_normals[1].Y),u=(c=s-1)-1;u>0;--u)c=e.OffsetPoint(u,c,o.m_jointype);o.m_endtype===wl.EndType.etOpenButt?(d=new wl.FPoint2(e.m_srcPoly[0].X-e.m_normals[0].X*t,e.m_srcPoly[0].Y-e.m_normals[0].Y*t),e.m_destPoly.push(d),d=new wl.FPoint2(e.m_srcPoly[0].X+e.m_normals[0].X*t,e.m_srcPoly[0].Y+e.m_normals[0].Y*t),e.m_destPoly.push(d)):(c=1,e.m_sinA=0,o.m_endtype===wl.EndType.etOpenSquare?e.DoSquare(0,1):e.DoRound(0,1)),e.m_destPolys.push(e.m_destPoly)}}}}},wl.ClipperOffset.prototype.Execute=function(){var t=arguments;if(t[0]instanceof wl.PolyTree){var e=t[1];if((a=t[0]).Clear(),this.FixOrientations(),this.DoOffset(e),(o=new wl.Clipper(0)).AddPaths(this.m_destPolys,wl.PolyType.ptSubject,!0),e>0)o.Execute(wl.ClipType.ctUnion,a,wl.PolyFillType.pftPositive,wl.PolyFillType.pftPositive);else{var n=wl.Clipper.GetBounds(this.m_destPolys);if((s=new wl.Path).push(new wl.FPoint2(n.left-10,n.bottom+10)),s.push(new wl.FPoint2(n.right+10,n.bottom+10)),s.push(new wl.FPoint2(n.right+10,n.top-10)),s.push(new wl.FPoint2(n.left-10,n.top-10)),o.AddPath(s,wl.PolyType.ptSubject,!0),o.ReverseSolution=!0,o.Execute(wl.ClipType.ctUnion,a,wl.PolyFillType.pftNegative,wl.PolyFillType.pftNegative),1===a.ChildCount()&&a.Childs()[0].ChildCount()>0){var i=a.Childs()[0];a.Childs()[0]=i.Childs()[0],a.Childs()[0].m_Parent=a;for(var r=1;r<i.ChildCount();r++)a.AddChild(i.Childs()[r])}else a.Clear()}}else{var o,s,a=t[0];if(e=t[1],wl.Clear(a),this.FixOrientations(),this.DoOffset(e),(o=new wl.Clipper(0)).AddPaths(this.m_destPolys,wl.PolyType.ptSubject,!0),e>0)o.Execute(wl.ClipType.ctUnion,a,wl.PolyFillType.pftPositive,wl.PolyFillType.pftPositive);else n=wl.Clipper.GetBounds(this.m_destPolys),(s=new wl.Path).push(new wl.FPoint2(n.left-10,n.bottom+10)),s.push(new wl.FPoint2(n.right+10,n.bottom+10)),s.push(new wl.FPoint2(n.right+10,n.top-10)),s.push(new wl.FPoint2(n.left-10,n.top-10)),o.AddPath(s,wl.PolyType.ptSubject,!0),o.ReverseSolution=!0,o.Execute(wl.ClipType.ctUnion,a,wl.PolyFillType.pftNegative,wl.PolyFillType.pftNegative),a.length>0&&a.splice(0,1)}},wl.ClipperOffset.prototype.OffsetPoint=function(t,e,n){if(this.m_sinA=this.m_normals[e].X*this.m_normals[t].Y-this.m_normals[t].X*this.m_normals[e].Y,0===this.m_sinA)return e;if(this.m_sinA>1?this.m_sinA=1:this.m_sinA<-1&&(this.m_sinA=-1),this.m_sinA*this.m_delta<0)this.m_destPoly.push(new wl.FPoint2(this.m_srcPoly[t].X+this.m_normals[e].X*this.m_delta,this.m_srcPoly[t].Y+this.m_normals[e].Y*this.m_delta)),this.m_destPoly.push(new wl.FPoint1(this.m_srcPoly[t])),this.m_destPoly.push(new wl.FPoint2(this.m_srcPoly[t].X+this.m_normals[t].X*this.m_delta,this.m_srcPoly[t].Y+this.m_normals[t].Y*this.m_delta));else switch(n){case wl.JoinType.jtMiter:var i=this.m_normals[t].X*this.m_normals[e].X+this.m_normals[t].Y*this.m_normals[e].Y+1;i>=this.m_miterLim?this.DoMiter(t,e,i):this.DoSquare(t,e);break;case wl.JoinType.jtSquare:this.DoSquare(t,e);break;case wl.JoinType.jtRound:this.DoRound(t,e)}return t},wl.ClipperOffset.prototype.DoSquare=function(t,e){var n=Math.tan(Math.atan2(this.m_sinA,this.m_normals[e].X*this.m_normals[t].X+this.m_normals[e].Y*this.m_normals[t].Y)/4);this.m_destPoly.push(new wl.FPoint2(this.m_srcPoly[t].X+this.m_delta*(this.m_normals[e].X-this.m_normals[e].Y*n),this.m_srcPoly[t].Y+this.m_delta*(this.m_normals[e].Y+this.m_normals[e].X*n))),this.m_destPoly.push(new wl.FPoint2(this.m_srcPoly[t].X+this.m_delta*(this.m_normals[t].X+this.m_normals[t].Y*n),this.m_srcPoly[t].Y+this.m_delta*(this.m_normals[t].Y-this.m_normals[t].X*n)))},wl.ClipperOffset.prototype.DoMiter=function(t,e,n){var i=this.m_delta/n;this.m_destPoly.push(new wl.FPoint2(this.m_srcPoly[t].X+(this.m_normals[e].X+this.m_normals[t].X)*i,this.m_srcPoly[t].Y+(this.m_normals[e].Y+this.m_normals[t].Y)*i))},wl.ClipperOffset.prototype.DoRound=function(t,e){for(var n,i=this,r=Math.atan2(this.m_sinA,this.m_normals[e].X*this.m_normals[t].X+this.m_normals[e].Y*this.m_normals[t].Y),o=Math.max(Math.round(this.m_StepsPerRad*Math.abs(r)),1),s=this.m_normals[e].X,a=this.m_normals[e].Y,l=0;l<o;++l)i.m_destPoly.push(new wl.FPoint2(i.m_srcPoly[t].X+s*i.m_delta,i.m_srcPoly[t].Y+a*i.m_delta)),n=s,s=s*i.m_cos-i.m_sin*a,a=n*i.m_sin+a*i.m_cos;this.m_destPoly.push(new wl.FPoint2(this.m_srcPoly[t].X+this.m_normals[t].X*this.m_delta,this.m_srcPoly[t].Y+this.m_normals[t].Y*this.m_delta))},wl.Error=function(t){try{throw new Error(t)}catch(t){alert(t.message)}},wl.JS={},wl.JS.AreaOfPolygon=function(t){return wl.Clipper.Area(t)},wl.JS.AreaOfPolygons=function(t){for(var e=0,n=0;n<t.length;n++)e+=wl.Clipper.Area(t[n]);return e},wl.JS.BoundsOfPath=function(t){return wl.JS.BoundsOfPaths([t])},wl.JS.BoundsOfPaths=function(t){return wl.Clipper.GetBounds(t)},wl.JS.Clean=function(t,e){if(!(t instanceof Array))return[];var n=t[0]instanceof Array;if(t=wl.JS.Clone(t),"number"!=typeof e||null===e)return wl.Error("Delta is not a number in Clean()."),t;if(0===t.length||1===t.length&&0===t[0].length||e<0)return t;n||(t=[t]);for(var i,r,o,s,a,l,u,h=t.length,c=[],p=0;p<h;p++)if(0!==(i=(r=t[p]).length)){if(i<3){o=r,c.push(o);continue}for(o=r,s=e*e,a=r[0],l=1,u=1;u<i;u++)(r[u].X-a.X)*(r[u].X-a.X)+(r[u].Y-a.Y)*(r[u].Y-a.Y)<=s||(o[l]=r[u],a=r[u],l++);a=r[l-1],(r[0].X-a.X)*(r[0].X-a.X)+(r[0].Y-a.Y)*(r[0].Y-a.Y)<=s&&l--,l<i&&o.splice(l,i-l),o.length&&c.push(o)}return!n&&c.length?c=c[0]:n||0!==c.length?n&&0===c.length&&(c=[[]]):c=[],c},wl.JS.Clone=function(t){if(!(t instanceof Array))return[];if(0===t.length)return[];if(1===t.length&&0===t[0].length)return[[]];var e=t[0]instanceof Array;e||(t=[t]);var n,i,r,o,s=t.length,a=new Array(s);for(i=0;i<s;i++){for(n=t[i].length,o=new Array(n),r=0;r<n;r++)o[r]={X:t[i][r].X,Y:t[i][r].Y};a[i]=o}return e||(a=a[0]),a},wl.JS.Lighten=function(t,e){if(!(t instanceof Array))return[];if("number"!=typeof e||null===e)return wl.Error("Tolerance is not a number in Lighten()."),wl.JS.Clone(t);if(0===t.length||1===t.length&&0===t[0].length||e<0)return wl.JS.Clone(t);var n=t[0]instanceof Array;n||(t=[t]);var i,r,o,s,a,l,u,h,c,p,d,f,m,y,g,v,_=t.length,x=e*e,b=[];for(i=0;i<_;i++)if(0!==(l=(o=t[i]).length)){for(s=0;s<1e6;s++){for(a=[],o[(l=o.length)-1].X!==o[0].X||o[l-1].Y!==o[0].Y?(d=1,o.push({X:o[0].X,Y:o[0].Y}),l=o.length):d=0,p=[],r=0;r<l-2;r++)u=o[r],c=o[r+1],h=o[r+2],g=u.X,v=u.Y,f=h.X-g,m=h.Y-v,(0!==f||0!==m)&&((y=((c.X-g)*f+(c.Y-v)*m)/(f*f+m*m))>1?(g=h.X,v=h.Y):y>0&&(g+=f*y,v+=m*y)),(f=c.X-g)*f+(m=c.Y-v)*m<=x&&(p[r+1]=1,r++);for(a.push({X:o[0].X,Y:o[0].Y}),r=1;r<l-1;r++)p[r]||a.push({X:o[r].X,Y:o[r].Y});if(a.push({X:o[l-1].X,Y:o[l-1].Y}),d&&o.pop(),!p.length)break;o=a}a[(l=a.length)-1].X===a[0].X&&a[l-1].Y===a[0].Y&&a.pop(),a.length>2&&b.push(a)}return n||(b=b[0]),typeof b>"u"&&(b=[]),b},wl.JS.PerimeterOfPath=function(t,e){if(typeof t>"u")return 0;var n,i,r=Math.sqrt,o=0,s=0,a=0,l=0,u=0,h=t.length;if(h<2)return 0;for(e&&(t[h]=t[0],h++);--h;)s=(n=t[h]).X,a=n.Y,o+=r((s-(l=(i=t[h-1]).X))*(s-l)+(a-(u=i.Y))*(a-u));return e&&t.pop(),o},wl.JS.PerimeterOfPaths=function(t,e){for(var n=0,i=0;i<t.length;i++)n+=wl.JS.PerimeterOfPath(t[i],e);return n},wl.ExPolygons=function(){return[]},wl.ExPolygon=function(){this.outer=null,this.holes=null},wl.JS.AddOuterPolyNodeToExPolygons=function(t,e){var n=new wl.ExPolygon;n.outer=t.Contour();var i,r,o,s,a,l,u=t.Childs(),h=u.length;for(n.holes=new Array(h),o=0;o<h;o++)for(i=u[o],n.holes[o]=i.Contour(),s=0,l=(a=i.Childs()).length;s<l;s++)r=a[s],wl.JS.AddOuterPolyNodeToExPolygons(r,e);e.push(n)},wl.JS.ExPolygonsToPaths=function(t){var e,n,i,r,o=new wl.Paths;for(e=0,i=t.length;e<i;e++)for(o.push(t[e].outer),n=0,r=t[e].holes.length;n<r;n++)o.push(t[e].holes[n]);return o},wl.JS.PolyTreeToExPolygons=function(t){var e,n,i,r,o=new wl.ExPolygons;for(n=0,r=(i=t.Childs()).length;n<r;n++)e=i[n],wl.JS.AddOuterPolyNodeToExPolygons(e,o);return o};var El=wl,Tl={exports:{}};function Sl(t,e){return t<e?-1:t>e?1:0}var Cl=function(t){var e=t.default;if("function"==typeof e){var n=function(){return e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach((function(e){var i=Object.getOwnPropertyDescriptor(t,e);Object.defineProperty(n,e,i.get?i:{enumerable:!0,get:function(){return t[e]}})})),n}(Object.freeze({__proto__:null,default:class{constructor(t=[],e=Sl){if(this.data=t,this.length=this.data.length,this.compare=e,this.length>0)for(let t=(this.length>>1)-1;t>=0;t--)this._down(t)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const t=this.data[0],e=this.data.pop();return this.length--,this.length>0&&(this.data[0]=e,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:e,compare:n}=this,i=e[t];for(;t>0;){const r=t-1>>1,o=e[r];if(n(i,o)>=0)break;e[t]=o,t=r}e[t]=i}_down(t){const{data:e,compare:n}=this,i=this.length>>1,r=e[t];for(;t<i;){let i=1+(t<<1),o=e[i];const s=i+1;if(s<this.length&&n(e[s],o)<0&&(i=s,o=e[s]),n(o,r)>=0)break;e[t]=o,t=i}e[t]=r}}})),Il=Cl;function Al(t,e,n){e=e||1;for(var i,r,o,s,a=0;a<t[0].length;a++){var l=t[0][a];(!a||l[0]<i)&&(i=l[0]),(!a||l[1]<r)&&(r=l[1]),(!a||l[0]>o)&&(o=l[0]),(!a||l[1]>s)&&(s=l[1])}var u=o-i,h=s-r,c=Math.min(u,h),p=c/2;if(0===c){var d=[i,r];return d.distance=0,d}for(var f=new Il(void 0,Ol),m=i;m<o;m+=c)for(var y=r;y<s;y+=c)f.push(new Nl(m+p,y+p,p,t));var g=function(t){for(var e=0,n=0,i=0,r=t[0],o=0,s=r.length,a=s-1;o<s;a=o++){var l=r[o],u=r[a],h=l[0]*u[1]-u[0]*l[1];n+=(l[0]+u[0])*h,i+=(l[1]+u[1])*h,e+=3*h}return 0===e?new Nl(r[0][0],r[0][1],0,t):new Nl(n/e,i/e,0,t)}(t),v=new Nl(i+u/2,r+h/2,0,t);v.d>g.d&&(g=v);for(var _=f.length;f.length;){var x=f.pop();x.d>g.d&&(g=x,n&&console.log("found best %d after %d probes",Math.round(1e4*x.d)/1e4,_)),!(x.max-g.d<=e)&&(p=x.h/2,f.push(new Nl(x.x-p,x.y-p,p,t)),f.push(new Nl(x.x+p,x.y-p,p,t)),f.push(new Nl(x.x-p,x.y+p,p,t)),f.push(new Nl(x.x+p,x.y+p,p,t)),_+=4)}n&&(console.log("num probes: "+_),console.log("best distance: "+g.d));var b=[g.x,g.y];return b.distance=g.d,b}function Ol(t,e){return e.max-t.max}function Nl(t,e,n,i){this.x=t,this.y=e,this.h=n,this.d=function(t,e,n){for(var i=!1,r=1/0,o=0;o<n.length;o++)for(var s=n[o],a=0,l=s.length,u=l-1;a<l;u=a++){var h=s[a],c=s[u];h[1]>e!=c[1]>e&&t<(c[0]-h[0])*(e-h[1])/(c[1]-h[1])+h[0]&&(i=!i),r=Math.min(r,Ll(t,e,h,c))}return 0===r?0:(i?1:-1)*Math.sqrt(r)}(t,e,i),this.max=this.d+this.h*Math.SQRT2}function Ll(t,e,n,i){var r=n[0],o=n[1],s=i[0]-r,a=i[1]-o;if(0!==s||0!==a){var l=((t-r)*s+(e-o)*a)/(s*s+a*a);l>1?(r=i[0],o=i[1]):l>0&&(r+=s*l,o+=a*l)}return(s=t-r)*s+(a=e-o)*a}Il.default&&(Il=Il.default),Tl.exports=Al,Tl.exports.default=Al;var Ml=typeof Float32Array<"u"?Float32Array:Array;function Rl(){var t=new Ml(6);return Ml!=Float32Array&&(t[1]=0,t[2]=0,t[4]=0,t[5]=0),t[0]=1,t[3]=1,t}function kl(){var t=new Ml(3);return Ml!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function Dl(t,e,n){var i=new Ml(3);return i[0]=t,i[1]=e,i[2]=n,i}function Fl(){var t=new Ml(4);return Ml!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function Bl(){var t=new Ml(2);return Ml!=Float32Array&&(t[0]=0,t[1]=0),t}function Ul(t,e){var n=new Ml(2);return n[0]=t,n[1]=e,n}function zl(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[2]*r+n[4],t[1]=n[1]*i+n[3]*r+n[5],t}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)}),kl(),function(){var t=new Ml(4);Ml!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0)}(),kl(),Dl(1,0,0),Dl(0,1,0),Fl(),Fl(),function(){var t=new Ml(9);Ml!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1}(),Bl();var Xl={exports:{}};function Yl(){}Yl.prototype={on:function(t,e,n){var i=this.e||(this.e={});return(i[t]||(i[t]=[])).push({fn:e,ctx:n}),this},once:function(t,e,n){var i=this;function r(){i.off(t,r),e.apply(n,arguments)}return r._=e,this.on(t,r,n)},emit:function(t){for(var e=[].slice.call(arguments,1),n=((this.e||(this.e={}))[t]||[]).slice(),i=0,r=n.length;i<r;i++)n[i].fn.apply(n[i].ctx,e);return this},off:function(t,e){var n=this.e||(this.e={}),i=n[t],r=[];if(i&&e)for(var o=0,s=i.length;o<s;o++)i[o].fn!==e&&i[o].fn._!==e&&r.push(i[o]);return r.length?n[t]=r:delete n[t],this}},Xl.exports=Yl;var Gl=Xl.exports.TinyEmitter=Yl,Hl={exports:{}};!function(t){var e=function(){var t={},e=Math.PI/180,n=180/Math.PI,i=6378137,r=20037508.342789244;function o(t){return Number(t)===t&&t%1!=0}function s(e){if(e=e||{},this.size=e.size||256,this.expansion=!0===e.antimeridian?2:1,!t[this.size]){var n=this.size,i=t[this.size]={};i.Bc=[],i.Cc=[],i.zc=[],i.Ac=[];for(var r=0;r<30;r++)i.Bc.push(n/360),i.Cc.push(n/(2*Math.PI)),i.zc.push(n/2),i.Ac.push(n),n*=2}this.Bc=t[this.size].Bc,this.Cc=t[this.size].Cc,this.zc=t[this.size].zc,this.Ac=t[this.size].Ac}return s.prototype.px=function(t,n){if(o(n)){var i=this.size*Math.pow(2,n),r=i/2,s=i/360,a=i/(2*Math.PI),l=i,u=Math.min(Math.max(Math.sin(e*t[1]),-.9999),.9999),h=r+t[0]*s,c=r+.5*Math.log((1+u)/(1-u))*-a;return h>l*this.expansion&&(h=l*this.expansion),c>l&&(c=l),[h,c]}return r=this.zc[n],u=Math.min(Math.max(Math.sin(e*t[1]),-.9999),.9999),h=Math.round(r+t[0]*this.Bc[n]),c=Math.round(r+.5*Math.log((1+u)/(1-u))*-this.Cc[n]),h>this.Ac[n]*this.expansion&&(h=this.Ac[n]*this.expansion),c>this.Ac[n]&&(c=this.Ac[n]),[h,c]},s.prototype.ll=function(t,e){if(o(e)){var i=this.size*Math.pow(2,e),r=i/360,s=i/(2*Math.PI),a=i/2,l=(t[1]-a)/-s;return[(t[0]-a)/r,n*(2*Math.atan(Math.exp(l))-.5*Math.PI)]}return l=(t[1]-this.zc[e])/-this.Cc[e],[(t[0]-this.zc[e])/this.Bc[e],n*(2*Math.atan(Math.exp(l))-.5*Math.PI)]},s.prototype.bbox=function(t,e,n,i,r){i&&(e=Math.pow(2,n)-1-e);var o=[t*this.size,(+e+1)*this.size],s=[(+t+1)*this.size,e*this.size],a=this.ll(o,n).concat(this.ll(s,n));return"900913"===r?this.convert(a,"900913"):a},s.prototype.xyz=function(t,e,n,i){"900913"===i&&(t=this.convert(t,"WGS84"));var r=[t[0],t[1]],o=[t[2],t[3]],s=this.px(r,e),a=this.px(o,e),l=[Math.floor(s[0]/this.size),Math.floor((a[0]-1)/this.size)],u=[Math.floor(a[1]/this.size),Math.floor((s[1]-1)/this.size)],h={minX:Math.min.apply(Math,l)<0?0:Math.min.apply(Math,l),minY:Math.min.apply(Math,u)<0?0:Math.min.apply(Math,u),maxX:Math.max.apply(Math,l),maxY:Math.max.apply(Math,u)};if(n){var c={minY:Math.pow(2,e)-1-h.maxY,maxY:Math.pow(2,e)-1-h.minY};h.minY=c.minY,h.maxY=c.maxY}return h},s.prototype.convert=function(t,e){return"900913"===e?this.forward(t.slice(0,2)).concat(this.forward(t.slice(2,4))):this.inverse(t.slice(0,2)).concat(this.inverse(t.slice(2,4)))},s.prototype.forward=function(t){var n=[i*t[0]*e,i*Math.log(Math.tan(.25*Math.PI+.5*t[1]*e))];return n[0]>r&&(n[0]=r),n[0]<-r&&(n[0]=-r),n[1]>r&&(n[1]=r),n[1]<-r&&(n[1]=-r),n},s.prototype.inverse=function(t){return[t[0]*n/i,(.5*Math.PI-2*Math.atan(Math.exp(-t[1]/i)))*n]},s}();t.exports=e}(Hl);var Wl,jl=Hl.exports;function Vl(t,e){e||(e={x:0,z:0});const n=function(t,e){return{x:t.x-e.x,z:t.z-e.z}}(e,t);return Math.sqrt(n.x*n.x+n.z*n.z)}function ql(t){const e=Vl(t);return{x:t.x/e,z:t.z/e}}function $l(t){const e=ru(t),n=El.Clipper.GetBounds(e);return{x:n.left,x2:n.right,z:n.top,z2:n.bottom,length:n.right-n.left,width:n.bottom-n.top}}function Zl(t){if(!Array.isArray(t))throw new Error("Union failed, input not Array");if(!t.length||!t[0])throw new Error("Union failed, empty Array");const e=ru(t),n=[e[0]],i=e.slice(1),r=new El.Clipper;r.AddPaths(n,El.PolyType.ptSubject,!0),r.AddPaths(i,El.PolyType.ptClip,!0);var o=new El.Paths;return r.Execute(El.ClipType.ctUnion,o,El.PolyFillType.pftNonZero,El.PolyFillType.pftNonZero),ou(o)}function Kl(t,e=.1,n,i){if(void 0===n&&(n=El.EndType.etClosedPolygon),!(t=i?t:nu(t)).length||!t[0].length)return[];e=e&&"number"==typeof e?e:.1;const r=ru(t),o=new El.ClipperOffset(2),s=new El.Paths;return o.AddPaths(r,El.JoinType.jtMiter,n),o.Execute(s,e),ou(s)}function Ql(t=[],e=[],n=!1){if(!Array.isArray(t))throw new Error("Intersection failed, input not Array");if(!t.length||!t[0])throw new Error("Intersection failed, empty Array");const i=ru(t),r=e.length&&ru(e),o=r?i:[i[0]],s=r||i.slice(1),a=new El.Clipper;a.AddPaths(o,El.PolyType.ptSubject,!n),a.AddPaths(s,El.PolyType.ptClip,!0);var l=El.PolyFillType.pftNonZero,u=El.PolyFillType.pftNonZero,h=El.ClipType.ctIntersection,c=n?new El.PolyTree:new El.Paths;return a.Execute(h,c,l,u),ou(n?El.Clipper.PolyTreeToPaths(c):c)}function Jl(t,e,n=[]){const i=new El.FPoint(t[0],t[1]),r=ru([e])[0];let o=El.Clipper.PointInPolygon(i,r);return n.forEach((e=>{let n=Jl(t,e);1===n?o=0:-1===n&&(o=-1)})),o}function tu(t){let e=ru([t]);return El.JS.AreaOfPolygon(e[0])}function eu(t){return Math.abs(tu(t))}function nu(t,e=.01){let n=ru(t);return ou(El.Clipper.CleanPolygons(n,e))}function iu(t,e=.01){return nu([t],e)[0]}function ru(t=[]){let e=[];for(var n=0;n<t.length;n++){var i=t[n]||[];e[n]=[];for(var r=0;r<i.length;r++){var o=i[r];Number.isFinite(o[0])&&Number.isFinite(o[1])?e[n][r]={X:o[0],Y:o[1]}:console.warn("invalid number",o[0],o[1])}}const s=[];for(const t of e)t.length?s.push(t):console.warn("empty polygon");if(!s.length)throw new Error("empty polygon invalid input");return s}function ou(t){let e=[];for(var n=0;n<t.length;n++){var i=t[n]||[];e[n]=[];for(var r=0;r<i.length;r++){var o=i[r];e[n][r]=[o.X,o.Y]}}return e}function su(t,e=[]){return eu(t)<.1?function(t){const{min:e,max:n}=function(t){let e=[1/0,1/0],n=[-1/0,-1/0];return t.forEach((t=>{t[0]<e[0]&&(e[0]=t[0]),t[1]<e[1]&&(e[1]=t[1]),t[0]>n[0]&&(n[0]=t[0]),t[1]>n[1]&&(n[1]=t[1])})),{min:e,max:n}}(t);return[e[0]+(n[0]-e[0])/2,e[1]+(n[1]-e[1])/2]}(t):Tl.exports([t,...e],.1)}function au(t,e,n=!1){let i=0,r=e.x,o=e.z;if(e.controlLine&&e.w&&(i="front"===e.controlLine?e.w:"center"===e.controlLine?e.w/2:0),i){let t=e.ry/180*Math.PI;r-=i*Math.sin(t),o-=i*Math.cos(t)}const s=t.ry||0,a=e.ry||0,l=Ul(t.x,t.z),u=Ul(r,o),h=-a*Math.PI/180;let c=Rl(),p=Bl();(function(t,e){t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1]})(c,u),function(t,e,n){var i=e[0],r=e[1],o=e[2],s=e[3],a=e[4],l=e[5],u=Math.sin(n),h=Math.cos(n);t[0]=i*h+o*u,t[1]=r*h+s*u,t[2]=i*-u+o*h,t[3]=r*-u+s*h,t[4]=a,t[5]=l}(c,c,h),zl(p,l,c);const d={x:p[0],z:p[1],y:t.y+e.y||0,ry:s+a};return n?Object.assign(t,d):Object.assign({},t,d)}function lu(t){let e,n,i;return"column"===t.type?n=function(t){if("column"!==t.type)return;let e=[];if("square"===t.shape){let n=t.l/2;e=[[-n,-n],[n,-n],[n,n],[-n,n]],e=uu(t,e)}else if("circle"===t.shape){const n=2*Math.PI/25;let i=0,r=t.l/2;for(let o=0;o<25;o++)e.push([t.x-r*Math.cos(i),t.z+r*Math.sin(i)]),i+=n}else"polygon"===t.shape&&(e=uu(t,t.polygon));return e}(t):(e=function(t){if("object"!=typeof t)throw new Error("Get el data, invalid type");let e,n,i,r,o,s,a,l,u,h,c,p,d,f,m,{x:y,z:g,l:v,ry:_}={...t},x="a:helper:spaceDivider"===t.type;if(!x&&!Number.isFinite(t.w)||!Number.isFinite(v)||!Number.isFinite(y)||!Number.isFinite(g)){let e={type:t.type,id:t.id,x:y,z:g,l:v,ry:_,w:t.w};throw new Error(`Get el vectors, params missing ${JSON.stringify(e)}`)}return e=_/180*Math.PI,n=t.barCounter?t.w+.25:t.w,x&&(n=0),o={x:n*Math.sin(e),z:n*Math.cos(e)},s=x?o:ql(o),a={x:v*Math.cos(e),z:-v*Math.sin(e)},l=ql(a),i=t.barCounter?y+-.25*s.x:y,r=t.barCounter?g+-.25*s.z:g,m=0,"front"===t.controlLine?m=-t.w:"center"===t.controlLine&&(m=-t.w/2),d={x:i,z:r},f={x:i+a.x,z:r+a.z},u={x:d.x+s.x*m,z:d.z+s.z*m},h={x:u.x+a.x,z:u.z+a.z},c={x:u.x+o.x,z:u.z+o.z},p={x:h.x+o.x,z:h.z+o.z},{l1:d,l2:f,p1:u,p2:h,p3:c,p4:p,w:o,l:a,nW:s,nL:l}}(t),i="a:helper:spaceDivider"===t.type?[e.l1,e.l2]:[e.p1,e.p2,e.p4,e.p3],n=i.map((t=>[t.x,t.z]))),n}function uu(t,e){return e.map((e=>{let n=au({x:e[0],z:e[1]},t);return[n.x,n.z]}))}!function(t){t[t.etOpenSquare=0]="etOpenSquare",t[t.etOpenRound=1]="etOpenRound",t[t.etOpenButt=2]="etOpenButt",t[t.etClosedLine=3]="etClosedLine",t[t.etClosedPolygon=4]="etClosedPolygon"}(Wl||(Wl={}));const hu=(t,e={})=>{let n={};const i=e.keepTransient;return Object.keys(t).forEach((e=>{let r="_"===e.slice(0,1);"_ryOrg"!==e?r&&!i||null!==t[e]&&void 0!==t[e]&&"children"!==e&&(n[e]=t[e]):n.ry=t[e]})),t.children?n.children=t.children.map((t=>hu(t,e))):n.children=[],n};function cu({uuid:t,scene:e,node:n}){if(!(n=n||e.nodesById[t]))return[];let i=n.getWorldPosition();if(!i.polygon||!i.polygon.length)throw new Error("Invalid space"+JSON.stringify(i,null,2));let r=function(t){let e=[...t];return tu(e)>0?e:e.reverse()}(i.polygon);if(r=iu(r),!r||!r.length)return[];let o=i.polygonHoles||[];return o=o.map((t=>{let e=function(t){let e=[...t];return tu(e)<0?e:e.reverse()}(t);return iu(e)})).filter((t=>t.length)),o=o.filter((t=>t.length)),[uu(i,r),...o.map((t=>uu(i,t)))]}function pu(t,e="",n=!1,i,r){const o={"a:helper:spaceDivider":["plan","level","group"],wall:["plan","level","group"],interior:["plan","level","interior","group","level"],window:["plan","level","wall"],door:["plan","level","wall"],polyfloor:["plan","level"],group:["plan","level","group"]};let s=n?function(t){return w(hu(t))}(t):t;var a,l=[];if(n&&i&&(s=au(s,i)),r||s.type!==e){if(r&&s.id===r)return[s]}else l.push(s);let u=0;if(s.children&&(!o[e]||o[e].includes(s.type)))for(var h=0;h<s.children.length;h++){const t=s.children[h];"level"===t.type&&u++,!(u>1)&&(a=pu(t,e,n,s,r),l=l.concat(a))}return l}function du(t,e){return pu(t,e,!0)}const fu=["a:helper:spaceDivider","a:reference:externalId","a:reference:ifcElement","a:reference:ifcFile","a:relation:wall","a:settings:display","a:settings:generatedGroup","box","camera-bookmark","closet","column","curtain","door","floor","floorplan","floorplanDxf","group","interior","kitchen","level","object","pic","plan","polybox","polyfloor","railing","stairs","tag","wall","window"],mu=()=>fu.reduce(((t,e)=>({...t,[e]:[]})),{}),yu=(t,e)=>{if(!e||!e.properties)return void console.warn(`schema is missing for type ${t}`);const n={};return Object.keys(e.properties).forEach((t=>{const i=e.properties[t],r=i.const||i.default;void 0!==r&&(n[t]=r)})),"interior"===t&&!n.src&&(n.src="!7dddc882-1def-4497-80e3-d1de834a1a7b"),w(n)};function gu(t,e={}){const n=vu(t,{});return bu(t,null,null,n),e.exportIdMap&&(t.idMap=n),t}function vu(t,e){return void 0!==t.id&&(e[t.id]=gt()),t.children.forEach((t=>vu(t,e))),e}const _u=t=>"[object Object]"===Object.prototype.toString.call(t),xu=t=>"[object Array]"===Object.prototype.toString.call(t);function bu(t,e,n,i){"string"==typeof t?(void 0!==e&&void 0!==n&&i[t]&&(e[n]=i[t]),"string"==typeof n&&void 0!==e&&void 0!==n&&i[n]&&(e[i[n]]=t,delete e[n])):(_u(t)||xu(t))&&(_u(t)&&t.type&&void 0===t.id&&(t.id=gt()),Object.entries(t).forEach((([e,n])=>bu(n,t,e,i))))}const wu={properties:{x:{type:"number"},y:{type:"number"},z:{type:"number"},ry:{type:"number"},id:{type:"string"}}},Pu=(t,e,n,i)=>"number"===i.type?((t,e,n,i)=>{let r=n;if("string"==typeof n&&(r=Number(r),console.log(t.type+"."+e,"converted from string to number")),!Number.isFinite(r))throw new Error(`${t.type}.${e} = ${n} is invalid`);const{minimum:o,maximum:s}=i,a=Number.isFinite(o)&&r<o,l=Number.isFinite(s)&&r>s;if(a||l){let n=a?"min:"+o:"max:"+s;throw new Error(`${t.type}.${e} = ${r} is out of range ${n}`)}return r})(t,e,n,i):"string"===i.type?((t,e,n,i)=>{if("string"!=typeof n)throw new Error(`${t.type}.${e} = '${n}' is invalid`);if(i.enum&&!i.enum.includes(n))throw new Error(`${t.type}.${e} = '${n}' is invalid`);return n})(t,e,n,i):n,Eu=(t,e,n)=>{const{properties:i}=n||wu;for(const r in e){const o=i?.[r],s=n&&!o,a=r.startsWith("_");!s||a?(t[r]=Pu(t,r,e[r],o||{type:void 0}),a&&!t[r]&&delete t[r]):delete e[r]}return t},Tu={colorDiffuse:{type:"array"},colorSpecular:{type:"array"},wireframeColor:{type:"array"},size:{type:"array"},specularCoef:{type:"number"},opacity:{type:"number"},wireframeOpacity:{type:"number"},wireframeThickness:{type:"number"},wireframeThresholdAngle:{type:"number"},lightEmissionCoef:{type:"number"},bsdfType:{type:"string"},wrap:{type:"string"},receiveRealTimeShadows:{type:"boolean"},hideAfterBaking:{type:"boolean"},castRealTimeShadows:{type:"boolean"},no2dOutline:{type:"boolean"},mapDiffuse:{type:"string"},mapDiffusePreview:{type:"string"},mapDiffuseSource:{type:"string"},mapDiffuseKey:{type:"string"},mapSpecular:{type:"string"},mapSpecularPreview:{type:"string"},mapSpecularSource:{type:"string"},mapSpecularKey:{type:"string"},mapNormal:{type:"string"},mapNormalPreview:{type:"string"},mapNormalSource:{type:"string"},mapNormalKey:{type:"string"},mapAlpha:{type:"string"},mapAlphaPreview:{type:"string"},mapAlphaSource:{type:"string"},mapAlphaKey:{type:"string"}},Su=t=>{let e=typeof t;return null===t?"null":"object"===e&&Array.isArray(t)?"array":"number"!==e||Number.isFinite(t)?e:"undefined"},Cu=Object.keys(Tu),Iu=t=>{const e=Su(t),n="string"===e,i="object"===e&&Object.keys(t).every((e=>{var n;const i=Cu.includes(e),r=i&&Su(t[e])===(null==(n=Tu[e])?void 0:n.type);return i&&r}));return n||i};function Au(t,e){let n=function(t={},e=[]){let n=e?.length&&e[0].split(":")[0],i=Object.keys(t);return n&&"default"!==n&&(i=i.filter((t=>t===n))),1===i.length?i[0]:i.filter((t=>!t.toLowerCase().includes("base")))[0]}(t.materials,e?.colours);return n&&Ou(t.materials[n])}function Ou(t){return t&&"string"==typeof t?t.toLowerCase().replace(/[()+&!?;,:_)]/g,"").replace(/\s+/g,"-"):""}const Nu={group:"a:settings:generatedGroup"};class Lu{}class Mu extends Lu{constructor({node:t,parent:e,scene:n,emitter:i,options:r={}}){var o;if(super(),"object"!=typeof t)throw new Error("node has to be type object: "+t);if(!t.type)throw new Error("node invalid, type is missing: "+JSON.stringify(t));void 0===r.setDefaults&&(r.setDefaults=!1),void 0===r.regenerateIds&&(r.regenerateIds=!1),this._scene=n,this._emitter=i;const s=t.children||[];t.children=[],!t.id||r.setDefaults||r.regenerateIds?this._update(Du(t,this.schema,r)):this._update(t),this._parent=e,e&&e.children.push(this),null!=(o=this._scene)&&o.registerNode&&this._scene.registerNode(this);const a="add-child";this._emitter&&this._emitter.emit(a,{node:e,args:this,options:r,event:a}),s.filter((t=>(t.type||console.warn("Prevent import from scene structure: Invalid type",t.type+""),t.type))).forEach((t=>this.addChild(t,r)))}get parent(){return this._parent}get scene(){return this._scene}get schema(){var t;return null==(t=this._scene)?void 0:t.schema}_update(t={}){var e,n;Eu(this,t,null==(n=null==(e=this._scene)?void 0:e.schema)?void 0:n[this.type])}set(t={},e={}){if(this.locked&&!e.force){let e=[];for(let n in t)switch(n){case"locked":case"_highlight":case"_isSelected":e.push(n)}if(!(e.length>0))return void console.log(`Node ID ${this.id} is locked and cannot be altered.`);{let n={};for(const i of e)n[i]=t[i];t=n}}t.id&&delete t.id,t.src&&delete t.src,t.children&&delete t.children;let n={};for(let e in t)n[e]=this[e];try{this._update(t)}catch(t){return void console.warn(t.message)}if(this._emitter){let i=0,r=0;for(let e in t)switch(t[e]===n[e]&&(delete t[e],delete n[e]),i++,e){case"x":case"y":case"z":case"ry":r++}const o=r===i?"set-transform":"set";Object.keys(t).length&&this._emitter.emit(o,{node:this,args:t,prevState:n,options:e,event:o})}}setTransform({x:t,y:e,z:n,ry:i}={},r={}){if(this.locked&&!r.force)return void console.log(`Node ID ${this.id} is locked and cannot be altered.`);let o={},s={};if(void 0!==t){let e=Number(t);this.x!==e&&Number.isFinite(e)&&(s.x=this.x,o.x=this.x=e)}if(void 0!==e){let t=Number(e);this.y!==t&&Number.isFinite(t)&&(s.y=this.y,o.y=this.y=t)}if(void 0!==n){let t=Number(n);this.z!==t&&Number.isFinite(t)&&(s.z=this.z,o.z=this.z=t)}if(void 0!==i){let t=Number(i);this.ry!==t&&Number.isFinite(t)&&(s.ry=this.ry,o.ry=this.ry=t)}const a="set-transform";this._emitter&&Object.keys(o).length&&this._emitter.emit(a,{node:this,args:o,prevState:s,options:r,event:a})}setMaterials(t={},e={}){if(this.locked&&!e.force)return void console.log(`Node ID ${this.id} is locked and cannot set materials.`);let n=0,i={};for(let e in t){const r=t[e];Iu(r)&&(i[e]=(this.materials||{})[e],t[e],n++)}if(n<1)return void console.log("no valid material definitions in",t);const r={...this.materials||{},...t};try{this._update({materials:r})}catch(t){return void console.warn(t.message)}const o="set-materials";this._emitter&&this._emitter.emit(o,{node:this,args:t,prevState:i,options:e,event:o})}setTransient(t={},e={}){let n={},i=0,r={};for(let e in t)"_"===e[0]&&(r[e]=this[e],n[e]=t[e],i++);if(i<1)return void console.log("no transient values in",t,"use underscore");try{this._update({...n})}catch(t){return void console.warn(t.message)}const o="set-transient";this._emitter&&this._emitter.emit(o,{node:this,args:t,prevState:r,options:e,event:o})}setHighlight(t={},e={}){let n={_highlight:this._highlight};const{fill:i,fillOpacity:r,outline:o,outlineWidth:s}=t;let a;i&&Array.isArray(i)&&(a={fill:i,fillOpacity:r}),o&&Array.isArray(o)&&(a={...a||{},outline:o,outlineWidth:s});const l={_highlight:a};try{this._update(l)}catch(t){return void console.warn(t.message)}const u="set-transient";this._emitter&&this._emitter.emit(u,{node:this,args:l,prevState:n,options:e,event:u})}find(t={}){if(!(t.id||t.type&&"string"==typeof t.type&&fu.includes(t.type)))return console.warn("type missing or invalid"),null;let e;return this.traverse((n=>{e||(t.id&&n.id===t.id||t.type&&n.type===t.type)&&(e=n)})),e}findAll(t={}){if(!t.type||"string"!=typeof t.type||!fu.includes(t.type))return console.warn("type missing or invalid"),[];let e=[];return this.traverse((n=>n.type===t.type&&e.push(n))),e}addChild(t,e={}){var n,i,r;if(!t.type||"string"!=typeof t.type||!fu.includes(t.type))return void console.warn("type missing or invalid");if(this.locked&&!["level","plan"].includes(this.type)&&!e.force)return void console.log(`Node ID ${this.id} is locked and cannot add children.`);if(t.id&&(null==(i=null==(n=this.scene)?void 0:n.nodesById)?void 0:i[t.id])&&!e.regenerateIds)return void console.warn(`Node with id ${t.id} already exists and can not be added - use options.regenerateIds = true`);const o=!1!==e.setDefaults;let s;if(o){const e=null==(r=this.schema)?void 0:r[t.type],n=yu(t.type,e)||{};s=Eu(n,t,e)}else s=t;return new Mu({node:s,parent:this,scene:this._scene,emitter:this._emitter,options:{...e,setDefaults:o}})}removeChild(t,e={}){var n;if(!t.id)return void console.error("not valid");if(this.locked&&!["level","plan"].includes(this.type)&&!e.force)return void console.log(`Node ID ${this.id} is locked and cannot remove children.`);let i;for(let e=0;e<this.children.length;e++)if(this.children[e].id===t.id){i=e;break}if(!Number.isFinite(i))return void console.warn("Node does not exist or is already removed",t);let r=t.children||[];for(let n=r.length-1;n>=0;n--)t instanceof Mu&&r[n]&&t.removeChild(r[n],e);null!=(n=this._scene)&&n.unregisterNode&&this._scene.unregisterNode(t),this.children.splice(i,1);const o="remove-child";this._emitter&&this._emitter.emit(o,{node:this,args:t,options:e,event:o}),(t?.getReferringNodes?t.getReferringNodes():[]).forEach((t=>t.remove(e)))}remove(t){!this.locked||t.force?this.parent.removeChild(this,t):console.warn(`Node ID ${this.id} is locked and cannot be removed.`)}getReferringNodes(){var t,e;let n=[],i=null==(t=this._scene)?void 0:t.nodesByType["a:relation:"+this.type];i&&i.forEach((t=>{var e;null!=(e=t?.nodeIds)&&e.hasOwnProperty(this.id)&&n.push(t)}));let r=Nu[this.type]||"a:settings:"+this.type,o=null==(e=this._scene)?void 0:e.nodesByType[r];return o&&o.forEach((t=>{t?.nodeId==this.id&&n.push(t)})),n}getWorldPosition(){return Ru(this)}getLocalPositionFromWorld(t){const e=this.getParents();return e?.length&&e.reverse().forEach((e=>{t=function(t,e,n=!1){let i=0,r=e.x,o=e.z;if(e.controlLine&&e.w&&(i="front"===e.controlLine?e.w:"center"===e.controlLine?e.w/2:0),i){let t=e.ry/180*Math.PI;r-=i*Math.sin(t),o-=i*Math.cos(t)}const s=t.ry||0,a=e.ry||0,l=Ul(t.x,t.z),u=Ul(r,o),h=a*Math.PI/180;let c=Rl(),p=Bl(),d=Bl();(function(t,e){t[0]=-e[0],t[1]=-e[1]})(d,u),function(t,e){var n=Math.sin(e),i=Math.cos(e);t[0]=i,t[1]=n,t[2]=-n,t[3]=i,t[4]=0,t[5]=0}(c,h),function(t,e,n){var i=e[0],r=e[1],o=e[2],s=e[3],a=e[4],l=e[5],u=n[0],h=n[1];t[0]=i,t[1]=r,t[2]=o,t[3]=s,t[4]=i*u+o*h+a,t[5]=r*u+s*h+l}(c,c,d),zl(p,l,c);const f={x:p[0],z:p[1],y:t.y-e.y||0,ry:s-a};return n?Object.assign(t,f):Object.assign({},t,f)}(t,e)})),t}getParents(){return ku(this)}toJson(t={}){let e=w(hu(this,t));return t.regenerateIds&&gu(e,t),e}traverse(t){"function"==typeof t&&(t(this),this.children.forEach((e=>{e.traverse(t)})))}}const Ru=(t,e)=>{const n=e?e.parent:t.parent;if(!n)return console.warn("no parent found"),t;let i=au(t,n);return n.parent&&(i=Ru(i,n)),i},ku=t=>{let e=[];const n=t.parent;return n&&e.push(n),n?.parent&&(e=e.concat(ku(n))),e},Du=(t,e,{setDefaults:n,regenerateIds:i})=>{if(!e&&n)throw new Error("schema is missing");if(!t)throw new Error("node missing");const r=e&&e[t.type];let o;if(r&&n){if(o=yu(t.type,r),!o)throw new Error("no defaults found")}else o={};let s=Object.assign({},o,t);if(!s)throw new Error("applying defaults failed");return(!t.id||i)&&(s.id=gt()),s};var Fu;!function(t){t.residential="residential",t.office="office",t.parking="parking"}(Fu||(Fu={}));const Bu={work:{name:"Work",isHidden:!0,description:"space for individual head-down work",spaceUsage:{privateOffice:{name:"Private office",category:[Fu.office]},focusRoom:{name:"Focus room",category:[Fu.office]},openWorkspace:{name:"Open workspace",category:[Fu.office]},enclosedWorkspace:{name:"Enclosed workspace",category:[Fu.office]},closedWorkspace:{name:"Closed workspace",isDeprecated:!0,category:[Fu.office]},executiveOffice:{name:"Executive office",isDeprecated:!0,category:[Fu.office]}}},meet:{name:"Meet",isHidden:!0,spaceUsage:{meetingRoom:{name:"Meeting room",category:[Fu.office]},hub:{name:"Hub",category:[Fu.office]},assembly:{name:"Assembly",category:[Fu.office]},boardRoom:{name:"Board room",category:[Fu.office]},trainingRoom:{name:"Training room",category:[Fu.office]},collaboration:{name:"Collaboration",isDeprecated:!0,category:[Fu.office]}}},live:{name:"live",isHidden:!0,spaceUsage:{living:{name:"Living",category:[Fu.residential]},dining:{name:"Dining",category:[Fu.residential]},dining_living:{name:"Living & Dining",category:[Fu.residential]},homeOffice:{name:"Home office",category:[Fu.residential]},bedroom:{name:"Bedroom",category:[Fu.residential]}}},socialize:{name:"Socialize",isHidden:!0,spaceUsage:{lobby:{name:"Lobby",category:[Fu.office,Fu.residential]},reception:{name:"Reception",category:[Fu.office]},lounge:{name:"Lounge",category:[Fu.office]},cafe:{name:"Cafe",category:[Fu.office]},canteen:{name:"Canteen",category:[Fu.office]},pantry:{name:"Pantry",category:[Fu.office]},terrace:{name:"Terrace",isOutdoor:!0,category:[Fu.office,Fu.residential]},balcony:{name:"Balcony",isOutdoor:!0,category:[Fu.office,Fu.residential]},rooftop:{name:"Rooftop",isOutdoor:!0,category:[Fu.office,Fu.residential]},courtyard:{name:"Courtyard",isOutdoor:!0,category:[Fu.office,Fu.residential]},garden:{name:"Garden",isOutdoor:!0,category:[Fu.residential]},common:{name:"Common",isDeprecated:!0,category:[Fu.office]}}},support:{name:"Support",isHidden:!0,spaceUsage:{serviceKitchen:{name:"Service kitchen",category:[Fu.office]},printStation:{name:"Print station",category:[Fu.office]},storage:{name:"Storage",category:[Fu.residential,Fu.office,Fu.parking]},mailRoom:{name:"Mail room",category:[Fu.office]},operationalRoom:{name:"Operational room",category:[Fu.office,Fu.parking]},serviceRoom:{name:"Service room",category:[Fu.office]},laundryRoom:{name:"Laundry room",category:[Fu.residential]},operate:{name:"Operate",isDeprecated:!0,category:[Fu.office]},services:{name:"Services",isDeprecated:!0,category:[Fu.office,Fu.residential]}}},care:{name:"Care",isHidden:!0,spaceUsage:{kitchen:{name:"Kitchen",category:[Fu.residential]},wellnessRoom:{name:"Wellness room",category:[Fu.office]},restroom:{name:"Restroom",category:[Fu.office,Fu.parking]},bathroom:{name:"Bathroom",category:[Fu.residential]},shower:{name:"Shower",category:[Fu.office,Fu.residential]},toilet:{name:"Toilet",category:[Fu.residential]}}},circulate:{name:"Circulate",isHidden:!0,spaceUsage:{corridor:{name:"Corridor",category:[Fu.residential,Fu.office,Fu.parking]},foyer:{name:"Foyer",category:[Fu.residential,Fu.office,Fu.parking]},staircase:{name:"Staircase",isVertical:!0,category:[Fu.residential,Fu.office,Fu.parking]},elevator:{name:"Elevator",isVertical:!0,category:[Fu.residential,Fu.office,Fu.parking]}}},drive:{name:"Drive",isHidden:!0,spaceUsage:{parkingSpot:{name:"Parking spot",category:[Fu.parking]},driveway:{name:"Driveway",category:[Fu.parking]},garage:{name:"Garage",category:[Fu.residential]}}},void:{isHidden:!0,name:"Void",spaceUsage:{shaft:{name:"Shaft",isVertical:!0,category:[Fu.residential,Fu.office,Fu.parking]},buildingOpening:{name:"Building opening",isVertical:!0,category:[Fu.residential,Fu.office,Fu.parking]},floorOpening:{name:"Floor opening",isVertical:!0,category:[Fu.residential,Fu.office,Fu.parking]}}},undefined:{isHidden:!0,spaceUsage:{undefined:{name:"Undefined",category:[Fu.residential,Fu.office],isHidden:!0}}}},Uu={};Object.keys(Bu).forEach((t=>{const e=Bu[t];Uu[t]={name:e.name,type:"program",category:[]},e.isHidden&&(Uu[t].isHidden=e.isHidden);const n={};Object.keys(Bu[t].spaceUsage).forEach((e=>{const i=Bu[t].spaceUsage[e];Uu[e]={...i,type:"space",program:t},i.category.forEach((t=>{n[t]=!0}))})),Uu[t].category=Object.keys(n)}));const zu=(t="")=>{"officeWorking"===t?t="work":"officeMeeting"===t&&(t="meet");let e=Uu[t];return e?e.name:""},Xu=(t="")=>{const e=Uu[t];let n;return e&&(n="program"===e.type?t:e.program),n};function Yu({scene:t,uuid:e}){let n=t.nodesByType.polyfloor;e&&(n=n.filter((t=>t.id===e)));const i=t.nodesByType.interior.map((t=>t.getWorldPosition()));return n.map((e=>{let n=cu({node:e});if(!n.length)return;const r=Math.abs(n.reduce(((t,e)=>t+tu(e)),0)),o=su(n[0],n.slice(1)),s=$l(n),{interiors:a}=function({uuid:t,polygons:e,scene:n,interiors:i}){let r;r=e&&e.length?e:cu({uuid:t,scene:n});let o=r[0],s=r.slice(1);return o=Kl([o],.05)[0],i||(i=n.nodesByType.interior.map((t=>t.getWorldPosition()))),{interiors:i.filter((t=>{if(t.src&&t.x&&t.z)return Jl([t.x,t.z],o,s)}))}}({polygons:n,scene:t,interiors:i});return{node:e,boundingBox:s,id:e.id,usage:e.usage,usageName:zu(e.usage),program:Xu(e.usage),polygons:n,interiors:a,area:r,center:o,customId:e.customId,name:e.name}})).flatMap((t=>t?[t]:[]))}const Gu=(t,e=!0,n=!1)=>{const i=t.nodesByType.column.map((t=>t.getWorldPosition())),r=[...t.nodesByType.wall.map((t=>t.getWorldPosition())),...i].map((t=>{let i=lu(t);if(e&&(i=Kl([i],.001)[0]),n)return[i];let r=du(t,"window"),o=du(t,"door"),s=r.concat(o);return s=s.map((e=>(e.w=t.w,e))),s?.length?function(t,e){if(!Array.isArray(t))throw new Error("Difference failed, input not Array");if(!t.length||!t[0])throw new Error("Difference failed, empty Array");const n=ru(t),i=ru(Kl(e,.002)),r=new El.Clipper;r.AddPaths(n,El.PolyType.ptSubject,!0),r.AddPaths(i,El.PolyType.ptClip,!0);var o=new El.Paths;return r.Execute(El.ClipType.ctDifference,o,El.PolyFillType.pftNonZero,El.PolyFillType.pftNonZero),ou(o)}([i],s.map(lu)):[i]})).reduce(((t,e)=>t.concat(e)),[]),o=r.length?Zl(r):[],{counterClockwise:s,clockwise:a}=function(t){return{counterClockwise:t.filter((t=>tu(t)>0)),clockwise:t.filter((t=>tu(t)<0))}}(o),l=function(t,e){const n=[],i=t.map(eu),r=e.map(eu);for(let o=0;o<t.length;o++){let s=t[o];for(let t=0;t<e.length;t++)i[o]>r[t]+.1&&Jl(e[t][0],s)&&(n[t]?i[n[t]]>i[o]&&(n[t]=o):n[t]=o)}const o=[];return n.forEach(((t,n)=>{o[t]||(o[t]=[]),o[t].push(e[n])})),o}(s,a);return s.map(((t,e)=>[t,...l[e]||[]]))},Hu={spaceContourAreaThreshold:.1};class Wu{constructor({schema:t,options:e={}}={}){this.sceneId=null,this.node=null,this._apiVersion="3.5.2",this.nodesById={},this.nodesByType=mu(),this.nodesByName={},this.options={...Hu,...e},this._schema=t||{},this._emitter=new Gl}get emitter(){return this._emitter}get schema(){return this._schema}set schema(t){"object"==typeof t&&(this._schema=t)}loadSceneStructure(t,e={}){if(this._emitter.emit("scene-structure-loading",this),!t||"plan"!==t.type)throw new Error("invalid sceneStructure");this.nodesById={},this.nodesByType=mu(),this.node=null;let n=w(t);return Number.isFinite(e.planRotation)&&(n._ryOrg=t.ry,n.ry=e.planRotation),this.node=new Mu({node:n,scene:this,emitter:this.emitter,options:e}),this.setSpaceCategories(),this._emitter.emit("scene-structure-loaded",this),this.node}setSceneType(){this.setSpaceCategories()}_setSceneType(){const t=this.node.class;if(t?.length)t.includes(Fu.residential)?this.type=Fu.residential:t.includes("commercial")||t.includes(Fu.office)?this.type=Fu.office:t.includes(Fu.parking)&&(this.type=Fu.parking);else{const t=this.nodesByType.polyfloor.map((t=>t.usage));t.includes("bedroom")?this.type=Fu.residential:(t.includes("work")||t.includes("meetingRoom")||t.includes("openWorkspace"))&&(this.type=Fu.office)}}setSpaceCategories(){let t=[];const e=this.node.class;if(e?.length)t=Array.from(e.reduce(((t,e)=>("commercial"===e?t.add(Fu.office):Fu[e]&&t.add(Fu[e]),t)),new Set));else{const e=this.nodesByType.polyfloor.map((t=>t.usage));e.includes("bedroom")&&t.push(Fu.residential),(e.includes("work")||e.includes("meetingRoom")||e.includes("openWorkspace"))&&t.push(Fu.office)}this.spaceCategories=t,this._setSceneType()}getFloorArea(){const t=Yu({scene:this}).reduce(((t,e)=>"void"===e.program?t:t+e.area),0);return Math.round(10*t)/10}registerNode(t){this.nodesById[t.id]&&console.error("Duplicate id",t.id),this.nodesById[t.id]=t,this.nodesByType[t.type]=this.nodesByType[t.type]||[],this.nodesByType[t.type].push(t),t.name&&(this.nodesByName[t.name]=this.nodesByName[t.name]||[],this.nodesByName[t.name].push(t))}unregisterNode(t){t.id&&delete this.nodesById[t.id];const e=(e,n)=>{if(e[t[n]]){let i=e[t[n]].findIndex((e=>e.id===t.id));Number.isFinite(i)&&e[t[n]].splice(i,1)}};e(this.nodesByType,"type"),e(this.nodesByName,"name")}on(t,e,n){t&&e?this._emitter.on(t,e,n):console.log("invalid event listener")}once(t,e,n){t&&e?this._emitter.once(t,e,n):console.log("invalid event listener")}off(t,e){t?this._emitter.off(t,e):console.log("invalid request")}emit(t,e,n,i,r){this._emitter.emit(t,e,n,i,r)}get apiVersion(){return this._apiVersion}}function ju(t,e){return{type:"line",start:t,end:e}}function Vu(t,e,n,i){return{type:"rectangle",position:t,dimensions:[e,n],style:i}}function qu(t,e,n){return{type:"circle",position:t,radius:e,style:n}}function $u(t,e,n=.5){let i=[e[0]-t[0],e[1]-t[1]];return[t[0]+i[0]*n,t[1]+i[1]*n]}function Zu(t,e,n,i=5){const r=[];let o,s,a,l=0;for(let u=0;u<=i;++u)l=u/i,o=$u(t,e,l),s=$u(e,n,l),a=$u(o,s,l),r.push(a);return r}const Ku=(t,e)=>{const n=Math.ceil(48/(2*Math.PI)*t*e),i=Math.ceil(12/(2*Math.PI)*t);return Math.min(100,Math.max(i,n))},Qu=t=>{const e={type:"polygon",points:[]};switch(t.type){case"circle":const n=t.radius,i=Ku(2*Math.PI,n),r=t.position,o=2*Math.PI/i;let s=0;for(let t=0;t<i;t++)e.points.push([n*Math.cos(s)+r[0],-n*Math.sin(s)+r[1]]),s+=o;break;case"polygon":e.points=t.points;break;case"rectangle":const a=t.dimensions;e.points=[[0,0],[0,a[1]],[a[0],a[1]],[a[0],0]];break;case"composite":for(const n of t.segments){let t=Ju(n);e.points.push(...t.points)}}return e},Ju=t=>{const e={type:"polyline",points:[]};switch(t.type){case"line":e.points=[t.start,t.end];break;case"arc":const n=t.startAngle/180*Math.PI,i=t.endAngle/180*Math.PI-n,r=t.radius,o=Ku(Math.abs(i),r),s=t.position,a=i/o;let l=n;for(let t=0;t<o+1;t++)e.points.push([r*Math.cos(l)+s[0],-r*Math.sin(l)+s[1]]),l+=a;break;case"polyline":e.points=t.points;break;case"quadraticBezier":e.points.push(t.points[0]);for(let n=0;n<=t.points.length-3;n++){let i=t.points[n],r=t.points[n+1],o=t.points[n+2],s=Zu(0===n?i:$u(i,r),r,n===t.points.length-3?o:$u(r,o));e.points.push(...s.slice(1))}}return e};function th(t){return new Promise(((e,n)=>{t.oncomplete=t.onsuccess=()=>e(t.result),t.onabort=t.onerror=()=>n(t.error)}))}function eh(t,e){const n=indexedDB.open(t);n.onupgradeneeded=()=>n.result.createObjectStore(e);const i=th(n);return(t,n)=>i.then((i=>n(i.transaction(e,t).objectStore(e))))}let nh;function ih(){return nh||(nh=eh("keyval-store","keyval")),nh}new jl({size:256});const rh={api:{sdkVersion:"5.0.0-beta.0",productDataCacheAge:864e5,productContourCacheAge:864e6},hideElements:[],panZoom:!0,planRotation:0,preserveViewbox:"center-center",roomStampSize:null,showCeilingLamps:!1,xrayMode:!1,destroyOnDomRemove:!1,ui:{scale:!0,coordinates:!1},spaceLabelMapping:{},theme:{fontFamily:"Avenir, Verdana, sans-serif",background:{color:"#f3f5f8",showGrid:!1},wallContours:!1,showAssetTextures:!1,nativeLines:!0,elements:{roomStamp:{showArea:!0,showUsage:!0}}},units:{system:"metric",areaDecimals:0,lengthDecimals:3,roomDimensions:"area"},zoomRange:[3,300]};let oh="archilogic/product",sh="https://storage.3d.io";const ah=async(t,e)=>cl.callSpaceAPIWithConfig("GET",`/v2/floor/${t}/scene-structure`,{},e),lh=t=>ch(`${sh}/${oh}/json/${t}.json`),uh=t=>`${sh}/${oh}/thumb/${t}.png`,hh=t=>ch(`${sh}/${oh}/outline/${t}.json`);function ch(t){return fetch(t).then((t=>{if(t.ok)return t.json();throw Error(t.statusText)}))}const ph=typeof window>"u"||typeof i<"u",dh=!ph&&eh("al-kvs","al-keyval");async function fh(t,e,n){if(ph)return Promise.resolve();n=n||2592e6;try{const i={timeStamp:(new Date).getTime(),content:e,maxAge:n};return await function(t,e,n=ih()){return n("readwrite",(n=>(n.put(e,t),th(n.transaction))))}(t,i,dh),t}catch{return}}async function mh(t,e){if(ph)return Promise.resolve();const n=e||2592e6,i=(new Date).getTime();let r;try{r=await function(t,e=ih()){return e("readonly",(e=>th(e.get(t))))}(t,dh);if(i-r.timeStamp>Math.min(r.maxAge,n))return;if(r.content)return r.content}catch{return}}function yh(t){const e={10:["ceilingLight","wallLight"],9:["modularMeetingRoom","phoneBooth"],8:["floorLamp","tableLamp","deskDivider","cushion","plant","officeSupply","tableware","decoration","laundry","electronics","kitchen","car"],7:["shelf","cabinet","wardrobe","storageCombination","outdoor","bicycle","people","sink"],6:["highTable","diningTable","conferenceTable","desk"],5:["sofa","armchair","loungeChair","ottoman","sideboard","pedestal"],4:["taskChair","diningChair","conferenceChair","stool","barStool","bench"],3:["shower"],2:["singleBed","doubleBed","daybed","toilet","bathtub"],1:["sideTable","coffeeTable","radiator","nightstand"],0:["rug"]};let n=0;return t.subCategories.forEach((t=>{Object.keys(e).forEach((i=>{let r=parseInt(i);e[i].includes(t)&&r>n&&(n=r)}))})),1===n&&t.categories.includes("tables")&&t.boundingBox.height>.6&&(n=6),n}const gh={kitchen:function(t){let e=[];const n=/90$/g.test(t.cooktopType),i=function(t){const e=t.elementLength,n=t.highCabinetLeft*e,i=t.highCabinetRight*e;return Math.max(0,t.l-n-i)}(t),r=function(t,e,n){const i=t.elementLength,r=t.highCabinetLeft*i;let o,s=[],a=0,l=0;for(o=0;o<t.highCabinetLeft;o++){let e=t.l-a;a+=e>i?i:e,s[o]=a,l++}for(;a+i<r+e;)a+=l===t.cooktopPos-1&&"none"!==t.cooktopType&&n?.9:i,l++,s.push(a);for(o=t.highCabinetRight;o>0;o--)a=t.l-i*o+i,s.push(a);return s=s.map((t=>Math.round(10*t)/10)),s}(t,i,n),o=function(t,e){let n,i=[];for(n=0;n<t.highCabinetLeft;n++)i.push(n);for(n=0;n<t.highCabinetRight;n++)i.push(e.length-1-n);return i}(t,r),s=function(t,e){return"number"==typeof t.sinkPos&&t.sinkPos>t.highCabinetLeft&&t.sinkPos<=e.length-t.highCabinetRight&&"none"!==t.sinkType?t.sinkPos:null}(t,r),a=function(t,e){return"number"==typeof t.cooktopPos&&t.cooktopPos>t.highCabinetLeft&&t.cooktopPos<=e.length-t.highCabinetRight&&"none"!==t.cooktopType?t.cooktopPos:null}(t,r);e.push(Vu([0,t.barCounter?-.25:0],t.l,t.barCounter?t.w+.25:t.w)),r.forEach((n=>{e.push(ju([n,t.w],[n,t.w-.075]))})),i&&t.barCounter&&e.push(ju([t.highCabinetLeft*t.elementLength,0],[t.l-t.highCabinetRight*t.elementLength,0]));for(let n of o){const i=r[n],o=i-.6;e.push(ju([o||0,t.w],[o||0,0]),ju([o||0,0],[i,t.w]),ju([o||0,t.w],[i,0]),ju([i,t.w],[i,0]))}const l={fill:!1};if(s&&r[s-2]){let n={type:"group",position:[r[s-2],0],children:[Vu([.05,t.w-.5],"double"!==t.sinkType?.5:1.1,.45,l),Vu([.1,t.w-.4],"double"!==t.sinkType?.4:.35,.3,l),Vu(["double"!==t.sinkType?t.elementLength/2-.02:.48,t.w-.45],.04,.18,l)]};"double"===t.sinkType&&n.children.push(Vu([.55,t.w-.4],.35,.3,l),ju([.95,t.w-.4],[.95,t.w-.1]),ju([1,t.w-.4],[1,t.w-.1]),ju([1.05,t.w-.4],[1.05,t.w-.1]),ju([1.1,t.w-.4],[1.1,t.w-.1])),e.push(n)}if(a&&r[a-2]){let i={type:"group",position:[r[a-2],0],children:[Vu([.05,t.w-.55],n?.8:.5,.5,l)]};n?i.children.push(qu([.225,t.w-.4],.08,l),qu([.675,t.w-.4],.08,l),qu([.45,t.w-.3],.08,l),qu([.225,t.w-.2],.08,l),qu([.675,t.w-.2],.08,l)):i.children.push(qu([.2,t.w-.4],.08,l),qu([.4,t.w-.4],.08,l),qu([.2,t.w-.2],.08,l),qu([.4,t.w-.2],.08,l)),e.push(i)}return i&&t.wallCabinet&&e.push(ju([t.highCabinetLeft*t.elementLength,t.wallCabinetWidth],[t.l-t.highCabinetRight*t.elementLength,t.wallCabinetWidth])),e},column:function(t){let e=[];return"square"===t.shape?e.push({type:"rectangle",position:[-t.l/2,-t.l/2],dimensions:[t.l,t.l]}):"circle"===t.shape?e.push({type:"circle",position:[0,0],radius:t.l/2}):"polygon"===t.shape&&e.push({type:"polygon",points:t.polygon}),e},stairs:function(t,e={}){const n="labelled"!==e.style,i="left"===t.circulation,r=.3;let o=t.stairType||"straight",s=t.l;const a=t.stepWidth;"straightLanding"===t.stairType?s=t.l-1:"lShaped"===t.stairType?s=t.l+t.w-2*a:"winder"===t.stairType?s=t.l+t.w-a:"halfLanding"===t.stairType?s=2*(t.l-a):"2QuarterLanding"===t.stairType?s=2*(t.l-a)+t.w-2*a:"doubleWinder"===t.stairType&&(s=2*t.l+t.w-2*a);const l=(s/t.h+1.2321)/.10357/100,u=Math.round(s/l),h=!i&&"left"===t.railing||i&&"right"===t.railing||"both"===t.railing,c=!i&&"right"===t.railing||i&&"left"===t.railing||"both"===t.railing,p=.05;let d,f,m,y=s/u,g={shape:[],runs:[],railings:[]};switch(o){case"straight":case"straightLanding":g.shape=[[0,0],[t.l,0],[t.l,t.w],[0,t.w]];break;case"lShaped":case"winder":g.shape=[[0,0],[t.l,0],[t.l,t.w],[t.l-a,t.w],[t.l-a,a],[0,a]];break;case"halfLanding":case"2QuarterLanding":case"doubleWinder":g.shape=[[0,0],[t.l,0],[t.l,t.w],[0,t.w],[0,t.w-a],[t.l-a,t.w-a],[t.l-a,a],[0,a]]}if(g.railings=function(t,e,n,i){const r=[];if(!n&&!i)return[];let o=[];4===t.length?o=t.map(((t,n)=>[t[0],t[1]+(n<2?e:-e)])):6===t.length?o=t.map(((t,n)=>{let i=[...t];return n<2?i[1]+=e:n>3&&(i[1]-=e),1===n||2===n?i[0]-=e:(3===n||4===n)&&(i[0]+=e),i})):8===t.length&&(o=t.map(((t,n)=>{let i=[...t];return n<2||n>3&&n<6?i[1]+=e:(n<4||n>5)&&(i[1]-=e),(1===n||2===n)&&(i[0]-=e),(5===n||6===n)&&(i[0]+=e),i})));const s=o.slice(0,o.length/2),a=o.slice(o.length/2,o.length);return n&&r.push({type:"polyline",points:s}),i&&r.push({type:"polyline",points:a}),r}(g.shape,p,h,c),n)switch(o){case"straight":g.runs=[{type:"straight",data:[0,0,u,y,0]}];break;case"straightLanding":d=Math.ceil(u/2),f=u-d,g.runs=[{type:"straight",data:[0,0,d,y,0]},{type:"straight",data:[d*y+1,0,f,y,0]}];break;case"lShaped":d=Math.floor((t.l-a)/y),f=u-d,g.runs=[{type:"straight",data:[0,0,d,(t.l-a)/d,0]},{type:"straight",data:[t.l,a,f,(t.w-a)/f,-90]}];break;case"winder":f=2*Math.round((a/2+r)/y),d=Math.round((t.l-a-r)/y),m=u-d-f,g.runs=[{type:"straight",data:[0,0,d,(t.l-a-r)/d,0]},{type:"winder",data:[t.l-a-r,0,f,0]}],m>0&&g.runs.push({type:"straight",data:[t.l,a+r,m,(t.w-a-r)/m,-90]});break;case"halfLanding":d=u/2,f=u/2,g.runs=[{type:"straight",data:[0,0,d,y,0]},{type:"straight",data:[d*y,t.w,f,y,180]}];break;case"2QuarterLanding":d=Math.round((t.l-a)/y),m=d,f=u-2*d,y=(t.l-a)/d,g.runs=[{type:"straight",data:[0,0,d,(t.l-a)/d,0]},{type:"straight",data:[t.l,a,f,(t.w-2*a)/f,-90]},{type:"straight",data:[d*y,t.w,m,(t.l-a)/d,180]}];break;case"doubleWinder":f=4*Math.round((a/2+r)/y),m=Math.round((t.w-2*(a+r))/y),d=Math.round((u-f-m)/2),g.runs=[],d>0&&g.runs.push({type:"straight",data:[0,0,d,(t.l-a-r)/d,0]}),g.runs.push({type:"winder",data:[t.l-a-r,0,f/2,0]}),m>0&&g.runs.push({type:"straight",data:[t.l,a+r,m,(t.w-2*(a+r))/m,-90]}),g.runs.push({type:"winder",data:[t.l,t.w-a-r,f/2,-90]}),d>0&&g.runs.push({type:"straight",data:[t.l-a-r,t.w,d,(t.l-a-r)/d,180]})}let v,_=[];if("labelled"!==e.style){let t=[[y/2-.06,a/2+.12],[y/2+.06,a/2],[y/2-.06,a/2-.12]];_.push({type:"polyline",points:t})}if("spiral"!==o)v={type:"polygon",points:g.shape},g.runs.forEach((t=>{"straight"===t.type?_=_.concat(function(t,e,n,i,r=0,o){r=r||0;const s=[];for(var a=0;a<n;a++){let n=[[a*i,0],[a*i,o]];n=uu({x:t,z:e,ry:r},n),s.push({type:"polyline",points:n})}return s}(...t.data,a)):"winder"===t.type&&(_=_.concat(function(t,e,n,i,r,o){let s=0;i=i||0;const a=[];let l=n/2,u=(r+o)/l,h=o/l,c=0,p=0;for(var d=0;d<l;d++){let n=[[s+c,0+r],[s+p,0]];n=uu({x:t,z:e,ry:i},n),a.push({type:"polyline",points:n}),c+=h,p+=u}for(s+=c,c=0,p=0,d=0;d<l;d++){let n=[[s,0+r+c],[s+r,0+p]];n=uu({x:t,z:e,ry:i},n),a.push({type:"polyline",points:n}),c+=h,p+=u}return a}(...t.data,a,r)))}));else if("spiral"===o){const e=t.w,i=e-a,r=i+a/2;let o=t.l/r;const s=o/u;o>2*Math.PI&&(o=2*Math.PI-.01);let l=[0,t.w],d=o/Math.PI*180-90;v={type:"composite",segments:[{type:"arc",radius:e,position:l,startAngle:-d,endAngle:90},{type:"arc",radius:i,position:l,startAngle:90,endAngle:-d}]},g.railings=[];const f=e-p,m=i+p;if(h&&g.railings.push({type:"arc",radius:f,position:l,startAngle:-d,endAngle:90}),c&&g.railings.push({type:"arc",radius:m,position:l,startAngle:-d,endAngle:90}),n){let t=0;for(var x=0;x<u&&!(t>=o);x++){const n=[Math.sin(t)*e,Math.cos(t)*e-e],r=[Math.sin(t)*i,Math.cos(t)*i-e];_.push({type:"polyline",points:[[n[0],-n[1]],[r[0],-r[1]]]}),t+=s}}}let b=[v,..._,...g.railings];return i&&(b=b.map((e=>("composite"===e.type&&(e=Qu(e)),"arc"===e.type&&(e=Ju(e)),("polygon"===e.type||"polyline"===e.type)&&e.points.forEach((e=>{e[1]=-e[1]+t.w})),e)))),b},wall:function(t){let e;return e="center"===t.controlLine?-t.w/2:"front"===t.controlLine?-t.w:0,[{type:"rectangle",position:[0,e],dimensions:[t.l,t.w]}]},door:function(t,e){const n=t.doorType||"singleSwing",i=t.l,r=e.w;let o=[],s=t.doorAngle;const a="right"===t.hinge,l="back"===t.side,u="front"===e.controlLine?-r:"center"===e.controlLine?-r/2:0;if(s<20&&(s=20),"singleSwing"===n){let t,e,n,h,c=s*Math.PI/180;l?(t=a?0:180-s,e=a?s:180,n=a?[0,u]:[i,u],h=[n[0]+i*Math.cos(c)*(a?1:-1),n[1]+-i*Math.sin(c)]):(t=a?-180:360-s,e=a?-180+s:360,n=a?[i,r+u]:[0,r+u],h=[n[0]+i*Math.cos(c)*(a?-1:1),n[1]+i*Math.sin(c)]),o.push({type:"arc",radius:i,position:n,startAngle:t,endAngle:e},{type:"line",start:n,end:h})}else if("doubleSwing"===n){const t=s*Math.PI/180;let e,n,a,h,c,p,d,f;l?(e=0,n=s,a=[0,u],h=[a[0]+i/2*Math.cos(t),a[1]+-i/2*Math.sin(t)],d=[i,u],f=[d[0]+-i/2*Math.cos(t),d[1]+-i/2*Math.sin(t)],c=180-s,p=180):(e=360-s,n=360,a=[0,r+u],h=[a[0]+i/2*Math.cos(t),a[1]+i/2*Math.sin(t)],d=[i,r+u],f=[d[0]+-i/2*Math.cos(t),d[1]+i/2*Math.sin(t)],c=180,p=180+s),o.push({type:"arc",radius:i/2,position:a,startAngle:e,endAngle:n},{type:"line",start:a,end:h}),o.push({type:"arc",radius:i/2,position:d,startAngle:c,endAngle:p},{type:"line",start:d,end:f})}return o.push({type:"rectangle",position:[0,u],dimensions:[t.l,r]}),o}},vh={box:t=>_h(t),curtain:t=>{const e=Math.min(Math.max(t.folds||10,Math.round(5*t.l)),Math.max(1,Math.round(15*t.l))),n=.05,i=t.w,r=t.l/e;let o=[],s=[];var a,l,u,h=0,c=i/2,p=n/2;let d=t.id.replace(/-/gi,""),f=d.length;for(var m=0;m<e;m++){l=p,u=c;let t=parseInt(d[m%f],16)/20;p=n/2+t*n/2*(m%2==0?-1:1),c=i/2+t*i/2*(m%2==0?-1:1),a=h,h=r*(m+1),s.push([a,u]),o.push([a,l]),m===e-1&&(s.push([h,c]),o.push([h,p]))}return[{type:"composite",segments:[{type:"quadraticBezier",points:o},{type:"quadraticBezier",points:s.reverse()}]}]},railing:t=>_h(t),floor:t=>_h(t),window:(t,e)=>_h(t,e),closet:t=>_h(t),interior:(t,e,n)=>n?(n=n.sort(((t,e)=>eu(t)>eu(e)?-1:1)))&&n.length?[{type:"polygon",points:n[0],holes:n.slice(1)}]:void 0:[{type:"circle",position:[0,0],radius:.01}],polyfloor:t=>[{type:"polygon",points:t.polygon,holes:t.polygonHoles||[]}],polybox:t=>[{type:"polygon",points:t.polygon}],"a:helper:spaceDivider":t=>[{type:"rectangle",position:[0,-.02],dimensions:[t.l,.04]}],floorplan:t=>[{type:"rectangle",position:[-t.l/2,-t.w/2],dimensions:[t.l,t.w],style:{fill:!1}}]};function _h(t,e){let n=0,i=t.w;return"wall"===t.type&&(n="front"===t.controlLine?t.w:"center"===t.controlLine?t.w/2:0),"window"===t.type&&(i=e.w,n="front"===e.controlLine?e.w:"center"===e.controlLine?e.w/2:0),[{type:"polygon",points:[[0,0-n],[t.l,0-n],[t.l,i-n],[0,i-n]]}]}const xh=t=>{var e;return(null==(e=t.src)?void 0:e.substring(1))||""},bh="fpe-dc2-";class wh extends Gl{constructor(t,e){var n,i,r;super(),this.productQueue={},this.textureQueue={},this.promiseCache=new Map,this.loadStages={product:!0,productContour:!0,productTexture:!1},this.isSceneStructureLoaded=!1,this.initialLoading=!0,this._loadCounter=0,this.resources=t,this.productContourCacheAge=null==(n=e.api)?void 0:n.productContourCacheAge,this.productDataCacheAge=null==(i=e.api)?void 0:i.productDataCacheAge,this.loadStages.productTexture=!(null==(r=e.theme)||!r.showAssetTextures)&&!1!==e.loadTextures,this.on("product-load-stage",this.loadStatus,this)}loadStatus({args:t}){const e=Object.values(this.textureQueue).reduce(((t,e)=>t+e.nodes.size),0)+Object.values(this.productQueue).reduce(((t,e)=>t+e.nodes.size),0);this._loadCounter++,this.emit("loading-status",{totalCount:e,doneCount:this._loadCounter}),e===this._loadCounter&&this.emit("loading-done",{totalCount:e})}reset(){this.resources.spaces=[],this.resources.assets=[],this.resources.products={},this.resources.productContours={},this.resources.productBoundingBoxes={},this.textureQueue={},this.productQueue={},this._loadCounter=0,this.promiseCache=new Map,this.initialLoading=!0}}const Ph=t=>{const e=t.boundingPoints;let n;if(e)return n=[[e.min[0],e.min[2]],[e.min[0],e.max[2]],[e.max[0],e.max[2]],[e.max[0],e.min[2]]],t._loadStage=1,[n]},Eh=async(t,e)=>{const{productId:n}=t,i=bh+n,r=e.promiseCache.get(i);if(r)return r;const o=function(t,e){const n=e.productContourCacheAge,i=n||864e6;if(!t)return Promise.reject("product id missing");const r=bh+t,o=e.promiseCache.get(r);if(o)return o;const s=mh(r,n).then((e=>e||hh(t).then((t=>(fh(r,t,i),t))))).catch((t=>{console.warn(t)}));return e.promiseCache.set(r,s),s}(n,e).then((t=>{const i=t;e.resources.productContours[n]=i,e.resources.products[n]._shapes=vh.interior({type:"interior"},null,i),e.productQueue[n].loadStage=3})).catch((()=>{}));return e.promiseCache.set(i,o),o};function Th(t,e){const{node:n,...i}=e;return{...i,resourceType:t,setHighlight:t=>{n.setHighlight(t)},node:n}}const Sh=t=>{const e=t.scene.nodesByType.interior;return Promise.all(e.map((e=>async function(t,e){if(e.promiseCache||(e.promiseCache=new Map),!t||!t.src)return;const n=xh(t);e.productQueue[n]||(e.productQueue[n]={loadStage:0,nodes:new Set}),e.productQueue[n].nodes.add(t),e.productQueue[n].loadStage<1&&await function(t,e){const n=e.productDataCacheAge,i=n||864e5;if(!t)return Promise.reject("product id missing");const r="fpe-pr1-"+t,o=e.promiseCache.get(r);if(o)return o;const s=mh(r,n).then((e=>e&&e.matColors?e:lh(t).then((t=>(t.matColors={},t.colours&&t.colours.length&&t.colours.forEach((e=>{if(!e.includes(":"))return;let n=e.split(":"),i=Ou(n[1]);t.matColors[i]=n[2]})),fh(r,t,i),t))))).then((n=>{const i=function(t){if(!t)return;const e=t.subCategories.includes("ceilingLight"),n=t.subCategories.includes("rug"),i=t.productResourceId,r=uh(i);return{preview:t.preview,manufacturer:t.manufacturer,productId:i,name:t.productDisplayName,fileKey:t.fileKey,tags:t.tags,categories:t.categories,subCategories:t.subCategories,boundingPoints:t.boundingPoints,boundingBox:t.boundingBox,seatCapacity:t.seatCapacity,texture:r,materials:[],matColors:t.matColors,colours:t.colours,order:yh(t),isCeilingLamp:e,isCarpet:n,createdAt:t.createdAt,updatedAt:t.updatedAt,link:t.link}}(n);e.resources.products[t]=i,e.productQueue[t].loadStage=1,e.emit("product-data",{productId:t,data:i})})).catch((t=>{console.warn(t.message)}));return e.promiseCache.set(r,s),s}(n,e),e.loadStages.productContour&&async function(t,e){const n=xh(t),i=e.resources.products[n];if(!i||!e.productQueue[n])return;const r=function(t,e){let n=(t=>{var e;return(null==(e=t.src)?void 0:e.substring(1))||""})(t),i=Au(t,e);return i=i?"_"+i:"",n+i}(t,i);if(function(t,e){if(!e||"interior"!==e.type)return;let n=xh(e);if(!n)return;let i=Au(e,t.products[n]);i&&!t.products[n].materials.includes(i)&&t.products[n].materials.splice(0,0,i)}(e.resources,t),!e.textureQueue[r]){const t=uh(r);e.textureQueue[r]={productId:n,loadStage:0,nodes:new Set,textureUrl:t,applyFilter:!0},e.loadStages.productTexture&&e.emit("product-load-texture",{textureId:r,productData:i})}e.textureQueue[r].nodes.add(t),2!==e.textureQueue[r].loadStage?(e.resources.productBoundingBoxes[n]||(e.resources.productBoundingBoxes[n]=Ph(i),e.productQueue[n].loadStage=2),2===e.productQueue[n].loadStage&&e.emit("product-load-stage",{node:t,args:{_loadStage:2}}),e.resources.productContours[n]||Eh(i,e).then((()=>{var n,i;1===(null==(n=e.textureQueue[r])?void 0:n.loadStage)||(null==(i=e.textureQueue[r])?void 0:i.error)?e.emit("product-contour",r):e.loadStages.productTexture||e.emit("product-load-stage",{node:t,args:{_loadStage:3}})}))):e.emit("product-load-stage",{node:t,args:{_loadStage:3,_textureId:r}})}(t,e)}(e,t.loader).catch((t=>console.error(t)))))).then((()=>{t.resources.assets=e.map((e=>{const n=function(t,e){if(!t)return;const n=xh(t),i=e.products[n];if(!i)return void console.error("no productData",n,t);const r=t.getWorldPosition(),o=function(t,e){if(!t)return null;const n=xh(t),i=e.products[n];if(!i)return null;const{boundingPoints:r}=i;if(r){const{min:e,max:n}=r,i=[[e[0],e[2]],[e[0],n[2]],[n[0],n[2]],[n[0],e[2]]];return uu(t.getWorldPosition(),i)}return null}(t,e),s=o&&$l([o]);return{id:t.id,node:t,polygon:o,boundingBox:s,name:i.name,manufacturer:i.manufacturer,productId:n,tags:i.tags,categories:i.categories,subCategories:i.subCategories,dimensions:i.boundingBox,seatCapacity:i.seatCapacity,position:{x:r.x,y:r.y,z:r.z},rotation:r.ry}}(e,t.resources);return n&&function(t){return Th("asset",t)}(n)})).filter((t=>t))}))};class Ch{constructor({options:t={},scene:e}={}){this.settings=w(rh),this.fpeId="fpe-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,3),this.resources={spaces:[],assets:[],products:{},productContours:{},productBoundingBoxes:{}},this.computed={wallContours:[],relations:{spaces:[]},snapPoints:[],snapMargin:0},this.isBrowser="object"!=typeof i&&typeof window<"u",this._emitter=new Gl,this.set(t),this.loader=new wh(this.resources,this.settings),this.scene=e||new Wu,e&&this.initScene(e),this.version=rh.api.sdkVersion,this.utils={polygonOffset:Kl,polygonIntersection:Ql,pointInPolygon:Jl,polygonUnion:Zl},this.scene.on("scene-structure-loading",(()=>{this.loader.isSceneStructureLoaded=!1})),this.scene.on("scene-structure-loaded",this.initScene,this)}on(t,e,n){return this._emitter.on(t,e,n),this}once(t,e,n){return this._emitter.once(t,e,n),this}off(t,e){return this._emitter.off(t,e),this}emit(t,...e){return this._emitter.emit(t,...e),this}initScene(t){this.loader.initialLoading||this.loader.reset(),this.scene||(this.scene=t),this.loader.isSceneStructureLoaded=!0,this.settings.theme.wallContours&&(this.computed.wallContours=Gu(this.scene)),this.getSpaces(),this.loader.emit("spaces-loaded",!0),Sh(this).then((()=>{const t=this.settings.hideElements.includes("interior"),e=0===this.scene.nodesByType.interior.length;this.loader.emit("assets-loaded",!0),(t||e)&&this.loader.emit("loading-done",{totalCount:0})})),this.loader.initialLoading=!1}loadScene(t,e=this.settings.api){return new Promise(((n,i)=>{let r;(!t||"string"!=typeof t)&&i(`Expected non-empty string sceneId parameter instead got: "${t}"`);try{r=(t=>"publishableToken"in t?(console.warn("token.publishableToken is deprecated, please use the token.publishableAccessToken option"),cl.getTokenConfig({publishableAccessToken:t.publishableToken,...t})):cl.getTokenConfig(t))(e)}catch(t){i(t)}return this.loader.once("assets-loaded",n),ah(t,r).then((t=>(function(t){var e;null==(e=document.querySelector(`#${t} .fpe-err`))||e.remove()}(this.fpeId),this.scene.loadSceneStructure(t.structure,{planRotation:this.settings.planRotation})))).catch((t=>{const e="string"==typeof t?t:t&&t.message;i(e)}))})).catch((t=>{throw function(t,e="Floor plan engine couldn't load properly on this page. For technical details check the browser console."){var n;const i=document.getElementById(t),r=null!=(n=i.querySelector(".fpe-err"))?n:function(t){const e=document.createElement("div"),n=document.createElement("div"),i=document.createElement("div"),r=document.createElement("div");return e.classList.add("fpe-err"),n.classList.add("fpe-err__box"),i.classList.add("fpe-err__title"),r.classList.add("fpe-err__msg"),t.append(e),e.append(n),n.append(i),n.append(r),i.textContent="Something went wrong",t.append(e),t}(i);r.querySelector(".fpe-err__msg").textContent=e}(this.fpeId,t),t}))}getSpaces(){let t=Yu({scene:this.scene});this.resources.spaces=t.map((t=>{let e=t.interiors;return delete t.interiors,function(t){return Th("space",t)}({...t,assets:e.map((t=>t.id))})}))}set(t={}){var e,n,i,r,o,s,a;const l=null==(e=this.settings.hideElements)?void 0:e.includes("interior");let u=w(t);u.theme&&(u.theme=P(rh.theme,u.theme)),u.ui&&(u.ui={...rh.ui,...u.ui}),u.api&&(u.api={...rh.api,...u.api}),u.units&&(u.units={...rh.units,...u.units});const h=!(null!=(n=u.hideElements)&&n.includes("interior"));for(let t in u)this.settings[t]=u[t];if(null!=(o=null==(r=null==(i=this.settings.theme)?void 0:i.elements)?void 0:r.space)&&o.program){const t=this.settings.theme.elements.space.program,e={wash:"care",operate:"support",common:"socialize"};Object.keys(t).forEach((n=>{Object.keys(e).includes(n)&&(t[e[n]]=t[n],delete t[n])}))}this.scene&&this.scene.node&&(l&&h&&Sh(this),(null==(s=u.theme)?void 0:s.wallContours)&&!(null!=(a=this.computed.wallContours)&&a.length)&&(this.computed.wallContours=Gu(this.scene)),this.scene.node.ry!==u.planRotation&&Number.isFinite(u.planRotation)&&(this.scene.node.set({ry:u.planRotation}),this.computed.wallContours&&(this.computed.wallContours=Gu(this.scene))),this.getSpaces()),this.emit("update-settings",this.settings)}getResourcesFromPosition(t){const e=this.resources.spaces.filter((e=>Jl(t,e.polygons[0],e.polygons.slice(1)))),n=[];return e.forEach((e=>{let i=this.resources.assets.filter((t=>e.assets.includes(t.id))).filter((e=>{var n;if((!(null==(n=this.resources.products[e.productId])?void 0:n.isCeilingLamp)||this.settings.showCeilingLamps)&&e.polygon&&e.polygon.length)return Jl(t,e.polygon)}));n.push(...i)})),{spaces:e,assets:n}}getElementBoundingBox(t,e=0){if(!t)return;let n,i,r;if(t instanceof Mu?i=t.getWorldPosition():"string"==typeof t&&(n=this.scene.nodesById[t].find({id:t}),i=n&&n.getWorldPosition()),!i)return;if("interior"===i.type&&i.src){let t=xh(i),e=this.resources.productBoundingBoxes[t]||this.resources.productContours[t];r=e&&uu(i,e[0])}else r="polyfloor"===i.type?uu(i,i.polygon):"group"!==i.type?lu(i):[[i.x-2,i.z-2],[i.x+2,i.z-2],[i.x+2,i.z+2],[i.x-2,i.z+2]];const o=$l([r]);return{x:o.x-e,z:o.z-e,x2:o.x2+e,z2:o.z2+e,length:o.length+2*e,width:o.width+2*e}}destroy(){delete this.scene,delete this.resources,delete this.settings,delete this.utils}}const Ih=(t,e,n=.15)=>{let i,r,o;for(const s of e)if(i=Math.abs(t[0]-s[0]),!(i>n)&&(r=Math.abs(t[1]-s[1]),i<n&&r<n)){o=s;break}return o};function Ah(t,e=0){return({door:31,window:31,column:30,wall:30,closet:20,railing:20,curtain:20,kitchen:20,group:12,box:11,polybox:11,interior:10,"a:helper:spaceDivider":5,stairs:5,floor:0,polyfloor:0}[t]||0)+e}var Oh={exports:{}};!function(t){(function(){var e,n;n=e={linear:function(t,e,n,i){return n*t/i+e},easeInQuad:function(t,e,n,i){return n*(t/=i)*t+e},easeOutQuad:function(t,e,n,i){return-n*(t/=i)*(t-2)+e},easeInOutQuad:function(t,e,n,i){return(t/=i/2)<1?n/2*t*t+e:-n/2*(--t*(t-2)-1)+e},easeInCubic:function(t,e,n,i){return n*(t/=i)*t*t+e},easeOutCubic:function(t,e,n,i){return n*((t=t/i-1)*t*t+1)+e},easeInOutCubic:function(t,e,n,i){return(t/=i/2)<1?n/2*t*t*t+e:n/2*((t-=2)*t*t+2)+e},easeInQuart:function(t,e,n,i){return n*(t/=i)*t*t*t+e},easeOutQuart:function(t,e,n,i){return-n*((t=t/i-1)*t*t*t-1)+e},easeInOutQuart:function(t,e,n,i){return(t/=i/2)<1?n/2*t*t*t*t+e:-n/2*((t-=2)*t*t*t-2)+e},easeInQuint:function(t,e,n,i){return n*(t/=i)*t*t*t*t+e},easeOutQuint:function(t,e,n,i){return n*((t=t/i-1)*t*t*t*t+1)+e},easeInOutQuint:function(t,e,n,i){return(t/=i/2)<1?n/2*t*t*t*t*t+e:n/2*((t-=2)*t*t*t*t+2)+e},easeInSine:function(t,e,n,i){return-n*Math.cos(t/i*(Math.PI/2))+n+e},easeOutSine:function(t,e,n,i){return n*Math.sin(t/i*(Math.PI/2))+e},easeInOutSine:function(t,e,n,i){return-n/2*(Math.cos(Math.PI*t/i)-1)+e},easeInExpo:function(t,e,n,i){return 0===t?e:n*Math.pow(2,10*(t/i-1))+e},easeOutExpo:function(t,e,n,i){return t===i?e+n:n*(1-Math.pow(2,-10*t/i))+e},easeInOutExpo:function(t,e,n,i){return(t/=i/2)<1?n/2*Math.pow(2,10*(t-1))+e:n/2*(2-Math.pow(2,-10*--t))+e},easeInCirc:function(t,e,n,i){return-n*(Math.sqrt(1-(t/=i)*t)-1)+e},easeOutCirc:function(t,e,n,i){return n*Math.sqrt(1-(t=t/i-1)*t)+e},easeInOutCirc:function(t,e,n,i){return(t/=i/2)<1?-n/2*(Math.sqrt(1-t*t)-1)+e:n/2*(Math.sqrt(1-(t-=2)*t)+1)+e},easeInElastic:function(t,e,n,i){var r,o,s;return s=1.70158,0===t||(t/=i),(o=0)||(o=.3*i),(r=n)<Math.abs(n)?(r=n,s=o/4):s=o/(2*Math.PI)*Math.asin(n/r),-r*Math.pow(2,10*(t-=1))*Math.sin((t*i-s)*(2*Math.PI)/o)+e},easeOutElastic:function(t,e,n,i){var r,o,s;return s=1.70158,0===t||(t/=i),(o=0)||(o=.3*i),(r=n)<Math.abs(n)?(r=n,s=o/4):s=o/(2*Math.PI)*Math.asin(n/r),r*Math.pow(2,-10*t)*Math.sin((t*i-s)*(2*Math.PI)/o)+n+e},easeInOutElastic:function(t,e,n,i){var r,o,s;return s=1.70158,0===t||(t/=i/2),(o=0)||(o=i*(.3*1.5)),(r=n)<Math.abs(n)?(r=n,s=o/4):s=o/(2*Math.PI)*Math.asin(n/r),t<1?r*Math.pow(2,10*(t-=1))*Math.sin((t*i-s)*(2*Math.PI)/o)*-.5+e:r*Math.pow(2,-10*(t-=1))*Math.sin((t*i-s)*(2*Math.PI)/o)*.5+n+e},easeInBack:function(t,e,n,i,r){return void 0===r&&(r=1.70158),n*(t/=i)*t*((r+1)*t-r)+e},easeOutBack:function(t,e,n,i,r){return void 0===r&&(r=1.70158),n*((t=t/i-1)*t*((r+1)*t+r)+1)+e},easeInOutBack:function(t,e,n,i,r){return void 0===r&&(r=1.70158),(t/=i/2)<1?n/2*(t*t*((1+(r*=1.525))*t-r))+e:n/2*((t-=2)*t*((1+(r*=1.525))*t+r)+2)+e},easeInBounce:function(t,n,i,r){return i-e.easeOutBounce(r-t,0,i,r)+n},easeOutBounce:function(t,e,n,i){return(t/=i)<1/2.75?n*(7.5625*t*t)+e:t<2/2.75?n*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?n*(7.5625*(t-=2.25/2.75)*t+.9375)+e:n*(7.5625*(t-=2.625/2.75)*t+.984375)+e},easeInOutBounce:function(t,n,i,r){return t<r/2?.5*e.easeInBounce(2*t,0,i,r)+n:.5*e.easeOutBounce(2*t-r,0,i,r)+.5*i+n}},t.exports=n}).call(T)}(Oh);var Nh=Oh.exports;class Lh{constructor(t){this.parent=t,this.paused=!1}destroy(){}down(t){return!1}move(t){return!1}up(t){return!1}wheel(t){return!1}update(t){}resize(){}reset(){}pause(){this.paused=!0}resume(){this.paused=!1}}function Mh(t,e){return t?"function"==typeof t?t:"string"==typeof t?Nh[t]:void 0:Nh[e]}const Rh={removeOnInterrupt:!1,ease:"linear",time:1e3};class kh extends Lh{__init(){this.startWidth=null}__init2(){this.startHeight=null}__init3(){this.deltaWidth=null}__init4(){this.deltaHeight=null}__init5(){this.width=null}__init6(){this.height=null}__init7(){this.time=0}constructor(t,e={}){super(t),kh.prototype.__init.call(this),kh.prototype.__init2.call(this),kh.prototype.__init3.call(this),kh.prototype.__init4.call(this),kh.prototype.__init5.call(this),kh.prototype.__init6.call(this),kh.prototype.__init7.call(this),this.options=Object.assign({},Rh,e),this.options.ease=Mh(this.options.ease),this.setupPosition(),this.setupZoom(),this.time=0}setupPosition(){typeof this.options.position<"u"?(this.startX=this.parent.center.x,this.startY=this.parent.center.y,this.deltaX=this.options.position.x-this.parent.center.x,this.deltaY=this.options.position.y-this.parent.center.y,this.keepCenter=!1):this.keepCenter=!0}setupZoom(){this.width=null,this.height=null,typeof this.options.scale<"u"?this.width=this.parent.screenWidth/this.options.scale:typeof this.options.scaleX<"u"||typeof this.options.scaleY<"u"?(typeof this.options.scaleX<"u"&&(this.width=this.parent.screenWidth/this.options.scaleX),typeof this.options.scaleY<"u"&&(this.height=this.parent.screenHeight/this.options.scaleY)):(typeof this.options.width<"u"&&(this.width=this.options.width),typeof this.options.height<"u"&&(this.height=this.options.height)),null!==this.width&&(this.startWidth=this.parent.screenWidthInWorldPixels,this.deltaWidth=this.width-this.startWidth),null!==this.height&&(this.startHeight=this.parent.screenHeightInWorldPixels,this.deltaHeight=this.height-this.startHeight)}down(){return this.options.removeOnInterrupt&&this.parent.plugins.remove("animate"),!1}complete(){this.parent.plugins.remove("animate"),null!==this.width&&this.parent.fitWidth(this.width,this.keepCenter,null===this.height),null!==this.height&&this.parent.fitHeight(this.height,this.keepCenter,null===this.width),this.keepCenter||this.parent.moveCenter(this.options.position),this.parent.emit("animate-end",this.parent),this.options.callbackOnComplete&&this.options.callbackOnComplete(this.parent)}update(t){if(!this.paused)if(this.time+=t,this.time>=this.options.time)this.complete();else{const t=new Ti(this.parent.scale.x,this.parent.scale.y),e=this.options.ease(this.time,0,1,this.options.time);if(null!==this.width){const t=this.startWidth,n=this.deltaWidth;this.parent.fitWidth(t+n*e,this.keepCenter,null===this.height)}if(null!==this.height){const t=this.startHeight,n=this.deltaHeight;this.parent.fitHeight(t+n*e,this.keepCenter,null===this.width)}if(null===this.width?this.parent.scale.x=this.parent.scale.y:null===this.height&&(this.parent.scale.y=this.parent.scale.x),!this.keepCenter){const t=this.startX,n=this.startY,i=this.deltaX,r=this.deltaY,o=new Ti(this.parent.x,this.parent.y);this.parent.moveCenter(t+i*e,n+r*e),this.parent.emit("moved",{viewport:this.parent,original:o,type:"animate"})}(this.width||this.height)&&this.parent.emit("zoomed",{viewport:this.parent,original:t,type:"animate"})}}}function Dh(t){let e,n=t[0],i=1;for(;i<t.length;){const r=t[i],o=t[i+1];if(i+=2,("optionalAccess"===r||"optionalCall"===r)&&null==n)return;"access"===r||"optionalAccess"===r?(e=n,n=o(n)):("call"===r||"optionalCall"===r)&&(n=o(((...t)=>n.call(e,...t))),e=void 0)}return n}const Fh={sides:"all",friction:.5,time:150,ease:"easeInOutSine",underflow:"center",bounceBox:null};class Bh extends Lh{constructor(t,e={}){super(t),this.options=Object.assign({},Fh,e),this.ease=Mh(this.options.ease,"easeInOutSine"),this.options.sides?"all"===this.options.sides?this.top=this.bottom=this.left=this.right=!0:"horizontal"===this.options.sides?(this.right=this.left=!0,this.top=this.bottom=!1):"vertical"===this.options.sides?(this.left=this.right=!1,this.top=this.bottom=!0):(this.top=-1!==this.options.sides.indexOf("top"),this.bottom=-1!==this.options.sides.indexOf("bottom"),this.left=-1!==this.options.sides.indexOf("left"),this.right=-1!==this.options.sides.indexOf("right")):this.left=this.top=this.right=this.bottom=!1;const n=this.options.underflow.toLowerCase();"center"===n?(this.underflowX=0,this.underflowY=0):(this.underflowX=-1!==n.indexOf("left")?-1:-1!==n.indexOf("right")?1:0,this.underflowY=-1!==n.indexOf("top")?-1:-1!==n.indexOf("bottom")?1:0),this.reset()}isActive(){return null!==this.toX||null!==this.toY}down(){return this.toX=this.toY=null,!1}up(){return this.bounce(),!1}update(t){if(!this.paused){if(this.bounce(),this.toX){const e=this.toX;e.time+=t,this.parent.emit("moved",{viewport:this.parent,type:"bounce-x"}),e.time>=this.options.time?(this.parent.x=e.end,this.toX=null,this.parent.emit("bounce-x-end",this.parent)):this.parent.x=this.ease(e.time,e.start,e.delta,this.options.time)}if(this.toY){const e=this.toY;e.time+=t,this.parent.emit("moved",{viewport:this.parent,type:"bounce-y"}),e.time>=this.options.time?(this.parent.y=e.end,this.toY=null,this.parent.emit("bounce-y-end",this.parent)):this.parent.y=this.ease(e.time,e.start,e.delta,this.options.time)}}}calcUnderflowX(){let t;switch(this.underflowX){case-1:t=0;break;case 1:t=this.parent.screenWidth-this.parent.screenWorldWidth;break;default:t=(this.parent.screenWidth-this.parent.screenWorldWidth)/2}return t}calcUnderflowY(){let t;switch(this.underflowY){case-1:t=0;break;case 1:t=this.parent.screenHeight-this.parent.screenWorldHeight;break;default:t=(this.parent.screenHeight-this.parent.screenWorldHeight)/2}return t}oob(){const t=this.options.bounceBox;if(t){const e=typeof t.x>"u"?0:t.x,n=typeof t.y>"u"?0:t.y,i=typeof t.width>"u"?this.parent.worldWidth:t.width,r=typeof t.height>"u"?this.parent.worldHeight:t.height;return{left:this.parent.left<e,right:this.parent.right>i,top:this.parent.top<n,bottom:this.parent.bottom>r,topLeft:new Ti(e*this.parent.scale.x,n*this.parent.scale.y),bottomRight:new Ti(i*this.parent.scale.x-this.parent.screenWidth,r*this.parent.scale.y-this.parent.screenHeight)}}return{left:this.parent.left<0,right:this.parent.right>this.parent.worldWidth,top:this.parent.top<0,bottom:this.parent.bottom>this.parent.worldHeight,topLeft:new Ti(0,0),bottomRight:new Ti(this.parent.worldWidth*this.parent.scale.x-this.parent.screenWidth,this.parent.worldHeight*this.parent.scale.y-this.parent.screenHeight)}}bounce(){if(this.paused)return;let t,e=this.parent.plugins.get("decelerate",!0);e&&(e.x||e.y)&&(e.x&&e.percentChangeX===Dh([e,"access",t=>t.options,"optionalAccess",t=>t.friction])||e.y&&e.percentChangeY===Dh([e,"access",t=>t.options,"optionalAccess",t=>t.friction]))&&(t=this.oob(),(t.left&&this.left||t.right&&this.right)&&(e.percentChangeX=this.options.friction),(t.top&&this.top||t.bottom&&this.bottom)&&(e.percentChangeY=this.options.friction));const n=this.parent.plugins.get("drag",!0)||{},i=this.parent.plugins.get("pinch",!0)||{};if(e=e||{},!(Dh([n,"optionalAccess",t=>t.active])||Dh([i,"optionalAccess",t=>t.active])||this.toX&&this.toY||e.x&&e.y)){t=t||this.oob();const n=t.topLeft,i=t.bottomRight;if(!this.toX&&!e.x){let e=null;t.left&&this.left?e=this.parent.screenWorldWidth<this.parent.screenWidth?this.calcUnderflowX():-n.x:t.right&&this.right&&(e=this.parent.screenWorldWidth<this.parent.screenWidth?this.calcUnderflowX():-i.x),null!==e&&this.parent.x!==e&&(this.toX={time:0,start:this.parent.x,delta:e-this.parent.x,end:e},this.parent.emit("bounce-x-start",this.parent))}if(!this.toY&&!e.y){let e=null;t.top&&this.top?e=this.parent.screenWorldHeight<this.parent.screenHeight?this.calcUnderflowY():-n.y:t.bottom&&this.bottom&&(e=this.parent.screenWorldHeight<this.parent.screenHeight?this.calcUnderflowY():-i.y),null!==e&&this.parent.y!==e&&(this.toY={time:0,start:this.parent.y,delta:e-this.parent.y,end:e},this.parent.emit("bounce-y-start",this.parent))}}}reset(){this.toX=this.toY=null,this.bounce()}}const Uh={left:!1,right:!1,top:!1,bottom:!1,direction:null,underflow:"center"};class zh extends Lh{constructor(t,e={}){super(t),this.options=Object.assign({},Uh,e),this.options.direction&&(this.options.left="x"===this.options.direction||"all"===this.options.direction||null,this.options.right="x"===this.options.direction||"all"===this.options.direction||null,this.options.top="y"===this.options.direction||"all"===this.options.direction||null,this.options.bottom="y"===this.options.direction||"all"===this.options.direction||null),this.parseUnderflow(),this.last={x:null,y:null,scaleX:null,scaleY:null},this.update()}parseUnderflow(){const t=this.options.underflow.toLowerCase();"none"===t?this.noUnderflow=!0:"center"===t?(this.underflowX=this.underflowY=0,this.noUnderflow=!1):(this.underflowX=-1!==t.indexOf("left")?-1:-1!==t.indexOf("right")?1:0,this.underflowY=-1!==t.indexOf("top")?-1:-1!==t.indexOf("bottom")?1:0,this.noUnderflow=!1)}move(){return this.update(),!1}update(){if(this.paused||this.parent.x===this.last.x&&this.parent.y===this.last.y&&this.parent.scale.x===this.last.scaleX&&this.parent.scale.y===this.last.scaleY)return;const t={x:this.parent.x,y:this.parent.y},e=this.parent.plugins.decelerate||{};if(null!==this.options.left||null!==this.options.right){let n=!1;if(!this.noUnderflow&&this.parent.screenWorldWidth<this.parent.screenWidth)switch(this.underflowX){case-1:0!==this.parent.x&&(this.parent.x=0,n=!0);break;case 1:this.parent.x!==this.parent.screenWidth-this.parent.screenWorldWidth&&(this.parent.x=this.parent.screenWidth-this.parent.screenWorldWidth,n=!0);break;default:this.parent.x!==(this.parent.screenWidth-this.parent.screenWorldWidth)/2&&(this.parent.x=(this.parent.screenWidth-this.parent.screenWorldWidth)/2,n=!0)}else null!==this.options.left&&this.parent.left<(!0===this.options.left?0:this.options.left)&&(this.parent.x=-(!0===this.options.left?0:this.options.left)*this.parent.scale.x,e.x=0,n=!0),null!==this.options.right&&this.parent.right>(!0===this.options.right?this.parent.worldWidth:this.options.right)&&(this.parent.x=-(!0===this.options.right?this.parent.worldWidth:this.options.right)*this.parent.scale.x+this.parent.screenWidth,e.x=0,n=!0);n&&this.parent.emit("moved",{viewport:this.parent,original:t,type:"clamp-x"})}if(null!==this.options.top||null!==this.options.bottom){let n=!1;if(!this.noUnderflow&&this.parent.screenWorldHeight<this.parent.screenHeight)switch(this.underflowY){case-1:0!==this.parent.y&&(this.parent.y=0,n=!0);break;case 1:this.parent.y!==this.parent.screenHeight-this.parent.screenWorldHeight&&(this.parent.y=this.parent.screenHeight-this.parent.screenWorldHeight,n=!0);break;default:this.parent.y!==(this.parent.screenHeight-this.parent.screenWorldHeight)/2&&(this.parent.y=(this.parent.screenHeight-this.parent.screenWorldHeight)/2,n=!0)}else null!==this.options.top&&this.parent.top<(!0===this.options.top?0:this.options.top)&&(this.parent.y=-(!0===this.options.top?0:this.options.top)*this.parent.scale.y,e.y=0,n=!0),null!==this.options.bottom&&this.parent.bottom>(!0===this.options.bottom?this.parent.worldHeight:this.options.bottom)&&(this.parent.y=-(!0===this.options.bottom?this.parent.worldHeight:this.options.bottom)*this.parent.scale.y+this.parent.screenHeight,e.y=0,n=!0);n&&this.parent.emit("moved",{viewport:this.parent,original:t,type:"clamp-y"})}this.last.x=this.parent.x,this.last.y=this.parent.y,this.last.scaleX=this.parent.scale.x,this.last.scaleY=this.parent.scale.y}reset(){this.update()}}const Xh={minWidth:null,minHeight:null,maxWidth:null,maxHeight:null,minScale:null,maxScale:null};class Yh extends Lh{constructor(t,e={}){super(t),this.options=Object.assign({},Xh,e),this.clamp()}resize(){this.clamp()}clamp(){if(!this.paused)if(this.options.minWidth||this.options.minHeight||this.options.maxWidth||this.options.maxHeight){let t=this.parent.worldScreenWidth,e=this.parent.worldScreenHeight;if(null!==this.options.minWidth&&t<this.options.minWidth){const n=this.parent.scale.x;this.parent.fitWidth(this.options.minWidth,!1,!1,!0),this.parent.scale.y*=this.parent.scale.x/n,t=this.parent.worldScreenWidth,e=this.parent.worldScreenHeight,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}if(null!==this.options.maxWidth&&t>this.options.maxWidth){const n=this.parent.scale.x;this.parent.fitWidth(this.options.maxWidth,!1,!1,!0),this.parent.scale.y*=this.parent.scale.x/n,t=this.parent.worldScreenWidth,e=this.parent.worldScreenHeight,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}if(null!==this.options.minHeight&&e<this.options.minHeight){const n=this.parent.scale.y;this.parent.fitHeight(this.options.minHeight,!1,!1,!0),this.parent.scale.x*=this.parent.scale.y/n,t=this.parent.worldScreenWidth,e=this.parent.worldScreenHeight,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}if(null!==this.options.maxHeight&&e>this.options.maxHeight){const t=this.parent.scale.y;this.parent.fitHeight(this.options.maxHeight,!1,!1,!0),this.parent.scale.x*=this.parent.scale.y/t,this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"})}}else if(this.options.minScale||this.options.maxScale){const t={x:null,y:null},e={x:null,y:null};if("number"==typeof this.options.minScale)t.x=this.options.minScale,t.y=this.options.minScale;else if(null!==this.options.minScale){const e=this.options.minScale;t.x=typeof e.x>"u"?null:e.x,t.y=typeof e.y>"u"?null:e.y}if("number"==typeof this.options.maxScale)e.x=this.options.maxScale,e.y=this.options.maxScale;else if(null!==this.options.maxScale){const t=this.options.maxScale;e.x=typeof t.x>"u"?null:t.x,e.y=typeof t.y>"u"?null:t.y}let n=this.parent.scale.x,i=this.parent.scale.y;null!==t.x&&n<t.x&&(n=t.x),null!==e.x&&n>e.x&&(n=e.x),null!==t.y&&i<t.y&&(i=t.y),null!==e.y&&i>e.y&&(i=e.y),(n!==this.parent.scale.x||i!==this.parent.scale.y)&&(this.parent.scale.set(n,i),this.parent.emit("zoomed",{viewport:this.parent,type:"clamp-zoom"}))}}reset(){this.clamp()}}const Gh={friction:.98,bounce:.8,minSpeed:.01},Hh=16;class Wh extends Lh{constructor(t,e={}){super(t),this.options=Object.assign({},Gh,e),this.saved=[],this.timeSinceRelease=0,this.reset(),this.parent.on("moved",(t=>this.moved(t)))}down(){return this.saved=[],this.x=this.y=null,!1}isActive(){return!(!this.x&&!this.y)}move(){if(this.paused)return!1;const t=this.parent.input.count();return(1===t||t>1&&!this.parent.plugins.get("pinch",!0))&&(this.saved.push({x:this.parent.x,y:this.parent.y,time:performance.now()}),this.saved.length>60&&this.saved.splice(0,30)),!1}moved(t){if(this.saved.length){const e=this.saved[this.saved.length-1];"clamp-x"===t.type?e.x===t.original.x&&(e.x=this.parent.x):"clamp-y"===t.type&&e.y===t.original.y&&(e.y=this.parent.y)}}up(){if(0===this.parent.input.count()&&this.saved.length){const t=performance.now();for(const e of this.saved)if(e.time>=t-100){const n=t-e.time;this.x=(this.parent.x-e.x)/n,this.y=(this.parent.y-e.y)/n,this.percentChangeX=this.percentChangeY=this.options.friction,this.timeSinceRelease=0;break}}return!1}activate(t){typeof(t=t||{}).x<"u"&&(this.x=t.x,this.percentChangeX=this.options.friction),typeof t.y<"u"&&(this.y=t.y,this.percentChangeY=this.options.friction)}update(t){if(this.paused)return;const e=this.x||this.y,n=this.timeSinceRelease,i=this.timeSinceRelease+t;if(this.x){const e=this.percentChangeX,r=Math.log(e);this.parent.x+=this.x*Hh/r*(Math.pow(e,i/Hh)-Math.pow(e,n/Hh)),this.x*=Math.pow(this.percentChangeX,t/Hh)}if(this.y){const e=this.percentChangeY,r=Math.log(e);this.parent.y+=this.y*Hh/r*(Math.pow(e,i/Hh)-Math.pow(e,n/Hh)),this.y*=Math.pow(this.percentChangeY,t/Hh)}this.timeSinceRelease+=t,this.x&&this.y?Math.abs(this.x)<this.options.minSpeed&&Math.abs(this.y)<this.options.minSpeed&&(this.x=0,this.y=0):(Math.abs(this.x||0)<this.options.minSpeed&&(this.x=0),Math.abs(this.y||0)<this.options.minSpeed&&(this.y=0)),e&&this.parent.emit("moved",{viewport:this.parent,type:"decelerate"})}reset(){this.x=this.y=null}}const jh={direction:"all",pressDrag:!0,wheel:!0,wheelScroll:1,reverse:!1,clampWheel:!1,underflow:"center",factor:1,mouseButtons:"all",keyToPress:null,ignoreKeyToPressOnTouch:!1,lineHeight:20};class Vh extends Lh{constructor(t,e={}){super(t),this.options=Object.assign({},jh,e),this.moved=!1,this.reverse=this.options.reverse?1:-1,this.xDirection=!this.options.direction||"all"===this.options.direction||"x"===this.options.direction,this.yDirection=!this.options.direction||"all"===this.options.direction||"y"===this.options.direction,this.keyIsPressed=!1,this.parseUnderflow(),this.mouseButtons(this.options.mouseButtons),this.options.keyToPress&&this.handleKeyPresses(this.options.keyToPress)}handleKeyPresses(t){window.addEventListener("keydown",(e=>{t.includes(e.code)&&(this.keyIsPressed=!0)})),window.addEventListener("keyup",(e=>{t.includes(e.code)&&(this.keyIsPressed=!1)}))}mouseButtons(t){this.mouse=t&&"all"!==t?[-1!==t.indexOf("left"),-1!==t.indexOf("middle"),-1!==t.indexOf("right")]:[!0,!0,!0]}parseUnderflow(){const t=this.options.underflow.toLowerCase();"center"===t?(this.underflowX=0,this.underflowY=0):(t.includes("left")?this.underflowX=-1:t.includes("right")?this.underflowX=1:this.underflowX=0,t.includes("top")?this.underflowY=-1:t.includes("bottom")?this.underflowY=1:this.underflowY=0)}checkButtons(t){const e="mouse"===t.data.pointerType,n=this.parent.input.count();return!(!(1===n||n>1&&!this.parent.plugins.get("pinch",!0))||e&&!this.mouse[t.data.button])}checkKeyPress(t){return!this.options.keyToPress||this.keyIsPressed||this.options.ignoreKeyToPressOnTouch&&"touch"===t.data.pointerType}down(t){return!(this.paused||!this.options.pressDrag||(this.checkButtons(t)&&this.checkKeyPress(t)?(this.last={x:t.data.global.x,y:t.data.global.y},this.current=t.data.pointerId,0):(this.last=null,1)))}get active(){return this.moved}move(t){if(this.paused||!this.options.pressDrag)return!1;if(this.last&&this.current===t.data.pointerId){const e=t.data.global.x,n=t.data.global.y,i=this.parent.input.count();if(1===i||i>1&&!this.parent.plugins.get("pinch",!0)){const i=e-this.last.x,r=n-this.last.y;if(this.moved||this.xDirection&&this.parent.input.checkThreshold(i)||this.yDirection&&this.parent.input.checkThreshold(r)){const i={x:e,y:n};return this.xDirection&&(this.parent.x+=(i.x-this.last.x)*this.options.factor),this.yDirection&&(this.parent.y+=(i.y-this.last.y)*this.options.factor),this.last=i,this.moved||this.parent.emit("drag-start",{event:t,screen:new Ti(this.last.x,this.last.y),world:this.parent.toWorld(new Ti(this.last.x,this.last.y)),viewport:this.parent}),this.moved=!0,this.parent.emit("moved",{viewport:this.parent,type:"drag"}),!0}}else this.moved=!1}return!1}up(t){if(this.paused)return!1;const e=this.parent.input.touches;if(1===e.length){const t=e[0];return t.last&&(this.last={x:t.last.x,y:t.last.y},this.current=t.id),this.moved=!1,!0}if(this.last&&this.moved){const e=new Ti(this.last.x,this.last.y);return this.parent.emit("drag-end",{event:t,screen:e,world:this.parent.toWorld(e),viewport:this.parent}),this.last=null,this.moved=!1,!0}return!1}wheel(t){if(this.paused)return!1;if(this.options.wheel){const e=this.parent.plugins.get("wheel",!0);if(!e||!e.options.wheelZoom&&!t.ctrlKey){const e=t.deltaMode?this.options.lineHeight:1;return this.xDirection&&(this.parent.x+=t.deltaX*e*this.options.wheelScroll*this.reverse),this.yDirection&&(this.parent.y+=t.deltaY*e*this.options.wheelScroll*this.reverse),this.options.clampWheel&&this.clamp(),this.parent.emit("wheel-scroll",this.parent),this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.parent.options.passiveWheel||t.preventDefault(),this.parent.options.stopPropagation&&t.stopPropagation(),!0}}return!1}resume(){this.last=null,this.paused=!1}clamp(){const t=this.parent.plugins.get("decelerate",!0)||{};if("y"!==this.options.clampWheel)if(this.parent.screenWorldWidth<this.parent.screenWidth)switch(this.underflowX){case-1:this.parent.x=0;break;case 1:this.parent.x=this.parent.screenWidth-this.parent.screenWorldWidth;break;default:this.parent.x=(this.parent.screenWidth-this.parent.screenWorldWidth)/2}else this.parent.left<0?(this.parent.x=0,t.x=0):this.parent.right>this.parent.worldWidth&&(this.parent.x=-this.parent.worldWidth*this.parent.scale.x+this.parent.screenWidth,t.x=0);if("x"!==this.options.clampWheel)if(this.parent.screenWorldHeight<this.parent.screenHeight)switch(this.underflowY){case-1:this.parent.y=0;break;case 1:this.parent.y=this.parent.screenHeight-this.parent.screenWorldHeight;break;default:this.parent.y=(this.parent.screenHeight-this.parent.screenWorldHeight)/2}else this.parent.top<0&&(this.parent.y=0,t.y=0),this.parent.bottom>this.parent.worldHeight&&(this.parent.y=-this.parent.worldHeight*this.parent.scale.y+this.parent.screenHeight,t.y=0)}}const qh={speed:0,acceleration:null,radius:null};class $h extends Lh{constructor(t,e,n={}){super(t),this.target=e,this.options=Object.assign({},qh,n),this.velocity={x:0,y:0}}update(t){if(this.paused)return;const e=this.parent.center;let n=this.target.x,i=this.target.y;if(this.options.radius){if(!(Math.sqrt(Math.pow(this.target.y-e.y,2)+Math.pow(this.target.x-e.x,2))>this.options.radius))return;{const t=Math.atan2(this.target.y-e.y,this.target.x-e.x);n=this.target.x-Math.cos(t)*this.options.radius,i=this.target.y-Math.sin(t)*this.options.radius}}const r=n-e.x,o=i-e.y;if(r||o)if(this.options.speed)if(this.options.acceleration){const s=Math.atan2(i-e.y,n-e.x),a=Math.sqrt(Math.pow(r,2)+Math.pow(o,2));if(a){const l=(Math.pow(this.velocity.x,2)+Math.pow(this.velocity.y,2))/(2*this.options.acceleration);this.velocity=a>l?{x:Math.min(this.velocity.x+this.options.acceleration*t,this.options.speed),y:Math.min(this.velocity.y+this.options.acceleration*t,this.options.speed)}:{x:Math.max(this.velocity.x-this.options.acceleration*this.options.speed,0),y:Math.max(this.velocity.y-this.options.acceleration*this.options.speed,0)};const u=Math.cos(s)*this.velocity.x,h=Math.sin(s)*this.velocity.y,c=Math.abs(u)>Math.abs(r)?n:e.x+u,p=Math.abs(h)>Math.abs(o)?i:e.y+h;this.parent.moveCenter(c,p),this.parent.emit("moved",{viewport:this.parent,type:"follow"})}}else{const t=Math.atan2(i-e.y,n-e.x),s=Math.cos(t)*this.options.speed,a=Math.sin(t)*this.options.speed,l=Math.abs(s)>Math.abs(r)?n:e.x+s,u=Math.abs(a)>Math.abs(o)?i:e.y+a;this.parent.moveCenter(l,u),this.parent.emit("moved",{viewport:this.parent,type:"follow"})}else this.parent.moveCenter(n,i),this.parent.emit("moved",{viewport:this.parent,type:"follow"})}}const Zh={radius:null,distance:null,top:null,bottom:null,left:null,right:null,speed:8,reverse:!1,noDecelerate:!1,linear:!1,allowButtons:!1};class Kh extends Lh{constructor(t,e={}){super(t),this.options=Object.assign({},Zh,e),this.reverse=this.options.reverse?1:-1,this.radiusSquared="number"==typeof this.options.radius?Math.pow(this.options.radius,2):null,this.resize()}resize(){const t=this.options.distance;null!==t?(this.left=t,this.top=t,this.right=this.parent.worldScreenWidth-t,this.bottom=this.parent.worldScreenHeight-t):this.options.radius||(this.left=this.options.left,this.top=this.options.top,this.right=null===this.options.right?null:this.parent.worldScreenWidth-this.options.right,this.bottom=null===this.options.bottom?null:this.parent.worldScreenHeight-this.options.bottom)}down(){return this.paused||this.options.allowButtons||(this.horizontal=this.vertical=null),!1}move(t){if(this.paused||"mouse"!==t.data.pointerType&&1!==t.data.identifier||!this.options.allowButtons&&0!==t.data.buttons)return!1;const e=t.data.global.x,n=t.data.global.y;if(this.radiusSquared){const t=this.parent.toScreen(this.parent.center);if(Math.pow(t.x-e,2)+Math.pow(t.y-n,2)>=this.radiusSquared){const i=Math.atan2(t.y-n,t.x-e);this.options.linear?(this.horizontal=Math.round(Math.cos(i))*this.options.speed*this.reverse*.06,this.vertical=Math.round(Math.sin(i))*this.options.speed*this.reverse*.06):(this.horizontal=Math.cos(i)*this.options.speed*this.reverse*.06,this.vertical=Math.sin(i)*this.options.speed*this.reverse*.06)}else this.horizontal&&this.decelerateHorizontal(),this.vertical&&this.decelerateVertical(),this.horizontal=this.vertical=0}else null!==this.left&&e<this.left?this.horizontal=Number(this.reverse)*this.options.speed*.06:null!==this.right&&e>this.right?this.horizontal=-1*this.reverse*this.options.speed*.06:(this.decelerateHorizontal(),this.horizontal=0),null!==this.top&&n<this.top?this.vertical=Number(this.reverse)*this.options.speed*.06:null!==this.bottom&&n>this.bottom?this.vertical=-1*this.reverse*this.options.speed*.06:(this.decelerateVertical(),this.vertical=0);return!1}decelerateHorizontal(){const t=this.parent.plugins.get("decelerate",!0);this.horizontal&&t&&!this.options.noDecelerate&&t.activate({x:this.horizontal*this.options.speed*this.reverse/(1e3/60)})}decelerateVertical(){const t=this.parent.plugins.get("decelerate",!0);this.vertical&&t&&!this.options.noDecelerate&&t.activate({y:this.vertical*this.options.speed*this.reverse/(1e3/60)})}up(){return this.paused||(this.horizontal&&this.decelerateHorizontal(),this.vertical&&this.decelerateVertical(),this.horizontal=this.vertical=null),!1}update(){if(!this.paused&&(this.horizontal||this.vertical)){const t=this.parent.center;this.horizontal&&(t.x+=this.horizontal*this.options.speed),this.vertical&&(t.y+=this.vertical*this.options.speed),this.parent.moveCenter(t),this.parent.emit("moved",{viewport:this.parent,type:"mouse-edges"})}}}const Qh={noDrag:!1,percent:1,center:null,factor:1,axis:"all"};class Jh extends Lh{__init(){this.active=!1}__init2(){this.pinching=!1}__init3(){this.moved=!1}constructor(t,e={}){super(t),Jh.prototype.__init.call(this),Jh.prototype.__init2.call(this),Jh.prototype.__init3.call(this),this.options=Object.assign({},Qh,e)}down(){return this.parent.input.count()>=2&&(this.active=!0,!0)}isAxisX(){return["all","x"].includes(this.options.axis)}isAxisY(){return["all","y"].includes(this.options.axis)}move(t){if(this.paused||!this.active)return!1;const e=t.data.global.x,n=t.data.global.y,i=this.parent.input.touches;if(i.length>=2){const r=i[0],o=i[1],s=r.last&&o.last?Math.sqrt(Math.pow(o.last.x-r.last.x,2)+Math.pow(o.last.y-r.last.y,2)):null;if(r.id===t.data.pointerId?r.last={x:e,y:n,data:t.data}:o.id===t.data.pointerId&&(o.last={x:e,y:n,data:t.data}),s){let t;const e={x:r.last.x+(o.last.x-r.last.x)/2,y:r.last.y+(o.last.y-r.last.y)/2};this.options.center||(t=this.parent.toLocal(e));let n=Math.sqrt(Math.pow(o.last.x-r.last.x,2)+Math.pow(o.last.y-r.last.y,2));n=0===n?n=1e-10:n;const i=(1-s/n)*this.options.percent*(this.isAxisX()?this.parent.scale.x:this.parent.scale.y);this.isAxisX()&&(this.parent.scale.x+=i),this.isAxisY()&&(this.parent.scale.y+=i),this.parent.emit("zoomed",{viewport:this.parent,type:"pinch",center:e});const a=this.parent.plugins.get("clamp-zoom",!0);if(a&&a.clamp(),this.options.center)this.parent.moveCenter(this.options.center);else{const n=this.parent.toGlobal(t);this.parent.x+=(e.x-n.x)*this.options.factor,this.parent.y+=(e.y-n.y)*this.options.factor,this.parent.emit("moved",{viewport:this.parent,type:"pinch"})}!this.options.noDrag&&this.lastCenter&&(this.parent.x+=(e.x-this.lastCenter.x)*this.options.factor,this.parent.y+=(e.y-this.lastCenter.y)*this.options.factor,this.parent.emit("moved",{viewport:this.parent,type:"pinch"})),this.lastCenter=e,this.moved=!0}else this.pinching||(this.parent.emit("pinch-start",this.parent),this.pinching=!0);return!0}return!1}up(){return!!(this.pinching&&this.parent.input.touches.length<=1)&&(this.active=!1,this.lastCenter=null,this.pinching=!1,this.moved=!1,this.parent.emit("pinch-end",this.parent),!0)}}const tc={topLeft:!1,friction:.8,time:1e3,ease:"easeInOutSine",interrupt:!0,removeOnComplete:!1,removeOnInterrupt:!1,forceStart:!1};class ec extends Lh{constructor(t,e,n,i={}){super(t),this.options=Object.assign({},tc,i),this.ease=Mh(i.ease,"easeInOutSine"),this.x=e,this.y=n,this.options.forceStart&&this.snapStart()}snapStart(){this.percent=0,this.snapping={time:0};const t=this.options.topLeft?this.parent.corner:this.parent.center;this.deltaX=this.x-t.x,this.deltaY=this.y-t.y,this.startX=t.x,this.startY=t.y,this.parent.emit("snap-start",this.parent)}wheel(){return this.options.removeOnInterrupt&&this.parent.plugins.remove("snap"),!1}down(){return this.options.removeOnInterrupt?this.parent.plugins.remove("snap"):this.options.interrupt&&(this.snapping=null),!1}up(){if(0===this.parent.input.count()){const t=this.parent.plugins.get("decelerate",!0);t&&(t.x||t.y)&&(t.percentChangeX=t.percentChangeY=this.options.friction)}return!1}update(t){if(!(this.paused||this.options.interrupt&&0!==this.parent.input.count()))if(this.snapping){const e=this.snapping;let n,i,r;e.time+=t;const o=this.startX,s=this.startY,a=this.deltaX,l=this.deltaY;if(e.time>this.options.time)n=!0,i=o+a,r=s+l;else{const t=this.ease(e.time,0,1,this.options.time);i=o+a*t,r=s+l*t}this.options.topLeft?this.parent.moveCorner(i,r):this.parent.moveCenter(i,r),this.parent.emit("moved",{viewport:this.parent,type:"snap"}),n&&(this.options.removeOnComplete&&this.parent.plugins.remove("snap"),this.parent.emit("snap-end",this.parent),this.snapping=null)}else{const t=this.options.topLeft?this.parent.corner:this.parent.center;(t.x!==this.x||t.y!==this.y)&&this.snapStart()}}}const nc={width:0,height:0,time:1e3,ease:"easeInOutSine",center:null,interrupt:!0,removeOnComplete:!1,removeOnInterrupt:!1,forceStart:!1,noMove:!1};class ic extends Lh{constructor(t,e={}){super(t),this.options=Object.assign({},nc,e),this.ease=Mh(this.options.ease),this.xIndependent=!1,this.yIndependent=!1,this.xScale=0,this.yScale=0,this.options.width>0&&(this.xScale=t.screenWidth/this.options.width,this.xIndependent=!0),this.options.height>0&&(this.yScale=t.screenHeight/this.options.height,this.yIndependent=!0),this.xScale=this.xIndependent?this.xScale:this.yScale,this.yScale=this.yIndependent?this.yScale:this.xScale,0===this.options.time?(t.container.scale.x=this.xScale,t.container.scale.y=this.yScale,this.options.removeOnComplete&&this.parent.plugins.remove("snap-zoom")):e.forceStart&&this.createSnapping()}createSnapping(){const t=this.parent.worldScreenWidth,e=this.parent.worldScreenHeight,n=this.parent.screenWidth/this.xScale,i=this.parent.screenHeight/this.yScale;this.snapping={time:0,startX:t,startY:e,deltaX:n-t,deltaY:i-e},this.parent.emit("snap-zoom-start",this.parent)}resize(){this.snapping=null,this.options.width>0&&(this.xScale=this.parent.screenWidth/this.options.width),this.options.height>0&&(this.yScale=this.parent.screenHeight/this.options.height),this.xScale=this.xIndependent?this.xScale:this.yScale,this.yScale=this.yIndependent?this.yScale:this.xScale}wheel(){return this.options.removeOnInterrupt&&this.parent.plugins.remove("snap-zoom"),!1}down(){return this.options.removeOnInterrupt?this.parent.plugins.remove("snap-zoom"):this.options.interrupt&&(this.snapping=null),!1}update(t){if(this.paused||this.options.interrupt&&0!==this.parent.input.count())return;let e;if(!this.options.center&&!this.options.noMove&&(e=this.parent.center),this.snapping){if(this.snapping){const n=this.snapping;if(n.time+=t,n.time>=this.options.time)this.parent.scale.set(this.xScale,this.yScale),this.options.removeOnComplete&&this.parent.plugins.remove("snap-zoom"),this.parent.emit("snap-zoom-end",this.parent),this.snapping=null;else{const t=this.snapping,e=this.ease(t.time,t.startX,t.deltaX,this.options.time),n=this.ease(t.time,t.startY,t.deltaY,this.options.time);this.parent.scale.x=this.parent.screenWidth/e,this.parent.scale.y=this.parent.screenHeight/n}const i=this.parent.plugins.get("clamp-zoom",!0);i&&i.clamp(),this.options.noMove||(this.options.center?this.parent.moveCenter(this.options.center):this.parent.moveCenter(e))}}else(this.parent.scale.x!==this.xScale||this.parent.scale.y!==this.yScale)&&this.createSnapping()}resume(){this.snapping=null,super.resume()}}const rc={percent:.1,smooth:!1,interrupt:!0,reverse:!1,center:null,lineHeight:20,axis:"all",keyToPress:null,trackpadPinch:!1,wheelZoom:!0};class oc extends Lh{constructor(t,e={}){super(t),this.options=Object.assign({},rc,e),this.keyIsPressed=!1,this.options.keyToPress&&this.handleKeyPresses(this.options.keyToPress)}handleKeyPresses(t){window.addEventListener("keydown",(e=>{t.includes(e.code)&&(this.keyIsPressed=!0)})),window.addEventListener("keyup",(e=>{t.includes(e.code)&&(this.keyIsPressed=!1)}))}checkKeyPress(){return!this.options.keyToPress||this.keyIsPressed}down(){return this.options.interrupt&&(this.smoothing=null),!1}isAxisX(){return["all","x"].includes(this.options.axis)}isAxisY(){return["all","y"].includes(this.options.axis)}update(){if(this.smoothing){const t=this.smoothingCenter,e=this.smoothing;let n;this.options.center||(n=this.parent.toLocal(t)),this.isAxisX()&&(this.parent.scale.x+=e.x),this.isAxisY()&&(this.parent.scale.y+=e.y),this.parent.emit("zoomed",{viewport:this.parent,type:"wheel"});const i=this.parent.plugins.get("clamp-zoom",!0);if(i&&i.clamp(),this.options.center)this.parent.moveCenter(this.options.center);else{const e=this.parent.toGlobal(n);this.parent.x+=t.x-e.x,this.parent.y+=t.y-e.y}this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.smoothingCount++,this.smoothingCount>=this.options.smooth&&(this.smoothing=null)}}pinch(t){if(this.paused)return;const e=this.parent.input.getPointerPosition(t),n=-t.deltaY*(t.deltaMode?this.options.lineHeight:1)/200,i=Math.pow(2,(1+this.options.percent)*n);let r;this.options.center||(r=this.parent.toLocal(e)),this.isAxisX()&&(this.parent.scale.x*=i),this.isAxisY()&&(this.parent.scale.y*=i),this.parent.emit("zoomed",{viewport:this.parent,type:"wheel"});const o=this.parent.plugins.get("clamp-zoom",!0);if(o&&o.clamp(),this.options.center)this.parent.moveCenter(this.options.center);else{const t=this.parent.toGlobal(r);this.parent.x+=e.x-t.x,this.parent.y+=e.y-t.y}this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.parent.emit("wheel",{wheel:{dx:t.deltaX,dy:t.deltaY,dz:t.deltaZ},event:t,viewport:this.parent})}wheel(t){if(this.paused||!this.checkKeyPress())return!1;if(t.ctrlKey&&this.options.trackpadPinch)this.pinch(t);else if(this.options.wheelZoom){const e=this.parent.input.getPointerPosition(t),n=(this.options.reverse?-1:1)*-t.deltaY*(t.deltaMode?this.options.lineHeight:1)/500,i=Math.pow(2,(1+this.options.percent)*n);if(this.options.smooth){const t={x:this.smoothing?this.smoothing.x*(this.options.smooth-this.smoothingCount):0,y:this.smoothing?this.smoothing.y*(this.options.smooth-this.smoothingCount):0};this.smoothing={x:((this.parent.scale.x+t.x)*i-this.parent.scale.x)/this.options.smooth,y:((this.parent.scale.y+t.y)*i-this.parent.scale.y)/this.options.smooth},this.smoothingCount=0,this.smoothingCenter=e}else{let t;this.options.center||(t=this.parent.toLocal(e)),this.isAxisX()&&(this.parent.scale.x*=i),this.isAxisY()&&(this.parent.scale.y*=i),this.parent.emit("zoomed",{viewport:this.parent,type:"wheel"});const n=this.parent.plugins.get("clamp-zoom",!0);if(n&&n.clamp(),this.options.center)this.parent.moveCenter(this.options.center);else{const n=this.parent.toGlobal(t);this.parent.x+=e.x-n.x,this.parent.y+=e.y-n.y}}this.parent.emit("moved",{viewport:this.parent,type:"wheel"}),this.parent.emit("wheel",{wheel:{dx:t.deltaX,dy:t.deltaY,dz:t.deltaZ},event:t,viewport:this.parent})}return!this.parent.options.passiveWheel}}class sc{constructor(t){this.viewport=t,this.touches=[],this.addListeners()}addListeners(){this.viewport.interactive=!0,this.viewport.forceHitArea||(this.viewport.hitArea=new xi(0,0,this.viewport.worldWidth,this.viewport.worldHeight)),this.viewport.on("pointerdown",this.down,this),this.viewport.on("pointermove",this.move,this),this.viewport.on("pointerup",this.up,this),this.viewport.on("pointerupoutside",this.up,this),this.viewport.on("pointercancel",this.up,this),this.viewport.on("pointerout",this.up,this),this.wheelFunction=t=>this.handleWheel(t),this.viewport.options.divWheel.addEventListener("wheel",this.wheelFunction,{passive:this.viewport.options.passiveWheel}),this.isMouseDown=!1}destroy(){this.viewport.options.divWheel.removeEventListener("wheel",this.wheelFunction)}down(t){if(!this.viewport.pause&&this.viewport.worldVisible){if("mouse"===t.data.pointerType?this.isMouseDown=!0:this.get(t.data.pointerId)||this.touches.push({id:t.data.pointerId,last:null}),1===this.count()){this.last=t.data.global.clone();const e=this.viewport.plugins.get("decelerate",!0),n=this.viewport.plugins.get("bounce",!0);e&&e.isActive()||n&&n.isActive()?this.clickedAvailable=!1:this.clickedAvailable=!0}else this.clickedAvailable=!1;this.viewport.plugins.down(t)&&this.viewport.options.stopPropagation&&t.stopPropagation()}}clear(){this.isMouseDown=!1,this.touches=[],this.last=null}checkThreshold(t){return Math.abs(t)>=this.viewport.threshold}move(t){if(this.viewport.pause||!this.viewport.worldVisible)return;const e=this.viewport.plugins.move(t);if(this.clickedAvailable&&this.last){const e=t.data.global.x-this.last.x,n=t.data.global.y-this.last.y;(this.checkThreshold(e)||this.checkThreshold(n))&&(this.clickedAvailable=!1)}e&&this.viewport.options.stopPropagation&&t.stopPropagation()}up(t){if(this.viewport.pause||!this.viewport.worldVisible)return;"mouse"===t.data.pointerType&&(this.isMouseDown=!1),"mouse"!==t.data.pointerType&&this.remove(t.data.pointerId);const e=this.viewport.plugins.up(t);this.clickedAvailable&&0===this.count()&&this.last&&(this.viewport.emit("clicked",{event:t,screen:this.last,world:this.viewport.toWorld(this.last),viewport:this}),this.clickedAvailable=!1),e&&this.viewport.options.stopPropagation&&t.stopPropagation()}getPointerPosition(t){const e=new Ti;return this.viewport.options.interaction?this.viewport.options.interaction.mapPositionToPoint(e,t.clientX,t.clientY):(e.x=t.clientX,e.y=t.clientY),e}handleWheel(t){if(this.viewport.pause||!this.viewport.worldVisible||this.viewport.options.interaction&&this.viewport.options.interaction.interactionDOMElement!==t.target)return;const e=this.viewport.toLocal(this.getPointerPosition(t));this.viewport.left<=e.x&&e.x<=this.viewport.right&&this.viewport.top<=e.y&&e.y<=this.viewport.bottom&&this.viewport.plugins.wheel(t)&&!this.viewport.options.passiveWheel&&t.preventDefault()}pause(){this.touches=[],this.isMouseDown=!1}get(t){for(const e of this.touches)if(e.id===t)return e;return null}remove(t){for(let e=0;e<this.touches.length;e++)if(this.touches[e].id===t)return void this.touches.splice(e,1)}count(){return(this.isMouseDown?1:0)+this.touches.length}}function ac(t){let e,n=t[0],i=1;for(;i<t.length;){const r=t[i],o=t[i+1];if(i+=2,("optionalAccess"===r||"optionalCall"===r)&&null==n)return;"access"===r||"optionalAccess"===r?(e=n,n=o(n)):("call"===r||"optionalCall"===r)&&(n=o(((...t)=>n.call(e,...t))),e=void 0)}return n}const lc=["drag","pinch","wheel","follow","mouse-edges","decelerate","animate","bounce","snap-zoom","clamp-zoom","snap","clamp"];class uc{constructor(t){this.viewport=t,this.list=[],this.plugins={}}add(t,e,n=lc.length){this.plugins[t]=e;const i=lc.indexOf(t);-1!==i&&lc.splice(i,1),lc.splice(n,0,t),this.sort()}get(t,e){return e&&ac([this,"access",t=>t.plugins,"access",e=>e[t],"optionalAccess",t=>t.paused])?null:this.plugins[t]}update(t){for(const e of this.list)e.update(t)}resize(){for(const t of this.list)t.resize()}reset(){for(const t of this.list)t.reset()}removeAll(){this.plugins={},this.sort()}remove(t){this.plugins[t]&&(delete this.plugins[t],this.viewport.emit(`${t}-remove`),this.sort())}pause(t){ac([this,"access",t=>t.plugins,"access",e=>e[t],"optionalAccess",t=>t.pause,"call",t=>t()])}resume(t){ac([this,"access",t=>t.plugins,"access",e=>e[t],"optionalAccess",t=>t.resume,"call",t=>t()])}sort(){this.list=[];for(const t of lc)this.plugins[t]&&this.list.push(this.plugins[t])}down(t){let e=!1;for(const n of this.list)n.down(t)&&(e=!0);return e}move(t){let e=!1;for(const n of this.viewport.plugins.list)n.move(t)&&(e=!0);return e}up(t){let e=!1;for(const n of this.list)n.up(t)&&(e=!0);return e}wheel(t){let e=!1;for(const n of this.list)n.wheel(t)&&(e=!0);return e}}const hc={screenWidth:window.innerWidth,screenHeight:window.innerHeight,worldWidth:null,worldHeight:null,threshold:5,passiveWheel:!0,stopPropagation:!1,forceHitArea:null,noTicker:!1,interaction:null,disableOnContextMenu:!1,ticker:we.shared};class cc extends lr{__init(){this._disableOnContextMenu=t=>t.preventDefault()}constructor(t={}){super(),cc.prototype.__init.call(this),this.options=Object.assign({},{divWheel:document.body},hc,t),this.screenWidth=this.options.screenWidth,this.screenHeight=this.options.screenHeight,this._worldWidth=this.options.worldWidth,this._worldHeight=this.options.worldHeight,this.forceHitArea=this.options.forceHitArea,this.threshold=this.options.threshold,this.options.divWheel=this.options.divWheel||document.body,this.options.disableOnContextMenu&&this.options.divWheel.addEventListener("contextmenu",this._disableOnContextMenu),this.options.noTicker||(this.tickerFunction=()=>this.update(this.options.ticker.elapsedMS),this.options.ticker.add(this.tickerFunction)),this.input=new sc(this),this.plugins=new uc(this)}destroy(t){!this.options.noTicker&&this.tickerFunction&&this.options.ticker.remove(this.tickerFunction),this.options.disableOnContextMenu&&this.options.divWheel.removeEventListener("contextmenu",this._disableOnContextMenu),this.input.destroy(),super.destroy(t)}update(t){this.pause||(this.plugins.update(t),this.lastViewport&&(this.lastViewport.x!==this.x||this.lastViewport.y!==this.y?this.moving=!0:this.moving&&(this.emit("moved-end",this),this.moving=!1),this.lastViewport.scaleX!==this.scale.x||this.lastViewport.scaleY!==this.scale.y?this.zooming=!0:this.zooming&&(this.emit("zoomed-end",this),this.zooming=!1)),this.forceHitArea||(this._hitAreaDefault=new xi(this.left,this.top,this.worldScreenWidth,this.worldScreenHeight),this.hitArea=this._hitAreaDefault),this._dirty=this._dirty||!this.lastViewport||this.lastViewport.x!==this.x||this.lastViewport.y!==this.y||this.lastViewport.scaleX!==this.scale.x||this.lastViewport.scaleY!==this.scale.y,this.lastViewport={x:this.x,y:this.y,scaleX:this.scale.x,scaleY:this.scale.y},this.emit("frame-end",this))}resize(t=window.innerWidth,e=window.innerHeight,n,i){this.screenWidth=t,this.screenHeight=e,typeof n<"u"&&(this._worldWidth=n),typeof i<"u"&&(this._worldHeight=i),this.plugins.resize(),this.dirty=!0}get worldWidth(){return this._worldWidth?this._worldWidth:this.width/this.scale.x}set worldWidth(t){this._worldWidth=t,this.plugins.resize()}get worldHeight(){return this._worldHeight?this._worldHeight:this.height/this.scale.y}set worldHeight(t){this._worldHeight=t,this.plugins.resize()}getVisibleBounds(){return new xi(this.left,this.top,this.worldScreenWidth,this.worldScreenHeight)}toWorld(t,e){return 2===arguments.length?this.toLocal(new Ti(t,e)):this.toLocal(t)}toScreen(t,e){return 2===arguments.length?this.toGlobal(new Ti(t,e)):this.toGlobal(t)}get worldScreenWidth(){return this.screenWidth/this.scale.x}get worldScreenHeight(){return this.screenHeight/this.scale.y}get screenWorldWidth(){return this.worldWidth*this.scale.x}get screenWorldHeight(){return this.worldHeight*this.scale.y}get center(){return new Ti(this.worldScreenWidth/2-this.x/this.scale.x,this.worldScreenHeight/2-this.y/this.scale.y)}set center(t){this.moveCenter(t)}moveCenter(...t){let e,n;"number"==typeof t[0]?(e=t[0],n=t[1]):(e=t[0].x,n=t[0].y);const i=(this.worldScreenWidth/2-e)*this.scale.x,r=(this.worldScreenHeight/2-n)*this.scale.y;return(this.x!==i||this.y!==r)&&(this.position.set(i,r),this.plugins.reset(),this.dirty=!0),this}get corner(){return new Ti(-this.x/this.scale.x,-this.y/this.scale.y)}set corner(t){this.moveCorner(t)}moveCorner(...t){let e,n;return 1===t.length?(e=-t[0].x*this.scale.x,n=-t[0].y*this.scale.y):(e=-t[0]*this.scale.x,n=-t[1]*this.scale.y),(e!==this.x||n!==this.y)&&(this.position.set(e,n),this.plugins.reset(),this.dirty=!0),this}get screenWidthInWorldPixels(){return this.screenWidth/this.scale.x}get screenHeightInWorldPixels(){return this.screenHeight/this.scale.y}findFitWidth(t){return this.screenWidth/t}findFitHeight(t){return this.screenHeight/t}findFit(t,e){const n=this.screenWidth/t,i=this.screenHeight/e;return Math.min(n,i)}findCover(t,e){const n=this.screenWidth/t,i=this.screenHeight/e;return Math.max(n,i)}fitWidth(t=this.worldWidth,e,n=!0,i){let r;e&&(r=this.center),this.scale.x=this.screenWidth/t,n&&(this.scale.y=this.scale.x);const o=this.plugins.get("clamp-zoom",!0);return!i&&o&&o.clamp(),e&&r&&this.moveCenter(r),this}fitHeight(t=this.worldHeight,e,n=!0,i){let r;e&&(r=this.center),this.scale.y=this.screenHeight/t,n&&(this.scale.x=this.scale.y);const o=this.plugins.get("clamp-zoom",!0);return!i&&o&&o.clamp(),e&&r&&this.moveCenter(r),this}fitWorld(t){let e;t&&(e=this.center),this.scale.x=this.screenWidth/this.worldWidth,this.scale.y=this.screenHeight/this.worldHeight,this.scale.x<this.scale.y?this.scale.y=this.scale.x:this.scale.x=this.scale.y;const n=this.plugins.get("clamp-zoom",!0);return n&&n.clamp(),t&&e&&this.moveCenter(e),this}fit(t,e=this.worldWidth,n=this.worldHeight){let i;t&&(i=this.center),this.scale.x=this.screenWidth/e,this.scale.y=this.screenHeight/n,this.scale.x<this.scale.y?this.scale.y=this.scale.x:this.scale.x=this.scale.y;const r=this.plugins.get("clamp-zoom",!0);return r&&r.clamp(),t&&i&&this.moveCenter(i),this}setZoom(t,e){let n;e&&(n=this.center),this.scale.set(t);const i=this.plugins.get("clamp-zoom",!0);return i&&i.clamp(),e&&n&&this.moveCenter(n),this}zoomPercent(t,e){return this.setZoom(this.scale.x+this.scale.x*t,e)}zoom(t,e){return this.fitWidth(t+this.worldScreenWidth,e),this}get scaled(){return this.scale.x}set scaled(t){this.setZoom(t,!0)}snapZoom(t){return this.plugins.add("snap-zoom",new ic(this,t)),this}OOB(){return{left:this.left<0,right:this.right>this.worldWidth,top:this.top<0,bottom:this.bottom>this.worldHeight,cornerPoint:new Ti(this.worldWidth*this.scale.x-this.screenWidth,this.worldHeight*this.scale.y-this.screenHeight)}}get right(){return-this.x/this.scale.x+this.worldScreenWidth}set right(t){this.x=-t*this.scale.x+this.screenWidth,this.plugins.reset()}get left(){return-this.x/this.scale.x}set left(t){this.x=-t*this.scale.x,this.plugins.reset()}get top(){return-this.y/this.scale.y}set top(t){this.y=-t*this.scale.y,this.plugins.reset()}get bottom(){return-this.y/this.scale.y+this.worldScreenHeight}set bottom(t){this.y=-t*this.scale.y+this.screenHeight,this.plugins.reset()}get dirty(){return!!this._dirty}set dirty(t){this._dirty=t}get forceHitArea(){return this._forceHitArea}set forceHitArea(t){t?(this._forceHitArea=t,this.hitArea=t):(this._forceHitArea=null,this.hitArea=new xi(0,0,this.worldWidth,this.worldHeight))}drag(t){return this.plugins.add("drag",new Vh(this,t)),this}clamp(t){return this.plugins.add("clamp",new zh(this,t)),this}decelerate(t){return this.plugins.add("decelerate",new Wh(this,t)),this}bounce(t){return this.plugins.add("bounce",new Bh(this,t)),this}pinch(t){return this.plugins.add("pinch",new Jh(this,t)),this}snap(t,e,n){return this.plugins.add("snap",new ec(this,t,e,n)),this}follow(t,e){return this.plugins.add("follow",new $h(this,t,e)),this}wheel(t){return this.plugins.add("wheel",new oc(this,t)),this}animate(t){return this.plugins.add("animate",new kh(this,t)),this}clampZoom(t){return this.plugins.add("clamp-zoom",new Yh(this,t)),this}mouseEdges(t){return this.plugins.add("mouse-edges",new Kh(this,t)),this}get pause(){return!!this._pause}set pause(t){this._pause=t,this.lastViewport=null,this.moving=!1,this.zooming=!1,t&&this.input.pause()}ensureVisible(t,e,n,i,r){r&&(n>this.worldScreenWidth||i>this.worldScreenHeight)&&(this.fit(!0,n,i),this.emit("zoomed",{viewport:this,type:"ensureVisible"}));let o=!1;t<this.left?(this.left=t,o=!0):t+n>this.right&&(this.right=t+n,o=!0),e<this.top?(this.top=e,o=!0):e+i>this.bottom&&(this.bottom=e+i,o=!0),o&&this.emit("moved",{viewport:this,type:"ensureVisible"})}}const pc=100;var dc={exports:{}};function fc(){}fc.prototype={on:function(t,e,n){var i=this.e||(this.e={});return(i[t]||(i[t]=[])).push({fn:e,ctx:n}),this},once:function(t,e,n){var i=this;function r(){i.off(t,r),e.apply(n,arguments)}return r._=e,this.on(t,r,n)},emit:function(t){for(var e=[].slice.call(arguments,1),n=((this.e||(this.e={}))[t]||[]).slice(),i=0,r=n.length;i<r;i++)n[i].fn.apply(n[i].ctx,e);return this},off:function(t,e){var n=this.e||(this.e={}),i=n[t],r=[];if(i&&e)for(var o=0,s=i.length;o<s;o++)i[o].fn!==e&&i[o].fn._!==e&&r.push(i[o]);return r.length?n[t]=r:delete n[t],this}},dc.exports=fc;var mc=dc.exports.TinyEmitter=fc;class yc extends mc{constructor({floorPlan:t,helperId:e}){super(),this.floorPlan=t,this.helperId=e}destroy(){delete this.floorPlan.helper[this.helperId],this.floorPlan=null}}class gc extends yc{constructor({floorPlan:t,parentEl:e,helperId:n}){super({floorPlan:t,helperId:n}),e&&t&&(this.data={cursor:["0","0"]},this.floorPlan.on("mousemove",this.update,this),this.mount(e),this.update())}update(){!this.rootEl||this.setData({cursor:[v(this.floorPlan.interaction.cursor[0],this.floorPlan.settings.units.system,this.floorPlan.settings.units.lengthDecimals),v(this.floorPlan.interaction.cursor[1],this.floorPlan.settings.units.system,this.floorPlan.settings.units.lengthDecimals)]})}setData(t={}){for(let e in t)this.data[e]=t[e];this.rootEl.innerHTML=this.template(this.data)}template(t={}){return`<span class="fpe-coordinates__unit">x:${t.cursor[0]}</span>\n    <span class="fpe-coordinates__unit">z:${t.cursor[1]}</span>`}mount(t){this.rootEl||(this.rootEl=document.createElement("div"),this.rootEl.classList.add("fpe-coordinates"),t.appendChild(this.rootEl))}destroy(){this.floorPlan.off("mousemove",this.update),this.rootEl.remove(),delete this.floorPlan,delete this.data}}class vc extends yc{constructor({floorPlan:t,parentEl:e,helperId:n}){super({floorPlan:t,helperId:n}),e&&t&&(this.data={width:10,height:.4,margin:.2,style:"lines",box:{},scaleStep:null,scaleDisplay:null,steps:[],leftHanded:!1,isImperial:"imperial"===t.settings.units.system},this.floorPlan.view.on("zoom",this.update,this),this.floorPlan.on("update-settings",this.update,this),this.mount(e),this.update())}update(){this.data.isImperial="imperial"===this.floorPlan.settings.units.system;const t=this.data.isImperial?3.28084:1;if(!this.floorPlan.view.viewbox||!this.floorPlan.view.viewbox.length)return;this.data.box=this.floorPlan.view.viewbox;const e=Math.min(this.floorPlan.view.client[0],this.floorPlan.view.client[1]),n=Math.min(this.data.box.length,this.data.box.width),i=e/n;if(!i)return;const r=200/i;this.data.scaleStep=n<=2.5/t?.1/t:n<=5.4/t?.2/t:n<=12/t?.5/t:n<=25/t?1/t:n<=50/t?2/t:n<=100/t?5/t:n<=200/t?10/t:n<=550/t?20/t:50/t,this.data.scaleDisplay=this.data.scaleStep*t;const o=this.data.width,s=o*this.data.scaleStep/r,a=this.leftHanded?0:o;let l=0,u=[];if(this.data.leftHanded)for(;l<o-s;){let t=s<o-l?s:o-l;u.push([l+a,t]),l+=s}else for(;l>-o+s;){let t=s;u.push([l+a,-t]),l-=s}this.data.steps=u,this.setData()}setData(t={}){for(let e in t)this.data[e]=t[e];this.rootEl.setAttribute("viewBox",`-${this.data.margin} -${3*this.data.margin} ${this.data.width+2*this.data.margin} ${this.data.height+2*this.data.margin}`),this.rootEl.innerHTML=this.template(this.data)}template(t={}){let e="";return t.steps[0]&&(e+=`<rect\n      class="fpe-scale-bar__background"\n      style="fill:${this.backgroundClr()}"\n      y="${2.5*-t.height}"\n      x="${t.width+t.steps[0][1]-t.margin}"\n      width="${-t.steps[0][1]+2*t.margin}"\n      height="${4*t.height}"\n    />`),e+=`<text x="${t.leftHanded?0:t.width}" text-anchor="${t.leftHanded?"start":"end"}" y="-0.3">\n      ${t.scaleDisplay} ${t.isImperial?"ft":"m"}\n    </text>`,"lines"===t.style&&(e+=`<path d="${this.stepStr(t.steps)}" />`),"solid"===t.style&&(e+="<g>",t.steps.forEach(((t,n)=>{e+=`<rect\n        class="${n%2!=0?"white":""}"\n        x="${t[0]}"\n        y="0"\n        width="${t[1]}"\n        height="0.5"\n      />`})),e+="</g>"),e}backgroundClr(){let t=this.floorPlan.settings&&function(t,e=1){if(function(t){return null!==x(t).match(/^#[a-f0-9]{6}$/i)}(t)){const{r:n,g:i,b:r}=function(t){const e=x(t),n={r:parseInt(e.substring(1,3),16),g:parseInt(e.substring(3,5),16),b:parseInt(e.substring(5,7),16)};if(function({r:t,g:e,b:n}){return b(t)&&b(e)&&b(n)}(n))return n;throw"invalid hex color input"}(t);return`rgba(${n},${i},${r},${e})`}}(this.floorPlan.settings.theme.background.color);return t||(t="rgba(255, 255, 255, 0.8)"),t+"!important"}stepStr(t){if(!t)return"";let e="",n=this.data.height;return t.forEach(((t,i)=>{if(i>=1&&!this.data.leftHanded)return;t=t.map((t=>Math.round(1e3*t)/1e3));let r=i%2==0?0:n,o=i%2==0?n:0;0===i&&(e+=`M ${t[0]} ${n} L ${t[0]} 0`),e+=`L ${t[0]+t[1]} ${r} `,e+=`L ${t[0]+t[1]} ${o} `})),e}mount(t){this.rootEl||(this.rootEl=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.rootEl.classList.add("fpe-scale-bar"),t.appendChild(this.rootEl))}destroy(){this.floorPlan.view.off("viewbox",this.update),this.floorPlan.off("update-settings",this.update),this.rootEl.remove(),delete this.floorPlan.helper.scaleBar,delete this.floorPlan,delete this.data}}class _c{constructor({width:t,height:e,pos:n=[0,0],html:i="",closeButton:r=!0,floorPlan:o}={}){this._floorPlan=o,this.pos=n,this.html=i,this.closeButton=r,this._anchorPos=null;let s=t||100;this.width=Math.max(100,s);let a=e||80;this.height=Math.max(50,a),this._getPosition=()=>{this._anchorPos=this._floorPlan.getScreenPosition(this.pos),this._updateInfoWindow()},this._getPosition(),this._createInfoWindow(),this._floorPlan.view.on("viewbox",this._getPosition,this),this._floorPlan.view.on("resize-canvas",this._getPosition,this)}_createInfoWindow(){const t=document.querySelector(`#${this._floorPlan.fpeId}.fpe`),e=t.querySelector("canvas");this.el||(this.el=document.createElement("div"),this.el.classList.add("fpe-info-window"),t.appendChild(this.el),this.el.addEventListener("wheel",(t=>{let n=new WheelEvent(t.type,t);e.dispatchEvent(n)}))),this._setContent(),this._updateInfoWindow()}_setContent(){let t=`<div class="fpe-info-window__content">${this.html}</div>`;this.closeButton&&(t+='<div class="fpe-info-window__close" @click="infoWindow.remove"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 40 40">\n  <g fill="none" stroke="#000" stroke-width="1.2" stroke-miterlimit="10">\n    <path d="M11.8 11.8l16.4 16.4M11.8 28.2l16.3-16.4" />\n  </g>\n</svg></div>'),this.el.innerHTML=t;const e=this.el.querySelector(".fpe-info-window__close");e&&e.addEventListener("click",this.remove.bind(this))}_updateInfoWindow(){if(!this.el)return;const t=this._floorPlan.interaction.isPanning?"pointer-events: none;":"",e=this._anchorPos[0]-47,n=this._anchorPos[1]-this.height-15,i=1e3+2*this.pos[1],r=this.height,o=this.width;this.el.setAttribute("style",`transform: translate(${e}px, ${n}px);${t} height:${r}px; width:${o}px; z-index:${i}`)}set({width:t,height:e,pos:n,html:i,closeButton:r}){void 0!==n&&(this.pos=n),void 0!==t&&(this.width=Math.max(100,t)),void 0!==e&&(this.height=Math.max(50,e)),void 0!==i&&(this.html=i),void 0!==r&&(this.closeButton=r),(void 0!==i||void 0!==r)&&this._setContent(),this._getPosition()}remove(){this._floorPlan.view.off("viewbox",this._getPosition),this._floorPlan.view.off("resize-canvas",this._getPosition),this.el.remove(),this._floorPlan=null}}class xc{constructor({pos:t=[0,0],offset:e=[0,0],el:n,floorPlan:i}){if(this._updateHtmlMarker=()=>{!this.el||(this.isHidden=!(([t,e],n,i=0)=>n.x-i<t&&n.x+n.length+i>t&&n.z-i<e&&n.z+n.width+i>e)(this.pos,this._floorPlan.view.viewbox,5),this.el.classList.toggle("fpe-marker--hidden",this.isHidden),this.isHidden||(this._anchorPos=this._floorPlan.getScreenPosition(this.pos),this._updateHtmlMarkerStyle()))},!i)return;if(!(n instanceof HTMLElement))return void console.warn("no Element provided");this.el=n;const r=document.querySelector(`#${i.fpeId}.fpe`),o=r.querySelector("canvas");r.appendChild(this.el),this.el.classList.add("fpe-marker");const{width:s,height:a}=n.getBoundingClientRect();this.el.addEventListener("wheel",(t=>{let e=new WheelEvent(t.type,t);o.dispatchEvent(e)})),this.id=gt(),this._floorPlan=i,this.pos=t,this.size=[s,a],this.offset=e,this._updateHtmlMarker(),this._floorPlan.view.on("viewbox",this._updateHtmlMarker),this._floorPlan.on("drag-end",this._updateHtmlMarker),this._floorPlan.view.on("resize-canvas",this._updateHtmlMarker)}_updateHtmlMarkerStyle(){const t=this._floorPlan.interaction.isPanning,e=this.offset?this.offset:[0,0],n=this._anchorPos[0]-this.size[0]/2+e[0],i=this._anchorPos[1]-this.size[1]/2+e[1];this.el.style.pointerEvents=t?"none":"",this.el.style.transform=`translate(${n}px, ${i}px)`}set({pos:t,offset:e}){void 0!==t&&(this.pos=t),void 0!==e&&(this.offset=e),this._updateHtmlMarker()}remove(){this._floorPlan.view.off("viewbox",this._updateHtmlMarker),this._floorPlan.view.off("resize-canvas",this._updateHtmlMarker),this._floorPlan.off("drag-end",this._updateHtmlMarker),this.el.remove(),this._floorPlan=null}}(function(t){var e=t.ShaderSystem;if(!e)throw new Error("Unable to patch ShaderSystem, class not found.");Object.assign(e.prototype,{systemCheck:function(){},syncUniforms:function(t,e){var n=this.shader,i=this.renderer;!function(t,e,n,i,r){var o=0,s=null,a=null,l=r.gl;for(var u in t.uniforms){var h=e[u],c=i[u],p=n[u],d=t.uniforms[u];h?"float"===h.type&&1===h.size?c!==p.value&&(p.value=c,l.uniform1f(p.location,c)):"sampler2D"!==h.type&&"samplerCube"!==h.type&&"sampler2DArray"!==h.type||1!==h.size||h.isArray?"mat3"===h.type&&1===h.size?void 0!==d.a?l.uniformMatrix3fv(p.location,!1,c.toArray(!0)):l.uniformMatrix3fv(p.location,!1,c):"vec2"===h.type&&1===h.size?void 0!==d.x?(s=c,((a=p.value)[0]!==s.x||a[1]!==s.y)&&(a[0]=s.x,a[1]=s.y,l.uniform2f(p.location,s.x,s.y))):(s=c,((a=p.value)[0]!==s[0]||a[1]!==s[1])&&(a[0]=s[0],a[1]=s[1],l.uniform2f(p.location,s[0],s[1]))):"vec4"===h.type&&1===h.size?void 0!==d.width?(s=c,((a=p.value)[0]!==s.x||a[1]!==s.y||a[2]!==s.width||a[3]!==s.height)&&(a[0]=s.x,a[1]=s.y,a[2]=s.width,a[3]=s.height,l.uniform4f(p.location,s.x,s.y,s.width,s.height))):(s=c,((a=p.value)[0]!==s[0]||a[1]!==s[1]||a[2]!==s[2]||a[3]!==s[3])&&(a[0]=s[0],a[1]=s[1],a[2]=s[2],a[3]=s[3],l.uniform4f(p.location,s[0],s[1],s[2],s[3]))):(1===h.size?pa:da)[h.type].call(null,l,p.location,p.value,c):(r.texture.bind(c,o),p.value!==o&&(p.value=o,l.uniform1i(p.location,o)),o++):d.group&&r.shader.syncUniformGroup(c)}}(t,n.program.uniformData,e.uniformData,t.uniforms,i)}})})({ShaderSystem:Jo}),ls.registerPlugin("batch",vs),ls.registerPlugin("interaction",ba),Ca.registerPlugin("extract",La),Ca.registerPlugin("graphics",Ra),Ca.registerPlugin("prepare",Ka),Ca.registerPlugin("sprite",Ja),Ca.registerPlugin("interaction",ba);const bc={ColorMatrixFilter:el};!function(t){if(!t)return void console.log("@pixi/layers: Canvas mixin was called with empty parameter. Are you sure that you even need this line?");rl(t);const e=lr.prototype;e.containerRenderCanvas||(e.containerRenderCanvas=e.renderCanvas,e.renderCanvas=function(t){return function(e){if(!this._activeParentLayer||this._activeParentLayer===e._activeLayer){if(!this.visible)return void(this.displayOrder=0);this.displayOrder=e.incDisplayOrder(),!(this.worldAlpha<=0)&&this.renderable&&(e._activeLayer=null,t.call(this,e),e._activeLayer=this._activeParentLayer)}}}(e.renderCanvas))}(Ca);const wc=Object.freeze(Object.defineProperty({__proto__:null,utils:yi,filters:bc,SCALE_MODES:Ct,settings:xe,Ticker:we,Container:lr,AbstractRenderer:os,Sprite:Es,Graphics:ta,Text:ca,TextStyle:ra},Symbol.toStringTag,{value:"Module"}));class Pc{constructor({pos:t,color:e,size:n,floorPlan:i}){this.pos=t,this.color=e,this.size=n,this.floorPlan=i,this.id=gt(),this.draw()}draw(){const t=this.size/4e3;this.layer=this.floorPlan.addLayer({id:"fpe-markers"});let e=[{type:"composite",segments:[{type:"arc",position:[0,-27.8],radius:12.4,startAngle:-25,endAngle:205},{type:"line",end:[0,0],start:[-11.2,-22.5]}],style:{fill:Hn(this.color),stroke:6710886,strokeWidth:.5/t}},{type:"circle",position:[0,-28],radius:5,style:{fill:1,fillOpacity:.2}}];this.graphic=this.layer.addGraphic({shapes:e,pos:this.pos,id:"marker_"+this.id,scale:t,scaleOnZoom:!0})}remove(){this.off("click"),this.layer.deleteGraphic(this.graphic),delete this.floorPlan,0===this.layer.graphics.size&&this.layer.destroy()}on(t="click",e,n){this.graphic.gfx.interactive=!0,this.graphic.gfx.on(t,e,n)}off(t="click",e){this.graphic.gfx.off(t,e)}set(t){let e=["pos","color","size"];Object.keys(t).forEach((n=>{e.includes(n)&&(this[n]=t[n])})),this.draw()}}function Ec(t,e,n=!1,i=16,r=8){let o=[];for(let t=0;t<e.length-1;t+=2)o.push({x:e[t],y:e[t+1]});let s,a,l,u=0,h=0,c=n?1:0;for(s=0;s<o.length-c;s++){a=o[s],l=s==o.length-1?o[0]:o[s+1];let e=l.x-a.x,n=l.y-a.y;var p=Math.sqrt(e*e+n*n),d={x:e/p,y:n/p},f=0;for(t.moveTo(a.x+h*d.x,a.y+h*d.y);f<=p;)f+=h,(f+=u>0?u:i)>p?(u=f-p,f=p):u=0,t.lineTo(a.x+f*d.x,a.y+f*d.y),(f+=r)>p&&0==u?h=f-p:(h=0,t.moveTo(a.x+f*d.x,a.y+f*d.y))}}function Tc(t){return"number"==typeof t?t:"string"==typeof t?Hn(t):Array.isArray(t)?Wn(t.map((t=>t/255))):void 0}function Sc(t){return t.stroke?{alpha:t.strokeOpacity||1,color:Tc(t.stroke),native:"native"===t.strokeWidth,width:"number"==typeof t.strokeWidth?t.strokeWidth:1}:{}}function Cc({shape:t,settings:e,gfx:n,style:i={}}){var r,o,s;if(!n||!n.lineStyle)return;let a={...i,...t.style||{}};const l=pc,u=!["line","polyline","arc"].includes(t.type)&&!!a.fill;if(u&&a.fill&&n.beginFill(Tc(a.fill),a.fillOpacity),n.lineStyle(Sc(a)),"rectangle"===t.type){let{position:e,dimensions:i}=t;n.drawRect(e[0]*l,e[1]*l,i[0]*l,i[1]*l)}else if("circle"===t.type||"composite"===t.type)Ic(Qu(t).points,[],a,l,n,u);else if("arc"===t.type||"quadraticBezier"===t.type)Ju(t).points.forEach(((t,e)=>{0===e?n.moveTo(t[0]*l,t[1]*l):n.lineTo(t[0]*l,t[1]*l)}));else if("polygon"===t.type){let{points:e,holes:i}=t;Ic(e,i,a,l,n,u)}else if("line"===t.type){let{start:e=[],end:i=[]}=t;n.moveTo(e[0]*l,e[1]*l),n.lineTo(i[0]*l,i[1]*l)}else if("polyline"===t.type){let{points:e}=t;a.dash?Ec(n,e.flat().map((t=>t*l)),!0):e.forEach(((t,e)=>{0===e?n.moveTo(t[0]*l,t[1]*l):n.lineTo(t[0]*l,t[1]*l)}))}else if("group"===t.type){let{position:r=[0,0],rotation:o=0}=t,s=new ta;s.x=r[0]*l,s.y=r[1]*l,s.rotation=-Math.PI/180*o,t.children.forEach((t=>Cc({shape:t,settings:e,gfx:s,style:i}))),n.addChild(s)}else if("text"===t.type){let i=null!=(r=t.style)&&r.fill?Tc(t.style.fill):0,a=null!=(o=t.style)&&o.stroke?Tc(t.style.stroke):16777215,{position:u=[0,0],rotation:h=0,text:c,alignH:p="center",alignV:d="center",fontSize:f=16}=t;const m=new ra({fontFamily:(null==(s=e?.theme)?void 0:s.fontFamily)||rh.theme.fontFamily,fontSize:f,fill:i,align:p,stroke:a,strokeThickness:3});let y=new ca(c,m);y.x=u[0]*l,y.y=u[1]*l,y.rotation=-Math.PI/180*h,y.anchor.x=.5,y.anchor.y="center"===d?.5:"bottom"===d?1:0,n.addChild(y)}u&&n.endFill()}function Ic(t=[],e=[],n={},i=100,r,o){if(!t||!Array.isArray(t)||!t.length)return r;r.lineStyle(Sc(n));let s=t.flat().map((t=>t*i));if(n.dash?(Ec(r,s),o&&(r.lineStyle(0),r.drawPolygon(s))):r.drawPolygon(s),e.length){o&&r.beginHole();for(const t of e){let e=t.flat().map((t=>t*i));r.drawPolygon(e)}o&&r.endHole()}return r}const Ac=({isSelected:t,settings:e,node:n})=>{var i,r,o,s,a,l,u,h,c,p,d,f,m;const y=function({node:t,settings:e}){const n=e?.theme.showAssetTextures;return{wallContour:{strokeWidth:1.5},wall:{fill:5396576,selectFill:9677484,selectStroke:5671825},curtain:{fill:15659510},column:{fill:5396576,selectFill:9677484,selectStroke:5671825},interior:{fill:n?null:15659510,selectFill:n?null:16116704,selectStrokeWidth:2.5},stairs:{fill:15987440},door:{selectStroke:6594727},window:{selectStroke:6594727},railing:{},polyfloor:(()=>{if("polyfloor"!==t.type)return{};const e="kitchen"!==t.usage&&Xu(t.usage);let n={care:14804201,circulate:15987440,fallback:16777215};const i=e&&n[e]||n.fallback;let r;return"void"===e&&(r=t._isSelected?.5:.05),{fill:i,fillOpacity:r}})(),"a:helper:spaceDivider":{fill:14541549,stroke:14541549,strokeOpacity:.8,strokeWidth:1,selectFill:16116704,selectStroke:11494980,selectStrokeWidth:1},floorplan:{}}[t.type]}({node:n,settings:e}),g=(({settings:t,node:e})=>{var n,i,r,o;let s,a=t.theme.elements,l=e.type;"column"===l&&(l="wall"),("polyfloor"===l||"floor"===l)&&(l="space"),"interior"===l&&(l="asset"),e.class&&("door"===l&&e.class.includes("entryDoor")?s="entryDoor":"window"===l&&e.class.includes("balconyDoor")?s="balconyDoor":"window"===l&&e.class.includes("slidingDoor")?s="slidingDoor":"box"===l&&e.class.includes("preWall")&&(s="preWall"));let u=a[s]||a[l]||{};if("space"===l){let t=Uu[e.usage]||{},n="program"===t.type?e.usage:t.program;u.usage&&u.usage[e.usage]?u=u.usage[e.usage]:u.program&&u.program[n]&&(u=u.program[n])}else"stairs"===l&&!a[l]&&(null!=(i=null==(n=a?.space)?void 0:n.usage)&&i.staircase?u=a.space.usage.staircase:null!=(o=null==(r=a?.space)?void 0:r.program)&&o.circulate&&(u=a.space.program.circulate));let{fill:h,fillOpacity:c,stroke:p,strokeWidth:d}=u,f={};return h&&(f.fill=Tc(h),f.selectFill=Tc(h)),p&&(f.stroke=Tc(p)),c&&Number.isFinite(c)&&(f.fillOpacity=Math.max(Math.min(c,1),0)),d&&Number.isFinite(d)&&(f.strokeWidth=d),f})({node:n,settings:e});let v={};if((null==(i=n._highlight)?void 0:i.fill)&&Array.isArray(null==(r=n._highlight)?void 0:r.fill)){let t=n._highlight.fill;Math.max(...t)<=1&&t.forEach((t=>Math.round(255*t)));const e=Tc(t);v={fill:e,selectFill:e},Number.isFinite(null==(o=n._highlight)?void 0:o.fillOpacity)&&(v.fillOpacity=Math.max(Math.min(null==(s=n._highlight)?void 0:s.fillOpacity,1),0))}if((null==(a=n._highlight)?void 0:a.outline)&&Array.isArray(null==(l=n._highlight)?void 0:l.outline)){const t=Tc(n._highlight.outline);v={...v,stroke:t,selectStroke:t},Number.isFinite(null==(u=n._highlight)?void 0:u.outlineWidth)&&(v.strokeWidth=null==(h=n._highlight)?void 0:h.outlineWidth,v.selectStrokeWidth=null==(c=n._highlight)?void 0:c.outlineWidth)}const _={...y,...g,...v};let x={fill:void 0!==_.fill?_.fill:16777215,fillOpacity:void 0!==_.fillOpacity?_.fillOpacity:1,stroke:null!=(p=_.stroke)?p:4605266,strokeWidth:null!=(d=_.strokeWidth)?d:.5};return t&&(x={fill:void 0!==_.selectFill?_.selectFill:15398134,fillOpacity:void 0!==_.fillOpacity?_.fillOpacity:1,stroke:null!=(f=_.selectStroke)?f:7321278,strokeWidth:null!=(m=_.selectStrokeWidth)?m:1}),e.theme.nativeLines&&(x.strokeWidth="native"),x};function Oc({resourceId:t,loader:e,view:n}){var i;if(null!=(i=e.textureQueue[t])&&i.texture)return Promise.resolve();if(!e.textureQueue[t])return Promise.reject(`no texture data to load ${t}`);let{textureUrl:r,productId:o}=e.textureQueue[t];return li(),new Promise((i=>{(function(t){return new Promise(((e,n)=>{var i=new Image;i.addEventListener("load",(()=>{URL.revokeObjectURL(i.src),e(new Mr(new vr(i)))})),i.addEventListener("error",(()=>{URL.revokeObjectURL(i.src),n("image loading failed: "+t)}));const r=t.includes("/storage/get/"),o=t.startsWith("https://")?t:sh+t;i.src=o,i.crossOrigin=r?"use-credentials":"anonymous"}))})(r).then((r=>{e.textureQueue[t].imageData=r,e.textureQueue[t].loadStage=1,(!o||3===e.productQueue[o].loadStage)&&Nc(t,n,e),i()})).catch((r=>{e.textureQueue[t].error=r,e.textureQueue[t].loadStage=1,(!o||3===e.productQueue[o].loadStage)&&Nc(t,n,e),i()}))}))}function Nc(t,e,n){const i=e?._renderer,r=n.textureQueue[t],o=r.error;if(li(),!r.texture){const t=r?.productId,e=n.resources.products[t],s=new lr;let a;if(!o){if(a=new Es(r.imageData),r.applyFilter){let t=new bc.ColorMatrixFilter;t.matrix=[.7,0,0,0,.25,0,.7,0,0,.25,0,0,.7,0,.25,0,0,0,1,0],a.filters=[t]}s.addChild(a)}let l,u=new ta;const h=t&&n.resources.products[t]._shapes||[];if(h.length){h.forEach((t=>{let e;e=o?{strokeWidth:.5,stroke:1,fill:16316664}:Ac({settings:{theme:{showAssetTextures:!0,elements:{}}},node:{type:"interior"}}),Cc({shape:t,gfx:u,style:e})})),l=u.generateCanvasTexture(Ct.LINEAR,1.5);const t=new Es(l);if(t.anchor.x=r.anchor.x,t.anchor.y=r.anchor.y,!o){let n=a.width/e.boundingBox.length,i=r?.offset||{x:0,y:0};t.scale.x=a.width/t.width,t.scale.y=a.height/t.height,t.x=a.width/2-i.x*n,t.y=a.height/2-i.y*n}s.addChild(t)}r.texture=i.generateTexture(s,{scaleMode:Ct.LINEAR,resolution:1.5}),r.loadStage=2,s.destroy(!0),l&&l.destroy(!0)}r.nodes.forEach((e=>{n.emit("product-load-stage",{node:e,args:{_loadStage:3,_textureId:t}})}))}function Lc(t){if(null!=t&&t.children)for(var e=t.children.length-1;e>=0;e--)t.children[e].destroy({children:!0}),t.removeChild(t.children[e])}function Mc(t,e,n){const i=new Es(t);return i.x=0,i.y=0,i.anchor.x=.5,i.anchor.y=.5,i.rotation=0,e&&(i.width=e),n&&(i.height=n),i}function Rc({node:t,ctx:e,parentNode:n,floorPlan:i,update:r=null}){if(!t)return;const{view:o,resources:s,settings:a,loader:l}=i;n=n||t.parent;const u=["plan","level","group"].includes(t.type),h=t.id&&(t._isSelected||t.getParents().some((t=>t._isSelected))),c=t.id&&t._highlight,p=pc,d=r&&r.container||new lr,f=o.gfxLayers.scene;if(d.x=t.x*p,d.y=t.z*p,d.rotation=-Math.PI/180*t.ry||0,"interior"!==t.type){const e=Ah(t.type);d.parentLayer=f,d.zOrder=e}const{hideElements:m,showCeilingLamps:y,showFloorPlan:g,theme:v,showSpaceDividers:_,xrayMode:x}=a,b=xh(t),w=s.products[b],P=s.productContours[b]||s.productBoundingBoxes[b],E="interior"===t.type&&w?.isCeilingLamp&&!y||v.wallContours&&["wall","column"].includes(t.type)||m.includes(t.type)||!_&&"a:helper:spaceDivider"===t.type,T=o.gfxNodes[t.id],S="interior"!==t.type||"interior"===t.type&&2===T?.loadStage;let C,I,A=!E&&S&&function(t,e,n){return gh[t.type]?gh[t.type](t,e):vh[t.type]?vh[t.type](t,e,n):void 0}(t,n,P)||[];if(E)C=void 0;else if("interior"===t.type){r&&Lc(d);const e=Ah(t.type,w?.order);if(d.parentLayer=f,d.zOrder=e,2===T?.loadStage)C=new ta;else if(v.showAssetTextures||3!==T?.loadStage)if(T?.loadStage>2&&v.showAssetTextures&&w?.boundingPoints&&T?.textureId){const{texture:t,anchor:e}=l.textureQueue[T.textureId]||{};if(t){let n=w.boundingBox.length*p,i=w.boundingBox.width*p;C=Mc(t,n,i),C.anchor.x=e.x,C.anchor.y=e.y,C.zIndex=1}(h||c)&&(A=w._shapes||[],I=new ta,I.zIndex=5)}else C=new Es(o._dummyTexture);else C=new ta,A=w._shapes||[]}else if("floorplan"===t.type){if(!g)return;const e=t.id;if(d._textureId=e,null!=T&&T.loadStage){const{texture:e}=l.textureQueue[T.textureId]||{};e&&(C=Mc(e,t.l*p,t.w*p)),I=new ta,C.zIndex=1,I.zIndex=5}else{const n=t.file;l.textureQueue[e]={loadStage:0,nodes:new Set([t]),textureUrl:n,applyFilter:!1},Oc({loader:l,view:o,resourceId:e}),C=new ta}}else u||(r&&Lc(d),C=new ta);const O=Ac({settings:a,node:t,isSelected:h});A.forEach((t=>Cc({shape:t,settings:a,gfx:I||C,style:O}))),C&&(C.interactive=!0,d.addChild(C),C._nodeId=t.id),I&&d.addChild(I),d.alpha=function(t,e,n){return!n||["plan","level","floorplan"].includes(t.type)||t.id&&t.getParents().some((t=>t.id===e.activeGroup))?1:.7}(t,i,x),(!r||r.updateChildren||"wall"===t.type||"interior"===t.type)&&t&&t.children&&t.children.forEach((e=>{Rc({node:e,ctx:d,parentNode:t,floorPlan:i})})),o.gfxNodes[t.id]||(o.gfxNodes[t.id]={}),o.gfxNodes[t.id].nodeContainer=d,r||e.addChild(d)}function kc(t,e,n,i){var r;const o=e.getChildByName(t.id);if(o?.destroy(!0),i.hideElements.includes("roomStamp"))return;const{text:s,textOutline:a=!0}=(null==(r=i.theme.elements)?void 0:r.roomStamp)||{},l=i.theme.background.color,u="transparent"!==l?l:"#eee",h=s?Gn(Wn(s.map((t=>t/255)))):"#333333",c=new ra({fontFamily:i.theme.fontFamily||rh.theme.fontFamily,fontSize:16,align:"center",fill:h,stroke:u,strokeThickness:a?3:0});let p=function(t,e){var n,i;if("void"===Xu(t.usage))return[];let{showUsage:r,showArea:o,roomStampDisplay:s}=(null==(n=e.theme.elements)?void 0:n.roomStamp)||{};const a=e.spaceLabelMapping||{};let l,u;switch(void 0!==a[t.usage]&&(l=a[t.usage]),void 0!==a[t.id]&&(l=a[t.id]),e.units.roomDimensions){case"area":u=_(t.area,e.units.system,e.units.areaDecimals);break;case"boundingBox":const{length:n,width:i}=t.boundingBox;u=`${v(n,e.units.system,e.units.lengthDecimals)} x ${v(i,e.units.system,e.units.lengthDecimals)}`;break;default:u=""}let h=t.usageName;if(!h&&"undefined"!==t.usage&&(h=function(t){return t.replace(/([A-Z])/g,(t=>` ${t}`)).replace(/^./,(t=>t.toUpperCase())).trim()}(t.usage||"")),void 0!==l&&("string"!=typeof l?console.warn("space label mapping has to be a string"):l.length>50?console.warn("space label mapping has to be less than 50 characters"):h=l),!s){const t=!1!==(null==(i=e.theme.elements)?void 0:i.roomStamp);s=[],!t||void 0===r&&void 0===o?t&&s.push("usage","area"):(r&&s.push("usage"),o&&s.push("area"))}const c=[];return s.forEach((e=>{var n,i;switch(e){case"name":null!=(n=t.node)&&n.name&&c.push(t.node.name);break;case"customId":null!=(i=t.node)&&i.customId&&c.push(t.node.customId);break;case"usage":c.push(h);break;case"area":c.push(u)}})),c}(t,i).join("\n");const d=new ca(p,c);d.x=t.center[0]*pc,d.y=t.center[1]*pc,d.anchor.x=.5,d.anchor.y=.5,Dc(d,n,t),d.name=t.id,e.addChild(d)}function Dc(t,e,n){let i=Math.min(1/e,2);t.scale.x=i,t.scale.y=i,t.visible=n.area>1.5*i}function Fc({node:t,event:e,args:n,floorPlan:i}){i=i||this;const{view:r,loader:o}=i;if(o.isSceneStructureLoaded&&t){if("add-child"===e){const{nodeContainer:e}=r.gfxNodes[t.id]||{};Rc({node:n,ctx:e,parentNode:t,floorPlan:i})}else if("remove-child"===e){const{nodeContainer:t}=r.gfxNodes[n.id]||{};t&&(t.parent.removeChild(t),t.destroy({children:!0})),r.viewportNeedsUpdate=!0,r.viewportPaused&&r.startAnimationLoop(),delete r.gfxNodes[n.id]}setTimeout((()=>{this.viewportNeedsUpdate=!0}),100)}}function Bc({node:t,args:e,event:n,floorPlan:i}){i=i||this;const{view:r}=i;if("stairs"===t.type||"door"===t.type)return void Uc({node:t,args:e,event:n,floorPlan:i});const{nodeContainer:o}=r.gfxNodes[t.id]||{};!o||(o.x=t.x*pc,o.y=t.z*pc,o.rotation=-Math.PI/180*t.ry,r.viewportNeedsUpdate=!0,r.viewportPaused&&r.startAnimationLoop())}function Uc({node:t,args:e,event:n,floorPlan:i}){i=i||this;const{view:r,resources:o,settings:s}=i;"set-materials"===n&&(e={materials:e});const{nodeContainer:a}=r.gfxNodes[t.id]||{};if(a&&"level"!==t.type&&"plan"!==t.type){if(e._loadStage&&(r.gfxNodes[t.id].loadStage=e._loadStage),e._textureId&&(r.gfxNodes[t.id].textureId=e._textureId),Lc(a),"polyfloor"===t.type){const e=o.spaces.find((e=>e.id===t.id));if(e){!function(t,e){!t||"polyfloor"!==e.type||(t.usage=e.usage,t.usageName=zu(e.usage),t.program=Xu(e.usage),t.name=e.name,t.customId=e.customId)}(e,t);const n=r.layers.get("fpe-room-stamp");n&&kc(e,n.container,r.zoom,s)}else console.warn(`Node with ID=${t.id} has no data in floorPlan.resources.spaces`)}Rc({node:t,ctx:a.parent,floorPlan:i,update:{container:a,args:e,updateChildren:void 0!==e._isSelected}}),r.viewportNeedsUpdate=!0,r.viewportPaused&&r.startAnimationLoop()}}function zc(t="linear"){return Nh[t]}function Xc({bb:t,animate:e=!1,view:n}){const i=n._viewport;if(!i)throw new Error("no viewport");return n.viewportPaused&&n.startAnimationLoop(),new Promise((r=>{Number.isFinite(t.x)||r(!1),Object.keys(t).forEach((e=>{t[e]=t[e]*pc}));let o=0;"number"==typeof e&&Number.isFinite(e)?o=e:!0===e&&(o=500);let s={x:t.x+t.length/2,y:t.z+t.width/2,width:t.length,height:t.width};if(o){let t={x:i.center.x,y:i.center.y,width:i.worldScreenWidth,height:i.worldScreenHeight},e={x:t.x-s.x,y:t.y-s.y,width:t.width-s.width,height:t.height-s.height};n._zoomTarget={delta:e,start:t,target:s,time:0,duration:o,destroy:()=>{n.ticker.remove("animateView"),delete n._zoomTarget,r(!0)},ease:zc("easeInOutQuad"),updateViewport:Gc.bind(n)},n.ticker.add("animateView",Yc,n)}else i.fit(!1,s.width,s.height).moveCenter(s.x,s.y),Gc.bind(n)({type:"animation"}),n.viewportNeedsUpdate=!0,r(!0)}))}function Yc(t){let e=this._zoomTarget,n=!1;e.time+=t;let i=e.ease(e.time,0,1,e.duration),r={x:e.start.x-e.delta.x*i,y:e.start.y-e.delta.y*i,width:e.start.width-e.delta.width*i,height:e.start.height-e.delta.height*i};e.time>e.duration&&(r=e.target,n=!0),this._viewport.fit(!1,r.width,r.height).moveCenter(r.x,r.y),this.viewportNeedsUpdate=!0,e.updateViewport({type:"animation"});const o=0!==this._viewport.input.count();(n||o)&&e.destroy()}function Gc(t){this.viewportNeedsUpdate=!0,this.viewportPaused&&this.startAnimationLoop();const e=this._viewport;"animation"!==t.type&&this._zoomTarget&&this._zoomTarget.destroy();const n=pc,i=e.scale._x,r=e.left,o=e.top,s=e.worldScreenWidth,a=e.worldScreenHeight;this.viewbox={x:r/n,z:o/n,x2:(r+s)/n,z2:(o+a)/n,length:s/n,width:a/n},this.client=[e.screenWidth,e.screenHeight];const l=this.zoom!==i;this.zoom=i;const u={sourceEvent:{type:t.type},viewbox:this.viewbox,zoom:this.zoom};l?this.emit("zoom",u):this.emit("pan",u),this.emit("viewbox",u)}function Hc({pos:t,nodeId:e}){Wc(this.interaction,{cursor:t,cursorTarget:e&&this.scene.nodesById[e]})}function Wc(t,e){for(const n in e)t[n]=e[n],"cursorAction"===n&&jc(e[n])}function jc(t){let e="";switch(t){case"split-wall":e="var(--fpe-split-cursor) 16 16, pointer";break;case"duplicate":e="var(--fpe-duplicate-cursor) 16 16, pointer";break;case"move":e="move";break;default:e="default"}document.body.style.cursor=e}function Vc(t){var e,n,i,r;if(2===(null==(n=null==(e=t?.data)?void 0:e.originalEvent)?void 0:n.button))return;if(!this)throw new Error("Viewport context is missing");let o=this.interaction._dragStart||{x:0,y:0},s=t.data.global||{x:0,y:0},a=Math.abs(s.x-o.x),l=Math.abs(s.y-o.y);if(!(a<5&&l<5))return;let u,h=(new Date).getTime();if(this.interaction.lastClick){let t=h-this.interaction.lastClick.time,e=this.interaction.lastClick.pos&&Math.max(Math.abs(s.x-this.interaction.lastClick.pos.x),Math.abs(s.y-this.interaction.lastClick.pos.y));u=t<400&&e<10}this.interaction.lastClick={time:h,pos:{...s}};const c=u?"dblclick":"click",p=null==(i=t.target)?void 0:i._nodeId,{x:d,y:f}=(null==(r=t.data)?void 0:r.global)||{},m=this.getPlanPosition([d,f]);Wc(this.interaction,{cursor:[m[0],m[1]]});let y={sourceEvent:t,nodeId:p,pos:m,isDoubleClick:!!u};this.emit(c,y)}function qc(t){var e;const{x:n,y:i}=t.data.global;this.view.windowPos=[n,i],this.interaction.lastSceneClick=this.getPlanPosition(this.view.windowPos);const r=null==(e=t.target)?void 0:e._nodeId;this.emit("context-menu",{sourceEvent:t,nodeId:r})}function $c(t){t.drag().pinch({percent:4}).wheel()}function Zc(t){this.interaction._dragStart={x:t.data.global.x,y:t.data.global.y},this.emit("drag-start",{pos:this.interaction.cursor,sourceEvent:t})}function Kc(){this.view.resume("drag"),this.emit("drag-end",{pos:this.interaction.cursor,sourceEvent:{}}),this.interaction.isDragging=!1,this.interaction.dragOffset=null}function Qc(t){var e;const{srcElement:n}=(null==(e=t?.data)?void 0:e.originalEvent)||{};if(!n)return;if(n!==this.view._viewport.options.divWheel)return;const i=t.data.getLocalPosition(this.view._viewport);let r=[i.x/pc,i.y/pc];const o=t.target&&t.target._nodeId;if(this.interaction.cursor=r,this.interaction.isDragging){const e=[i.x,i.y];this.emit("drag-move",{pos:this.interaction.cursor,screenPos:e,sourceEvent:t})}this.emit("mousemove",{sourceEvent:t,nodeId:o,pos:r})}const Jc=t=>{const e=document.querySelector(`#${t.fpeId} .fpe__plan`);!e||(e.addEventListener("mouseleave",(()=>t.view.emit("focus",!1,t.view))),e.addEventListener("mouseenter",(()=>t.view.emit("focus",!0,t.view))),document.addEventListener("visibilitychange",(()=>t.view.emit("focus","visible"===document.visibilityState,t.view))),e.addEventListener("contextmenu",(function(t){return t.preventDefault(),!1}),!1))};function tp({floorPlan:t,update:e=!1}){const{scene:n,view:i,settings:r}=t,{_renderer:o,_viewport:s}=i;let a=r.theme.background.color;4===a.length&&(a=a[0]+a[1]+a[1]+a[2]+a[2]+a[3]+a[3]),o.backgroundColor=Hn(a);const l=i.sceneContainer;Lc(l),Rc({node:n.node,ctx:l,floorPlan:t}),r.theme.wallContours&&function(t,e){const n=Ac({settings:(e=e||this).settings,node:{type:"wallContour"},isSelected:!1}),i=new ta,r=e.view.gfxLayers.scene,o=Ah("wall");i.parentLayer=r,i.zOrder=o,e.computed.wallContours.forEach((t=>{Cc({shape:{type:"polygon",points:t[0],holes:t.slice(1)},settings:e.settings,gfx:i,style:n})})),t.addChild(i)}(l,t),ep(t,!0),i.emit("scene-rendered",{update:e}),i.viewportNeedsUpdate=!0,e&&(r.panZoom?$c(s):function(t){t.plugins.remove("wheel"),t.plugins.remove("pinch"),t.plugins.remove("drag")}(s)),i.viewportPaused&&i.startAnimationLoop()}function ep(t,e=!1){const{view:n,resources:i,settings:r}=t,o=t.addLayer({id:"fpe-room-stamp",baseLayer:"annotation"});e?(Lc(o.container),i.spaces.forEach((t=>kc(t,o.container,n.zoom,r)))):o.container.children.forEach((t=>{let e=i.spaces.find((e=>e.id===t.name));Dc(t,n.zoom,e)}))}class np extends cc{}const ip=(t,e=!1)=>new al(new ol(t,e)),rp={top:0,left:0,center:.5,right:1,bottom:1};class op{constructor(){this.methods={},this.add=(t,e,n)=>{this.methods[t]={fn:e,ctx:n}},this.remove=t=>{delete this.methods[t]}}}class sp extends mc{constructor(t,e,n){var i;super(),this.windowPos=[0,0],this.zoom=1,this.client=[0,0],this.layers=new Map,this.viewbox={x:0,z:0,x2:0,z2:0,length:0,width:0},this.viewportNeedsUpdate=!1,this.viewportPaused=!1,this.viewportInFocus=!1,this.sceneContainer=new lr,this.gfxNodes={},this.ticker=new op,this._oldTime=Date.now(),Bn(),this.parentEl=document.getElementById(n);const r=this.parentEl.querySelector(".fpe__plan");let o=this.parentEl.clientWidth,s=this.parentEl.clientHeight;this._settings=e;const a=window.devicePixelRatio||1;let l=e.theme.background.color;const u="transparent"===l;this._renderer=function(t){return ls.create(t)}({width:o,height:s,view:r,antialias:!0,backgroundAlpha:u?0:1,autoDensity:!0,resolution:a,powerPreference:"high-performance",preserveDrawingBuffer:!0}),this.parentEl.appendChild(this._renderer.view),4===l.length&&(l=l[0]+l[1]+l[1]+l[2]+l[2]+l[3]+l[3]),u||(this._renderer.backgroundColor=Hn(l)),this._stage=new ll,this._stage.sortableChildren=!0,this._viewport=new np({screenWidth:o,screenHeight:s,worldWidth:o,worldHeight:s,interaction:this._renderer.plugins.interaction,noTicker:!0,passiveWheel:!1,divWheel:document.querySelector(`#${n} .fpe__plan`)}),this._viewport.addChild(this.sceneContainer),null!=(i=null==wc?void 0:we)&&i.system&&we.system.stop(),this.startAnimationLoop(),this.watchResize(),this._stage.addChild(this._viewport),this.on("focus",(t=>{t&&this.viewportPaused?this.startAnimationLoop():t||this.stopAnimationLoop(),this.viewportInFocus=t})),this.gfxLayers=ap(this._stage,this.parentEl.clientWidth),function(t,e){e.on("product-load-texture",(({textureId:n,productData:i})=>{(function(t,{textureId:e,productData:n}){if(!n||!n.boundingPoints)return;let i={x:n.boundingPoints.min[0],y:n.boundingPoints.min[2]},r={x:Math.abs(n.boundingPoints.min[0]/n.boundingBox.length),y:Math.abs(n.boundingPoints.min[2]/n.boundingBox.width)},o={x:n.boundingPoints.max[0]-n.boundingBox.length/2,y:n.boundingPoints.max[2]-n.boundingBox.width/2};t.textureQueue[e].offset=o,t.textureQueue[e].anchor=r,t.textureQueue[e].position=i})(e,{textureId:n,productData:i}),Oc({view:t,resourceId:n,loader:e})})),e.on("product-contour",(n=>Nc(n,t,e)));const n=new ta;n.lineStyle({native:!0,color:3355443}),n.drawCircle(0,0,1),t._dummyTexture=t._renderer.generateTexture(n)}(this,t)}draw(){var t;const e=Date.now();let n=e-this._oldTime;this._oldTime=e,n<0&&(n=0),n>1e3&&(n=1e3);let i=Object.keys(this.ticker.methods).length;(this.viewportNeedsUpdate||i)&&(null!=(t=this.ticker)&&t.methods&&Object.values(this.ticker.methods).forEach((({fn:t,ctx:e})=>{"function"==typeof t&&(e?t.call(e,n):t(n))})),this._viewport.update(n),this._renderer.render(this._stage)),this.viewportPaused||requestAnimationFrame((()=>this.draw())),this.viewportNeedsUpdate=!1}startAnimationLoop(){this._oldTime=Date.now(),this.viewportNeedsUpdate=!0,this.viewportPaused=!1,requestAnimationFrame((()=>this.draw()))}stopAnimationLoop(){this.viewportPaused=!0}updateView(){if(!this.parentEl.clientWidth||!this.parentEl.clientHeight)return;const t=this._viewport,e=this._renderer,n=pc,i=t.screenWidth,r=t.screenHeight,o=this.parentEl.clientWidth,s=this.parentEl.clientHeight;e.resize(o,s),t.resize(o,s);const a=i-o,l=r-s,u=this._settings.preserveViewbox,[h=.5,c=.5]=u.split("-").map((t=>rp[t])),p=h*a,d=c*l;t.position.set(t.x-p,t.y-d),t.plugins.get("clamp-zoom")||t.clampZoom({minHeight:this._settings.zoomRange[0]*n,maxHeight:this._settings.zoomRange[1]*n}),e.render(this._stage);let f=t.left,m=t.top,y=t.worldScreenWidth,g=t.worldScreenHeight;this.viewbox={x:f/n,z:m/n,x2:(f+y)/n,z2:(m+g)/n,length:y/n,width:g/n},this.client=[t.screenWidth,t.screenHeight]}async watchResize(){new ResizeObserver((()=>{this.updateView(),this.emit("resize-canvas",this.viewbox)})).observe(this.parentEl)}get gfxNodeCount(){return Object.keys(this.gfxNodes).length}reset(){this.gfxNodes={},this.gfxLayers=ap(this._stage,this.parentEl.clientWidth)}pause(t="drag"){this._viewport.plugins.pause(t)}resume(t="drag"){this._viewport.plugins.resume(t)}}const ap=(t,e)=>{const n=ip(0);t.addChild(n);const i=ip(1,!0);i.width=i.height=e,t.addChild(i);const r=ip(2);t.addChild(r);const o=ip(3);return t.addChild(o),{base:n,scene:i,annotation:r,helper:o}};class lp{constructor({shapes:t=[],pos:e=[0,0],alpha:n=1,scale:i=1,clearLayer:r=!1,interactive:o=!1,id:s,isHandler:a=!1,scaleOnZoom:l=!1,baseLayer:u,container:h,floorPlan:c}){if(this.shapes=t,this.gfxScale=i,this.scaleOnZoom=l,this.container=h,this.floorPlan=c,!this.container)return;r&&Lc(this.container);let p=new ta;this.gfx=p,p.alpha=n;const d=Math.min(1/this.floorPlan.view.zoom)*this.gfxScale;e&&(p.x=e[0]*pc,p.y=e[1]*pc),o&&(p.interactive=!0),p._nodeId=s,a&&(p._isHandler=!0),p.parentLayer=u,d&&l&&(p.scale.x=p.scale.y=d),this.container.addChild(p),t.forEach((t=>Cc({shape:t,settings:this.floorPlan.settings,gfx:p}))),this.floorPlan.view.viewportNeedsUpdate=!0,this.floorPlan.view.viewportPaused&&this.floorPlan.view.startAnimationLoop()}set({pos:t,style:e,shapes:n}={}){const i=Math.min(1/this.floorPlan.view.zoom)*this.gfxScale,r=this.gfx;if(t&&(r.x=t[0]*pc,r.y=t[1]*pc),n&&(this.shapes=n,r.clear(),Lc(r),n.forEach((t=>Cc({shape:t,settings:this.floorPlan.settings,gfx:r})))),i&&this.scaleOnZoom&&(r.scale.x=r.scale.y=i),e){const t=Sc(e);e.fill&&(r.geometry.graphicsData[0].fillStyle.color=Tc(e.fill)),r.geometry.graphicsData[0].lineStyle.color=t.color,r.geometry.graphicsData[0].lineStyle.width=t.width,r.geometry.graphicsData[0].lineStyle.native=t.native,r.geometry.invalidate()}this.floorPlan.view.viewportNeedsUpdate=!0,this.floorPlan.view.viewportPaused&&this.floorPlan.view.startAnimationLoop()}on(t,e,n){return this.gfx.interactive=!0,"drag"===t?this.addDragEvent(e,n):this.gfx.on(t,e,n),this}off(t,e){return"drag"===t?this.removeDragEvent():this.gfx.off(t,e),this}destroy(){this.gfx.destroy(),this.floorPlan.view.viewportNeedsUpdate=!0,this.floorPlan.view.viewportPaused&&this.floorPlan.view.startAnimationLoop()}addDragEvent(t,e){function n(){this.floorPlan.interaction.isDragging=!1,this.floorPlan.view.resume("drag"),this.floorPlan.off("mousemove",t)}this.on("pointerdown",(function(){this.floorPlan.interaction.isDragging=!0,this.floorPlan.view.pause("drag"),this.floorPlan.on("mousemove",t,e)}),this),this.on("pointerup",n,this),this.on("pointerupoutside",n,this),this.on("pointercancel",n,this)}removeDragEvent(){this.off("pointerdown"),this.off("pointerup"),this.off("pointerupoutside"),this.off("pointercancel")}}class up{constructor(t,e,n){this.graphics=new Set;const i=t.view._viewport;this.container=new lr,this.id=n,this.baseLayer=t.view.gfxLayers[e]||t.view.gfxLayers.helper,this.container.parentLayer=this.baseLayer,this.floorPlan=t,i.addChild(this.container)}addGraphic(t){const e=new lp({...t,floorPlan:this.floorPlan,baseLayer:this.baseLayer,container:this.container});return this.graphics.add(e),e}deleteGraphic(t){this.graphics.delete(t),t.destroy()}draw(t){return this.addGraphic(t)}drawImage({url:t,width:e,height:n,mask:i,options:r}){if(null!=r&&r.pixelated?xe.SCALE_MODE=Ct.NEAREST:xe.SCALE_MODE=Ct.LINEAR,!this.container)return;Lc(this.container);let o=Es.from(t);if(o.width=e*pc,o.height=n*pc,o.parentLayer=this.baseLayer,i){let{x:t,z:e,length:n,width:r}=$l([i]);o.x=(t+n/2)*pc,o.y=(e+r/2)*pc,o.anchor.set(.5);let s=new ta;Cc({shape:{type:"polygon",points:i,style:{fill:16724736}},settings:this.floorPlan.settings,gfx:s}),this.container.addChild(s),o.mask=s}this.container.addChild(o),this.floorPlan.view.viewportNeedsUpdate=!0,this.floorPlan.view.viewportPaused&&this.floorPlan.view.startAnimationLoop(),setTimeout((()=>{this.floorPlan.view.viewportNeedsUpdate=!0}),100)}clear(){Lc(this.container),this.floorPlan.view.viewportNeedsUpdate=!0,this.floorPlan.view.viewportPaused&&this.floorPlan.view.startAnimationLoop()}destroy(){!this.container||(this.floorPlan.view.layers.delete(this.id),this.container.destroy({children:!0,texture:!0,baseTexture:!0}),this.floorPlan.view.viewportNeedsUpdate=!0,this.floorPlan.view.viewportPaused&&this.floorPlan.view.startAnimationLoop(),delete this.container,delete this.floorPlan)}}class hp extends yc{constructor({floorPlan:t,helperId:e,mode:n="distance"}){super({floorPlan:t,helperId:e}),this.drawing=!1,this.polygonsOrPolylines=[],this.floorPlan=t,this.mode=n,this.floorPlan.on("mousemove",this.handlePointerMove,this),this.floorPlan.on("click",this.handlePointerDown,this),this.floorPlan.on("dblclick",this.handlePointerDown,this),this.floorPlan.on("update-settings",this.draw,this),this.startDrawing()}get isInAreaMode(){return"area"===this.mode}get isDrawing(){return this.drawing}set({mode:t}){this.mode=t,this.draw()}handlePointerMove(t){this.setSnapCursor(t)}handlePointerDown(t){this.setSnapCursor(t),this.drawPoint(t)}setSnapCursor({pos:t}){null!=this._snapCursor||(this._snapCursor=this.floorPlan.addHelper("snapCursor",{pos:t}));const{snapPoints:e,snapMargin:n}=this.floorPlan.computed;if(!e.length)return this._snapCursor.set({pos:t}),void this.draw();const i=Ih(t,e,n);this._snapCursor.isSnapping=!!i,this._snapCursor.set({pos:i||t}),this.draw()}stopDrawing(){this.polygonsOrPolylines[this.polygonsOrPolylines.length-1].points.length>1&&this.drawing&&this.polygonDone()}cancelDrawing(){this.destroy()}startDrawing(){this.drawing=!0,this.polygonsOrPolylines.push({points:[],isClosed:!1,length:0,area:0,areaDisplay:"",lengthDisplay:"",contour:null,label:null,pointGraphics:[]})}removeLastPoint(){var t,e;const n=this.polygonsOrPolylines[this.polygonsOrPolylines.length-1];if(n?.points.length>0){n.points.pop();const i=n.pointGraphics.pop();i&&this.layer.deleteGraphic(i),n.points.length<=1&&(n.contour&&(null==(t=this.layer)||t.deleteGraphic(n.contour),n.contour=null),n.label&&(null==(e=this.layer)||e.deleteGraphic(n.label),n.label=null)),0===n.points.length?(this.polygonsOrPolylines.pop(),this.drawing=!1):this.draw()}}polygonDone(){this.drawing=!1,this.emit("polygon-done",{}),this.draw()}drawPoint(t){var e;this.drawing||this.startDrawing();const n=this.polygonsOrPolylines.length-1,i=this.polygonsOrPolylines[n];if((null==(e=t.nodeId)?void 0:e.startsWith(`point/${n}/`))||t.isDoubleClick){const e=t.nodeId===`point/${n}/0`;return"distance"===this.mode&&e&&(i.isClosed=!0),void this.polygonDone()}const{pos:r}=this._snapCursor;i.points.push([...r]);const o=i.points.length-1,s=`point/${n}/${o}`;this.layer||(this.layer=this.floorPlan.addLayer());const a=this.layer.addGraphic({shapes:[{type:"circle",position:[0,0],radius:.15,style:{fill:22015,fillOpacity:.1}},{type:"circle",position:[0,0],radius:.05,style:{stroke:22015,fill:16777215,strokeWidth:1.5}}],pos:r,scaleOnZoom:!0,id:s,isHandler:!0});i.pointGraphics[o]=a,a.on("drag",(function(){this.updatePolygon(n,o,this.floorPlan.interaction.cursor),a.set({pos:i.points[o]})}),this)}updatePolygon(t,e,n){const i=n,{snapPoints:r,snapMargin:o}=this.floorPlan.computed,s=r.length&&Ih(i,r,o);this.polygonsOrPolylines[t].points[e]=s||i,this.draw()}getLengthText(t){const{units:e}=this.floorPlan.settings;return v(t,e.system,e.lengthDecimals)}getAreaText(t){const{units:e}=this.floorPlan.settings;return _(t,e.system,e.areaDecimals)}reset(){this.drawing=!1,this.polygonsOrPolylines=[],this.floorPlan.removeHelper("snapCursor"),this._snapCursor=null,this.layer&&(this.layer.destroy(),this.layer=null)}draw(){!this.polygonsOrPolylines.length||(this.layer||(this.layer=this.floorPlan.addLayer()),this.polygonsOrPolylines.forEach(((t,e)=>{if(!t.points.length)return;const n=this.drawing&&this._snapCursor&&e===this.polygonsOrPolylines.length-1?[...t.points,this._snapCursor.pos]:t.points;if(n.length<2)return;t.length=function(t,e=!0){let n=0;const i=e?t.length:t.length-1;for(var r=0;r<i;r++)n+=Vl({x:t[r][0],z:t[r][1]},{x:t[r<t.length-1?r+1:0][0],z:t[r<t.length-1?r+1:0][1]});return n}(n,t.isClosed),t.lengthDisplay=this.getLengthText(t.length);const i=n.length<2?0:function(t,e){return t||(t={x:0,z:0}),function(t,e=0){const n=Math.pow(10,e);return Math.round(t*n)/n}(180*Math.atan2(-e.z+t.z,e.x-t.x)/Math.PI,2)}({x:n[0][0],z:n[0][1]},{x:n[1][0],z:n[1][1]}),r=n.map((t=>t.map((t=>Number(t.toFixed(10)))))).slice(0,this.isInAreaMode?void 0:2),o=this.isInAreaMode?su(r):[r[0][0]+(r[1][0]-r[0][0])/2,r[0][1]+(r[1][1]-r[0][1])/2];t.area=Math.abs(tu(n)),t.areaDisplay=this.getAreaText(t.area);const s=this.isInAreaMode||t.isClosed?"polygon":"polyline",a={stroke:6789887,dash:!0,strokeWidth:"native"};let l=t.lengthDisplay,u=i;this.isInAreaMode&&(a.fill=22015,a.fillOpacity=.04,l=t.areaDisplay,u=0);const h=[{type:s,points:n,style:a}],c={shapes:[{type:"text",text:l,position:[0,0],rotation:u,alignV:"bottom",fontSize:15,style:{fill:22015}}],id:"text",pos:o,scaleOnZoom:!0};t.contour?t.contour.set({shapes:h}):t.contour=this.layer.addGraphic({shapes:h}),t.label?t.label.set(c):t.label=this.layer.addGraphic(c);const p=this.isInAreaMode?{area:t.area}:{distance:t.length};this.emit("polygon-draw",p)})))}destroy(){this.reset(),this.floorPlan.off("mousemove",this.handlePointerMove),this.floorPlan.off("click",this.handlePointerDown),this.floorPlan.off("dblclick",this.handlePointerDown),this.floorPlan.off("update-settings",this.draw),super.destroy()}}class cp extends yc{constructor({floorPlan:t,helperId:e,pos:n}){super({floorPlan:t,helperId:e}),this.pos=[0,0],this.floorPlan.on("mousemove",this.draw,this),this.isSnapping=!1,this.isEdge=!1,n&&(this.pos=n)}draw(){if(this.layer||(this.layer=this.floorPlan.addLayer({id:"fpe-snap-cursor"})),this.cursor){const t=this.isSnapping?6789887:12303291,e=this.isSnapping?2:1.5;this.cursor.set({pos:this.pos,style:{stroke:t,strokeWidth:e}})}else this.cursor=this.layer.addGraphic({shapes:[{type:"circle",position:[0,0],radius:.06,style:{stroke:6789887,strokeWidth:1.5}}],pos:this.pos,scaleOnZoom:!0})}set({pos:t,isSnapping:e,isEdge:n,node:i}){this.pos=t,this.isSnapping=e,this.isEdge=n,this.node=i,this.draw()}snapState(){return this.isSnapping?this.isEdge?"edge":"point":""}destroy(){this.floorPlan.off("mousemove",this.draw),this.layer&&this.layer.destroy(),this.layer=void 0,this.cursor=null,super.destroy()}}const pp={lastSceneClick:[0,0],cursor:[0,0],cursorTarget:null,isDragging:!1,altKey:!1,shiftKey:!1,metaKey:!1,ctrlKey:!1,dragOffset:null,cursorAction:"none",isPanning:!1,lastClick:{time:null,pos:{x:0,y:0}},_dragStart:{x:0,y:0}};class dp extends Ch{constructor({container:t,options:e={},scene:n}={}){let i;super({options:e,scene:n}),this.interaction=pp,this.availableHelpers={cursorCoordinates:gc,scaleBar:vc},this.helper={},this.version=rh.api.sdkVersion,i=t instanceof Element?t:document.body,this.mountFloorPlan(i),this.availableHelpers.polygonHelper=hp,this.availableHelpers.snapCursor=cp}prevent(t){t.preventDefault()}on(t,e,n){return this._emitter.on(t,e,n),this}once(t,e,n){return this._emitter.once(t,e,n),this}off(t,e){return this._emitter.off(t,e),this}emit(t,...e){return this._emitter.emit(t,...e),this}handleDrop(t){var e;t.preventDefault(),t.stopPropagation();const n=[t.offsetX,t.offsetY],i=this.getPlanPosition(n);this.interaction.cursor=[...i];const{spaces:r}=this.getResourcesFromPosition(i),o=(null==(e=r[0])?void 0:e.node.y)||0;this.emit("drop",{pos:i,sourceEvent:t,verticalPos:o})}set(t){super.set(t),this.view&&tp({floorPlan:this,update:!0})}mountFloorPlan(t){const e=t.querySelector(".fpe");e&&e.remove();const n=document.createElement("div");n.id=this.fpeId,n.classList.add("fpe"),t.appendChild(n);const i=document.createElement("canvas");i.classList.add("fpe__plan"),n.appendChild(i),this.fpeNode=n,(t=>{t&&"object"==typeof t&&(rh.api={...rh.api,...t})})(this.settings.api),this.view=new sp(this.loader,this.settings,this.fpeId),this.loader.on("product-load-stage",(t=>function(t,e){Uc({...t,floorPlan:e})}(t,this))),this.loader.on("spaces-loaded",this.initDrawing,this),i.addEventListener("drop",this.handleDrop.bind(this)),i.addEventListener("gesturestart",this.prevent),i.addEventListener("gesturechange",this.prevent),i.addEventListener("gestureend",this.prevent),i.addEventListener("dragover",this.prevent),this.settings.destroyOnDomRemove&&function(t,e,n){const i=new MutationObserver((()=>{(function t(n){return n.parentNode!==e&&(null===n.parentNode||t(n.parentNode))})(t)&&(i.disconnect(),n())}));i.observe(e,{childList:!0,subtree:!0})}(n,t,(()=>this.destroy())),function(t){const{settings:e,view:n}=t;e.panZoom&&$c(n._viewport),n._viewport.on("pointerdown",Zc,t).on("pointerup",Kc,t).on("pointerup",Vc,t).on("rightup",qc,t).on("pointerupoutside",Kc,t).on("pointermove",Qc,t).on("moved",Gc,n).on("zoomed",Gc,n),Jc(t),(t=>{const{view:e,interaction:n}=t,i=(i,r)=>{!e.viewportInFocus||(n.shiftKey=i.shiftKey,n.ctrlKey=i.ctrlKey,n.altKey=i.altKey,n.metaKey=i.metaKey,t.emit(r,{key:i.key,lowerCaseKey:i.key&&i.key.toLowerCase(),sourceEvent:i}))};document.addEventListener("keydown",(t=>i(t,"key"))),document.addEventListener("keyup",(t=>i(t,"keyup")))})(t),t.on("mousemove",Hc,t)}(this),this.view.on("scene-rendered",(({update:t})=>{t||this.zoomExtents(1,0)})),this.view.on("zoom",(()=>{this.view.layers.forEach((t=>{t.graphics.forEach((t=>{t.scaleOnZoom&&!t.gfx.destroyed&&t.set()}))})),ep(this)})),this.generateUi()}initDrawing(){this.loader.initialLoading||this.view.reset(),tp({floorPlan:this}),this.loader.initialLoading&&this.initDrawingEvents()}initDrawingEvents(){this.scene.on("set",Uc,this),this.scene.on("set-transform",Bc,this),this.scene.on("set-transient",Uc,this),this.scene.on("set-materials",Uc,this),this.scene.on("add-child",Fc,this),this.scene.on("remove-child",Fc,this)}generateUi(){this.settings.ui.coordinates?this.addHelper("cursorCoordinates",{parentEl:this.fpeNode}):this.helper.cursorCoordinates&&this.removeHelper("cursorCoordinates"),this.settings.ui.scale?this.addHelper("scaleBar",{parentEl:this.fpeNode}):this.helper.scaleBar&&this.removeHelper("scaleBar")}getSceneBoundingBox(t=0){var e;if(null==(e=this.view)||!e._viewport)return;let n=this.view.sceneContainer;if(!n)return;let{x:i,y:r,width:o,height:s}=n.getLocalBounds(),a=i/pc-t,l=r/pc-t,u=o/pc+2*t,h=s/pc+2*t;return{x:a,x2:a+u,z:l,z2:l+h,length:u,width:h}}getZoomExtentsBoundingBox(t,e,n,i,r,o,s){return function({sceneBoundingBox:t,rectLeft:e,rectTop:n,rectRight:i,rectBottom:r,viewportWidth:o,viewportHeight:s}){if([e,n,i,r].some((t=>t>0))&&o&&s){const a=i-e,l=r-n,u=function(t,e,n){let{x:i,z:r,x2:o,z2:s,length:a,width:l}=t;const u=e/n;if(a/l>u){const t=l;l=a/u;const e=(t-l)/2;r+=e,s-=e}else{const t=a;a=l*u;const e=(t-a)/2;i+=e,o-=e}return{x:i,x2:o,z:r,z2:s,length:a,width:l}}(t,a,l);let{x:h,z:c,length:p,width:d}=u;return p*=o/a,d*=s/l,h-=e/o*p,c-=n/s*d,{x:h,z:c,x2:h+p,z2:c+d,length:p,width:d}}return t}({sceneBoundingBox:t,rectLeft:e,rectTop:n,rectRight:i,rectBottom:r,viewportWidth:o,viewportHeight:s})}zoomExtents(t=1,e=!1,n=null){return function({margin:t=0,animate:e,floorPlan:n,boundingBox:i}){if(!n.view.sceneContainer)return Promise.resolve(!1);if(i)return Xc({bb:i,animate:e,view:n.view});let{x:r,z:o,length:s,width:a}=n.getSceneBoundingBox();return r-=t,o-=t,s+=2*t,a+=2*t,Xc({bb:{x:r,z:o,x2:r+s,z2:o+a,length:s,width:a},animate:e,view:n.view})}({margin:t,animate:e,floorPlan:this,boundingBox:n})}zoomToElement(t,e=1,n){return Xc({bb:this.getElementBoundingBox(t,e),animate:n,view:this.view})}setZoom(t,e=!0){return Xc({bb:t,animate:e,view:this.view})}zoomByFactor(t,e=!0){if(!Number.isFinite(t)||t<=0)return Promise.reject("factor is not a positive number");let{x:n,z:i,length:r,width:o}=this.view.viewbox;const s=r/t,a=o/t;n-=(s-r)/2,i-=(a-o)/2;const l=n+r,u=i+o;return this.setZoom({x:n,z:i,length:s,width:a,x2:l,z2:u},e)}addInfoWindow(t={}){return new _c({...t,floorPlan:this})}addHtmlMarker(t={}){return new xc({...t,floorPlan:this})}addMarker({pos:t=[0,0],color:e="#669cff",size:n=40}={}){return new Pc({pos:t,color:e,size:n,floorPlan:this})}getPlanPosition(t){const e=this.view._viewport.toWorld(t[0],t[1]);return[e.x/pc,e.y/pc]}getScreenPosition(t){const e=t.map((t=>t*pc)),n=this.view._viewport.toScreen(e[0],e[1]);return[n.x,n.y]}addLayer({id:t,baseLayer:e}={}){if(t||(t=gt()),this.view.layers.has(t)){const e=this.view.layers.get(t);if(null!=e&&e.container)return e}const n=new up(this,e,t);return this.view.layers.set(t,n),n}getLayer(t){return this.view.layers.get(t)}addPlanGraphic(){return new up(this)}addHelper(t,e={}){let n=e?.helperId;return n||(n="string"==typeof t?t:gt()),this.helper[n]&&this.removeHelper(n),"string"==typeof t?this.availableHelpers[t]?this.helper[n]=new this.availableHelpers[t]({floorPlan:this,helperId:n,...e}):console.warn(`No helper registered for: ${t}`):this.helper[n]=new t({floorPlan:this,helperId:n,...e}),this.helper[n]}removeHelper(t){var e,n;null==(n=null==(e=this.helper[t])?void 0:e.destroy)||n.call(e),delete this.helper[t]}async exportImage({format:t="png",fileName:e,quality:n=90,output:i="base64",maxWidth:r,download:o=!1}={}){let s={format:t,quality:n,output:i,maxWidth:r};o&&(s.format="png");const a=document.querySelector("#"+this.fpeId+" canvas"),l=await function(t,{format:e="png",quality:n=.95}){return new Promise((i=>{let r;r="jpg"===e?t.toDataURL("image/jpeg",n):t.toDataURL(),i(r)}))}(a,s).catch((t=>t));if(!o)return l;!function(t,{format:e,fileName:n,quality:i}={}){if("svg"===e)return;const r=new Image;r.src=t,r.onload=function(){const t=document.createElement("canvas");t.width=r.naturalWidth,t.height=r.naturalHeight;const o=t.getContext("2d");o.imageSmoothingEnabled=!1,o.drawImage(r,0,0),function(t,{format:e="png",fileName:n="floorplan",quality:i=.95}){const r=document.createElement("a");r.download=n+"."+e;let o="png"===e?"image/png":"image/jpeg";t.toBlob((function(t){r.href=URL.createObjectURL(t),r.click()}),o,i)}(t,{format:e,fileName:n,quality:i})}}(l,{format:t,fileName:e,quality:n})}destroy(){var t;null==(t=this.view._viewport)||t.destroy(),this.view.reset(),this.loader.reset(),delete this.scene,delete this.resources,delete this.utils,this.fpeNode&&this.fpeNode.remove(),delete this.fpeNode}}},791:t=>{class e{constructor(t="",e="",n=0,i=10){this.setColorGradient=(n,i)=>{t=o(n),e=o(i)},this.setMidpoint=(t,e)=>{n=t,i=e},this.getColor=n=>{if(n)return"#"+r(n,t.substring(0,2),e.substring(0,2))+r(n,t.substring(2,4),e.substring(2,4))+r(n,t.substring(4,6),e.substring(4,6))};const r=(t,e,r)=>{t<n?t=n:t>i&&(t=i);const o=i-n,s=parseInt(e,16),a=(parseInt(r,16)-s)/o,l=Math.round(a*(t-n)+s);return l<16?"0"+l.toString(16):l.toString(16)},o=t=>t.substring(t.length-6,t.length)}}t.exports=class{constructor(t="",n=10,i=["",""],r=[]){const o=o=>{if(o.length<2)throw new Error(`setColorGradient should have more than ${o.length} color`);{const s=n/(o.length-1),a=new e,l=0,u=0+s;a.setColorGradient(o[0],o[1]),a.setMidpoint(l,u),t=[a],r=[{lower:l,upper:u}];for(let n=1;n<o.length-1;n++){const i=new e,a=0+s*n,l=0+s*(n+1);i.setColorGradient(o[n],o[n+1]),i.setMidpoint(a,l),t[n]=i,r[n]={lower:a,upper:l}}i=o}};this.setColorGradient=(...t)=>(o(t),this),this.getColors=()=>{const e=[];for(let i=0;i<r.length;i++){const o=r[i],s=0===o.lower?1:Math.ceil(o.lower),a=o.upper===n?o.upper+1:Math.ceil(o.upper);for(let n=s;n<a;n++)e.push(t[i].getColor(n))}return e},this.getColor=e=>{if(isNaN(e))throw new TypeError("getColor should be a number");if(e<=0)throw new TypeError(`getColor should be greater than ${e}`);{const i=e+1,r=(n-0)/t.length,o=Math.min(Math.floor((Math.max(e,0)-0)/r),t.length-1);return t[o].getColor(i)}},this.setMidpoint=t=>{if(isNaN(t)||!(t>=0))throw t<=0?new RangeError(`midPoint should be greater than ${t}`):new RangeError("midPoint should be a number");return n=t,o(i),this}}}},907:t=>{var e,n,i=t.exports={};function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(t){if(e===setTimeout)return setTimeout(t,0);if((e===r||!e)&&setTimeout)return e=setTimeout,setTimeout(t,0);try{return e(t,0)}catch(n){try{return e.call(null,t,0)}catch(n){return e.call(this,t,0)}}}!function(){try{e="function"==typeof setTimeout?setTimeout:r}catch(t){e=r}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(t){n=o}}();var a,l=[],u=!1,h=-1;function c(){u&&a&&(u=!1,a.length?l=a.concat(l):h=-1,l.length&&p())}function p(){if(!u){var t=s(c);u=!0;for(var e=l.length;e;){for(a=l,l=[];++h<e;)a&&a[h].run();h=-1,e=l.length}a=null,u=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{return n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function d(t,e){this.fun=t,this.array=e}function f(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];l.push(new d(t,e)),1!==l.length||u||s(p)},d.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=f,i.addListener=f,i.once=f,i.off=f,i.removeListener=f,i.removeAllListeners=f,i.emit=f,i.prependListener=f,i.prependOnceListener=f,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},304:(t,e)=>{"use strict";var n=Symbol.for("react.element"),i=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),d=Symbol.iterator,f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,y={};function g(t,e,n){this.props=t,this.context=e,this.refs=y,this.updater=n||f}function v(){}function _(t,e,n){this.props=t,this.context=e,this.refs=y,this.updater=n||f}g.prototype.isReactComponent={},g.prototype.setState=function(t,e){if("object"!=typeof t&&"function"!=typeof t&&null!=t)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")},g.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},v.prototype=g.prototype;var x=_.prototype=new v;x.constructor=_,m(x,g.prototype),x.isPureReactComponent=!0;var b=Array.isArray,w=Object.prototype.hasOwnProperty,P={current:null},E={key:!0,ref:!0,__self:!0,__source:!0};function T(t,e,i){var r,o={},s=null,a=null;if(null!=e)for(r in void 0!==e.ref&&(a=e.ref),void 0!==e.key&&(s=""+e.key),e)w.call(e,r)&&!E.hasOwnProperty(r)&&(o[r]=e[r]);var l=arguments.length-2;if(1===l)o.children=i;else if(1<l){for(var u=Array(l),h=0;h<l;h++)u[h]=arguments[h+2];o.children=u}if(t&&t.defaultProps)for(r in l=t.defaultProps)void 0===o[r]&&(o[r]=l[r]);return{$$typeof:n,type:t,key:s,ref:a,props:o,_owner:P.current}}function S(t){return"object"==typeof t&&null!==t&&t.$$typeof===n}var C=/\/+/g;function I(t,e){return"object"==typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,(function(t){return e[t]}))}(""+t.key):e.toString(36)}function A(t,e,r,o,s){var a=typeof t;"undefined"!==a&&"boolean"!==a||(t=null);var l=!1;if(null===t)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(t.$$typeof){case n:case i:l=!0}}if(l)return s=s(l=t),t=""===o?"."+I(l,0):o,b(s)?(r="",null!=t&&(r=t.replace(C,"$&/")+"/"),A(s,e,r,"",(function(t){return t}))):null!=s&&(S(s)&&(s=function(t,e){return{$$typeof:n,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}(s,r+(!s.key||l&&l.key===s.key?"":(""+s.key).replace(C,"$&/")+"/")+t)),e.push(s)),1;if(l=0,o=""===o?".":o+":",b(t))for(var u=0;u<t.length;u++){var h=o+I(a=t[u],u);l+=A(a,e,r,h,s)}else if(h=function(t){return null===t||"object"!=typeof t?null:"function"==typeof(t=d&&t[d]||t["@@iterator"])?t:null}(t),"function"==typeof h)for(t=h.call(t),u=0;!(a=t.next()).done;)l+=A(a=a.value,e,r,h=o+I(a,u++),s);else if("object"===a)throw e=String(t),Error("Objects are not valid as a React child (found: "+("[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return l}function O(t,e,n){if(null==t)return t;var i=[],r=0;return A(t,i,"","",(function(t){return e.call(n,t,r++)})),i}function N(t){if(-1===t._status){var e=t._result;(e=e()).then((function(e){0!==t._status&&-1!==t._status||(t._status=1,t._result=e)}),(function(e){0!==t._status&&-1!==t._status||(t._status=2,t._result=e)})),-1===t._status&&(t._status=0,t._result=e)}if(1===t._status)return t._result.default;throw t._result}var L={current:null},M={transition:null},R={ReactCurrentDispatcher:L,ReactCurrentBatchConfig:M,ReactCurrentOwner:P};function k(){throw Error("act(...) is not supported in production builds of React.")}e.Children={map:O,forEach:function(t,e,n){O(t,(function(){e.apply(this,arguments)}),n)},count:function(t){var e=0;return O(t,(function(){e++})),e},toArray:function(t){return O(t,(function(t){return t}))||[]},only:function(t){if(!S(t))throw Error("React.Children.only expected to receive a single React element child.");return t}},e.Component=g,e.Fragment=r,e.Profiler=s,e.PureComponent=_,e.StrictMode=o,e.Suspense=h,e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=R,e.act=k,e.cloneElement=function(t,e,i){if(null==t)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=m({},t.props),o=t.key,s=t.ref,a=t._owner;if(null!=e){if(void 0!==e.ref&&(s=e.ref,a=P.current),void 0!==e.key&&(o=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(u in e)w.call(e,u)&&!E.hasOwnProperty(u)&&(r[u]=void 0===e[u]&&void 0!==l?l[u]:e[u])}var u=arguments.length-2;if(1===u)r.children=i;else if(1<u){l=Array(u);for(var h=0;h<u;h++)l[h]=arguments[h+2];r.children=l}return{$$typeof:n,type:t.type,key:o,ref:s,props:r,_owner:a}},e.createContext=function(t){return(t={$$typeof:l,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:t},t.Consumer=t},e.createElement=T,e.createFactory=function(t){var e=T.bind(null,t);return e.type=t,e},e.createRef=function(){return{current:null}},e.forwardRef=function(t){return{$$typeof:u,render:t}},e.isValidElement=S,e.lazy=function(t){return{$$typeof:p,_payload:{_status:-1,_result:t},_init:N}},e.memo=function(t,e){return{$$typeof:c,type:t,compare:void 0===e?null:e}},e.startTransition=function(t){var e=M.transition;M.transition={};try{t()}finally{M.transition=e}},e.unstable_act=k,e.useCallback=function(t,e){return L.current.useCallback(t,e)},e.useContext=function(t){return L.current.useContext(t)},e.useDebugValue=function(){},e.useDeferredValue=function(t){return L.current.useDeferredValue(t)},e.useEffect=function(t,e){return L.current.useEffect(t,e)},e.useId=function(){return L.current.useId()},e.useImperativeHandle=function(t,e,n){return L.current.useImperativeHandle(t,e,n)},e.useInsertionEffect=function(t,e){return L.current.useInsertionEffect(t,e)},e.useLayoutEffect=function(t,e){return L.current.useLayoutEffect(t,e)},e.useMemo=function(t,e){return L.current.useMemo(t,e)},e.useReducer=function(t,e,n){return L.current.useReducer(t,e,n)},e.useRef=function(t){return L.current.useRef(t)},e.useState=function(t){return L.current.useState(t)},e.useSyncExternalStore=function(t,e,n){return L.current.useSyncExternalStore(t,e,n)},e.useTransition=function(){return L.current.useTransition()},e.version="18.3.1"},41:(t,e,n)=>{"use strict";t.exports=n(304)},889:(t,e,n)=>{"use strict";function i(t){return null==t&&(t=0),{data:[{dataViewWildcard:{matchingOption:t}}]}}n.d(e,{Z:()=>i})},754:(t,e,n)=>{"use strict";n.d(e,{Kx:()=>o,Zp:()=>s,jF:()=>l,ks:()=>h,sk:()=>u});var i=n(639);class r{}class o{}class s extends r{getFormattingCard(t,e,n){return{displayName:n&&this.displayNameKey?n.getDisplayName(this.displayNameKey):this.displayName,description:n&&this.descriptionKey?n.getDisplayName(this.descriptionKey):this.description,groups:[e],uid:t,analyticsPane:this.analyticsPane}}}class a extends r{constructor(t){super(),Object.assign(this,t)}getFormattingSlice(t,e){const n=this.type,i=this.name,r={displayName:e&&this.displayNameKey?e.getDisplayName(this.displayNameKey):this.displayName,description:e&&this.descriptionKey?e.getDisplayName(this.descriptionKey):this.description,uid:t+"-"+i};return Object.assign(Object.assign({},r),{control:{type:n,properties:this.getFormattingComponent(t,e)}})}getFormattingComponent(t,e){return{descriptor:i.y(t,this),value:this.value}}getRevertToDefaultDescriptor(t){return[{objectName:t,propertyName:this.name}]}setPropertiesValues(t,e){var n;let r=null===(n=null==t?void 0:t[e])||void 0===n?void 0:n[this.name];this.value=i.D(this,r,this.value)}}class l extends a{constructor(t){super(t),this.type="ToggleSwitch"}}class u extends a{constructor(t){super(t),this.type="ColorPicker"}getFormattingComponent(t){return Object.assign(Object.assign({},super.getFormattingComponent(t)),{defaultColor:this.defaultColor,isNoFillItemSupported:this.isNoFillItemSupported})}}class h extends a{constructor(t){super(t),this.type="TextInput"}getFormattingComponent(t){return Object.assign(Object.assign({},super.getFormattingComponent(t)),{placeholder:this.placeholder})}}},667:(t,e,n)=>{"use strict";n.d(e,{A:()=>i});const i=class{constructor(t){this.localizationManager=t}populateFormattingSettingsModel(t,e){var n,i,r;let o=new t,s=null===(i=null===(n=null==e?void 0:e[0])||void 0===n?void 0:n.metadata)||void 0===i?void 0:i.objects;return s&&(null===(r=o.cards)||void 0===r||r.forEach((t=>{var e,n,i;null===(e=null==t?void 0:t.slices)||void 0===e||e.forEach((e=>{null==e||e.setPropertiesValues(s,t.name)})),null===(i=null===(n=null==t?void 0:t.container)||void 0===n?void 0:n.containerItems)||void 0===i||i.forEach((e=>{var n;null===(n=null==e?void 0:e.slices)||void 0===n||n.forEach((e=>{null==e||e.setPropertiesValues(s,t.name)}))}))}))),o}buildFormattingModel(t){var e;let n={cards:[]};return null===(e=t.cards)||void 0===e||e.forEach((t=>{if(!t)return;const e=t.name,i=t.name+"-group";let r={displayName:void 0,slices:[],uid:i},o=t.getFormattingCard(e,r,this.localizationManager);n.cards.push(o);const s={};if(t.container){const n=t.container,a=i+"-container",l={displayName:this.localizationManager&&n.displayNameKey?this.localizationManager.getDisplayName(n.displayNameKey):n.displayName,description:this.localizationManager&&n.descriptionKey?this.localizationManager.getDisplayName(n.descriptionKey):n.description,containerItems:[],uid:a};n.containerItems.forEach((t=>{const n=t.displayNameKey?t.displayNameKey:t.displayName,i=a+n;let r={displayName:this.localizationManager&&t.displayNameKey?this.localizationManager.getDisplayName(t.displayNameKey):t.displayName,slices:[],uid:i};this.buildFormattingSlices(t.slices,e,s,o,r.slices),l.containerItems.push(r)})),r.container=l}t.slices&&this.buildFormattingSlices(t.slices,e,s,o,r.slices),o.revertToDefaultDescriptors=this.getRevertToDefaultDescriptor(t)})),n}buildFormattingSlices(t,e,n,i,r){null==t||t.forEach((t=>{let o=null==t?void 0:t.getFormattingSlice(e,this.localizationManager);o&&(void 0===n[t.name]?n[t.name]=0:(n[t.name]++,o.uid=`${o.uid}-${n[t.name]}`),t.topLevelToggle?(o.suppressDisplayName=!0,i.topLevelToggle=o):r.push(o))}))}getRevertToDefaultDescriptor(t){var e,n;const i={};let r=[],o=this.getSlicesRevertToDefaultDescriptor(t.name,t.slices,i),s=[];return null===(n=null===(e=t.container)||void 0===e?void 0:e.containerItems)||void 0===n||n.forEach((e=>{s=s.concat(this.getSlicesRevertToDefaultDescriptor(t.name,e.slices,i))})),r=o.concat(s),r}getSlicesRevertToDefaultDescriptor(t,e,n){let i=[];return null==e||e.forEach((e=>{e&&!n[e.name]&&(n[e.name]=!0,i=i.concat(e.getRevertToDefaultDescriptor(t)))})),i}}},674:(t,e,n)=>{"use strict";n.d(e,{O:()=>r.A,z:()=>i});var i=n(754),r=n(667)},639:(t,e,n)=>{"use strict";function i(t,e){return{objectName:t,propertyName:e.name,selector:e.selector,altConstantValueSelector:e.altConstantSelector,instanceKind:e.instanceKind}}function r(t,e,n){return null==e||"object"==typeof e&&!e.solid?n:e.solid?{value:null==e?void 0:e.solid.color}:(null==t?void 0:t.items)?t.items.find((t=>t.value==e)):e}n.d(e,{D:()=>r,y:()=>i})},551:(t,e,n)=>{"use strict";var i=n(540),r=n(982);function o(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,a={};function l(t,e){u(t,e),u(t+"Capture",e)}function u(t,e){for(a[t]=e,t=0;t<e.length;t++)s.add(e[t])}var h=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),c=Object.prototype.hasOwnProperty,p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d={},f={};function m(t,e,n,i,r,o,s){this.acceptsBooleans=2===e||3===e||4===e,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=s}var y={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(t){y[t]=new m(t,0,!1,t,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(t){var e=t[0];y[e]=new m(e,1,!1,t[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(t){y[t]=new m(t,2,!1,t.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(t){y[t]=new m(t,2,!1,t,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(t){y[t]=new m(t,3,!1,t.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(t){y[t]=new m(t,3,!0,t,null,!1,!1)})),["capture","download"].forEach((function(t){y[t]=new m(t,4,!1,t,null,!1,!1)})),["cols","rows","size","span"].forEach((function(t){y[t]=new m(t,6,!1,t,null,!1,!1)})),["rowSpan","start"].forEach((function(t){y[t]=new m(t,5,!1,t.toLowerCase(),null,!1,!1)}));var g=/[\-:]([a-z])/g;function v(t){return t[1].toUpperCase()}function _(t,e,n,i){var r=y.hasOwnProperty(e)?y[e]:null;(null!==r?0!==r.type:i||!(2<e.length)||"o"!==e[0]&&"O"!==e[0]||"n"!==e[1]&&"N"!==e[1])&&(function(t,e,n,i){if(null==e||function(t,e,n,i){if(null!==n&&0===n.type)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return!i&&(null!==n?!n.acceptsBooleans:"data-"!==(t=t.toLowerCase().slice(0,5))&&"aria-"!==t);default:return!1}}(t,e,n,i))return!0;if(i)return!1;if(null!==n)switch(n.type){case 3:return!e;case 4:return!1===e;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}(e,n,r,i)&&(n=null),i||null===r?function(t){return!!c.call(f,t)||!c.call(d,t)&&(p.test(t)?f[t]=!0:(d[t]=!0,!1))}(e)&&(null===n?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=null===n?3!==r.type&&"":n:(e=r.attributeName,i=r.attributeNamespace,null===n?t.removeAttribute(e):(n=3===(r=r.type)||4===r&&!0===n?"":""+n,i?t.setAttributeNS(i,e,n):t.setAttribute(e,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(t){var e=t.replace(g,v);y[e]=new m(e,1,!1,t,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(t){var e=t.replace(g,v);y[e]=new m(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(t){var e=t.replace(g,v);y[e]=new m(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(t){y[t]=new m(t,1,!1,t.toLowerCase(),null,!1,!1)})),y.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(t){y[t]=new m(t,1,!1,t.toLowerCase(),null,!0,!0)}));var x=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,b=Symbol.for("react.element"),w=Symbol.for("react.portal"),P=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),S=Symbol.for("react.provider"),C=Symbol.for("react.context"),I=Symbol.for("react.forward_ref"),A=Symbol.for("react.suspense"),O=Symbol.for("react.suspense_list"),N=Symbol.for("react.memo"),L=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var M=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var R=Symbol.iterator;function k(t){return null===t||"object"!=typeof t?null:"function"==typeof(t=R&&t[R]||t["@@iterator"])?t:null}var D,F=Object.assign;function B(t){if(void 0===D)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);D=e&&e[1]||""}return"\n"+D+t}var U=!1;function z(t,e){if(!t||U)return"";U=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(e,[])}catch(t){var i=t}Reflect.construct(t,[],e)}else{try{e.call()}catch(t){i=t}t.call(e.prototype)}else{try{throw Error()}catch(t){i=t}t()}}catch(e){if(e&&i&&"string"==typeof e.stack){for(var r=e.stack.split("\n"),o=i.stack.split("\n"),s=r.length-1,a=o.length-1;1<=s&&0<=a&&r[s]!==o[a];)a--;for(;1<=s&&0<=a;s--,a--)if(r[s]!==o[a]){if(1!==s||1!==a)do{if(s--,0>--a||r[s]!==o[a]){var l="\n"+r[s].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}}while(1<=s&&0<=a);break}}}finally{U=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?B(t):""}function X(t){switch(t.tag){case 5:return B(t.type);case 16:return B("Lazy");case 13:return B("Suspense");case 19:return B("SuspenseList");case 0:case 2:case 15:return z(t.type,!1);case 11:return z(t.type.render,!1);case 1:return z(t.type,!0);default:return""}}function Y(t){if(null==t)return null;if("function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t;switch(t){case P:return"Fragment";case w:return"Portal";case T:return"Profiler";case E:return"StrictMode";case A:return"Suspense";case O:return"SuspenseList"}if("object"==typeof t)switch(t.$$typeof){case C:return(t.displayName||"Context")+".Consumer";case S:return(t._context.displayName||"Context")+".Provider";case I:var e=t.render;return(t=t.displayName)||(t=""!==(t=e.displayName||e.name||"")?"ForwardRef("+t+")":"ForwardRef"),t;case N:return null!==(e=t.displayName||null)?e:Y(t.type)||"Memo";case L:e=t._payload,t=t._init;try{return Y(t(e))}catch(t){}}return null}function G(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=(t=e.render).displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Y(e);case 8:return e===E?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e}return null}function H(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":case"object":return t;default:return""}}function W(t){var e=t.type;return(t=t.nodeName)&&"input"===t.toLowerCase()&&("checkbox"===e||"radio"===e)}function j(t){t._valueTracker||(t._valueTracker=function(t){var e=W(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),i=""+t[e];if(!t.hasOwnProperty(e)&&void 0!==n&&"function"==typeof n.get&&"function"==typeof n.set){var r=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(t){i=""+t,o.call(this,t)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(t){i=""+t},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}(t))}function V(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),i="";return t&&(i=W(t)?t.checked?"true":"false":t.value),(t=i)!==n&&(e.setValue(t),!0)}function q(t){if(void 0===(t=t||("undefined"!=typeof document?document:void 0)))return null;try{return t.activeElement||t.body}catch(e){return t.body}}function $(t,e){var n=e.checked;return F({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:t._wrapperState.initialChecked})}function Z(t,e){var n=null==e.defaultValue?"":e.defaultValue,i=null!=e.checked?e.checked:e.defaultChecked;n=H(null!=e.value?e.value:n),t._wrapperState={initialChecked:i,initialValue:n,controlled:"checkbox"===e.type||"radio"===e.type?null!=e.checked:null!=e.value}}function K(t,e){null!=(e=e.checked)&&_(t,"checked",e,!1)}function Q(t,e){K(t,e);var n=H(e.value),i=e.type;if(null!=n)"number"===i?(0===n&&""===t.value||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if("submit"===i||"reset"===i)return void t.removeAttribute("value");e.hasOwnProperty("value")?tt(t,e.type,n):e.hasOwnProperty("defaultValue")&&tt(t,e.type,H(e.defaultValue)),null==e.checked&&null!=e.defaultChecked&&(t.defaultChecked=!!e.defaultChecked)}function J(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!("submit"!==i&&"reset"!==i||void 0!==e.value&&null!==e.value))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}""!==(n=t.name)&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,""!==n&&(t.name=n)}function tt(t,e,n){"number"===e&&q(t.ownerDocument)===t||(null==n?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var et=Array.isArray;function nt(t,e,n,i){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&i&&(t[n].defaultSelected=!0)}else{for(n=""+H(n),e=null,r=0;r<t.length;r++){if(t[r].value===n)return t[r].selected=!0,void(i&&(t[r].defaultSelected=!0));null!==e||t[r].disabled||(e=t[r])}null!==e&&(e.selected=!0)}}function it(t,e){if(null!=e.dangerouslySetInnerHTML)throw Error(o(91));return F({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function rt(t,e){var n=e.value;if(null==n){if(n=e.children,e=e.defaultValue,null!=n){if(null!=e)throw Error(o(92));if(et(n)){if(1<n.length)throw Error(o(93));n=n[0]}e=n}null==e&&(e=""),n=e}t._wrapperState={initialValue:H(n)}}function ot(t,e){var n=H(e.value),i=H(e.defaultValue);null!=n&&((n=""+n)!==t.value&&(t.value=n),null==e.defaultValue&&t.defaultValue!==n&&(t.defaultValue=n)),null!=i&&(t.defaultValue=""+i)}function st(t){var e=t.textContent;e===t._wrapperState.initialValue&&""!==e&&null!==e&&(t.value=e)}function at(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lt(t,e){return null==t||"http://www.w3.org/1999/xhtml"===t?at(e):"http://www.w3.org/2000/svg"===t&&"foreignObject"===e?"http://www.w3.org/1999/xhtml":t}var ut,ht,ct=(ht=function(t,e){if("http://www.w3.org/2000/svg"!==t.namespaceURI||"innerHTML"in t)t.innerHTML=e;else{for((ut=ut||document.createElement("div")).innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ut.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}},"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,e,n,i){MSApp.execUnsafeLocalFunction((function(){return ht(t,e)}))}:ht);function pt(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&3===n.nodeType)return void(n.nodeValue=e)}t.textContent=e}var dt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ft=["Webkit","ms","Moz","O"];function mt(t,e,n){return null==e||"boolean"==typeof e||""===e?"":n||"number"!=typeof e||0===e||dt.hasOwnProperty(t)&&dt[t]?(""+e).trim():e+"px"}function yt(t,e){for(var n in t=t.style,e)if(e.hasOwnProperty(n)){var i=0===n.indexOf("--"),r=mt(n,e[n],i);"float"===n&&(n="cssFloat"),i?t.setProperty(n,r):t[n]=r}}Object.keys(dt).forEach((function(t){ft.forEach((function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),dt[e]=dt[t]}))}));var gt=F({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function vt(t,e){if(e){if(gt[t]&&(null!=e.children||null!=e.dangerouslySetInnerHTML))throw Error(o(137,t));if(null!=e.dangerouslySetInnerHTML){if(null!=e.children)throw Error(o(60));if("object"!=typeof e.dangerouslySetInnerHTML||!("__html"in e.dangerouslySetInnerHTML))throw Error(o(61))}if(null!=e.style&&"object"!=typeof e.style)throw Error(o(62))}}function _t(t,e){if(-1===t.indexOf("-"))return"string"==typeof e.is;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xt=null;function bt(t){return(t=t.target||t.srcElement||window).correspondingUseElement&&(t=t.correspondingUseElement),3===t.nodeType?t.parentNode:t}var wt=null,Pt=null,Et=null;function Tt(t){if(t=_r(t)){if("function"!=typeof wt)throw Error(o(280));var e=t.stateNode;e&&(e=br(e),wt(t.stateNode,t.type,e))}}function St(t){Pt?Et?Et.push(t):Et=[t]:Pt=t}function Ct(){if(Pt){var t=Pt,e=Et;if(Et=Pt=null,Tt(t),e)for(t=0;t<e.length;t++)Tt(e[t])}}function It(t,e){return t(e)}function At(){}var Ot=!1;function Nt(t,e,n){if(Ot)return t(e,n);Ot=!0;try{return It(t,e,n)}finally{Ot=!1,(null!==Pt||null!==Et)&&(At(),Ct())}}function Lt(t,e){var n=t.stateNode;if(null===n)return null;var i=br(n);if(null===i)return null;n=i[e];t:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(i=!("button"===(t=t.type)||"input"===t||"select"===t||"textarea"===t)),t=!i;break t;default:t=!1}if(t)return null;if(n&&"function"!=typeof n)throw Error(o(231,e,typeof n));return n}var Mt=!1;if(h)try{var Rt={};Object.defineProperty(Rt,"passive",{get:function(){Mt=!0}}),window.addEventListener("test",Rt,Rt),window.removeEventListener("test",Rt,Rt)}catch(ht){Mt=!1}function kt(t,e,n,i,r,o,s,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(t){this.onError(t)}}var Dt=!1,Ft=null,Bt=!1,Ut=null,zt={onError:function(t){Dt=!0,Ft=t}};function Xt(t,e,n,i,r,o,s,a,l){Dt=!1,Ft=null,kt.apply(zt,arguments)}function Yt(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do{!!(4098&(e=t).flags)&&(n=e.return),t=e.return}while(t)}return 3===e.tag?n:null}function Gt(t){if(13===t.tag){var e=t.memoizedState;if(null===e&&null!==(t=t.alternate)&&(e=t.memoizedState),null!==e)return e.dehydrated}return null}function Ht(t){if(Yt(t)!==t)throw Error(o(188))}function Wt(t){return null!==(t=function(t){var e=t.alternate;if(!e){if(null===(e=Yt(t)))throw Error(o(188));return e!==t?null:t}for(var n=t,i=e;;){var r=n.return;if(null===r)break;var s=r.alternate;if(null===s){if(null!==(i=r.return)){n=i;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===n)return Ht(r),t;if(s===i)return Ht(r),e;s=s.sibling}throw Error(o(188))}if(n.return!==i.return)n=r,i=s;else{for(var a=!1,l=r.child;l;){if(l===n){a=!0,n=r,i=s;break}if(l===i){a=!0,i=r,n=s;break}l=l.sibling}if(!a){for(l=s.child;l;){if(l===n){a=!0,n=s,i=r;break}if(l===i){a=!0,i=s,n=r;break}l=l.sibling}if(!a)throw Error(o(189))}}if(n.alternate!==i)throw Error(o(190))}if(3!==n.tag)throw Error(o(188));return n.stateNode.current===n?t:e}(t))?jt(t):null}function jt(t){if(5===t.tag||6===t.tag)return t;for(t=t.child;null!==t;){var e=jt(t);if(null!==e)return e;t=t.sibling}return null}var Vt=r.unstable_scheduleCallback,qt=r.unstable_cancelCallback,$t=r.unstable_shouldYield,Zt=r.unstable_requestPaint,Kt=r.unstable_now,Qt=r.unstable_getCurrentPriorityLevel,Jt=r.unstable_ImmediatePriority,te=r.unstable_UserBlockingPriority,ee=r.unstable_NormalPriority,ne=r.unstable_LowPriority,ie=r.unstable_IdlePriority,re=null,oe=null,se=Math.clz32?Math.clz32:function(t){return 0===(t>>>=0)?32:31-(ae(t)/le|0)|0},ae=Math.log,le=Math.LN2,ue=64,he=4194304;function ce(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&t;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&t;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function pe(t,e){var n=t.pendingLanes;if(0===n)return 0;var i=0,r=t.suspendedLanes,o=t.pingedLanes,s=268435455&n;if(0!==s){var a=s&~r;0!==a?i=ce(a):0!=(o&=s)&&(i=ce(o))}else 0!=(s=n&~r)?i=ce(s):0!==o&&(i=ce(o));if(0===i)return 0;if(0!==e&&e!==i&&!(e&r)&&((r=i&-i)>=(o=e&-e)||16===r&&4194240&o))return e;if(4&i&&(i|=16&n),0!==(e=t.entangledLanes))for(t=t.entanglements,e&=i;0<e;)r=1<<(n=31-se(e)),i|=t[n],e&=~r;return i}function de(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;default:return-1}}function fe(t){return 0!=(t=-1073741825&t.pendingLanes)?t:1073741824&t?1073741824:0}function me(){var t=ue;return!(4194240&(ue<<=1))&&(ue=64),t}function ye(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function ge(t,e,n){t.pendingLanes|=e,536870912!==e&&(t.suspendedLanes=0,t.pingedLanes=0),(t=t.eventTimes)[e=31-se(e)]=n}function ve(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var i=31-se(n),r=1<<i;r&e|t[i]&e&&(t[i]|=e),n&=~r}}var _e=0;function xe(t){return 1<(t&=-t)?4<t?268435455&t?16:536870912:4:1}var be,we,Pe,Ee,Te,Se=!1,Ce=[],Ie=null,Ae=null,Oe=null,Ne=new Map,Le=new Map,Me=[],Re="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ke(t,e){switch(t){case"focusin":case"focusout":Ie=null;break;case"dragenter":case"dragleave":Ae=null;break;case"mouseover":case"mouseout":Oe=null;break;case"pointerover":case"pointerout":Ne.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Le.delete(e.pointerId)}}function De(t,e,n,i,r,o){return null===t||t.nativeEvent!==o?(t={blockedOn:e,domEventName:n,eventSystemFlags:i,nativeEvent:o,targetContainers:[r]},null!==e&&null!==(e=_r(e))&&we(e),t):(t.eventSystemFlags|=i,e=t.targetContainers,null!==r&&-1===e.indexOf(r)&&e.push(r),t)}function Fe(t){var e=vr(t.target);if(null!==e){var n=Yt(e);if(null!==n)if(13===(e=n.tag)){if(null!==(e=Gt(n)))return t.blockedOn=e,void Te(t.priority,(function(){Pe(n)}))}else if(3===e&&n.stateNode.current.memoizedState.isDehydrated)return void(t.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}t.blockedOn=null}function Be(t){if(null!==t.blockedOn)return!1;for(var e=t.targetContainers;0<e.length;){var n=$e(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(null!==n)return null!==(e=_r(n))&&we(e),t.blockedOn=n,!1;var i=new(n=t.nativeEvent).constructor(n.type,n);xt=i,n.target.dispatchEvent(i),xt=null,e.shift()}return!0}function Ue(t,e,n){Be(t)&&n.delete(e)}function ze(){Se=!1,null!==Ie&&Be(Ie)&&(Ie=null),null!==Ae&&Be(Ae)&&(Ae=null),null!==Oe&&Be(Oe)&&(Oe=null),Ne.forEach(Ue),Le.forEach(Ue)}function Xe(t,e){t.blockedOn===e&&(t.blockedOn=null,Se||(Se=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,ze)))}function Ye(t){function e(e){return Xe(e,t)}if(0<Ce.length){Xe(Ce[0],t);for(var n=1;n<Ce.length;n++){var i=Ce[n];i.blockedOn===t&&(i.blockedOn=null)}}for(null!==Ie&&Xe(Ie,t),null!==Ae&&Xe(Ae,t),null!==Oe&&Xe(Oe,t),Ne.forEach(e),Le.forEach(e),n=0;n<Me.length;n++)(i=Me[n]).blockedOn===t&&(i.blockedOn=null);for(;0<Me.length&&null===(n=Me[0]).blockedOn;)Fe(n),null===n.blockedOn&&Me.shift()}var Ge=x.ReactCurrentBatchConfig,He=!0;function We(t,e,n,i){var r=_e,o=Ge.transition;Ge.transition=null;try{_e=1,Ve(t,e,n,i)}finally{_e=r,Ge.transition=o}}function je(t,e,n,i){var r=_e,o=Ge.transition;Ge.transition=null;try{_e=4,Ve(t,e,n,i)}finally{_e=r,Ge.transition=o}}function Ve(t,e,n,i){if(He){var r=$e(t,e,n,i);if(null===r)Hi(t,e,i,qe,n),ke(t,i);else if(function(t,e,n,i,r){switch(e){case"focusin":return Ie=De(Ie,t,e,n,i,r),!0;case"dragenter":return Ae=De(Ae,t,e,n,i,r),!0;case"mouseover":return Oe=De(Oe,t,e,n,i,r),!0;case"pointerover":var o=r.pointerId;return Ne.set(o,De(Ne.get(o)||null,t,e,n,i,r)),!0;case"gotpointercapture":return o=r.pointerId,Le.set(o,De(Le.get(o)||null,t,e,n,i,r)),!0}return!1}(r,t,e,n,i))i.stopPropagation();else if(ke(t,i),4&e&&-1<Re.indexOf(t)){for(;null!==r;){var o=_r(r);if(null!==o&&be(o),null===(o=$e(t,e,n,i))&&Hi(t,e,i,qe,n),o===r)break;r=o}null!==r&&i.stopPropagation()}else Hi(t,e,i,null,n)}}var qe=null;function $e(t,e,n,i){if(qe=null,null!==(t=vr(t=bt(i))))if(null===(e=Yt(t)))t=null;else if(13===(n=e.tag)){if(null!==(t=Gt(e)))return t;t=null}else if(3===n){if(e.stateNode.current.memoizedState.isDehydrated)return 3===e.tag?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return qe=t,null}function Ze(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Qt()){case Jt:return 1;case te:return 4;case ee:case ne:return 16;case ie:return 536870912;default:return 16}default:return 16}}var Ke=null,Qe=null,Je=null;function tn(){if(Je)return Je;var t,e,n=Qe,i=n.length,r="value"in Ke?Ke.value:Ke.textContent,o=r.length;for(t=0;t<i&&n[t]===r[t];t++);var s=i-t;for(e=1;e<=s&&n[i-e]===r[o-e];e++);return Je=r.slice(t,1<e?1-e:void 0)}function en(t){var e=t.keyCode;return"charCode"in t?0===(t=t.charCode)&&13===e&&(t=13):t=e,10===t&&(t=13),32<=t||13===t?t:0}function nn(){return!0}function rn(){return!1}function on(t){function e(e,n,i,r,o){for(var s in this._reactName=e,this._targetInst=i,this.type=n,this.nativeEvent=r,this.target=o,this.currentTarget=null,t)t.hasOwnProperty(s)&&(e=t[s],this[s]=e?e(r):r[s]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return F(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():"unknown"!=typeof t.returnValue&&(t.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():"unknown"!=typeof t.cancelBubble&&(t.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),e}var sn,an,ln,un={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},hn=on(un),cn=F({},un,{view:0,detail:0}),pn=on(cn),dn=F({},cn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Tn,button:0,buttons:0,relatedTarget:function(t){return void 0===t.relatedTarget?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ln&&(ln&&"mousemove"===t.type?(sn=t.screenX-ln.screenX,an=t.screenY-ln.screenY):an=sn=0,ln=t),sn)},movementY:function(t){return"movementY"in t?t.movementY:an}}),fn=on(dn),mn=on(F({},dn,{dataTransfer:0})),yn=on(F({},cn,{relatedTarget:0})),gn=on(F({},un,{animationName:0,elapsedTime:0,pseudoElement:0})),vn=F({},un,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),_n=on(vn),xn=on(F({},un,{data:0})),bn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Pn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function En(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):!!(t=Pn[t])&&!!e[t]}function Tn(){return En}var Sn=F({},cn,{key:function(t){if(t.key){var e=bn[t.key]||t.key;if("Unidentified"!==e)return e}return"keypress"===t.type?13===(t=en(t))?"Enter":String.fromCharCode(t):"keydown"===t.type||"keyup"===t.type?wn[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Tn,charCode:function(t){return"keypress"===t.type?en(t):0},keyCode:function(t){return"keydown"===t.type||"keyup"===t.type?t.keyCode:0},which:function(t){return"keypress"===t.type?en(t):"keydown"===t.type||"keyup"===t.type?t.keyCode:0}}),Cn=on(Sn),In=on(F({},dn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),An=on(F({},cn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Tn})),On=on(F({},un,{propertyName:0,elapsedTime:0,pseudoElement:0})),Nn=F({},dn,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Ln=on(Nn),Mn=[9,13,27,32],Rn=h&&"CompositionEvent"in window,kn=null;h&&"documentMode"in document&&(kn=document.documentMode);var Dn=h&&"TextEvent"in window&&!kn,Fn=h&&(!Rn||kn&&8<kn&&11>=kn),Bn=String.fromCharCode(32),Un=!1;function zn(t,e){switch(t){case"keyup":return-1!==Mn.indexOf(e.keyCode);case"keydown":return 229!==e.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Xn(t){return"object"==typeof(t=t.detail)&&"data"in t?t.data:null}var Yn=!1,Gn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hn(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return"input"===e?!!Gn[t.type]:"textarea"===e}function Wn(t,e,n,i){St(i),0<(e=ji(e,"onChange")).length&&(n=new hn("onChange","change",null,n,i),t.push({event:n,listeners:e}))}var jn=null,Vn=null;function qn(t){Bi(t,0)}function $n(t){if(V(xr(t)))return t}function Zn(t,e){if("change"===t)return e}var Kn=!1;if(h){var Qn;if(h){var Jn="oninput"in document;if(!Jn){var ti=document.createElement("div");ti.setAttribute("oninput","return;"),Jn="function"==typeof ti.oninput}Qn=Jn}else Qn=!1;Kn=Qn&&(!document.documentMode||9<document.documentMode)}function ei(){jn&&(jn.detachEvent("onpropertychange",ni),Vn=jn=null)}function ni(t){if("value"===t.propertyName&&$n(Vn)){var e=[];Wn(e,Vn,t,bt(t)),Nt(qn,e)}}function ii(t,e,n){"focusin"===t?(ei(),Vn=n,(jn=e).attachEvent("onpropertychange",ni)):"focusout"===t&&ei()}function ri(t){if("selectionchange"===t||"keyup"===t||"keydown"===t)return $n(Vn)}function oi(t,e){if("click"===t)return $n(e)}function si(t,e){if("input"===t||"change"===t)return $n(e)}var ai="function"==typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t==1/e)||t!=t&&e!=e};function li(t,e){if(ai(t,e))return!0;if("object"!=typeof t||null===t||"object"!=typeof e||null===e)return!1;var n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!c.call(e,r)||!ai(t[r],e[r]))return!1}return!0}function ui(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function hi(t,e){var n,i=ui(t);for(t=0;i;){if(3===i.nodeType){if(n=t+i.textContent.length,t<=e&&n>=e)return{node:i,offset:e-t};t=n}t:{for(;i;){if(i.nextSibling){i=i.nextSibling;break t}i=i.parentNode}i=void 0}i=ui(i)}}function ci(t,e){return!(!t||!e)&&(t===e||(!t||3!==t.nodeType)&&(e&&3===e.nodeType?ci(t,e.parentNode):"contains"in t?t.contains(e):!!t.compareDocumentPosition&&!!(16&t.compareDocumentPosition(e))))}function pi(){for(var t=window,e=q();e instanceof t.HTMLIFrameElement;){try{var n="string"==typeof e.contentWindow.location.href}catch(t){n=!1}if(!n)break;e=q((t=e.contentWindow).document)}return e}function di(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&("input"===e&&("text"===t.type||"search"===t.type||"tel"===t.type||"url"===t.type||"password"===t.type)||"textarea"===e||"true"===t.contentEditable)}function fi(t){var e=pi(),n=t.focusedElem,i=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&ci(n.ownerDocument.documentElement,n)){if(null!==i&&di(n))if(e=i.start,void 0===(t=i.end)&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if((t=(e=n.ownerDocument||document)&&e.defaultView||window).getSelection){t=t.getSelection();var r=n.textContent.length,o=Math.min(i.start,r);i=void 0===i.end?o:Math.min(i.end,r),!t.extend&&o>i&&(r=i,i=o,o=r),r=hi(n,o);var s=hi(n,i);r&&s&&(1!==t.rangeCount||t.anchorNode!==r.node||t.anchorOffset!==r.offset||t.focusNode!==s.node||t.focusOffset!==s.offset)&&((e=e.createRange()).setStart(r.node,r.offset),t.removeAllRanges(),o>i?(t.addRange(e),t.extend(s.node,s.offset)):(e.setEnd(s.node,s.offset),t.addRange(e)))}for(e=[],t=n;t=t.parentNode;)1===t.nodeType&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for("function"==typeof n.focus&&n.focus(),n=0;n<e.length;n++)(t=e[n]).element.scrollLeft=t.left,t.element.scrollTop=t.top}}var mi=h&&"documentMode"in document&&11>=document.documentMode,yi=null,gi=null,vi=null,_i=!1;function xi(t,e,n){var i=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;_i||null==yi||yi!==q(i)||(i="selectionStart"in(i=yi)&&di(i)?{start:i.selectionStart,end:i.selectionEnd}:{anchorNode:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset},vi&&li(vi,i)||(vi=i,0<(i=ji(gi,"onSelect")).length&&(e=new hn("onSelect","select",null,e,n),t.push({event:e,listeners:i}),e.target=yi)))}function bi(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var wi={animationend:bi("Animation","AnimationEnd"),animationiteration:bi("Animation","AnimationIteration"),animationstart:bi("Animation","AnimationStart"),transitionend:bi("Transition","TransitionEnd")},Pi={},Ei={};function Ti(t){if(Pi[t])return Pi[t];if(!wi[t])return t;var e,n=wi[t];for(e in n)if(n.hasOwnProperty(e)&&e in Ei)return Pi[t]=n[e];return t}h&&(Ei=document.createElement("div").style,"AnimationEvent"in window||(delete wi.animationend.animation,delete wi.animationiteration.animation,delete wi.animationstart.animation),"TransitionEvent"in window||delete wi.transitionend.transition);var Si=Ti("animationend"),Ci=Ti("animationiteration"),Ii=Ti("animationstart"),Ai=Ti("transitionend"),Oi=new Map,Ni="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Li(t,e){Oi.set(t,e),l(e,[t])}for(var Mi=0;Mi<Ni.length;Mi++){var Ri=Ni[Mi];Li(Ri.toLowerCase(),"on"+(Ri[0].toUpperCase()+Ri.slice(1)))}Li(Si,"onAnimationEnd"),Li(Ci,"onAnimationIteration"),Li(Ii,"onAnimationStart"),Li("dblclick","onDoubleClick"),Li("focusin","onFocus"),Li("focusout","onBlur"),Li(Ai,"onTransitionEnd"),u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ki="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Di=new Set("cancel close invalid load scroll toggle".split(" ").concat(ki));function Fi(t,e,n){var i=t.type||"unknown-event";t.currentTarget=n,function(t,e,n,i,r,s,a,l,u){if(Xt.apply(this,arguments),Dt){if(!Dt)throw Error(o(198));var h=Ft;Dt=!1,Ft=null,Bt||(Bt=!0,Ut=h)}}(i,e,void 0,t),t.currentTarget=null}function Bi(t,e){e=!!(4&e);for(var n=0;n<t.length;n++){var i=t[n],r=i.event;i=i.listeners;t:{var o=void 0;if(e)for(var s=i.length-1;0<=s;s--){var a=i[s],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==o&&r.isPropagationStopped())break t;Fi(r,a,u),o=l}else for(s=0;s<i.length;s++){if(l=(a=i[s]).instance,u=a.currentTarget,a=a.listener,l!==o&&r.isPropagationStopped())break t;Fi(r,a,u),o=l}}}if(Bt)throw t=Ut,Bt=!1,Ut=null,t}function Ui(t,e){var n=e[mr];void 0===n&&(n=e[mr]=new Set);var i=t+"__bubble";n.has(i)||(Gi(e,t,2,!1),n.add(i))}function zi(t,e,n){var i=0;e&&(i|=4),Gi(n,t,i,e)}var Xi="_reactListening"+Math.random().toString(36).slice(2);function Yi(t){if(!t[Xi]){t[Xi]=!0,s.forEach((function(e){"selectionchange"!==e&&(Di.has(e)||zi(e,!1,t),zi(e,!0,t))}));var e=9===t.nodeType?t:t.ownerDocument;null===e||e[Xi]||(e[Xi]=!0,zi("selectionchange",!1,e))}}function Gi(t,e,n,i){switch(Ze(e)){case 1:var r=We;break;case 4:r=je;break;default:r=Ve}n=r.bind(null,e,n,t),r=void 0,!Mt||"touchstart"!==e&&"touchmove"!==e&&"wheel"!==e||(r=!0),i?void 0!==r?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):void 0!==r?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function Hi(t,e,n,i,r){var o=i;if(!(1&e||2&e||null===i))t:for(;;){if(null===i)return;var s=i.tag;if(3===s||4===s){var a=i.stateNode.containerInfo;if(a===r||8===a.nodeType&&a.parentNode===r)break;if(4===s)for(s=i.return;null!==s;){var l=s.tag;if((3===l||4===l)&&((l=s.stateNode.containerInfo)===r||8===l.nodeType&&l.parentNode===r))return;s=s.return}for(;null!==a;){if(null===(s=vr(a)))return;if(5===(l=s.tag)||6===l){i=o=s;continue t}a=a.parentNode}}i=i.return}Nt((function(){var i=o,r=bt(n),s=[];t:{var a=Oi.get(t);if(void 0!==a){var l=hn,u=t;switch(t){case"keypress":if(0===en(n))break t;case"keydown":case"keyup":l=Cn;break;case"focusin":u="focus",l=yn;break;case"focusout":u="blur",l=yn;break;case"beforeblur":case"afterblur":l=yn;break;case"click":if(2===n.button)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=fn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=An;break;case Si:case Ci:case Ii:l=gn;break;case Ai:l=On;break;case"scroll":l=pn;break;case"wheel":l=Ln;break;case"copy":case"cut":case"paste":l=_n;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=In}var h=!!(4&e),c=!h&&"scroll"===t,p=h?null!==a?a+"Capture":null:a;h=[];for(var d,f=i;null!==f;){var m=(d=f).stateNode;if(5===d.tag&&null!==m&&(d=m,null!==p&&null!=(m=Lt(f,p))&&h.push(Wi(f,m,d))),c)break;f=f.return}0<h.length&&(a=new l(a,u,null,n,r),s.push({event:a,listeners:h}))}}if(!(7&e)){if(l="mouseout"===t||"pointerout"===t,(!(a="mouseover"===t||"pointerover"===t)||n===xt||!(u=n.relatedTarget||n.fromElement)||!vr(u)&&!u[fr])&&(l||a)&&(a=r.window===r?r:(a=r.ownerDocument)?a.defaultView||a.parentWindow:window,l?(l=i,null!==(u=(u=n.relatedTarget||n.toElement)?vr(u):null)&&(u!==(c=Yt(u))||5!==u.tag&&6!==u.tag)&&(u=null)):(l=null,u=i),l!==u)){if(h=fn,m="onMouseLeave",p="onMouseEnter",f="mouse","pointerout"!==t&&"pointerover"!==t||(h=In,m="onPointerLeave",p="onPointerEnter",f="pointer"),c=null==l?a:xr(l),d=null==u?a:xr(u),(a=new h(m,f+"leave",l,n,r)).target=c,a.relatedTarget=d,m=null,vr(r)===i&&((h=new h(p,f+"enter",u,n,r)).target=d,h.relatedTarget=c,m=h),c=m,l&&u)t:{for(p=u,f=0,d=h=l;d;d=Vi(d))f++;for(d=0,m=p;m;m=Vi(m))d++;for(;0<f-d;)h=Vi(h),f--;for(;0<d-f;)p=Vi(p),d--;for(;f--;){if(h===p||null!==p&&h===p.alternate)break t;h=Vi(h),p=Vi(p)}h=null}else h=null;null!==l&&qi(s,a,l,h,!1),null!==u&&null!==c&&qi(s,c,u,h,!0)}if("select"===(l=(a=i?xr(i):window).nodeName&&a.nodeName.toLowerCase())||"input"===l&&"file"===a.type)var y=Zn;else if(Hn(a))if(Kn)y=si;else{y=ri;var g=ii}else(l=a.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(y=oi);switch(y&&(y=y(t,i))?Wn(s,y,n,r):(g&&g(t,a,i),"focusout"===t&&(g=a._wrapperState)&&g.controlled&&"number"===a.type&&tt(a,"number",a.value)),g=i?xr(i):window,t){case"focusin":(Hn(g)||"true"===g.contentEditable)&&(yi=g,gi=i,vi=null);break;case"focusout":vi=gi=yi=null;break;case"mousedown":_i=!0;break;case"contextmenu":case"mouseup":case"dragend":_i=!1,xi(s,n,r);break;case"selectionchange":if(mi)break;case"keydown":case"keyup":xi(s,n,r)}var v;if(Rn)t:{switch(t){case"compositionstart":var _="onCompositionStart";break t;case"compositionend":_="onCompositionEnd";break t;case"compositionupdate":_="onCompositionUpdate";break t}_=void 0}else Yn?zn(t,n)&&(_="onCompositionEnd"):"keydown"===t&&229===n.keyCode&&(_="onCompositionStart");_&&(Fn&&"ko"!==n.locale&&(Yn||"onCompositionStart"!==_?"onCompositionEnd"===_&&Yn&&(v=tn()):(Qe="value"in(Ke=r)?Ke.value:Ke.textContent,Yn=!0)),0<(g=ji(i,_)).length&&(_=new xn(_,t,null,n,r),s.push({event:_,listeners:g}),(v||null!==(v=Xn(n)))&&(_.data=v))),(v=Dn?function(t,e){switch(t){case"compositionend":return Xn(e);case"keypress":return 32!==e.which?null:(Un=!0,Bn);case"textInput":return(t=e.data)===Bn&&Un?null:t;default:return null}}(t,n):function(t,e){if(Yn)return"compositionend"===t||!Rn&&zn(t,e)?(t=tn(),Je=Qe=Ke=null,Yn=!1,t):null;switch(t){case"paste":default:return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Fn&&"ko"!==e.locale?null:e.data}}(t,n))&&0<(i=ji(i,"onBeforeInput")).length&&(r=new xn("onBeforeInput","beforeinput",null,n,r),s.push({event:r,listeners:i}),r.data=v)}Bi(s,e)}))}function Wi(t,e,n){return{instance:t,listener:e,currentTarget:n}}function ji(t,e){for(var n=e+"Capture",i=[];null!==t;){var r=t,o=r.stateNode;5===r.tag&&null!==o&&(r=o,null!=(o=Lt(t,n))&&i.unshift(Wi(t,o,r)),null!=(o=Lt(t,e))&&i.push(Wi(t,o,r))),t=t.return}return i}function Vi(t){if(null===t)return null;do{t=t.return}while(t&&5!==t.tag);return t||null}function qi(t,e,n,i,r){for(var o=e._reactName,s=[];null!==n&&n!==i;){var a=n,l=a.alternate,u=a.stateNode;if(null!==l&&l===i)break;5===a.tag&&null!==u&&(a=u,r?null!=(l=Lt(n,o))&&s.unshift(Wi(n,l,a)):r||null!=(l=Lt(n,o))&&s.push(Wi(n,l,a))),n=n.return}0!==s.length&&t.push({event:e,listeners:s})}var $i=/\r\n?/g,Zi=/\u0000|\uFFFD/g;function Ki(t){return("string"==typeof t?t:""+t).replace($i,"\n").replace(Zi,"")}function Qi(t,e,n){if(e=Ki(e),Ki(t)!==e&&n)throw Error(o(425))}function Ji(){}var tr=null,er=null;function nr(t,e){return"textarea"===t||"noscript"===t||"string"==typeof e.children||"number"==typeof e.children||"object"==typeof e.dangerouslySetInnerHTML&&null!==e.dangerouslySetInnerHTML&&null!=e.dangerouslySetInnerHTML.__html}var ir="function"==typeof setTimeout?setTimeout:void 0,rr="function"==typeof clearTimeout?clearTimeout:void 0,or="function"==typeof Promise?Promise:void 0,sr="function"==typeof queueMicrotask?queueMicrotask:void 0!==or?function(t){return or.resolve(null).then(t).catch(ar)}:ir;function ar(t){setTimeout((function(){throw t}))}function lr(t,e){var n=e,i=0;do{var r=n.nextSibling;if(t.removeChild(n),r&&8===r.nodeType)if("/$"===(n=r.data)){if(0===i)return t.removeChild(r),void Ye(e);i--}else"$"!==n&&"$?"!==n&&"$!"!==n||i++;n=r}while(n);Ye(e)}function ur(t){for(;null!=t;t=t.nextSibling){var e=t.nodeType;if(1===e||3===e)break;if(8===e){if("$"===(e=t.data)||"$!"===e||"$?"===e)break;if("/$"===e)return null}}return t}function hr(t){t=t.previousSibling;for(var e=0;t;){if(8===t.nodeType){var n=t.data;if("$"===n||"$!"===n||"$?"===n){if(0===e)return t;e--}else"/$"===n&&e++}t=t.previousSibling}return null}var cr=Math.random().toString(36).slice(2),pr="__reactFiber$"+cr,dr="__reactProps$"+cr,fr="__reactContainer$"+cr,mr="__reactEvents$"+cr,yr="__reactListeners$"+cr,gr="__reactHandles$"+cr;function vr(t){var e=t[pr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[fr]||n[pr]){if(n=e.alternate,null!==e.child||null!==n&&null!==n.child)for(t=hr(t);null!==t;){if(n=t[pr])return n;t=hr(t)}return e}n=(t=n).parentNode}return null}function _r(t){return!(t=t[pr]||t[fr])||5!==t.tag&&6!==t.tag&&13!==t.tag&&3!==t.tag?null:t}function xr(t){if(5===t.tag||6===t.tag)return t.stateNode;throw Error(o(33))}function br(t){return t[dr]||null}var wr=[],Pr=-1;function Er(t){return{current:t}}function Tr(t){0>Pr||(t.current=wr[Pr],wr[Pr]=null,Pr--)}function Sr(t,e){Pr++,wr[Pr]=t.current,t.current=e}var Cr={},Ir=Er(Cr),Ar=Er(!1),Or=Cr;function Nr(t,e){var n=t.type.contextTypes;if(!n)return Cr;var i=t.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var r,o={};for(r in n)o[r]=e[r];return i&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=o),o}function Lr(t){return null!=t.childContextTypes}function Mr(){Tr(Ar),Tr(Ir)}function Rr(t,e,n){if(Ir.current!==Cr)throw Error(o(168));Sr(Ir,e),Sr(Ar,n)}function kr(t,e,n){var i=t.stateNode;if(e=e.childContextTypes,"function"!=typeof i.getChildContext)return n;for(var r in i=i.getChildContext())if(!(r in e))throw Error(o(108,G(t)||"Unknown",r));return F({},n,i)}function Dr(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Cr,Or=Ir.current,Sr(Ir,t),Sr(Ar,Ar.current),!0}function Fr(t,e,n){var i=t.stateNode;if(!i)throw Error(o(169));n?(t=kr(t,e,Or),i.__reactInternalMemoizedMergedChildContext=t,Tr(Ar),Tr(Ir),Sr(Ir,t)):Tr(Ar),Sr(Ar,n)}var Br=null,Ur=!1,zr=!1;function Xr(t){null===Br?Br=[t]:Br.push(t)}function Yr(){if(!zr&&null!==Br){zr=!0;var t=0,e=_e;try{var n=Br;for(_e=1;t<n.length;t++){var i=n[t];do{i=i(!0)}while(null!==i)}Br=null,Ur=!1}catch(e){throw null!==Br&&(Br=Br.slice(t+1)),Vt(Jt,Yr),e}finally{_e=e,zr=!1}}return null}var Gr=[],Hr=0,Wr=null,jr=0,Vr=[],qr=0,$r=null,Zr=1,Kr="";function Qr(t,e){Gr[Hr++]=jr,Gr[Hr++]=Wr,Wr=t,jr=e}function Jr(t,e,n){Vr[qr++]=Zr,Vr[qr++]=Kr,Vr[qr++]=$r,$r=t;var i=Zr;t=Kr;var r=32-se(i)-1;i&=~(1<<r),n+=1;var o=32-se(e)+r;if(30<o){var s=r-r%5;o=(i&(1<<s)-1).toString(32),i>>=s,r-=s,Zr=1<<32-se(e)+r|n<<r|i,Kr=o+t}else Zr=1<<o|n<<r|i,Kr=t}function to(t){null!==t.return&&(Qr(t,1),Jr(t,1,0))}function eo(t){for(;t===Wr;)Wr=Gr[--Hr],Gr[Hr]=null,jr=Gr[--Hr],Gr[Hr]=null;for(;t===$r;)$r=Vr[--qr],Vr[qr]=null,Kr=Vr[--qr],Vr[qr]=null,Zr=Vr[--qr],Vr[qr]=null}var no=null,io=null,ro=!1,oo=null;function so(t,e){var n=Nu(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,null===(e=t.deletions)?(t.deletions=[n],t.flags|=16):e.push(n)}function ao(t,e){switch(t.tag){case 5:var n=t.type;return null!==(e=1!==e.nodeType||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e)&&(t.stateNode=e,no=t,io=ur(e.firstChild),!0);case 6:return null!==(e=""===t.pendingProps||3!==e.nodeType?null:e)&&(t.stateNode=e,no=t,io=null,!0);case 13:return null!==(e=8!==e.nodeType?null:e)&&(n=null!==$r?{id:Zr,overflow:Kr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},(n=Nu(18,null,null,0)).stateNode=e,n.return=t,t.child=n,no=t,io=null,!0);default:return!1}}function lo(t){return!(!(1&t.mode)||128&t.flags)}function uo(t){if(ro){var e=io;if(e){var n=e;if(!ao(t,e)){if(lo(t))throw Error(o(418));e=ur(n.nextSibling);var i=no;e&&ao(t,e)?so(i,n):(t.flags=-4097&t.flags|2,ro=!1,no=t)}}else{if(lo(t))throw Error(o(418));t.flags=-4097&t.flags|2,ro=!1,no=t}}}function ho(t){for(t=t.return;null!==t&&5!==t.tag&&3!==t.tag&&13!==t.tag;)t=t.return;no=t}function co(t){if(t!==no)return!1;if(!ro)return ho(t),ro=!0,!1;var e;if((e=3!==t.tag)&&!(e=5!==t.tag)&&(e="head"!==(e=t.type)&&"body"!==e&&!nr(t.type,t.memoizedProps)),e&&(e=io)){if(lo(t))throw po(),Error(o(418));for(;e;)so(t,e),e=ur(e.nextSibling)}if(ho(t),13===t.tag){if(!(t=null!==(t=t.memoizedState)?t.dehydrated:null))throw Error(o(317));t:{for(t=t.nextSibling,e=0;t;){if(8===t.nodeType){var n=t.data;if("/$"===n){if(0===e){io=ur(t.nextSibling);break t}e--}else"$"!==n&&"$!"!==n&&"$?"!==n||e++}t=t.nextSibling}io=null}}else io=no?ur(t.stateNode.nextSibling):null;return!0}function po(){for(var t=io;t;)t=ur(t.nextSibling)}function fo(){io=no=null,ro=!1}function mo(t){null===oo?oo=[t]:oo.push(t)}var yo=x.ReactCurrentBatchConfig;function go(t,e,n){if(null!==(t=n.ref)&&"function"!=typeof t&&"object"!=typeof t){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(o(309));var i=n.stateNode}if(!i)throw Error(o(147,t));var r=i,s=""+t;return null!==e&&null!==e.ref&&"function"==typeof e.ref&&e.ref._stringRef===s?e.ref:(e=function(t){var e=r.refs;null===t?delete e[s]:e[s]=t},e._stringRef=s,e)}if("string"!=typeof t)throw Error(o(284));if(!n._owner)throw Error(o(290,t))}return t}function vo(t,e){throw t=Object.prototype.toString.call(e),Error(o(31,"[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function _o(t){return(0,t._init)(t._payload)}function xo(t){function e(e,n){if(t){var i=e.deletions;null===i?(e.deletions=[n],e.flags|=16):i.push(n)}}function n(n,i){if(!t)return null;for(;null!==i;)e(n,i),i=i.sibling;return null}function i(t,e){for(t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function r(t,e){return(t=Mu(t,e)).index=0,t.sibling=null,t}function s(e,n,i){return e.index=i,t?null!==(i=e.alternate)?(i=i.index)<n?(e.flags|=2,n):i:(e.flags|=2,n):(e.flags|=1048576,n)}function a(e){return t&&null===e.alternate&&(e.flags|=2),e}function l(t,e,n,i){return null===e||6!==e.tag?((e=Fu(n,t.mode,i)).return=t,e):((e=r(e,n)).return=t,e)}function u(t,e,n,i){var o=n.type;return o===P?c(t,e,n.props.children,i,n.key):null!==e&&(e.elementType===o||"object"==typeof o&&null!==o&&o.$$typeof===L&&_o(o)===e.type)?((i=r(e,n.props)).ref=go(t,e,n),i.return=t,i):((i=Ru(n.type,n.key,n.props,null,t.mode,i)).ref=go(t,e,n),i.return=t,i)}function h(t,e,n,i){return null===e||4!==e.tag||e.stateNode.containerInfo!==n.containerInfo||e.stateNode.implementation!==n.implementation?((e=Bu(n,t.mode,i)).return=t,e):((e=r(e,n.children||[])).return=t,e)}function c(t,e,n,i,o){return null===e||7!==e.tag?((e=ku(n,t.mode,i,o)).return=t,e):((e=r(e,n)).return=t,e)}function p(t,e,n){if("string"==typeof e&&""!==e||"number"==typeof e)return(e=Fu(""+e,t.mode,n)).return=t,e;if("object"==typeof e&&null!==e){switch(e.$$typeof){case b:return(n=Ru(e.type,e.key,e.props,null,t.mode,n)).ref=go(t,null,e),n.return=t,n;case w:return(e=Bu(e,t.mode,n)).return=t,e;case L:return p(t,(0,e._init)(e._payload),n)}if(et(e)||k(e))return(e=ku(e,t.mode,n,null)).return=t,e;vo(t,e)}return null}function d(t,e,n,i){var r=null!==e?e.key:null;if("string"==typeof n&&""!==n||"number"==typeof n)return null!==r?null:l(t,e,""+n,i);if("object"==typeof n&&null!==n){switch(n.$$typeof){case b:return n.key===r?u(t,e,n,i):null;case w:return n.key===r?h(t,e,n,i):null;case L:return d(t,e,(r=n._init)(n._payload),i)}if(et(n)||k(n))return null!==r?null:c(t,e,n,i,null);vo(t,n)}return null}function f(t,e,n,i,r){if("string"==typeof i&&""!==i||"number"==typeof i)return l(e,t=t.get(n)||null,""+i,r);if("object"==typeof i&&null!==i){switch(i.$$typeof){case b:return u(e,t=t.get(null===i.key?n:i.key)||null,i,r);case w:return h(e,t=t.get(null===i.key?n:i.key)||null,i,r);case L:return f(t,e,n,(0,i._init)(i._payload),r)}if(et(i)||k(i))return c(e,t=t.get(n)||null,i,r,null);vo(e,i)}return null}function m(r,o,a,l){for(var u=null,h=null,c=o,m=o=0,y=null;null!==c&&m<a.length;m++){c.index>m?(y=c,c=null):y=c.sibling;var g=d(r,c,a[m],l);if(null===g){null===c&&(c=y);break}t&&c&&null===g.alternate&&e(r,c),o=s(g,o,m),null===h?u=g:h.sibling=g,h=g,c=y}if(m===a.length)return n(r,c),ro&&Qr(r,m),u;if(null===c){for(;m<a.length;m++)null!==(c=p(r,a[m],l))&&(o=s(c,o,m),null===h?u=c:h.sibling=c,h=c);return ro&&Qr(r,m),u}for(c=i(r,c);m<a.length;m++)null!==(y=f(c,r,m,a[m],l))&&(t&&null!==y.alternate&&c.delete(null===y.key?m:y.key),o=s(y,o,m),null===h?u=y:h.sibling=y,h=y);return t&&c.forEach((function(t){return e(r,t)})),ro&&Qr(r,m),u}function y(r,a,l,u){var h=k(l);if("function"!=typeof h)throw Error(o(150));if(null==(l=h.call(l)))throw Error(o(151));for(var c=h=null,m=a,y=a=0,g=null,v=l.next();null!==m&&!v.done;y++,v=l.next()){m.index>y?(g=m,m=null):g=m.sibling;var _=d(r,m,v.value,u);if(null===_){null===m&&(m=g);break}t&&m&&null===_.alternate&&e(r,m),a=s(_,a,y),null===c?h=_:c.sibling=_,c=_,m=g}if(v.done)return n(r,m),ro&&Qr(r,y),h;if(null===m){for(;!v.done;y++,v=l.next())null!==(v=p(r,v.value,u))&&(a=s(v,a,y),null===c?h=v:c.sibling=v,c=v);return ro&&Qr(r,y),h}for(m=i(r,m);!v.done;y++,v=l.next())null!==(v=f(m,r,y,v.value,u))&&(t&&null!==v.alternate&&m.delete(null===v.key?y:v.key),a=s(v,a,y),null===c?h=v:c.sibling=v,c=v);return t&&m.forEach((function(t){return e(r,t)})),ro&&Qr(r,y),h}return function t(i,o,s,l){if("object"==typeof s&&null!==s&&s.type===P&&null===s.key&&(s=s.props.children),"object"==typeof s&&null!==s){switch(s.$$typeof){case b:t:{for(var u=s.key,h=o;null!==h;){if(h.key===u){if((u=s.type)===P){if(7===h.tag){n(i,h.sibling),(o=r(h,s.props.children)).return=i,i=o;break t}}else if(h.elementType===u||"object"==typeof u&&null!==u&&u.$$typeof===L&&_o(u)===h.type){n(i,h.sibling),(o=r(h,s.props)).ref=go(i,h,s),o.return=i,i=o;break t}n(i,h);break}e(i,h),h=h.sibling}s.type===P?((o=ku(s.props.children,i.mode,l,s.key)).return=i,i=o):((l=Ru(s.type,s.key,s.props,null,i.mode,l)).ref=go(i,o,s),l.return=i,i=l)}return a(i);case w:t:{for(h=s.key;null!==o;){if(o.key===h){if(4===o.tag&&o.stateNode.containerInfo===s.containerInfo&&o.stateNode.implementation===s.implementation){n(i,o.sibling),(o=r(o,s.children||[])).return=i,i=o;break t}n(i,o);break}e(i,o),o=o.sibling}(o=Bu(s,i.mode,l)).return=i,i=o}return a(i);case L:return t(i,o,(h=s._init)(s._payload),l)}if(et(s))return m(i,o,s,l);if(k(s))return y(i,o,s,l);vo(i,s)}return"string"==typeof s&&""!==s||"number"==typeof s?(s=""+s,null!==o&&6===o.tag?(n(i,o.sibling),(o=r(o,s)).return=i,i=o):(n(i,o),(o=Fu(s,i.mode,l)).return=i,i=o),a(i)):n(i,o)}}var bo=xo(!0),wo=xo(!1),Po=Er(null),Eo=null,To=null,So=null;function Co(){So=To=Eo=null}function Io(t){var e=Po.current;Tr(Po),t._currentValue=e}function Ao(t,e,n){for(;null!==t;){var i=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,null!==i&&(i.childLanes|=e)):null!==i&&(i.childLanes&e)!==e&&(i.childLanes|=e),t===n)break;t=t.return}}function Oo(t,e){Eo=t,So=To=null,null!==(t=t.dependencies)&&null!==t.firstContext&&(!!(t.lanes&e)&&(_a=!0),t.firstContext=null)}function No(t){var e=t._currentValue;if(So!==t)if(t={context:t,memoizedValue:e,next:null},null===To){if(null===Eo)throw Error(o(308));To=t,Eo.dependencies={lanes:0,firstContext:t}}else To=To.next=t;return e}var Lo=null;function Mo(t){null===Lo?Lo=[t]:Lo.push(t)}function Ro(t,e,n,i){var r=e.interleaved;return null===r?(n.next=n,Mo(e)):(n.next=r.next,r.next=n),e.interleaved=n,ko(t,i)}function ko(t,e){t.lanes|=e;var n=t.alternate;for(null!==n&&(n.lanes|=e),n=t,t=t.return;null!==t;)t.childLanes|=e,null!==(n=t.alternate)&&(n.childLanes|=e),n=t,t=t.return;return 3===n.tag?n.stateNode:null}var Do=!1;function Fo(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Bo(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Uo(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function zo(t,e,n){var i=t.updateQueue;if(null===i)return null;if(i=i.shared,2&Il){var r=i.pending;return null===r?e.next=e:(e.next=r.next,r.next=e),i.pending=e,ko(t,n)}return null===(r=i.interleaved)?(e.next=e,Mo(i)):(e.next=r.next,r.next=e),i.interleaved=e,ko(t,n)}function Xo(t,e,n){if(null!==(e=e.updateQueue)&&(e=e.shared,4194240&n)){var i=e.lanes;n|=i&=t.pendingLanes,e.lanes=n,ve(t,n)}}function Yo(t,e){var n=t.updateQueue,i=t.alternate;if(null!==i&&n===(i=i.updateQueue)){var r=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===o?r=o=s:o=o.next=s,n=n.next}while(null!==n);null===o?r=o=e:o=o.next=e}else r=o=e;return n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:o,shared:i.shared,effects:i.effects},void(t.updateQueue=n)}null===(t=n.lastBaseUpdate)?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Go(t,e,n,i){var r=t.updateQueue;Do=!1;var o=r.firstBaseUpdate,s=r.lastBaseUpdate,a=r.shared.pending;if(null!==a){r.shared.pending=null;var l=a,u=l.next;l.next=null,null===s?o=u:s.next=u,s=l;var h=t.alternate;null!==h&&(a=(h=h.updateQueue).lastBaseUpdate)!==s&&(null===a?h.firstBaseUpdate=u:a.next=u,h.lastBaseUpdate=l)}if(null!==o){var c=r.baseState;for(s=0,h=u=l=null,a=o;;){var p=a.lane,d=a.eventTime;if((i&p)===p){null!==h&&(h=h.next={eventTime:d,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});t:{var f=t,m=a;switch(p=e,d=n,m.tag){case 1:if("function"==typeof(f=m.payload)){c=f.call(d,c,p);break t}c=f;break t;case 3:f.flags=-65537&f.flags|128;case 0:if(null==(p="function"==typeof(f=m.payload)?f.call(d,c,p):f))break t;c=F({},c,p);break t;case 2:Do=!0}}null!==a.callback&&0!==a.lane&&(t.flags|=64,null===(p=r.effects)?r.effects=[a]:p.push(a))}else d={eventTime:d,lane:p,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===h?(u=h=d,l=c):h=h.next=d,s|=p;if(null===(a=a.next)){if(null===(a=r.shared.pending))break;a=(p=a).next,p.next=null,r.lastBaseUpdate=p,r.shared.pending=null}}if(null===h&&(l=c),r.baseState=l,r.firstBaseUpdate=u,r.lastBaseUpdate=h,null!==(e=r.shared.interleaved)){r=e;do{s|=r.lane,r=r.next}while(r!==e)}else null===o&&(r.shared.lanes=0);Dl|=s,t.lanes=s,t.memoizedState=c}}function Ho(t,e,n){if(t=e.effects,e.effects=null,null!==t)for(e=0;e<t.length;e++){var i=t[e],r=i.callback;if(null!==r){if(i.callback=null,i=n,"function"!=typeof r)throw Error(o(191,r));r.call(i)}}}var Wo={},jo=Er(Wo),Vo=Er(Wo),qo=Er(Wo);function $o(t){if(t===Wo)throw Error(o(174));return t}function Zo(t,e){switch(Sr(qo,e),Sr(Vo,t),Sr(jo,Wo),t=e.nodeType){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:lt(null,"");break;default:e=lt(e=(t=8===t?e.parentNode:e).namespaceURI||null,t=t.tagName)}Tr(jo),Sr(jo,e)}function Ko(){Tr(jo),Tr(Vo),Tr(qo)}function Qo(t){$o(qo.current);var e=$o(jo.current),n=lt(e,t.type);e!==n&&(Sr(Vo,t),Sr(jo,n))}function Jo(t){Vo.current===t&&(Tr(jo),Tr(Vo))}var ts=Er(0);function es(t){for(var e=t;null!==e;){if(13===e.tag){var n=e.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return e}else if(19===e.tag&&void 0!==e.memoizedProps.revealOrder){if(128&e.flags)return e}else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var ns=[];function is(){for(var t=0;t<ns.length;t++)ns[t]._workInProgressVersionPrimary=null;ns.length=0}var rs=x.ReactCurrentDispatcher,os=x.ReactCurrentBatchConfig,ss=0,as=null,ls=null,us=null,hs=!1,cs=!1,ps=0,ds=0;function fs(){throw Error(o(321))}function ms(t,e){if(null===e)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!ai(t[n],e[n]))return!1;return!0}function ys(t,e,n,i,r,s){if(ss=s,as=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,rs.current=null===t||null===t.memoizedState?Js:ta,t=n(i,r),cs){s=0;do{if(cs=!1,ps=0,25<=s)throw Error(o(301));s+=1,us=ls=null,e.updateQueue=null,rs.current=ea,t=n(i,r)}while(cs)}if(rs.current=Qs,e=null!==ls&&null!==ls.next,ss=0,us=ls=as=null,hs=!1,e)throw Error(o(300));return t}function gs(){var t=0!==ps;return ps=0,t}function vs(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===us?as.memoizedState=us=t:us=us.next=t,us}function _s(){if(null===ls){var t=as.alternate;t=null!==t?t.memoizedState:null}else t=ls.next;var e=null===us?as.memoizedState:us.next;if(null!==e)us=e,ls=t;else{if(null===t)throw Error(o(310));t={memoizedState:(ls=t).memoizedState,baseState:ls.baseState,baseQueue:ls.baseQueue,queue:ls.queue,next:null},null===us?as.memoizedState=us=t:us=us.next=t}return us}function xs(t,e){return"function"==typeof e?e(t):e}function bs(t){var e=_s(),n=e.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=t;var i=ls,r=i.baseQueue,s=n.pending;if(null!==s){if(null!==r){var a=r.next;r.next=s.next,s.next=a}i.baseQueue=r=s,n.pending=null}if(null!==r){s=r.next,i=i.baseState;var l=a=null,u=null,h=s;do{var c=h.lane;if((ss&c)===c)null!==u&&(u=u.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),i=h.hasEagerState?h.eagerState:t(i,h.action);else{var p={lane:c,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};null===u?(l=u=p,a=i):u=u.next=p,as.lanes|=c,Dl|=c}h=h.next}while(null!==h&&h!==s);null===u?a=i:u.next=l,ai(i,e.memoizedState)||(_a=!0),e.memoizedState=i,e.baseState=a,e.baseQueue=u,n.lastRenderedState=i}if(null!==(t=n.interleaved)){r=t;do{s=r.lane,as.lanes|=s,Dl|=s,r=r.next}while(r!==t)}else null===r&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function ws(t){var e=_s(),n=e.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=t;var i=n.dispatch,r=n.pending,s=e.memoizedState;if(null!==r){n.pending=null;var a=r=r.next;do{s=t(s,a.action),a=a.next}while(a!==r);ai(s,e.memoizedState)||(_a=!0),e.memoizedState=s,null===e.baseQueue&&(e.baseState=s),n.lastRenderedState=s}return[s,i]}function Ps(){}function Es(t,e){var n=as,i=_s(),r=e(),s=!ai(i.memoizedState,r);if(s&&(i.memoizedState=r,_a=!0),i=i.queue,Ds(Cs.bind(null,n,i,t),[t]),i.getSnapshot!==e||s||null!==us&&1&us.memoizedState.tag){if(n.flags|=2048,Ns(9,Ss.bind(null,n,i,r,e),void 0,null),null===Al)throw Error(o(349));30&ss||Ts(n,e,r)}return r}function Ts(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},null===(e=as.updateQueue)?(e={lastEffect:null,stores:null},as.updateQueue=e,e.stores=[t]):null===(n=e.stores)?e.stores=[t]:n.push(t)}function Ss(t,e,n,i){e.value=n,e.getSnapshot=i,Is(e)&&As(t)}function Cs(t,e,n){return n((function(){Is(e)&&As(t)}))}function Is(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!ai(t,n)}catch(t){return!0}}function As(t){var e=ko(t,1);null!==e&&nu(e,t,1,-1)}function Os(t){var e=vs();return"function"==typeof t&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:xs,lastRenderedState:t},e.queue=t,t=t.dispatch=qs.bind(null,as,t),[e.memoizedState,t]}function Ns(t,e,n,i){return t={tag:t,create:e,destroy:n,deps:i,next:null},null===(e=as.updateQueue)?(e={lastEffect:null,stores:null},as.updateQueue=e,e.lastEffect=t.next=t):null===(n=e.lastEffect)?e.lastEffect=t.next=t:(i=n.next,n.next=t,t.next=i,e.lastEffect=t),t}function Ls(){return _s().memoizedState}function Ms(t,e,n,i){var r=vs();as.flags|=t,r.memoizedState=Ns(1|e,n,void 0,void 0===i?null:i)}function Rs(t,e,n,i){var r=_s();i=void 0===i?null:i;var o=void 0;if(null!==ls){var s=ls.memoizedState;if(o=s.destroy,null!==i&&ms(i,s.deps))return void(r.memoizedState=Ns(e,n,o,i))}as.flags|=t,r.memoizedState=Ns(1|e,n,o,i)}function ks(t,e){return Ms(8390656,8,t,e)}function Ds(t,e){return Rs(2048,8,t,e)}function Fs(t,e){return Rs(4,2,t,e)}function Bs(t,e){return Rs(4,4,t,e)}function Us(t,e){return"function"==typeof e?(t=t(),e(t),function(){e(null)}):null!=e?(t=t(),e.current=t,function(){e.current=null}):void 0}function zs(t,e,n){return n=null!=n?n.concat([t]):null,Rs(4,4,Us.bind(null,e,t),n)}function Xs(){}function Ys(t,e){var n=_s();e=void 0===e?null:e;var i=n.memoizedState;return null!==i&&null!==e&&ms(e,i[1])?i[0]:(n.memoizedState=[t,e],t)}function Gs(t,e){var n=_s();e=void 0===e?null:e;var i=n.memoizedState;return null!==i&&null!==e&&ms(e,i[1])?i[0]:(t=t(),n.memoizedState=[t,e],t)}function Hs(t,e,n){return 21&ss?(ai(n,e)||(n=me(),as.lanes|=n,Dl|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,_a=!0),t.memoizedState=n)}function Ws(t,e){var n=_e;_e=0!==n&&4>n?n:4,t(!0);var i=os.transition;os.transition={};try{t(!1),e()}finally{_e=n,os.transition=i}}function js(){return _s().memoizedState}function Vs(t,e,n){var i=eu(t);n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},$s(t)?Zs(e,n):null!==(n=Ro(t,e,n,i))&&(nu(n,t,i,tu()),Ks(n,e,i))}function qs(t,e,n){var i=eu(t),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if($s(t))Zs(e,r);else{var o=t.alternate;if(0===t.lanes&&(null===o||0===o.lanes)&&null!==(o=e.lastRenderedReducer))try{var s=e.lastRenderedState,a=o(s,n);if(r.hasEagerState=!0,r.eagerState=a,ai(a,s)){var l=e.interleaved;return null===l?(r.next=r,Mo(e)):(r.next=l.next,l.next=r),void(e.interleaved=r)}}catch(t){}null!==(n=Ro(t,e,r,i))&&(nu(n,t,i,r=tu()),Ks(n,e,i))}}function $s(t){var e=t.alternate;return t===as||null!==e&&e===as}function Zs(t,e){cs=hs=!0;var n=t.pending;null===n?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Ks(t,e,n){if(4194240&n){var i=e.lanes;n|=i&=t.pendingLanes,e.lanes=n,ve(t,n)}}var Qs={readContext:No,useCallback:fs,useContext:fs,useEffect:fs,useImperativeHandle:fs,useInsertionEffect:fs,useLayoutEffect:fs,useMemo:fs,useReducer:fs,useRef:fs,useState:fs,useDebugValue:fs,useDeferredValue:fs,useTransition:fs,useMutableSource:fs,useSyncExternalStore:fs,useId:fs,unstable_isNewReconciler:!1},Js={readContext:No,useCallback:function(t,e){return vs().memoizedState=[t,void 0===e?null:e],t},useContext:No,useEffect:ks,useImperativeHandle:function(t,e,n){return n=null!=n?n.concat([t]):null,Ms(4194308,4,Us.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Ms(4194308,4,t,e)},useInsertionEffect:function(t,e){return Ms(4,2,t,e)},useMemo:function(t,e){var n=vs();return e=void 0===e?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var i=vs();return e=void 0!==n?n(e):e,i.memoizedState=i.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},i.queue=t,t=t.dispatch=Vs.bind(null,as,t),[i.memoizedState,t]},useRef:function(t){return t={current:t},vs().memoizedState=t},useState:Os,useDebugValue:Xs,useDeferredValue:function(t){return vs().memoizedState=t},useTransition:function(){var t=Os(!1),e=t[0];return t=Ws.bind(null,t[1]),vs().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var i=as,r=vs();if(ro){if(void 0===n)throw Error(o(407));n=n()}else{if(n=e(),null===Al)throw Error(o(349));30&ss||Ts(i,e,n)}r.memoizedState=n;var s={value:n,getSnapshot:e};return r.queue=s,ks(Cs.bind(null,i,s,t),[t]),i.flags|=2048,Ns(9,Ss.bind(null,i,s,n,e),void 0,null),n},useId:function(){var t=vs(),e=Al.identifierPrefix;if(ro){var n=Kr;e=":"+e+"R"+(n=(Zr&~(1<<32-se(Zr)-1)).toString(32)+n),0<(n=ps++)&&(e+="H"+n.toString(32)),e+=":"}else e=":"+e+"r"+(n=ds++).toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},ta={readContext:No,useCallback:Ys,useContext:No,useEffect:Ds,useImperativeHandle:zs,useInsertionEffect:Fs,useLayoutEffect:Bs,useMemo:Gs,useReducer:bs,useRef:Ls,useState:function(){return bs(xs)},useDebugValue:Xs,useDeferredValue:function(t){return Hs(_s(),ls.memoizedState,t)},useTransition:function(){return[bs(xs)[0],_s().memoizedState]},useMutableSource:Ps,useSyncExternalStore:Es,useId:js,unstable_isNewReconciler:!1},ea={readContext:No,useCallback:Ys,useContext:No,useEffect:Ds,useImperativeHandle:zs,useInsertionEffect:Fs,useLayoutEffect:Bs,useMemo:Gs,useReducer:ws,useRef:Ls,useState:function(){return ws(xs)},useDebugValue:Xs,useDeferredValue:function(t){var e=_s();return null===ls?e.memoizedState=t:Hs(e,ls.memoizedState,t)},useTransition:function(){return[ws(xs)[0],_s().memoizedState]},useMutableSource:Ps,useSyncExternalStore:Es,useId:js,unstable_isNewReconciler:!1};function na(t,e){if(t&&t.defaultProps){for(var n in e=F({},e),t=t.defaultProps)void 0===e[n]&&(e[n]=t[n]);return e}return e}function ia(t,e,n,i){n=null==(n=n(i,e=t.memoizedState))?e:F({},e,n),t.memoizedState=n,0===t.lanes&&(t.updateQueue.baseState=n)}var ra={isMounted:function(t){return!!(t=t._reactInternals)&&Yt(t)===t},enqueueSetState:function(t,e,n){t=t._reactInternals;var i=tu(),r=eu(t),o=Uo(i,r);o.payload=e,null!=n&&(o.callback=n),null!==(e=zo(t,o,r))&&(nu(e,t,r,i),Xo(e,t,r))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var i=tu(),r=eu(t),o=Uo(i,r);o.tag=1,o.payload=e,null!=n&&(o.callback=n),null!==(e=zo(t,o,r))&&(nu(e,t,r,i),Xo(e,t,r))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=tu(),i=eu(t),r=Uo(n,i);r.tag=2,null!=e&&(r.callback=e),null!==(e=zo(t,r,i))&&(nu(e,t,i,n),Xo(e,t,i))}};function oa(t,e,n,i,r,o,s){return"function"==typeof(t=t.stateNode).shouldComponentUpdate?t.shouldComponentUpdate(i,o,s):!(e.prototype&&e.prototype.isPureReactComponent&&li(n,i)&&li(r,o))}function sa(t,e,n){var i=!1,r=Cr,o=e.contextType;return"object"==typeof o&&null!==o?o=No(o):(r=Lr(e)?Or:Ir.current,o=(i=null!=(i=e.contextTypes))?Nr(t,r):Cr),e=new e(n,o),t.memoizedState=null!==e.state&&void 0!==e.state?e.state:null,e.updater=ra,t.stateNode=e,e._reactInternals=t,i&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=o),e}function aa(t,e,n,i){t=e.state,"function"==typeof e.componentWillReceiveProps&&e.componentWillReceiveProps(n,i),"function"==typeof e.UNSAFE_componentWillReceiveProps&&e.UNSAFE_componentWillReceiveProps(n,i),e.state!==t&&ra.enqueueReplaceState(e,e.state,null)}function la(t,e,n,i){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs={},Fo(t);var o=e.contextType;"object"==typeof o&&null!==o?r.context=No(o):(o=Lr(e)?Or:Ir.current,r.context=Nr(t,o)),r.state=t.memoizedState,"function"==typeof(o=e.getDerivedStateFromProps)&&(ia(t,e,o,n),r.state=t.memoizedState),"function"==typeof e.getDerivedStateFromProps||"function"==typeof r.getSnapshotBeforeUpdate||"function"!=typeof r.UNSAFE_componentWillMount&&"function"!=typeof r.componentWillMount||(e=r.state,"function"==typeof r.componentWillMount&&r.componentWillMount(),"function"==typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),e!==r.state&&ra.enqueueReplaceState(r,r.state,null),Go(t,n,r,i),r.state=t.memoizedState),"function"==typeof r.componentDidMount&&(t.flags|=4194308)}function ua(t,e){try{var n="",i=e;do{n+=X(i),i=i.return}while(i);var r=n}catch(t){r="\nError generating stack: "+t.message+"\n"+t.stack}return{value:t,source:e,stack:r,digest:null}}function ha(t,e,n){return{value:t,source:null,stack:null!=n?n:null,digest:null!=e?e:null}}function ca(t,e){try{console.error(e.value)}catch(t){setTimeout((function(){throw t}))}}var pa="function"==typeof WeakMap?WeakMap:Map;function da(t,e,n){(n=Uo(-1,n)).tag=3,n.payload={element:null};var i=e.value;return n.callback=function(){Hl||(Hl=!0,Wl=i),ca(0,e)},n}function fa(t,e,n){(n=Uo(-1,n)).tag=3;var i=t.type.getDerivedStateFromError;if("function"==typeof i){var r=e.value;n.payload=function(){return i(r)},n.callback=function(){ca(0,e)}}var o=t.stateNode;return null!==o&&"function"==typeof o.componentDidCatch&&(n.callback=function(){ca(0,e),"function"!=typeof i&&(null===jl?jl=new Set([this]):jl.add(this));var t=e.stack;this.componentDidCatch(e.value,{componentStack:null!==t?t:""})}),n}function ma(t,e,n){var i=t.pingCache;if(null===i){i=t.pingCache=new pa;var r=new Set;i.set(e,r)}else void 0===(r=i.get(e))&&(r=new Set,i.set(e,r));r.has(n)||(r.add(n),t=Tu.bind(null,t,e,n),e.then(t,t))}function ya(t){do{var e;if((e=13===t.tag)&&(e=null===(e=t.memoizedState)||null!==e.dehydrated),e)return t;t=t.return}while(null!==t);return null}function ga(t,e,n,i,r){return 1&t.mode?(t.flags|=65536,t.lanes=r,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((e=Uo(-1,1)).tag=2,zo(n,e,1))),n.lanes|=1),t)}var va=x.ReactCurrentOwner,_a=!1;function xa(t,e,n,i){e.child=null===t?wo(e,null,n,i):bo(e,t.child,n,i)}function ba(t,e,n,i,r){n=n.render;var o=e.ref;return Oo(e,r),i=ys(t,e,n,i,o,r),n=gs(),null===t||_a?(ro&&n&&to(e),e.flags|=1,xa(t,e,i,r),e.child):(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,Ha(t,e,r))}function wa(t,e,n,i,r){if(null===t){var o=n.type;return"function"!=typeof o||Lu(o)||void 0!==o.defaultProps||null!==n.compare||void 0!==n.defaultProps?((t=Ru(n.type,null,i,e,e.mode,r)).ref=e.ref,t.return=e,e.child=t):(e.tag=15,e.type=o,Pa(t,e,o,i,r))}if(o=t.child,!(t.lanes&r)){var s=o.memoizedProps;if((n=null!==(n=n.compare)?n:li)(s,i)&&t.ref===e.ref)return Ha(t,e,r)}return e.flags|=1,(t=Mu(o,i)).ref=e.ref,t.return=e,e.child=t}function Pa(t,e,n,i,r){if(null!==t){var o=t.memoizedProps;if(li(o,i)&&t.ref===e.ref){if(_a=!1,e.pendingProps=i=o,!(t.lanes&r))return e.lanes=t.lanes,Ha(t,e,r);131072&t.flags&&(_a=!0)}}return Sa(t,e,n,i,r)}function Ea(t,e,n){var i=e.pendingProps,r=i.children,o=null!==t?t.memoizedState:null;if("hidden"===i.mode)if(1&e.mode){if(!(1073741824&n))return t=null!==o?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Sr(Ml,Ll),Ll|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=null!==o?o.baseLanes:n,Sr(Ml,Ll),Ll|=i}else e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Sr(Ml,Ll),Ll|=n;else null!==o?(i=o.baseLanes|n,e.memoizedState=null):i=n,Sr(Ml,Ll),Ll|=i;return xa(t,e,r,n),e.child}function Ta(t,e){var n=e.ref;(null===t&&null!==n||null!==t&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Sa(t,e,n,i,r){var o=Lr(n)?Or:Ir.current;return o=Nr(e,o),Oo(e,r),n=ys(t,e,n,i,o,r),i=gs(),null===t||_a?(ro&&i&&to(e),e.flags|=1,xa(t,e,n,r),e.child):(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,Ha(t,e,r))}function Ca(t,e,n,i,r){if(Lr(n)){var o=!0;Dr(e)}else o=!1;if(Oo(e,r),null===e.stateNode)Ga(t,e),sa(e,n,i),la(e,n,i,r),i=!0;else if(null===t){var s=e.stateNode,a=e.memoizedProps;s.props=a;var l=s.context,u=n.contextType;u="object"==typeof u&&null!==u?No(u):Nr(e,u=Lr(n)?Or:Ir.current);var h=n.getDerivedStateFromProps,c="function"==typeof h||"function"==typeof s.getSnapshotBeforeUpdate;c||"function"!=typeof s.UNSAFE_componentWillReceiveProps&&"function"!=typeof s.componentWillReceiveProps||(a!==i||l!==u)&&aa(e,s,i,u),Do=!1;var p=e.memoizedState;s.state=p,Go(e,i,s,r),l=e.memoizedState,a!==i||p!==l||Ar.current||Do?("function"==typeof h&&(ia(e,n,h,i),l=e.memoizedState),(a=Do||oa(e,n,a,i,p,l,u))?(c||"function"!=typeof s.UNSAFE_componentWillMount&&"function"!=typeof s.componentWillMount||("function"==typeof s.componentWillMount&&s.componentWillMount(),"function"==typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"==typeof s.componentDidMount&&(e.flags|=4194308)):("function"==typeof s.componentDidMount&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=l),s.props=i,s.state=l,s.context=u,i=a):("function"==typeof s.componentDidMount&&(e.flags|=4194308),i=!1)}else{s=e.stateNode,Bo(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:na(e.type,a),s.props=u,c=e.pendingProps,p=s.context,l="object"==typeof(l=n.contextType)&&null!==l?No(l):Nr(e,l=Lr(n)?Or:Ir.current);var d=n.getDerivedStateFromProps;(h="function"==typeof d||"function"==typeof s.getSnapshotBeforeUpdate)||"function"!=typeof s.UNSAFE_componentWillReceiveProps&&"function"!=typeof s.componentWillReceiveProps||(a!==c||p!==l)&&aa(e,s,i,l),Do=!1,p=e.memoizedState,s.state=p,Go(e,i,s,r);var f=e.memoizedState;a!==c||p!==f||Ar.current||Do?("function"==typeof d&&(ia(e,n,d,i),f=e.memoizedState),(u=Do||oa(e,n,u,i,p,f,l)||!1)?(h||"function"!=typeof s.UNSAFE_componentWillUpdate&&"function"!=typeof s.componentWillUpdate||("function"==typeof s.componentWillUpdate&&s.componentWillUpdate(i,f,l),"function"==typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(i,f,l)),"function"==typeof s.componentDidUpdate&&(e.flags|=4),"function"==typeof s.getSnapshotBeforeUpdate&&(e.flags|=1024)):("function"!=typeof s.componentDidUpdate||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),"function"!=typeof s.getSnapshotBeforeUpdate||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=f),s.props=i,s.state=f,s.context=l,i=u):("function"!=typeof s.componentDidUpdate||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),"function"!=typeof s.getSnapshotBeforeUpdate||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),i=!1)}return Ia(t,e,n,i,o,r)}function Ia(t,e,n,i,r,o){Ta(t,e);var s=!!(128&e.flags);if(!i&&!s)return r&&Fr(e,n,!1),Ha(t,e,o);i=e.stateNode,va.current=e;var a=s&&"function"!=typeof n.getDerivedStateFromError?null:i.render();return e.flags|=1,null!==t&&s?(e.child=bo(e,t.child,null,o),e.child=bo(e,null,a,o)):xa(t,e,a,o),e.memoizedState=i.state,r&&Fr(e,n,!0),e.child}function Aa(t){var e=t.stateNode;e.pendingContext?Rr(0,e.pendingContext,e.pendingContext!==e.context):e.context&&Rr(0,e.context,!1),Zo(t,e.containerInfo)}function Oa(t,e,n,i,r){return fo(),mo(r),e.flags|=256,xa(t,e,n,i),e.child}var Na,La,Ma,Ra,ka={dehydrated:null,treeContext:null,retryLane:0};function Da(t){return{baseLanes:t,cachePool:null,transitions:null}}function Fa(t,e,n){var i,r=e.pendingProps,s=ts.current,a=!1,l=!!(128&e.flags);if((i=l)||(i=(null===t||null!==t.memoizedState)&&!!(2&s)),i?(a=!0,e.flags&=-129):null!==t&&null===t.memoizedState||(s|=1),Sr(ts,1&s),null===t)return uo(e),null!==(t=e.memoizedState)&&null!==(t=t.dehydrated)?(1&e.mode?"$!"===t.data?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(l=r.children,t=r.fallback,a?(r=e.mode,a=e.child,l={mode:"hidden",children:l},1&r||null===a?a=Du(l,r,0,null):(a.childLanes=0,a.pendingProps=l),t=ku(t,r,n,null),a.return=e,t.return=e,a.sibling=t,e.child=a,e.child.memoizedState=Da(n),e.memoizedState=ka,t):Ba(e,l));if(null!==(s=t.memoizedState)&&null!==(i=s.dehydrated))return function(t,e,n,i,r,s,a){if(n)return 256&e.flags?(e.flags&=-257,Ua(t,e,a,i=ha(Error(o(422))))):null!==e.memoizedState?(e.child=t.child,e.flags|=128,null):(s=i.fallback,r=e.mode,i=Du({mode:"visible",children:i.children},r,0,null),(s=ku(s,r,a,null)).flags|=2,i.return=e,s.return=e,i.sibling=s,e.child=i,1&e.mode&&bo(e,t.child,null,a),e.child.memoizedState=Da(a),e.memoizedState=ka,s);if(!(1&e.mode))return Ua(t,e,a,null);if("$!"===r.data){if(i=r.nextSibling&&r.nextSibling.dataset)var l=i.dgst;return i=l,Ua(t,e,a,i=ha(s=Error(o(419)),i,void 0))}if(l=!!(a&t.childLanes),_a||l){if(null!==(i=Al)){switch(a&-a){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}0!==(r=r&(i.suspendedLanes|a)?0:r)&&r!==s.retryLane&&(s.retryLane=r,ko(t,r),nu(i,t,r,-1))}return mu(),Ua(t,e,a,i=ha(Error(o(421))))}return"$?"===r.data?(e.flags|=128,e.child=t.child,e=Cu.bind(null,t),r._reactRetry=e,null):(t=s.treeContext,io=ur(r.nextSibling),no=e,ro=!0,oo=null,null!==t&&(Vr[qr++]=Zr,Vr[qr++]=Kr,Vr[qr++]=$r,Zr=t.id,Kr=t.overflow,$r=e),(e=Ba(e,i.children)).flags|=4096,e)}(t,e,l,r,i,s,n);if(a){a=r.fallback,l=e.mode,i=(s=t.child).sibling;var u={mode:"hidden",children:r.children};return 1&l||e.child===s?(r=Mu(s,u)).subtreeFlags=14680064&s.subtreeFlags:((r=e.child).childLanes=0,r.pendingProps=u,e.deletions=null),null!==i?a=Mu(i,a):(a=ku(a,l,n,null)).flags|=2,a.return=e,r.return=e,r.sibling=a,e.child=r,r=a,a=e.child,l=null===(l=t.child.memoizedState)?Da(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},a.memoizedState=l,a.childLanes=t.childLanes&~n,e.memoizedState=ka,r}return t=(a=t.child).sibling,r=Mu(a,{mode:"visible",children:r.children}),!(1&e.mode)&&(r.lanes=n),r.return=e,r.sibling=null,null!==t&&(null===(n=e.deletions)?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Ba(t,e){return(e=Du({mode:"visible",children:e},t.mode,0,null)).return=t,t.child=e}function Ua(t,e,n,i){return null!==i&&mo(i),bo(e,t.child,null,n),(t=Ba(e,e.pendingProps.children)).flags|=2,e.memoizedState=null,t}function za(t,e,n){t.lanes|=e;var i=t.alternate;null!==i&&(i.lanes|=e),Ao(t.return,e,n)}function Xa(t,e,n,i,r){var o=t.memoizedState;null===o?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=i,o.tail=n,o.tailMode=r)}function Ya(t,e,n){var i=e.pendingProps,r=i.revealOrder,o=i.tail;if(xa(t,e,i.children,n),2&(i=ts.current))i=1&i|2,e.flags|=128;else{if(null!==t&&128&t.flags)t:for(t=e.child;null!==t;){if(13===t.tag)null!==t.memoizedState&&za(t,n,e);else if(19===t.tag)za(t,n,e);else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break t;for(;null===t.sibling;){if(null===t.return||t.return===e)break t;t=t.return}t.sibling.return=t.return,t=t.sibling}i&=1}if(Sr(ts,i),1&e.mode)switch(r){case"forwards":for(n=e.child,r=null;null!==n;)null!==(t=n.alternate)&&null===es(t)&&(r=n),n=n.sibling;null===(n=r)?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),Xa(e,!1,r,n,o);break;case"backwards":for(n=null,r=e.child,e.child=null;null!==r;){if(null!==(t=r.alternate)&&null===es(t)){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}Xa(e,!0,n,null,o);break;case"together":Xa(e,!1,null,null,void 0);break;default:e.memoizedState=null}else e.memoizedState=null;return e.child}function Ga(t,e){!(1&e.mode)&&null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Ha(t,e,n){if(null!==t&&(e.dependencies=t.dependencies),Dl|=e.lanes,!(n&e.childLanes))return null;if(null!==t&&e.child!==t.child)throw Error(o(153));if(null!==e.child){for(n=Mu(t=e.child,t.pendingProps),e.child=n,n.return=e;null!==t.sibling;)t=t.sibling,(n=n.sibling=Mu(t,t.pendingProps)).return=e;n.sibling=null}return e.child}function Wa(t,e){if(!ro)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;null!==e;)null!==e.alternate&&(n=e),e=e.sibling;null===n?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var i=null;null!==n;)null!==n.alternate&&(i=n),n=n.sibling;null===i?e||null===t.tail?t.tail=null:t.tail.sibling=null:i.sibling=null}}function ja(t){var e=null!==t.alternate&&t.alternate.child===t.child,n=0,i=0;if(e)for(var r=t.child;null!==r;)n|=r.lanes|r.childLanes,i|=14680064&r.subtreeFlags,i|=14680064&r.flags,r.return=t,r=r.sibling;else for(r=t.child;null!==r;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=i,t.childLanes=n,e}function Va(t,e,n){var i=e.pendingProps;switch(eo(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ja(e),null;case 1:case 17:return Lr(e.type)&&Mr(),ja(e),null;case 3:return i=e.stateNode,Ko(),Tr(Ar),Tr(Ir),is(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),null!==t&&null!==t.child||(co(e)?e.flags|=4:null===t||t.memoizedState.isDehydrated&&!(256&e.flags)||(e.flags|=1024,null!==oo&&(su(oo),oo=null))),La(t,e),ja(e),null;case 5:Jo(e);var r=$o(qo.current);if(n=e.type,null!==t&&null!=e.stateNode)Ma(t,e,n,i,r),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(null===e.stateNode)throw Error(o(166));return ja(e),null}if(t=$o(jo.current),co(e)){i=e.stateNode,n=e.type;var s=e.memoizedProps;switch(i[pr]=e,i[dr]=s,t=!!(1&e.mode),n){case"dialog":Ui("cancel",i),Ui("close",i);break;case"iframe":case"object":case"embed":Ui("load",i);break;case"video":case"audio":for(r=0;r<ki.length;r++)Ui(ki[r],i);break;case"source":Ui("error",i);break;case"img":case"image":case"link":Ui("error",i),Ui("load",i);break;case"details":Ui("toggle",i);break;case"input":Z(i,s),Ui("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!s.multiple},Ui("invalid",i);break;case"textarea":rt(i,s),Ui("invalid",i)}for(var l in vt(n,s),r=null,s)if(s.hasOwnProperty(l)){var u=s[l];"children"===l?"string"==typeof u?i.textContent!==u&&(!0!==s.suppressHydrationWarning&&Qi(i.textContent,u,t),r=["children",u]):"number"==typeof u&&i.textContent!==""+u&&(!0!==s.suppressHydrationWarning&&Qi(i.textContent,u,t),r=["children",""+u]):a.hasOwnProperty(l)&&null!=u&&"onScroll"===l&&Ui("scroll",i)}switch(n){case"input":j(i),J(i,s,!0);break;case"textarea":j(i),st(i);break;case"select":case"option":break;default:"function"==typeof s.onClick&&(i.onclick=Ji)}i=r,e.updateQueue=i,null!==i&&(e.flags|=4)}else{l=9===r.nodeType?r:r.ownerDocument,"http://www.w3.org/1999/xhtml"===t&&(t=at(n)),"http://www.w3.org/1999/xhtml"===t?"script"===n?((t=l.createElement("div")).innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):"string"==typeof i.is?t=l.createElement(n,{is:i.is}):(t=l.createElement(n),"select"===n&&(l=t,i.multiple?l.multiple=!0:i.size&&(l.size=i.size))):t=l.createElementNS(t,n),t[pr]=e,t[dr]=i,Na(t,e,!1,!1),e.stateNode=t;t:{switch(l=_t(n,i),n){case"dialog":Ui("cancel",t),Ui("close",t),r=i;break;case"iframe":case"object":case"embed":Ui("load",t),r=i;break;case"video":case"audio":for(r=0;r<ki.length;r++)Ui(ki[r],t);r=i;break;case"source":Ui("error",t),r=i;break;case"img":case"image":case"link":Ui("error",t),Ui("load",t),r=i;break;case"details":Ui("toggle",t),r=i;break;case"input":Z(t,i),r=$(t,i),Ui("invalid",t);break;case"option":default:r=i;break;case"select":t._wrapperState={wasMultiple:!!i.multiple},r=F({},i,{value:void 0}),Ui("invalid",t);break;case"textarea":rt(t,i),r=it(t,i),Ui("invalid",t)}for(s in vt(n,r),u=r)if(u.hasOwnProperty(s)){var h=u[s];"style"===s?yt(t,h):"dangerouslySetInnerHTML"===s?null!=(h=h?h.__html:void 0)&&ct(t,h):"children"===s?"string"==typeof h?("textarea"!==n||""!==h)&&pt(t,h):"number"==typeof h&&pt(t,""+h):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(a.hasOwnProperty(s)?null!=h&&"onScroll"===s&&Ui("scroll",t):null!=h&&_(t,s,h,l))}switch(n){case"input":j(t),J(t,i,!1);break;case"textarea":j(t),st(t);break;case"option":null!=i.value&&t.setAttribute("value",""+H(i.value));break;case"select":t.multiple=!!i.multiple,null!=(s=i.value)?nt(t,!!i.multiple,s,!1):null!=i.defaultValue&&nt(t,!!i.multiple,i.defaultValue,!0);break;default:"function"==typeof r.onClick&&(t.onclick=Ji)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break t;case"img":i=!0;break t;default:i=!1}}i&&(e.flags|=4)}null!==e.ref&&(e.flags|=512,e.flags|=2097152)}return ja(e),null;case 6:if(t&&null!=e.stateNode)Ra(t,e,t.memoizedProps,i);else{if("string"!=typeof i&&null===e.stateNode)throw Error(o(166));if(n=$o(qo.current),$o(jo.current),co(e)){if(i=e.stateNode,n=e.memoizedProps,i[pr]=e,(s=i.nodeValue!==n)&&null!==(t=no))switch(t.tag){case 3:Qi(i.nodeValue,n,!!(1&t.mode));break;case 5:!0!==t.memoizedProps.suppressHydrationWarning&&Qi(i.nodeValue,n,!!(1&t.mode))}s&&(e.flags|=4)}else(i=(9===n.nodeType?n:n.ownerDocument).createTextNode(i))[pr]=e,e.stateNode=i}return ja(e),null;case 13:if(Tr(ts),i=e.memoizedState,null===t||null!==t.memoizedState&&null!==t.memoizedState.dehydrated){if(ro&&null!==io&&1&e.mode&&!(128&e.flags))po(),fo(),e.flags|=98560,s=!1;else if(s=co(e),null!==i&&null!==i.dehydrated){if(null===t){if(!s)throw Error(o(318));if(!(s=null!==(s=e.memoizedState)?s.dehydrated:null))throw Error(o(317));s[pr]=e}else fo(),!(128&e.flags)&&(e.memoizedState=null),e.flags|=4;ja(e),s=!1}else null!==oo&&(su(oo),oo=null),s=!0;if(!s)return 65536&e.flags?e:null}return 128&e.flags?(e.lanes=n,e):((i=null!==i)!=(null!==t&&null!==t.memoizedState)&&i&&(e.child.flags|=8192,1&e.mode&&(null===t||1&ts.current?0===Rl&&(Rl=3):mu())),null!==e.updateQueue&&(e.flags|=4),ja(e),null);case 4:return Ko(),La(t,e),null===t&&Yi(e.stateNode.containerInfo),ja(e),null;case 10:return Io(e.type._context),ja(e),null;case 19:if(Tr(ts),null===(s=e.memoizedState))return ja(e),null;if(i=!!(128&e.flags),null===(l=s.rendering))if(i)Wa(s,!1);else{if(0!==Rl||null!==t&&128&t.flags)for(t=e.child;null!==t;){if(null!==(l=es(t))){for(e.flags|=128,Wa(s,!1),null!==(i=l.updateQueue)&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=n,n=e.child;null!==n;)t=i,(s=n).flags&=14680066,null===(l=s.alternate)?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,t=l.dependencies,s.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Sr(ts,1&ts.current|2),e.child}t=t.sibling}null!==s.tail&&Kt()>Yl&&(e.flags|=128,i=!0,Wa(s,!1),e.lanes=4194304)}else{if(!i)if(null!==(t=es(l))){if(e.flags|=128,i=!0,null!==(n=t.updateQueue)&&(e.updateQueue=n,e.flags|=4),Wa(s,!0),null===s.tail&&"hidden"===s.tailMode&&!l.alternate&&!ro)return ja(e),null}else 2*Kt()-s.renderingStartTime>Yl&&1073741824!==n&&(e.flags|=128,i=!0,Wa(s,!1),e.lanes=4194304);s.isBackwards?(l.sibling=e.child,e.child=l):(null!==(n=s.last)?n.sibling=l:e.child=l,s.last=l)}return null!==s.tail?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Kt(),e.sibling=null,n=ts.current,Sr(ts,i?1&n|2:1&n),e):(ja(e),null);case 22:case 23:return cu(),i=null!==e.memoizedState,null!==t&&null!==t.memoizedState!==i&&(e.flags|=8192),i&&1&e.mode?!!(1073741824&Ll)&&(ja(e),6&e.subtreeFlags&&(e.flags|=8192)):ja(e),null;case 24:case 25:return null}throw Error(o(156,e.tag))}function qa(t,e){switch(eo(e),e.tag){case 1:return Lr(e.type)&&Mr(),65536&(t=e.flags)?(e.flags=-65537&t|128,e):null;case 3:return Ko(),Tr(Ar),Tr(Ir),is(),65536&(t=e.flags)&&!(128&t)?(e.flags=-65537&t|128,e):null;case 5:return Jo(e),null;case 13:if(Tr(ts),null!==(t=e.memoizedState)&&null!==t.dehydrated){if(null===e.alternate)throw Error(o(340));fo()}return 65536&(t=e.flags)?(e.flags=-65537&t|128,e):null;case 19:return Tr(ts),null;case 4:return Ko(),null;case 10:return Io(e.type._context),null;case 22:case 23:return cu(),null;default:return null}}Na=function(t,e){for(var n=e.child;null!==n;){if(5===n.tag||6===n.tag)t.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},La=function(){},Ma=function(t,e,n,i){var r=t.memoizedProps;if(r!==i){t=e.stateNode,$o(jo.current);var o,s=null;switch(n){case"input":r=$(t,r),i=$(t,i),s=[];break;case"select":r=F({},r,{value:void 0}),i=F({},i,{value:void 0}),s=[];break;case"textarea":r=it(t,r),i=it(t,i),s=[];break;default:"function"!=typeof r.onClick&&"function"==typeof i.onClick&&(t.onclick=Ji)}for(h in vt(n,i),n=null,r)if(!i.hasOwnProperty(h)&&r.hasOwnProperty(h)&&null!=r[h])if("style"===h){var l=r[h];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else"dangerouslySetInnerHTML"!==h&&"children"!==h&&"suppressContentEditableWarning"!==h&&"suppressHydrationWarning"!==h&&"autoFocus"!==h&&(a.hasOwnProperty(h)?s||(s=[]):(s=s||[]).push(h,null));for(h in i){var u=i[h];if(l=null!=r?r[h]:void 0,i.hasOwnProperty(h)&&u!==l&&(null!=u||null!=l))if("style"===h)if(l){for(o in l)!l.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in u)u.hasOwnProperty(o)&&l[o]!==u[o]&&(n||(n={}),n[o]=u[o])}else n||(s||(s=[]),s.push(h,n)),n=u;else"dangerouslySetInnerHTML"===h?(u=u?u.__html:void 0,l=l?l.__html:void 0,null!=u&&l!==u&&(s=s||[]).push(h,u)):"children"===h?"string"!=typeof u&&"number"!=typeof u||(s=s||[]).push(h,""+u):"suppressContentEditableWarning"!==h&&"suppressHydrationWarning"!==h&&(a.hasOwnProperty(h)?(null!=u&&"onScroll"===h&&Ui("scroll",t),s||l===u||(s=[])):(s=s||[]).push(h,u))}n&&(s=s||[]).push("style",n);var h=s;(e.updateQueue=h)&&(e.flags|=4)}},Ra=function(t,e,n,i){n!==i&&(e.flags|=4)};var $a=!1,Za=!1,Ka="function"==typeof WeakSet?WeakSet:Set,Qa=null;function Ja(t,e){var n=t.ref;if(null!==n)if("function"==typeof n)try{n(null)}catch(n){Eu(t,e,n)}else n.current=null}function tl(t,e,n){try{n()}catch(n){Eu(t,e,n)}}var el=!1;function nl(t,e,n){var i=e.updateQueue;if(null!==(i=null!==i?i.lastEffect:null)){var r=i=i.next;do{if((r.tag&t)===t){var o=r.destroy;r.destroy=void 0,void 0!==o&&tl(e,n,o)}r=r.next}while(r!==i)}}function il(t,e){if(null!==(e=null!==(e=e.updateQueue)?e.lastEffect:null)){var n=e=e.next;do{if((n.tag&t)===t){var i=n.create;n.destroy=i()}n=n.next}while(n!==e)}}function rl(t){var e=t.ref;if(null!==e){var n=t.stateNode;t.tag,t=n,"function"==typeof e?e(t):e.current=t}}function ol(t){var e=t.alternate;null!==e&&(t.alternate=null,ol(e)),t.child=null,t.deletions=null,t.sibling=null,5===t.tag&&null!==(e=t.stateNode)&&(delete e[pr],delete e[dr],delete e[mr],delete e[yr],delete e[gr]),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function sl(t){return 5===t.tag||3===t.tag||4===t.tag}function al(t){t:for(;;){for(;null===t.sibling;){if(null===t.return||sl(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;5!==t.tag&&6!==t.tag&&18!==t.tag;){if(2&t.flags)continue t;if(null===t.child||4===t.tag)continue t;t.child.return=t,t=t.child}if(!(2&t.flags))return t.stateNode}}function ll(t,e,n){var i=t.tag;if(5===i||6===i)t=t.stateNode,e?8===n.nodeType?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(8===n.nodeType?(e=n.parentNode).insertBefore(t,n):(e=n).appendChild(t),null!=(n=n._reactRootContainer)||null!==e.onclick||(e.onclick=Ji));else if(4!==i&&null!==(t=t.child))for(ll(t,e,n),t=t.sibling;null!==t;)ll(t,e,n),t=t.sibling}function ul(t,e,n){var i=t.tag;if(5===i||6===i)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(4!==i&&null!==(t=t.child))for(ul(t,e,n),t=t.sibling;null!==t;)ul(t,e,n),t=t.sibling}var hl=null,cl=!1;function pl(t,e,n){for(n=n.child;null!==n;)dl(t,e,n),n=n.sibling}function dl(t,e,n){if(oe&&"function"==typeof oe.onCommitFiberUnmount)try{oe.onCommitFiberUnmount(re,n)}catch(t){}switch(n.tag){case 5:Za||Ja(n,e);case 6:var i=hl,r=cl;hl=null,pl(t,e,n),cl=r,null!==(hl=i)&&(cl?(t=hl,n=n.stateNode,8===t.nodeType?t.parentNode.removeChild(n):t.removeChild(n)):hl.removeChild(n.stateNode));break;case 18:null!==hl&&(cl?(t=hl,n=n.stateNode,8===t.nodeType?lr(t.parentNode,n):1===t.nodeType&&lr(t,n),Ye(t)):lr(hl,n.stateNode));break;case 4:i=hl,r=cl,hl=n.stateNode.containerInfo,cl=!0,pl(t,e,n),hl=i,cl=r;break;case 0:case 11:case 14:case 15:if(!Za&&null!==(i=n.updateQueue)&&null!==(i=i.lastEffect)){r=i=i.next;do{var o=r,s=o.destroy;o=o.tag,void 0!==s&&(2&o||4&o)&&tl(n,e,s),r=r.next}while(r!==i)}pl(t,e,n);break;case 1:if(!Za&&(Ja(n,e),"function"==typeof(i=n.stateNode).componentWillUnmount))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(t){Eu(n,e,t)}pl(t,e,n);break;case 21:pl(t,e,n);break;case 22:1&n.mode?(Za=(i=Za)||null!==n.memoizedState,pl(t,e,n),Za=i):pl(t,e,n);break;default:pl(t,e,n)}}function fl(t){var e=t.updateQueue;if(null!==e){t.updateQueue=null;var n=t.stateNode;null===n&&(n=t.stateNode=new Ka),e.forEach((function(e){var i=Iu.bind(null,t,e);n.has(e)||(n.add(e),e.then(i,i))}))}}function ml(t,e){var n=e.deletions;if(null!==n)for(var i=0;i<n.length;i++){var r=n[i];try{var s=t,a=e,l=a;t:for(;null!==l;){switch(l.tag){case 5:hl=l.stateNode,cl=!1;break t;case 3:case 4:hl=l.stateNode.containerInfo,cl=!0;break t}l=l.return}if(null===hl)throw Error(o(160));dl(s,a,r),hl=null,cl=!1;var u=r.alternate;null!==u&&(u.return=null),r.return=null}catch(t){Eu(r,e,t)}}if(12854&e.subtreeFlags)for(e=e.child;null!==e;)yl(e,t),e=e.sibling}function yl(t,e){var n=t.alternate,i=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(ml(e,t),gl(t),4&i){try{nl(3,t,t.return),il(3,t)}catch(e){Eu(t,t.return,e)}try{nl(5,t,t.return)}catch(e){Eu(t,t.return,e)}}break;case 1:ml(e,t),gl(t),512&i&&null!==n&&Ja(n,n.return);break;case 5:if(ml(e,t),gl(t),512&i&&null!==n&&Ja(n,n.return),32&t.flags){var r=t.stateNode;try{pt(r,"")}catch(e){Eu(t,t.return,e)}}if(4&i&&null!=(r=t.stateNode)){var s=t.memoizedProps,a=null!==n?n.memoizedProps:s,l=t.type,u=t.updateQueue;if(t.updateQueue=null,null!==u)try{"input"===l&&"radio"===s.type&&null!=s.name&&K(r,s),_t(l,a);var h=_t(l,s);for(a=0;a<u.length;a+=2){var c=u[a],p=u[a+1];"style"===c?yt(r,p):"dangerouslySetInnerHTML"===c?ct(r,p):"children"===c?pt(r,p):_(r,c,p,h)}switch(l){case"input":Q(r,s);break;case"textarea":ot(r,s);break;case"select":var d=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!s.multiple;var f=s.value;null!=f?nt(r,!!s.multiple,f,!1):d!==!!s.multiple&&(null!=s.defaultValue?nt(r,!!s.multiple,s.defaultValue,!0):nt(r,!!s.multiple,s.multiple?[]:"",!1))}r[dr]=s}catch(e){Eu(t,t.return,e)}}break;case 6:if(ml(e,t),gl(t),4&i){if(null===t.stateNode)throw Error(o(162));r=t.stateNode,s=t.memoizedProps;try{r.nodeValue=s}catch(e){Eu(t,t.return,e)}}break;case 3:if(ml(e,t),gl(t),4&i&&null!==n&&n.memoizedState.isDehydrated)try{Ye(e.containerInfo)}catch(e){Eu(t,t.return,e)}break;case 4:default:ml(e,t),gl(t);break;case 13:ml(e,t),gl(t),8192&(r=t.child).flags&&(s=null!==r.memoizedState,r.stateNode.isHidden=s,!s||null!==r.alternate&&null!==r.alternate.memoizedState||(Xl=Kt())),4&i&&fl(t);break;case 22:if(c=null!==n&&null!==n.memoizedState,1&t.mode?(Za=(h=Za)||c,ml(e,t),Za=h):ml(e,t),gl(t),8192&i){if(h=null!==t.memoizedState,(t.stateNode.isHidden=h)&&!c&&1&t.mode)for(Qa=t,c=t.child;null!==c;){for(p=Qa=c;null!==Qa;){switch(f=(d=Qa).child,d.tag){case 0:case 11:case 14:case 15:nl(4,d,d.return);break;case 1:Ja(d,d.return);var m=d.stateNode;if("function"==typeof m.componentWillUnmount){i=d,n=d.return;try{e=i,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(t){Eu(i,n,t)}}break;case 5:Ja(d,d.return);break;case 22:if(null!==d.memoizedState){bl(p);continue}}null!==f?(f.return=d,Qa=f):bl(p)}c=c.sibling}t:for(c=null,p=t;;){if(5===p.tag){if(null===c){c=p;try{r=p.stateNode,h?"function"==typeof(s=r.style).setProperty?s.setProperty("display","none","important"):s.display="none":(l=p.stateNode,a=null!=(u=p.memoizedProps.style)&&u.hasOwnProperty("display")?u.display:null,l.style.display=mt("display",a))}catch(e){Eu(t,t.return,e)}}}else if(6===p.tag){if(null===c)try{p.stateNode.nodeValue=h?"":p.memoizedProps}catch(e){Eu(t,t.return,e)}}else if((22!==p.tag&&23!==p.tag||null===p.memoizedState||p===t)&&null!==p.child){p.child.return=p,p=p.child;continue}if(p===t)break t;for(;null===p.sibling;){if(null===p.return||p.return===t)break t;c===p&&(c=null),p=p.return}c===p&&(c=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:ml(e,t),gl(t),4&i&&fl(t);case 21:}}function gl(t){var e=t.flags;if(2&e){try{t:{for(var n=t.return;null!==n;){if(sl(n)){var i=n;break t}n=n.return}throw Error(o(160))}switch(i.tag){case 5:var r=i.stateNode;32&i.flags&&(pt(r,""),i.flags&=-33),ul(t,al(t),r);break;case 3:case 4:var s=i.stateNode.containerInfo;ll(t,al(t),s);break;default:throw Error(o(161))}}catch(e){Eu(t,t.return,e)}t.flags&=-3}4096&e&&(t.flags&=-4097)}function vl(t,e,n){Qa=t,_l(t,e,n)}function _l(t,e,n){for(var i=!!(1&t.mode);null!==Qa;){var r=Qa,o=r.child;if(22===r.tag&&i){var s=null!==r.memoizedState||$a;if(!s){var a=r.alternate,l=null!==a&&null!==a.memoizedState||Za;a=$a;var u=Za;if($a=s,(Za=l)&&!u)for(Qa=r;null!==Qa;)l=(s=Qa).child,22===s.tag&&null!==s.memoizedState?wl(r):null!==l?(l.return=s,Qa=l):wl(r);for(;null!==o;)Qa=o,_l(o,e,n),o=o.sibling;Qa=r,$a=a,Za=u}xl(t)}else 8772&r.subtreeFlags&&null!==o?(o.return=r,Qa=o):xl(t)}}function xl(t){for(;null!==Qa;){var e=Qa;if(8772&e.flags){var n=e.alternate;try{if(8772&e.flags)switch(e.tag){case 0:case 11:case 15:Za||il(5,e);break;case 1:var i=e.stateNode;if(4&e.flags&&!Za)if(null===n)i.componentDidMount();else{var r=e.elementType===e.type?n.memoizedProps:na(e.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;null!==s&&Ho(e,s,i);break;case 3:var a=e.updateQueue;if(null!==a){if(n=null,null!==e.child)switch(e.child.tag){case 5:case 1:n=e.child.stateNode}Ho(e,a,n)}break;case 5:var l=e.stateNode;if(null===n&&4&e.flags){n=l;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===e.memoizedState){var h=e.alternate;if(null!==h){var c=h.memoizedState;if(null!==c){var p=c.dehydrated;null!==p&&Ye(p)}}}break;default:throw Error(o(163))}Za||512&e.flags&&rl(e)}catch(t){Eu(e,e.return,t)}}if(e===t){Qa=null;break}if(null!==(n=e.sibling)){n.return=e.return,Qa=n;break}Qa=e.return}}function bl(t){for(;null!==Qa;){var e=Qa;if(e===t){Qa=null;break}var n=e.sibling;if(null!==n){n.return=e.return,Qa=n;break}Qa=e.return}}function wl(t){for(;null!==Qa;){var e=Qa;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{il(4,e)}catch(t){Eu(e,n,t)}break;case 1:var i=e.stateNode;if("function"==typeof i.componentDidMount){var r=e.return;try{i.componentDidMount()}catch(t){Eu(e,r,t)}}var o=e.return;try{rl(e)}catch(t){Eu(e,o,t)}break;case 5:var s=e.return;try{rl(e)}catch(t){Eu(e,s,t)}}}catch(t){Eu(e,e.return,t)}if(e===t){Qa=null;break}var a=e.sibling;if(null!==a){a.return=e.return,Qa=a;break}Qa=e.return}}var Pl,El=Math.ceil,Tl=x.ReactCurrentDispatcher,Sl=x.ReactCurrentOwner,Cl=x.ReactCurrentBatchConfig,Il=0,Al=null,Ol=null,Nl=0,Ll=0,Ml=Er(0),Rl=0,kl=null,Dl=0,Fl=0,Bl=0,Ul=null,zl=null,Xl=0,Yl=1/0,Gl=null,Hl=!1,Wl=null,jl=null,Vl=!1,ql=null,$l=0,Zl=0,Kl=null,Ql=-1,Jl=0;function tu(){return 6&Il?Kt():-1!==Ql?Ql:Ql=Kt()}function eu(t){return 1&t.mode?2&Il&&0!==Nl?Nl&-Nl:null!==yo.transition?(0===Jl&&(Jl=me()),Jl):0!==(t=_e)?t:t=void 0===(t=window.event)?16:Ze(t.type):1}function nu(t,e,n,i){if(50<Zl)throw Zl=0,Kl=null,Error(o(185));ge(t,n,i),2&Il&&t===Al||(t===Al&&(!(2&Il)&&(Fl|=n),4===Rl&&au(t,Nl)),iu(t,i),1===n&&0===Il&&!(1&e.mode)&&(Yl=Kt()+500,Ur&&Yr()))}function iu(t,e){var n=t.callbackNode;!function(t,e){for(var n=t.suspendedLanes,i=t.pingedLanes,r=t.expirationTimes,o=t.pendingLanes;0<o;){var s=31-se(o),a=1<<s,l=r[s];-1===l?a&n&&!(a&i)||(r[s]=de(a,e)):l<=e&&(t.expiredLanes|=a),o&=~a}}(t,e);var i=pe(t,t===Al?Nl:0);if(0===i)null!==n&&qt(n),t.callbackNode=null,t.callbackPriority=0;else if(e=i&-i,t.callbackPriority!==e){if(null!=n&&qt(n),1===e)0===t.tag?function(t){Ur=!0,Xr(t)}(lu.bind(null,t)):Xr(lu.bind(null,t)),sr((function(){!(6&Il)&&Yr()})),n=null;else{switch(xe(i)){case 1:n=Jt;break;case 4:n=te;break;case 16:default:n=ee;break;case 536870912:n=ie}n=Au(n,ru.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function ru(t,e){if(Ql=-1,Jl=0,6&Il)throw Error(o(327));var n=t.callbackNode;if(wu()&&t.callbackNode!==n)return null;var i=pe(t,t===Al?Nl:0);if(0===i)return null;if(30&i||i&t.expiredLanes||e)e=yu(t,i);else{e=i;var r=Il;Il|=2;var s=fu();for(Al===t&&Nl===e||(Gl=null,Yl=Kt()+500,pu(t,e));;)try{vu();break}catch(e){du(t,e)}Co(),Tl.current=s,Il=r,null!==Ol?e=0:(Al=null,Nl=0,e=Rl)}if(0!==e){if(2===e&&0!==(r=fe(t))&&(i=r,e=ou(t,r)),1===e)throw n=kl,pu(t,0),au(t,i),iu(t,Kt()),n;if(6===e)au(t,i);else{if(r=t.current.alternate,!(30&i||function(t){for(var e=t;;){if(16384&e.flags){var n=e.updateQueue;if(null!==n&&null!==(n=n.stores))for(var i=0;i<n.length;i++){var r=n[i],o=r.getSnapshot;r=r.value;try{if(!ai(o(),r))return!1}catch(t){return!1}}}if(n=e.child,16384&e.subtreeFlags&&null!==n)n.return=e,e=n;else{if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}(r)||(e=yu(t,i),2===e&&(s=fe(t),0!==s&&(i=s,e=ou(t,s))),1!==e)))throw n=kl,pu(t,0),au(t,i),iu(t,Kt()),n;switch(t.finishedWork=r,t.finishedLanes=i,e){case 0:case 1:throw Error(o(345));case 2:case 5:bu(t,zl,Gl);break;case 3:if(au(t,i),(130023424&i)===i&&10<(e=Xl+500-Kt())){if(0!==pe(t,0))break;if(((r=t.suspendedLanes)&i)!==i){tu(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=ir(bu.bind(null,t,zl,Gl),e);break}bu(t,zl,Gl);break;case 4:if(au(t,i),(4194240&i)===i)break;for(e=t.eventTimes,r=-1;0<i;){var a=31-se(i);s=1<<a,(a=e[a])>r&&(r=a),i&=~s}if(i=r,10<(i=(120>(i=Kt()-i)?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*El(i/1960))-i)){t.timeoutHandle=ir(bu.bind(null,t,zl,Gl),i);break}bu(t,zl,Gl);break;default:throw Error(o(329))}}}return iu(t,Kt()),t.callbackNode===n?ru.bind(null,t):null}function ou(t,e){var n=Ul;return t.current.memoizedState.isDehydrated&&(pu(t,e).flags|=256),2!==(t=yu(t,e))&&(e=zl,zl=n,null!==e&&su(e)),t}function su(t){null===zl?zl=t:zl.push.apply(zl,t)}function au(t,e){for(e&=~Bl,e&=~Fl,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-se(e),i=1<<n;t[n]=-1,e&=~i}}function lu(t){if(6&Il)throw Error(o(327));wu();var e=pe(t,0);if(!(1&e))return iu(t,Kt()),null;var n=yu(t,e);if(0!==t.tag&&2===n){var i=fe(t);0!==i&&(e=i,n=ou(t,i))}if(1===n)throw n=kl,pu(t,0),au(t,e),iu(t,Kt()),n;if(6===n)throw Error(o(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,bu(t,zl,Gl),iu(t,Kt()),null}function uu(t,e){var n=Il;Il|=1;try{return t(e)}finally{0===(Il=n)&&(Yl=Kt()+500,Ur&&Yr())}}function hu(t){null!==ql&&0===ql.tag&&!(6&Il)&&wu();var e=Il;Il|=1;var n=Cl.transition,i=_e;try{if(Cl.transition=null,_e=1,t)return t()}finally{_e=i,Cl.transition=n,!(6&(Il=e))&&Yr()}}function cu(){Ll=Ml.current,Tr(Ml)}function pu(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(-1!==n&&(t.timeoutHandle=-1,rr(n)),null!==Ol)for(n=Ol.return;null!==n;){var i=n;switch(eo(i),i.tag){case 1:null!=(i=i.type.childContextTypes)&&Mr();break;case 3:Ko(),Tr(Ar),Tr(Ir),is();break;case 5:Jo(i);break;case 4:Ko();break;case 13:case 19:Tr(ts);break;case 10:Io(i.type._context);break;case 22:case 23:cu()}n=n.return}if(Al=t,Ol=t=Mu(t.current,null),Nl=Ll=e,Rl=0,kl=null,Bl=Fl=Dl=0,zl=Ul=null,null!==Lo){for(e=0;e<Lo.length;e++)if(null!==(i=(n=Lo[e]).interleaved)){n.interleaved=null;var r=i.next,o=n.pending;if(null!==o){var s=o.next;o.next=r,i.next=s}n.pending=i}Lo=null}return t}function du(t,e){for(;;){var n=Ol;try{if(Co(),rs.current=Qs,hs){for(var i=as.memoizedState;null!==i;){var r=i.queue;null!==r&&(r.pending=null),i=i.next}hs=!1}if(ss=0,us=ls=as=null,cs=!1,ps=0,Sl.current=null,null===n||null===n.return){Rl=1,kl=e,Ol=null;break}t:{var s=t,a=n.return,l=n,u=e;if(e=Nl,l.flags|=32768,null!==u&&"object"==typeof u&&"function"==typeof u.then){var h=u,c=l,p=c.tag;if(!(1&c.mode||0!==p&&11!==p&&15!==p)){var d=c.alternate;d?(c.updateQueue=d.updateQueue,c.memoizedState=d.memoizedState,c.lanes=d.lanes):(c.updateQueue=null,c.memoizedState=null)}var f=ya(a);if(null!==f){f.flags&=-257,ga(f,a,l,0,e),1&f.mode&&ma(s,h,e),u=h;var m=(e=f).updateQueue;if(null===m){var y=new Set;y.add(u),e.updateQueue=y}else m.add(u);break t}if(!(1&e)){ma(s,h,e),mu();break t}u=Error(o(426))}else if(ro&&1&l.mode){var g=ya(a);if(null!==g){!(65536&g.flags)&&(g.flags|=256),ga(g,a,l,0,e),mo(ua(u,l));break t}}s=u=ua(u,l),4!==Rl&&(Rl=2),null===Ul?Ul=[s]:Ul.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e,Yo(s,da(0,u,e));break t;case 1:l=u;var v=s.type,_=s.stateNode;if(!(128&s.flags||"function"!=typeof v.getDerivedStateFromError&&(null===_||"function"!=typeof _.componentDidCatch||null!==jl&&jl.has(_)))){s.flags|=65536,e&=-e,s.lanes|=e,Yo(s,fa(s,l,e));break t}}s=s.return}while(null!==s)}xu(n)}catch(t){e=t,Ol===n&&null!==n&&(Ol=n=n.return);continue}break}}function fu(){var t=Tl.current;return Tl.current=Qs,null===t?Qs:t}function mu(){0!==Rl&&3!==Rl&&2!==Rl||(Rl=4),null===Al||!(268435455&Dl)&&!(268435455&Fl)||au(Al,Nl)}function yu(t,e){var n=Il;Il|=2;var i=fu();for(Al===t&&Nl===e||(Gl=null,pu(t,e));;)try{gu();break}catch(e){du(t,e)}if(Co(),Il=n,Tl.current=i,null!==Ol)throw Error(o(261));return Al=null,Nl=0,Rl}function gu(){for(;null!==Ol;)_u(Ol)}function vu(){for(;null!==Ol&&!$t();)_u(Ol)}function _u(t){var e=Pl(t.alternate,t,Ll);t.memoizedProps=t.pendingProps,null===e?xu(t):Ol=e,Sl.current=null}function xu(t){var e=t;do{var n=e.alternate;if(t=e.return,32768&e.flags){if(null!==(n=qa(n,e)))return n.flags&=32767,void(Ol=n);if(null===t)return Rl=6,void(Ol=null);t.flags|=32768,t.subtreeFlags=0,t.deletions=null}else if(null!==(n=Va(n,e,Ll)))return void(Ol=n);if(null!==(e=e.sibling))return void(Ol=e);Ol=e=t}while(null!==e);0===Rl&&(Rl=5)}function bu(t,e,n){var i=_e,r=Cl.transition;try{Cl.transition=null,_e=1,function(t,e,n,i){do{wu()}while(null!==ql);if(6&Il)throw Error(o(327));n=t.finishedWork;var r=t.finishedLanes;if(null===n)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(o(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(function(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var i=t.eventTimes;for(t=t.expirationTimes;0<n;){var r=31-se(n),o=1<<r;e[r]=0,i[r]=-1,t[r]=-1,n&=~o}}(t,s),t===Al&&(Ol=Al=null,Nl=0),!(2064&n.subtreeFlags)&&!(2064&n.flags)||Vl||(Vl=!0,Au(ee,(function(){return wu(),null}))),s=!!(15990&n.flags),15990&n.subtreeFlags||s){s=Cl.transition,Cl.transition=null;var a=_e;_e=1;var l=Il;Il|=4,Sl.current=null,function(t,e){if(tr=He,di(t=pi())){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else t:{var i=(n=(n=t.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(i&&0!==i.rangeCount){n=i.anchorNode;var r=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{n.nodeType,s.nodeType}catch(t){n=null;break t}var a=0,l=-1,u=-1,h=0,c=0,p=t,d=null;e:for(;;){for(var f;p!==n||0!==r&&3!==p.nodeType||(l=a+r),p!==s||0!==i&&3!==p.nodeType||(u=a+i),3===p.nodeType&&(a+=p.nodeValue.length),null!==(f=p.firstChild);)d=p,p=f;for(;;){if(p===t)break e;if(d===n&&++h===r&&(l=a),d===s&&++c===i&&(u=a),null!==(f=p.nextSibling))break;d=(p=d).parentNode}p=f}n=-1===l||-1===u?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(er={focusedElem:t,selectionRange:n},He=!1,Qa=e;null!==Qa;)if(t=(e=Qa).child,1028&e.subtreeFlags&&null!==t)t.return=e,Qa=t;else for(;null!==Qa;){e=Qa;try{var m=e.alternate;if(1024&e.flags)switch(e.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var y=m.memoizedProps,g=m.memoizedState,v=e.stateNode,_=v.getSnapshotBeforeUpdate(e.elementType===e.type?y:na(e.type,y),g);v.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var x=e.stateNode.containerInfo;1===x.nodeType?x.textContent="":9===x.nodeType&&x.documentElement&&x.removeChild(x.documentElement);break;default:throw Error(o(163))}}catch(t){Eu(e,e.return,t)}if(null!==(t=e.sibling)){t.return=e.return,Qa=t;break}Qa=e.return}m=el,el=!1}(t,n),yl(n,t),fi(er),He=!!tr,er=tr=null,t.current=n,vl(n,t,r),Zt(),Il=l,_e=a,Cl.transition=s}else t.current=n;if(Vl&&(Vl=!1,ql=t,$l=r),0===(s=t.pendingLanes)&&(jl=null),function(t){if(oe&&"function"==typeof oe.onCommitFiberRoot)try{oe.onCommitFiberRoot(re,t,void 0,!(128&~t.current.flags))}catch(t){}}(n.stateNode),iu(t,Kt()),null!==e)for(i=t.onRecoverableError,n=0;n<e.length;n++)i((r=e[n]).value,{componentStack:r.stack,digest:r.digest});if(Hl)throw Hl=!1,t=Wl,Wl=null,t;!!(1&$l)&&0!==t.tag&&wu(),1&(s=t.pendingLanes)?t===Kl?Zl++:(Zl=0,Kl=t):Zl=0,Yr()}(t,e,n,i)}finally{Cl.transition=r,_e=i}return null}function wu(){if(null!==ql){var t=xe($l),e=Cl.transition,n=_e;try{if(Cl.transition=null,_e=16>t?16:t,null===ql)var i=!1;else{if(t=ql,ql=null,$l=0,6&Il)throw Error(o(331));var r=Il;for(Il|=4,Qa=t.current;null!==Qa;){var s=Qa,a=s.child;if(16&Qa.flags){var l=s.deletions;if(null!==l){for(var u=0;u<l.length;u++){var h=l[u];for(Qa=h;null!==Qa;){var c=Qa;switch(c.tag){case 0:case 11:case 15:nl(8,c,s)}var p=c.child;if(null!==p)p.return=c,Qa=p;else for(;null!==Qa;){var d=(c=Qa).sibling,f=c.return;if(ol(c),c===h){Qa=null;break}if(null!==d){d.return=f,Qa=d;break}Qa=f}}}var m=s.alternate;if(null!==m){var y=m.child;if(null!==y){m.child=null;do{var g=y.sibling;y.sibling=null,y=g}while(null!==y)}}Qa=s}}if(2064&s.subtreeFlags&&null!==a)a.return=s,Qa=a;else t:for(;null!==Qa;){if(2048&(s=Qa).flags)switch(s.tag){case 0:case 11:case 15:nl(9,s,s.return)}var v=s.sibling;if(null!==v){v.return=s.return,Qa=v;break t}Qa=s.return}}var _=t.current;for(Qa=_;null!==Qa;){var x=(a=Qa).child;if(2064&a.subtreeFlags&&null!==x)x.return=a,Qa=x;else t:for(a=_;null!==Qa;){if(2048&(l=Qa).flags)try{switch(l.tag){case 0:case 11:case 15:il(9,l)}}catch(t){Eu(l,l.return,t)}if(l===a){Qa=null;break t}var b=l.sibling;if(null!==b){b.return=l.return,Qa=b;break t}Qa=l.return}}if(Il=r,Yr(),oe&&"function"==typeof oe.onPostCommitFiberRoot)try{oe.onPostCommitFiberRoot(re,t)}catch(t){}i=!0}return i}finally{_e=n,Cl.transition=e}}return!1}function Pu(t,e,n){t=zo(t,e=da(0,e=ua(n,e),1),1),e=tu(),null!==t&&(ge(t,1,e),iu(t,e))}function Eu(t,e,n){if(3===t.tag)Pu(t,t,n);else for(;null!==e;){if(3===e.tag){Pu(e,t,n);break}if(1===e.tag){var i=e.stateNode;if("function"==typeof e.type.getDerivedStateFromError||"function"==typeof i.componentDidCatch&&(null===jl||!jl.has(i))){e=zo(e,t=fa(e,t=ua(n,t),1),1),t=tu(),null!==e&&(ge(e,1,t),iu(e,t));break}}e=e.return}}function Tu(t,e,n){var i=t.pingCache;null!==i&&i.delete(e),e=tu(),t.pingedLanes|=t.suspendedLanes&n,Al===t&&(Nl&n)===n&&(4===Rl||3===Rl&&(130023424&Nl)===Nl&&500>Kt()-Xl?pu(t,0):Bl|=n),iu(t,e)}function Su(t,e){0===e&&(1&t.mode?(e=he,!(130023424&(he<<=1))&&(he=4194304)):e=1);var n=tu();null!==(t=ko(t,e))&&(ge(t,e,n),iu(t,n))}function Cu(t){var e=t.memoizedState,n=0;null!==e&&(n=e.retryLane),Su(t,n)}function Iu(t,e){var n=0;switch(t.tag){case 13:var i=t.stateNode,r=t.memoizedState;null!==r&&(n=r.retryLane);break;case 19:i=t.stateNode;break;default:throw Error(o(314))}null!==i&&i.delete(e),Su(t,n)}function Au(t,e){return Vt(t,e)}function Ou(t,e,n,i){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Nu(t,e,n,i){return new Ou(t,e,n,i)}function Lu(t){return!(!(t=t.prototype)||!t.isReactComponent)}function Mu(t,e){var n=t.alternate;return null===n?((n=Nu(t.tag,e,t.key,t.mode)).elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&t.flags,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Ru(t,e,n,i,r,s){var a=2;if(i=t,"function"==typeof t)Lu(t)&&(a=1);else if("string"==typeof t)a=5;else t:switch(t){case P:return ku(n.children,r,s,e);case E:a=8,r|=8;break;case T:return(t=Nu(12,n,e,2|r)).elementType=T,t.lanes=s,t;case A:return(t=Nu(13,n,e,r)).elementType=A,t.lanes=s,t;case O:return(t=Nu(19,n,e,r)).elementType=O,t.lanes=s,t;case M:return Du(n,r,s,e);default:if("object"==typeof t&&null!==t)switch(t.$$typeof){case S:a=10;break t;case C:a=9;break t;case I:a=11;break t;case N:a=14;break t;case L:a=16,i=null;break t}throw Error(o(130,null==t?t:typeof t,""))}return(e=Nu(a,n,e,r)).elementType=t,e.type=i,e.lanes=s,e}function ku(t,e,n,i){return(t=Nu(7,t,i,e)).lanes=n,t}function Du(t,e,n,i){return(t=Nu(22,t,i,e)).elementType=M,t.lanes=n,t.stateNode={isHidden:!1},t}function Fu(t,e,n){return(t=Nu(6,t,null,e)).lanes=n,t}function Bu(t,e,n){return(e=Nu(4,null!==t.children?t.children:[],t.key,e)).lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Uu(t,e,n,i,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ye(0),this.expirationTimes=ye(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ye(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function zu(t,e,n,i,r,o,s,a,l){return t=new Uu(t,e,n,a,l),1===e?(e=1,!0===o&&(e|=8)):e=0,o=Nu(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Fo(o),t}function Xu(t){if(!t)return Cr;t:{if(Yt(t=t._reactInternals)!==t||1!==t.tag)throw Error(o(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break t;case 1:if(Lr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break t}}e=e.return}while(null!==e);throw Error(o(171))}if(1===t.tag){var n=t.type;if(Lr(n))return kr(t,n,e)}return e}function Yu(t,e,n,i){var r=e.current,o=tu(),s=eu(r);return n=Xu(n),null===e.context?e.context=n:e.pendingContext=n,(e=Uo(o,s)).payload={element:t},null!==(i=void 0===i?null:i)&&(e.callback=i),null!==(t=zo(r,e,s))&&(nu(t,r,s,o),Xo(t,r,s)),s}function Gu(t){return(t=t.current).child?(t.child.tag,t.child.stateNode):null}function Hu(t,e){if(null!==(t=t.memoizedState)&&null!==t.dehydrated){var n=t.retryLane;t.retryLane=0!==n&&n<e?n:e}}function Wu(t,e){Hu(t,e),(t=t.alternate)&&Hu(t,e)}Pl=function(t,e,n){if(null!==t)if(t.memoizedProps!==e.pendingProps||Ar.current)_a=!0;else{if(!(t.lanes&n||128&e.flags))return _a=!1,function(t,e,n){switch(e.tag){case 3:Aa(e),fo();break;case 5:Qo(e);break;case 1:Lr(e.type)&&Dr(e);break;case 4:Zo(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,r=e.memoizedProps.value;Sr(Po,i._currentValue),i._currentValue=r;break;case 13:if(null!==(i=e.memoizedState))return null!==i.dehydrated?(Sr(ts,1&ts.current),e.flags|=128,null):n&e.child.childLanes?Fa(t,e,n):(Sr(ts,1&ts.current),null!==(t=Ha(t,e,n))?t.sibling:null);Sr(ts,1&ts.current);break;case 19:if(i=!!(n&e.childLanes),128&t.flags){if(i)return Ya(t,e,n);e.flags|=128}if(null!==(r=e.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),Sr(ts,ts.current),i)break;return null;case 22:case 23:return e.lanes=0,Ea(t,e,n)}return Ha(t,e,n)}(t,e,n);_a=!!(131072&t.flags)}else _a=!1,ro&&1048576&e.flags&&Jr(e,jr,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;Ga(t,e),t=e.pendingProps;var r=Nr(e,Ir.current);Oo(e,n),r=ys(null,e,i,t,r,n);var s=gs();return e.flags|=1,"object"==typeof r&&null!==r&&"function"==typeof r.render&&void 0===r.$$typeof?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Lr(i)?(s=!0,Dr(e)):s=!1,e.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,Fo(e),r.updater=ra,e.stateNode=r,r._reactInternals=e,la(e,i,t,n),e=Ia(null,e,i,!0,s,n)):(e.tag=0,ro&&s&&to(e),xa(null,e,r,n),e=e.child),e;case 16:i=e.elementType;t:{switch(Ga(t,e),t=e.pendingProps,i=(r=i._init)(i._payload),e.type=i,r=e.tag=function(t){if("function"==typeof t)return Lu(t)?1:0;if(null!=t){if((t=t.$$typeof)===I)return 11;if(t===N)return 14}return 2}(i),t=na(i,t),r){case 0:e=Sa(null,e,i,t,n);break t;case 1:e=Ca(null,e,i,t,n);break t;case 11:e=ba(null,e,i,t,n);break t;case 14:e=wa(null,e,i,na(i.type,t),n);break t}throw Error(o(306,i,""))}return e;case 0:return i=e.type,r=e.pendingProps,Sa(t,e,i,r=e.elementType===i?r:na(i,r),n);case 1:return i=e.type,r=e.pendingProps,Ca(t,e,i,r=e.elementType===i?r:na(i,r),n);case 3:t:{if(Aa(e),null===t)throw Error(o(387));i=e.pendingProps,r=(s=e.memoizedState).element,Bo(t,e),Go(e,i,null,n);var a=e.memoizedState;if(i=a.element,s.isDehydrated){if(s={element:i,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=s,e.memoizedState=s,256&e.flags){e=Oa(t,e,i,n,r=ua(Error(o(423)),e));break t}if(i!==r){e=Oa(t,e,i,n,r=ua(Error(o(424)),e));break t}for(io=ur(e.stateNode.containerInfo.firstChild),no=e,ro=!0,oo=null,n=wo(e,null,i,n),e.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fo(),i===r){e=Ha(t,e,n);break t}xa(t,e,i,n)}e=e.child}return e;case 5:return Qo(e),null===t&&uo(e),i=e.type,r=e.pendingProps,s=null!==t?t.memoizedProps:null,a=r.children,nr(i,r)?a=null:null!==s&&nr(i,s)&&(e.flags|=32),Ta(t,e),xa(t,e,a,n),e.child;case 6:return null===t&&uo(e),null;case 13:return Fa(t,e,n);case 4:return Zo(e,e.stateNode.containerInfo),i=e.pendingProps,null===t?e.child=bo(e,null,i,n):xa(t,e,i,n),e.child;case 11:return i=e.type,r=e.pendingProps,ba(t,e,i,r=e.elementType===i?r:na(i,r),n);case 7:return xa(t,e,e.pendingProps,n),e.child;case 8:case 12:return xa(t,e,e.pendingProps.children,n),e.child;case 10:t:{if(i=e.type._context,r=e.pendingProps,s=e.memoizedProps,a=r.value,Sr(Po,i._currentValue),i._currentValue=a,null!==s)if(ai(s.value,a)){if(s.children===r.children&&!Ar.current){e=Ha(t,e,n);break t}}else for(null!==(s=e.child)&&(s.return=e);null!==s;){var l=s.dependencies;if(null!==l){a=s.child;for(var u=l.firstContext;null!==u;){if(u.context===i){if(1===s.tag){(u=Uo(-1,n&-n)).tag=2;var h=s.updateQueue;if(null!==h){var c=(h=h.shared).pending;null===c?u.next=u:(u.next=c.next,c.next=u),h.pending=u}}s.lanes|=n,null!==(u=s.alternate)&&(u.lanes|=n),Ao(s.return,n,e),l.lanes|=n;break}u=u.next}}else if(10===s.tag)a=s.type===e.type?null:s.child;else if(18===s.tag){if(null===(a=s.return))throw Error(o(341));a.lanes|=n,null!==(l=a.alternate)&&(l.lanes|=n),Ao(a,n,e),a=s.sibling}else a=s.child;if(null!==a)a.return=s;else for(a=s;null!==a;){if(a===e){a=null;break}if(null!==(s=a.sibling)){s.return=a.return,a=s;break}a=a.return}s=a}xa(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,i=e.pendingProps.children,Oo(e,n),i=i(r=No(r)),e.flags|=1,xa(t,e,i,n),e.child;case 14:return r=na(i=e.type,e.pendingProps),wa(t,e,i,r=na(i.type,r),n);case 15:return Pa(t,e,e.type,e.pendingProps,n);case 17:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:na(i,r),Ga(t,e),e.tag=1,Lr(i)?(t=!0,Dr(e)):t=!1,Oo(e,n),sa(e,i,r),la(e,i,r,n),Ia(null,e,i,!0,t,n);case 19:return Ya(t,e,n);case 22:return Ea(t,e,n)}throw Error(o(156,e.tag))};"function"==typeof reportError&&reportError;function ju(t){this._internalRoot=t}function Vu(t){this._internalRoot=t}function qu(){}function $u(t,e,n,i,r){var o=n._reactRootContainer;if(o){var s=o;if("function"==typeof r){var a=r;r=function(){var t=Gu(s);a.call(t)}}Yu(e,s,t,r)}else s=function(t,e,n,i,r){if(r){if("function"==typeof i){var o=i;i=function(){var t=Gu(s);o.call(t)}}var s=function(t,e,n,i,r,o,s,a,l){return(t=zu(n,i,!0,t,0,o,0,a,l)).context=Xu(null),n=t.current,(o=Uo(i=tu(),r=eu(n))).callback=null!=e?e:null,zo(n,o,r),t.current.lanes=r,ge(t,r,i),iu(t,i),t}(e,i,t,0,null,!1,0,"",qu);return t._reactRootContainer=s,t[fr]=s.current,Yi(8===t.nodeType?t.parentNode:t),hu(),s}for(;r=t.lastChild;)t.removeChild(r);if("function"==typeof i){var a=i;i=function(){var t=Gu(l);a.call(t)}}var l=zu(t,0,!1,null,0,!1,0,"",qu);return t._reactRootContainer=l,t[fr]=l.current,Yi(8===t.nodeType?t.parentNode:t),hu((function(){Yu(e,l,n,i)})),l}(n,e,t,r,i);return Gu(s)}Vu.prototype.render=ju.prototype.render=function(t){var e=this._internalRoot;if(null===e)throw Error(o(409));Yu(t,e,null,null)},Vu.prototype.unmount=ju.prototype.unmount=function(){var t=this._internalRoot;if(null!==t){this._internalRoot=null;var e=t.containerInfo;hu((function(){Yu(null,t,null,null)})),e[fr]=null}},Vu.prototype.unstable_scheduleHydration=function(t){if(t){var e=Ee();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Me.length&&0!==e&&e<Me[n].priority;n++);Me.splice(n,0,t),0===n&&Fe(t)}},be=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=ce(e.pendingLanes);0!==n&&(ve(e,1|n),iu(e,Kt()),!(6&Il)&&(Yl=Kt()+500,Yr()))}break;case 13:hu((function(){var e=ko(t,1);if(null!==e){var n=tu();nu(e,t,1,n)}})),Wu(t,1)}},we=function(t){if(13===t.tag){var e=ko(t,134217728);null!==e&&nu(e,t,134217728,tu()),Wu(t,134217728)}},Pe=function(t){if(13===t.tag){var e=eu(t),n=ko(t,e);null!==n&&nu(n,t,e,tu()),Wu(t,e)}},Ee=function(){return _e},Te=function(t,e){var n=_e;try{return _e=t,e()}finally{_e=n}},wt=function(t,e,n){switch(e){case"input":if(Q(t,n),e=n.name,"radio"===n.type&&null!=e){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var i=n[e];if(i!==t&&i.form===t.form){var r=br(i);if(!r)throw Error(o(90));V(i),Q(i,r)}}}break;case"textarea":ot(t,n);break;case"select":null!=(e=n.value)&&nt(t,!!n.multiple,e,!1)}},It=uu,At=hu;var Zu={findFiberByHostInstance:vr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Ku={bundleType:Zu.bundleType,version:Zu.version,rendererPackageName:Zu.rendererPackageName,rendererConfig:Zu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:x.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return null===(t=Wt(t))?null:t.stateNode},findFiberByHostInstance:Zu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var Qu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Qu.isDisabled&&Qu.supportsFiber)try{re=Qu.inject(Ku),oe=Qu}catch(ht){}}e.render=function(t,e,n){if(!function(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType&&(8!==t.nodeType||" react-mount-point-unstable "!==t.nodeValue))}(e))throw Error(o(200));return $u(null,t,e,!1,n)}},961:(t,e,n)=>{"use strict";!function t(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(t){console.error(t)}}(),t.exports=n(551)},287:(t,e)=>{"use strict";var n=Symbol.for("react.element"),i=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),d=Symbol.iterator,f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,y={};function g(t,e,n){this.props=t,this.context=e,this.refs=y,this.updater=n||f}function v(){}function _(t,e,n){this.props=t,this.context=e,this.refs=y,this.updater=n||f}g.prototype.isReactComponent={},g.prototype.setState=function(t,e){if("object"!=typeof t&&"function"!=typeof t&&null!=t)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")},g.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},v.prototype=g.prototype;var x=_.prototype=new v;x.constructor=_,m(x,g.prototype),x.isPureReactComponent=!0;var b=Array.isArray,w=Object.prototype.hasOwnProperty,P={current:null},E={key:!0,ref:!0,__self:!0,__source:!0};function T(t,e,i){var r,o={},s=null,a=null;if(null!=e)for(r in void 0!==e.ref&&(a=e.ref),void 0!==e.key&&(s=""+e.key),e)w.call(e,r)&&!E.hasOwnProperty(r)&&(o[r]=e[r]);var l=arguments.length-2;if(1===l)o.children=i;else if(1<l){for(var u=Array(l),h=0;h<l;h++)u[h]=arguments[h+2];o.children=u}if(t&&t.defaultProps)for(r in l=t.defaultProps)void 0===o[r]&&(o[r]=l[r]);return{$$typeof:n,type:t,key:s,ref:a,props:o,_owner:P.current}}function S(t){return"object"==typeof t&&null!==t&&t.$$typeof===n}var C=/\/+/g;function I(t,e){return"object"==typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,(function(t){return e[t]}))}(""+t.key):e.toString(36)}function A(t,e,r,o,s){var a=typeof t;"undefined"!==a&&"boolean"!==a||(t=null);var l=!1;if(null===t)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(t.$$typeof){case n:case i:l=!0}}if(l)return s=s(l=t),t=""===o?"."+I(l,0):o,b(s)?(r="",null!=t&&(r=t.replace(C,"$&/")+"/"),A(s,e,r,"",(function(t){return t}))):null!=s&&(S(s)&&(s=function(t,e){return{$$typeof:n,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}(s,r+(!s.key||l&&l.key===s.key?"":(""+s.key).replace(C,"$&/")+"/")+t)),e.push(s)),1;if(l=0,o=""===o?".":o+":",b(t))for(var u=0;u<t.length;u++){var h=o+I(a=t[u],u);l+=A(a,e,r,h,s)}else if(h=function(t){return null===t||"object"!=typeof t?null:"function"==typeof(t=d&&t[d]||t["@@iterator"])?t:null}(t),"function"==typeof h)for(t=h.call(t),u=0;!(a=t.next()).done;)l+=A(a=a.value,e,r,h=o+I(a,u++),s);else if("object"===a)throw e=String(t),Error("Objects are not valid as a React child (found: "+("[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return l}function O(t,e,n){if(null==t)return t;var i=[],r=0;return A(t,i,"","",(function(t){return e.call(n,t,r++)})),i}function N(t){if(-1===t._status){var e=t._result;(e=e()).then((function(e){0!==t._status&&-1!==t._status||(t._status=1,t._result=e)}),(function(e){0!==t._status&&-1!==t._status||(t._status=2,t._result=e)})),-1===t._status&&(t._status=0,t._result=e)}if(1===t._status)return t._result.default;throw t._result}var L={current:null},M={transition:null},R={ReactCurrentDispatcher:L,ReactCurrentBatchConfig:M,ReactCurrentOwner:P};function k(){throw Error("act(...) is not supported in production builds of React.")}e.Children={map:O,forEach:function(t,e,n){O(t,(function(){e.apply(this,arguments)}),n)},count:function(t){var e=0;return O(t,(function(){e++})),e},toArray:function(t){return O(t,(function(t){return t}))||[]},only:function(t){if(!S(t))throw Error("React.Children.only expected to receive a single React element child.");return t}},e.Component=g,e.Fragment=r,e.Profiler=s,e.PureComponent=_,e.StrictMode=o,e.Suspense=h,e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=R,e.act=k,e.cloneElement=function(t,e,i){if(null==t)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=m({},t.props),o=t.key,s=t.ref,a=t._owner;if(null!=e){if(void 0!==e.ref&&(s=e.ref,a=P.current),void 0!==e.key&&(o=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(u in e)w.call(e,u)&&!E.hasOwnProperty(u)&&(r[u]=void 0===e[u]&&void 0!==l?l[u]:e[u])}var u=arguments.length-2;if(1===u)r.children=i;else if(1<u){l=Array(u);for(var h=0;h<u;h++)l[h]=arguments[h+2];r.children=l}return{$$typeof:n,type:t.type,key:o,ref:s,props:r,_owner:a}},e.createContext=function(t){return(t={$$typeof:l,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:t},t.Consumer=t},e.createElement=T,e.createFactory=function(t){var e=T.bind(null,t);return e.type=t,e},e.createRef=function(){return{current:null}},e.forwardRef=function(t){return{$$typeof:u,render:t}},e.isValidElement=S,e.lazy=function(t){return{$$typeof:p,_payload:{_status:-1,_result:t},_init:N}},e.memo=function(t,e){return{$$typeof:c,type:t,compare:void 0===e?null:e}},e.startTransition=function(t){var e=M.transition;M.transition={};try{t()}finally{M.transition=e}},e.unstable_act=k,e.useCallback=function(t,e){return L.current.useCallback(t,e)},e.useContext=function(t){return L.current.useContext(t)},e.useDebugValue=function(){},e.useDeferredValue=function(t){return L.current.useDeferredValue(t)},e.useEffect=function(t,e){return L.current.useEffect(t,e)},e.useId=function(){return L.current.useId()},e.useImperativeHandle=function(t,e,n){return L.current.useImperativeHandle(t,e,n)},e.useInsertionEffect=function(t,e){return L.current.useInsertionEffect(t,e)},e.useLayoutEffect=function(t,e){return L.current.useLayoutEffect(t,e)},e.useMemo=function(t,e){return L.current.useMemo(t,e)},e.useReducer=function(t,e,n){return L.current.useReducer(t,e,n)},e.useRef=function(t){return L.current.useRef(t)},e.useState=function(t){return L.current.useState(t)},e.useSyncExternalStore=function(t,e,n){return L.current.useSyncExternalStore(t,e,n)},e.useTransition=function(){return L.current.useTransition()},e.version="18.3.1"},540:(t,e,n)=>{"use strict";t.exports=n(287)},463:(t,e)=>{"use strict";function n(t,e){var n=t.length;t.push(e);t:for(;0<n;){var i=n-1>>>1,r=t[i];if(!(0<o(r,e)))break t;t[i]=e,t[n]=r,n=i}}function i(t){return 0===t.length?null:t[0]}function r(t){if(0===t.length)return null;var e=t[0],n=t.pop();if(n!==e){t[0]=n;t:for(var i=0,r=t.length,s=r>>>1;i<s;){var a=2*(i+1)-1,l=t[a],u=a+1,h=t[u];if(0>o(l,n))u<r&&0>o(h,l)?(t[i]=h,t[u]=n,i=u):(t[i]=l,t[a]=n,i=a);else{if(!(u<r&&0>o(h,n)))break t;t[i]=h,t[u]=n,i=u}}}return e}function o(t,e){var n=t.sortIndex-e.sortIndex;return 0!==n?n:t.id-e.id}if("object"==typeof performance&&"function"==typeof performance.now){var s=performance;e.unstable_now=function(){return s.now()}}else{var a=Date,l=a.now();e.unstable_now=function(){return a.now()-l}}var u=[],h=[],c=1,p=null,d=3,f=!1,m=!1,y=!1,g="function"==typeof setTimeout?setTimeout:null,v="function"==typeof clearTimeout?clearTimeout:null,_="undefined"!=typeof setImmediate?setImmediate:null;function x(t){for(var e=i(h);null!==e;){if(null===e.callback)r(h);else{if(!(e.startTime<=t))break;r(h),e.sortIndex=e.expirationTime,n(u,e)}e=i(h)}}function b(t){if(y=!1,x(t),!m)if(null!==i(u))m=!0,M(w);else{var e=i(h);null!==e&&R(b,e.startTime-t)}}function w(t,n){m=!1,y&&(y=!1,v(S),S=-1),f=!0;var o=d;try{for(x(n),p=i(u);null!==p&&(!(p.expirationTime>n)||t&&!A());){var s=p.callback;if("function"==typeof s){p.callback=null,d=p.priorityLevel;var a=s(p.expirationTime<=n);n=e.unstable_now(),"function"==typeof a?p.callback=a:p===i(u)&&r(u),x(n)}else r(u);p=i(u)}if(null!==p)var l=!0;else{var c=i(h);null!==c&&R(b,c.startTime-n),l=!1}return l}finally{p=null,d=o,f=!1}}"undefined"!=typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var P,E=!1,T=null,S=-1,C=5,I=-1;function A(){return!(e.unstable_now()-I<C)}function O(){if(null!==T){var t=e.unstable_now();I=t;var n=!0;try{n=T(!0,t)}finally{n?P():(E=!1,T=null)}}else E=!1}if("function"==typeof _)P=function(){_(O)};else if("undefined"!=typeof MessageChannel){var N=new MessageChannel,L=N.port2;N.port1.onmessage=O,P=function(){L.postMessage(null)}}else P=function(){g(O,0)};function M(t){T=t,E||(E=!0,P())}function R(t,n){S=g((function(){t(e.unstable_now())}),n)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(t){t.callback=null},e.unstable_continueExecution=function(){m||f||(m=!0,M(w))},e.unstable_forceFrameRate=function(t){0>t||125<t?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<t?Math.floor(1e3/t):5},e.unstable_getCurrentPriorityLevel=function(){return d},e.unstable_getFirstCallbackNode=function(){return i(u)},e.unstable_next=function(t){switch(d){case 1:case 2:case 3:var e=3;break;default:e=d}var n=d;d=e;try{return t()}finally{d=n}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(t,e){switch(t){case 1:case 2:case 3:case 4:case 5:break;default:t=3}var n=d;d=t;try{return e()}finally{d=n}},e.unstable_scheduleCallback=function(t,r,o){var s=e.unstable_now();switch(o="object"==typeof o&&null!==o&&"number"==typeof(o=o.delay)&&0<o?s+o:s,t){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return t={id:c++,callback:r,priorityLevel:t,startTime:o,expirationTime:a=o+a,sortIndex:-1},o>s?(t.sortIndex=o,n(h,t),null===i(u)&&t===i(h)&&(y?(v(S),S=-1):y=!0,R(b,o-s))):(t.sortIndex=a,n(u,t),m||f||(m=!0,M(w))),t},e.unstable_shouldYield=A,e.unstable_wrapCallback=function(t){var e=d;return function(){var n=d;d=e;try{return t.apply(this,arguments)}finally{d=n}}}},982:(t,e,n)=>{"use strict";t.exports=n(463)},872:(t,e,n)=>{"use strict";n.d(e,{D:()=>o});var i=n(540),r=n(385);const o=t=>{const[e,n]=(0,i.useState)(null),[o,s]=(0,i.useState)(!1),[a,l]=(0,i.useState)(null),[u,h]=(0,i.useState)(new Map),c=e=>{const n=new Map;for(const i of t.allDataEntries.keys()){const t=(0,r.dV)(e,i);if(t){const e=p(t);n.set(t.id,e)}}return n},p=e=>{if(t.isGradient.value&&t.gradient?.min&&t.gradient?.max)return(0,r.yw)(t.gradient.min?.color,t.gradient.max?.color,t.allDataEntries,e.id)},d=(t,e=1)=>{if(!t)return;const n=u.get(t.id)??p(t);t.node.setHighlight({fill:n,fillOpacity:e})},f=(t=1)=>{(0,r.c5)(e).forEach((e=>{d(e,t)}))};return(0,i.useEffect)((()=>{s(!1)}),[t.floorID,t.publishableToken]),(0,i.useEffect)((()=>{t.highlightedDataEntries?.size>0?(()=>{f(.5);for(const n of t.highlightedDataEntries.keys()){const t=(0,r.dV)(e,n);d(t)}})():a?(f(.5),d(a)):f()}),[e,a,t.allDataEntries,t.highlightedDataEntries,u,t.setSelectedSpaceId]),(0,i.useEffect)((()=>{h(c(e))}),[t.gradient]),(0,i.useEffect)((()=>{e&&e.on("click",(n=>{const i=n.pos,o=(0,r.Pl)(e,i);if(a!==o){if(l(o),!o)return t.clearSelection(),void f();t.setSelectedSpaceId(o.id)}}))}),[e,a]),i.createElement("div",{id:"app"},i.createElement(r.sk,{id:t.floorID,token:t.publishableToken,loaded:o,onLoad:t=>{n(t),s(!0),h(c(t))}}))}},980:(t,e,n)=>{"use strict";n.d(e,{S:()=>c});var i=n(674),r=n(889),o=n(385),s=i.z.Zp,a=i.z.Kx;class l extends s{publishableToken=new i.z.ks({name:"publishableToken",displayName:"Publishable Token",value:o.Sh,placeholder:"Publishable Token"});floorID=new i.z.ks({name:"floorID",displayName:"Floor ID",value:o.I5,placeholder:"Floor ID"});name="archilogicPlugin";displayName="Archilogic Plugin";slices=[this.publishableToken,this.floorID]}class u extends s{show=new i.z.jF({name:"show",displayName:void 0,value:!1,topLevelToggle:!1});name="enableGradient";displayName="Enable Gradient";slices=[this.show]}class h extends s{defaultColor=new i.z.sk({name:"defaultColor",displayName:"Default Color",value:{value:""},selector:r.Z(0),instanceKind:3});name="dataPoint";displayName="Data Colors";slices=[this.defaultColor]}class c extends a{archilogicPluginSettings=new l;enableGradient=new u;dataPoint=new h;cards=[this.archilogicPluginSettings,this.enableGradient,this.dataPoint]}},789:(t,e,n)=>{"use strict";n.d(e,{b:()=>l});var i=n(674),r=n(980),o=n(540),s=n(961),a=n(872);class l{target;formattingSettings;formattingSettingsService;host;selectionManager;gradient;dataView;selectedSpaceId;allCategories;constructor(t){this.target=t.element,this.formattingSettingsService=new i.O,this.host=t.host,this.selectionManager=this.host.createSelectionManager(),this.handleContextMenu(),this.selectionManager.clear()}handleContextMenu(){this.target.oncontextmenu=(t,e)=>{this.selectionManager.showContextMenu(e||{},{x:t.clientX,y:t.clientY}),t.preventDefault()}}setGradient(t){if(t){const e=t.dataPoint.defaultColor.gradient.options,n=Object.keys(e)[0];this.gradient=e[n]}else this.gradient=null}updateSelectionBySpaceId(t){let e;const n=this.allCategories;if(n.forEach((n=>{const i=n.values.findIndex((e=>e===t));i&&(e=n?.identity?.[i]?.identityIndex)})),e){const t=this.host.createSelectionIdBuilder().withCategory(n[0],e).createSelectionId();this.selectionManager.select(t)}return e}setSelectedSpaceId(t){this.selectionManager.clear(),this.selectedSpaceId=t;const e=[this.selectedSpaceId];this.updateSelectionBySpaceId(t),this.renderReactComponent(e)}clearSelection(){this.selectionManager.clear()}renderReactComponent(t,e){const n=this.setSelectedSpaceId.bind(this),i=this.clearSelection.bind(this),r=o.createElement(a.D,{publishableToken:this.formattingSettings.archilogicPluginSettings.publishableToken.value,floorID:this.formattingSettings.archilogicPluginSettings.floorID.value,isGradient:this.formattingSettings.enableGradient.slices[0],gradient:this.gradient,allDataEntries:t,highlightedDataEntries:e,setSelectedSpaceId:n,clearSelection:i});s.render(r,this.target)}update(t){this.formattingSettings=this.formattingSettingsService.populateFormattingSettingsModel(r.S,t.dataViews),this.dataView=t.dataViews[0],this.allCategories?.length||(this.allCategories=this.dataView?.categorical?.categories);const{objectsRules:e}=this.dataView.metadata,n=this.dataView.categorical.categories?.[0].values??[],i=this.dataView.categorical.values?.[0].values??[],o=this.dataView.categorical.values?.[0].highlights??[],s=new Map(n.map(((t,e)=>[t,i[e]]))??[]),a=new Map;for(let t=0;t<n.length;t++)o.length>0&&null!=o[t]&&a.set(n[t],o[t]);this.setGradient(e),this.renderReactComponent(s,a)}getFormattingModel(){return this.formattingSettingsService.buildFormattingModel(this.formattingSettings)}}},231:(t,e,n)=>{"use strict";n.d(e,{A:()=>o});var i=n(41),r=n(869);const o=t=>{const e=`floor-plan-${(new Date).getTime()}`,n={publishableAccessToken:t.token};return setTimeout((()=>{const i=document.getElementById(e);if(i&&!t.loaded){const e=new r.Et({container:i,options:t.startupOptions});e.loadScene(t.id,n).then((()=>{t.onLoad&&t.onLoad(e)}))}}),500),i.createElement("div",{className:"plan-wrapper"},i.createElement("div",{id:e,className:"plan-container"}))}},684:(t,e,n)=>{"use strict";n.d(e,{A:()=>i.A});var i=n(231)},922:(t,e,n)=>{"use strict";n.d(e,{s:()=>i.A});var i=n(684)},385:(t,e,n)=>{"use strict";n.d(e,{I5:()=>s.I,Pl:()=>o.Pl,Sh:()=>s.S,c5:()=>o.c5,dV:()=>o.dV,sk:()=>i.s,yw:()=>r.yw});var i=n(922),r=n(691),o=n(990),s=n(386)},691:(t,e,n)=>{"use strict";n.d(e,{yw:()=>s});var i=n(791),r=n.n(i);function o(t){const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]:null}function s(t,e,n,i){if(!(n.size>0))return null;{const s=function(t,e,n=10){return(new(r())).setColorGradient(t,e).setMidpoint(n).getColors()}(t,e),a=n.values(),l=function(t,e){const n=Math.ceil(t.length/e);return Array.from({length:e},((e,i)=>t.slice(i*n,(i+1)*n)))}([...new Set(a)].sort(((t,e)=>t-e)),s.length),u=n.get(i);if(u)for(let t=0;t<l.length;t++)if(-1!=l[t].indexOf(u))return o(s[t])}}},386:(t,e,n)=>{"use strict";n.d(e,{I:()=>i,S:()=>r});const i="e9c82007-ae74-4b95-9174-8df619a08bd8",r="a983595e-94ee-4ecf-8cd0-1f5f1612fc96"},990:(t,e,n)=>{"use strict";n.d(e,{Pl:()=>o,c5:()=>i,dV:()=>r});const i=t=>{if(!t)return[];const{spaces:e,assets:n}=t.resources;return[...e,...n]},r=(t,e)=>i(t).find((t=>t.id===e)),o=(t,e)=>{const n=e,i=t.getResourcesFromPosition(n);return!!i.spaces&&i.spaces[0]}}},e={};function n(i){var r=e[i];if(void 0!==r)return r.exports;var o=e[i]={exports:{}};return t[i](o,o.exports,n),o.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var i={};(()=>{"use strict";n.r(i),n.d(i,{default:()=>o});var t=n(789),e=window.powerbi,r={name:"floorPlanVisualizationA490C0576F6341F78AFFF9E2E83E7396",displayName:"Archilogic Floor Plan Visualization",class:"Visual",apiVersion:"5.10.0",create:e=>{if(t.b)return new t.b(e);throw"Visual instance not found"},createModalDialog:(t,e,n)=>{const i=globalThis.dialogRegistry;t in i&&new i[t](e,n)},custom:!0};void 0!==e&&(e.visuals=e.visuals||{},e.visuals.plugins=e.visuals.plugins||{},e.visuals.plugins.floorPlanVisualizationA490C0576F6341F78AFFF9E2E83E7396=r);const o=r})(),floorPlanVisualizationA490C0576F6341F78AFFF9E2E83E7396=i})();