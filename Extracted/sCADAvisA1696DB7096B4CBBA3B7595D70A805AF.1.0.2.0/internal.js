/*
 *  Power BI Visualizations
 *
 *  Copyright (c) Microsoft Corporation
 *  All rights reserved.
 *  MIT License
 *
 *  Permission is hereby granted, free of charge, to any person obtaining a copy
 *  of this software and associated documentation files (the ""Software""), to deal
 *  in the Software without restriction, including without limitation the rights
 *  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 *  copies of the Software, and to permit persons to whom the Software is
 *  furnished to do so, subject to the following conditions:
 *
 *  The above copyright notice and this permission notice shall be included in
 *  all copies or substantial portions of the Software.
 *
 *  THE SOFTWARE IS PROVIDED *AS IS*, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 *  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 *  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 *  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 *  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 *  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 *  THE SOFTWARE.
 */
var powerbi;
(function (powerbi) {
    var extensibility;
    (function (extensibility) {
        var utils;
        (function (utils) {
            var dataview;
            (function (dataview) {
                // TODO: refactor & focus DataViewTransform into a service with well-defined dependencies.
                var DataViewTransform;
                (function (DataViewTransform) {
                    // TODO: refactor this, setGrouped, and groupValues to a test helper to stop using it in the product
                    function createValueColumns(values, valueIdentityFields, source) {
                        if (values === void 0) { values = []; }
                        var result = values;
                        setGrouped(result);
                        if (valueIdentityFields) {
                            result.identityFields = valueIdentityFields;
                        }
                        if (source) {
                            result.source = source;
                        }
                        return result;
                    }
                    DataViewTransform.createValueColumns = createValueColumns;
                    function setGrouped(values, groupedResult) {
                        values.grouped = groupedResult
                            ? function () { return groupedResult; }
                            : function () { return groupValues(values); };
                    }
                    DataViewTransform.setGrouped = setGrouped;
                    /** Group together the values with a common identity. */
                    function groupValues(values) {
                        var groups = [], currentGroup;
                        for (var i = 0, len = values.length; i < len; i++) {
                            var value = values[i];
                            if (!currentGroup || currentGroup.identity !== value.identity) {
                                currentGroup = {
                                    values: []
                                };
                                if (value.identity) {
                                    currentGroup.identity = value.identity;
                                    var source = value.source;
                                    // allow null, which will be formatted as (Blank).
                                    if (source.groupName !== undefined) {
                                        currentGroup.name = source.groupName;
                                    }
                                    else if (source.displayName) {
                                        currentGroup.name = source.displayName;
                                    }
                                }
                                groups.push(currentGroup);
                            }
                            currentGroup.values.push(value);
                        }
                        return groups;
                    }
                    DataViewTransform.groupValues = groupValues;
                })(DataViewTransform = dataview.DataViewTransform || (dataview.DataViewTransform = {}));
            })(dataview = utils.dataview || (utils.dataview = {}));
        })(utils = extensibility.utils || (extensibility.utils = {}));
    })(extensibility = powerbi.extensibility || (powerbi.extensibility = {}));
})(powerbi || (powerbi = {}));
/*
 *  Power BI Visualizations
 *
 *  Copyright (c) Microsoft Corporation
 *  All rights reserved.
 *  MIT License
 *
 *  Permission is hereby granted, free of charge, to any person obtaining a copy
 *  of this software and associated documentation files (the ""Software""), to deal
 *  in the Software without restriction, including without limitation the rights
 *  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 *  copies of the Software, and to permit persons to whom the Software is
 *  furnished to do so, subject to the following conditions:
 *
 *  The above copyright notice and this permission notice shall be included in
 *  all copies or substantial portions of the Software.
 *
 *  THE SOFTWARE IS PROVIDED *AS IS*, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 *  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 *  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 *  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 *  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 *  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 *  THE SOFTWARE.
 */
var powerbi;
(function (powerbi) {
    var extensibility;
    (function (extensibility) {
        var utils;
        (function (utils) {
            var dataview;
            (function (dataview) {
                var DataRoleHelper;
                (function (DataRoleHelper) {
                    function getMeasureIndexOfRole(grouped, roleName) {
                        if (!grouped || !grouped.length) {
                            return -1;
                        }
                        var firstGroup = grouped[0];
                        if (firstGroup.values && firstGroup.values.length > 0) {
                            for (var i = 0, len = firstGroup.values.length; i < len; ++i) {
                                var value = firstGroup.values[i];
                                if (value && value.source) {
                                    if (hasRole(value.source, roleName)) {
                                        return i;
                                    }
                                }
                            }
                        }
                        return -1;
                    }
                    DataRoleHelper.getMeasureIndexOfRole = getMeasureIndexOfRole;
                    function getCategoryIndexOfRole(categories, roleName) {
                        if (categories && categories.length) {
                            for (var i = 0, ilen = categories.length; i < ilen; i++) {
                                if (hasRole(categories[i].source, roleName)) {
                                    return i;
                                }
                            }
                        }
                        return -1;
                    }
                    DataRoleHelper.getCategoryIndexOfRole = getCategoryIndexOfRole;
                    function hasRole(column, name) {
                        var roles = column.roles;
                        return roles && roles[name];
                    }
                    DataRoleHelper.hasRole = hasRole;
                    function hasRoleInDataView(dataView, name) {
                        return dataView != null
                            && dataView.metadata != null
                            && dataView.metadata.columns
                            && dataView.metadata.columns.some(function (c) { return c.roles && c.roles[name] !== undefined; }); // any is an alias of some
                    }
                    DataRoleHelper.hasRoleInDataView = hasRoleInDataView;
                    function hasRoleInValueColumn(valueColumn, name) {
                        return valueColumn
                            && valueColumn.source
                            && valueColumn.source.roles
                            && (valueColumn.source.roles[name] === true);
                    }
                    DataRoleHelper.hasRoleInValueColumn = hasRoleInValueColumn;
                })(DataRoleHelper = dataview.DataRoleHelper || (dataview.DataRoleHelper = {}));
            })(dataview = utils.dataview || (utils.dataview = {}));
        })(utils = extensibility.utils || (extensibility.utils = {}));
    })(extensibility = powerbi.extensibility || (powerbi.extensibility = {}));
})(powerbi || (powerbi = {}));
/*
 *  Power BI Visualizations
 *
 *  Copyright (c) Microsoft Corporation
 *  All rights reserved.
 *  MIT License
 *
 *  Permission is hereby granted, free of charge, to any person obtaining a copy
 *  of this software and associated documentation files (the ""Software""), to deal
 *  in the Software without restriction, including without limitation the rights
 *  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 *  copies of the Software, and to permit persons to whom the Software is
 *  furnished to do so, subject to the following conditions:
 *
 *  The above copyright notice and this permission notice shall be included in
 *  all copies or substantial portions of the Software.
 *
 *  THE SOFTWARE IS PROVIDED *AS IS*, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 *  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 *  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 *  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 *  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 *  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 *  THE SOFTWARE.
 */
var powerbi;
(function (powerbi) {
    var extensibility;
    (function (extensibility) {
        var utils;
        (function (utils) {
            var dataview;
            (function (dataview) {
                var DataViewObject;
                (function (DataViewObject) {
                    function getValue(object, propertyName, defaultValue) {
                        if (!object) {
                            return defaultValue;
                        }
                        var propertyValue = object[propertyName];
                        if (propertyValue === undefined) {
                            return defaultValue;
                        }
                        return propertyValue;
                    }
                    DataViewObject.getValue = getValue;
                    /** Gets the solid color from a fill property using only a propertyName */
                    function getFillColorByPropertyName(object, propertyName, defaultColor) {
                        var value = getValue(object, propertyName);
                        if (!value || !value.solid) {
                            return defaultColor;
                        }
                        return value.solid.color;
                    }
                    DataViewObject.getFillColorByPropertyName = getFillColorByPropertyName;
                })(DataViewObject = dataview.DataViewObject || (dataview.DataViewObject = {}));
            })(dataview = utils.dataview || (utils.dataview = {}));
        })(utils = extensibility.utils || (extensibility.utils = {}));
    })(extensibility = powerbi.extensibility || (powerbi.extensibility = {}));
})(powerbi || (powerbi = {}));
/*
 *  Power BI Visualizations
 *
 *  Copyright (c) Microsoft Corporation
 *  All rights reserved.
 *  MIT License
 *
 *  Permission is hereby granted, free of charge, to any person obtaining a copy
 *  of this software and associated documentation files (the ""Software""), to deal
 *  in the Software without restriction, including without limitation the rights
 *  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 *  copies of the Software, and to permit persons to whom the Software is
 *  furnished to do so, subject to the following conditions:
 *
 *  The above copyright notice and this permission notice shall be included in
 *  all copies or substantial portions of the Software.
 *
 *  THE SOFTWARE IS PROVIDED *AS IS*, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 *  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 *  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 *  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 *  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 *  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 *  THE SOFTWARE.
 */
var powerbi;
(function (powerbi) {
    var extensibility;
    (function (extensibility) {
        var utils;
        (function (utils) {
            var dataview;
            (function (dataview) {
                var DataViewObjects;
                (function (DataViewObjects) {
                    /** Gets the value of the given object/property pair. */
                    function getValue(objects, propertyId, defaultValue) {
                        if (!objects) {
                            return defaultValue;
                        }
                        return dataview.DataViewObject.getValue(objects[propertyId.objectName], propertyId.propertyName, defaultValue);
                    }
                    DataViewObjects.getValue = getValue;
                    /** Gets an object from objects. */
                    function getObject(objects, objectName, defaultValue) {
                        if (objects && objects[objectName]) {
                            return objects[objectName];
                        }
                        return defaultValue;
                    }
                    DataViewObjects.getObject = getObject;
                    /** Gets the solid color from a fill property. */
                    function getFillColor(objects, propertyId, defaultColor) {
                        var value = getValue(objects, propertyId);
                        if (!value || !value.solid) {
                            return defaultColor;
                        }
                        return value.solid.color;
                    }
                    DataViewObjects.getFillColor = getFillColor;
                    function getCommonValue(objects, propertyId, defaultValue) {
                        var value = getValue(objects, propertyId, defaultValue);
                        if (value && value.solid) {
                            return value.solid.color;
                        }
                        if (value === undefined
                            || value === null
                            || (typeof value === "object" && !value.solid)) {
                            return defaultValue;
                        }
                        return value;
                    }
                    DataViewObjects.getCommonValue = getCommonValue;
                })(DataViewObjects = dataview.DataViewObjects || (dataview.DataViewObjects = {}));
            })(dataview = utils.dataview || (utils.dataview = {}));
        })(utils = extensibility.utils || (extensibility.utils = {}));
    })(extensibility = powerbi.extensibility || (powerbi.extensibility = {}));
})(powerbi || (powerbi = {}));
/*
 *  Power BI Visualizations
 *
 *  Copyright (c) Microsoft Corporation
 *  All rights reserved.
 *  MIT License
 *
 *  Permission is hereby granted, free of charge, to any person obtaining a copy
 *  of this software and associated documentation files (the ""Software""), to deal
 *  in the Software without restriction, including without limitation the rights
 *  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 *  copies of the Software, and to permit persons to whom the Software is
 *  furnished to do so, subject to the following conditions:
 *
 *  The above copyright notice and this permission notice shall be included in
 *  all copies or substantial portions of the Software.
 *
 *  THE SOFTWARE IS PROVIDED *AS IS*, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 *  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 *  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 *  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 *  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 *  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 *  THE SOFTWARE.
 */
var powerbi;
(function (powerbi) {
    var extensibility;
    (function (extensibility) {
        var utils;
        (function (utils) {
            var dataview;
            (function (dataview) {
                // powerbi.extensibility.utils.dataview
                var DataRoleHelper = powerbi.extensibility.utils.dataview.DataRoleHelper;
                var converterHelper;
                (function (converterHelper) {
                    function categoryIsAlsoSeriesRole(dataView, seriesRoleName, categoryRoleName) {
                        if (dataView.categories && dataView.categories.length > 0) {
                            // Need to pivot data if our category soure is a series role
                            var category = dataView.categories[0];
                            return category.source &&
                                DataRoleHelper.hasRole(category.source, seriesRoleName) &&
                                DataRoleHelper.hasRole(category.source, categoryRoleName);
                        }
                        return false;
                    }
                    converterHelper.categoryIsAlsoSeriesRole = categoryIsAlsoSeriesRole;
                    function getSeriesName(source) {
                        return (source.groupName !== undefined)
                            ? source.groupName
                            : source.queryName;
                    }
                    converterHelper.getSeriesName = getSeriesName;
                    function isImageUrlColumn(column) {
                        var misc = getMiscellaneousTypeDescriptor(column);
                        return misc != null && misc.imageUrl === true;
                    }
                    converterHelper.isImageUrlColumn = isImageUrlColumn;
                    function isWebUrlColumn(column) {
                        var misc = getMiscellaneousTypeDescriptor(column);
                        return misc != null && misc.webUrl === true;
                    }
                    converterHelper.isWebUrlColumn = isWebUrlColumn;
                    function getMiscellaneousTypeDescriptor(column) {
                        return column
                            && column.type
                            && column.type.misc;
                    }
                    converterHelper.getMiscellaneousTypeDescriptor = getMiscellaneousTypeDescriptor;
                    function hasImageUrlColumn(dataView) {
                        if (!dataView || !dataView.metadata || !dataView.metadata.columns || !dataView.metadata.columns.length) {
                            return false;
                        }
                        return dataView.metadata.columns.some(function (column) { return isImageUrlColumn(column) === true; });
                    }
                    converterHelper.hasImageUrlColumn = hasImageUrlColumn;
                })(converterHelper = dataview.converterHelper || (dataview.converterHelper = {}));
            })(dataview = utils.dataview || (utils.dataview = {}));
        })(utils = extensibility.utils || (extensibility.utils = {}));
    })(extensibility = powerbi.extensibility || (powerbi.extensibility = {}));
})(powerbi || (powerbi = {}));
/*
 *  Power BI Visualizations
 *
 *  Copyright (c) Microsoft Corporation
 *  All rights reserved.
 *  MIT License
 *
 *  Permission is hereby granted, free of charge, to any person obtaining a copy
 *  of this software and associated documentation files (the ""Software""), to deal
 *  in the Software without restriction, including without limitation the rights
 *  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 *  copies of the Software, and to permit persons to whom the Software is
 *  furnished to do so, subject to the following conditions:
 *
 *  The above copyright notice and this permission notice shall be included in
 *  all copies or substantial portions of the Software.
 *
 *  THE SOFTWARE IS PROVIDED *AS IS*, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 *  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 *  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 *  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 *  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 *  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 *  THE SOFTWARE.
 */
var powerbi;
(function (powerbi) {
    var extensibility;
    (function (extensibility) {
        var utils;
        (function (utils) {
            var dataview;
            (function (dataview) {
                var DataViewObjectsParser = (function () {
                    function DataViewObjectsParser() {
                    }
                    DataViewObjectsParser.getDefault = function () {
                        return new this();
                    };
                    DataViewObjectsParser.createPropertyIdentifier = function (objectName, propertyName) {
                        return {
                            objectName: objectName,
                            propertyName: propertyName
                        };
                    };
                    DataViewObjectsParser.parse = function (dataView) {
                        var dataViewObjectParser = this.getDefault(), properties;
                        if (!dataView || !dataView.metadata || !dataView.metadata.objects) {
                            return dataViewObjectParser;
                        }
                        properties = dataViewObjectParser.getProperties();
                        for (var objectName in properties) {
                            for (var propertyName in properties[objectName]) {
                                var defaultValue = dataViewObjectParser[objectName][propertyName];
                                dataViewObjectParser[objectName][propertyName] = dataview.DataViewObjects.getCommonValue(dataView.metadata.objects, properties[objectName][propertyName], defaultValue);
                            }
                        }
                        return dataViewObjectParser;
                    };
                    DataViewObjectsParser.isPropertyEnumerable = function (propertyName) {
                        return !DataViewObjectsParser.InnumerablePropertyPrefix.test(propertyName);
                    };
                    DataViewObjectsParser.enumerateObjectInstances = function (dataViewObjectParser, options) {
                        var dataViewProperties = dataViewObjectParser && dataViewObjectParser[options.objectName];
                        if (!dataViewProperties) {
                            return [];
                        }
                        var instance = {
                            objectName: options.objectName,
                            selector: null,
                            properties: {}
                        };
                        for (var key in dataViewProperties) {
                            if (dataViewProperties.hasOwnProperty(key)) {
                                instance.properties[key] = dataViewProperties[key];
                            }
                        }
                        return {
                            instances: [instance]
                        };
                    };
                    DataViewObjectsParser.prototype.getProperties = function () {
                        var _this = this;
                        var properties = {}, objectNames = Object.keys(this);
                        objectNames.forEach(function (objectName) {
                            if (DataViewObjectsParser.isPropertyEnumerable(objectName)) {
                                var propertyNames = Object.keys(_this[objectName]);
                                properties[objectName] = {};
                                propertyNames.forEach(function (propertyName) {
                                    if (DataViewObjectsParser.isPropertyEnumerable(objectName)) {
                                        properties[objectName][propertyName] =
                                            DataViewObjectsParser.createPropertyIdentifier(objectName, propertyName);
                                    }
                                });
                            }
                        });
                        return properties;
                    };
                    return DataViewObjectsParser;
                }());
                DataViewObjectsParser.InnumerablePropertyPrefix = /^_/;
                dataview.DataViewObjectsParser = DataViewObjectsParser;
            })(dataview = utils.dataview || (utils.dataview = {}));
        })(utils = extensibility.utils || (extensibility.utils = {}));
    })(extensibility = powerbi.extensibility || (powerbi.extensibility = {}));
})(powerbi || (powerbi = {}));

!function(){var Xl=Math.SQRT2,Bl=Math.abs,Wl=Math.floor,$l=Math.LN2,Gl=Math.tan,Jl=Math.PI,Ql=Math.atan,Kl=Math.ceil,er=Math.LN10,tr=Math.log,nr=Math.min,ir=Math.max,ar=Math.pow,lr=Math.sqrt,rr=Math.atan2,or=Math.cos,dr=Math.round,pr=Math.sin,gr=Math.exp,hr=Math.asin,cr=Math.acos;function e(e){return e&&(e.ownerDocument||e.document||e).documentElement}function t(e){return e&&(e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView)}function l(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function r(e){return null===e?NaN:+e}function o(e){return!isNaN(e)}function d(e){return{left:function(t,n,i,a){for(3>arguments.length&&(i=0),4>arguments.length&&(a=t.length);i<a;){var l=i+a>>>1;0>e(t[l],n)?i=l+1:a=l}return i},right:function(t,n,i,a){for(3>arguments.length&&(i=0),4>arguments.length&&(a=t.length);i<a;){var l=i+a>>>1;0<e(t[l],n)?a=l:i=l+1}return i}}}function s(e){return e.length}function p(e){for(var t=1;e*t%1;)t*=10;return t}function g(e,t){for(var n in t)Object.defineProperty(e.prototype,n,{value:t[n],enumerable:!1})}function h(){this._=Object.create(null)}function c(e){return"__proto__"===(e+="")||"\0"===e[0]?"\0"+e:e}function u(e){return"\0"===(e+="")[0]?e.slice(1):e}function y(e){return c(e)in this._}function m(e){return(e=c(e))in this._&&delete this._[e]}function f(){var e=[];for(var t in this._)e.push(u(t));return e}function x(){var e=0;for(var t in this._)++e;return e}function _(){for(var e in this._)return!1;return!0}function v(){this._=Object.create(null)}function b(e){return e}function k(e,t,n){return function(){var i=n.apply(t,arguments);return i===t?e:i}}function S(e,t){if(t in e)return t;t=t.charAt(0).toUpperCase()+t.slice(1);for(var a=0,l=kr.length,n;a<l;++a)if(n=kr[a]+t,n in e)return n}function w(){}function E(){}function C(e){function t(){for(var t=a,r=-1,o=t.length,n;++r<o;)(n=t[r].on)&&n.apply(this,arguments);return e}var a=[],r=new h;return t.on=function(t,n){var o=r.get(t),l;return 2>arguments.length?o&&o.on:(o&&(o.on=null,a=a.slice(0,l=a.indexOf(o)).concat(a.slice(l+1)),r.remove(t)),n&&a.push(r.set(t,{on:n})),e)},t}function A(){ur.event.preventDefault()}function j(){for(var t=ur.event,n;n=t.sourceEvent;)t=n;return t}function z(e){for(var t=new E,a=0,l=arguments.length;++a<l;)t[arguments[a]]=C(t);return t.of=function(n,i){return function(a){try{var l=a.sourceEvent=ur.event;a.target=e,ur.event=a,t[a.type].apply(n,i)}finally{ur.event=l}}},t}function L(e){return wr(e,jr),e}function T(e){return"function"==typeof e?e:function(){return Er(e,this)}}function M(e){return"function"==typeof e?e:function(){return Cr(e,this)}}function R(e,t){function n(){this.removeAttribute(e)}function i(){this.removeAttributeNS(e.space,e.local)}function a(){this.setAttribute(e,t)}function l(){this.setAttributeNS(e.space,e.local,t)}function r(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}function o(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}return e=ur.ns.qualify(e),null==t?e.local?i:n:"function"==typeof t?e.local?o:r:e.local?l:a}function N(e){return e.trim().replace(/\s+/g," ")}function U(e){return new RegExp("(?:^|\\s+)"+ur.requote(e)+"(?:\\s+|$)","g")}function P(e){return(e+"").trim().split(/^|\s+/)}function D(e,t){function i(){for(var n=-1;++n<l;)e[n](this,t)}function a(){for(var n=-1,a=t.apply(this,arguments);++n<l;)e[n](this,a)}e=P(e).map(q);var l=e.length;return"function"==typeof t?a:i}function q(e){var t=U(e);return function(n,i){if(a=n.classList)return i?a.add(e):a.remove(e);var a=n.getAttribute("class")||"";i?(t.lastIndex=0,!t.test(a)&&n.setAttribute("class",N(a+" "+e))):n.setAttribute("class",N(a.replace(t," ")))}}function H(e,t,n){return null==t?function(){this.style.removeProperty(e)}:"function"==typeof t?function(){var i=t.apply(this,arguments);null==i?this.style.removeProperty(e):this.style.setProperty(e,i,n)}:function(){this.style.setProperty(e,t,n)}}function I(e,t){return null==t?function(){delete this[e]}:"function"==typeof t?function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}:function(){this[e]=t}}function F(e){function t(){var t=this.ownerDocument,n=this.namespaceURI;return"http://www.w3.org/1999/xhtml"===n&&"http://www.w3.org/1999/xhtml"===t.documentElement.namespaceURI?t.createElement(e):t.createElementNS(n,e)}function n(){return this.ownerDocument.createElementNS(e.space,e.local)}return"function"==typeof e?e:(e=ur.ns.qualify(e)).local?n:t}function Y(){var e=this.parentNode;e&&e.removeChild(this)}function O(e){return{__data__:e}}function Z(e){return function(){return Ar(this,e)}}function V(e){return arguments.length||(e=l),function(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}}function X(e,t){for(var a=0,l=e.length;a<l;a++)for(var r=e[a],o=0,d=r.length,n;o<d;o++)(n=r[o])&&t(n,o,a);return e}function B(e){return wr(e,Lr),e}function W(e){var t,a;return function(l,r,i){var o=e[i].update,d=o.length,n;for(i!=a&&(a=i,t=0),r>=t&&(t=r+1);!(n=o[t])&&++t<d;);return n}}function $(e,t,n){function r(){var t=this[s];t&&(this.removeEventListener(e,t,t.$),delete this[s])}function o(){var o=i(t,a(arguments));r.call(this),this.addEventListener(e,this[s]=o,o.$=n),o._=t}function d(){var t=new RegExp("^__on([^.]+)"+ur.requote(e)+"$"),n;for(var i in this)if(n=i.match(t)){var a=this[i];this.removeEventListener(n[1],a,a.$),delete this[i]}}var s="__on"+e,p=e.indexOf("."),i=G;0<p&&(e=e.slice(0,p));var l=Tr.get(e);return l&&(e=l,i=J),p?t?o:r:t?w:d}function G(e,t){return function(n){var i=ur.event;ur.event=n,t[0]=this.__data__;try{e.apply(this,t)}finally{ur.event=i}}}function J(e,t){var n=G(e,t);return function(t){var e=this,i=t.relatedTarget;i&&(i===e||8&i.compareDocumentPosition(e))||n.call(e,t)}}function Q(n){var i=".dragsuppress-"+ ++Mr,a="click"+i,l=ur.select(t(n)).on("touchmove"+i,A).on("dragstart"+i,A).on("selectstart"+i,A);if(null==Rr&&(Rr=!("onselectstart"in n)&&S(n.style,"userSelect")),Rr){var r=e(n).style,o=r[Rr];r[Rr]="none"}return function(e){if(l.on(i,null),Rr&&(r[Rr]=o),e){var t=function(){l.on(a,null)};l.on(a,function(){A(),t()},!0),setTimeout(t,0)}}}function K(n,i){i.changedTouches&&(i=i.changedTouches[0]);var a=n.ownerSVGElement||n;if(a.createSVGPoint){var l=a.createSVGPoint();if(0>Nr){var r=t(n);if(r.scrollX||r.scrollY){a=ur.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var o=a[0][0].getScreenCTM();Nr=!(o.f||o.e),a.remove()}}return Nr?(l.x=i.pageX,l.y=i.pageY):(l.x=i.clientX,l.y=i.clientY),l=l.matrixTransform(n.getScreenCTM().inverse()),[l.x,l.y]}var d=n.getBoundingClientRect();return[i.clientX-d.left-n.clientLeft,i.clientY-d.top-n.clientTop]}function ee(){return ur.event.changedTouches[0].identifier}function te(e){return 0<e?1:0>e?-1:0}function ne(e,t,n){return(t[0]-e[0])*(n[1]-e[1])-(t[1]-e[1])*(n[0]-e[0])}function ie(e){return 1<e?0:-1>e?i:cr(e)}function ae(e){return 1<e?qr:-1>e?-qr:hr(e)}function le(e){return((e=gr(e))-1/e)/2}function re(e){return((e=gr(e))+1/e)/2}function oe(e){return((e=gr(2*e))-1)/(e+1)}function de(e){return(e=pr(e/2))*e}function se(){}function pe(e,t,n){return this instanceof pe?void(this.h=+e,this.s=+t,this.l=+n):2>arguments.length?e instanceof pe?new pe(e.h,e.s,e.l):we(""+e,Ee,pe):new pe(e,t,n)}function ge(e,t,n){function i(e){return 360<e?e-=360:0>e&&(e+=360),60>e?r+(o-r)*e/60:180>e?o:240>e?r+(o-r)*(240-e)/60:r}function a(e){return dr(255*i(e))}var r,o;return e=isNaN(e)?0:0>(e%=360)?e+360:e,t=isNaN(t)?0:0>t?0:1<t?1:t,n=0>n?0:1<n?1:n,o=.5>=n?n*(1+t):n+t-n*t,r=2*n-o,new ve(a(e+120),a(e),a(e-120))}function he(e,t,n){return this instanceof he?void(this.h=+e,this.c=+t,this.l=+n):2>arguments.length?e instanceof he?new he(e.h,e.c,e.l):e instanceof ue?me(e.l,e.a,e.b):me((e=Ce((e=ur.rgb(e)).r,e.g,e.b)).l,e.a,e.b):new he(e,t,n)}function ce(e,t,n){return isNaN(e)&&(e=0),isNaN(t)&&(t=0),new ue(n,or(e*=Hr)*t,pr(e)*t)}function ue(e,t,n){return this instanceof ue?void(this.l=+e,this.a=+t,this.b=+n):2>arguments.length?e instanceof ue?new ue(e.l,e.a,e.b):e instanceof he?ce(e.h,e.c,e.l):Ce((e=ve(e)).r,e.g,e.b):new ue(e,t,n)}function ye(e,t,n){var i=(e+16)/116,a=i+t/500,l=i-n/200;return a=fe(a)*Wr,i=1*fe(i),l=fe(l)*$r,new ve(_e(3.2404542*a-1.5371385*i-.4985314*l),_e(-.969266*a+1.8760108*i+.041556*l),_e(.0556434*a-.2040259*i+1.0572252*l))}function me(e,t,n){return 0<e?new he(rr(n,t)*Ir,lr(t*t+n*n),e):new he(NaN,NaN,e)}function fe(e){return .206893034<e?e*e*e:(e-4/29)/7.787037}function xe(e){return .008856<e?ar(e,1/3):7.787037*e+4/29}function _e(e){return dr(255*(.00304>=e?12.92*e:1.055*ar(e,1/2.4)-.055))}function ve(e,t,n){return this instanceof ve?void(this.r=~~e,this.g=~~t,this.b=~~n):2>arguments.length?e instanceof ve?new ve(e.r,e.g,e.b):we(""+e,ve,ge):new ve(e,t,n)}function be(e){return new ve(e>>16,255&e>>8,255&e)}function ke(e){return be(e)+""}function Se(e){return 16>e?"0"+ir(0,e).toString(16):nr(255,e).toString(16)}function we(e,t,n){var i=0,a=0,l=0,o,d,s;if(o=/([a-z]+)\((.*)\)/.exec(e=e.toLowerCase()),o)switch(d=o[2].split(","),o[1]){case"hsl":return n(parseFloat(d[0]),parseFloat(d[1])/100,parseFloat(d[2])/100);case"rgb":return t(je(d[0]),je(d[1]),je(d[2]));}return(s=Qr.get(e))?t(s.r,s.g,s.b):(null==e||"#"!==e.charAt(0)||isNaN(s=parseInt(e.slice(1),16))||(4===e.length?(i=(3840&s)>>4,i=i>>4|i,a=240&s,a=a>>4|a,l=15&s,l=l<<4|l):7===e.length&&(i=(16711680&s)>>16,a=(65280&s)>>8,l=255&s)),t(i,a,l))}function Ee(e,t,n){var i=nr(e/=255,t/=255,n/=255),a=ir(e,t,n),o=a-i,d=(a+i)/2,l,p;return o?(p=.5>d?o/(a+i):o/(2-a-i),l=e==a?(t-n)/o+(t<n?6:0):t==a?(n-e)/o+2:(e-t)/o+4,l*=60):(l=NaN,p=0<d&&1>d?0:l),new pe(l,p,d)}function Ce(e,t,n){e=Ae(e),t=Ae(t),n=Ae(n);var i=xe((.4124564*e+.3575761*t+.1804375*n)/Wr),a=xe((.2126729*e+.7151522*t+.072175*n)/1),l=xe((.0193339*e+.119192*t+.9503041*n)/$r);return ue(116*a-16,500*(i-a),200*(a-l))}function Ae(e){return .04045>=(e/=255)?e/12.92:ar((e+.055)/1.055,2.4)}function je(e){var t=parseFloat(e);return"%"===e.charAt(e.length-1)?dr(2.55*t):t}function ze(e){return"function"==typeof e?e:function(){return e}}function Le(e){return function(t,n,i){return 2===arguments.length&&"function"==typeof n&&(i=n,n=null),Te(t,n,e,i)}}function Te(e,t,n,i){function l(){var e=s.status,t;if(!e&&Re(s)||200<=e&&300>e||304===e){try{t=n.call(r,s)}catch(t){return void o.error.call(r,t)}o.load.call(r,t)}else o.error.call(r,s)}var r={},o=ur.dispatch("beforesend","progress","load","error"),d={},s=new XMLHttpRequest,p=null;return this.XDomainRequest&&!("withCredentials"in s)&&/^(http(s)?:)?\/\//.test(e)&&(s=new XDomainRequest),"onload"in s?s.onload=s.onerror=l:s.onreadystatechange=function(){3<s.readyState&&l()},s.onprogress=function(e){var t=ur.event;ur.event=e;try{o.progress.call(r,s)}finally{ur.event=t}},r.header=function(e,t){return(e=(e+"").toLowerCase(),2>arguments.length)?d[e]:(null==t?delete d[e]:d[e]=t+"",r)},r.mimeType=function(e){return arguments.length?(t=null==e?null:e+"",r):t},r.responseType=function(e){return arguments.length?(p=e,r):p},r.response=function(e){return n=e,r},["get","post"].forEach(function(e){r[e]=function(){return r.send.apply(r,[e].concat(a(arguments)))}}),r.send=function(n,i,a){if(2===arguments.length&&"function"==typeof i&&(a=i,i=null),s.open(n,e,!0),null==t||"accept"in d||(d.accept=t+",*/*"),s.setRequestHeader)for(var l in d)s.setRequestHeader(l,d[l]);return null!=t&&s.overrideMimeType&&s.overrideMimeType(t),null!=p&&(s.responseType=p),null!=a&&r.on("error",a).on("load",function(e){a(null,e)}),o.beforesend.call(r,s),s.send(null==i?null:i),r},r.abort=function(){return s.abort(),r},ur.rebind(r,o,"on"),null==i?r:r.get(Me(i))}function Me(e){return 1===e.length?function(t,n){e(null==t?n:null)}:e}function Re(e){var t=e.responseType;return t&&"text"!==t?e.response:e.responseText}function Ne(e,t,i){var a=arguments.length;2>a&&(t=0),3>a&&(i=Date.now());var n=i+t,l={c:e,t:n,n:null};return to?to.n=l:eo=l,to=l,no||(io=clearTimeout(io),no=1,Kr(Ue)),l}function Ue(){var e=Pe(),t=De()-e;24<t?(isFinite(t)&&(clearTimeout(io),io=setTimeout(Ue,t)),no=0):(no=1,Kr(Ue))}function Pe(){for(var e=Date.now(),t=eo;t;)e>=t.t&&t.c(e-t.t)&&(t.c=null),t=t.n;return e}function De(){for(var e=eo,t=1/0,n;e;)e.c?(e.t<t&&(t=e.t),e=(n=e).n):e=n?n.n=e.n:eo=e.n;return to=n,t}function qe(e,t){return t-(e?Kl(tr(e)/er):1)}function He(e){var t=e.decimal,n=e.thousands,a=e.grouping,l=e.currency,r=a&&n?function(e,l){for(var r=e.length,o=[],t=0,d=a[0],s=0;0<r&&0<d&&(s+d+1>l&&(d=ir(1,l-s)),o.push(e.substring(r-=d,r+d)),!((s+=d+1)>l));)d=a[t=(t+1)%a.length];return o.reverse().join(n)}:b;return function(e){var n=lo.exec(e),a=n[1]||" ",o=n[2]||">",d=n[3]||"-",s=n[4]||"",p=n[5],g=+n[6],h=n[7],c=n[8],u=n[9],y=1,m="",f="",x=!1,_=!0;switch(c&&(c=+c.substring(1)),(p||"0"===a&&"="===o)&&(p=a="0",o="="),u){case"n":h=!0,u="g";break;case"%":y=100,f="%",u="f";break;case"p":y=100,f="%",u="r";break;case"b":case"o":case"x":case"X":"#"===s&&(m="0"+u.toLowerCase());case"c":_=!1;case"d":x=!0,c=0;break;case"s":y=-1,u="r";}"$"===s&&(m=l[0],f=l[1]),"r"!=u||c||(u="g"),null!=c&&("g"==u?c=ir(1,nr(21,c)):("e"==u||"f"==u)&&(c=ir(0,nr(20,c)))),u=ro.get(u)||Ie;var v=p&&h;return function(e){var n=f;if(x&&e%1)return"";var l=0>e||0===e&&0>1/e?(e=-e,"-"):"-"===d?"":d;if(0>y){var s=ur.formatPrefix(e,c);e=s.scale(e),n=s.symbol+f}else e*=y;e=u(e,c);var b=e.lastIndexOf("."),i,k;if(0>b){var S=_?e.lastIndexOf("e"):-1;0>S?(i=e,k=""):(i=e.substring(0,S),k=e.substring(S))}else i=e.substring(0,b),k=t+e.substring(b+1);!p&&h&&(i=r(i,1/0));var w=m.length+i.length+k.length+(v?0:l.length),E=w<g?Array(w=g-w+1).join(a):"";return v&&(i=r(E+i,E.length?g-k.length:1/0)),l+=m,e=i+k,("<"===o?l+e+E:">"===o?E+l+e:"^"===o?E.substring(0,w>>=1)+l+e+E.substring(w):l+(v?e:E+e))+n}}}function Ie(e){return e+""}function Fe(){this._=new Date(1<arguments.length?Date.UTC.apply(this,arguments):arguments[0])}function Ye(e,t,n){function i(t){var n=e(t),i=l(n,1);return t-n<i-t?n:i}function a(n){return t(n=e(new so(n-1)),1),n}function l(e,n){return t(e=new so(+e),n),e}function r(e,i,l){var r=a(e),o=[];if(1<l)for(;r<i;)n(r)%l||o.push(new Date(+r)),t(r,1);else for(;r<i;)o.push(new Date(+r)),t(r,1);return o}e.floor=e,e.round=i,e.ceil=a,e.offset=l,e.range=r;var o=e.utc=Oe(e);return o.floor=o,o.round=Oe(i),o.ceil=Oe(a),o.offset=Oe(l),o.range=function(e,t,n){try{so=Fe;var i=new Fe;return i._=e,r(i,t,n)}finally{so=Date}},e}function Oe(e){return function(t,n){try{so=Fe;var i=new Fe;return i._=t,e(i,n)._}finally{so=Date}}}function Ze(e){function t(e){function t(t){for(var n=[],l=-1,r=0,o,d,s;++l<a;)37===e.charCodeAt(l)&&(n.push(e.slice(r,l)),null!=(d=go[o=e.charAt(++l)])&&(o=e.charAt(++l)),(s=b[o])&&(o=s(t,null==d?"e"===o?" ":"0":d)),n.push(o),r=l+1);return n.push(e.slice(r,l)),n.join("")}var a=e.length;return t.parse=function(t){var a={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null},l=n(a,e,t,0);if(l!=t.length)return null;"p"in a&&(a.H=a.H%12+12*a.p);var i=null!=a.Z&&so!==Fe,r=new(i?Fe:so);return"j"in a?r.setFullYear(a.y,0,a.j):"W"in a||"U"in a?(!("w"in a)&&(a.w="W"in a?1:0),r.setFullYear(a.y,0,1),r.setFullYear(a.y,0,"W"in a?(a.w+6)%7+7*a.W-(r.getDay()+5)%7:a.w+7*a.U-(r.getDay()+6)%7)):r.setFullYear(a.y,a.m,a.d),r.setHours(a.H+(0|a.Z/100),a.M+a.Z%100,a.S,a.L),i?r._:r},t.toString=function(){return e},t}function n(e,a,l,r){for(var o=0,d=a.length,n=l.length,s,g,h;o<d;){if(r>=n)return-1;if(s=a.charCodeAt(o++),37===s){if(h=a.charAt(o++),g=k[h in go?a.charAt(o++):h],!g||0>(r=g(e,l,r)))return-1;}else if(s!=l.charCodeAt(r++))return-1}return r}var i=e.dateTime,a=e.date,l=e.time,r=e.periods,o=e.days,s=e.shortDays,p=e.months,g=e.shortMonths;t.utc=function(e){function n(e){try{so=Fe;var t=new so;return t._=e,i(t)}finally{so=Date}}var i=t(e);return n.parse=function(e){try{so=Fe;var t=i.parse(e);return t&&t._}finally{so=Date}},n.toString=i.toString,n},t.multi=t.utc.multi=pt;var h=ur.map(),c=Xe(o),u=Be(o),y=Xe(s),m=Be(s),f=Xe(p),x=Be(p),_=Xe(g),v=Be(g);r.forEach(function(e,t){h.set(e.toLowerCase(),t)});var b={a:function(e){return s[e.getDay()]},A:function(e){return o[e.getDay()]},b:function(e){return g[e.getMonth()]},B:function(e){return p[e.getMonth()]},c:t(i),d:function(e,t){return Ve(e.getDate(),t,2)},e:function(e,t){return Ve(e.getDate(),t,2)},H:function(e,t){return Ve(e.getHours(),t,2)},I:function(e,t){return Ve(e.getHours()%12||12,t,2)},j:function(e,t){return Ve(1+oo.dayOfYear(e),t,3)},L:function(e,t){return Ve(e.getMilliseconds(),t,3)},m:function(e,t){return Ve(e.getMonth()+1,t,2)},M:function(e,t){return Ve(e.getMinutes(),t,2)},p:function(e){return r[+(12<=e.getHours())]},S:function(e,t){return Ve(e.getSeconds(),t,2)},U:function(e,t){return Ve(oo.sundayOfYear(e),t,2)},w:function(e){return e.getDay()},W:function(e,t){return Ve(oo.mondayOfYear(e),t,2)},x:t(a),X:t(l),y:function(e,t){return Ve(e.getFullYear()%100,t,2)},Y:function(e,t){return Ve(e.getFullYear()%1e4,t,4)},Z:dt,"%":function(){return"%"}},k={a:function(e,t,a){y.lastIndex=0;var i=y.exec(t.slice(a));return i?(e.w=m.get(i[0].toLowerCase()),a+i[0].length):-1},A:function(e,t,a){c.lastIndex=0;var i=c.exec(t.slice(a));return i?(e.w=u.get(i[0].toLowerCase()),a+i[0].length):-1},b:function(e,t,a){_.lastIndex=0;var i=_.exec(t.slice(a));return i?(e.m=v.get(i[0].toLowerCase()),a+i[0].length):-1},B:function(e,t,a){f.lastIndex=0;var i=f.exec(t.slice(a));return i?(e.m=x.get(i[0].toLowerCase()),a+i[0].length):-1},c:function(e,t,a){return n(e,b.c.toString(),t,a)},d:nt,e:nt,H:at,I:at,j:it,L:ot,m:tt,M:lt,p:function(e,t,a){var l=h.get(t.slice(a,a+=2).toLowerCase());return null==l?-1:(e.p=l,a)},S:rt,U:$e,w:We,W:Ge,x:function(e,t,a){return n(e,b.x.toString(),t,a)},X:function(e,t,a){return n(e,b.X.toString(),t,a)},y:Qe,Y:Je,Z:Ke,"%":st};return t}function Ve(e,t,n){var i=0>e?"-":"",a=(i?-e:e)+"",l=a.length;return i+(l<n?Array(n-l+1).join(t)+a:a)}function Xe(e){return new RegExp("^(?:"+e.map(ur.requote).join("|")+")","i")}function Be(e){for(var t=new h,a=-1,l=e.length;++a<l;)t.set(e[a].toLowerCase(),a);return t}function We(e,t,a){ho.lastIndex=0;var i=ho.exec(t.slice(a,a+1));return i?(e.w=+i[0],a+i[0].length):-1}function $e(e,t,a){ho.lastIndex=0;var i=ho.exec(t.slice(a));return i?(e.U=+i[0],a+i[0].length):-1}function Ge(e,t,a){ho.lastIndex=0;var i=ho.exec(t.slice(a));return i?(e.W=+i[0],a+i[0].length):-1}function Je(e,t,a){ho.lastIndex=0;var i=ho.exec(t.slice(a,a+4));return i?(e.y=+i[0],a+i[0].length):-1}function Qe(e,t,a){ho.lastIndex=0;var i=ho.exec(t.slice(a,a+2));return i?(e.y=et(+i[0]),a+i[0].length):-1}function Ke(e,t,n){return /^[+-]\d{4}$/.test(t=t.slice(n,n+5))?(e.Z=-t,n+5):-1}function et(e){return e+(68<e?1900:2e3)}function tt(e,t,a){ho.lastIndex=0;var i=ho.exec(t.slice(a,a+2));return i?(e.m=i[0]-1,a+i[0].length):-1}function nt(e,t,a){ho.lastIndex=0;var i=ho.exec(t.slice(a,a+2));return i?(e.d=+i[0],a+i[0].length):-1}function it(e,t,a){ho.lastIndex=0;var i=ho.exec(t.slice(a,a+3));return i?(e.j=+i[0],a+i[0].length):-1}function at(e,t,a){ho.lastIndex=0;var i=ho.exec(t.slice(a,a+2));return i?(e.H=+i[0],a+i[0].length):-1}function lt(e,t,a){ho.lastIndex=0;var i=ho.exec(t.slice(a,a+2));return i?(e.M=+i[0],a+i[0].length):-1}function rt(e,t,a){ho.lastIndex=0;var i=ho.exec(t.slice(a,a+2));return i?(e.S=+i[0],a+i[0].length):-1}function ot(e,t,a){ho.lastIndex=0;var i=ho.exec(t.slice(a,a+3));return i?(e.L=+i[0],a+i[0].length):-1}function dt(e){var t=e.getTimezoneOffset(),n=0<t?"-":"+",i=0|br(t)/60,a=br(t)%60;return n+Ve(i,"0",2)+Ve(a,"0",2)}function st(e,t,a){co.lastIndex=0;var i=co.exec(t.slice(a,a+1));return i?a+i[0].length:-1}function pt(e){for(var t=e.length,n=-1;++n<t;)e[n][0]=this(e[n][0]);return function(t){for(var n=0,a=e[n];!a[1](t);)a=e[++n];return a[0](t)}}function gt(){}function ht(e,t,n){var i=n.s=e+t,a=i-e;n.t=e-(i-a)+(t-a)}function ct(e,t){e&&fo.hasOwnProperty(e.type)&&fo[e.type](e,t)}function ut(e,t,a){var l=-1,r=e.length-a,n;for(t.lineStart();++l<r;)n=e[l],t.point(n[0],n[1],n[2]);t.lineEnd()}function yt(e,t){var a=-1,l=e.length;for(t.polygonStart();++a<l;)ut(e[a],t,1);t.polygonEnd()}function mt(){function e(e,t){e*=Hr,t=t*Hr/2+i/4;var n=e-a,o=0<=n?1:-1,d=o*n,s=or(t),p=pr(t),g=r*p,h=l*s+g*or(d),c=g*o*pr(d);xo.add(rr(c,h)),a=e,l=s,r=p}var t,n,a,l,r;_o.point=function(o,d){_o.point=e,a=(t=o)*Hr,l=or(d=(n=d)*Hr/2+i/4),r=pr(d)},_o.lineEnd=function(){e(t,n)}}function ft(e){var t=e[0],n=e[1],i=or(n);return[i*or(t),i*pr(t),pr(n)]}function xt(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function _t(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function vt(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function bt(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function kt(e){var t=lr(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function St(e){return[rr(e[1],e[0]),ae(e[2])]}function wt(e,t){return br(e[0]-t[0])<Ur&&br(e[1]-t[1])<Ur}function Et(e,t){e*=Hr;var n=or(t*=Hr);Ct(n*or(e),n*pr(e),pr(t))}function Ct(e,t,n){++So,Eo+=(e-Eo)/So,Co+=(t-Co)/So,Ao+=(n-Ao)/So}function At(){function e(e,a){e*=Hr;var l=or(a*=Hr),r=l*or(e),o=l*pr(e),d=pr(a),s=rr(lr((s=n*d-i*o)*s+(s=i*r-t*d)*s+(s=t*o-n*r)*s),t*r+n*o+i*d);wo+=s,jo+=s*(t+(t=r)),zo+=s*(n+(n=o)),Lo+=s*(i+(i=d)),Ct(t,n,i)}var t,n,i;bo.point=function(a,l){a*=Hr;var r=or(l*=Hr);t=r*or(a),n=r*pr(a),i=pr(l),bo.point=e,Ct(t,n,i)}}function jt(){bo.point=Et}function zt(){function e(e,t){e*=Hr;var n=or(t*=Hr),r=n*or(e),o=n*pr(e),d=pr(t),s=a*d-l*o,p=l*r-i*d,g=i*o-a*r,h=lr(s*s+p*p+g*g),c=i*r+a*o+l*d,u=h&&-ie(c)/h,y=rr(h,c);To+=u*s,Mo+=u*p,Ro+=u*g,wo+=y,jo+=y*(i+(i=r)),zo+=y*(a+(a=o)),Lo+=y*(l+(l=d)),Ct(i,a,l)}var t,n,i,a,l;bo.point=function(r,o){t=r,n=o,bo.point=e,r*=Hr;var d=or(o*=Hr);i=d*or(r),a=d*pr(r),l=pr(o),Ct(i,a,l)},bo.lineEnd=function(){e(t,n),bo.lineEnd=jt,bo.point=Et}}function Lt(e,t){function n(n,i){return n=e(n,i),t(n[0],n[1])}return e.invert&&t.invert&&(n.invert=function(n,i){return n=t.invert(n,i),n&&e.invert(n[0],n[1])}),n}function Tt(){return!0}function Mt(e,t,a,l,r){var o=[],d=[];if(e.forEach(function(e){if(!(0>=(s=e.length-1))){var t=e[0],l=e[s],s;if(wt(t,l)){r.lineStart();for(var p=0;p<s;++p)r.point((t=e[p])[0],t[1]);return void r.lineEnd()}var g=new Nt(t,e,null,!0),h=new Nt(t,null,g,!1);g.o=h,o.push(g),d.push(h),g=new Nt(l,e,null,!1),h=new Nt(l,null,g,!0),g.o=h,o.push(g),d.push(h)}}),d.sort(t),Rt(o),Rt(d),!!o.length){for(var s=0,p=a,g=d.length;s<g;++s)d[s].e=p=!p;for(var h=o[0],c,u;;){for(var y=h,m=!0;y.v;)if((y=y.n)===h)return;c=y.z,r.lineStart();do{if(y.v=y.o.v=!0,y.e){if(m)for(var s=0,g=c.length;s<g;++s)r.point((u=c[s])[0],u[1]);else l(y.x,y.n.x,1,r);y=y.n}else{if(m){c=y.p.z;for(var s=c.length-1;0<=s;--s)r.point((u=c[s])[0],u[1])}else l(y.x,y.p.x,-1,r);y=y.p}y=y.o,c=y.z,m=!m}while(!y.v);r.lineEnd()}}}function Rt(e){if(r=e.length){for(var t=0,l=e[0],r,o;++t<r;)l.n=o=e[t],o.p=l,l=o;l.n=o=e[0],o.p=l}}function Nt(e,t,n,i){this.x=e,this.z=t,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}function Ut(e,t,n,i){return function(a,l){function r(t,n){var i=a(t,n);e(t=i[0],n=i[1])&&l.point(t,n)}function o(e,t){var n=a(e,t);c.point(n[0],n[1])}function d(){y.point=o,c.lineStart()}function s(){y.point=r,c.lineEnd()}function p(e,t){b.push([e,t]);var n=a(e,t);f.point(n[0],n[1])}function g(){f.lineStart(),b=[]}function h(){p(b[0][0],b[0][1]),f.lineEnd();var e=f.clean(),t=m.buffer(),a=t.length,r;if(b.pop(),v.push(b),b=null,!!a){if(1&e){r=t[0];var a=r.length-1,o=-1,d;if(0<a){for(x||(l.polygonStart(),x=!0),l.lineStart();++o<a;)l.point((d=r[o])[0],d[1]);l.lineEnd()}return}1<a&&2&e&&t.push(t.pop().concat(t.shift())),_.push(t.filter(Pt))}}var c=t(l),u=a.invert(i[0],i[1]),y={point:r,lineStart:d,lineEnd:s,polygonStart:function(){y.point=p,y.lineStart=g,y.lineEnd=h,_=[],v=[]},polygonEnd:function(){y.point=r,y.lineStart=d,y.lineEnd=s,_=ur.merge(_);var e=It(u,v);_.length?(!x&&(l.polygonStart(),x=!0),Mt(_,qt,e,n,l)):e&&(!x&&(l.polygonStart(),x=!0),l.lineStart(),n(null,null,1,l),l.lineEnd()),x&&(l.polygonEnd(),x=!1),_=v=null},sphere:function(){l.polygonStart(),l.lineStart(),n(null,null,1,l),l.lineEnd(),l.polygonEnd()}},m=Dt(),f=t(m),x=!1,_,v,b;return y}}function Pt(e){return 1<e.length}function Dt(){var e=[],t;return{lineStart:function(){e.push(t=[])},point:function(e,n){t.push([e,n])},lineEnd:w,buffer:function(){var n=e;return e=[],t=null,n},rejoin:function(){1<e.length&&e.push(e.pop().concat(e.shift()))}}}function qt(e,t){return(0>(e=e.x)[0]?e[1]-qr-Ur:qr-e[1])-(0>(t=t.x)[0]?t[1]-qr-Ur:qr-t[1])}function Ht(e,t,n,i){var a=pr(e-n),l,r;return br(a)>Ur?Ql((pr(t)*(r=or(i))*pr(n)-pr(i)*(l=or(t))*pr(e))/(l*r*a)):(t+i)/2}function It(e,t){var a=e[0],l=e[1],r=[pr(a),-or(a),0],o=0,d=0;xo.reset();for(var s=0,p=t.length;s<p;++s){var n=t[s],g=n.length;if(g)for(var h=n[0],c=h[0],u=h[1]/2+i/4,y=pr(u),m=or(u),f=1;;){f===g&&(f=0),e=n[f];var x=e[0],_=e[1]/2+i/4,v=pr(_),b=or(_),S=x-c,w=0<=S?1:-1,E=w*S,C=E>i,A=y*v;if(xo.add(rr(A*w*pr(E),m*b+A*or(E))),o+=C?S+w*Dr:S,C^c>=a^x>=a){var k=_t(ft(h),ft(e));kt(k);var z=_t(r,k);kt(z);var L=(C^0<=S?-1:1)*ae(z[2]);(l>L||l===L&&(k[0]||k[1]))&&(d+=C^0<=S?1:-1)}if(!f++)break;c=x,y=v,m=b,h=e}}return(o<-Ur||o<Ur&&xo<-Ur)^1&d}function Ft(e){function n(e,t){return or(e)*or(t)>r}function a(e,n,a){var l=ft(e),o=ft(n),d=[1,0,0],s=_t(l,o),p=xt(s,s),g=s[0],h=p-g*g;if(!h)return!a&&e;var c=_t(d,s),y=bt(d,r*p/h),m=bt(s,-r*g/h);vt(y,m);var f=c,u=xt(y,f),x=xt(f,f),_=u*u-x*(xt(y,y)-1);if(!(0>_)){var v=lr(_),t=bt(f,(-u-v)/x);if(vt(t,y),t=St(t),!a)return t;var b=e[0],k=n[0],S=e[1],w=n[1],E;k<b&&(E=b,b=k,k=E);var C=k-b,A=br(C-i)<Ur;if(!A&&w<S&&(E=S,S=w,w=E),A||C<Ur?A?0<S+w^t[1]<(br(t[0]-b)<Ur?S:w):S<=t[1]&&t[1]<=w:C>i^(b<=t[0]&&t[0]<=k)){var j=bt(f,(-u+v)/x);return vt(j,y),[t,St(j)]}}}function l(t,n){var a=o?e:i-e,l=0;return t<-a?l|=1:t>a&&(l|=2),n<-a?l|=4:n>a&&(l|=8),l}var r=or(e),o=0<r,d=br(r)>Ur,s=yn(e,6*Hr);return Ut(n,function(e){var r,s,p,g,h;return{lineStart:function(){g=p=!1,h=1},point:function(u,y){var m=[u,y],f=n(u,y),x=o?f?0:l(u,y):f?l(u+(0>u?i:-i),y):0,c;if(!r&&(g=p=f)&&e.lineStart(),f!==p&&(c=a(r,m),(wt(r,c)||wt(m,c))&&(m[0]+=Ur,m[1]+=Ur,f=n(m[0],m[1]))),f!==p)h=0,f?(e.lineStart(),c=a(m,r),e.point(c[0],c[1])):(c=a(r,m),e.point(c[0],c[1]),e.lineEnd()),r=c;else if(d&&r&&o^f){var _;!(x&s)&&(_=a(m,r,!0))&&(h=0,o?(e.lineStart(),e.point(_[0][0],_[0][1]),e.point(_[1][0],_[1][1]),e.lineEnd()):(e.point(_[1][0],_[1][1]),e.lineEnd(),e.lineStart(),e.point(_[0][0],_[0][1])))}!f||r&&wt(r,m)||e.point(m[0],m[1]),r=m,p=f,s=x},lineEnd:function(){p&&e.lineEnd(),r=null},clean:function(){return h|(g&&p)<<1}}},s,o?[0,-e]:[-i,e-i])}function Yt(e,t,n,i){return function(l){var o=l.a,a=l.b,d=o.x,s=o.y,p=a.x,g=a.y,h=0,c=1,u=p-d,y=g-s,m;if(m=e-d,u||!(0<m)){if(m/=u,0>u){if(m<h)return;m<c&&(c=m)}else if(0<u){if(m>c)return;m>h&&(h=m)}if(m=n-d,u||!(0>m)){if(m/=u,0>u){if(m>c)return;m>h&&(h=m)}else if(0<u){if(m<h)return;m<c&&(c=m)}if(m=t-s,y||!(0<m)){if(m/=y,0>y){if(m<h)return;m<c&&(c=m)}else if(0<y){if(m>c)return;m>h&&(h=m)}if(m=i-s,y||!(0>m)){if(m/=y,0>y){if(m>c)return;m>h&&(h=m)}else if(0<y){if(m<h)return;m<c&&(c=m)}return 0<h&&(l.a={x:d+h*u,y:s+h*y}),1>c&&(l.b={x:d+c*u,y:s+c*y}),l}}}}}}function Ot(e,t,n,i){function l(i,a){return br(i[0]-e)<Ur?0<a?0:3:br(i[0]-n)<Ur?0<a?2:1:br(i[1]-t)<Ur?0<a?1:0:0<a?3:2}function r(e,t){return o(e.x,t.x)}function o(e,t){var n=l(e,1),i=l(t,1);return n===i?0===n?t[1]-e[1]:1===n?e[0]-t[0]:2===n?e[1]-t[1]:t[0]-e[0]:n-i}return function(a){function d(e){for(var t=0,l=k.length,n=e[1],r=0;r<l;++r)for(var o=1,d=k[r],s=d.length,p=d[0],g;o<s;++o)g=d[o],p[1]<=n?g[1]>n&&0<ne(p,g,e)&&++t:g[1]<=n&&0>ne(p,g,e)&&--t,p=g;return 0!=t}function s(r,d,s,p){var g=0,h=0;if(null==r||(g=l(r,s))!==(h=l(d,s))||0>o(r,d)^0<s)do p.point(0===g||3===g?e:n,1<g?i:t);while((g=(g+s+4)%4)!==h);else p.point(d[0],d[1])}function p(a,l){return e<=a&&a<=n&&t<=l&&l<=i}function g(e,t){p(e,t)&&a.point(e,t)}function h(){x.point=u,k&&k.push(S=[]),z=!0,j=!1,A=b=NaN}function c(){_&&(u(w,E),C&&j&&m.rejoin(),_.push(m.buffer())),x.point=g,j&&a.lineEnd()}function u(e,t){e=ir(-1000000000,nr(1000000000,e)),t=ir(-1000000000,nr(1000000000,t));var n=p(e,t);if(k&&S.push([e,t]),z)w=e,E=t,C=n,z=!1,n&&(a.lineStart(),a.point(e,t));else if(n&&j)a.point(e,t);else{var i={a:{x:A,y:b},b:{x:e,y:t}};f(i)?(!j&&(a.lineStart(),a.point(i.a.x,i.a.y)),a.point(i.b.x,i.b.y),!n&&a.lineEnd(),L=!1):n&&(a.lineStart(),a.point(e,t),L=!1)}A=e,b=t,j=n}var y=a,m=Dt(),f=Yt(e,t,n,i),x={point:g,lineStart:h,lineEnd:c,polygonStart:function(){a=m,_=[],k=[],L=!0},polygonEnd:function(){a=y,_=ur.merge(_);var t=d([e,i]),n=L&&t,l=_.length;(n||l)&&(a.polygonStart(),n&&(a.lineStart(),s(null,null,1,a),a.lineEnd()),l&&Mt(_,r,t,s,a),a.polygonEnd()),_=k=S=null}},_,k,S,w,E,C,A,b,j,z,L;return x}}function Zt(e){var t=0,n=i/3,a=on(e),l=a(t,n);return l.parallels=function(e){return arguments.length?a(t=e[0]*i/180,n=e[1]*i/180):[180*(t/i),180*(n/i)]},l}function Vt(e,t){function i(e,t){var i=lr(n-2*l*pr(t))/l;return[i*pr(e*=l),r-i*or(e)]}var a=pr(e),l=(a+pr(t))/2,n=1+a*(2*l-a),r=lr(n)/l;return i.invert=function(e,t){var i=r-t;return[rr(e,i)/l,ae((n-(e*e+i*i)*l*l)/(2*l))]},i}function Xt(){function e(e,t){qo+=a*e-i*t,i=e,a=t}var t,n,i,a;No.point=function(l,r){No.point=e,t=i=l,n=a=r},No.lineEnd=function(){e(t,n)}}function Bt(e,t){e<Ho&&(Ho=e),e>Fo&&(Fo=e),t<Io&&(Io=t),t>Yo&&(Yo=t)}function Wt(){function e(e,t){r.push("M",e,",",t,l)}function t(e,t){r.push("M",e,",",t),o.point=n}function n(e,t){r.push("L",e,",",t)}function i(){o.point=e}function a(){r.push("Z")}var l=$t(4.5),r=[],o={point:e,lineStart:function(){o.point=t},lineEnd:i,polygonStart:function(){o.lineEnd=a},polygonEnd:function(){o.lineEnd=i,o.point=e},pointRadius:function(e){return l=$t(e),o},result:function(){if(r.length){var e=r.join("");return r=[],e}}};return o}function $t(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}function Gt(e,t){Eo+=e,Co+=t,++Ao}function Jt(){function e(e,i){var a=e-t,l=i-n,r=lr(a*a+l*l);jo+=r*(t+e)/2,zo+=r*(n+i)/2,Lo+=r,Gt(t=e,n=i)}var t,n;Po.point=function(i,a){Po.point=e,Gt(t=i,n=a)}}function Qt(){Po.point=Gt}function Kt(){function e(e,t){var n=e-i,l=t-a,r=lr(n*n+l*l);jo+=r*(i+e)/2,zo+=r*(a+t)/2,Lo+=r,r=a*e-i*t,To+=r*(i+e),Mo+=r*(a+t),Ro+=3*r,Gt(i=e,a=t)}var t,n,i,a;Po.point=function(l,r){Po.point=e,Gt(t=i=l,n=a=r)},Po.lineEnd=function(){e(t,n)}}function en(e){function t(t,n){e.moveTo(t+r,n),e.arc(t,n,r,0,Dr)}function n(t,n){e.moveTo(t,n),o.point=i}function i(t,n){e.lineTo(t,n)}function a(){o.point=t}function l(){e.closePath()}var r=4.5,o={point:t,lineStart:function(){o.point=n},lineEnd:a,polygonStart:function(){o.lineEnd=l},polygonEnd:function(){o.lineEnd=a,o.point=t},pointRadius:function(e){return r=e,o},result:w};return o}function tn(e){function t(e){return(d?i:n)(e)}function n(t){return ln(t,function(n,i){n=e(n,i),t.point(n[0],n[1])})}function i(t){function n(n,i){n=e(n,i),t.point(n[0],n[1])}function i(){v=NaN,g.point=a,t.lineStart()}function a(n,i){var a=ft([n,i]),r=e(n,i);l(v,b,_,k,S,w,v=r[0],b=r[1],_=n,k=a[0],S=a[1],w=a[2],d,t),t.point(v,b)}function r(){g.point=n,t.lineEnd()}function o(){i(),g.point=s,g.lineEnd=p}function s(e,t){a(h=e,c=t),u=v,y=b,m=k,f=S,x=w,g.point=a}function p(){l(v,b,_,k,S,w,u,y,h,m,f,x,d,t),g.lineEnd=r,r()}var g={point:n,lineStart:i,lineEnd:r,polygonStart:function(){t.polygonStart(),g.lineStart=o},polygonEnd:function(){t.polygonEnd(),g.lineStart=i}},h,c,u,y,m,f,x,_,v,b,k,S,w;return g}function l(t,n,i,d,s,g,h,u,y,f,x,_,v,k){var S=h-t,w=u-n,E=S*S+w*w;if(E>4*r&&v--){var C=d+f,A=s+x,j=g+_,z=lr(C*C+A*A+j*j),m=hr(j/=z),L=br(br(j)-1)<Ur||br(i-y)<Ur?(i+y)/2:rr(A,C),T=e(L,m),p=T[0],M=T[1],R=p-t,N=M-n,U=w*R-S*N;(U*U/E>r||.3<br((S*R+w*N)/E-.5)||d*f+s*x+g*_<o)&&(l(t,n,i,d,s,g,p,M,L,C/=z,A/=z,j,v,k),k.point(p,M),l(p,M,L,C,A,j,h,u,y,f,x,_,v,k))}}var r=.5,o=or(30*Hr),d=16;return t.precision=function(e){return arguments.length?(d=0<(r=e*e)&&16,t):lr(r)},t}function nn(e){var t=tn(function(t,n){return e([t*Ir,n*Ir])});return function(e){return dn(t(e))}}function an(e){this.stream=e}function ln(e,t){return{point:t,sphere:function(){e.sphere()},lineStart:function(){e.lineStart()},lineEnd:function(){e.lineEnd()},polygonStart:function(){e.polygonStart()},polygonEnd:function(){e.polygonEnd()}}}function rn(e){return on(function(){return e})()}function on(e){function t(e){return e=E(e[0]*Hr,e[1]*Hr),[e[0]*r+C,_-e[1]*r]}function n(e){return e=E.invert((e[0]-C)/r,(_-e[1])/r),e&&[e[0]*Ir,e[1]*Ir]}function i(){E=Lt(w=gn(g,h,c),S);var e=S(s,p);return C=o-e[0]*r,_=d+e[1]*r,a()}function a(){return A&&(A.valid=!1,A=null),t}var l=tn(function(e,t){return e=S(e,t),[e[0]*r+C,_-e[1]*r]}),r=150,o=480,d=250,s=0,p=0,g=0,h=0,c=0,u=ko,m=b,f=null,v=null,S,w,E,C,_,A;return t.stream=function(e){return A&&(A.valid=!1),A=dn(u(w,l(m(e)))),A.valid=!0,A},t.clipAngle=function(e){return arguments.length?(u=null==e?(f=e,ko):Ft((f=+e)*Hr),a()):f},t.clipExtent=function(e){return arguments.length?(v=e,m=e?Ot(e[0][0],e[0][1],e[1][0],e[1][1]):b,a()):v},t.scale=function(e){return arguments.length?(r=+e,i()):r},t.translate=function(e){return arguments.length?(o=+e[0],d=+e[1],i()):[o,d]},t.center=function(e){return arguments.length?(s=e[0]%360*Hr,p=e[1]%360*Hr,i()):[s*Ir,p*Ir]},t.rotate=function(e){return arguments.length?(g=e[0]%360*Hr,h=e[1]%360*Hr,c=2<e.length?e[2]%360*Hr:0,i()):[g*Ir,h*Ir,c*Ir]},ur.rebind(t,l,"precision"),function(){return S=e.apply(this,arguments),t.invert=S.invert&&n,i()}}function dn(e){return ln(e,function(t,n){e.point(t*Hr,n*Hr)})}function sn(e,t){return[e,t]}function pn(e,t){return[e>i?e-Dr:e<-i?e+Dr:e,t]}function gn(e,t,n){return e?t||n?Lt(cn(e),un(t,n)):cn(e):t||n?un(t,n):pn}function hn(e){return function(t,n){return t+=e,[t>i?t-Dr:t<-i?t+Dr:t,n]}}function cn(e){var t=hn(e);return t.invert=hn(-e),t}function un(e,t){function n(e,t){var n=or(t),o=or(e)*n,d=pr(e)*n,s=pr(t),p=s*i+o*a;return[rr(d*l-p*r,o*i-s*a),ae(p*l+d*r)]}var i=or(e),a=pr(e),l=or(t),r=pr(t);return n.invert=function(e,t){var n=or(t),o=or(e)*n,d=pr(e)*n,s=pr(t),p=s*l-d*r;return[rr(d*l+s*r,o*i+p*a),ae(p*i-o*a)]},n}function yn(e,n){var i=or(e),a=pr(e);return function(l,r,o,d){var s=o*n;null==l?(l=e+o*Dr,r=e-.5*s):(l=mn(i,l),r=mn(i,r),(0<o?l<r:l>r)&&(l+=o*Dr));for(var p=l,g;0<o?p>r:p<r;p-=s)d.point((g=St([i,-a*or(p),-a*pr(p)]))[0],g[1])}}function mn(e,t){var n=ft(t);n[0]-=e,kt(n);var i=ie(-n[1]);return((0>-n[2]?-i:i)+2*Jl-Ur)%(2*Jl)}function fn(e,t,n){var i=ur.range(e,t-Ur,n).concat(t);return function(e){return i.map(function(t){return[e,t]})}}function xn(e,t,n){var i=ur.range(e,t-Ur,n).concat(t);return function(e){return i.map(function(t){return[t,e]})}}function _n(e){return e.source}function vn(e){return e.target}function bn(e,t,n,i){var a=or(t),l=pr(t),r=or(i),o=pr(i),s=a*or(e),p=a*pr(e),g=r*or(n),h=r*pr(n),c=2*hr(lr(de(i-t)+a*r*de(n-e))),d=1/pr(c),u=c?function(e){var n=pr(e*=c)*d,i=pr(c-e)*d,a=i*s+n*g,r=i*p+n*h;return[rr(r,a)*Ir,rr(i*l+n*o,lr(a*a+r*r))*Ir]}:function(){return[e*Ir,t*Ir]};return u.distance=c,u}function kn(e,t){function n(t,n){var i=or(t),a=or(n),l=e(i*a);return[l*a*pr(t),l*pr(n)]}return n.invert=function(e,n){var i=lr(e*e+n*n),a=t(i),l=pr(a),r=or(a);return[rr(e*l,i*r),hr(i&&n*l/i)]},n}function Sn(e,a){function l(e,i){0<n?i<-qr+Ur&&(i=-qr+Ur):i>qr-Ur&&(i=qr-Ur);var a=n/ar(o(i),t);return[a*pr(t*e),n-a*or(t*e)]}var r=or(e),o=function(e){return Gl(i/4+e/2)},t=e===a?pr(e):tr(r/or(a))/tr(o(a)/o(e)),n=r*ar(o(e),t)/t;return t?(l.invert=function(e,i){var a=n-i,l=te(t)*lr(e*e+a*a);return[rr(e,a)/t,2*Ql(ar(n/l,1/t))-qr]},l):En}function wn(e,t){function i(e,t){var i=n-t;return[i*pr(l*e),n-i*or(l*e)]}var a=or(e),l=e===t?pr(e):(a-or(t))/(t-e),n=a/l+e;return br(l)<Ur?sn:(i.invert=function(e,t){var i=n-t;return[rr(e,i)/l,n-te(l)*lr(e*e+i*i)]},i)}function En(e,t){return[e,tr(Gl(i/4+t/2))]}function Cn(e){var n=rn(e),a=n.scale,l=n.translate,r=n.clipExtent,o;return n.scale=function(){var e=a.apply(n,arguments);return e===n?o?n.clipExtent(null):n:e},n.translate=function(){var e=l.apply(n,arguments);return e===n?o?n.clipExtent(null):n:e},n.clipExtent=function(e){var d=r.apply(n,arguments);if(d!==n)o&&(d=null);else if(o=null==e){var s=i*a(),p=l();r([[p[0]-s,p[1]-s],[p[0]+s,p[1]+s]])}return d},n.clipExtent(null)}function An(e,t){return[tr(Gl(i/4+t/2)),-e]}function jn(e){return e[0]}function zn(e){return e[1]}function Ln(e){for(var t=e.length,n=[0,1],a=2,l=2;l<t;l++){for(;1<a&&0>=ne(e[n[a-2]],e[n[a-1]],e[l]);)--a;n[a++]=l}return n.slice(0,a)}function Tn(e,t){return e[0]-t[0]||e[1]-t[1]}function Mn(e,t,n){return(n[0]-t[0])*(e[1]-t[1])<(n[1]-t[1])*(e[0]-t[0])}function Rn(e,t,n,i){var a=e[0],l=n[0],r=t[0]-a,o=i[0]-l,d=e[1],s=n[1],p=t[1]-d,g=i[1]-s,h=(o*(d-s)-g*(a-l))/(g*r-o*p);return[a+h*r,d+h*p]}function Nn(e){var t=e[0],n=e[e.length-1];return!(t[0]-n[0]||t[1]-n[1])}function Un(){ni(this),this.edge=this.site=this.circle=null}function Pn(e){var t=Jo.pop()||new Un;return t.site=e,t}function Dn(e){Bn(e),td.remove(e),Jo.push(e),ni(e)}function qn(e){var t=e.circle,n=t.x,i=t.cy,a={x:n,y:i},l=e.P,r=e.N,o=[e];Dn(e);for(var d=l;d.circle&&br(n-d.circle.x)<Ur&&br(i-d.circle.cy)<Ur;)l=d.P,o.unshift(d),Dn(d),d=l;o.unshift(d),Bn(d);for(var s=r;s.circle&&br(n-s.circle.x)<Ur&&br(i-s.circle.cy)<Ur;)r=s.N,o.push(s),Dn(s),s=r;o.push(s),Bn(s);var p=o.length,g;for(g=1;g<p;++g)s=o[g],d=o[g-1],Kn(s.edge,d.site,s.site,a);d=o[0],s=o[p-1],s.edge=Jn(d.site,s.site,null,a),Xn(d),Xn(s)}function Hn(e){for(var t=e.x,n=e.y,i=td._,a,l,r,o;i;)if(r=In(i,n)-t,r>Ur)i=i.L;else if(o=t-Fn(i,n),o>Ur){if(!i.R){a=i;break}i=i.R}else{r>-Ur?(a=i.P,l=i):o>-Ur?(a=i,l=i.N):a=l=i;break}var s=Pn(e);if(td.insert(a,s),a||l){if(a===l)return Bn(a),l=Pn(a.site),td.insert(s,l),s.edge=l.edge=Jn(a.site,s.site),Xn(a),void Xn(l);if(!l)return void(s.edge=Jn(a.site,s.site));Bn(a),Bn(l);var p=a.site,g=p.x,h=p.y,c=e.x-g,u=e.y-h,y=l.site,m=y.x-g,f=y.y-h,x=2*(c*f-u*m),d=c*c+u*u,_=m*m+f*f,v={x:(f*d-u*_)/x+g,y:(c*_-m*d)/x+h};Kn(l.edge,p,y,v),s.edge=Jn(p,e,null,v),l.edge=Jn(e,y,null,v),Xn(a),Xn(l)}}function In(e,t){var n=e.site,i=n.x,a=n.y,l=a-t;if(!l)return i;var r=e.P;if(!r)return-Infinity;n=r.site;var o=n.x,d=n.y,s=d-t;if(!s)return o;var p=o-i,g=1/l-1/s,h=p/s;return g?(-h+lr(h*h-2*g*(p*p/(-2*s)-d+s/2+a-l/2)))/g+i:(i+o)/2}function Fn(e,t){var n=e.N;if(n)return In(n,t);var i=e.site;return i.y===t?i.x:1/0}function Yn(e){this.site=e,this.edges=[]}function On(e){for(var t=e[0][0],n=e[1][0],i=e[0][1],a=e[1][1],l=ed,r=l.length,o,d,s,p,g,h,c,u,y,m;r--;)if(g=l[r],g&&g.prepare())for(c=g.edges,u=c.length,h=0;h<u;)m=c[h].end(),s=m.x,p=m.y,y=c[++h%u].start(),o=y.x,d=y.y,(br(s-o)>Ur||br(p-d)>Ur)&&(c.splice(h,0,new ei(Qn(g.site,m,br(s-t)<Ur&&a-p>Ur?{x:t,y:br(o-t)<Ur?d:a}:br(p-a)<Ur&&n-s>Ur?{x:br(d-a)<Ur?o:n,y:a}:br(s-n)<Ur&&p-i>Ur?{x:n,y:br(o-n)<Ur?d:i}:br(p-i)<Ur&&s-t>Ur?{x:br(d-i)<Ur?o:t,y:i}:null),g.site,null)),++u)}function Zn(e,t){return t.angle-e.angle}function Vn(){ni(this),this.x=this.y=this.arc=this.site=this.cy=null}function Xn(e){var t=e.P,n=e.N;if(t&&n){var i=t.site,a=e.site,l=n.site;if(i!==l){var r=a.x,o=a.y,s=i.x-r,p=i.y-o,g=l.x-r,h=l.y-o,c=2*(s*h-p*g);if(!(c>=-Pr)){var d=s*s+p*p,u=g*g+h*h,m=(h*d-p*u)/c,f=(s*u-g*d)/c,h=f+o,y=Qo.pop()||new Vn;y.arc=e,y.site=a,y.x=m+r,y.y=h+lr(m*m+f*f),y.cy=h,e.circle=y;for(var x=null,_=id._;_;)if(y.y<_.y||y.y===_.y&&y.x<=_.x){if(_.L)_=_.L;else{x=_.P;break}}else if(_.R)_=_.R;else{x=_;break}id.insert(x,y),x||(nd=y)}}}}function Bn(e){var t=e.circle;t&&(!t.P&&(nd=t.N),id.remove(t),Qo.push(t),ni(t),e.circle=null)}function Wn(t){for(var n=Ko,a=Yt(t[0][0],t[0][1],t[1][0],t[1][1]),l=n.length,r;l--;)r=n[l],(!$n(r,t)||!a(r)||br(r.a.x-r.b.x)<Ur&&br(r.a.y-r.b.y)<Ur)&&(r.a=r.b=null,n.splice(l,1))}function $n(e,t){var n=e.b;if(n)return!0;var i=e.a,a=t[0][0],l=t[1][0],r=t[0][1],o=t[1][1],d=e.l,s=e.r,p=d.x,g=d.y,h=s.x,c=s.y,u=(p+h)/2,y,m;if(c===g){if(u<a||u>=l)return;if(p>h){if(!i)i={x:u,y:r};else if(i.y>=o)return;n={x:u,y:o}}else{if(!i)i={x:u,y:o};else if(i.y<r)return;n={x:u,y:r}}}else if(y=(p-h)/(c-g),m=(g+c)/2-y*u,-1>y||1<y){if(p>h){if(!i)i={x:(r-m)/y,y:r};else if(i.y>=o)return;n={x:(o-m)/y,y:o}}else{if(!i)i={x:(o-m)/y,y:o};else if(i.y<r)return;n={x:(r-m)/y,y:r}}}else if(g<c){if(!i)i={x:a,y:y*a+m};else if(i.x>=l)return;n={x:l,y:y*l+m}}else{if(!i)i={x:l,y:y*l+m};else if(i.x<a)return;n={x:a,y:y*a+m}}return e.a=i,e.b=n,!0}function Gn(e,t){this.l=e,this.r=t,this.a=this.b=null}function Jn(e,t,n,i){var a=new Gn(e,t);return Ko.push(a),n&&Kn(a,e,t,n),i&&Kn(a,t,e,i),ed[e.i].edges.push(new ei(a,e,t)),ed[t.i].edges.push(new ei(a,t,e)),a}function Qn(e,t,n){var i=new Gn(e,null);return i.a=t,i.b=n,Ko.push(i),i}function Kn(e,t,n,i){e.a||e.b?e.l===n?e.b=i:e.a=i:(e.a=i,e.l=t,e.r=n)}function ei(e,t,n){var i=e.a,a=e.b;this.edge=e,this.site=t,this.angle=n?rr(n.y-t.y,n.x-t.x):e.l===t?rr(a.x-i.x,i.y-a.y):rr(i.x-a.x,a.y-i.y)}function ti(){this._=null}function ni(e){e.U=e.C=e.L=e.R=e.P=e.N=null}function ii(e,t){var n=t,i=t.R,a=n.U;a?a.L===n?a.L=i:a.R=i:e._=i,i.U=a,n.U=i,n.R=i.L,n.R&&(n.R.U=n),i.L=n}function ai(e,t){var n=t,i=t.L,a=n.U;a?a.L===n?a.L=i:a.R=i:e._=i,i.U=a,n.U=i,n.L=i.R,n.L&&(n.L.U=n),i.R=n}function li(e){for(;e.L;)e=e.L;return e}function ri(e,t){var n=e.sort(oi).pop(),i,a,l;for(Ko=[],ed=Array(e.length),td=new ti,id=new ti;;)if(l=nd,n&&(!l||n.y<l.y||n.y===l.y&&n.x<l.x))(n.x!==i||n.y!==a)&&(ed[n.i]=new Yn(n),Hn(n),i=n.x,a=n.y),n=e.pop();else if(l)qn(l.arc);else break;t&&(Wn(t),On(t));var r={cells:ed,edges:Ko};return td=id=Ko=ed=null,r}function oi(e,t){return t.y-e.y||t.x-e.x}function di(e,t,n){return(e.x-n.x)*(t.y-e.y)-(e.x-t.x)*(n.y-e.y)}function si(e){return e.x}function pi(e){return e.y}function gi(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function hi(e,t,n,i,a,l){if(!e(t,n,i,a,l)){var r=.5*(n+a),o=.5*(i+l),d=t.nodes;d[0]&&hi(e,d[0],n,i,r,o),d[1]&&hi(e,d[1],r,i,a,o),d[2]&&hi(e,d[2],n,o,r,l),d[3]&&hi(e,d[3],r,o,a,l)}}function ci(e,t,n,a,l,r,o){var i=1/0,d;return function e(s,p,g,h,c){if(!(p>r||g>o||h<a||c<l)){if(f=s.point){var u=t-s.x,y=n-s.y,m=u*u+y*y,f;if(m<i){var x=lr(i=m);a=t-x,l=n-x,r=t+x,o=n+x,d=f}}for(var _=s.nodes,v=.5*(p+h),b=.5*(g+c),k=(n>=b)<<1|t>=v;void 0>k;++k)if(s=_[3&k])switch(3&k){case 0:e(s,p,g,v,b);break;case 1:e(s,v,g,h,b);break;case 2:e(s,p,b,v,c);break;case 3:e(s,v,b,h,c);}}}(e,a,l,r,o),d}function ui(e,t){e=ur.rgb(e),t=ur.rgb(t);var n=e.r,i=e.g,l=e.b,r=t.r-n,o=t.g-i,d=t.b-l;return function(e){return"#"+Se(dr(n+r*e))+Se(dr(i+o*e))+Se(dr(l+d*e))}}function yi(e,t){var n={},i={},a;for(a in e)a in t?n[a]=xi(e[a],t[a]):i[a]=e[a];for(a in t)a in e||(i[a]=t[a]);return function(e){for(a in n)i[a]=n[a](e);return i}}function mi(e,n){return e=+e,n=+n,function(i){return e*(1-i)+n*i}}function fi(e,n){var t=ld.lastIndex=rd.lastIndex=0,l=-1,r=[],d=[],o,s,p;for(e+="",n+="";(o=ld.exec(e))&&(s=rd.exec(n));)(p=s.index)>t&&(p=n.slice(t,p),r[l]?r[l]+=p:r[++l]=p),(o=o[0])===(s=s[0])?r[l]?r[l]+=s:r[++l]=s:(r[++l]=null,d.push({i:l,x:mi(o,s)})),t=rd.lastIndex;return t<n.length&&(p=n.slice(t),r[l]?r[l]+=p:r[++l]=p),2>r.length?d[0]?(n=d[0].x,function(e){return n(e)+""}):function(){return n}:(n=d.length,function(e){for(var t=0,a;t<n;++t)r[(a=d[t]).i]=a.x(e);return r.join("")})}function xi(e,t){for(var n=ur.interpolators.length,a;0<=--n&&!(a=ur.interpolators[n](e,t)););return a}function _i(e,t){var n=[],a=[],l=e.length,r=t.length,o=nr(e.length,t.length),d;for(d=0;d<o;++d)n.push(xi(e[d],t[d]));for(;d<l;++d)a[d]=e[d];for(;d<r;++d)a[d]=t[d];return function(e){for(d=0;d<o;++d)a[d]=n[d](e);return a}}function vi(e){return function(n){return 0>=n?0:1<=n?1:e(n)}}function bi(e){return function(n){return 1-e(1-n)}}function ki(e){return function(n){return .5*(.5>n?e(2*n):2-e(2-2*n))}}function Si(e){return e*e}function wi(e){return e*e*e}function Ei(e){if(0>=e)return 0;if(1<=e)return 1;var t=e*e,n=t*e;return 4*(.5>e?n:3*(e-t)+n-.75)}function Ci(e){return 1-or(e*qr)}function Ai(e){return ar(2,10*(e-1))}function ji(e){return 1-lr(1-e*e)}function zi(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375}function Li(e,n){return n-=e,function(i){return dr(e+n*i)}}function Ti(e){var t=[e.a,e.b],n=[e.c,e.d],i=Ri(t),a=Mi(t,n),l=Ri(Ni(n,t,-a))||0;t[0]*n[1]<n[0]*t[1]&&(t[0]*=-1,t[1]*=-1,i*=-1,a*=-1),this.rotate=(i?rr(t[1],t[0]):rr(-n[0],n[1]))*Ir,this.translate=[e.e,e.f],this.scale=[i,l],this.skew=l?rr(a,l)*Ir:0}function Mi(e,t){return e[0]*t[0]+e[1]*t[1]}function Ri(e){var t=lr(Mi(e,e));return t&&(e[0]/=t,e[1]/=t),t}function Ni(e,t,n){return e[0]+=n*t[0],e[1]+=n*t[1],e}function Ui(e){return e.length?e.pop()+",":""}function Pi(e,t,n,a){if(e[0]!==t[0]||e[1]!==t[1]){var l=n.push("translate(",null,",",null,")");a.push({i:l-4,x:mi(e[0],t[0])},{i:l-2,x:mi(e[1],t[1])})}else(t[0]||t[1])&&n.push("translate("+t+")")}function Di(e,t,n,i){e===t?t&&n.push(Ui(n)+"rotate("+t+")"):(180<e-t?t+=360:180<t-e&&(e+=360),i.push({i:n.push(Ui(n)+"rotate(",null,")")-2,x:mi(e,t)}))}function qi(e,t,n,i){e===t?t&&n.push(Ui(n)+"skewX("+t+")"):i.push({i:n.push(Ui(n)+"skewX(",null,")")-2,x:mi(e,t)})}function Hi(e,t,n,a){if(e[0]!==t[0]||e[1]!==t[1]){var l=n.push(Ui(n)+"scale(",null,",",null,")");a.push({i:l-4,x:mi(e[0],t[0])},{i:l-2,x:mi(e[1],t[1])})}else(1!==t[0]||1!==t[1])&&n.push(Ui(n)+"scale("+t+")")}function Ii(e,t){var l=[],r=[];return e=ur.transform(e),t=ur.transform(t),Pi(e.translate,t.translate,l,r),Di(e.rotate,t.rotate,l,r),qi(e.skew,t.skew,l,r),Hi(e.scale,t.scale,l,r),e=t=null,function(e){for(var t=-1,a=r.length,n;++t<a;)l[(n=r[t]).i]=n.x(e);return l.join("")}}function Fi(e,t){return t=(t-=e=+e)||1/t,function(n){return(n-e)/t}}function Yi(e,t){return t=(t-=e=+e)||1/t,function(n){return ir(0,nr(1,(n-e)/t))}}function Oi(e){for(var t=e.source,n=e.target,i=Vi(t,n),a=[t];t!==i;)t=t.parent,a.push(t);for(var l=a.length;n!==i;)a.splice(l,0,n),n=n.parent;return a}function Zi(e){for(var t=[],n=e.parent;null!=n;)t.push(e),e=n,n=n.parent;return t.push(e),t}function Vi(e,t){if(e===t)return e;for(var n=Zi(e),i=Zi(t),a=n.pop(),l=i.pop(),r=null;a===l;)r=a,a=n.pop(),l=i.pop();return r}function Xi(e){e.fixed|=2}function Bi(e){e.fixed&=-7}function Wi(e){e.fixed|=4,e.px=e.x,e.py=e.y}function $i(e){e.fixed&=-5}function Gi(e,t,a){var l=0,r=0;if(e.charge=0,!e.leaf)for(var o=e.nodes,d=o.length,n=-1,s;++n<d;)s=o[n],null==s||(Gi(s,t,a),e.charge+=s.charge,l+=s.charge*s.cx,r+=s.charge*s.cy);if(e.point){e.leaf||(e.point.x+=Math.random()-.5,e.point.y+=Math.random()-.5);var p=t*a[e.point.index];e.charge+=e.pointCharge=p,l+=p*e.point.x,r+=p*e.point.y}e.cx=l/e.charge,e.cy=r/e.charge}function Ji(e,t){return ur.rebind(e,t,"sort","children","value"),e.nodes=e,e.links=ia,e}function Qi(e,t){for(var i=[e];null!=(e=i.pop());)if(t(e),(l=e.children)&&(a=l.length))for(var a,l;0<=--a;)i.push(l[a])}function Ki(e,t){for(var a=[e],l=[];null!=(e=a.pop());)if(l.push(e),(d=e.children)&&(o=d.length))for(var r=-1,o,d;++r<o;)a.push(d[r]);for(;null!=(e=l.pop());)t(e)}function ea(e){return e.children}function ta(e){return e.value}function na(e,t){return t.value-e.value}function ia(e){return ur.merge(e.map(function(e){return(e.children||[]).map(function(t){return{source:e,target:t}})}))}function aa(e){return e.x}function la(e){return e.y}function ra(e,t,n){e.y0=t,e.y=n}function oa(e){return ur.range(e.length)}function da(e){for(var t=-1,n=e[0].length,i=[];++t<n;)i[t]=0;return i}function sa(e){for(var t=1,a=0,l=e[0][1],r=e.length,n;t<r;++t)(n=e[t][1])>l&&(a=t,l=n);return a}function pa(e){return e.reduce(ga,0)}function ga(e,t){return e+t[1]}function ha(e,t){return ca(e,Kl(tr(t.length)/$l+1))}function ca(e,t){for(var n=-1,i=+e[0],a=(e[1]-i)/t,l=[];++n<=t;)l[n]=a*n+i;return l}function ua(e){return[ur.min(e),ur.max(e)]}function ya(e,t){return e.value-t.value}function ma(e,t){var n=e._pack_next;e._pack_next=t,t._pack_prev=e,t._pack_next=n,n._pack_prev=t}function fa(e,t){e._pack_next=t,t._pack_prev=e}function xa(e,t){var n=t.x-e.x,i=t.y-e.y,a=e.r+t.r;return .999*a*a>n*n+i*i}function _a(e){function t(e){l=nr(e.x-e.r,l),r=ir(e.x+e.r,r),o=nr(e.y-e.r,o),d=ir(e.y+e.r,d)}if((s=e.children)&&(f=s.length)){var l=1/0,r=-Infinity,o=1/0,d=-Infinity,s,p,g,h,u,y,m,f;if(s.forEach(va),p=s[0],p.x=-p.r,p.y=0,t(p),1<f&&(g=s[1],g.x=g.r,g.y=0,t(g),2<f))for(h=s[2],Sa(p,g,h),t(h),ma(p,h),p._pack_prev=h,ma(h,g),g=p._pack_next,u=3;u<f;u++){Sa(p,g,h=s[u]);var x=0,_=1,v=1;for(y=g._pack_next;y!==g;y=y._pack_next,_++)if(xa(y,h)){x=1;break}if(1==x)for(m=p._pack_prev;m!==y._pack_prev&&!xa(m,h);m=m._pack_prev,v++);x?(_<v||_==v&&g.r<p.r?fa(p,g=y):fa(p=m,g),u--):(ma(p,h),g=h,t(h))}var S=(l+r)/2,w=(o+d)/2,E=0;for(u=0;u<f;u++)h=s[u],h.x-=S,h.y-=w,E=ir(E,h.r+lr(h.x*h.x+h.y*h.y));e.r=E,s.forEach(ba)}}function va(e){e._pack_next=e._pack_prev=e}function ba(e){delete e._pack_next,delete e._pack_prev}function ka(e,t,a,l){var r=e.children;if(e.x=t+=l*e.x,e.y=a+=l*e.y,e.r*=l,r)for(var o=-1,d=r.length;++o<d;)ka(r[o],t,a,l)}function Sa(e,t,n){var i=e.r+n.r,a=t.x-e.x,l=t.y-e.y;if(i&&(a||l)){var r=t.r+n.r,o=a*a+l*l;r*=r,i*=i;var d=.5+(i-r)/(2*o),s=lr(ir(0,2*r*(i+o)-(i-=o)*i-r*r))/(2*o);n.x=e.x+d*a+s*l,n.y=e.y+d*l-s*a}else n.x=e.x+i,n.y=e.y}function wa(e,t){return e.parent==t.parent?1:2}function Ea(e){var t=e.children;return t.length?t[0]:e.t}function Ca(e){var t=e.children,i;return(i=t.length)?t[i-1]:e.t}function Aa(e,t,n){var i=n/(t.i-e.i);t.c-=i,t.s+=n,e.c+=i,t.z+=n,t.m+=n}function ja(e){for(var t=0,n=0,a=e.children,l=a.length,r;0<=--l;)r=a[l],r.z+=t,r.m+=t,t+=r.s+(n+=r.c)}function za(e,t,n){return e.a.parent===t.parent?e.a:n}function La(e){return 1+ur.max(e,function(e){return e.y})}function Ta(e){return e.reduce(function(e,t){return e+t.x},0)/e.length}function Ma(e){var t=e.children;return t&&t.length?Ma(t[0]):e}function Ra(e){var t=e.children,i;return t&&(i=t.length)?Ra(t[i-1]):e}function Na(e){return{x:e.x,y:e.y,dx:e.dx,dy:e.dy}}function Ua(e,t){var n=e.x+t[3],i=e.y+t[0],a=e.dx-t[1]-t[3],l=e.dy-t[0]-t[2];return 0>a&&(n+=a/2,a=0),0>l&&(i+=l/2,l=0),{x:n,y:i,dx:a,dy:l}}function Pa(e){var t=e[0],n=e[e.length-1];return t<n?[t,n]:[n,t]}function Da(e){return e.rangeExtent?e.rangeExtent():Pa(e.range())}function qa(e,t,n,a){var l=n(e[0],e[1]),r=a(t[0],t[1]);return function(e){return r(l(e))}}function Ha(e,t){var n=0,i=e.length-1,a=e[n],l=e[i],r;return l<a&&(r=n,n=i,i=r,r=a,a=l,l=r),e[n]=t.floor(a),e[i]=t.ceil(l),e}function Ia(e){return e?{floor:function(t){return Wl(t/e)*e},ceil:function(t){return Kl(t/e)*e}}:fd}function Fa(e,t,n,a){var l=[],r=[],i=0,o=nr(e.length,t.length)-1;for(e[o]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++i<=o;)l.push(n(e[i-1],e[i])),r.push(a(t[i-1],t[i]));return function(t){var n=ur.bisect(e,t,1,o)-1;return r[n](l[n](t))}}function Ya(e,t,n,i){function a(){var a=2<nr(e.length,t.length)?Fa:qa,d=i?Yi:Fi;return r=a(e,t,d,n),o=a(t,e,d,xi),l}function l(e){return r(e)}var r,o;return l.invert=function(e){return o(e)},l.domain=function(t){return arguments.length?(e=t.map(Number),a()):e},l.range=function(e){return arguments.length?(t=e,a()):t},l.rangeRound=function(e){return l.range(e).interpolate(Li)},l.clamp=function(e){return arguments.length?(i=e,a()):i},l.interpolate=function(e){return arguments.length?(n=e,a()):n},l.ticks=function(t){return Xa(e,t)},l.tickFormat=function(t,n){return Ba(e,t,n)},l.nice=function(t){return Za(e,t),a()},l.copy=function(){return Ya(e,t,n,i)},a()}function Oa(e,t){return ur.rebind(e,t,"range","rangeRound","interpolate","clamp")}function Za(e,t){return Ha(e,Ia(Va(e,t)[2])),Ha(e,Ia(Va(e,t)[2])),e}function Va(e,t){null==t&&(t=10);var n=Pa(e),i=n[1]-n[0],a=ar(10,Wl(tr(i/t)/er)),l=t/i*a;return .15>=l?a*=10:.35>=l?a*=5:.75>=l&&(a*=2),n[0]=Kl(n[0]/a)*a,n[1]=Wl(n[1]/a)*a+.5*a,n[2]=a,n}function Xa(e,t){return ur.range.apply(ur,Va(e,t))}function Ba(e,t,n){var i=Va(e,t);if(n){var a=lo.exec(n);if(a.shift(),"s"===a[8]){var l=ur.formatPrefix(ir(br(i[0]),br(i[1])));return a[7]||(a[7]="."+Wa(l.scale(i[2]))),a[8]="f",n=ur.format(a.join("")),function(e){return n(l.scale(e))+l.symbol}}a[7]||(a[7]="."+$a(a[8],i)),n=a.join("")}else n=",."+Wa(i[2])+"f";return ur.format(n)}function Wa(e){return-Wl(tr(e)/er+.01)}function $a(e,t){var n=Wa(t[2]);return e in xd?Bl(n-Wa(ir(br(t[0]),br(t[1]))))+ +("e"!==e):n-2*("%"===e)}function Ga(e,t,a,l){function r(e){return(a?tr(0>e?0:e):-tr(0<e?0:-e))/tr(t)}function o(e){return a?ar(t,e):-ar(t,-e)}function d(t){return e(r(t))}return d.invert=function(t){return o(e.invert(t))},d.domain=function(t){return arguments.length?(a=0<=t[0],e.domain((l=t.map(Number)).map(r)),d):l},d.base=function(n){return arguments.length?(t=+n,e.domain(l.map(r)),d):t},d.nice=function(){var t=Ha(l.map(r),a?Math:vd);return e.domain(t),l=t.map(o),d},d.ticks=function(){var e=Pa(l),d=[],s=e[0],p=e[1],g=Wl(r(s)),h=Kl(r(p)),c=t%1?2:t;if(isFinite(h-g)){if(a){for(;g<h;g++)for(var n=1;n<c;n++)d.push(o(g)*n);d.push(o(g))}else for(d.push(o(g));g++<h;)for(var n=c-1;0<n;n--)d.push(o(g)*n);for(g=0;d[g]<s;g++);for(h=d.length;d[h-1]>p;h--);d=d.slice(g,h)}return d},d.tickFormat=function(e,n){if(!arguments.length)return _d;2>arguments.length?n=_d:"function"!=typeof n&&(n=ur.format(n));var a=ir(1,t*e/d.ticks().length);return function(e){var l=e/o(dr(r(e)));return l*t<t-.5&&(l*=t),l<=a?n(e):""}},d.copy=function(){return Ga(e.copy(),t,a,l)},Oa(d,e)}function Ja(e,t,n){function i(t){return e(a(t))}var a=Qa(t),l=Qa(1/t);return i.invert=function(t){return l(e.invert(t))},i.domain=function(t){return arguments.length?(e.domain((n=t.map(Number)).map(a)),i):n},i.ticks=function(e){return Xa(n,e)},i.tickFormat=function(e,t){return Ba(n,e,t)},i.nice=function(e){return i.domain(Za(n,e))},i.exponent=function(r){return arguments.length?(a=Qa(t=r),l=Qa(1/t),e.domain(n.map(a)),i):t},i.copy=function(){return Ja(e.copy(),t,n)},Oa(i,e)}function Qa(t){return function(e){return 0>e?-ar(-e,t):ar(e,t)}}function Ka(e,t){function a(n){return o[((r.get(n)||("range"===t.t?r.set(n,e.push(n)):NaN))-1)%o.length]}function l(t,n){return ur.range(e.length).map(function(e){return t+n*e})}var r,o,d;return a.domain=function(l){if(!arguments.length)return e;e=[],r=new h;for(var o=-1,d=l.length,n;++o<d;)r.has(n=l[o])||r.set(n,e.push(n));return a[t.t].apply(a,t.a)},a.range=function(e){return arguments.length?(o=e,d=0,t={t:"range",a:arguments},a):o},a.rangePoints=function(n,i){2>arguments.length&&(i=0);var r=n[0],s=n[1],p=2>e.length?(r=(r+s)/2,0):(s-r)/(e.length-1+i);return o=l(r+p*i/2,p),d=0,t={t:"rangePoints",a:arguments},a},a.rangeRoundPoints=function(n,i){2>arguments.length&&(i=0);var r=n[0],s=n[1],p=2>e.length?(r=s=dr((r+s)/2),0):0|(s-r)/(e.length-1+i);return o=l(r+dr(p*i/2+(s-r-(e.length-1+i)*p)/2),p),d=0,t={t:"rangeRoundPoints",a:arguments},a},a.rangeBands=function(n,i,r){2>arguments.length&&(i=0),3>arguments.length&&(r=i);var s=n[1]<n[0],p=n[s-0],g=n[1-s],h=(g-p)/(e.length-i+2*r);return o=l(p+h*r,h),s&&o.reverse(),d=h*(1-i),t={t:"rangeBands",a:arguments},a},a.rangeRoundBands=function(n,i,r){2>arguments.length&&(i=0),3>arguments.length&&(r=i);var s=n[1]<n[0],p=n[s-0],g=n[1-s],h=Wl((g-p)/(e.length-i+2*r));return o=l(p+dr((g-p-(e.length-i)*h)/2),h),s&&o.reverse(),d=dr(h*(1-i)),t={t:"rangeRoundBands",a:arguments},a},a.rangeBand=function(){return d},a.rangeExtent=function(){return Pa(t.a[0])},a.copy=function(){return Ka(e,t)},a.domain(e)}function el(e,t){function n(){var n=0,l=t.length;for(a=[];++n<l;)a[n-1]=ur.quantile(e,n/l);return i}function i(e){if(!isNaN(e=+e))return t[ur.bisect(a,e)]}var a;return i.domain=function(t){return arguments.length?(e=t.map(r).filter(o).sort(l),n()):e},i.range=function(e){return arguments.length?(t=e,n()):t},i.quantiles=function(){return a},i.invertExtent=function(n){return n=t.indexOf(n),0>n?[NaN,NaN]:[0<n?a[n-1]:e[0],n<a.length?a[n]:e[e.length-1]]},i.copy=function(){return el(e,t)},n()}function tl(e,t,n){function a(t){return n[ir(0,nr(o,Wl(r*(t-e))))]}function l(){return r=n.length/(t-e),o=n.length-1,a}var r,o;return a.domain=function(n){return arguments.length?(e=+n[0],t=+n[n.length-1],l()):[e,t]},a.range=function(e){return arguments.length?(n=e,l()):n},a.invertExtent=function(t){return t=n.indexOf(t),t=0>t?NaN:t/r+e,[t,t+1/r]},a.copy=function(){return tl(e,t,n)},l()}function nl(e,t){function n(n){if(n<=n)return t[ur.bisect(e,n)]}return n.domain=function(t){return arguments.length?(e=t,n):e},n.range=function(e){return arguments.length?(t=e,n):t},n.invertExtent=function(n){return n=t.indexOf(n),[e[n-1],e[n]]},n.copy=function(){return nl(e,t)},n}function il(e){function t(e){return+e}return t.invert=t,t.domain=t.range=function(n){return arguments.length?(e=n.map(t),t):e},t.ticks=function(t){return Xa(e,t)},t.tickFormat=function(t,n){return Ba(e,t,n)},t.copy=function(){return il(e)},t}function al(){return 0}function ll(e){return e.innerRadius}function rl(e){return e.outerRadius}function ol(e){return e.startAngle}function dl(e){return e.endAngle}function sl(e){return e&&e.padAngle}function pl(e,t,n,i){return 0<(e-n)*t-(t-i)*e?0:1}function gl(e,t,n,i,a){var l=e[0]-t[0],o=e[1]-t[1],s=(a?i:-i)/lr(l*l+o*o),p=s*o,g=-s*l,h=e[0]+p,c=e[1]+g,u=t[0]+p,y=t[1]+g,m=(h+u)/2,f=(c+y)/2,x=u-h,_=y-c,v=x*x+_*_,b=n-i,r=h*y-u*c,k=(0>_?-1:1)*lr(ir(0,b*b*v-r*r)),d=(r*_-x*k)/v,S=(-r*x-_*k)/v,w=(r*_+x*k)/v,E=(-r*x+_*k)/v,C=d-m,A=S-f,j=w-m,z=E-f;return C*C+A*A>j*j+z*z&&(d=w,S=E),[[d-p,S-g],[d*n/b,S*n/b]]}function hl(e){function t(t){function p(){g.push("M",o(e(h),s))}for(var g=[],h=[],c=-1,u=t.length,n=ze(a),y=ze(l),m;++c<u;)r.call(this,m=t[c],c)?h.push([+n.call(this,m,c),+y.call(this,m,c)]):h.length&&(p(),h=[]);return h.length&&p(),g.length?g.join(""):null}var a=jn,l=zn,r=Tt,o=cl,d=o.key,s=.7;return t.x=function(e){return arguments.length?(a=e,t):a},t.y=function(e){return arguments.length?(l=e,t):l},t.defined=function(e){return arguments.length?(r=e,t):r},t.interpolate=function(e){return arguments.length?(d="function"==typeof e?o=e:(o=Cd.get(e)||cl).key,t):d},t.tension=function(e){return arguments.length?(s=e,t):s},t}function cl(e){return 1<e.length?e.join("L"):e+"Z"}function ul(e){return e.join("L")+"Z"}function yl(e){for(var t=0,a=e.length,n=e[0],l=[n[0],",",n[1]];++t<a;)l.push("V",(n=e[t])[1],"H",n[0]);return l.join("")}function ml(e){for(var t=0,a=e.length,n=e[0],l=[n[0],",",n[1]];++t<a;)l.push("H",(n=e[t])[0],"V",n[1]);return l.join("")}function fl(e,n){if(1>n.length||e.length!=n.length&&e.length!=n.length+2)return cl(e);var a=e.length!=n.length,l="",r=e[0],o=e[1],d=n[0],s=d,g=1;if(a&&(l+="Q"+(o[0]-2*d[0]/3)+","+(o[1]-2*d[1]/3)+","+o[0]+","+o[1],r=e[1],g=2),1<n.length){s=n[1],o=e[g],g++,l+="C"+(r[0]+d[0])+","+(r[1]+d[1])+","+(o[0]-s[0])+","+(o[1]-s[1])+","+o[0]+","+o[1];for(var h=2;h<n.length;h++,g++)o=e[g],s=n[h],l+="S"+(o[0]-s[0])+","+(o[1]-s[1])+","+o[0]+","+o[1]}if(a){var c=e[g];l+="Q"+(o[0]+2*s[0]/3)+","+(o[1]+2*s[1]/3)+","+c[0]+","+c[1]}return l}function xl(e,t){for(var l=[],r=(1-t)/2,a=e[0],o=e[1],d=1,s=e.length,n;++d<s;)n=a,a=o,o=e[d],l.push([r*(o[0]-n[0]),r*(o[1]-n[1])]);return l}function _l(e){if(3>e.length)return cl(e);var t=1,a=e.length,n=e[0],l=n[0],r=n[1],o=[l,l,l,(n=e[1])[0]],d=[r,r,r,n[1]],s=[l,",",r,"L",vl(zd,o),",",vl(zd,d)];for(e.push(e[a-1]);++t<=a;)n=e[t],o.shift(),o.push(n[0]),d.shift(),d.push(n[1]),bl(s,o,d);return e.pop(),s.push("L",n),s.join("")}function vl(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function bl(e,t,n){e.push("C",vl(Ad,t),",",vl(Ad,n),",",vl(jd,t),",",vl(jd,n),",",vl(zd,t),",",vl(zd,n))}function kl(e,t){return(t[1]-e[1])/(t[0]-e[0])}function Sl(e){for(var t=0,n=e.length-1,a=[],l=e[0],r=e[1],o=a[0]=kl(l,r);++t<n;)a[t]=(o+(o=kl(l=r,r=e[t+1])))/2;return a[t]=o,a}function wl(e){for(var t=[],n=Sl(e),l=-1,r=e.length-1,o,p,g,h;++l<r;)o=kl(e[l],e[l+1]),br(o)<Ur?n[l]=n[l+1]=0:(p=n[l]/o,g=n[l+1]/o,h=p*p+g*g,9<h&&(h=3*o/lr(h),n[l]=h*p,n[l+1]=h*g));for(l=-1;++l<=r;)h=(e[nr(r,l+1)][0]-e[ir(0,l-1)][0])/(6*(1+n[l]*n[l])),t.push([h||0,n[l]*h||0]);return t}function El(e){for(var t=-1,l=e.length,n,o,d;++t<l;)n=e[t],o=n[0],d=n[1]-qr,n[0]=o*or(d),n[1]=o*pr(d);return e}function Cl(e){function t(t){function g(){u.push("M",p(e(f),n),c,h(e(m.reverse()),n),"Z")}for(var u=[],m=[],f=[],_=-1,v=t.length,b=ze(a),k=ze(r),S=a===l?function(){return C}:ze(l),w=r===o?function(){return A}:ze(o),E,C,A;++_<v;)s.call(this,E=t[_],_)?(m.push([C=+b.call(this,E,_),A=+k.call(this,E,_)]),f.push([+S.call(this,E,_),+w.call(this,E,_)])):m.length&&(g(),m=[],f=[]);return m.length&&g(),u.length?u.join(""):null}var a=jn,l=jn,r=0,o=zn,s=Tt,p=cl,g=p.key,h=p,c="L",n=.7;return t.x=function(e){return arguments.length?(a=l=e,t):l},t.x0=function(e){return arguments.length?(a=e,t):a},t.x1=function(e){return arguments.length?(l=e,t):l},t.y=function(e){return arguments.length?(r=o=e,t):o},t.y0=function(e){return arguments.length?(r=e,t):r},t.y1=function(e){return arguments.length?(o=e,t):o},t.defined=function(e){return arguments.length?(s=e,t):s},t.interpolate=function(e){return arguments.length?(g="function"==typeof e?p=e:(p=Cd.get(e)||cl).key,h=p.reverse||p,c=p.closed?"M":"L",t):g},t.tension=function(e){return arguments.length?(n=e,t):n},t}function Al(e){return e.radius}function jl(e){return[e.x,e.y]}function zl(e){return function(){var t=e.apply(this,arguments),n=t[0],i=t[1]-qr;return[n*or(i),n*pr(i)]}}function Ll(){return 64}function Tl(){return"circle"}function Ml(e){var t=lr(e/i);return"M0,"+t+"A"+t+","+t+" 0 1,1 0,"+-t+"A"+t+","+t+" 0 1,1 0,"+t+"Z"}function Rl(e){return function(){var t,n,i;(t=this[e])&&(i=t[n=t.active])&&(i.timer.c=null,i.timer.t=NaN,--t.count?delete t[n]:delete this[e],t.active+=.5,i.event&&i.event.interrupt.call(this,this.__data__,i.index))}}function Nl(e,t,n){return wr(e,Nd),e.namespace=t,e.id=n,e}function Ul(e,t,n,a){var l=e.id,r=e.namespace;return X(e,"function"==typeof n?function(e,o,i){e[r][l].tween.set(t,a(n.call(e,e.__data__,o,i)))}:(n=a(n),function(e){e[r][l].tween.set(t,n)}))}function Pl(e){return null==e&&(e=""),function(){this.textContent=e}}function Dl(e){return null==e?"__transition__":"__transition_"+e+"__"}function ql(a,l,i,r,e){function t(e){var t=s.delay;return g.t=t+p,t<=e?n(e-t):void(g.c=n)}function n(e){var t=d.active,n=d[t];for(var i in n&&(n.timer.c=null,n.timer.t=NaN,--d.count,delete d[t],n.event&&n.event.interrupt.call(a,a.__data__,n.index)),d)if(+i<r){var h=d[i];h.timer.c=null,h.timer.t=NaN,--d.count,delete d[i]}g.c=o,Ne(function(){return g.c&&o(e||1)&&(g.c=null,g.t=NaN),1},0,p),d.active=r,s.event&&s.event.start.call(a,a.__data__,l),y=[],s.tween.forEach(function(e,t){(t=t.call(a,a.__data__,l))&&y.push(t)}),u=s.ease,c=s.duration}function o(o){for(var p=o/c,t=u(p),e=y.length;0<e;)y[--e].call(a,t);if(1<=p)return s.event&&s.event.end.call(a,a.__data__,l),--d.count?delete d[r]:delete a[i],1}var d=a[i]||(a[i]={active:0,count:0}),s=d[r],p,g,c,u,y;s||(p=e.time,g=Ne(t,0,p),s=d[r]={tween:new h,time:p,timer:g,delay:e.delay,duration:e.duration,ease:e.ease,index:l},e=null,++d.count)}function Hl(e,t,n){e.attr("transform",function(e){var i=t(e);return"translate("+(isFinite(i)?i:n(e))+",0)"})}function Il(e,t,n){e.attr("transform",function(e){var i=t(e);return"translate(0,"+(isFinite(i)?i:n(e))+")"})}function Fl(e){return e.toISOString()}function Yl(e,t,n){function i(t){return e(t)}function a(e,n){var a=e[1]-e[0],l=a/n,r=ur.bisect(Vd,l);return r==Vd.length?[t.year,Va(e.map(function(e){return e/31536e6}),n)[2]]:r?t[l/Vd[r-1]<Vd[r]/l?r-1:r]:[Wd,Va(e,n)[2]]}return i.invert=function(t){return Ol(e.invert(t))},i.domain=function(t){return arguments.length?(e.domain(t),i):e.domain().map(Ol)},i.nice=function(e,t){function n(n){return!isNaN(n)&&!e.range(n,Ol(+n+1),t).length}var l=i.domain(),r=Pa(l),o=null==e?a(r,10):"number"==typeof e&&a(r,e);return o&&(e=o[0],t=o[1]),i.domain(Ha(l,1<t?{floor:function(t){for(;n(t=e.floor(t));)t=Ol(t-1);return t},ceil:function(t){for(;n(t=e.ceil(t));)t=Ol(+t+1);return t}}:e))},i.ticks=function(e,t){var n=Pa(i.domain()),l=null==e?a(n,10):"number"==typeof e?a(n,e):!e.range&&[{range:e},t];return l&&(e=l[0],t=l[1]),e.range(n[0],Ol(+n[1]+1),1>t?1:t)},i.tickFormat=function(){return n},i.copy=function(){return Yl(e.copy(),t,n)},Oa(i,e)}function Ol(e){return new Date(e)}function Zl(e){return JSON.parse(e.responseText)}function Vl(e){var t=sr.createRange();return t.selectNode(sr.body),t.createContextualFragment(e.responseText)}var ur={version:"3.5.17"},n=[].slice,a=function(e){return n.call(e)},sr=this.document;if(sr)try{a(sr.documentElement.childNodes)[0].nodeType}catch(t){a=function(e){for(var t=e.length,n=Array(t);t--;)n[t]=e[t];return n}}if(Date.now||(Date.now=function(){return+new Date}),sr)try{sr.createElement("DIV").style.setProperty("opacity",0,"")}catch(e){var yr=this.Element.prototype,mr=yr.setAttribute,fr=yr.setAttributeNS,xr=this.CSSStyleDeclaration.prototype,_r=xr.setProperty;yr.setAttribute=function(e,t){mr.call(this,e,t+"")},yr.setAttributeNS=function(e,t,n){fr.call(this,e,t,n+"")},xr.setProperty=function(e,t,n){_r.call(this,e,t+"",n)}}ur.ascending=l,ur.descending=function(e,t){return t<e?-1:t>e?1:t>=e?0:NaN},ur.min=function(e,t){var l=-1,r=e.length,n,o;if(1===arguments.length){for(;++l<r;)if(null!=(o=e[l])&&o>=o){n=o;break}for(;++l<r;)null!=(o=e[l])&&n>o&&(n=o)}else{for(;++l<r;)if(null!=(o=t.call(e,e[l],l))&&o>=o){n=o;break}for(;++l<r;)null!=(o=t.call(e,e[l],l))&&n>o&&(n=o)}return n},ur.max=function(e,t){var l=-1,r=e.length,n,o;if(1===arguments.length){for(;++l<r;)if(null!=(o=e[l])&&o>=o){n=o;break}for(;++l<r;)null!=(o=e[l])&&o>n&&(n=o)}else{for(;++l<r;)if(null!=(o=t.call(e,e[l],l))&&o>=o){n=o;break}for(;++l<r;)null!=(o=t.call(e,e[l],l))&&o>n&&(n=o)}return n},ur.extent=function(e,t){var l=-1,r=e.length,n,o,d;if(1===arguments.length){for(;++l<r;)if(null!=(o=e[l])&&o>=o){n=d=o;break}for(;++l<r;)null!=(o=e[l])&&(n>o&&(n=o),d<o&&(d=o))}else{for(;++l<r;)if(null!=(o=t.call(e,e[l],l))&&o>=o){n=d=o;break}for(;++l<r;)null!=(o=t.call(e,e[l],l))&&(n>o&&(n=o),d<o&&(d=o))}return[n,d]},ur.sum=function(e,t){var l=0,r=e.length,n=-1,d;if(1===arguments.length)for(;++n<r;)o(d=+e[n])&&(l+=d);else for(;++n<r;)o(d=+t.call(e,e[n],n))&&(l+=d);return l},ur.mean=function(e,t){var l=0,d=e.length,n=-1,p=d,g;if(1===arguments.length)for(;++n<d;)o(g=r(e[n]))?l+=g:--p;else for(;++n<d;)o(g=r(t.call(e,e[n],n)))?l+=g:--p;return p?l/p:void 0},ur.quantile=function(t,n){var i=(t.length-1)*n+1,a=Wl(i),l=+t[a-1],r=i-a;return r?l+r*(t[a]-l):l},ur.median=function(e,t){var d=[],s=e.length,n=-1,p;if(1===arguments.length)for(;++n<s;)o(p=r(e[n]))&&d.push(p);else for(;++n<s;)o(p=r(t.call(e,e[n],n)))&&d.push(p);return d.length?ur.quantile(d.sort(l),.5):void 0},ur.variance=function(e,t){var l=e.length,n=0,p=0,g=-1,h=0,c,u;if(1===arguments.length)for(;++g<l;)o(c=r(e[g]))&&(u=c-n,n+=u/++h,p+=u*(c-n));else for(;++g<l;)o(c=r(t.call(e,e[g],g)))&&(u=c-n,n+=u/++h,p+=u*(c-n));return 1<h?p/(h-1):void 0},ur.deviation=function(){var e=ur.variance.apply(this,arguments);return e?lr(e):e};var vr=d(l);ur.bisectLeft=vr.left,ur.bisect=ur.bisectRight=vr.right,ur.bisector=function(e){return d(1===e.length?function(t,n){return l(e(t),n)}:e)},ur.shuffle=function(e,n,a){3>(l=arguments.length)&&(a=e.length,2>l&&(n=0));for(var l=a-n,r,o;l;)o=0|Math.random()*l--,r=e[l+n],e[l+n]=e[o+n],e[o+n]=r;return e},ur.permute=function(e,t){for(var n=t.length,a=Array(n);n--;)a[n]=e[t[n]];return a},ur.pairs=function(e){for(var t=0,a=e.length-1,n=e[0],l=Array(0>a?0:a),r;t<a;)l[t]=[r=n,n=e[++t]];return l},ur.transpose=function(e){if(!(d=e.length))return[];for(var t=-1,a=ur.min(e,s),l=Array(a);++t<a;)for(var r=-1,o=l[t]=Array(d),d;++r<d;)o[r]=e[r][t];return l},ur.zip=function(){return ur.transpose(arguments)},ur.keys=function(e){var t=[];for(var n in e)t.push(n);return t},ur.values=function(e){var t=[];for(var n in e)t.push(e[n]);return t},ur.entries=function(e){var t=[];for(var n in e)t.push({key:n,value:e[n]});return t},ur.merge=function(e){for(var t=e.length,a=-1,l=0,r,o,d;++a<t;)l+=e[a].length;for(o=Array(l);0<=--t;)for(d=e[t],r=d.length;0<=--r;)o[--l]=d[r];return o};var br=Bl;ur.range=function(e,t,n){if(3>arguments.length&&(n=1,2>arguments.length&&(t=e,e=0)),(t-e)/n==1/0)throw new Error("infinite range");var a=[],l=p(br(n)),r=-1,o;if(e*=l,t*=l,n*=l,0>n)for(;(o=e+n*++r)>t;)a.push(o/l);else for(;(o=e+n*++r)<t;)a.push(o/l);return a},ur.map=function(e,t){var a=new h;if(e instanceof h)e.forEach(function(e,t){a.set(e,t)});else if(Array.isArray(e)){var l=-1,r=e.length,n;if(1===arguments.length)for(;++l<r;)a.set(l,e[l]);else for(;++l<r;)a.set(t.call(e,n=e[l],l),n)}else for(var d in e)a.set(d,e[d]);return a};g(h,{has:y,get:function(e){return this._[c(e)]},set:function(e,t){return this._[c(e)]=t},remove:m,keys:f,values:function(){var e=[];for(var t in this._)e.push(this._[t]);return e},entries:function(){var e=[];for(var t in this._)e.push({key:u(t),value:this._[t]});return e},size:x,empty:_,forEach:function(e){for(var t in this._)e.call(this,u(t),this._[t])}}),ur.nest=function(){function e(t,r,s){if(s>=l.length)return d?d.call(a,r):o?r.sort(o):r;for(var p=-1,g=r.length,n=l[s++],c=new h,u,y,m,f;++p<g;)(f=c.get(u=n(y=r[p])))?f.push(y):c.set(u,[y]);return t?(y=t(),m=function(n,i){y.set(n,e(t,i,s))}):(y={},m=function(n,i){y[n]=e(t,i,s)}),c.forEach(m),y}function t(e,n){if(n>=l.length)return e;var i=[],o=r[n++];return e.forEach(function(e,a){i.push({key:e,values:t(a,n)})}),o?i.sort(function(e,t){return o(e.key,t.key)}):i}var a={},l=[],r=[],o,d;return a.map=function(t,n){return e(n,t,0)},a.entries=function(n){return t(e(ur.map,n,0),0)},a.key=function(e){return l.push(e),a},a.sortKeys=function(e){return r[l.length-1]=e,a},a.sortValues=function(e){return o=e,a},a.rollup=function(e){return d=e,a},a},ur.set=function(e){var t=new v;if(e)for(var a=0,l=e.length;a<l;++a)t.add(e[a]);return t},g(v,{has:y,add:function(e){return this._[c(e+="")]=!0,e},remove:m,values:f,size:x,empty:_,forEach:function(e){for(var t in this._)e.call(this,u(t))}}),ur.behavior={},ur.rebind=function(e,t){for(var a=1,l=arguments.length,n;++a<l;)e[n=arguments[a]]=k(e,t,t[n]);return e};var kr=["webkit","ms","moz","Moz","o","O"];ur.dispatch=function(){for(var e=new E,t=-1,a=arguments.length;++t<a;)e[arguments[t]]=C(e);return e},E.prototype.on=function(e,t){var n=e.indexOf("."),i="";if(0<=n&&(i=e.slice(n+1),e=e.slice(0,n)),e)return 2>arguments.length?this[e].on(i):this[e].on(i,t);if(2===arguments.length){if(null==t)for(e in this)this.hasOwnProperty(e)&&this[e].on(i,null);return this}},ur.event=null,ur.requote=function(e){return e.replace(Sr,"\\$&")};var Sr=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,wr={}.__proto__?function(e,t){e.__proto__=t}:function(e,t){for(var n in t)e[n]=t[n]},Er=function(e,t){return t.querySelector(e)},Cr=function(e,t){return t.querySelectorAll(e)},Ar=function(e,t){var i=e.matches||e[S(e,"matchesSelector")];return Ar=function(e,t){return i.call(e,t)},Ar(e,t)};"function"==typeof Sizzle&&(Er=function(e,t){return Sizzle(e,t)[0]||null},Cr=Sizzle,Ar=Sizzle.matchesSelector),ur.selection=function(){return ur.select(sr.documentElement)};var jr=ur.selection.prototype=[];jr.select=function(e){var t=[],a,l,r,o;e=T(e);for(var d=-1,s=this.length;++d<s;){t.push(a=[]),a.parentNode=(r=this[d]).parentNode;for(var p=-1,g=r.length;++p<g;)(o=r[p])?(a.push(l=e.call(o,o.__data__,p,d)),l&&"__data__"in o&&(l.__data__=o.__data__)):a.push(null)}return L(t)},jr.selectAll=function(e){var t=[],l,r;e=M(e);for(var o=-1,d=this.length;++o<d;)for(var s=this[o],p=-1,g=s.length;++p<g;)(r=s[p])&&(t.push(l=a(e.call(r,r.__data__,p,o))),l.parentNode=r);return L(t)};var zr={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};ur.ns={prefix:zr,qualify:function(e){var t=e.indexOf(":"),n=e;return 0<=t&&"xmlns"!==(n=e.slice(0,t))&&(e=e.slice(t+1)),zr.hasOwnProperty(n)?{space:zr[n],local:e}:e}},jr.attr=function(e,t){if(2>arguments.length){if("string"==typeof e){var n=this.node();return e=ur.ns.qualify(e),e.local?n.getAttributeNS(e.space,e.local):n.getAttribute(e)}for(t in e)this.each(R(t,e[t]));return this}return this.each(R(e,t))},jr.classed=function(e,t){if(2>arguments.length){if("string"==typeof e){var a=this.node(),l=(e=P(e)).length,n=-1;if(t=a.classList){for(;++n<l;)if(!t.contains(e[n]))return!1;}else for(t=a.getAttribute("class");++n<l;)if(!U(e[n]).test(t))return!1;return!0}for(t in e)this.each(D(t,e[t]));return this}return this.each(D(e,t))},jr.style=function(e,i,a){var l=arguments.length;if(3>l){if("string"!=typeof e){for(a in 2>l&&(i=""),e)this.each(H(a,e[a],i));return this}if(2>l){var n=this.node();return t(n).getComputedStyle(n,null).getPropertyValue(e)}a=""}return this.each(H(e,i,a))},jr.property=function(e,t){if(2>arguments.length){if("string"==typeof e)return this.node()[e];for(t in e)this.each(I(t,e[t]));return this}return this.each(I(e,t))},jr.text=function(e){return arguments.length?this.each("function"==typeof e?function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}:null==e?function(){this.textContent=""}:function(){this.textContent=e}):this.node().textContent},jr.html=function(e){return arguments.length?this.each("function"==typeof e?function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}:null==e?function(){this.innerHTML=""}:function(){this.innerHTML=e}):this.node().innerHTML},jr.append=function(e){return e=F(e),this.select(function(){return this.appendChild(e.apply(this,arguments))})},jr.insert=function(e,t){return e=F(e),t=T(t),this.select(function(){return this.insertBefore(e.apply(this,arguments),t.apply(this,arguments)||null)})},jr.remove=function(){return this.each(Y)},jr.data=function(e,t){function a(e,a){var l=e.length,n=a.length,r=nr(l,n),o=Array(n),d=Array(n),c=Array(l),u,y,m;if(t){var f=new h,x=Array(l),_;for(u=-1;++u<l;)(y=e[u])&&(f.has(_=t.call(y,y.__data__,u))?c[u]=y:f.set(_,y),x[u]=_);for(u=-1;++u<n;)(y=f.get(_=t.call(a,m=a[u],u)))?!0!==y&&(o[u]=y,y.__data__=m):d[u]=O(m),f.set(_,!0);for(u=-1;++u<l;)u in x&&!0!==f.get(x[u])&&(c[u]=e[u])}else{for(u=-1;++u<r;)y=e[u],m=a[u],y?(y.__data__=m,o[u]=y):d[u]=O(m);for(;u<n;++u)d[u]=O(a[u]);for(;u<l;++u)c[u]=e[u]}d.update=o,d.parentNode=o.parentNode=c.parentNode=e.parentNode,s.push(d),p.push(o),g.push(c)}var l=-1,r=this.length,o,d;if(!arguments.length){for(e=Array(r=(o=this[0]).length);++l<r;)(d=o[l])&&(e[l]=d.__data__);return e}var s=B([]),p=L([]),g=L([]);if("function"==typeof e)for(;++l<r;)a(o=this[l],e.call(o,o.parentNode.__data__,l));else for(;++l<r;)a(o=this[l],e);return p.enter=function(){return s},p.exit=function(){return g},p},jr.datum=function(e){return arguments.length?this.property("__data__",e):this.property("__data__")},jr.filter=function(e){var t=[],a,l,r;"function"!=typeof e&&(e=Z(e));for(var o=0,d=this.length;o<d;o++){t.push(a=[]),a.parentNode=(l=this[o]).parentNode;for(var s=0,p=l.length;s<p;s++)(r=l[s])&&e.call(r,r.__data__,s,o)&&a.push(r)}return L(t)},jr.order=function(){for(var e=-1,t=this.length;++e<t;)for(var n=this[e],a=n.length-1,l=n[a],r;0<=--a;)(r=n[a])&&(l&&l!==r.nextSibling&&l.parentNode.insertBefore(r,l),l=r);return this},jr.sort=function(e){e=V.apply(this,arguments);for(var t=-1,n=this.length;++t<n;)this[t].sort(e);return this.order()},jr.each=function(e){return X(this,function(t,n,i){e.call(t,t.__data__,n,i)})},jr.call=function(e){var t=a(arguments);return e.apply(t[0]=this,t),this},jr.empty=function(){return!this.node()},jr.node=function(){for(var e=0,t=this.length;e<t;e++)for(var a=this[e],l=0,r=a.length,n;l<r;l++)if(n=a[l],n)return n;return null},jr.size=function(){var e=0;return X(this,function(){++e}),e};var Lr=[];ur.selection.enter=B,ur.selection.enter.prototype=Lr,Lr.append=jr.append,Lr.empty=jr.empty,Lr.node=jr.node,Lr.call=jr.call,Lr.size=jr.size,Lr.select=function(e){for(var t=[],a=-1,l=this.length,r,o,d,s,p;++a<l;){d=(s=this[a]).update,t.push(r=[]),r.parentNode=s.parentNode;for(var g=-1,h=s.length;++g<h;)(p=s[g])?(r.push(d[g]=o=e.call(s.parentNode,p.__data__,g,a)),o.__data__=p.__data__):r.push(null)}return L(t)},Lr.insert=function(e,t){return 2>arguments.length&&(t=W(this)),jr.insert.call(this,e,t)},ur.select=function(t){var n;return"string"==typeof t?(n=[Er(t,sr)],n.parentNode=sr.documentElement):(n=[t],n.parentNode=e(t)),L([n])},ur.selectAll=function(e){var t;return"string"==typeof e?(t=a(Cr(e,sr)),t.parentNode=sr.documentElement):(t=a(e),t.parentNode=null),L([t])},jr.on=function(e,t,i){var a=arguments.length;if(3>a){if("string"!=typeof e){for(i in 2>a&&(t=!1),e)this.each($(i,e[i],t));return this}if(2>a)return(a=this.node()["__on"+e])&&a._;i=!1}return this.each($(e,t,i))};var Tr=ur.map({mouseenter:"mouseover",mouseleave:"mouseout"});sr&&Tr.forEach(function(e){"on"+e in sr&&Tr.remove(e)});var Mr=0,Rr;ur.mouse=function(e){return K(e,j())};var Nr=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;ur.touch=function(e,t,a){if(3>arguments.length&&(a=t,t=j().changedTouches),t)for(var l=0,r=t.length,n;l<r;++l)if((n=t[l]).identifier===a)return K(e,n)},ur.behavior.drag=function(){function e(){this.on("mousedown.drag",l).on("touchstart.drag",r)}function n(e,t,n,l,r){return function(){function o(){var e=t(g,u),n,i;e&&(n=e[0]-x[0],i=e[1]-x[1],c|=n|i,x=e,h({type:"drag",x:e[0]+_[0],y:e[1]+_[1],dx:n,dy:i}))}function d(){t(g,u)&&(m.on(l+y,null).on(r+y,null),f(c),h({type:"dragend"}))}var s=this,p=ur.event.target.correspondingElement||ur.event.target,g=s.parentNode,h=i.of(s,arguments),c=0,u=e(),y=".drag"+(null==u?"":"-"+u),m=ur.select(n(p)).on(l+y,o).on(r+y,d),f=Q(p),x=t(g,u),_;a?(_=a.apply(s,arguments),_=[_.x-x[0],_.y-x[1]]):_=[0,0],h({type:"dragstart"})}}var i=z(e,"drag","dragstart","dragend"),a=null,l=n(w,ur.mouse,t,"mousemove","mouseup"),r=n(ee,ur.touch,b,"touchmove","touchend");return e.origin=function(t){return arguments.length?(a=t,e):a},ur.rebind(e,i,"on")},ur.touches=function(e,t){return 2>arguments.length&&(t=j().touches),t?a(t).map(function(t){var n=K(e,t);return n.identifier=t.identifier,n}):[]};var Ur=1e-6,Pr=Ur*Ur,i=Jl,Dr=2*i,qr=i/2,Hr=i/180,Ir=180/i,Fr=Xl;ur.interpolateZoom=function(e,t){var n=e[0],a=e[1],l=e[2],r=t[0],o=t[1],d=t[2],p=r-n,g=o-a,s=p*p+g*g,h,c;if(s<Pr)c=tr(d/l)/Fr,h=function(e){return[n+e*p,a+e*g,l*gr(Fr*e*c)]};else{var y=lr(s),u=(d*d-l*l+4*s)/(2*(2*l)*y),m=(d*d-l*l-4*s)/(2*(2*d)*y),f=tr(lr(u*u+1)-u),x=tr(lr(m*m+1)-m);c=(x-f)/Fr,h=function(e){var t=e*c,i=re(f),r=l/(2*y)*(i*oe(Fr*t+f)-le(f));return[n+r*p,a+r*g,l*i/re(Fr*t+f)]}}return h.duration=1e3*c,h},ur.behavior.zoom=function(){function e(e){e.on("mousedown.zoom",h).on(Zr+".zoom",u).on("dblclick.zoom",y).on("touchstart.zoom",c)}function n(e){return[(e[0]-m.x)/m.k,(e[1]-m.y)/m.k]}function i(e){return[e[0]*m.k+m.x,e[1]*m.k+m.y]}function a(e){m.k=ir(x[0],nr(x[1],e))}function r(e,t){t=i(t),m.x+=e[0]-t[0],m.y+=e[1]-t[1]}function o(t,n,i,l){t.__chart__={x:m.x,y:m.y,k:m.k},a(ar(2,l)),r(w=n,i),t=ur.select(t),0<v&&(t=t.transition().duration(v)),t.call(e.event)}function d(){l&&l.domain(L.range().map(function(e){return(e-m.x)/m.k}).map(L.invert)),T&&T.domain(_.range().map(function(e){return(e-m.y)/m.k}).map(_.invert))}function s(e){b++||e({type:"zoomstart"})}function p(e){d(),e({type:"zoom",scale:m.k,translate:[m.x,m.y]})}function g(e){--b||(e({type:"zoomend"}),w=null)}function h(){function e(){o.on("mousemove.zoom",null).on("mouseup.zoom",null),h(l),g(a)}var i=this,a=k.of(i,arguments),l=0,o=ur.select(t(i)).on("mousemove.zoom",function(){l=1,r(ur.mouse(i),d),p(a)}).on("mouseup.zoom",e),d=n(ur.mouse(i)),h=Q(i);Rd.call(i),s(a)}function c(){function e(){var e=ur.touches(u);return C=m.k,e.forEach(function(e){e.identifier in f&&(f[e.identifier]=n(e))}),e}function t(){var t=ur.event.target;ur.select(t).on(v,l).on(b,d),S.push(t);for(var a=ur.event.changedTouches,r=0,s=a.length;r<s;++r)f[a[r].identifier]=null;var n=e(),g=Date.now();if(1===n.length){if(500>g-j){var h=n[0];o(u,h,f[h.identifier],Wl(tr(m.k)/$l)+1),A()}j=g}else if(1<n.length){var h=n[0],c=n[1],y=h[0]-c[0],_=h[1]-c[1];x=y*y+_*_}}function l(){var e=ur.touches(u),t,l,o,d;Rd.call(u);for(var s=0,g=e.length;s<g;++s,d=null)if(o=e[s],d=f[o.identifier]){if(l)break;t=o,l=d}if(d){var n=(n=o[0]-t[0])*n+(n=o[1]-t[1])*n,h=x&&lr(n/x);t=[(t[0]+o[0])/2,(t[1]+o[1])/2],l=[(l[0]+d[0])/2,(l[1]+d[1])/2],a(h*C)}j=null,r(t,l),p(y)}function d(){if(ur.event.touches.length){for(var t=ur.event.changedTouches,a=0,l=t.length;a<l;++a)delete f[t[a].identifier];for(var n in f)return void e()}ur.selectAll(S).on(_,null),w.on("mousedown.zoom",h).on("touchstart.zoom",c),E(),g(y)}var u=this,y=k.of(u,arguments),f={},x=0,_=".zoom-"+ur.event.changedTouches[0].identifier,v="touchmove"+_,b="touchend"+_,S=[],w=ur.select(u),E=Q(u),C;t(),s(y),w.on("mousedown.zoom",null).on("touchstart.zoom",t)}function u(){var e=k.of(this,arguments);C?clearTimeout(C):(Rd.call(this),S=n(w=E||ur.mouse(this)),s(e)),C=setTimeout(function(){C=null,g(e)},50),A(),a(ar(2,.002*Or())*m.k),r(w,S),p(e)}function y(){var e=ur.mouse(this),t=tr(m.k)/$l;o(this,e,n(e),ur.event.shiftKey?Kl(t)-1:Wl(t)+1)}var m={x:0,y:0,k:1},f=[960,500],x=Yr,v=250,b=0,k=z(e,"zoomstart","zoom","zoomend"),S,w,E,C,j,L,l,_,T;return Zr||(Zr="onwheel"in sr?(Or=function(){return-ur.event.deltaY*(ur.event.deltaMode?120:1)},"wheel"):"onmousewheel"in sr?(Or=function(){return ur.event.wheelDelta},"mousewheel"):(Or=function(){return-ur.event.detail},"MozMousePixelScroll")),e.event=function(e){e.each(function(){var e=k.of(this,arguments),t=m;Pd?ur.select(this).transition().each("start.zoom",function(){m=this.__chart__||{x:0,y:0,k:1},s(e)}).tween("zoom:zoom",function(){var n=f[0],a=f[1],r=w?w[0]:n/2,o=w?w[1]:a/2,d=ur.interpolateZoom([(r-m.x)/m.k,(o-m.y)/m.k,n/m.k],[(r-t.x)/t.k,(o-t.y)/t.k,n/t.k]);return function(i){var t=d(i),a=n/t[2];this.__chart__=m={x:r-t[0]*a,y:o-t[1]*a,k:a},p(e)}}).each("interrupt.zoom",function(){g(e)}).each("end.zoom",function(){g(e)}):(this.__chart__=m,s(e),p(e),g(e))})},e.translate=function(t){return arguments.length?(m={x:+t[0],y:+t[1],k:m.k},d(),e):[m.x,m.y]},e.scale=function(t){return arguments.length?(m={x:m.x,y:m.y,k:null},a(+t),d(),e):m.k},e.scaleExtent=function(t){return arguments.length?(x=null==t?Yr:[+t[0],+t[1]],e):x},e.center=function(t){return arguments.length?(E=t&&[+t[0],+t[1]],e):E},e.size=function(t){return arguments.length?(f=t&&[+t[0],+t[1]],e):f},e.duration=function(t){return arguments.length?(v=+t,e):v},e.x=function(t){return arguments.length?(l=t,L=t.copy(),m={x:0,y:0,k:1},e):l},e.y=function(t){return arguments.length?(T=t,_=t.copy(),m={x:0,y:0,k:1},e):T},ur.rebind(e,k,"on")};var Yr=[0,1/0],Or,Zr;ur.color=se,se.prototype.toString=function(){return this.rgb()+""},ur.hsl=pe;var Vr=pe.prototype=new se;Vr.brighter=function(e){return e=ar(.7,arguments.length?e:1),new pe(this.h,this.s,this.l/e)},Vr.darker=function(e){return e=ar(.7,arguments.length?e:1),new pe(this.h,this.s,e*this.l)},Vr.rgb=function(){return ge(this.h,this.s,this.l)},ur.hcl=he;var Xr=he.prototype=new se;Xr.brighter=function(e){return new he(this.h,this.c,nr(100,this.l+Br*(arguments.length?e:1)))},Xr.darker=function(e){return new he(this.h,this.c,ir(0,this.l-Br*(arguments.length?e:1)))},Xr.rgb=function(){return ce(this.h,this.c,this.l).rgb()},ur.lab=ue;var Br=18,Wr=.95047,$r=1.08883,Gr=ue.prototype=new se;Gr.brighter=function(e){return new ue(nr(100,this.l+18*(arguments.length?e:1)),this.a,this.b)},Gr.darker=function(e){return new ue(ir(0,this.l-18*(arguments.length?e:1)),this.a,this.b)},Gr.rgb=function(){return ye(this.l,this.a,this.b)},ur.rgb=ve;var Jr=ve.prototype=new se;Jr.brighter=function(e){e=ar(.7,arguments.length?e:1);var t=this.r,n=this.g,i=this.b;return t||n||i?(t&&30>t&&(t=30),n&&30>n&&(n=30),i&&30>i&&(i=30),new ve(nr(255,t/e),nr(255,n/e),nr(255,i/e))):new ve(30,30,30)},Jr.darker=function(e){return e=ar(.7,arguments.length?e:1),new ve(e*this.r,e*this.g,e*this.b)},Jr.hsl=function(){return Ee(this.r,this.g,this.b)},Jr.toString=function(){return"#"+Se(this.r)+Se(this.g)+Se(this.b)};var Qr=ur.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});Qr.forEach(function(e,t){Qr.set(e,be(t))}),ur.functor=ze,ur.xhr=Le(b),ur.dsv=function(e,t){function n(e,n,l){3>arguments.length&&(l=n,n=null);var r=Te(e,t,null==n?i:a(n),l);return r.row=function(e){return arguments.length?r.response(null==(n=e)?i:a(e)):n},r}function i(e){return n.parse(e.responseText)}function a(e){return function(t){return n.parse(t.responseText,e)}}function l(t){return t.map(r).join(e)}function r(e){return o.test(e)?"\""+e.replace(/\"/g,"\"\"")+"\"":e}var o=new RegExp("[\""+e+"\n]"),d=e.charCodeAt(0);return n.parse=function(e,t){var l;return n.parseRows(e,function(e,n){if(l)return l(e,n-1);var r=new Function("d","return {"+e.map(function(e,t){return JSON.stringify(e)+": d["+t+"]"}).join(",")+"}");l=t?function(e,n){return t(r(e),n)}:r})},n.parseRows=function(e,i){function l(){if(g>=p)return o;if(u)return u=!1,r;var t=g;if(34===e.charCodeAt(t)){for(var n=t;n++<p;)if(34===e.charCodeAt(n)){if(34!==e.charCodeAt(n+1))break;++n}g=n+2;var a=e.charCodeAt(n+1);return 13===a?(u=!0,10===e.charCodeAt(n+2)&&++g):10===a&&(u=!0),e.slice(t+1,n).replace(/""/g,"\"")}for(;g<p;){var a=e.charCodeAt(g++),l=1;if(10===a)u=!0;else if(13===a)u=!0,10===e.charCodeAt(g)&&(++g,++l);else if(a!==d)continue;return e.slice(t,g-l)}return e.slice(t)}for(var r={},o={},s=[],p=e.length,g=0,h=0,c,u;(c=l())!==o;){for(var y=[];c!==r&&c!==o;)y.push(c),c=l();i&&null==(y=i(y,h++))||s.push(y)}return s},n.format=function(t){if(Array.isArray(t[0]))return n.formatRows(t);var i=new v,a=[];return t.forEach(function(e){for(var t in e)i.has(t)||a.push(i.add(t))}),[a.map(r).join(e)].concat(t.map(function(t){return a.map(function(e){return r(t[e])}).join(e)})).join("\n")},n.formatRows=function(e){return e.map(l).join("\n")},n},ur.csv=ur.dsv(",","text/csv"),ur.tsv=ur.dsv("\t","text/tab-separated-values");var Kr=this[S(this,"requestAnimationFrame")]||function(e){setTimeout(e,17)},eo,to,no,io;ur.timer=function(){Ne.apply(this,arguments)},ur.timer.flush=function(){Pe(),De()},ur.round=function(e,t){return t?dr(e*(t=ar(10,t)))/t:dr(e)};var ao=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"].map(function(e,t){var n=ar(10,3*br(8-t));return{scale:8<t?function(e){return e/n}:function(e){return e*n},symbol:e}});ur.formatPrefix=function(e,t){var n=0;return(e=+e)&&(0>e&&(e*=-1),t&&(e=ur.round(e,qe(e,t))),n=1+Wl(1e-12+tr(e)/er),n=ir(-24,nr(24,3*Wl((n-1)/3)))),ao[8+n/3]};var lo=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,ro=ur.map({b:function(e){return e.toString(2)},c:function(e){var t=String.fromCharCode;return t(e)},o:function(e){return e.toString(8)},x:function(e){return e.toString(16)},X:function(e){return e.toString(16).toUpperCase()},g:function(e,t){return e.toPrecision(t)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},r:function(e,t){return(e=ur.round(e,qe(e,t))).toFixed(ir(0,nr(20,qe(e*(1+1e-15),t))))}}),oo=ur.time={},so=Date;Fe.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){po.setUTCDate.apply(this._,arguments)},setDay:function(){po.setUTCDay.apply(this._,arguments)},setFullYear:function(){po.setUTCFullYear.apply(this._,arguments)},setHours:function(){po.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){po.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){po.setUTCMinutes.apply(this._,arguments)},setMonth:function(){po.setUTCMonth.apply(this._,arguments)},setSeconds:function(){po.setUTCSeconds.apply(this._,arguments)},setTime:function(){po.setTime.apply(this._,arguments)}};var po=Date.prototype;oo.year=Ye(function(e){return e=oo.day(e),e.setMonth(0,1),e},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e){return e.getFullYear()}),oo.years=oo.year.range,oo.years.utc=oo.year.utc.range,oo.day=Ye(function(e){var t=new so(2e3,0);return t.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),t},function(e,t){e.setDate(e.getDate()+t)},function(e){return e.getDate()-1}),oo.days=oo.day.range,oo.days.utc=oo.day.utc.range,oo.dayOfYear=function(e){var t=oo.year(e);return Wl((e-t-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/864e5)},["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(e,t){t=7-t;var n=oo[e]=Ye(function(e){return(e=oo.day(e)).setDate(e.getDate()-(e.getDay()+t)%7),e},function(e,t){e.setDate(e.getDate()+7*Wl(t))},function(e){var n=oo.year(e).getDay();return Wl((oo.dayOfYear(e)+(n+t)%7)/7)-(n!==t)});oo[e+"s"]=n.range,oo[e+"s"].utc=n.utc.range,oo[e+"OfYear"]=function(e){var n=oo.year(e).getDay();return Wl((oo.dayOfYear(e)+(n+t)%7)/7)}}),oo.week=oo.sunday,oo.weeks=oo.sunday.range,oo.weeks.utc=oo.sunday.utc.range,oo.weekOfYear=oo.sundayOfYear;var go={"-":"",_:" ",0:"0"},ho=/^\s*\d+/,co=/^%/;ur.locale=function(e){return{numberFormat:He(e),timeFormat:Ze(e)}};var uo=ur.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});ur.format=uo.numberFormat,ur.geo={},gt.prototype={s:0,t:0,add:function(e){ht(e,this.t,yo),ht(yo.s,this.s,this),this.s?this.t+=yo.t:this.s=yo.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var yo=new gt;ur.geo.stream=function(e,t){e&&mo.hasOwnProperty(e.type)?mo[e.type](e,t):ct(e,t)};var mo={Feature:function(e,t){ct(e.geometry,t)},FeatureCollection:function(e,t){for(var a=e.features,l=-1,r=a.length;++l<r;)ct(a[l].geometry,t)}},fo={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var a=e.coordinates,l=-1,r=a.length;++l<r;)e=a[l],t.point(e[0],e[1],e[2])},LineString:function(e,t){ut(e.coordinates,t,0)},MultiLineString:function(e,t){for(var a=e.coordinates,l=-1,r=a.length;++l<r;)ut(a[l],t,0)},Polygon:function(e,t){yt(e.coordinates,t)},MultiPolygon:function(e,t){for(var a=e.coordinates,l=-1,r=a.length;++l<r;)yt(a[l],t)},GeometryCollection:function(e,t){for(var a=e.geometries,l=-1,r=a.length;++l<r;)ct(a[l],t)}};ur.geo.area=function(e){return vo=0,ur.geo.stream(e,_o),vo};var xo=new gt,_o={sphere:function(){vo+=4*i},point:w,lineStart:w,lineEnd:w,polygonStart:function(){xo.reset(),_o.lineStart=mt},polygonEnd:function(){var e=2*xo;vo+=0>e?4*i+e:e,_o.lineStart=_o.lineEnd=_o.point=w}},vo;ur.geo.bounds=function(){function e(e,t){v.push(k=[g=e,c=e]),t<h&&(h=t),t>u&&(u=t)}function t(t,n){var i=ft([t*Hr,n*Hr]);if(x){var a=_t(x,i),l=[a[1],-a[0],0],r=_t(l,a);kt(r),r=St(r);var d=t-y,p=0<d?1:-1,s=r[0]*Ir*p,m=180<br(d);if(m^(p*y<s&&s<p*t)){var f=r[1]*Ir;f>u&&(u=f)}else if(s=(s+360)%360-180,m^(p*y<s&&s<p*t)){var f=-r[1]*Ir;f<h&&(h=f)}else n<h&&(h=n),n>u&&(u=n);m?t<y?o(g,t)>o(g,c)&&(c=t):o(t,c)>o(g,c)&&(g=t):c>=g?(t<g&&(g=t),t>c&&(c=t)):t>y?o(g,t)>o(g,c)&&(c=t):o(t,c)>o(g,c)&&(g=t)}else e(t,n);x=i,y=t}function n(){p.point=t}function i(){k[0]=g,k[1]=c,p.point=e,x=null}function a(e,n){if(x){var i=e-y;_+=180<br(i)?i+(0<i?360:-360):i}else m=e,f=n;_o.point(e,n),t(e,n)}function l(){_o.lineStart()}function r(){a(m,f),_o.lineEnd(),br(_)>Ur&&(g=-(c=180)),k[0]=g,k[1]=c,x=null}function o(e,t){return 0>(t-=e)?t+360:t}function d(e,t){return e[0]-t[0]}function s(e,t){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}var p={point:e,lineStart:n,lineEnd:i,polygonStart:function(){p.point=a,p.lineStart=l,p.lineEnd=r,_=0,_o.polygonStart()},polygonEnd:function(){_o.polygonEnd(),p.point=e,p.lineStart=n,p.lineEnd=i,0>xo?(g=-(c=180),h=-(u=90)):_>Ur?u=90:_<-Ur&&(h=-90),k[0]=g,k[1]=c}},g,h,c,u,y,m,f,x,_,v,k;return function(e){u=c=-(g=h=1/0),v=[],ur.geo.stream(e,p);var t=v.length;if(t){v.sort(d);for(var l=1,r=v[0],y=[r],m;l<t;++l)m=v[l],s(m[0],r)||s(m[1],r)?(o(r[0],m[1])>o(r[0],r[1])&&(r[1]=m[1]),o(m[0],r[1])>o(r[0],r[1])&&(r[0]=m[0])):y.push(r=m);for(var f=-Infinity,t=y.length-1,l=0,r=y[t],x,m;l<=t;r=m,++l)m=y[l],(x=o(r[1],m[0]))>f&&(f=x,g=m[0],c=r[1])}return v=k=null,g===1/0||h===1/0?[[NaN,NaN],[NaN,NaN]]:[[g,h],[c,u]]}}(),ur.geo.centroid=function(e){So=wo=Eo=Co=Ao=jo=zo=Lo=To=Mo=Ro=0,ur.geo.stream(e,bo);var t=To,n=Mo,i=Ro,a=t*t+n*n+i*i;return a<Pr&&(t=jo,n=zo,i=Lo,wo<Ur&&(t=Eo,n=Co,i=Ao),a=t*t+n*n+i*i,a<Pr)?[NaN,NaN]:[rr(n,t)*Ir,ae(i/lr(a))*Ir]};var bo={sphere:w,point:Et,lineStart:At,lineEnd:jt,polygonStart:function(){bo.lineStart=zt},polygonEnd:function(){bo.lineStart=At}},ko=Ut(Tt,function(e){var t=NaN,n=NaN,a=NaN,l;return{lineStart:function(){e.lineStart(),l=1},point:function(r,o){var d=0<r?i:-i,s=br(r-t);br(s-i)<Ur?(e.point(t,n=0<(n+o)/2?qr:-qr),e.point(a,n),e.lineEnd(),e.lineStart(),e.point(d,n),e.point(r,n),l=0):a!==d&&s>=i&&(br(t-a)<Ur&&(t-=a*Ur),br(r-d)<Ur&&(r-=d*Ur),n=Ht(t,n,r,o),e.point(a,n),e.lineEnd(),e.lineStart(),e.point(d,n),l=0),e.point(t=r,n=o),a=d},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-l}}},function(e,t,n,a){var l;if(null==e)l=n*qr,a.point(-i,l),a.point(0,l),a.point(i,l),a.point(i,0),a.point(i,-l),a.point(0,-l),a.point(-i,-l),a.point(-i,0),a.point(-i,l);else if(br(e[0]-t[0])>Ur){var r=e[0]<t[0]?i:-i;l=n*r/2,a.point(-r,l),a.point(0,l),a.point(r,l)}else a.point(t[0],t[1])},[-i,-i/2]),So,wo,Eo,Co,Ao,jo,zo,Lo,To,Mo,Ro;ur.geo.clipExtent=function(){var e={stream:function(e){return l&&(l.valid=!1),l=r(e),l.valid=!0,l},extent:function(o){return arguments.length?(r=Ot(t=+o[0][0],n=+o[0][1],i=+o[1][0],a=+o[1][1]),l&&(l.valid=!1,l=null),e):[[t,n],[i,a]]}},t,n,i,a,l,r;return e.extent([[0,0],[960,500]])},(ur.geo.conicEqualArea=function(){return Zt(Vt)}).raw=Vt,ur.geo.albers=function(){return ur.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},ur.geo.albersUsa=function(){function e(e){var t=e[0],n=e[1];return r=null,(o(t,n),r)||(d(t,n),r)||s(t,n),r}var n=ur.geo.albers(),i=ur.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),a=ur.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),l={point:function(e,t){r=[e,t]}},r,o,d,s;return e.invert=function(e){var l=n.scale(),r=n.translate(),t=(e[0]-r[0])/l,o=(e[1]-r[1])/l;return(.12<=o&&.234>o&&-.425<=t&&-.214>t?i:.166<=o&&.234>o&&-.214<=t&&-.115>t?a:n).invert(e)},e.stream=function(e){var t=n.stream(e),l=i.stream(e),r=a.stream(e);return{point:function(e,n){t.point(e,n),l.point(e,n),r.point(e,n)},sphere:function(){t.sphere(),l.sphere(),r.sphere()},lineStart:function(){t.lineStart(),l.lineStart(),r.lineStart()},lineEnd:function(){t.lineEnd(),l.lineEnd(),r.lineEnd()},polygonStart:function(){t.polygonStart(),l.polygonStart(),r.polygonStart()},polygonEnd:function(){t.polygonEnd(),l.polygonEnd(),r.polygonEnd()}}},e.precision=function(t){return arguments.length?(n.precision(t),i.precision(t),a.precision(t),e):n.precision()},e.scale=function(t){return arguments.length?(n.scale(t),i.scale(.35*t),a.scale(t),e.translate(n.translate())):n.scale()},e.translate=function(t){if(!arguments.length)return n.translate();var r=n.scale(),p=+t[0],g=+t[1];return o=n.translate(t).clipExtent([[p-.455*r,g-.238*r],[p+.455*r,g+.238*r]]).stream(l).point,d=i.translate([p-.307*r,g+.201*r]).clipExtent([[p-.425*r+Ur,g+.12*r+Ur],[p-.214*r-Ur,g+.234*r-Ur]]).stream(l).point,s=a.translate([p-.205*r,g+.212*r]).clipExtent([[p-.214*r+Ur,g+.166*r+Ur],[p-.115*r-Ur,g+.234*r-Ur]]).stream(l).point,e},e.scale(1070)};var No={point:w,lineStart:w,lineEnd:w,polygonStart:function(){qo=0,No.lineStart=Xt},polygonEnd:function(){No.lineStart=No.lineEnd=No.point=w,Do+=br(qo/2)}},Uo={point:Bt,lineStart:w,lineEnd:w,polygonStart:w,polygonEnd:w},Po={point:Gt,lineStart:Jt,lineEnd:Qt,polygonStart:function(){Po.lineStart=Kt},polygonEnd:function(){Po.point=Gt,Po.lineStart=Jt,Po.lineEnd=Qt}},Do,qo,Ho,Io,Fo,Yo;ur.geo.path=function(){function e(e){return e&&("function"==typeof n&&r.pointRadius(+n.apply(this,arguments)),(!o||!o.valid)&&(o=l(r)),ur.geo.stream(e,o)),r.result()}function t(){return o=null,e}var n=4.5,i,a,l,r,o;return e.area=function(e){return Do=0,ur.geo.stream(e,l(No)),Do},e.centroid=function(e){return Eo=Co=Ao=jo=zo=Lo=To=Mo=Ro=0,ur.geo.stream(e,l(Po)),Ro?[To/Ro,Mo/Ro]:Lo?[jo/Lo,zo/Lo]:Ao?[Eo/Ao,Co/Ao]:[NaN,NaN]},e.bounds=function(e){return Fo=Yo=-(Ho=Io=1/0),ur.geo.stream(e,l(Uo)),[[Ho,Io],[Fo,Yo]]},e.projection=function(e){return arguments.length?(l=(i=e)?e.stream||nn(e):b,t()):i},e.context=function(e){return arguments.length?(r=null==(a=e)?new Wt:new en(e),"function"!=typeof n&&r.pointRadius(n),t()):a},e.pointRadius=function(t){return arguments.length?(n="function"==typeof t?t:(r.pointRadius(+t),+t),e):n},e.projection(ur.geo.albersUsa()).context(null)},ur.geo.transform=function(e){return{stream:function(t){var n=new an(t);for(var i in e)n[i]=e[i];return n}}},an.prototype={point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},ur.geo.projection=rn,ur.geo.projectionMutator=on,(ur.geo.equirectangular=function(){return rn(sn)}).raw=sn.invert=sn,ur.geo.rotation=function(e){function t(t){return t=e(t[0]*Hr,t[1]*Hr),t[0]*=Ir,t[1]*=Ir,t}return e=gn(e[0]%360*Hr,e[1]*Hr,2<e.length?e[2]*Hr:0),t.invert=function(t){return t=e.invert(t[0]*Hr,t[1]*Hr),t[0]*=Ir,t[1]*=Ir,t},t},pn.invert=sn,ur.geo.circle=function(){function e(){var e="function"==typeof t?t.apply(this,arguments):t,n=gn(-e[0]*Hr,-e[1]*Hr,0).invert,i=[];return a(null,null,1,{point:function(e,t){i.push(e=n(e,t)),e[0]*=Ir,e[1]*=Ir}}),{type:"Polygon",coordinates:[i]}}var t=[0,0],n=6,i,a;return e.origin=function(n){return arguments.length?(t=n,e):t},e.angle=function(t){return arguments.length?(a=yn((i=+t)*Hr,n*Hr),e):i},e.precision=function(t){return arguments.length?(a=yn(i*Hr,(n=+t)*Hr),e):n},e.angle(90)},ur.geo.distance=function(e,n){var i=(n[0]-e[0])*Hr,a=e[1]*Hr,l=n[1]*Hr,r=pr(i),o=or(i),d=pr(a),s=or(a),p=pr(l),g=or(l),h;return rr(lr((h=g*r)*h+(h=s*p-d*g*o)*h),d*p+s*g*o)},ur.geo.graticule=function(){function e(){return{type:"MultiLineString",coordinates:t()}}function t(){return ur.range(Kl(p/a)*a,s,a).map(v).concat(ur.range(Kl(u/l)*l,c,l).map(b)).concat(ur.range(Kl(d/n)*n,o,n).filter(function(e){return br(e%a)>Ur}).map(m)).concat(ur.range(Kl(h/i)*i,g,i).filter(function(e){return br(e%l)>Ur}).map(f))}var n=10,i=n,a=90,l=360,r=2.5,o,d,s,p,g,h,c,u,m,f,v,b;return e.lines=function(){return t().map(function(e){return{type:"LineString",coordinates:e}})},e.outline=function(){return{type:"Polygon",coordinates:[v(p).concat(b(c).slice(1),v(s).reverse().slice(1),b(u).reverse().slice(1))]}},e.extent=function(t){return arguments.length?e.majorExtent(t).minorExtent(t):e.minorExtent()},e.majorExtent=function(t){return arguments.length?(p=+t[0][0],s=+t[1][0],u=+t[0][1],c=+t[1][1],p>s&&(t=p,p=s,s=t),u>c&&(t=u,u=c,c=t),e.precision(r)):[[p,u],[s,c]]},e.minorExtent=function(t){return arguments.length?(d=+t[0][0],o=+t[1][0],h=+t[0][1],g=+t[1][1],d>o&&(t=d,d=o,o=t),h>g&&(t=h,h=g,g=t),e.precision(r)):[[d,h],[o,g]]},e.step=function(t){return arguments.length?e.majorStep(t).minorStep(t):e.minorStep()},e.majorStep=function(t){return arguments.length?(a=+t[0],l=+t[1],e):[a,l]},e.minorStep=function(t){return arguments.length?(n=+t[0],i=+t[1],e):[n,i]},e.precision=function(t){return arguments.length?(r=+t,m=fn(h,g,90),f=xn(d,o,r),v=fn(u,c,90),b=xn(p,s,r),e):r},e.majorExtent([[-180,-90+Ur],[180,90-Ur]]).minorExtent([[-180,-80-Ur],[180,80+Ur]])},ur.geo.greatArc=function(){function e(){return{type:"LineString",coordinates:[i||t.apply(this,arguments),a||n.apply(this,arguments)]}}var t=_n,n=vn,i,a;return e.distance=function(){return ur.geo.distance(i||t.apply(this,arguments),a||n.apply(this,arguments))},e.source=function(n){return arguments.length?(t=n,i="function"==typeof n?null:n,e):t},e.target=function(t){return arguments.length?(n=t,a="function"==typeof t?null:t,e):n},e.precision=function(){return arguments.length?e:0},e},ur.geo.interpolate=function(e,t){return bn(e[0]*Hr,e[1]*Hr,t[0]*Hr,t[1]*Hr)},ur.geo.length=function(e){return Vo=0,ur.geo.stream(e,Oo),Vo};var Oo={sphere:w,point:w,lineStart:function(){function e(e,l){var r=pr(l*=Hr),o=or(l),d=br((e*=Hr)-n),s=or(d);Vo+=rr(lr((d=o*pr(d))*d+(d=a*r-i*o*s)*d),i*r+a*o*s),n=e,i=r,a=o}var n,i,a;Oo.point=function(t,l){n=t*Hr,i=pr(l*=Hr),a=or(l),Oo.point=e},Oo.lineEnd=function(){Oo.point=Oo.lineEnd=w}},lineEnd:w,polygonStart:w,polygonEnd:w},Zo=kn(function(e){return lr(2/(1+e))},function(e){return 2*hr(e/2)}),Vo;(ur.geo.azimuthalEqualArea=function(){return rn(Zo)}).raw=Zo;var Xo=kn(function(e){var t=cr(e);return t&&t/pr(t)},b);(ur.geo.azimuthalEquidistant=function(){return rn(Xo)}).raw=Xo,(ur.geo.conicConformal=function(){return Zt(Sn)}).raw=Sn,(ur.geo.conicEquidistant=function(){return Zt(wn)}).raw=wn;var Bo=kn(function(e){return 1/e},Math.atan);(ur.geo.gnomonic=function(){return rn(Bo)}).raw=Bo,En.invert=function(e,t){return[e,2*Ql(gr(t))-qr]},(ur.geo.mercator=function(){return Cn(En)}).raw=En;var Wo=kn(function(){return 1},Math.asin);(ur.geo.orthographic=function(){return rn(Wo)}).raw=Wo;var $o=kn(function(e){return 1/(1+e)},function(e){return 2*Ql(e)});(ur.geo.stereographic=function(){return rn($o)}).raw=$o,An.invert=function(e,t){return[-t,2*Ql(gr(e))-qr]},(ur.geo.transverseMercator=function(){var e=Cn(An),t=e.center,n=e.rotate;return e.center=function(e){return e?t([-e[1],e[0]]):(e=t(),[e[1],-e[0]])},e.rotate=function(e){return e?n([e[0],e[1],2<e.length?e[2]+90:90]):(e=n(),[e[0],e[1],e[2]-90])},n([0,0,90])}).raw=An,ur.geom={},ur.geom.hull=function(e){function t(e){if(3>e.length)return[];var t=ze(a),r=ze(l),o=e.length,n=[],d=[],s;for(s=0;s<o;s++)n.push([+t.call(this,e[s],s),+r.call(this,e[s],s),s]);for(n.sort(Tn),s=0;s<o;s++)d.push([n[s][0],-n[s][1]]);var p=Ln(n),g=Ln(d),h=g[0]===p[0],c=g[g.length-1]===p[p.length-1],u=[];for(s=p.length-1;0<=s;--s)u.push(e[n[p[s]][2]]);for(s=+h;s<g.length-c;++s)u.push(e[n[g[s]][2]]);return u}var a=jn,l=zn;return arguments.length?t(e):(t.x=function(e){return arguments.length?(a=e,t):a},t.y=function(e){return arguments.length?(l=e,t):l},t)},ur.geom.polygon=function(e){return wr(e,Go),e};var Go=ur.geom.polygon.prototype=[];Go.area=function(){for(var e=-1,t=this.length,n=this[t-1],l=0,r;++e<t;)r=n,n=this[e],l+=r[1]*n[0]-r[0]*n[1];return .5*l},Go.centroid=function(e){var t=-1,l=this.length,n=0,r=0,o=this[l-1],d,s;for(arguments.length||(e=-1/(6*this.area()));++t<l;)d=o,o=this[t],s=d[0]*o[1]-o[0]*d[1],n+=(d[0]+o[0])*s,r+=(d[1]+o[1])*s;return[n*e,r*e]},Go.clip=function(e){for(var t=Nn(e),l=-1,r=this.length-Nn(this),n=this[r-1],o,s,p,g,h,u;++l<r;){for(o=e.slice(),e.length=0,g=this[l],h=o[(p=o.length-t)-1],s=-1;++s<p;)u=o[s],Mn(u,n,g)?(!Mn(h,n,g)&&e.push(Rn(h,u,n,g)),e.push(u)):Mn(h,n,g)&&e.push(Rn(h,u,n,g)),h=u;t&&e.push(e[0]),n=g}return e};var Jo=[],Qo=[],Ko,ed,td,nd,id;Yn.prototype.prepare=function(){for(var e=this.edges,t=e.length,n;t--;)n=e[t].edge,n.b&&n.a||e.splice(t,1);return e.sort(Zn),e.length},ei.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},ti.prototype={insert:function(e,t){var n,i,a;if(e){if(t.P=e,t.N=e.N,e.N&&(e.N.P=t),e.N=t,e.R){for(e=e.R;e.L;)e=e.L;e.L=t}else e.R=t;n=e}else this._?(e=li(this._),t.P=null,t.N=e,e.P=e.L=t,n=e):(t.P=t.N=null,this._=t,n=null);for(t.L=t.R=null,t.U=n,t.C=!0,e=t;n&&n.C;)i=n.U,n===i.L?(a=i.R,a&&a.C?(n.C=a.C=!1,i.C=!0,e=i):(e===n.R&&(ii(this,n),e=n,n=e.U),n.C=!1,i.C=!0,ai(this,i))):(a=i.L,a&&a.C?(n.C=a.C=!1,i.C=!0,e=i):(e===n.L&&(ai(this,n),e=n,n=e.U),n.C=!1,i.C=!0,ii(this,i))),n=e.U;this._.C=!1},remove:function(e){e.N&&(e.N.P=e.P),e.P&&(e.P.N=e.N),e.N=e.P=null;var t=e.U,n=e.L,i=e.R,a,l,r;if(l=n?i?li(i):n:i,t?t.L===e?t.L=l:t.R=l:this._=l,n&&i?(r=l.C,l.C=e.C,l.L=n,n.U=l,l===i?(l.U=t,t=l,e=l.R):(t=l.U,l.U=e.U,e=l.R,t.L=e,l.R=i,i.U=l)):(r=e.C,e=l),e&&(e.U=t),!r){if(e&&e.C)return void(e.C=!1);do{if(e===this._)break;if(e===t.L){if(a=t.R,a.C&&(a.C=!1,t.C=!0,ii(this,t),a=t.R),a.L&&a.L.C||a.R&&a.R.C){a.R&&a.R.C||(a.L.C=!1,a.C=!0,ai(this,a),a=t.R),a.C=t.C,t.C=a.R.C=!1,ii(this,t),e=this._;break}}else if(a=t.L,a.C&&(a.C=!1,t.C=!0,ai(this,t),a=t.L),a.L&&a.L.C||a.R&&a.R.C){a.L&&a.L.C||(a.R.C=!1,a.C=!0,ii(this,a),a=t.L),a.C=t.C,t.C=a.L.C=!1,ai(this,t),e=this._;break}a.C=!0,e=t,t=t.U}while(!e.C);e&&(e.C=!1)}}},ur.geom.voronoi=function(e){function t(e){var t=Array(e.length),a=o[0][0],l=o[0][1],r=o[1][0],d=o[1][1];return ri(n(e),o).cells.forEach(function(n,o){var i=n.edges,s=n.site,p=t[o]=i.length?i.map(function(t){var e=t.start();return[e.x,e.y]}):s.x>=a&&s.x<=r&&s.y>=l&&s.y<=d?[[a,d],[r,d],[r,l],[a,l]]:[];p.point=e[o]}),t}function n(e){return e.map(function(e,t){return{x:dr(l(e,t)/Ur)*Ur,y:dr(r(e,t)/Ur)*Ur,i:t}})}var i=jn,a=zn,l=i,r=a,o=ad;return e?t(e):(t.links=function(e){return ri(n(e)).edges.filter(function(e){return e.l&&e.r}).map(function(t){return{source:e[t.l.i],target:e[t.r.i]}})},t.triangles=function(e){var t=[];return ri(n(e)).cells.forEach(function(n,a){for(var i=n.site,l=n.edges.sort(Zn),r=-1,o=l.length,d=l[o-1].edge,s=d.l===i?d.r:d.l,p,g;++r<o;)p=d,g=s,d=l[r].edge,s=d.l===i?d.r:d.l,a<g.i&&a<s.i&&0>di(i,g,s)&&t.push([e[a],e[g.i],e[s.i]])}),t},t.x=function(e){return arguments.length?(l=ze(i=e),t):i},t.y=function(e){return arguments.length?(r=ze(a=e),t):a},t.clipExtent=function(e){return arguments.length?(o=null==e?ad:e,t):o===ad?null:o},t.size=function(e){return arguments.length?t.clipExtent(e&&[[0,0],e]):o===ad?null:o&&o[1]},t)};var ad=[[-1e6,-1e6],[1e6,1e6]];ur.geom.delaunay=function(e){return ur.geom.voronoi().triangles(e)},ur.geom.quadtree=function(e,t,a,l,r){function n(e){function g(e,t,n,i,a,l,r,o){if(!(isNaN(n)||isNaN(i)))if(e.leaf){var d=e.x,s=e.y;if(null==d)e.x=n,e.y=i,e.point=t;else if(.01>br(d-n)+br(s-i))h(e,t,n,i,a,l,r,o);else{var p=e.point;e.x=e.y=e.point=null,h(e,p,d,s,a,l,r,o),h(e,t,n,i,a,l,r,o)}}else h(e,t,n,i,a,l,r,o)}function h(e,t,a,l,r,o,d,s){var p=.5*(r+d),h=.5*(o+s),c=a>=p,u=l>=h,y=u<<1|c;e.leaf=!1,e=e.nodes[y]||(e.nodes[y]=gi()),c?r=p:d=p,u?o=h:s=h,g(e,t,a,l,r,o,d,s)}var c=ze(o),u=ze(s),y,m,f,x,_,v,b,k,S;if(null!=t)v=t,b=a,k=l,S=r;else if(k=S=-(v=b=1/0),m=[],f=[],_=e.length,p)for(x=0;x<_;++x)y=e[x],y.x<v&&(v=y.x),y.y<b&&(b=y.y),y.x>k&&(k=y.x),y.y>S&&(S=y.y),m.push(y.x),f.push(y.y);else for(x=0;x<_;++x){var w=+c(y=e[x],x),E=+u(y,x);w<v&&(v=w),E<b&&(b=E),w>k&&(k=w),E>S&&(S=E),m.push(w),f.push(E)}var C=k-v,A=S-b;C>A?S=b+C:k=v+A;var j=gi();if(j.add=function(e){g(j,e,+c(e,++x),+u(e,x),v,b,k,S)},j.visit=function(e){hi(e,j,v,b,k,S)},j.find=function(e){return ci(j,e[0],e[1],v,b,k,S)},x=-1,null==t){for(;++x<_;)g(j,e[x],m[x],f[x],v,b,k,S);--x}else e.forEach(j.add);return m=f=e=y=null,j}var o=jn,s=zn,p;return(p=arguments.length)?(o=si,s=pi,3===p&&(r=a,l=t,a=t=0),n(e)):(n.x=function(e){return arguments.length?(o=e,n):o},n.y=function(e){return arguments.length?(s=e,n):s},n.extent=function(e){return arguments.length?(null==e?t=a=l=r=null:(t=+e[0][0],a=+e[0][1],l=+e[1][0],r=+e[1][1]),n):null==t?null:[[t,a],[l,r]]},n.size=function(e){return arguments.length?(null==e?t=a=l=r=null:(t=a=0,l=+e[0],r=+e[1]),n):null==t?null:[l-t,r-a]},n)},ur.interpolateRgb=ui,ur.interpolateObject=yi,ur.interpolateNumber=mi,ur.interpolateString=fi;var ld=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,rd=new RegExp(ld.source,"g");ur.interpolate=xi,ur.interpolators=[function(e,n){var i=typeof n;return("string"==i?Qr.has(n.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(n)?ui:fi:n instanceof se?ui:Array.isArray(n)?_i:"object"==i&&isNaN(n)?yi:mi)(e,n)}],ur.interpolateArray=_i;var od=function(){return b},dd=ur.map({linear:od,poly:function(n){return function(e){return ar(e,n)}},quad:function(){return Si},cubic:function(){return wi},sin:function(){return Ci},exp:function(){return Ai},circle:function(){return ji},elastic:function(e,n){var i;return 2>arguments.length&&(n=.45),arguments.length?i=n/Dr*hr(1/e):(e=1,i=n/4),function(a){return 1+e*ar(2,-10*a)*pr((a-i)*Dr/n)}},back:function(e){return e||(e=1.70158),function(n){return n*n*((e+1)*n-e)}},bounce:function(){return zi}}),sd=ur.map({in:b,out:bi,"in-out":ki,"out-in":function(e){return ki(bi(e))}});ur.ease=function(e){var a=e.indexOf("-"),i=0<=a?e.slice(0,a):e,l=0<=a?e.slice(a+1):"in";return i=dd.get(i)||od,l=sd.get(l)||b,vi(l(i.apply(null,n.call(arguments,1))))},ur.interpolateHcl=function(e,t){e=ur.hcl(e),t=ur.hcl(t);var n=e.h,i=e.c,l=e.l,r=t.h-n,o=t.c-i,d=t.l-l;return isNaN(o)&&(o=0,i=isNaN(i)?t.c:i),isNaN(r)?(r=0,n=isNaN(n)?t.h:n):180<r?r-=360:-180>r&&(r+=360),function(e){return ce(n+r*e,i+o*e,l+d*e)+""}},ur.interpolateHsl=function(e,t){e=ur.hsl(e),t=ur.hsl(t);var n=e.h,i=e.s,l=e.l,r=t.h-n,o=t.s-i,d=t.l-l;return isNaN(o)&&(o=0,i=isNaN(i)?t.s:i),isNaN(r)?(r=0,n=isNaN(n)?t.h:n):180<r?r-=360:-180>r&&(r+=360),function(e){return ge(n+r*e,i+o*e,l+d*e)+""}},ur.interpolateLab=function(e,t){e=ur.lab(e),t=ur.lab(t);var n=e.l,i=e.a,l=e.b,r=t.l-n,o=t.a-i,d=t.b-l;return function(e){return ye(n+r*e,i+o*e,l+d*e)+""}},ur.interpolateRound=Li,ur.transform=function(e){var t=sr.createElementNS(ur.ns.prefix.svg,"g");return(ur.transform=function(e){if(null!=e){t.setAttribute("transform",e);var n=t.transform.baseVal.consolidate()}return new Ti(n?n.matrix:pd)})(e)},Ti.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var pd={a:1,b:0,c:0,d:1,e:0,f:0};ur.interpolateTransform=Ii,ur.layout={},ur.layout.bundle=function(){return function(e){for(var t=[],a=-1,l=e.length;++a<l;)t.push(Oi(e[a]));return t}},ur.layout.chord=function(){function e(){var e={},n=[],h=ur.range(d),c=[],u,y,m,f,_;for(l=[],r=[],u=0,f=-1;++f<d;){for(y=0,_=-1;++_<d;)y+=o[f][_];n.push(y),c.push(ur.range(d)),u+=y}for(s&&h.sort(function(e,t){return s(n[e],n[t])}),p&&c.forEach(function(e,t){e.sort(function(e,n){return p(o[t][e],o[t][n])})}),u=(Dr-a*d)/u,y=0,f=-1;++f<d;){for(m=y,_=-1;++_<d;){var b=h[f],S=c[b][_],w=o[b][S],v=y,E=y+=w*u;e[b+"-"+S]={index:b,subindex:S,startAngle:v,endAngle:E,value:w}}r[b]={index:b,startAngle:m,endAngle:y,value:n[b]},y+=a}for(f=-1;++f<d;)for(_=f-1;++_<d;){var C=e[f+"-"+_],A=e[_+"-"+f];(C.value||A.value)&&l.push(C.value<A.value?{source:A,target:C}:{source:C,target:A})}g&&t()}function t(){l.sort(function(e,t){return g((e.source.value+e.target.value)/2,(t.source.value+t.target.value)/2)})}var i={},a=0,l,r,o,d,s,p,g;return i.matrix=function(e){return arguments.length?(d=(o=e)&&o.length,l=r=null,i):o},i.padding=function(e){return arguments.length?(a=e,l=r=null,i):a},i.sortGroups=function(e){return arguments.length?(s=e,l=r=null,i):s},i.sortSubgroups=function(e){return arguments.length?(p=e,l=null,i):p},i.sortChords=function(e){return arguments.length?(g=e,l&&t(),i):g},i.chords=function(){return l||e(),l},i.groups=function(){return r||e(),r},i},ur.layout.force=function(){function e(e){return function(t,n,i,a){if(t.point!==e){var l=t.cx-e.x,r=t.cy-e.y,o=a-n,d=l*l+r*r;if(o*o/_<d){if(d<u){var s=t.charge/d;e.px-=l*s,e.py-=r*s}return!0}if(t.point&&d&&d<u){var s=t.pointCharge/d;e.px-=l*s,e.py-=r*s}}return!t.charge}}function t(e){e.px=ur.event.x,e.py=ur.event.y,a.resume()}var a={},r=ur.dispatch("start","tick","end"),d=[1,1],s=.9,p=gd,g=hd,c=-30,u=cd,f=.1,_=.64,v=[],S=[],w,E,C,A,j,z;return a.tick=function(){if(.005>(C*=.99))return w=null,r.end({type:"end",alpha:C=0}),!0;var a=v.length,n=S.length,p,g,h,u,m,_,b,E,L;for(g=0;g<n;++g)h=S[g],u=h.source,m=h.target,E=m.x-u.x,L=m.y-u.y,(_=E*E+L*L)&&(_=C*j[g]*((_=lr(_))-A[g])/_,E*=_,L*=_,m.x-=E*(b=u.weight+m.weight?u.weight/(u.weight+m.weight):.5),m.y-=L*b,u.x+=E*(b=1-b),u.y+=L*b);if((b=C*f)&&(E=d[0]/2,L=d[1]/2,g=-1,b))for(;++g<a;)h=v[g],h.x+=(E-h.x)*b,h.y+=(L-h.y)*b;if(c)for(Gi(p=ur.geom.quadtree(v),C,z),g=-1;++g<a;)(h=v[g]).fixed||p.visit(e(h));for(g=-1;++g<a;)h=v[g],h.fixed?(h.x=h.px,h.y=h.py):(h.x-=(h.px-(h.px=h.x))*s,h.y-=(h.py-(h.py=h.y))*s);r.tick({type:"tick",alpha:C})},a.nodes=function(e){return arguments.length?(v=e,a):v},a.links=function(e){return arguments.length?(S=e,a):S},a.size=function(e){return arguments.length?(d=e,a):d},a.linkDistance=function(e){return arguments.length?(p="function"==typeof e?e:+e,a):p},a.distance=a.linkDistance,a.linkStrength=function(e){return arguments.length?(g="function"==typeof e?e:+e,a):g},a.friction=function(e){return arguments.length?(s=+e,a):s},a.charge=function(e){return arguments.length?(c="function"==typeof e?e:+e,a):c},a.chargeDistance=function(e){return arguments.length?(u=e*e,a):lr(u)},a.gravity=function(e){return arguments.length?(f=+e,a):f},a.theta=function(e){return arguments.length?(_=e*e,a):lr(_)},a.alpha=function(e){return arguments.length?(e=+e,C?0<e?C=e:(w.c=null,w.t=NaN,w=null,r.end({type:"end",alpha:C=0})):0<e&&(r.start({type:"start",alpha:C=e}),w=Ne(a.tick)),a):C},a.start=function(){function e(e,i){if(!h){for(h=Array(t),o=0;o<t;++o)h[o]=[];for(o=0;o<n;++o){var a=S[o];h[a.source.index].push(a.target),h[a.target.index].push(a.source)}}for(var r=h[s],o=-1,d=r.length,l;++o<d;)if(!isNaN(l=r[o][e]))return l;return Math.random()*i}var t=v.length,n=S.length,l=d[0],r=d[1],s,h,u;for(s=0;s<t;++s)(u=v[s]).index=s,u.weight=0;for(s=0;s<n;++s)u=S[s],"number"==typeof u.source&&(u.source=v[u.source]),"number"==typeof u.target&&(u.target=v[u.target]),++u.source.weight,++u.target.weight;for(s=0;s<t;++s)u=v[s],isNaN(u.x)&&(u.x=e("x",l)),isNaN(u.y)&&(u.y=e("y",r)),isNaN(u.px)&&(u.px=u.x),isNaN(u.py)&&(u.py=u.y);if(A=[],"function"==typeof p)for(s=0;s<n;++s)A[s]=+p.call(this,S[s],s);else for(s=0;s<n;++s)A[s]=p;if(j=[],"function"==typeof g)for(s=0;s<n;++s)j[s]=+g.call(this,S[s],s);else for(s=0;s<n;++s)j[s]=g;if(z=[],"function"==typeof c)for(s=0;s<t;++s)z[s]=+c.call(this,v[s],s);else for(s=0;s<t;++s)z[s]=c;return a.resume()},a.resume=function(){return a.alpha(.1)},a.stop=function(){return a.alpha(0)},a.drag=function(){return E||(E=ur.behavior.drag().origin(b).on("dragstart.force",Xi).on("drag.force",t).on("dragend.force",Bi)),arguments.length?void this.on("mouseover.force",Wi).on("mouseout.force",$i).call(E):E},ur.rebind(a,r,"on")};var gd=20,hd=1,cd=1/0;ur.layout.hierarchy=function(){function e(l){var r=[l],o=[],d;for(l.depth=0;null!=(d=r.pop());)if(o.push(d),(p=i.call(e,d,d.depth))&&(s=p.length)){for(var s,p,g;0<=--s;)r.push(g=p[s]),g.parent=d,g.depth=d.depth+1;a&&(d.value=0),d.children=p}else a&&(d.value=+a.call(e,d,d.depth)||0),delete d.children;return Ki(l,function(e){var n,i;t&&(n=e.children)&&n.sort(t),a&&(i=e.parent)&&(i.value+=e.value)}),o}var t=na,i=ea,a=ta;return e.sort=function(n){return arguments.length?(t=n,e):t},e.children=function(t){return arguments.length?(i=t,e):i},e.value=function(t){return arguments.length?(a=t,e):a},e.revalue=function(t){return a&&(Qi(t,function(e){e.children&&(e.value=0)}),Ki(t,function(t){var n;t.children||(t.value=+a.call(e,t,t.depth)||0),(n=t.parent)&&(n.value+=t.value)})),t},e},ur.layout.partition=function(){function e(t,a,l,r){var o=t.children;if(t.x=a,t.y=t.depth*r,t.dx=l,t.dy=r,o&&(p=o.length)){var s=-1,p,g,h;for(l=t.value?l/t.value:0;++s<p;)e(g=o[s],a,h=g.value*l,r),a+=h}}function t(e){var a=e.children,l=0;if(a&&(o=a.length))for(var r=-1,o;++r<o;)l=ir(l,t(a[r]));return 1+l}function n(n,r){var i=a.call(this,n,r);return e(i[0],0,l[0],l[1]/t(i[0])),i}var a=ur.layout.hierarchy(),l=[1,1];return n.size=function(e){return arguments.length?(l=e,n):l},Ji(n,a)},ur.layout.pie=function(){function e(s){var g=s.length,n=s.map(function(n,a){return+t.call(e,n,a)}),h=+("function"==typeof r?r.apply(this,arguments):r),i=("function"==typeof o?o.apply(this,arguments):o)-h,c=nr(Bl(i)/g,+("function"==typeof d?d.apply(this,arguments):d)),p=c*(0>i?-1:1),u=ur.sum(n),y=u?(i-g*p)/u:0,m=ur.range(g),f=[],x;return null!=l&&m.sort(l===ud?function(e,t){return n[t]-n[e]}:function(e,t){return l(s[e],s[t])}),m.forEach(function(e){f[e]={data:s[e],value:x=n[e],startAngle:h,endAngle:h+=x*y+p,padAngle:c}}),f}var t=Number,l=ud,r=0,o=Dr,d=0;return e.value=function(n){return arguments.length?(t=n,e):t},e.sort=function(t){return arguments.length?(l=t,e):l},e.startAngle=function(t){return arguments.length?(r=t,e):r},e.endAngle=function(t){return arguments.length?(o=t,e):o},e.padAngle=function(t){return arguments.length?(d=t,e):d},e};var ud={};ur.layout.stack=function(){function e(d,s){if(!(y=d.length))return d;var p=d.map(function(n,a){return t.call(e,n,a)}),g=p.map(function(t){return t.map(function(t,a){return[o.call(e,t,a),n.call(e,t,a)]})}),h=a.call(e,g,s);p=ur.permute(p,h),g=ur.permute(g,h);var c=l.call(e,g,s),u=p[0].length,y,m,f,x;for(f=0;f<u;++f)for(r.call(e,p[0][f],x=c[f],g[0][f][1]),m=1;m<y;++m)r.call(e,p[m][f],x+=g[m-1][f][1],g[m][f][1]);return d}var t=b,a=oa,l=da,r=ra,o=aa,n=la;return e.values=function(n){return arguments.length?(t=n,e):t},e.order=function(t){return arguments.length?(a="function"==typeof t?t:yd.get(t)||oa,e):a},e.offset=function(t){return arguments.length?(l="function"==typeof t?t:md.get(t)||da,e):l},e.x=function(t){return arguments.length?(o=t,e):o},e.y=function(t){return arguments.length?(n=t,e):n},e.out=function(t){return arguments.length?(r=t,e):r},e};var yd=ur.map({"inside-out":function(e){var t=e.length,n=e.map(sa),a=e.map(pa),l=ur.range(t).sort(function(e,t){return n[e]-n[t]}),r=0,o=0,d=[],s=[],p,g;for(p=0;p<t;++p)g=l[p],r<o?(r+=a[g],d.push(g)):(o+=a[g],s.push(g));return s.reverse().concat(d)},reverse:function(e){return ur.range(e.length).reverse()},default:oa}),md=ur.map({silhouette:function(e){var t=e.length,n=e[0].length,a=[],l=0,r=[],d,s,p;for(s=0;s<n;++s){for(d=0,p=0;d<t;d++)p+=e[d][s][1];p>l&&(l=p),a.push(p)}for(s=0;s<n;++s)r[s]=(l-a[s])/2;return r},wiggle:function(e){var t=e.length,n=e[0],a=n.length,l=[],r,d,s,p,g,h,c,u,y;for(l[0]=u=y=0,d=1;d<a;++d){for(r=0,p=0;r<t;++r)p+=e[r][d][1];for(r=0,g=0,c=n[d][0]-n[d-1][0];r<t;++r){for(s=0,h=(e[r][d][1]-e[r][d-1][1])/(2*c);s<r;++s)h+=(e[s][d][1]-e[s][d-1][1])/c;g+=h*e[r][d][1]}l[d]=u-=p?g/p*c:0,u<y&&(y=u)}for(d=0;d<a;++d)l[d]-=y;return l},expand:function(e){var t=e.length,n=e[0].length,a=[],l,r,d;for(r=0;r<n;++r){for(l=0,d=0;l<t;l++)d+=e[l][r][1];if(d)for(l=0;l<t;l++)e[l][r][1]/=d;else for(l=0;l<t;l++)e[l][r][1]=1/t}for(r=0;r<n;++r)a[r]=0;return a},zero:da});ur.layout.histogram=function(){function e(e,o){for(var d=[],s=e.map(a,this),p=l.call(this,s,o),g=r.call(this,p,s,o),o=-1,h=s.length,n=g.length-1,c=t?1:1/h,u,y;++o<n;)u=d[o]=[],u.dx=g[o+1]-(u.x=g[o]),u.y=0;if(0<n)for(o=-1;++o<h;)y=s[o],y>=p[0]&&y<=p[1]&&(u=d[ur.bisect(g,y,1,n)-1],u.y+=c,u.push(e[o]));return d}var t=!0,a=Number,l=ua,r=ha;return e.value=function(t){return arguments.length?(a=t,e):a},e.range=function(t){return arguments.length?(l=ze(t),e):l},e.bins=function(t){return arguments.length?(r="number"==typeof t?function(e){return ca(e,t)}:ze(t),e):r},e.frequency=function(n){return arguments.length?(t=!!n,e):t},e},ur.layout.pack=function(){function e(e,o){var i=t.call(this,e,o),d=i[0],s=a[0],p=a[1],g=null==l?lr:"function"==typeof l?l:function(){return l};if(d.x=d.y=0,Ki(d,function(e){e.r=+g(e.value)}),Ki(d,_a),n){var r=n*(l?1:ir(2*d.r/s,2*d.r/p))/2;Ki(d,function(e){e.r+=r}),Ki(d,_a),Ki(d,function(e){e.r-=r})}return ka(d,s/2,p/2,l?1:1/ir(2*d.r/s,2*d.r/p)),i}var t=ur.layout.hierarchy().sort(ya),n=0,a=[1,1],l;return e.size=function(t){return arguments.length?(a=t,e):a},e.radius=function(t){return arguments.length?(l=null==t||"function"==typeof t?t:+t,e):l},e.padding=function(t){return arguments.length?(n=+t,e):n},Ji(e,t)},ur.layout.tree=function(){function e(e,l){var i=o.call(this,e,l),g=i[0],h=t(g);if(Ki(h,n),h.parent.m=-h.z,Qi(h,a),p)Qi(g,r);else{var c=g,u=g,y=g;Qi(g,function(e){e.x<c.x&&(c=e),e.x>u.x&&(u=e),e.depth>y.depth&&(y=e)});var m=d(c,u)/2-c.x,f=s[0]/(u.x+d(u,c)/2+m),x=s[1]/(y.depth||1);Qi(g,function(e){e.x=(e.x+m)*f,e.y=e.depth*x})}return i}function t(e){for(var t={A:null,children:[e]},a=[t],l;null!=(l=a.pop());)for(var r=l.children,o=0,d=r.length,n;o<d;++o)a.push((r[o]=n={_:r[o],parent:l,children:(n=r[o].children)&&n.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:o}).a=n);return t.children[0]}function n(e){var t=e.children,n=e.parent.children,i=e.i?n[e.i-1]:null;if(t.length){ja(e);var a=(t[0].z+t[t.length-1].z)/2;i?(e.z=i.z+d(e._,i._),e.m=e.z-a):e.z=a}else i&&(e.z=i.z+d(e._,i._));e.parent.A=l(e,i,e.parent.A||n[0])}function a(e){e._.x=e.z+e.parent.m,e.m+=e.parent.m}function l(e,t,n){if(t){for(var i=e,a=e,l=t,r=i.parent.children[0],o=i.m,s=a.m,p=l.m,g=r.m,h;l=Ca(l),i=Ea(i),l&&i;)r=Ea(r),a=Ca(a),a.a=e,h=l.z+p-i.z-o+d(l._,i._),0<h&&(Aa(za(l,e,n),e,h),o+=h,s+=h),p+=l.m,o+=i.m,g+=r.m,s+=a.m;l&&!Ca(a)&&(a.t=l,a.m+=p-s),i&&!Ea(r)&&(r.t=i,r.m+=o-g,n=e)}return n}function r(e){e.x*=s[0],e.y=e.depth*s[1]}var o=ur.layout.hierarchy().sort(null).value(null),d=wa,s=[1,1],p=null;return e.separation=function(t){return arguments.length?(d=t,e):d},e.size=function(t){return arguments.length?(p=null==(s=t)?r:null,e):p?null:s},e.nodeSize=function(t){return arguments.length?(p=null==(s=t)?null:r,e):p?s:null},Ji(e,o)},ur.layout.cluster=function(){function e(e,l){var r=t.call(this,e,l),o=r[0],d=0,s;Ki(o,function(e){var t=e.children;t&&t.length?(e.x=Ta(t),e.y=La(t)):(e.x=s?d+=n(e,s):0,e.y=0,s=e)});var p=Ma(o),g=Ra(o),h=p.x-n(p,g)/2,c=g.x+n(g,p)/2;return Ki(o,a?function(e){e.x=(e.x-o.x)*i[0],e.y=(o.y-e.y)*i[1]}:function(e){e.x=(e.x-h)/(c-h)*i[0],e.y=(1-(o.y?e.y/o.y:1))*i[1]}),r}var t=ur.layout.hierarchy().sort(null).value(null),n=wa,i=[1,1],a=!1;return e.separation=function(t){return arguments.length?(n=t,e):n},e.size=function(t){return arguments.length?(a=null==(i=t),e):a?null:i},e.nodeSize=function(t){return arguments.length?(a=null!=(i=t),e):a?i:null},Ji(e,t)},ur.layout.treemap=function(){function e(e,t){for(var a=-1,l=e.length,n,r;++a<l;)r=(n=e[a]).value*(0>t?0:t),n.area=isNaN(r)||0>=r?0:r}function t(l){var r=l.children;if(r&&r.length){var o=g(l),d=[],s=r.slice(),p=1/0,h="slice"===c?o.dx:"dice"===c?o.dy:"slice-dice"===c?1&l.depth?o.dy:o.dx:nr(o.dx,o.dy),y,m,f;for(e(s,o.dx*o.dy/l.value),d.area=0;0<(f=s.length);)d.push(y=s[f-1]),d.area+=y.area,"squarify"!==c||(m=i(d,h))<=p?(s.pop(),p=m):(d.area-=d.pop().area,a(d,h,o,!1),h=nr(o.dx,o.dy),d.length=d.area=0,p=1/0);d.length&&(a(d,h,o,!0),d.length=d.area=0),r.forEach(t)}}function n(t){var i=t.children;if(i&&i.length){var l=g(t),r=i.slice(),o=[],d;for(e(r,l.dx*l.dy/t.value),o.area=0;d=r.pop();)o.push(d),o.area+=d.area,null!=d.z&&(a(o,d.z?l.dx:l.dy,l,!r.length),o.length=o.area=0);i.forEach(n)}}function i(e,t){for(var a=e.area,l=0,o=1/0,d=-1,p=e.length,n;++d<p;)(n=e[d].area)&&(n<o&&(o=n),n>l&&(l=n));return a*=a,t*=t,a?ir(t*l*y/a,a/(t*o*y)):1/0}function a(e,t,a,l){var r=-1,s=e.length,n=a.x,p=a.y,g=t?d(e.area/t):0,h;if(t==a.dx){for((l||g>a.dy)&&(g=a.dy);++r<s;)h=e[r],h.x=n,h.y=p,h.dy=g,n+=h.dx=nr(a.x+a.dx-n,g?d(h.area/g):0);h.z=!0,h.dx+=a.x+a.dx-n,a.y+=g,a.dy-=g}else{for((l||g>a.dx)&&(g=a.dx);++r<s;)h=e[r],h.x=n,h.y=p,h.dx=g,p+=h.dy=nr(a.y+a.dy-p,g?d(h.area/g):0);h.z=!1,h.dy+=a.y+a.dy-p,a.x+=g,a.dx-=g}}function l(i){var a=m||r(i),l=a[0];return l.x=l.y=0,l.value?(l.dx=s[0],l.dy=s[1]):l.dx=l.dy=0,m&&r.revalue(l),e([l],l.dx*l.dy/l.value),(m?n:t)(l),h&&(m=a),a}var r=ur.layout.hierarchy(),d=dr,s=[1,1],p=null,g=Na,h=!1,c="squarify",y=.5*(1+lr(5)),m;return l.size=function(e){return arguments.length?(s=e,l):s},l.padding=function(e){function t(t){var n=e.call(l,t,t.depth);return null==n?Na(t):Ua(t,"number"==typeof n?[n,n,n,n]:n)}function n(t){return Ua(t,e)}if(!arguments.length)return p;var i;return g=null==(p=e)?Na:"function"==(i=typeof e)?t:"number"===i?(e=[e,e,e,e],n):n,l},l.round=function(e){return arguments.length?(d=e?dr:Number,l):d!=Number},l.sticky=function(e){return arguments.length?(h=e,m=null,l):h},l.ratio=function(e){return arguments.length?(y=e,l):y},l.mode=function(e){return arguments.length?(c=e+"",l):c},Ji(l,r)},ur.random={normal:function(e,t){var i=arguments.length;return 2>i&&(t=1),1>i&&(e=0),function(){var n,i,a;do n=2*Math.random()-1,i=2*Math.random()-1,a=n*n+i*i;while(!a||1<a);return e+t*n*lr(-2*tr(a)/a)}},logNormal:function(){var e=ur.random.normal.apply(ur,arguments);return function(){return gr(e())}},bates:function(e){var t=ur.random.irwinHall(e);return function(){return t()/e}},irwinHall:function(e){return function(){for(var t=0,n=0;n<e;n++)t+=Math.random();return t}}},ur.scale={};var fd={floor:b,ceil:b};ur.scale.linear=function(){return Ya([0,1],[0,1],xi,!1)};var xd={s:1,g:1,p:1,r:1,e:1};ur.scale.log=function(){return Ga(ur.scale.linear().domain([0,1]),10,!0,[1,10])};var _d=ur.format(".0e"),vd={floor:function(e){return-Kl(-e)},ceil:function(e){return-Wl(-e)}};ur.scale.pow=function(){return Ja(ur.scale.linear(),1,[0,1])},ur.scale.sqrt=function(){return ur.scale.pow().exponent(.5)},ur.scale.ordinal=function(){return Ka([],{t:"range",a:[[]]})},ur.scale.category10=function(){return ur.scale.ordinal().range(bd)},ur.scale.category20=function(){return ur.scale.ordinal().range(kd)},ur.scale.category20b=function(){return ur.scale.ordinal().range(Sd)},ur.scale.category20c=function(){return ur.scale.ordinal().range(wd)};var bd=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(ke),kd=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(ke),Sd=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(ke),wd=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(ke);ur.scale.quantile=function(){return el([],[])},ur.scale.quantize=function(){return tl(0,1,[0,1])},ur.scale.threshold=function(){return nl([.5],[0,1])},ur.scale.identity=function(){return il([0,1])},ur.svg={},ur.svg.arc=function(){function e(){var e=ir(0,+n.apply(this,arguments)),a=ir(0,+l.apply(this,arguments)),g=d.apply(this,arguments)-qr,h=s.apply(this,arguments)-qr,c=Bl(h-g),u=g>h?0:1;if(a<e&&(x=a,a=e,e=x),c>=Dr-Ur)return t(a,u)+(e?t(e,1-u):"")+"Z";var y=0,m=0,f=[],x,_,v,b,k,S,w,E,C,A,j,z;if((b=(+p.apply(this,arguments)||0)/2)&&(v=o===Ed?lr(e*e+a*a):+o.apply(this,arguments),!u&&(m*=-1),a&&(m=ae(v/a*pr(b))),e&&(y=ae(v/e*pr(b)))),a){k=a*or(g+m),S=a*pr(g+m),w=a*or(h-m),E=a*pr(h-m);var L=Bl(h-g-2*m)<=i?0:1;if(m&&pl(k,S,w,E)===u^L){var T=(g+h)/2;k=a*or(T),S=a*pr(T),w=E=null}}else k=S=0;if(e){C=e*or(h-y),A=e*pr(h-y),j=e*or(g+y),z=e*pr(g+y);var M=Bl(g-h+2*y)<=i?0:1;if(y&&pl(C,A,j,z)===1-u^M){var R=(g+h)/2;C=e*or(R),A=e*pr(R),j=z=null}}else C=A=0;if(c>Ur&&.001<(x=nr(Bl(a-e)/2,+r.apply(this,arguments)))){_=e<a^u?0:1;var N=x,U=x;if(c<i){var P=null==j?[C,A]:null==w?[k,S]:Rn([k,S],[j,z],[w,E],[C,A]),D=k-P[0],q=S-P[1],H=w-P[0],I=E-P[1],F=1/pr(cr((D*H+q*I)/(lr(D*D+q*q)*lr(H*H+I*I)))/2),Y=lr(P[0]*P[0]+P[1]*P[1]);U=nr(x,(e-Y)/(F-1)),N=nr(x,(a-Y)/(F+1))}if(null!=w){var O=gl(null==j?[C,A]:[j,z],[k,S],a,N,u),Z=gl([w,E],[C,A],a,N,u);x===N?f.push("M",O[0],"A",N,",",N," 0 0,",_," ",O[1],"A",a,",",a," 0 ",1-u^pl(O[1][0],O[1][1],Z[1][0],Z[1][1]),",",u," ",Z[1],"A",N,",",N," 0 0,",_," ",Z[0]):f.push("M",O[0],"A",N,",",N," 0 1,",_," ",Z[0])}else f.push("M",k,",",S);if(null!=j){var V=gl([k,S],[j,z],e,-U,u),X=gl([C,A],null==w?[k,S]:[w,E],e,-U,u);x===U?f.push("L",X[0],"A",U,",",U," 0 0,",_," ",X[1],"A",e,",",e," 0 ",u^pl(X[1][0],X[1][1],V[1][0],V[1][1]),",",1-u," ",V[1],"A",U,",",U," 0 0,",_," ",V[0]):f.push("L",X[0],"A",U,",",U," 0 0,",_," ",V[0])}else f.push("L",C,",",A)}else f.push("M",k,",",S),null!=w&&f.push("A",a,",",a," 0 ",L,",",u," ",w,",",E),f.push("L",C,",",A),null!=j&&f.push("A",e,",",e," 0 ",M,",",1-u," ",j,",",z);return f.push("Z"),f.join("")}function t(e,t){return"M0,"+e+"A"+e+","+e+" 0 1,"+t+" 0,"+-e+"A"+e+","+e+" 0 1,"+t+" 0,"+e}var n=ll,l=rl,r=al,o=Ed,d=ol,s=dl,p=sl;return e.innerRadius=function(t){return arguments.length?(n=ze(t),e):n},e.outerRadius=function(t){return arguments.length?(l=ze(t),e):l},e.cornerRadius=function(t){return arguments.length?(r=ze(t),e):r},e.padRadius=function(t){return arguments.length?(o=t==Ed?Ed:ze(t),e):o},e.startAngle=function(t){return arguments.length?(d=ze(t),e):d},e.endAngle=function(t){return arguments.length?(s=ze(t),e):s},e.padAngle=function(t){return arguments.length?(p=ze(t),e):p},e.centroid=function(){var e=(+n.apply(this,arguments)+ +l.apply(this,arguments))/2,t=(+d.apply(this,arguments)+ +s.apply(this,arguments))/2-qr;return[or(t)*e,pr(t)*e]},e};var Ed="auto";ur.svg.line=function(){return hl(b)};var Cd=ur.map({linear:cl,"linear-closed":ul,step:function(e){for(var t=0,a=e.length,n=e[0],l=[n[0],",",n[1]];++t<a;)l.push("H",(n[0]+(n=e[t])[0])/2,"V",n[1]);return 1<a&&l.push("H",n[0]),l.join("")},"step-before":yl,"step-after":ml,basis:_l,"basis-open":function(e){if(4>e.length)return cl(e);for(var t=[],a=-1,l=e.length,n=[0],r=[0],o;3>++a;)o=e[a],n.push(o[0]),r.push(o[1]);for(t.push(vl(zd,n)+","+vl(zd,r)),--a;++a<l;)o=e[a],n.shift(),n.push(o[0]),r.shift(),r.push(o[1]),bl(t,n,r);return t.join("")},"basis-closed":function(e){for(var t=-1,a=e.length,n=a+4,l=[],r=[],o,d;4>++t;)d=e[t%a],l.push(d[0]),r.push(d[1]);for(o=[vl(zd,l),",",vl(zd,r)],--t;++t<n;)d=e[t%a],l.shift(),l.push(d[0]),r.shift(),r.push(d[1]),bl(o,l,r);return o.join("")},bundle:function(e,a){var l=e.length-1;if(l)for(var n=e[0][0],r=e[0][1],o=e[l][0]-n,d=e[l][1]-r,s=-1,g,h;++s<=l;)g=e[s],h=s/l,g[0]=a*g[0]+(1-a)*(n+h*o),g[1]=a*g[1]+(1-a)*(r+h*d);return _l(e)},cardinal:function(e,t){return 3>e.length?cl(e):e[0]+fl(e,xl(e,t))},"cardinal-open":function(e,t){return 4>e.length?cl(e):e[1]+fl(e.slice(1,-1),xl(e,t))},"cardinal-closed":function(e,t){return 3>e.length?ul(e):e[0]+fl((e.push(e[0]),e),xl([e[e.length-2]].concat(e,[e[1]]),t))},monotone:function(e){return 3>e.length?cl(e):e[0]+fl(e,wl(e))}});Cd.forEach(function(e,t){t.key=e,t.closed=/-closed$/.test(e)});var Ad=[0,2/3,1/3,0],jd=[0,1/3,2/3,0],zd=[0,1/6,2/3,1/6];ur.svg.line.radial=function(){var e=hl(El);return e.radius=e.x,delete e.x,e.angle=e.y,delete e.y,e},yl.reverse=ml,ml.reverse=yl,ur.svg.area=function(){return Cl(b)},ur.svg.area.radial=function(){var e=Cl(El);return e.radius=e.x,delete e.x,e.innerRadius=e.x0,delete e.x0,e.outerRadius=e.x1,delete e.x1,e.angle=e.y,delete e.y,e.startAngle=e.y0,delete e.y0,e.endAngle=e.y1,delete e.y1,e},ur.svg.chord=function(){function e(e,d){var i=n(this,o,e,d),s=n(this,p,e,d);return"M"+i.p0+l(i.r,i.p1,i.a1-i.a0)+(a(i,s)?r(i.r,i.p1,i.r,i.p0):r(i.r,i.p1,s.r,s.p0)+l(s.r,s.p1,s.a1-s.a0)+r(s.r,s.p1,i.r,i.p0))+"Z"}function n(e,t,n,a){var i=t.call(e,n,a),l=g.call(e,i,a),r=h.call(e,i,a)-qr,o=c.call(e,i,a)-qr;return{r:l,a0:r,a1:o,p0:[l*or(r),l*pr(r)],p1:[l*or(o),l*pr(o)]}}function a(e,t){return e.a0==t.a0&&e.a1==t.a1}function l(e,t,n){return"A"+e+","+e+" 0 "+ +(n>i)+",1 "+t}function r(e,t,n,i){return"Q 0,0 "+i}var o=_n,p=vn,g=Al,h=ol,c=dl;return e.radius=function(t){return arguments.length?(g=ze(t),e):g},e.source=function(t){return arguments.length?(o=ze(t),e):o},e.target=function(t){return arguments.length?(p=ze(t),e):p},e.startAngle=function(t){return arguments.length?(h=ze(t),e):h},e.endAngle=function(t){return arguments.length?(c=ze(t),e):c},e},ur.svg.diagonal=function(){function e(e,l){var i=t.call(this,e,l),r=n.call(this,e,l),o=(i.y+r.y)/2,d=[i,{x:i.x,y:o},{x:r.x,y:o},r];return d=d.map(a),"M"+d[0]+"C"+d[1]+" "+d[2]+" "+d[3]}var t=_n,n=vn,a=jl;return e.source=function(n){return arguments.length?(t=ze(n),e):t},e.target=function(t){return arguments.length?(n=ze(t),e):n},e.projection=function(t){return arguments.length?(a=t,e):a},e},ur.svg.diagonal.radial=function(){var e=ur.svg.diagonal(),t=jl,n=e.projection;return e.projection=function(e){return arguments.length?n(zl(t=e)):t},e},ur.svg.symbol=function(){function e(e,a){return(Ld.get(t.call(this,e,a))||Ml)(n.call(this,e,a))}var t=Tl,n=Ll;return e.type=function(n){return arguments.length?(t=ze(n),e):t},e.size=function(t){return arguments.length?(n=ze(t),e):n},e};var Ld=ur.map({circle:Ml,cross:function(e){var t=lr(e/5)/2;return"M"+-3*t+","+-t+"H"+-t+"V"+-3*t+"H"+t+"V"+-t+"H"+3*t+"V"+t+"H"+t+"V"+3*t+"H"+-t+"V"+t+"H"+-3*t+"Z"},diamond:function(e){var t=lr(e/(2*Md)),n=t*Md;return"M0,"+-t+"L"+n+",0 0,"+t+" "+-n+",0Z"},square:function(e){var t=lr(e)/2;return"M"+-t+","+-t+"L"+t+","+-t+" "+t+","+t+" "+-t+","+t+"Z"},"triangle-down":function(e){var t=lr(e/Td),n=t*Td/2;return"M0,"+n+"L"+t+","+-n+" "+-t+","+-n+"Z"},"triangle-up":function(e){var t=lr(e/Td),n=t*Td/2;return"M0,"+-n+"L"+t+","+n+" "+-t+","+n+"Z"}});ur.svg.symbolTypes=Ld.keys();var Td=lr(3),Md=Gl(30*Hr);jr.transition=function(e){for(var t=Pd||++Ud,a=Dl(e),l=[],r=Dd||{time:Date.now(),ease:Ei,delay:0,duration:250},o=-1,d=this.length,s,p;++o<d;){l.push(s=[]);for(var g=this[o],h=-1,c=g.length;++h<c;)(p=g[h])&&ql(p,h,a,t,r),s.push(p)}return Nl(l,a,t)},jr.interrupt=function(e){return this.each(null==e?Rd:Rl(Dl(e)))};var Rd=Rl(Dl()),Nd=[],Ud=0,Pd,Dd;Nd.call=jr.call,Nd.empty=jr.empty,Nd.node=jr.node,Nd.size=jr.size,ur.transition=function(e,t){return e&&e.transition?Pd?e.transition(t):e:ur.selection().transition(e)},ur.transition.prototype=Nd,Nd.select=function(e){var t=this.id,a=this.namespace,l=[],r,o,d;e=T(e);for(var s=-1,p=this.length;++s<p;){l.push(r=[]);for(var g=this[s],h=-1,c=g.length;++h<c;)(d=g[h])&&(o=e.call(d,d.__data__,h,s))?("__data__"in d&&(o.__data__=d.__data__),ql(o,h,a,t,d[a][t]),r.push(o)):r.push(null)}return Nl(l,a,t)},Nd.selectAll=function(e){var t=this.id,a=this.namespace,l=[],r,d,s,p,g;e=M(e);for(var h=-1,c=this.length;++h<c;)for(var u=this[h],y=-1,m=u.length;++y<m;)if(s=u[y]){g=s[a][t],d=e.call(s,s.__data__,y,h),l.push(r=[]);for(var n=-1,f=d.length;++n<f;)(p=d[n])&&ql(p,n,a,t,g),r.push(p)}return Nl(l,a,t)},Nd.filter=function(e){var t=[],a,l,r;"function"!=typeof e&&(e=Z(e));for(var o=0,d=this.length;o<d;o++){t.push(a=[]);for(var l=this[o],s=0,p=l.length;s<p;s++)(r=l[s])&&e.call(r,r.__data__,s,o)&&a.push(r)}return Nl(t,this.namespace,this.id)},Nd.tween=function(e,t){var n=this.id,i=this.namespace;return 2>arguments.length?this.node()[i][n].tween.get(e):X(this,null==t?function(t){t[i][n].tween.remove(e)}:function(a){a[i][n].tween.set(e,t)})},Nd.attr=function(e,t){function n(){this.removeAttribute(r)}function i(){this.removeAttributeNS(r.space,r.local)}if(2>arguments.length){for(t in e)this.attr(t,e[t]);return this}var l="transform"==e?Ii:xi,r=ur.ns.qualify(e);return Ul(this,"attr."+e,t,r.local?function(e){return null==e?i:(e+="",function(){var t=this.getAttributeNS(r.space,r.local),n;return t!==e&&(n=l(t,e),function(e){this.setAttributeNS(r.space,r.local,n(e))})})}:function(e){return null==e?n:(e+="",function(){var t=this.getAttribute(r),n;return t!==e&&(n=l(t,e),function(e){this.setAttribute(r,n(e))})})})},Nd.attrTween=function(e,t){var n=ur.ns.qualify(e);return this.tween("attr."+e,n.local?function(e,a){var i=t.call(this,e,a,this.getAttributeNS(n.space,n.local));return i&&function(e){this.setAttributeNS(n.space,n.local,i(e))}}:function(e,a){var i=t.call(this,e,a,this.getAttribute(n));return i&&function(e){this.setAttribute(n,i(e))}})},Nd.style=function(e,i,a){function l(){this.style.removeProperty(e)}var r=arguments.length;if(3>r){if("string"!=typeof e){for(a in 2>r&&(i=""),e)this.style(a,e[a],i);return this}a=""}return Ul(this,"style."+e,i,function(n){return null==n?l:(n+="",function(){var l=t(this).getComputedStyle(this,null).getPropertyValue(e),r;return l!==n&&(r=xi(l,n),function(n){this.style.setProperty(e,r(n),a)})})})},Nd.styleTween=function(e,n,i){return 3>arguments.length&&(i=""),this.tween("style."+e,function(a,l){var r=n.call(this,a,l,t(this).getComputedStyle(this,null).getPropertyValue(e));return r&&function(n){this.style.setProperty(e,r(n),i)}})},Nd.text=function(e){return Ul(this,"text",e,Pl)},Nd.remove=function(){var e=this.namespace;return this.each("end.transition",function(){var t;2>this[e].count&&(t=this.parentNode)&&t.removeChild(this)})},Nd.ease=function(e){var t=this.id,n=this.namespace;return 1>arguments.length?this.node()[n][t].ease:("function"!=typeof e&&(e=ur.ease.apply(ur,arguments)),X(this,function(i){i[n][t].ease=e}))},Nd.delay=function(e){var t=this.id,n=this.namespace;return 1>arguments.length?this.node()[n][t].delay:X(this,"function"==typeof e?function(a,l,i){a[n][t].delay=+e.call(a,a.__data__,l,i)}:(e=+e,function(i){i[n][t].delay=e}))},Nd.duration=function(e){var t=this.id,n=this.namespace;return 1>arguments.length?this.node()[n][t].duration:X(this,"function"==typeof e?function(a,l,i){a[n][t].duration=ir(1,e.call(a,a.__data__,l,i))}:(e=ir(1,e),function(i){i[n][t].duration=e}))},Nd.each=function(e,t){var n=this.id,a=this.namespace;if(2>arguments.length){var i=Dd,l=Pd;try{Pd=n,X(this,function(t,l,i){Dd=t[a][n],e.call(t,t.__data__,l,i)})}finally{Dd=i,Pd=l}}else X(this,function(i){var l=i[a][n];(l.event||(l.event=ur.dispatch("start","end","interrupt"))).on(e,t)});return this},Nd.transition=function(){for(var e=this.id,t=++Ud,a=this.namespace,l=[],r=0,o=this.length,d,s,p,g;r<o;r++){l.push(d=[]);for(var s=this[r],h=0,c=s.length;h<c;h++)(p=s[h])&&(g=p[a][e],ql(p,h,a,t,{time:g.time,ease:g.ease,delay:g.delay+g.duration,duration:g.duration})),d.push(p)}return Nl(l,a,t)},ur.svg.axis=function(){function e(e){e.each(function(){var e=ur.select(this),a=this.__chart__||t,p=this.__chart__=t.copy(),g=null==d?p.ticks?p.ticks.apply(p,o):p.domain():d,h=null==s?p.tickFormat?p.tickFormat.apply(p,o):b:s,c=e.selectAll(".tick").data(g,p),u=c.enter().insert("g",".domain").attr("class","tick").style("opacity",Ur),y=ur.transition(c.exit()).style("opacity",Ur).remove(),m=ur.transition(c.order()).style("opacity",1),f=ir(i,0)+r,_=Da(p),v=e.selectAll(".domain").data([0]),k=(v.enter().append("path").attr("class","domain"),ur.transition(v)),S;u.append("line"),u.append("text");var w=u.select("line"),E=m.select("line"),C=c.select("text").text(h),A=u.select("text"),j=m.select("text"),z="top"===n||"left"===n?-1:1,L,T,M,R;if("bottom"===n||"top"===n?(S=Hl,L="x",M="y",T="x2",R="y2",C.attr("dy",0>z?"0em":".71em").style("text-anchor","middle"),k.attr("d","M"+_[0]+","+z*l+"V0H"+_[1]+"V"+z*l)):(S=Il,L="y",M="x",T="y2",R="x2",C.attr("dy",".32em").style("text-anchor",0>z?"end":"start"),k.attr("d","M"+z*l+","+_[0]+"H0V"+_[1]+"H"+z*l)),w.attr(R,z*i),A.attr(M,z*f),E.attr(T,0).attr(R,z*i),j.attr(L,0).attr(M,z*f),p.rangeBand){var N=p,x=N.rangeBand()/2;a=p=function(e){return N(e)+x}}else a.rangeBand?a=p:y.call(S,p,a);u.call(S,a,p),m.call(S,p,p)})}var t=ur.scale.linear(),n=qd,i=6,l=6,r=3,o=[10],d=null,s;return e.scale=function(n){return arguments.length?(t=n,e):t},e.orient=function(t){return arguments.length?(n=t in Hd?t+"":qd,e):n},e.ticks=function(){return arguments.length?(o=a(arguments),e):o},e.tickValues=function(t){return arguments.length?(d=t,e):d},e.tickFormat=function(t){return arguments.length?(s=t,e):s},e.tickSize=function(t){var a=arguments.length;return a?(i=+t,l=+arguments[a-1],e):i},e.innerTickSize=function(t){return arguments.length?(i=+t,e):i},e.outerTickSize=function(t){return arguments.length?(l=+t,e):l},e.tickPadding=function(t){return arguments.length?(r=+t,e):r},e.tickSubdivide=function(){return arguments.length&&e},e};var qd="bottom",Hd={top:1,right:1,bottom:1,left:1};ur.svg.brush=function(){function e(t){t.each(function(){var t=ur.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",l).on("touchstart.brush",l),r=t.selectAll(".background").data([0]);r.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),t.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var s=t.selectAll(".resize").data(c,b);s.exit().remove(),s.enter().append("g").attr("class",function(e){return"resize "+e}).style("cursor",function(e){return Id[e]}).append("rect").attr("x",function(e){return /[ew]$/.test(e)?-3:null}).attr("y",function(e){return /^[ns]/.test(e)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),s.style("display",e.empty()?"none":null);var p=ur.transition(t),g=ur.transition(r),h;o&&(h=Da(o),g.attr("x",h[0]).attr("width",h[1]-h[0]),i(p)),d&&(h=Da(d),g.attr("y",h[0]).attr("height",h[1]-h[0]),a(p)),n(p)})}function n(e){e.selectAll(".resize").attr("transform",function(e){return"translate("+s[+/e$/.test(e)]+","+p[+/^s/.test(e)]+")"})}function i(e){e.select(".extent").attr("x",s[0]),e.selectAll(".extent,.n>rect,.s>rect").attr("width",s[1]-s[0])}function a(e){e.select(".extent").attr("y",p[0]),e.selectAll(".extent,.e>rect,.w>rect").attr("height",p[1]-p[0])}function l(){function l(){32==ur.event.keyCode&&(!j&&(w=null,L[0]-=s[1],L[1]-=p[1],j=2),A())}function c(){32==ur.event.keyCode&&2==j&&(L[0]+=s[1],L[1]+=p[1],j=0,A())}function y(){var e=ur.mouse(_),t=!1;M&&(e[0]+=M[0],e[1]+=M[1]),j||(ur.event.altKey?(!w&&(w=[(s[0]+s[1])/2,(p[0]+p[1])/2]),L[0]=s[+(e[0]<w[0])],L[1]=p[+(e[1]<w[1])]):w=null),E&&f(e,o,0)&&(i(k),t=!0),C&&f(e,d,1)&&(a(k),t=!0),t&&(n(k),b({type:"brush",mode:j?"move":"resize"}))}function f(e,t,n){var i=Da(t),a=i[0],l=i[1],r=L[n],o=n?p:s,d=o[1]-o[0],c,y;if(j&&(a-=r,l-=d+r),c=(n?h:g)?ir(a,nr(l,e[n])):e[n],j?y=(c+=r)+d:(w&&(r=ir(a,nr(l,2*w[n]-c))),r<c?(y=c,c=r):y=r),o[0]!=c||o[1]!=y)return n?m=null:u=null,o[0]=c,o[1]=y,!0}function x(){y(),k.style("pointer-events","all").selectAll(".resize").style("display",e.empty()?"none":null),ur.select("body").style("cursor",null),T.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),z(),b({type:"brushend"})}var _=this,v=ur.select(ur.event.target),b=r.of(_,arguments),k=ur.select(_),S=v.datum(),E=!/^(n|s)$/.test(S)&&o,C=!/^(e|w)$/.test(S)&&d,j=v.classed("extent"),z=Q(_),L=ur.mouse(_),T=ur.select(t(_)).on("keydown.brush",l).on("keyup.brush",c),w,M;if(ur.event.changedTouches?T.on("touchmove.brush",y).on("touchend.brush",x):T.on("mousemove.brush",y).on("mouseup.brush",x),k.interrupt().selectAll("*").interrupt(),j)L[0]=s[0]-L[0],L[1]=p[0]-L[1];else if(S){var R=+/w$/.test(S),N=+/^n/.test(S);M=[s[1-R]-L[0],p[1-N]-L[1]],L[0]=s[R],L[1]=p[N]}else ur.event.altKey&&(w=L.slice());k.style("pointer-events","none").selectAll(".resize").style("display",null),ur.select("body").style("cursor",v.style("cursor")),b({type:"brushstart"}),y()}var r=z(e,"brushstart","brush","brushend"),o=null,d=null,s=[0,0],p=[0,0],g=!0,h=!0,c=Fd[0],u,m;return e.event=function(e){e.each(function(){var e=r.of(this,arguments),n={x:s,y:p,i:u,j:m},i=this.__chart__||n;this.__chart__=n,Pd?ur.select(this).transition().each("start.brush",function(){u=i.i,m=i.j,s=i.x,p=i.y,e({type:"brushstart"})}).tween("brush:brush",function(){var i=_i(s,n.x),a=_i(p,n.y);return u=m=null,function(l){s=n.x=i(l),p=n.y=a(l),e({type:"brush",mode:"resize"})}}).each("end.brush",function(){u=n.i,m=n.j,e({type:"brush",mode:"resize"}),e({type:"brushend"})}):(e({type:"brushstart"}),e({type:"brush",mode:"resize"}),e({type:"brushend"}))})},e.x=function(t){return arguments.length?(o=t,c=Fd[!o<<1|!d],e):o},e.y=function(t){return arguments.length?(d=t,c=Fd[!o<<1|!d],e):d},e.clamp=function(t){return arguments.length?(o&&d?(g=!!t[0],h=!!t[1]):o?g=!!t:d&&(h=!!t),e):o&&d?[g,h]:o?g:d?h:null},e.extent=function(n){var i,a,l,r,g;return arguments.length?(o&&(i=n[0],a=n[1],d&&(i=i[0],a=a[0]),u=[i,a],o.invert&&(i=o(i),a=o(a)),a<i&&(g=i,i=a,a=g),(i!=s[0]||a!=s[1])&&(s=[i,a])),d&&(l=n[0],r=n[1],o&&(l=l[1],r=r[1]),m=[l,r],d.invert&&(l=d(l),r=d(r)),r<l&&(g=l,l=r,r=g),(l!=p[0]||r!=p[1])&&(p=[l,r])),e):(o&&(u?(i=u[0],a=u[1]):(i=s[0],a=s[1],o.invert&&(i=o.invert(i),a=o.invert(a)),a<i&&(g=i,i=a,a=g))),d&&(m?(l=m[0],r=m[1]):(l=p[0],r=p[1],d.invert&&(l=d.invert(l),r=d.invert(r)),r<l&&(g=l,l=r,r=g))),o&&d?[[i,l],[a,r]]:o?[i,a]:d&&[l,r])},e.clear=function(){return e.empty()||(s=[0,0],p=[0,0],u=m=null),e},e.empty=function(){return!!o&&s[0]==s[1]||!!d&&p[0]==p[1]},ur.rebind(e,r,"on")};var Id={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Fd=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],Yd=oo.format=uo.timeFormat,Od=Yd.utc,Zd=Od("%Y-%m-%dT%H:%M:%S.%LZ");Yd.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?Fl:Zd,Fl.parse=function(e){var t=new Date(e);return isNaN(t)?null:t},Fl.toString=Zd.toString,oo.second=Ye(function(e){return new so(1e3*Wl(e/1e3))},function(e,t){e.setTime(e.getTime()+1e3*Wl(t))},function(e){return e.getSeconds()}),oo.seconds=oo.second.range,oo.seconds.utc=oo.second.utc.range,oo.minute=Ye(function(e){return new so(6e4*Wl(e/6e4))},function(e,t){e.setTime(e.getTime()+6e4*Wl(t))},function(e){return e.getMinutes()}),oo.minutes=oo.minute.range,oo.minutes.utc=oo.minute.utc.range,oo.hour=Ye(function(e){var t=e.getTimezoneOffset()/60;return new so(36e5*(Wl(e/36e5-t)+t))},function(e,t){e.setTime(e.getTime()+36e5*Wl(t))},function(e){return e.getHours()}),oo.hours=oo.hour.range,oo.hours.utc=oo.hour.utc.range,oo.month=Ye(function(e){return e=oo.day(e),e.setDate(1),e},function(e,t){e.setMonth(e.getMonth()+t)},function(e){return e.getMonth()}),oo.months=oo.month.range,oo.months.utc=oo.month.utc.range;var Vd=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],Xd=[[oo.second,1],[oo.second,5],[oo.second,15],[oo.second,30],[oo.minute,1],[oo.minute,5],[oo.minute,15],[oo.minute,30],[oo.hour,1],[oo.hour,3],[oo.hour,6],[oo.hour,12],[oo.day,1],[oo.day,2],[oo.week,1],[oo.month,1],[oo.month,3],[oo.year,1]],Bd=Yd.multi([[".%L",function(e){return e.getMilliseconds()}],[":%S",function(e){return e.getSeconds()}],["%I:%M",function(e){return e.getMinutes()}],["%I %p",function(e){return e.getHours()}],["%a %d",function(e){return e.getDay()&&1!=e.getDate()}],["%b %d",function(e){return 1!=e.getDate()}],["%B",function(e){return e.getMonth()}],["%Y",Tt]]),Wd={range:function(e,t,n){return ur.range(Kl(e/n)*n,+t,n).map(Ol)},floor:b,ceil:b};Xd.year=oo.year,oo.scale=function(){return Yl(ur.scale.linear(),Xd,Bd)};var $d=Xd.map(function(e){return[e[0].utc,e[1]]}),Gd=Od.multi([[".%L",function(e){return e.getUTCMilliseconds()}],[":%S",function(e){return e.getUTCSeconds()}],["%I:%M",function(e){return e.getUTCMinutes()}],["%I %p",function(e){return e.getUTCHours()}],["%a %d",function(e){return e.getUTCDay()&&1!=e.getUTCDate()}],["%b %d",function(e){return 1!=e.getUTCDate()}],["%B",function(e){return e.getUTCMonth()}],["%Y",Tt]]);$d.year=oo.year.utc,oo.scale.utc=function(){return Yl(ur.scale.linear(),$d,Gd)},ur.text=Le(function(e){return e.responseText}),ur.json=function(e,t){return Te(e,"application/json",Zl,t)},ur.html=function(e,t){return Te(e,"text/html",Vl,t)},ur.xml=Le(function(e){return e.responseXML}),"function"==typeof define&&define.amd?(this.d3=ur,define(ur)):"object"==typeof module&&module.exports?module.exports=ur:this.d3=ur}();
// Snap.svg 0.5.0
//
// Copyright (c) 2013  2017 Adobe Systems Incorporated. All rights reserved.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
// http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.
//
// build: 2017-02-06

!function(a){var b,c,d="0.5.0",e="hasOwnProperty",f=/[\.\/]/,g=/\s*,\s*/,h="*",i=function(a,b){return a-b},j={n:{}},k=function(){for(var a=0,b=this.length;b>a;a++)if("undefined"!=typeof this[a])return this[a]},l=function(){for(var a=this.length;--a;)if("undefined"!=typeof this[a])return this[a]},m=Object.prototype.toString,n=String,o=Array.isArray||function(a){return a instanceof Array||"[object Array]"==m.call(a)};eve=function(a,d){var e,f=c,g=Array.prototype.slice.call(arguments,2),h=eve.listeners(a),j=0,m=[],n={},o=[],p=b;o.firstDefined=k,o.lastDefined=l,b=a,c=0;for(var q=0,r=h.length;r>q;q++)"zIndex"in h[q]&&(m.push(h[q].zIndex),h[q].zIndex<0&&(n[h[q].zIndex]=h[q]));for(m.sort(i);m[j]<0;)if(e=n[m[j++]],o.push(e.apply(d,g)),c)return c=f,o;for(q=0;r>q;q++)if(e=h[q],"zIndex"in e)if(e.zIndex==m[j]){if(o.push(e.apply(d,g)),c)break;do if(j++,e=n[m[j]],e&&o.push(e.apply(d,g)),c)break;while(e)}else n[e.zIndex]=e;else if(o.push(e.apply(d,g)),c)break;return c=f,b=p,o},eve._events=j,eve.listeners=function(a){var b,c,d,e,g,i,k,l,m=o(a)?a:a.split(f),n=j,p=[n],q=[];for(e=0,g=m.length;g>e;e++){for(l=[],i=0,k=p.length;k>i;i++)for(n=p[i].n,c=[n[m[e]],n[h]],d=2;d--;)b=c[d],b&&(l.push(b),q=q.concat(b.f||[]));p=l}return q},eve.separator=function(a){a?(a=n(a).replace(/(?=[\.\^\]\[\-])/g,"\\"),a="["+a+"]",f=new RegExp(a)):f=/[\.\/]/},eve.on=function(a,b){if("function"!=typeof b)return function(){};for(var c=o(a)?o(a[0])?a:[a]:n(a).split(g),d=0,e=c.length;e>d;d++)!function(a){for(var c,d=o(a)?a:n(a).split(f),e=j,g=0,h=d.length;h>g;g++)e=e.n,e=e.hasOwnProperty(d[g])&&e[d[g]]||(e[d[g]]={n:{}});for(e.f=e.f||[],g=0,h=e.f.length;h>g;g++)if(e.f[g]==b){c=!0;break}!c&&e.f.push(b)}(c[d]);return function(a){+a==+a&&(b.zIndex=+a)}},eve.f=function(a){var b=[].slice.call(arguments,1);return function(){eve.apply(null,[a,null].concat(b).concat([].slice.call(arguments,0)))}},eve.stop=function(){c=1},eve.nt=function(a){var c=o(b)?b.join("."):b;return a?new RegExp("(?:\\.|\\/|^)"+a+"(?:\\.|\\/|$)").test(c):c},eve.nts=function(){return o(b)?b:b.split(f)},eve.off=eve.unbind=function(a,b){if(!a)return void(eve._events=j={n:{}});var c=o(a)?o(a[0])?a:[a]:n(a).split(g);if(c.length>1)for(var d=0,i=c.length;i>d;d++)eve.off(c[d],b);else{c=o(a)?a:n(a).split(f);var k,l,m,d,i,p,q,r=[j],s=[];for(d=0,i=c.length;i>d;d++)for(p=0;p<r.length;p+=m.length-2){if(m=[p,1],k=r[p].n,c[d]!=h)k[c[d]]&&(m.push(k[c[d]]),s.unshift({n:k,name:c[d]}));else for(l in k)k[e](l)&&(m.push(k[l]),s.unshift({n:k,name:l}));r.splice.apply(r,m)}for(d=0,i=r.length;i>d;d++)for(k=r[d];k.n;){if(b){if(k.f){for(p=0,q=k.f.length;q>p;p++)if(k.f[p]==b){k.f.splice(p,1);break}!k.f.length&&delete k.f}for(l in k.n)if(k.n[e](l)&&k.n[l].f){var t=k.n[l].f;for(p=0,q=t.length;q>p;p++)if(t[p]==b){t.splice(p,1);break}!t.length&&delete k.n[l].f}}else{delete k.f;for(l in k.n)k.n[e](l)&&k.n[l].f&&delete k.n[l].f}k=k.n}a:for(d=0,i=s.length;i>d;d++){k=s[d];for(l in k.n[k.name].f)continue a;for(l in k.n[k.name].n)continue a;delete k.n[k.name]}}},eve.once=function(a,b){var c=function(){return eve.off(a,c),b.apply(this,arguments)};return eve.on(a,c)},eve.version=d,eve.toString=function(){return"You are running Eve "+d},"undefined"!=typeof module&&module.exports?module.exports=eve:"function"==typeof define&&define.amd?define("eve",[],function(){return eve}):a.eve=eve}(this),function(a,b){if("function"==typeof define&&define.amd)define(["eve"],function(c){return b(a,c)});else if("undefined"!=typeof exports){var c=require("eve");module.exports=b(a,c)}else b(a,a.eve)}(window||this,function(a,b){var c=function(b){var c,d={},e=a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame||a.oRequestAnimationFrame||a.msRequestAnimationFrame||function(a){return setTimeout(a,16,(new Date).getTime()),!0},f=Array.isArray||function(a){return a instanceof Array||"[object Array]"==Object.prototype.toString.call(a)},g=0,h="M"+(+new Date).toString(36),i=function(){return h+(g++).toString(36)},j=Date.now||function(){return+new Date},k=function(a){var b=this;if(null==a)return b.s;var c=b.s-a;b.b+=b.dur*c,b.B+=b.dur*c,b.s=a},l=function(a){var b=this;return null==a?b.spd:void(b.spd=a)},m=function(a){var b=this;return null==a?b.dur:(b.s=b.s*a/b.dur,void(b.dur=a))},n=function(){var a=this;delete d[a.id],a.update(),b("mina.stop."+a.id,a)},o=function(){var a=this;a.pdif||(delete d[a.id],a.update(),a.pdif=a.get()-a.b)},p=function(){var a=this;a.pdif&&(a.b=a.get()-a.pdif,delete a.pdif,d[a.id]=a,r())},q=function(){var a,b=this;if(f(b.start)){a=[];for(var c=0,d=b.start.length;d>c;c++)a[c]=+b.start[c]+(b.end[c]-b.start[c])*b.easing(b.s)}else a=+b.start+(b.end-b.start)*b.easing(b.s);b.set(a)},r=function(a){if(!a)return void(c||(c=e(r)));var f=0;for(var g in d)if(d.hasOwnProperty(g)){var h=d[g],i=h.get();f++,h.s=(i-h.b)/(h.dur/h.spd),h.s>=1&&(delete d[g],h.s=1,f--,function(a){setTimeout(function(){b("mina.finish."+a.id,a)})}(h)),h.update()}c=f?e(r):!1},s=function(a,b,c,e,f,g,h){var j={id:i(),start:a,end:b,b:c,s:0,dur:e-c,spd:1,get:f,set:g,easing:h||s.linear,status:k,speed:l,duration:m,stop:n,pause:o,resume:p,update:q};d[j.id]=j;var t,u=0;for(t in d)if(d.hasOwnProperty(t)&&(u++,2==u))break;return 1==u&&r(),j};return s.time=j,s.getById=function(a){return d[a]||null},s.linear=function(a){return a},s.easeout=function(a){return Math.pow(a,1.7)},s.easein=function(a){return Math.pow(a,.48)},s.easeinout=function(a){if(1==a)return 1;if(0==a)return 0;var b=.48-a/1.04,c=Math.sqrt(.1734+b*b),d=c-b,e=Math.pow(Math.abs(d),1/3)*(0>d?-1:1),f=-c-b,g=Math.pow(Math.abs(f),1/3)*(0>f?-1:1),h=e+g+.5;return 3*(1-h)*h*h+h*h*h},s.backin=function(a){if(1==a)return 1;var b=1.70158;return a*a*((b+1)*a-b)},s.backout=function(a){if(0==a)return 0;a-=1;var b=1.70158;return a*a*((b+1)*a+b)+1},s.elastic=function(a){return a==!!a?a:Math.pow(2,-10*a)*Math.sin((a-.075)*(2*Math.PI)/.3)+1},s.bounce=function(a){var b,c=7.5625,d=2.75;return 1/d>a?b=c*a*a:2/d>a?(a-=1.5/d,b=c*a*a+.75):2.5/d>a?(a-=2.25/d,b=c*a*a+.9375):(a-=2.625/d,b=c*a*a+.984375),b},a.mina=s,s}("undefined"==typeof b?function(){}:b),d=function(a){function c(a,b){if(a){if(a.nodeType)return w(a);if(e(a,"array")&&c.set)return c.set.apply(c,a);if(a instanceof s)return a;if(null==b)return a=y.doc.querySelector(String(a)),w(a)}return a=null==a?"100%":a,b=null==b?"100%":b,new v(a,b)}function d(a,b){if(b){if("#text"==a&&(a=y.doc.createTextNode(b.text||b["#text"]||"")),"#comment"==a&&(a=y.doc.createComment(b.text||b["#text"]||"")),"string"==typeof a&&(a=d(a)),"string"==typeof b)return 1==a.nodeType?"xlink:"==b.substring(0,6)?a.getAttributeNS(T,b.substring(6)):"xml:"==b.substring(0,4)?a.getAttributeNS(U,b.substring(4)):a.getAttribute(b):"text"==b?a.nodeValue:null;if(1==a.nodeType){for(var c in b)if(b[z](c)){var e=A(b[c]);e?"xlink:"==c.substring(0,6)?a.setAttributeNS(T,c.substring(6),e):"xml:"==c.substring(0,4)?a.setAttributeNS(U,c.substring(4),e):a.setAttribute(c,e):a.removeAttribute(c)}}else"text"in b&&(a.nodeValue=b.text)}else a=y.doc.createElementNS(U,a);return a}function e(a,b){return b=A.prototype.toLowerCase.call(b),"finite"==b?isFinite(a):"array"==b&&(a instanceof Array||Array.isArray&&Array.isArray(a))?!0:"null"==b&&null===a||b==typeof a&&null!==a||"object"==b&&a===Object(a)||J.call(a).slice(8,-1).toLowerCase()==b}function f(a){if("function"==typeof a||Object(a)!==a)return a;var b=new a.constructor;for(var c in a)a[z](c)&&(b[c]=f(a[c]));return b}function h(a,b){for(var c=0,d=a.length;d>c;c++)if(a[c]===b)return a.push(a.splice(c,1)[0])}function i(a,b,c){function d(){var e=Array.prototype.slice.call(arguments,0),f=e.join(""),g=d.cache=d.cache||{},i=d.count=d.count||[];return g[z](f)?(h(i,f),c?c(g[f]):g[f]):(i.length>=1e3&&delete g[i.shift()],i.push(f),g[f]=a.apply(b,e),c?c(g[f]):g[f])}return d}function j(a,b,c,d,e,f){if(null==e){var g=a-c,h=b-d;return g||h?(180+180*D.atan2(-h,-g)/H+360)%360:0}return j(a,b,e,f)-j(c,d,e,f)}function k(a){return a%360*H/180}function l(a){return 180*a/H%360}function m(a){var b=[];return a=a.replace(/(?:^|\s)(\w+)\(([^)]+)\)/g,function(a,c,d){return d=d.split(/\s*,\s*|\s+/),"rotate"==c&&1==d.length&&d.push(0,0),"scale"==c&&(d.length>2?d=d.slice(0,2):2==d.length&&d.push(0,0),1==d.length&&d.push(d[0],0,0)),"skewX"==c?b.push(["m",1,0,D.tan(k(d[0])),1,0,0]):"skewY"==c?b.push(["m",1,D.tan(k(d[0])),0,1,0,0]):b.push([c.charAt(0)].concat(d)),a}),b}function n(a,b){var d=aa(a),e=new c.Matrix;if(d)for(var f=0,g=d.length;g>f;f++){var h,i,j,k,l,m=d[f],n=m.length,o=A(m[0]).toLowerCase(),p=m[0]!=o,q=p?e.invert():0;"t"==o&&2==n?e.translate(m[1],0):"t"==o&&3==n?p?(h=q.x(0,0),i=q.y(0,0),j=q.x(m[1],m[2]),k=q.y(m[1],m[2]),e.translate(j-h,k-i)):e.translate(m[1],m[2]):"r"==o?2==n?(l=l||b,e.rotate(m[1],l.x+l.width/2,l.y+l.height/2)):4==n&&(p?(j=q.x(m[2],m[3]),k=q.y(m[2],m[3]),e.rotate(m[1],j,k)):e.rotate(m[1],m[2],m[3])):"s"==o?2==n||3==n?(l=l||b,e.scale(m[1],m[n-1],l.x+l.width/2,l.y+l.height/2)):4==n?p?(j=q.x(m[2],m[3]),k=q.y(m[2],m[3]),e.scale(m[1],m[1],j,k)):e.scale(m[1],m[1],m[2],m[3]):5==n&&(p?(j=q.x(m[3],m[4]),k=q.y(m[3],m[4]),e.scale(m[1],m[2],j,k)):e.scale(m[1],m[2],m[3],m[4])):"m"==o&&7==n&&e.add(m[1],m[2],m[3],m[4],m[5],m[6])}return e}function o(a){var b=a.node.ownerSVGElement&&w(a.node.ownerSVGElement)||a.node.parentNode&&w(a.node.parentNode)||c.select("svg")||c(0,0),d=b.select("defs"),e=null==d?!1:d.node;return e||(e=u("defs",b.node).node),e}function p(a){return a.node.ownerSVGElement&&w(a.node.ownerSVGElement)||c.select("svg")}function q(a,b,c){function e(a){if(null==a)return I;if(a==+a)return a;d(j,{width:a});try{return j.getBBox().width}catch(b){return 0}}function f(a){if(null==a)return I;if(a==+a)return a;d(j,{height:a});try{return j.getBBox().height}catch(b){return 0}}function g(d,e){null==b?i[d]=e(a.attr(d)||0):d==b&&(i=e(null==c?a.attr(d)||0:c))}var h=p(a).node,i={},j=h.querySelector(".svg---mgr");switch(j||(j=d("rect"),d(j,{x:-9e9,y:-9e9,width:10,height:10,"class":"svg---mgr",fill:"none"}),h.appendChild(j)),a.type){case"rect":g("rx",e),g("ry",f);case"image":g("width",e),g("height",f);case"text":g("x",e),g("y",f);break;case"circle":g("cx",e),g("cy",f),g("r",e);break;case"ellipse":g("cx",e),g("cy",f),g("rx",e),g("ry",f);break;case"line":g("x1",e),g("x2",e),g("y1",f),g("y2",f);break;case"marker":g("refX",e),g("markerWidth",e),g("refY",f),g("markerHeight",f);break;case"radialGradient":g("fx",e),g("fy",f);break;case"tspan":g("dx",e),g("dy",f);break;default:g(b,e)}return h.removeChild(j),i}function r(a){e(a,"array")||(a=Array.prototype.slice.call(arguments,0));for(var b=0,c=0,d=this.node;this[b];)delete this[b++];for(b=0;b<a.length;b++)"set"==a[b].type?a[b].forEach(function(a){d.appendChild(a.node)}):d.appendChild(a[b].node);var f=d.childNodes;for(b=0;b<f.length;b++)this[c++]=w(f[b]);return this}function s(a){if(a.snap in V)return V[a.snap];var b;try{b=a.ownerSVGElement}catch(c){}this.node=a,b&&(this.paper=new v(b)),this.type=a.tagName||a.nodeName;var d=this.id=S(this);if(this.anims={},this._={transform:[]},a.snap=d,V[d]=this,"g"==this.type&&(this.add=r),this.type in{g:1,mask:1,pattern:1,symbol:1})for(var e in v.prototype)v.prototype[z](e)&&(this[e]=v.prototype[e])}function t(a){this.node=a}function u(a,b){var c=d(a);b.appendChild(c);var e=w(c);return e}function v(a,b){var c,e,f,g=v.prototype;if(a&&a.tagName&&"svg"==a.tagName.toLowerCase()){if(a.snap in V)return V[a.snap];var h=a.ownerDocument;c=new s(a),e=a.getElementsByTagName("desc")[0],f=a.getElementsByTagName("defs")[0],e||(e=d("desc"),e.appendChild(h.createTextNode("Created with Snap")),c.node.appendChild(e)),f||(f=d("defs"),c.node.appendChild(f)),c.defs=f;for(var i in g)g[z](i)&&(c[i]=g[i]);c.paper=c.root=c}else c=u("svg",y.doc.body),d(c.node,{height:b,version:1.1,width:a,xmlns:U});return c}function w(a){return a?a instanceof s||a instanceof t?a:a.tagName&&"svg"==a.tagName.toLowerCase()?new v(a):a.tagName&&"object"==a.tagName.toLowerCase()&&"image/svg+xml"==a.type?new v(a.contentDocument.getElementsByTagName("svg")[0]):new s(a):a}function x(a,b){for(var c=0,d=a.length;d>c;c++){var e={type:a[c].type,attr:a[c].attr()},f=a[c].children();b.push(e),f.length&&x(f,e.childNodes=[])}}c.version="0.5.1",c.toString=function(){return"Snap v"+this.version},c._={};var y={win:a.window,doc:a.window.document};c._.glob=y;var z="hasOwnProperty",A=String,B=parseFloat,C=parseInt,D=Math,E=D.max,F=D.min,G=D.abs,H=(D.pow,D.PI),I=(D.round,""),J=Object.prototype.toString,K=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+%?)?)\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?%?)\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?%?)\s*\))\s*$/i,L=(c._.separator=/[,\s]+/,/[\s]*,[\s]*/),M={hs:1,rg:1},N=/([a-z])[\s,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\s]*,?[\s]*)+)/gi,O=/([rstm])[\s,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\s]*,?[\s]*)+)/gi,P=/(-?\d*\.?\d*(?:e[\-+]?\d+)?)[\s]*,?[\s]*/gi,Q=0,R="S"+(+new Date).toString(36),S=function(a){return(a&&a.type?a.type:I)+R+(Q++).toString(36)},T="http://www.w3.org/1999/xlink",U="http://www.w3.org/2000/svg",V={};c.url=function(a){return"url('#"+a+"')"};c._.$=d,c._.id=S,c.format=function(){var a=/\{([^\}]+)\}/g,b=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,c=function(a,c,d){var e=d;return c.replace(b,function(a,b,c,d,f){b=b||d,e&&(b in e&&(e=e[b]),"function"==typeof e&&f&&(e=e()))}),e=(null==e||e==d?a:e)+""};return function(b,d){return A(b).replace(a,function(a,b){return c(a,b,d)})}}(),c._.clone=f,c._.cacher=i,c.rad=k,c.deg=l,c.sin=function(a){return D.sin(c.rad(a))},c.tan=function(a){return D.tan(c.rad(a))},c.cos=function(a){return D.cos(c.rad(a))},c.asin=function(a){return c.deg(D.asin(a))},c.acos=function(a){return c.deg(D.acos(a))},c.atan=function(a){return c.deg(D.atan(a))},c.atan2=function(a){return c.deg(D.atan2(a))},c.angle=j,c.len=function(a,b,d,e){return Math.sqrt(c.len2(a,b,d,e))},c.len2=function(a,b,c,d){return(a-c)*(a-c)+(b-d)*(b-d)},c.closestPoint=function(a,b,c){function d(a){var d=a.x-b,e=a.y-c;return d*d+e*e}for(var e,f,g,h,i=a.node,j=i.getTotalLength(),k=j/i.pathSegList.numberOfItems*.125,l=1/0,m=0;j>=m;m+=k)(h=d(g=i.getPointAtLength(m)))<l&&(e=g,f=m,l=h);for(k*=.5;k>.5;){var n,o,p,q,r,s;(p=f-k)>=0&&(r=d(n=i.getPointAtLength(p)))<l?(e=n,f=p,l=r):(q=f+k)<=j&&(s=d(o=i.getPointAtLength(q)))<l?(e=o,f=q,l=s):k*=.5}return e={x:e.x,y:e.y,length:f,distance:Math.sqrt(l)}},c.is=e,c.snapTo=function(a,b,c){if(c=e(c,"finite")?c:10,e(a,"array")){for(var d=a.length;d--;)if(G(a[d]-b)<=c)return a[d]}else{a=+a;var f=b%a;if(c>f)return b-f;if(f>a-c)return b-f+a}return b},c.getRGB=i(function(a){if(!a||(a=A(a)).indexOf("-")+1)return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:Z};if("none"==a)return{r:-1,g:-1,b:-1,hex:"none",toString:Z};if(!(M[z](a.toLowerCase().substring(0,2))||"#"==a.charAt())&&(a=W(a)),!a)return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:Z};var b,d,f,g,h,i,j=a.match(K);return j?(j[2]&&(f=C(j[2].substring(5),16),d=C(j[2].substring(3,5),16),b=C(j[2].substring(1,3),16)),j[3]&&(f=C((h=j[3].charAt(3))+h,16),d=C((h=j[3].charAt(2))+h,16),b=C((h=j[3].charAt(1))+h,16)),j[4]&&(i=j[4].split(L),b=B(i[0]),"%"==i[0].slice(-1)&&(b*=2.55),d=B(i[1]),"%"==i[1].slice(-1)&&(d*=2.55),f=B(i[2]),"%"==i[2].slice(-1)&&(f*=2.55),"rgba"==j[1].toLowerCase().slice(0,4)&&(g=B(i[3])),i[3]&&"%"==i[3].slice(-1)&&(g/=100)),j[5]?(i=j[5].split(L),b=B(i[0]),"%"==i[0].slice(-1)&&(b/=100),d=B(i[1]),"%"==i[1].slice(-1)&&(d/=100),f=B(i[2]),"%"==i[2].slice(-1)&&(f/=100),("deg"==i[0].slice(-3)||""==i[0].slice(-1))&&(b/=360),"hsba"==j[1].toLowerCase().slice(0,4)&&(g=B(i[3])),i[3]&&"%"==i[3].slice(-1)&&(g/=100),c.hsb2rgb(b,d,f,g)):j[6]?(i=j[6].split(L),b=B(i[0]),"%"==i[0].slice(-1)&&(b/=100),d=B(i[1]),"%"==i[1].slice(-1)&&(d/=100),f=B(i[2]),"%"==i[2].slice(-1)&&(f/=100),("deg"==i[0].slice(-3)||""==i[0].slice(-1))&&(b/=360),"hsla"==j[1].toLowerCase().slice(0,4)&&(g=B(i[3])),i[3]&&"%"==i[3].slice(-1)&&(g/=100),c.hsl2rgb(b,d,f,g)):(b=F(D.round(b),255),d=F(D.round(d),255),f=F(D.round(f),255),g=F(E(g,0),1),j={r:b,g:d,b:f,toString:Z},j.hex="#"+(16777216|f|d<<8|b<<16).toString(16).slice(1),j.opacity=e(g,"finite")?g:1,j)):{r:-1,g:-1,b:-1,hex:"none",error:1,toString:Z}},c),c.hsb=i(function(a,b,d){return c.hsb2rgb(a,b,d).hex}),c.hsl=i(function(a,b,d){return c.hsl2rgb(a,b,d).hex}),c.rgb=i(function(a,b,c,d){if(e(d,"finite")){var f=D.round;return"rgba("+[f(a),f(b),f(c),+d.toFixed(2)]+")"}return"#"+(16777216|c|b<<8|a<<16).toString(16).slice(1)});var W=function(a){var b=y.doc.getElementsByTagName("head")[0]||y.doc.getElementsByTagName("svg")[0],c="rgb(255, 0, 0)";return(W=i(function(a){if("red"==a.toLowerCase())return c;b.style.color=c,b.style.color=a;var d=y.doc.defaultView.getComputedStyle(b,I).getPropertyValue("color");return d==c?null:d}))(a)},X=function(){return"hsb("+[this.h,this.s,this.b]+")"},Y=function(){return"hsl("+[this.h,this.s,this.l]+")"},Z=function(){return 1==this.opacity||null==this.opacity?this.hex:"rgba("+[this.r,this.g,this.b,this.opacity]+")"},$=function(a,b,d){if(null==b&&e(a,"object")&&"r"in a&&"g"in a&&"b"in a&&(d=a.b,b=a.g,a=a.r),null==b&&e(a,string)){var f=c.getRGB(a);a=f.r,b=f.g,d=f.b}return(a>1||b>1||d>1)&&(a/=255,b/=255,d/=255),[a,b,d]},_=function(a,b,d,f){a=D.round(255*a),b=D.round(255*b),d=D.round(255*d);var g={r:a,g:b,b:d,opacity:e(f,"finite")?f:1,hex:c.rgb(a,b,d),toString:Z};return e(f,"finite")&&(g.opacity=f),g};c.color=function(a){var b;return e(a,"object")&&"h"in a&&"s"in a&&"b"in a?(b=c.hsb2rgb(a),a.r=b.r,a.g=b.g,a.b=b.b,a.opacity=1,a.hex=b.hex):e(a,"object")&&"h"in a&&"s"in a&&"l"in a?(b=c.hsl2rgb(a),a.r=b.r,a.g=b.g,a.b=b.b,a.opacity=1,a.hex=b.hex):(e(a,"string")&&(a=c.getRGB(a)),e(a,"object")&&"r"in a&&"g"in a&&"b"in a&&!("error"in a)?(b=c.rgb2hsl(a),a.h=b.h,a.s=b.s,a.l=b.l,b=c.rgb2hsb(a),a.v=b.b):(a={hex:"none"},a.r=a.g=a.b=a.h=a.s=a.v=a.l=-1,a.error=1)),a.toString=Z,a},c.hsb2rgb=function(a,b,c,d){e(a,"object")&&"h"in a&&"s"in a&&"b"in a&&(c=a.b,b=a.s,d=a.o,a=a.h),a*=360;var f,g,h,i,j;return a=a%360/60,j=c*b,i=j*(1-G(a%2-1)),f=g=h=c-j,a=~~a,f+=[j,i,0,0,i,j][a],g+=[i,j,j,i,0,0][a],h+=[0,0,i,j,j,i][a],_(f,g,h,d)},c.hsl2rgb=function(a,b,c,d){e(a,"object")&&"h"in a&&"s"in a&&"l"in a&&(c=a.l,b=a.s,a=a.h),(a>1||b>1||c>1)&&(a/=360,b/=100,c/=100),a*=360;var f,g,h,i,j;return a=a%360/60,j=2*b*(.5>c?c:1-c),i=j*(1-G(a%2-1)),f=g=h=c-j/2,a=~~a,f+=[j,i,0,0,i,j][a],g+=[i,j,j,i,0,0][a],h+=[0,0,i,j,j,i][a],_(f,g,h,d)},c.rgb2hsb=function(a,b,c){c=$(a,b,c),a=c[0],b=c[1],c=c[2];var d,e,f,g;return f=E(a,b,c),g=f-F(a,b,c),d=0==g?null:f==a?(b-c)/g:f==b?(c-a)/g+2:(a-b)/g+4,d=(d+360)%6*60/360,e=0==g?0:g/f,{h:d,s:e,b:f,toString:X}},c.rgb2hsl=function(a,b,c){c=$(a,b,c),a=c[0],b=c[1],c=c[2];var d,e,f,g,h,i;return g=E(a,b,c),h=F(a,b,c),i=g-h,d=0==i?null:g==a?(b-c)/i:g==b?(c-a)/i+2:(a-b)/i+4,d=(d+360)%6*60/360,f=(g+h)/2,e=0==i?0:.5>f?i/(2*f):i/(2-2*f),{h:d,s:e,l:f,toString:Y}},c.parsePathString=function(a){if(!a)return null;var b=c.path(a);if(b.arr)return c.path.clone(b.arr);var d={a:7,c:6,o:2,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,u:3,z:0},f=[];return e(a,"array")&&e(a[0],"array")&&(f=c.path.clone(a)),f.length||A(a).replace(N,function(a,b,c){var e=[],g=b.toLowerCase();if(c.replace(P,function(a,b){b&&e.push(+b)}),"m"==g&&e.length>2&&(f.push([b].concat(e.splice(0,2))),g="l",b="m"==b?"l":"L"),"o"==g&&1==e.length&&f.push([b,e[0]]),"r"==g)f.push([b].concat(e));else for(;e.length>=d[g]&&(f.push([b].concat(e.splice(0,d[g]))),d[g]););}),f.toString=c.path.toString,b.arr=c.path.clone(f),f};var aa=c.parseTransformString=function(a){if(!a)return null;var b=[];return e(a,"array")&&e(a[0],"array")&&(b=c.path.clone(a)),b.length||A(a).replace(O,function(a,c,d){var e=[];c.toLowerCase();d.replace(P,function(a,b){b&&e.push(+b)}),b.push([c].concat(e))}),b.toString=c.path.toString,b};c._.svgTransform2string=m,c._.rgTransform=/^[a-z][\s]*-?\.?\d/i,c._.transform2matrix=n,c._unit2px=q;y.doc.contains||y.doc.compareDocumentPosition?function(a,b){var c=9==a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a==d||!(!d||1!=d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)))}:function(a,b){if(b)for(;b;)if(b=b.parentNode,b==a)return!0;return!1};c._.getSomeDefs=o,c._.getSomeSVG=p,c.select=function(a){return a=A(a).replace(/([^\\]):/g,"$1\\:"),w(y.doc.querySelector(a))},c.selectAll=function(a){for(var b=y.doc.querySelectorAll(a),d=(c.set||Array)(),e=0;e<b.length;e++)d.push(w(b[e]));return d},setInterval(function(){for(var a in V)if(V[z](a)){var b=V[a],c=b.node;("svg"!=b.type&&!c.ownerSVGElement||"svg"==b.type&&(!c.parentNode||"ownerSVGElement"in c.parentNode&&!c.ownerSVGElement))&&delete V[a]}},1e4),s.prototype.attr=function(a,c){var d=this,f=d.node;if(!a){if(1!=f.nodeType)return{text:f.nodeValue};for(var g=f.attributes,h={},i=0,j=g.length;j>i;i++)h[g[i].nodeName]=g[i].nodeValue;return h}if(e(a,"string")){if(!(arguments.length>1))return b("snap.util.getattr."+a,d).firstDefined();var k={};k[a]=c,a=k}for(var l in a)a[z](l)&&b("snap.util.attr."+l,d,a[l]);return d},c.parse=function(a){var b=y.doc.createDocumentFragment(),c=!0,d=y.doc.createElement("div");if(a=A(a),a.match(/^\s*<\s*svg(?:\s|>)/)||(a="<svg>"+a+"</svg>",c=!1),d.innerHTML=a,a=d.getElementsByTagName("svg")[0])if(c)b=a;else for(;a.firstChild;)b.appendChild(a.firstChild);return new t(b)},c.fragment=function(){for(var a=Array.prototype.slice.call(arguments,0),b=y.doc.createDocumentFragment(),d=0,e=a.length;e>d;d++){var f=a[d];f.node&&f.node.nodeType&&b.appendChild(f.node),f.nodeType&&b.appendChild(f),"string"==typeof f&&b.appendChild(c.parse(f).node)}return new t(b)},c._.make=u,c._.wrap=w,v.prototype.el=function(a,b){var c=u(a,this.node);return b&&c.attr(b),c},s.prototype.children=function(){for(var a=[],b=this.node.childNodes,d=0,e=b.length;e>d;d++)a[d]=c(b[d]);return a},s.prototype.toJSON=function(){var a=[];return x([this],a),a[0]},b.on("snap.util.getattr",function(){var a=b.nt();a=a.substring(a.lastIndexOf(".")+1);var c=a.replace(/[A-Z]/g,function(a){return"-"+a.toLowerCase()});return ba[z](c)?this.node.ownerDocument.defaultView.getComputedStyle(this.node,null).getPropertyValue(c):d(this.node,a)});var ba={"alignment-baseline":0,"baseline-shift":0,clip:0,"clip-path":0,"clip-rule":0,color:0,"color-interpolation":0,"color-interpolation-filters":0,"color-profile":0,"color-rendering":0,cursor:0,direction:0,display:0,"dominant-baseline":0,"enable-background":0,fill:0,"fill-opacity":0,"fill-rule":0,filter:0,"flood-color":0,"flood-opacity":0,font:0,"font-family":0,"font-size":0,"font-size-adjust":0,"font-stretch":0,"font-style":0,"font-variant":0,"font-weight":0,"glyph-orientation-horizontal":0,"glyph-orientation-vertical":0,"image-rendering":0,kerning:0,"letter-spacing":0,"lighting-color":0,marker:0,"marker-end":0,"marker-mid":0,"marker-start":0,mask:0,opacity:0,overflow:0,"pointer-events":0,"shape-rendering":0,"stop-color":0,"stop-opacity":0,stroke:0,"stroke-dasharray":0,"stroke-dashoffset":0,"stroke-linecap":0,"stroke-linejoin":0,"stroke-miterlimit":0,"stroke-opacity":0,"stroke-width":0,"text-anchor":0,"text-decoration":0,"text-rendering":0,"unicode-bidi":0,visibility:0,"word-spacing":0,"writing-mode":0};b.on("snap.util.attr",function(a){var c=b.nt(),e={};c=c.substring(c.lastIndexOf(".")+1),e[c]=a;var f=c.replace(/-(\w)/gi,function(a,b){return b.toUpperCase()}),g=c.replace(/[A-Z]/g,function(a){return"-"+a.toLowerCase()});ba[z](g)?this.node.style[f]=null==a?I:a:d(this.node,e)}),function(a){}(v.prototype),c.ajax=function(a,c,d,f){var g=new XMLHttpRequest,h=S();if(g){if(e(c,"function"))f=d,d=c,c=null;else if(e(c,"object")){var i=[];for(var j in c)c.hasOwnProperty(j)&&i.push(encodeURIComponent(j)+"="+encodeURIComponent(c[j]));c=i.join("&")}return g.open(c?"POST":"GET",a,!0),c&&(g.setRequestHeader("X-Requested-With","XMLHttpRequest"),g.setRequestHeader("Content-type","application/x-www-form-urlencoded")),d&&(b.once("snap.ajax."+h+".0",d),b.once("snap.ajax."+h+".200",d),b.once("snap.ajax."+h+".304",d)),g.onreadystatechange=function(){4==g.readyState&&b("snap.ajax."+h+"."+g.status,f,g)},4==g.readyState?g:(g.send(c),g)}},c.load=function(a,b,d){c.ajax(a,function(a){var e=c.parse(a.responseText);d?b.call(d,e):b(e)})};var ca=function(a){var b=a.getBoundingClientRect(),c=a.ownerDocument,d=c.body,e=c.documentElement,f=e.clientTop||d.clientTop||0,h=e.clientLeft||d.clientLeft||0,i=b.top+(g.win.pageYOffset||e.scrollTop||d.scrollTop)-f,j=b.left+(g.win.pageXOffset||e.scrollLeft||d.scrollLeft)-h;return{y:i,x:j}};return c.getElementByPoint=function(a,b){var c=this,d=(c.canvas,y.doc.elementFromPoint(a,b));if(y.win.opera&&"svg"==d.tagName){var e=ca(d),f=d.createSVGRect();f.x=a-e.x,f.y=b-e.y,f.width=f.height=1;var g=d.getIntersectionList(f,null);g.length&&(d=g[g.length-1])}return d?w(d):null},c.plugin=function(a){a(c,s,v,y,t)},y.win.Snap=c,c}(a||this);return d.plugin(function(c,d,e,f,g){function h(a,b){if(null==b){var d=!0;if(b="linearGradient"==a.type||"radialGradient"==a.type?a.node.getAttribute("gradientTransform"):"pattern"==a.type?a.node.getAttribute("patternTransform"):a.node.getAttribute("transform"),!b)return new c.Matrix;b=c._.svgTransform2string(b)}else b=c._.rgTransform.test(b)?m(b).replace(/\.{3}|\u2026/g,a._.transform||""):c._.svgTransform2string(b),l(b,"array")&&(b=c.path?c.path.toString.call(b):m(b)),a._.transform=b;var e=c._.transform2matrix(b,a.getBBox(1));return d?e:void(a.matrix=e)}function i(a){function b(a,b){var d=o(a.node,b);d=d&&d.match(g),d=d&&d[2],d&&"#"==d.charAt()&&(d=d.substring(1),d&&(i[d]=(i[d]||[]).concat(function(d){var e={};e[b]=c.url(d),o(a.node,e)})))}function d(a){var b=o(a.node,"xlink:href");b&&"#"==b.charAt()&&(b=b.substring(1),b&&(i[b]=(i[b]||[]).concat(function(b){a.attr("xlink:href","#"+b)})))}for(var e,f=a.selectAll("*"),g=/^\s*url\(("|'|)(.*)\1\)\s*$/,h=[],i={},j=0,k=f.length;k>j;j++){e=f[j],b(e,"fill"),b(e,"stroke"),b(e,"filter"),b(e,"mask"),b(e,"clip-path"),d(e);var l=o(e.node,"id");l&&(o(e.node,{id:e.id}),h.push({old:l,id:e.id}))}for(j=0,k=h.length;k>j;j++){var m=i[h[j].old];if(m)for(var n=0,p=m.length;p>n;n++)m[n](h[j].id)}}function j(a){return function(){var b=a?"<"+this.type:"",c=this.node.attributes,d=this.node.childNodes;if(a)for(var e=0,f=c.length;f>e;e++)b+=" "+c[e].name+'="'+c[e].value.replace(/"/g,'\\"')+'"';if(d.length){for(a&&(b+=">"),e=0,f=d.length;f>e;e++)3==d[e].nodeType?b+=d[e].nodeValue:1==d[e].nodeType&&(b+=s(d[e]).toString());a&&(b+="</"+this.type+">")}else a&&(b+="/>");return b}}var k=d.prototype,l=c.is,m=String,n=c._unit2px,o=c._.$,p=c._.make,q=c._.getSomeDefs,r="hasOwnProperty",s=c._.wrap;k.getBBox=function(a){if("tspan"==this.type)return c._.box(this.node.getClientRects().item(0));if(!c.Matrix||!c.path)return this.node.getBBox();var b=this,d=new c.Matrix;if(b.removed)return c._.box();for(;"use"==b.type;)if(a||(d=d.add(b.transform().localMatrix.translate(b.attr("x")||0,b.attr("y")||0))),b.original)b=b.original;else{var e=b.attr("xlink:href");b=b.original=b.node.ownerDocument.getElementById(e.substring(e.indexOf("#")+1))}var f=b._,g=c.path.get[b.type]||c.path.get.deflt;try{return a?(f.bboxwt=g?c.path.getBBox(b.realPath=g(b)):c._.box(b.node.getBBox()),c._.box(f.bboxwt)):(b.realPath=g(b),b.matrix=b.transform().localMatrix,f.bbox=c.path.getBBox(c.path.map(b.realPath,d.add(b.matrix))),c._.box(f.bbox))}catch(h){return c._.box()}};var t=function(){return this.string};k.transform=function(a){var b=this._;if(null==a){for(var d,e=this,f=new c.Matrix(this.node.getCTM()),g=h(this),i=[g],j=new c.Matrix,k=g.toTransformString(),l=m(g)==m(this.matrix)?m(b.transform):k;"svg"!=e.type&&(e=e.parent());)i.push(h(e));for(d=i.length;d--;)j.add(i[d]);return{string:l,globalMatrix:f,totalMatrix:j,localMatrix:g,diffMatrix:f.clone().add(g.invert()),global:f.toTransformString(),total:j.toTransformString(),local:k,toString:t}}return a instanceof c.Matrix?(this.matrix=a,this._.transform=a.toTransformString()):h(this,a),this.node&&("linearGradient"==this.type||"radialGradient"==this.type?o(this.node,{gradientTransform:this.matrix}):"pattern"==this.type?o(this.node,{patternTransform:this.matrix}):o(this.node,{transform:this.matrix})),this},k.parent=function(){return s(this.node.parentNode)},k.append=k.add=function(a){if(a){if("set"==a.type){var b=this;return a.forEach(function(a){b.add(a)}),this}a=s(a),this.node.appendChild(a.node),a.paper=this.paper}return this},k.appendTo=function(a){return a&&(a=s(a),a.append(this)),this},k.prepend=function(a){if(a){if("set"==a.type){var b,c=this;return a.forEach(function(a){b?b.after(a):c.prepend(a),b=a}),this}a=s(a);var d=a.parent();this.node.insertBefore(a.node,this.node.firstChild),this.add&&this.add(),a.paper=this.paper,this.parent()&&this.parent().add(),d&&d.add()}return this},k.prependTo=function(a){return a=s(a),a.prepend(this),this},k.before=function(a){if("set"==a.type){var b=this;return a.forEach(function(a){var c=a.parent();b.node.parentNode.insertBefore(a.node,b.node),c&&c.add()}),this.parent().add(),this}a=s(a);var c=a.parent();return this.node.parentNode.insertBefore(a.node,this.node),this.parent()&&this.parent().add(),c&&c.add(),a.paper=this.paper,this},k.after=function(a){a=s(a);var b=a.parent();return this.node.nextSibling?this.node.parentNode.insertBefore(a.node,this.node.nextSibling):this.node.parentNode.appendChild(a.node),this.parent()&&this.parent().add(),b&&b.add(),a.paper=this.paper,this},k.insertBefore=function(a){a=s(a);var b=this.parent();return a.node.parentNode.insertBefore(this.node,a.node),this.paper=a.paper,b&&b.add(),a.parent()&&a.parent().add(),this},k.insertAfter=function(a){a=s(a);var b=this.parent();return a.node.parentNode.insertBefore(this.node,a.node.nextSibling),this.paper=a.paper,b&&b.add(),a.parent()&&a.parent().add(),this},k.remove=function(){var a=this.parent();return this.node.parentNode&&this.node.parentNode.removeChild(this.node),delete this.paper,this.removed=!0,a&&a.add(),this},k.select=function(a){return s(this.node.querySelector(a))},k.selectAll=function(a){for(var b=this.node.querySelectorAll(a),d=(c.set||Array)(),e=0;e<b.length;e++)d.push(s(b[e]));return d},k.asPX=function(a,b){return null==b&&(b=this.attr(a)),+n(this,a,b)},k.use=function(){var a,b=this.node.id;return b||(b=this.id,o(this.node,{id:b})),a="linearGradient"==this.type||"radialGradient"==this.type||"pattern"==this.type?p(this.type,this.node.parentNode):p("use",this.node.parentNode),o(a.node,{"xlink:href":"#"+b}),a.original=this,a},k.clone=function(){var a=s(this.node.cloneNode(!0));return o(a.node,"id")&&o(a.node,{id:a.id}),i(a),a.insertAfter(this),a},k.toDefs=function(){var a=q(this);return a.appendChild(this.node),this},k.pattern=k.toPattern=function(a,b,c,d){var e=p("pattern",q(this));return null==a&&(a=this.getBBox()),l(a,"object")&&"x"in a&&(b=a.y,c=a.width,d=a.height,a=a.x),o(e.node,{x:a,y:b,width:c,height:d,patternUnits:"userSpaceOnUse",id:e.id,viewBox:[a,b,c,d].join(" ")}),e.node.appendChild(this.node),e},k.marker=function(a,b,c,d,e,f){var g=p("marker",q(this));return null==a&&(a=this.getBBox()),l(a,"object")&&"x"in a&&(b=a.y,c=a.width,d=a.height,e=a.refX||a.cx,f=a.refY||a.cy,a=a.x),o(g.node,{viewBox:[a,b,c,d].join(" "),markerWidth:c,markerHeight:d,orient:"auto",refX:e||0,refY:f||0,id:g.id}),g.node.appendChild(this.node),g};var u={};k.data=function(a,d){var e=u[this.id]=u[this.id]||{};if(0==arguments.length)return b("snap.data.get."+this.id,this,e,null),e;if(1==arguments.length){if(c.is(a,"object")){for(var f in a)a[r](f)&&this.data(f,a[f]);return this}return b("snap.data.get."+this.id,this,e[a],a),e[a]}return e[a]=d,b("snap.data.set."+this.id,this,d,a),this},k.removeData=function(a){return null==a?u[this.id]={}:u[this.id]&&delete u[this.id][a],this},k.outerSVG=k.toString=j(1),k.innerSVG=j(),k.toDataURL=function(){if(a&&a.btoa){var b=this.getBBox(),d=c.format('<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="{width}" height="{height}" viewBox="{x} {y} {width} {height}">{contents}</svg>',{x:+b.x.toFixed(3),y:+b.y.toFixed(3),width:+b.width.toFixed(3),height:+b.height.toFixed(3),contents:this.outerSVG()});
return"data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(d)))}},g.prototype.select=k.select,g.prototype.selectAll=k.selectAll}),d.plugin(function(a,d,e,f,g){function h(a,b,c){return function(d){var e=d.slice(a,b);return 1==e.length&&(e=e[0]),c?c(e):e}}var i=d.prototype,j=a.is,k=String,l="hasOwnProperty",m=function(a,b,d,e){"function"!=typeof d||d.length||(e=d,d=c.linear),this.attr=a,this.dur=b,d&&(this.easing=d),e&&(this.callback=e)};a._.Animation=m,a.animation=function(a,b,c,d){return new m(a,b,c,d)},i.inAnim=function(){var a=this,b=[];for(var c in a.anims)a.anims[l](c)&&!function(a){b.push({anim:new m(a._attrs,a.dur,a.easing,a._callback),mina:a,curStatus:a.status(),status:function(b){return a.status(b)},stop:function(){a.stop()}})}(a.anims[c]);return b},a.animate=function(a,d,e,f,g,h){"function"!=typeof g||g.length||(h=g,g=c.linear);var i=c.time(),j=c(a,d,i,i+f,c.time,e,g);return h&&b.once("mina.finish."+j.id,h),j},i.stop=function(){for(var a=this.inAnim(),b=0,c=a.length;c>b;b++)a[b].stop();return this},i.animate=function(a,d,e,f){"function"!=typeof e||e.length||(f=e,e=c.linear),a instanceof m&&(f=a.callback,e=a.easing,d=a.dur,a=a.attr);var g,i,n,o,p=[],q=[],r={},s=this;for(var t in a)if(a[l](t)){s.equal?(o=s.equal(t,k(a[t])),g=o.from,i=o.to,n=o.f):(g=+s.attr(t),i=+a[t]);var u=j(g,"array")?g.length:1;r[t]=h(p.length,p.length+u,n),p=p.concat(g),q=q.concat(i)}var v=c.time(),w=c(p,q,v,v+d,c.time,function(a){var b={};for(var c in r)r[l](c)&&(b[c]=r[c](a));s.attr(b)},e);return s.anims[w.id]=w,w._attrs=a,w._callback=f,b("snap.animcreated."+s.id,w),b.once("mina.finish."+w.id,function(){b.off("mina.*."+w.id),delete s.anims[w.id],f&&f.call(s)}),b.once("mina.stop."+w.id,function(){b.off("mina.*."+w.id),delete s.anims[w.id]}),s}}),d.plugin(function(a,b,c,d,e){function f(a,b,c,d,e,f){return null==b&&"[object SVGMatrix]"==g.call(a)?(this.a=a.a,this.b=a.b,this.c=a.c,this.d=a.d,this.e=a.e,void(this.f=a.f)):void(null!=a?(this.a=+a,this.b=+b,this.c=+c,this.d=+d,this.e=+e,this.f=+f):(this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0))}var g=Object.prototype.toString,h=String,i=Math,j="";!function(b){function c(a){return a[0]*a[0]+a[1]*a[1]}function d(a){var b=i.sqrt(c(a));a[0]&&(a[0]/=b),a[1]&&(a[1]/=b)}b.add=function(a,b,c,d,e,g){if(a&&a instanceof f)return this.add(a.a,a.b,a.c,a.d,a.e,a.f);var h=a*this.a+b*this.c,i=a*this.b+b*this.d;return this.e+=e*this.a+g*this.c,this.f+=e*this.b+g*this.d,this.c=c*this.a+d*this.c,this.d=c*this.b+d*this.d,this.a=h,this.b=i,this},f.prototype.multLeft=function(a,b,c,d,e,g){if(a&&a instanceof f)return this.multLeft(a.a,a.b,a.c,a.d,a.e,a.f);var h=a*this.a+c*this.b,i=a*this.c+c*this.d,j=a*this.e+c*this.f+e;return this.b=b*this.a+d*this.b,this.d=b*this.c+d*this.d,this.f=b*this.e+d*this.f+g,this.a=h,this.c=i,this.e=j,this},b.invert=function(){var a=this,b=a.a*a.d-a.b*a.c;return new f(a.d/b,-a.b/b,-a.c/b,a.a/b,(a.c*a.f-a.d*a.e)/b,(a.b*a.e-a.a*a.f)/b)},b.clone=function(){return new f(this.a,this.b,this.c,this.d,this.e,this.f)},b.translate=function(a,b){return this.e+=a*this.a+b*this.c,this.f+=a*this.b+b*this.d,this},b.scale=function(a,b,c,d){return null==b&&(b=a),(c||d)&&this.translate(c,d),this.a*=a,this.b*=a,this.c*=b,this.d*=b,(c||d)&&this.translate(-c,-d),this},b.rotate=function(b,c,d){b=a.rad(b),c=c||0,d=d||0;var e=+i.cos(b).toFixed(9),f=+i.sin(b).toFixed(9);return this.add(e,f,-f,e,c,d),this.add(1,0,0,1,-c,-d)},b.skewX=function(a){return this.skew(a,0)},b.skewY=function(a){return this.skew(0,a)},b.skew=function(b,c){b=b||0,c=c||0,b=a.rad(b),c=a.rad(c);var d=i.tan(b).toFixed(9),e=i.tan(c).toFixed(9);return this.add(1,e,d,1,0,0)},b.x=function(a,b){return a*this.a+b*this.c+this.e},b.y=function(a,b){return a*this.b+b*this.d+this.f},b.get=function(a){return+this[h.fromCharCode(97+a)].toFixed(4)},b.toString=function(){return"matrix("+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)].join()+")"},b.offset=function(){return[this.e.toFixed(4),this.f.toFixed(4)]},b.determinant=function(){return this.a*this.d-this.b*this.c},b.split=function(){var b={};b.dx=this.e,b.dy=this.f;var e=[[this.a,this.b],[this.c,this.d]];b.scalex=i.sqrt(c(e[0])),d(e[0]),b.shear=e[0][0]*e[1][0]+e[0][1]*e[1][1],e[1]=[e[1][0]-e[0][0]*b.shear,e[1][1]-e[0][1]*b.shear],b.scaley=i.sqrt(c(e[1])),d(e[1]),b.shear/=b.scaley,this.determinant()<0&&(b.scalex=-b.scalex);var f=e[0][1],g=e[1][1];return 0>g?(b.rotate=a.deg(i.acos(g)),0>f&&(b.rotate=360-b.rotate)):b.rotate=a.deg(i.asin(f)),b.isSimple=!(+b.shear.toFixed(9)||b.scalex.toFixed(9)!=b.scaley.toFixed(9)&&b.rotate),b.isSuperSimple=!+b.shear.toFixed(9)&&b.scalex.toFixed(9)==b.scaley.toFixed(9)&&!b.rotate,b.noRotation=!+b.shear.toFixed(9)&&!b.rotate,b},b.toTransformString=function(a){var b=a||this.split();return+b.shear.toFixed(9)?"m"+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)]:(b.scalex=+b.scalex.toFixed(4),b.scaley=+b.scaley.toFixed(4),b.rotate=+b.rotate.toFixed(4),(b.dx||b.dy?"t"+[+b.dx.toFixed(4),+b.dy.toFixed(4)]:j)+(b.rotate?"r"+[+b.rotate.toFixed(4),0,0]:j)+(1!=b.scalex||1!=b.scaley?"s"+[b.scalex,b.scaley,0,0]:j))}}(f.prototype),a.Matrix=f,a.matrix=function(a,b,c,d,e,g){return new f(a,b,c,d,e,g)}}),d.plugin(function(a,c,d,e,f){function g(d){return function(e){if(b.stop(),e instanceof f&&1==e.node.childNodes.length&&("radialGradient"==e.node.firstChild.tagName||"linearGradient"==e.node.firstChild.tagName||"pattern"==e.node.firstChild.tagName)&&(e=e.node.firstChild,n(this).appendChild(e),e=l(e)),e instanceof c)if("radialGradient"==e.type||"linearGradient"==e.type||"pattern"==e.type){e.node.id||p(e.node,{id:e.id});var g=q(e.node.id)}else g=e.attr(d);else if(g=a.color(e),g.error){var h=a(n(this).ownerSVGElement).gradient(e);h?(h.node.id||p(h.node,{id:h.id}),g=q(h.node.id)):g=e}else g=r(g);var i={};i[d]=g,p(this.node,i),this.node.style[d]=t}}function h(a){b.stop(),a==+a&&(a+="px"),this.node.style.fontSize=a}function i(a){for(var b=[],c=a.childNodes,d=0,e=c.length;e>d;d++){var f=c[d];3==f.nodeType&&b.push(f.nodeValue),"tspan"==f.tagName&&(1==f.childNodes.length&&3==f.firstChild.nodeType?b.push(f.firstChild.nodeValue):b.push(i(f)))}return b}function j(){return b.stop(),this.node.style.fontSize}var k=a._.make,l=a._.wrap,m=a.is,n=a._.getSomeDefs,o=/^url\((['"]?)([^)]+)\1\)$/,p=a._.$,q=a.url,r=String,s=a._.separator,t="";a.deurl=function(a){var b=String(a).match(o);return b?b[2]:a},b.on("snap.util.attr.mask",function(a){if(a instanceof c||a instanceof f){if(b.stop(),a instanceof f&&1==a.node.childNodes.length&&(a=a.node.firstChild,n(this).appendChild(a),a=l(a)),"mask"==a.type)var d=a;else d=k("mask",n(this)),d.node.appendChild(a.node);!d.node.id&&p(d.node,{id:d.id}),p(this.node,{mask:q(d.id)})}}),function(a){b.on("snap.util.attr.clip",a),b.on("snap.util.attr.clip-path",a),b.on("snap.util.attr.clipPath",a)}(function(a){if(a instanceof c||a instanceof f){b.stop();for(var d,e=a.node;e;){if("clipPath"===e.nodeName){d=new c(e);break}if("svg"===e.nodeName){d=void 0;break}e=e.parentNode}d||(d=k("clipPath",n(this)),d.node.appendChild(a.node),!d.node.id&&p(d.node,{id:d.id})),p(this.node,{"clip-path":q(d.node.id||d.id)})}}),b.on("snap.util.attr.fill",g("fill")),b.on("snap.util.attr.stroke",g("stroke"));var u=/^([lr])(?:\(([^)]*)\))?(.*)$/i;b.on("snap.util.grad.parse",function(a){function b(a,b){for(var c=(b-h)/(a-i),d=i;a>d;d++)f[d].offset=+(+h+c*(d-i)).toFixed(2);i=a,h=b}a=r(a);var c=a.match(u);if(!c)return null;var d=c[1],e=c[2],f=c[3];e=e.split(/\s*,\s*/).map(function(a){return+a==a?+a:a}),1==e.length&&0==e[0]&&(e=[]),f=f.split("-"),f=f.map(function(a){a=a.split(":");var b={color:a[0]};return a[1]&&(b.offset=parseFloat(a[1])),b});var g=f.length,h=0,i=0;g--;for(var j=0;g>j;j++)"offset"in f[j]&&b(j,f[j].offset);return f[g].offset=f[g].offset||100,b(g,f[g].offset),{type:d,params:e,stops:f}}),b.on("snap.util.attr.d",function(c){b.stop(),m(c,"array")&&m(c[0],"array")&&(c=a.path.toString.call(c)),c=r(c),c.match(/[ruo]/i)&&(c=a.path.toAbsolute(c)),p(this.node,{d:c})})(-1),b.on("snap.util.attr.#text",function(a){b.stop(),a=r(a);for(var c=e.doc.createTextNode(a);this.node.firstChild;)this.node.removeChild(this.node.firstChild);this.node.appendChild(c)})(-1),b.on("snap.util.attr.path",function(a){b.stop(),this.attr({d:a})})(-1),b.on("snap.util.attr.class",function(a){b.stop(),this.node.className.baseVal=a})(-1),b.on("snap.util.attr.viewBox",function(a){var c;c=m(a,"object")&&"x"in a?[a.x,a.y,a.width,a.height].join(" "):m(a,"array")?a.join(" "):a,p(this.node,{viewBox:c}),b.stop()})(-1),b.on("snap.util.attr.transform",function(a){this.transform(a),b.stop()})(-1),b.on("snap.util.attr.r",function(a){"rect"==this.type&&(b.stop(),p(this.node,{rx:a,ry:a}))})(-1),b.on("snap.util.attr.textpath",function(a){if(b.stop(),"text"==this.type){var d,e,f;if(!a&&this.textPath){for(e=this.textPath;e.node.firstChild;)this.node.appendChild(e.node.firstChild);return e.remove(),void delete this.textPath}if(m(a,"string")){var g=n(this),h=l(g.parentNode).path(a);g.appendChild(h.node),d=h.id,h.attr({id:d})}else a=l(a),a instanceof c&&(d=a.attr("id"),d||(d=a.id,a.attr({id:d})));if(d)if(e=this.textPath,f=this.node,e)e.attr({"xlink:href":"#"+d});else{for(e=p("textPath",{"xlink:href":"#"+d});f.firstChild;)e.appendChild(f.firstChild);f.appendChild(e),this.textPath=l(e)}}})(-1),b.on("snap.util.attr.text",function(a){if("text"==this.type){for(var c=this.node,d=function(a){var b=p("tspan");if(m(a,"array"))for(var c=0;c<a.length;c++)b.appendChild(d(a[c]));else b.appendChild(e.doc.createTextNode(a));return b.normalize&&b.normalize(),b};c.firstChild;)c.removeChild(c.firstChild);for(var f=d(a);f.firstChild;)c.appendChild(f.firstChild)}b.stop()})(-1),b.on("snap.util.attr.fontSize",h)(-1),b.on("snap.util.attr.font-size",h)(-1),b.on("snap.util.getattr.transform",function(){return b.stop(),this.transform()})(-1),b.on("snap.util.getattr.textpath",function(){return b.stop(),this.textPath})(-1),function(){function c(c){return function(){b.stop();var d=e.doc.defaultView.getComputedStyle(this.node,null).getPropertyValue("marker-"+c);return"none"==d?d:a(e.doc.getElementById(d.match(o)[1]))}}function d(a){return function(c){b.stop();var d="marker"+a.charAt(0).toUpperCase()+a.substring(1);if(""==c||!c)return void(this.node.style[d]="none");if("marker"==c.type){var e=c.node.id;return e||p(c.node,{id:c.id}),void(this.node.style[d]=q(e))}}}b.on("snap.util.getattr.marker-end",c("end"))(-1),b.on("snap.util.getattr.markerEnd",c("end"))(-1),b.on("snap.util.getattr.marker-start",c("start"))(-1),b.on("snap.util.getattr.markerStart",c("start"))(-1),b.on("snap.util.getattr.marker-mid",c("mid"))(-1),b.on("snap.util.getattr.markerMid",c("mid"))(-1),b.on("snap.util.attr.marker-end",d("end"))(-1),b.on("snap.util.attr.markerEnd",d("end"))(-1),b.on("snap.util.attr.marker-start",d("start"))(-1),b.on("snap.util.attr.markerStart",d("start"))(-1),b.on("snap.util.attr.marker-mid",d("mid"))(-1),b.on("snap.util.attr.markerMid",d("mid"))(-1)}(),b.on("snap.util.getattr.r",function(){return"rect"==this.type&&p(this.node,"rx")==p(this.node,"ry")?(b.stop(),p(this.node,"rx")):void 0})(-1),b.on("snap.util.getattr.text",function(){if("text"==this.type||"tspan"==this.type){b.stop();var a=i(this.node);return 1==a.length?a[0]:a}})(-1),b.on("snap.util.getattr.#text",function(){return this.node.textContent})(-1),b.on("snap.util.getattr.fill",function(c){if(!c){b.stop();var d=b("snap.util.getattr.fill",this,!0).firstDefined();return a(a.deurl(d))||d}})(-1),b.on("snap.util.getattr.stroke",function(c){if(!c){b.stop();var d=b("snap.util.getattr.stroke",this,!0).firstDefined();return a(a.deurl(d))||d}})(-1),b.on("snap.util.getattr.viewBox",function(){b.stop();var c=p(this.node,"viewBox");return c?(c=c.split(s),a._.box(+c[0],+c[1],+c[2],+c[3])):void 0})(-1),b.on("snap.util.getattr.points",function(){var a=p(this.node,"points");return b.stop(),a?a.split(s):void 0})(-1),b.on("snap.util.getattr.path",function(){var a=p(this.node,"d");return b.stop(),a})(-1),b.on("snap.util.getattr.class",function(){return this.node.className.baseVal})(-1),b.on("snap.util.getattr.fontSize",j)(-1),b.on("snap.util.getattr.font-size",j)(-1)}),d.plugin(function(a,b,c,d,e){var f=/\S+/g,g=String,h=b.prototype;h.addClass=function(a){var b,c,d,e,h=g(a||"").match(f)||[],i=this.node,j=i.className.baseVal,k=j.match(f)||[];if(h.length){for(b=0;d=h[b++];)c=k.indexOf(d),~c||k.push(d);e=k.join(" "),j!=e&&(i.className.baseVal=e)}return this},h.removeClass=function(a){var b,c,d,e,h=g(a||"").match(f)||[],i=this.node,j=i.className.baseVal,k=j.match(f)||[];if(k.length){for(b=0;d=h[b++];)c=k.indexOf(d),~c&&k.splice(c,1);e=k.join(" "),j!=e&&(i.className.baseVal=e)}return this},h.hasClass=function(a){var b=this.node,c=b.className.baseVal,d=c.match(f)||[];return!!~d.indexOf(a)},h.toggleClass=function(a,b){if(null!=b)return b?this.addClass(a):this.removeClass(a);var c,d,e,g,h=(a||"").match(f)||[],i=this.node,j=i.className.baseVal,k=j.match(f)||[];for(c=0;e=h[c++];)d=k.indexOf(e),~d?k.splice(d,1):k.push(e);return g=k.join(" "),j!=g&&(i.className.baseVal=g),this}}),d.plugin(function(a,c,d,e,f){function g(a){return a}function h(a){return function(b){return+b.toFixed(3)+a}}var i={"+":function(a,b){return a+b},"-":function(a,b){return a-b},"/":function(a,b){return a/b},"*":function(a,b){return a*b}},j=String,k=/[a-z]+$/i,l=/^\s*([+\-\/*])\s*=\s*([\d.eE+\-]+)\s*([^\d\s]+)?\s*$/;b.on("snap.util.attr",function(a){var c=j(a).match(l);if(c){var d=b.nt(),e=d.substring(d.lastIndexOf(".")+1),f=this.attr(e),g={};b.stop();var h=c[3]||"",m=f.match(k),n=i[c[1]];if(m&&m==h?a=n(parseFloat(f),+c[2]):(f=this.asPX(e),a=n(this.asPX(e),this.asPX(e,c[2]+h))),isNaN(f)||isNaN(a))return;g[e]=a,this.attr(g)}})(-10),b.on("snap.util.equal",function(a,c){var d=j(this.attr(a)||""),e=j(c).match(l);if(e){b.stop();var f=e[3]||"",m=d.match(k),n=i[e[1]];return m&&m==f?{from:parseFloat(d),to:n(parseFloat(d),+e[2]),f:h(m)}:(d=this.asPX(a),{from:d,to:n(d,this.asPX(a,e[2]+f)),f:g})}})(-10)}),d.plugin(function(c,d,e,f,g){var h=e.prototype,i=c.is;h.rect=function(a,b,c,d,e,f){var g;return null==f&&(f=e),i(a,"object")&&"[object Object]"==a?g=a:null!=a&&(g={x:a,y:b,width:c,height:d},null!=e&&(g.rx=e,g.ry=f)),this.el("rect",g)},h.circle=function(a,b,c){var d;return i(a,"object")&&"[object Object]"==a?d=a:null!=a&&(d={cx:a,cy:b,r:c}),this.el("circle",d)};var j=function(){function a(){this.parentNode.removeChild(this)}return function(b,c){var d=f.doc.createElement("img"),e=f.doc.body;d.style.cssText="position:absolute;left:-9999em;top:-9999em",d.onload=function(){c.call(d),d.onload=d.onerror=null,e.removeChild(d)},d.onerror=a,e.appendChild(d),d.src=b}}();h.image=function(a,b,d,e,f){var g=this.el("image");if(i(a,"object")&&"src"in a)g.attr(a);else if(null!=a){var h={"xlink:href":a,preserveAspectRatio:"none"};null!=b&&null!=d&&(h.x=b,h.y=d),null!=e&&null!=f?(h.width=e,h.height=f):j(a,function(){c._.$(g.node,{width:this.offsetWidth,height:this.offsetHeight})}),c._.$(g.node,h)}return g},h.ellipse=function(a,b,c,d){var e;return i(a,"object")&&"[object Object]"==a?e=a:null!=a&&(e={cx:a,cy:b,rx:c,ry:d}),this.el("ellipse",e)},h.path=function(a){var b;return i(a,"object")&&!i(a,"array")?b=a:a&&(b={d:a}),this.el("path",b)},h.group=h.g=function(a){var b=this.el("g");return 1==arguments.length&&a&&!a.type?b.attr(a):arguments.length&&b.add(Array.prototype.slice.call(arguments,0)),b},h.svg=function(a,b,c,d,e,f,g,h){var j={};return i(a,"object")&&null==b?j=a:(null!=a&&(j.x=a),null!=b&&(j.y=b),null!=c&&(j.width=c),null!=d&&(j.height=d),null!=e&&null!=f&&null!=g&&null!=h&&(j.viewBox=[e,f,g,h])),this.el("svg",j)},h.mask=function(a){var b=this.el("mask");return 1==arguments.length&&a&&!a.type?b.attr(a):arguments.length&&b.add(Array.prototype.slice.call(arguments,0)),b},h.ptrn=function(a,b,c,d,e,f,g,h){if(i(a,"object"))var j=a;else j={patternUnits:"userSpaceOnUse"},a&&(j.x=a),b&&(j.y=b),null!=c&&(j.width=c),null!=d&&(j.height=d),null!=e&&null!=f&&null!=g&&null!=h?j.viewBox=[e,f,g,h]:j.viewBox=[a||0,b||0,c||0,d||0];return this.el("pattern",j)},h.use=function(a){return null!=a?(a instanceof d&&(a.attr("id")||a.attr({id:c._.id(a)}),a=a.attr("id")),"#"==String(a).charAt()&&(a=a.substring(1)),this.el("use",{"xlink:href":"#"+a})):d.prototype.use.call(this)},h.symbol=function(a,b,c,d){var e={};return null!=a&&null!=b&&null!=c&&null!=d&&(e.viewBox=[a,b,c,d]),this.el("symbol",e)},h.text=function(a,b,c){var d={};return i(a,"object")?d=a:null!=a&&(d={x:a,y:b,text:c||""}),this.el("text",d)},h.line=function(a,b,c,d){var e={};return i(a,"object")?e=a:null!=a&&(e={x1:a,x2:c,y1:b,y2:d}),this.el("line",e)},h.polyline=function(a){arguments.length>1&&(a=Array.prototype.slice.call(arguments,0));var b={};return i(a,"object")&&!i(a,"array")?b=a:null!=a&&(b={points:a}),this.el("polyline",b)},h.polygon=function(a){arguments.length>1&&(a=Array.prototype.slice.call(arguments,0));var b={};return i(a,"object")&&!i(a,"array")?b=a:null!=a&&(b={points:a}),this.el("polygon",b)},function(){function d(){return this.selectAll("stop")}function e(a,b){var d=l("stop"),e={offset:+b+"%"};a=c.color(a),e["stop-color"]=a.hex,a.opacity<1&&(e["stop-opacity"]=a.opacity),l(d,e);for(var f,g=this.stops(),h=0;h<g.length;h++){var i=parseFloat(g[h].attr("offset"));if(i>b){this.node.insertBefore(d,g[h].node),f=!0;break}}return f||this.node.appendChild(d),this}function f(){if("linearGradient"==this.type){var a=l(this.node,"x1")||0,b=l(this.node,"x2")||1,d=l(this.node,"y1")||0,e=l(this.node,"y2")||0;return c._.box(a,d,math.abs(b-a),math.abs(e-d))}var f=this.node.cx||.5,g=this.node.cy||.5,h=this.node.r||0;return c._.box(f-h,g-h,2*h,2*h)}function g(a){var d=a,e=this.stops();if("string"==typeof a&&(d=b("snap.util.grad.parse",null,"l(0,0,0,1)"+a).firstDefined().stops),c.is(d,"array")){for(var f=0;f<e.length;f++)if(d[f]){var g=c.color(d[f].color),h={offset:d[f].offset+"%"};h["stop-color"]=g.hex,g.opacity<1&&(h["stop-opacity"]=g.opacity),e[f].attr(h)}else e[f].remove();for(f=e.length;f<d.length;f++)this.addStop(d[f].color,d[f].offset);return this}}function i(a,c){var d,e=b("snap.util.grad.parse",null,c).firstDefined();if(!e)return null;e.params.unshift(a),d="l"==e.type.toLowerCase()?j.apply(0,e.params):k.apply(0,e.params),e.type!=e.type.toLowerCase()&&l(d.node,{gradientUnits:"userSpaceOnUse"});for(var f=e.stops,g=f.length,h=0;g>h;h++){var i=f[h];d.addStop(i.color,i.offset)}return d}function j(a,b,h,i,j){var k=c._.make("linearGradient",a);return k.stops=d,k.addStop=e,k.getBBox=f,k.setStops=g,null!=b&&l(k.node,{x1:b,y1:h,x2:i,y2:j}),k}function k(a,b,g,h,i,j){var k=c._.make("radialGradient",a);return k.stops=d,k.addStop=e,k.getBBox=f,null!=b&&l(k.node,{cx:b,cy:g,r:h}),null!=i&&null!=j&&l(k.node,{fx:i,fy:j}),k}var l=c._.$;h.gradient=function(a){return i(this.defs,a)},h.gradientLinear=function(a,b,c,d){return j(this.defs,a,b,c,d)},h.gradientRadial=function(a,b,c,d,e){return k(this.defs,a,b,c,d,e)},h.toString=function(){var a,b=this.node.ownerDocument,d=b.createDocumentFragment(),e=b.createElement("div"),f=this.node.cloneNode(!0);return d.appendChild(e),e.appendChild(f),c._.$(f,{xmlns:"http://www.w3.org/2000/svg"}),a=e.innerHTML,d.removeChild(d.firstChild),a},h.toDataURL=function(){return a&&a.btoa?"data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(this))):void 0},h.clear=function(){for(var a,b=this.node.firstChild;b;)a=b.nextSibling,"defs"!=b.tagName?b.parentNode.removeChild(b):h.clear.call({node:b}),b=a}}()}),d.plugin(function(a,b,c,d){function e(a){var b=e.ps=e.ps||{};return b[a]?b[a].sleep=100:b[a]={sleep:100},setTimeout(function(){for(var c in b)b[M](c)&&c!=a&&(b[c].sleep--,!b[c].sleep&&delete b[c])}),b[a]}function f(a,b,c,d){return null==a&&(a=b=c=d=0),null==b&&(b=a.y,c=a.width,d=a.height,a=a.x),{x:a,y:b,width:c,w:c,height:d,h:d,x2:a+c,y2:b+d,cx:a+c/2,cy:b+d/2,r1:P.min(c,d)/2,r2:P.max(c,d)/2,r0:P.sqrt(c*c+d*d)/2,path:y(a,b,c,d),vb:[a,b,c,d].join(" ")}}function g(){return this.join(",").replace(N,"$1")}function h(a){var b=L(a);return b.toString=g,b}function i(a,b,c,d,e,f,g,h,i){return null==i?p(a,b,c,d,e,f,g,h):k(a,b,c,d,e,f,g,h,q(a,b,c,d,e,f,g,h,i))}function j(c,d){function e(a){return+(+a).toFixed(3)}return a._.cacher(function(a,f,g){a instanceof b&&(a=a.attr("d")),a=G(a);for(var h,j,l,m,n,o="",p={},q=0,r=0,s=a.length;s>r;r++){if(l=a[r],"M"==l[0])h=+l[1],j=+l[2];else{if(m=i(h,j,l[1],l[2],l[3],l[4],l[5],l[6]),q+m>f){if(d&&!p.start){if(n=i(h,j,l[1],l[2],l[3],l[4],l[5],l[6],f-q),o+=["C"+e(n.start.x),e(n.start.y),e(n.m.x),e(n.m.y),e(n.x),e(n.y)],g)return o;p.start=o,o=["M"+e(n.x),e(n.y)+"C"+e(n.n.x),e(n.n.y),e(n.end.x),e(n.end.y),e(l[5]),e(l[6])].join(),q+=m,h=+l[5],j=+l[6];continue}if(!c&&!d)return n=i(h,j,l[1],l[2],l[3],l[4],l[5],l[6],f-q)}q+=m,h=+l[5],j=+l[6]}o+=l.shift()+l}return p.end=o,n=c?q:d?p:k(h,j,l[0],l[1],l[2],l[3],l[4],l[5],1)},null,a._.clone)}function k(a,b,c,d,e,f,g,h,i){var j=1-i,k=T(j,3),l=T(j,2),m=i*i,n=m*i,o=k*a+3*l*i*c+3*j*i*i*e+n*g,p=k*b+3*l*i*d+3*j*i*i*f+n*h,q=a+2*i*(c-a)+m*(e-2*c+a),r=b+2*i*(d-b)+m*(f-2*d+b),s=c+2*i*(e-c)+m*(g-2*e+c),t=d+2*i*(f-d)+m*(h-2*f+d),u=j*a+i*c,v=j*b+i*d,w=j*e+i*g,x=j*f+i*h,y=90-180*P.atan2(q-s,r-t)/Q;return{x:o,y:p,m:{x:q,y:r},n:{x:s,y:t},start:{x:u,y:v},end:{x:w,y:x},alpha:y}}function l(b,c,d,e,g,h,i,j){a.is(b,"array")||(b=[b,c,d,e,g,h,i,j]);var k=F.apply(null,b);return f(k.min.x,k.min.y,k.max.x-k.min.x,k.max.y-k.min.y)}function m(a,b,c){return b>=a.x&&b<=a.x+a.width&&c>=a.y&&c<=a.y+a.height}function n(a,b){return a=f(a),b=f(b),m(b,a.x,a.y)||m(b,a.x2,a.y)||m(b,a.x,a.y2)||m(b,a.x2,a.y2)||m(a,b.x,b.y)||m(a,b.x2,b.y)||m(a,b.x,b.y2)||m(a,b.x2,b.y2)||(a.x<b.x2&&a.x>b.x||b.x<a.x2&&b.x>a.x)&&(a.y<b.y2&&a.y>b.y||b.y<a.y2&&b.y>a.y)}function o(a,b,c,d,e){var f=-3*b+9*c-9*d+3*e,g=a*f+6*b-12*c+6*d;return a*g-3*b+3*c}function p(a,b,c,d,e,f,g,h,i){null==i&&(i=1),i=i>1?1:0>i?0:i;for(var j=i/2,k=12,l=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],m=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],n=0,p=0;k>p;p++){var q=j*l[p]+j,r=o(q,a,c,e,g),s=o(q,b,d,f,h),t=r*r+s*s;n+=m[p]*P.sqrt(t)}return j*n}function q(a,b,c,d,e,f,g,h,i){if(!(0>i||p(a,b,c,d,e,f,g,h)<i)){var j,k=1,l=k/2,m=k-l,n=.01;for(j=p(a,b,c,d,e,f,g,h,m);U(j-i)>n;)l/=2,m+=(i>j?1:-1)*l,j=p(a,b,c,d,e,f,g,h,m);return m}}function r(a,b,c,d,e,f,g,h){if(!(S(a,c)<R(e,g)||R(a,c)>S(e,g)||S(b,d)<R(f,h)||R(b,d)>S(f,h))){var i=(a*d-b*c)*(e-g)-(a-c)*(e*h-f*g),j=(a*d-b*c)*(f-h)-(b-d)*(e*h-f*g),k=(a-c)*(f-h)-(b-d)*(e-g);if(k){var l=i/k,m=j/k,n=+l.toFixed(2),o=+m.toFixed(2);if(!(n<+R(a,c).toFixed(2)||n>+S(a,c).toFixed(2)||n<+R(e,g).toFixed(2)||n>+S(e,g).toFixed(2)||o<+R(b,d).toFixed(2)||o>+S(b,d).toFixed(2)||o<+R(f,h).toFixed(2)||o>+S(f,h).toFixed(2)))return{x:l,y:m}}}}function s(a,b,c){var d=l(a),e=l(b);if(!n(d,e))return c?0:[];for(var f=p.apply(0,a),g=p.apply(0,b),h=~~(f/8),i=~~(g/8),j=[],m=[],o={},q=c?0:[],s=0;h+1>s;s++){var t=k.apply(0,a.concat(s/h));j.push({x:t.x,y:t.y,t:s/h})}for(s=0;i+1>s;s++)t=k.apply(0,b.concat(s/i)),m.push({x:t.x,y:t.y,t:s/i});for(s=0;h>s;s++)for(var u=0;i>u;u++){var v=j[s],w=j[s+1],x=m[u],y=m[u+1],z=U(w.x-v.x)<.001?"y":"x",A=U(y.x-x.x)<.001?"y":"x",B=r(v.x,v.y,w.x,w.y,x.x,x.y,y.x,y.y);if(B){if(o[B.x.toFixed(4)]==B.y.toFixed(4))continue;o[B.x.toFixed(4)]=B.y.toFixed(4);var C=v.t+U((B[z]-v[z])/(w[z]-v[z]))*(w.t-v.t),D=x.t+U((B[A]-x[A])/(y[A]-x[A]))*(y.t-x.t);C>=0&&1>=C&&D>=0&&1>=D&&(c?q++:q.push({x:B.x,y:B.y,t1:C,t2:D}))}}return q}function t(a,b){return v(a,b)}function u(a,b){return v(a,b,1)}function v(a,b,c){a=G(a),b=G(b);for(var d,e,f,g,h,i,j,k,l,m,n=c?0:[],o=0,p=a.length;p>o;o++){var q=a[o];if("M"==q[0])d=h=q[1],e=i=q[2];else{"C"==q[0]?(l=[d,e].concat(q.slice(1)),d=l[6],e=l[7]):(l=[d,e,d,e,h,i,h,i],d=h,e=i);for(var r=0,t=b.length;t>r;r++){var u=b[r];if("M"==u[0])f=j=u[1],g=k=u[2];else{"C"==u[0]?(m=[f,g].concat(u.slice(1)),f=m[6],g=m[7]):(m=[f,g,f,g,j,k,j,k],f=j,g=k);var v=s(l,m,c);if(c)n+=v;else{for(var w=0,x=v.length;x>w;w++)v[w].segment1=o,v[w].segment2=r,v[w].bez1=l,v[w].bez2=m;n=n.concat(v)}}}}}return n}function w(a,b,c){var d=x(a);return m(d,b,c)&&v(a,[["M",b,c],["H",d.x2+10]],1)%2==1}function x(a){var b=e(a);if(b.bbox)return L(b.bbox);if(!a)return f();a=G(a);for(var c,d=0,g=0,h=[],i=[],j=0,k=a.length;k>j;j++)if(c=a[j],"M"==c[0])d=c[1],g=c[2],h.push(d),i.push(g);else{var l=F(d,g,c[1],c[2],c[3],c[4],c[5],c[6]);h=h.concat(l.min.x,l.max.x),i=i.concat(l.min.y,l.max.y),d=c[5],g=c[6]}var m=R.apply(0,h),n=R.apply(0,i),o=S.apply(0,h),p=S.apply(0,i),q=f(m,n,o-m,p-n);return b.bbox=L(q),q}function y(a,b,c,d,e){if(e)return[["M",+a+ +e,b],["l",c-2*e,0],["a",e,e,0,0,1,e,e],["l",0,d-2*e],["a",e,e,0,0,1,-e,e],["l",2*e-c,0],["a",e,e,0,0,1,-e,-e],["l",0,2*e-d],["a",e,e,0,0,1,e,-e],["z"]];var f=[["M",a,b],["l",c,0],["l",0,d],["l",-c,0],["z"]];return f.toString=g,f}function z(a,b,c,d,e){if(null==e&&null==d&&(d=c),a=+a,b=+b,c=+c,d=+d,null!=e)var f=Math.PI/180,h=a+c*Math.cos(-d*f),i=a+c*Math.cos(-e*f),j=b+c*Math.sin(-d*f),k=b+c*Math.sin(-e*f),l=[["M",h,j],["A",c,c,0,+(e-d>180),0,i,k]];else l=[["M",a,b],["m",0,-d],["a",c,d,0,1,1,0,2*d],["a",c,d,0,1,1,0,-2*d],["z"]];return l.toString=g,l}function A(b){var c=e(b),d=String.prototype.toLowerCase;if(c.rel)return h(c.rel);a.is(b,"array")&&a.is(b&&b[0],"array")||(b=a.parsePathString(b));var f=[],i=0,j=0,k=0,l=0,m=0;"M"==b[0][0]&&(i=b[0][1],j=b[0][2],k=i,l=j,m++,f.push(["M",i,j]));for(var n=m,o=b.length;o>n;n++){var p=f[n]=[],q=b[n];if(q[0]!=d.call(q[0]))switch(p[0]=d.call(q[0]),p[0]){case"a":p[1]=q[1],p[2]=q[2],p[3]=q[3],p[4]=q[4],p[5]=q[5],p[6]=+(q[6]-i).toFixed(3),p[7]=+(q[7]-j).toFixed(3);break;case"v":p[1]=+(q[1]-j).toFixed(3);break;case"m":k=q[1],l=q[2];default:for(var r=1,s=q.length;s>r;r++)p[r]=+(q[r]-(r%2?i:j)).toFixed(3)}else{p=f[n]=[],"m"==q[0]&&(k=q[1]+i,l=q[2]+j);for(var t=0,u=q.length;u>t;t++)f[n][t]=q[t]}var v=f[n].length;switch(f[n][0]){case"z":i=k,j=l;break;case"h":i+=+f[n][v-1];break;case"v":j+=+f[n][v-1];break;default:i+=+f[n][v-2],j+=+f[n][v-1]}}return f.toString=g,c.rel=h(f),f}function B(b){var c=e(b);if(c.abs)return h(c.abs);if(K(b,"array")&&K(b&&b[0],"array")||(b=a.parsePathString(b)),!b||!b.length)return[["M",0,0]];var d,f=[],i=0,j=0,k=0,l=0,m=0;"M"==b[0][0]&&(i=+b[0][1],j=+b[0][2],k=i,l=j,m++,f[0]=["M",i,j]);for(var n,o,p=3==b.length&&"M"==b[0][0]&&"R"==b[1][0].toUpperCase()&&"Z"==b[2][0].toUpperCase(),q=m,r=b.length;r>q;q++){if(f.push(n=[]),o=b[q],d=o[0],d!=d.toUpperCase())switch(n[0]=d.toUpperCase(),n[0]){case"A":n[1]=o[1],n[2]=o[2],n[3]=o[3],n[4]=o[4],n[5]=o[5],n[6]=+o[6]+i,n[7]=+o[7]+j;break;case"V":n[1]=+o[1]+j;break;case"H":n[1]=+o[1]+i;break;case"R":for(var s=[i,j].concat(o.slice(1)),t=2,u=s.length;u>t;t++)s[t]=+s[t]+i,s[++t]=+s[t]+j;f.pop(),f=f.concat(I(s,p));break;case"O":f.pop(),s=z(i,j,o[1],o[2]),s.push(s[0]),f=f.concat(s);break;case"U":f.pop(),f=f.concat(z(i,j,o[1],o[2],o[3])),n=["U"].concat(f[f.length-1].slice(-2));break;case"M":k=+o[1]+i,l=+o[2]+j;default:for(t=1,u=o.length;u>t;t++)n[t]=+o[t]+(t%2?i:j)}else if("R"==d)s=[i,j].concat(o.slice(1)),f.pop(),f=f.concat(I(s,p)),n=["R"].concat(o.slice(-2));else if("O"==d)f.pop(),s=z(i,j,o[1],o[2]),s.push(s[0]),f=f.concat(s);else if("U"==d)f.pop(),f=f.concat(z(i,j,o[1],o[2],o[3])),n=["U"].concat(f[f.length-1].slice(-2));else for(var v=0,w=o.length;w>v;v++)n[v]=o[v];if(d=d.toUpperCase(),"O"!=d)switch(n[0]){case"Z":i=+k,j=+l;break;case"H":i=n[1];break;case"V":j=n[1];break;case"M":k=n[n.length-2],l=n[n.length-1];default:i=n[n.length-2],j=n[n.length-1]}}return f.toString=g,c.abs=h(f),f}function C(a,b,c,d){return[a,b,c,d,c,d]}function D(a,b,c,d,e,f){var g=1/3,h=2/3;return[g*a+h*c,g*b+h*d,g*e+h*c,g*f+h*d,e,f]}function E(b,c,d,e,f,g,h,i,j,k){var l,m=120*Q/180,n=Q/180*(+f||0),o=[],p=a._.cacher(function(a,b,c){var d=a*P.cos(c)-b*P.sin(c),e=a*P.sin(c)+b*P.cos(c);return{x:d,y:e}});if(!d||!e)return[b,c,i,j,i,j];if(k)y=k[0],z=k[1],w=k[2],x=k[3];else{l=p(b,c,-n),b=l.x,c=l.y,l=p(i,j,-n),i=l.x,j=l.y;var q=(P.cos(Q/180*f),P.sin(Q/180*f),(b-i)/2),r=(c-j)/2,s=q*q/(d*d)+r*r/(e*e);s>1&&(s=P.sqrt(s),d=s*d,e=s*e);var t=d*d,u=e*e,v=(g==h?-1:1)*P.sqrt(U((t*u-t*r*r-u*q*q)/(t*r*r+u*q*q))),w=v*d*r/e+(b+i)/2,x=v*-e*q/d+(c+j)/2,y=P.asin(((c-x)/e).toFixed(9)),z=P.asin(((j-x)/e).toFixed(9));y=w>b?Q-y:y,z=w>i?Q-z:z,0>y&&(y=2*Q+y),0>z&&(z=2*Q+z),h&&y>z&&(y-=2*Q),!h&&z>y&&(z-=2*Q)}var A=z-y;if(U(A)>m){var B=z,C=i,D=j;z=y+m*(h&&z>y?1:-1),i=w+d*P.cos(z),j=x+e*P.sin(z),o=E(i,j,d,e,f,0,h,C,D,[z,B,w,x])}A=z-y;var F=P.cos(y),G=P.sin(y),H=P.cos(z),I=P.sin(z),J=P.tan(A/4),K=4/3*d*J,L=4/3*e*J,M=[b,c],N=[b+K*G,c-L*F],O=[i+K*I,j-L*H],R=[i,j];if(N[0]=2*M[0]-N[0],N[1]=2*M[1]-N[1],k)return[N,O,R].concat(o);o=[N,O,R].concat(o).join().split(",");for(var S=[],T=0,V=o.length;V>T;T++)S[T]=T%2?p(o[T-1],o[T],n).y:p(o[T],o[T+1],n).x;return S}function F(a,b,c,d,e,f,g,h){for(var i,j,k,l,m,n,o,p,q=[],r=[[],[]],s=0;2>s;++s)if(0==s?(j=6*a-12*c+6*e,i=-3*a+9*c-9*e+3*g,k=3*c-3*a):(j=6*b-12*d+6*f,i=-3*b+9*d-9*f+3*h,k=3*d-3*b),U(i)<1e-12){if(U(j)<1e-12)continue;l=-k/j,l>0&&1>l&&q.push(l)}else o=j*j-4*k*i,p=P.sqrt(o),0>o||(m=(-j+p)/(2*i),m>0&&1>m&&q.push(m),n=(-j-p)/(2*i),n>0&&1>n&&q.push(n));for(var t,u=q.length,v=u;u--;)l=q[u],t=1-l,r[0][u]=t*t*t*a+3*t*t*l*c+3*t*l*l*e+l*l*l*g,r[1][u]=t*t*t*b+3*t*t*l*d+3*t*l*l*f+l*l*l*h;return r[0][v]=a,r[1][v]=b,r[0][v+1]=g,r[1][v+1]=h,r[0].length=r[1].length=v+2,{min:{x:R.apply(0,r[0]),y:R.apply(0,r[1])},max:{x:S.apply(0,r[0]),y:S.apply(0,r[1])}}}function G(a,b){var c=!b&&e(a);if(!b&&c.curve)return h(c.curve);for(var d=B(a),f=b&&B(b),g={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},i={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},j=(function(a,b,c){var d,e;if(!a)return["C",b.x,b.y,b.x,b.y,b.x,b.y];switch(!(a[0]in{T:1,Q:1})&&(b.qx=b.qy=null),a[0]){case"M":b.X=a[1],b.Y=a[2];break;case"A":a=["C"].concat(E.apply(0,[b.x,b.y].concat(a.slice(1))));break;case"S":"C"==c||"S"==c?(d=2*b.x-b.bx,e=2*b.y-b.by):(d=b.x,e=b.y),a=["C",d,e].concat(a.slice(1));break;case"T":"Q"==c||"T"==c?(b.qx=2*b.x-b.qx,b.qy=2*b.y-b.qy):(b.qx=b.x,b.qy=b.y),a=["C"].concat(D(b.x,b.y,b.qx,b.qy,a[1],a[2]));break;case"Q":b.qx=a[1],b.qy=a[2],a=["C"].concat(D(b.x,b.y,a[1],a[2],a[3],a[4]));break;case"L":a=["C"].concat(C(b.x,b.y,a[1],a[2]));break;case"H":a=["C"].concat(C(b.x,b.y,a[1],b.y));break;case"V":a=["C"].concat(C(b.x,b.y,b.x,a[1]));break;case"Z":a=["C"].concat(C(b.x,b.y,b.X,b.Y))}return a}),k=function(a,b){if(a[b].length>7){a[b].shift();for(var c=a[b];c.length;)m[b]="A",f&&(n[b]="A"),a.splice(b++,0,["C"].concat(c.splice(0,6)));a.splice(b,1),r=S(d.length,f&&f.length||0)}},l=function(a,b,c,e,g){a&&b&&"M"==a[g][0]&&"M"!=b[g][0]&&(b.splice(g,0,["M",e.x,e.y]),c.bx=0,c.by=0,c.x=a[g][1],c.y=a[g][2],r=S(d.length,f&&f.length||0))},m=[],n=[],o="",p="",q=0,r=S(d.length,f&&f.length||0);r>q;q++){d[q]&&(o=d[q][0]),"C"!=o&&(m[q]=o,q&&(p=m[q-1])),d[q]=j(d[q],g,p),"A"!=m[q]&&"C"==o&&(m[q]="C"),k(d,q),f&&(f[q]&&(o=f[q][0]),"C"!=o&&(n[q]=o,q&&(p=n[q-1])),f[q]=j(f[q],i,p),"A"!=n[q]&&"C"==o&&(n[q]="C"),k(f,q)),l(d,f,g,i,q),l(f,d,i,g,q);var s=d[q],t=f&&f[q],u=s.length,v=f&&t.length;g.x=s[u-2],g.y=s[u-1],g.bx=O(s[u-4])||g.x,g.by=O(s[u-3])||g.y,i.bx=f&&(O(t[v-4])||i.x),i.by=f&&(O(t[v-3])||i.y),i.x=f&&t[v-2],i.y=f&&t[v-1]}return f||(c.curve=h(d)),f?[d,f]:d}function H(a,b){if(!b)return a;var c,d,e,f,g,h,i;for(a=G(a),e=0,g=a.length;g>e;e++)for(i=a[e],f=1,h=i.length;h>f;f+=2)c=b.x(i[f],i[f+1]),d=b.y(i[f],i[f+1]),i[f]=c,i[f+1]=d;return a}function I(a,b){for(var c=[],d=0,e=a.length;e-2*!b>d;d+=2){var f=[{x:+a[d-2],y:+a[d-1]},{x:+a[d],y:+a[d+1]},{x:+a[d+2],y:+a[d+3]},{x:+a[d+4],y:+a[d+5]}];b?d?e-4==d?f[3]={x:+a[0],y:+a[1]}:e-2==d&&(f[2]={x:+a[0],y:+a[1]},f[3]={x:+a[2],y:+a[3]}):f[0]={x:+a[e-2],y:+a[e-1]}:e-4==d?f[3]=f[2]:d||(f[0]={x:+a[d],y:+a[d+1]}),c.push(["C",(-f[0].x+6*f[1].x+f[2].x)/6,(-f[0].y+6*f[1].y+f[2].y)/6,(f[1].x+6*f[2].x-f[3].x)/6,(f[1].y+6*f[2].y-f[3].y)/6,f[2].x,f[2].y])}return c}var J=b.prototype,K=a.is,L=a._.clone,M="hasOwnProperty",N=/,?([a-z]),?/gi,O=parseFloat,P=Math,Q=P.PI,R=P.min,S=P.max,T=P.pow,U=P.abs,V=j(1),W=j(),X=j(0,1),Y=a._unit2px,Z={path:function(a){return a.attr("path")},circle:function(a){var b=Y(a);return z(b.cx,b.cy,b.r)},ellipse:function(a){var b=Y(a);return z(b.cx||0,b.cy||0,b.rx,b.ry);
},rect:function(a){var b=Y(a);return y(b.x||0,b.y||0,b.width,b.height,b.rx,b.ry)},image:function(a){var b=Y(a);return y(b.x||0,b.y||0,b.width,b.height)},line:function(a){return"M"+[a.attr("x1")||0,a.attr("y1")||0,a.attr("x2"),a.attr("y2")]},polyline:function(a){return"M"+a.attr("points")},polygon:function(a){return"M"+a.attr("points")+"z"},deflt:function(a){var b=a.node.getBBox();return y(b.x,b.y,b.width,b.height)}};a.path=e,a.path.getTotalLength=V,a.path.getPointAtLength=W,a.path.getSubpath=function(a,b,c){if(this.getTotalLength(a)-c<1e-6)return X(a,b).end;var d=X(a,c,1);return b?X(d,b).end:d},J.getTotalLength=function(){return this.node.getTotalLength?this.node.getTotalLength():void 0},J.getPointAtLength=function(a){return W(this.attr("d"),a)},J.getSubpath=function(b,c){return a.path.getSubpath(this.attr("d"),b,c)},a._.box=f,a.path.findDotsAtSegment=k,a.path.bezierBBox=l,a.path.isPointInsideBBox=m,a.closest=function(b,c,d,e){for(var g=100,h=f(b-g/2,c-g/2,g,g),i=[],j=d[0].hasOwnProperty("x")?function(a){return{x:d[a].x,y:d[a].y}}:function(a){return{x:d[a],y:e[a]}},k=0;1e6>=g&&!k;){for(var l=0,n=d.length;n>l;l++){var o=j(l);if(m(h,o.x,o.y)){k++,i.push(o);break}}k||(g*=2,h=f(b-g/2,c-g/2,g,g))}if(1e6!=g){var p,q=1/0;for(l=0,n=i.length;n>l;l++){var r=a.len(b,c,i[l].x,i[l].y);q>r&&(q=r,i[l].len=r,p=i[l])}return p}},a.path.isBBoxIntersect=n,a.path.intersection=t,a.path.intersectionNumber=u,a.path.isPointInside=w,a.path.getBBox=x,a.path.get=Z,a.path.toRelative=A,a.path.toAbsolute=B,a.path.toCubic=G,a.path.map=H,a.path.toString=g,a.path.clone=h}),d.plugin(function(a,d,e,f){var g=Math.max,h=Math.min,i=function(a){if(this.items=[],this.bindings={},this.length=0,this.type="set",a)for(var b=0,c=a.length;c>b;b++)a[b]&&(this[this.items.length]=this.items[this.items.length]=a[b],this.length++)},j=i.prototype;j.push=function(){for(var a,b,c=0,d=arguments.length;d>c;c++)a=arguments[c],a&&(b=this.items.length,this[b]=this.items[b]=a,this.length++);return this},j.pop=function(){return this.length&&delete this[this.length--],this.items.pop()},j.forEach=function(a,b){for(var c=0,d=this.items.length;d>c;c++)if(a.call(b,this.items[c],c)===!1)return this;return this},j.animate=function(d,e,f,g){"function"!=typeof f||f.length||(g=f,f=c.linear),d instanceof a._.Animation&&(g=d.callback,f=d.easing,e=f.dur,d=d.attr);var h=arguments;if(a.is(d,"array")&&a.is(h[h.length-1],"array"))var i=!0;var j,k=function(){j?this.b=j:j=this.b},l=0,m=this,n=g&&function(){++l==m.length&&g.call(this)};return this.forEach(function(a,c){b.once("snap.animcreated."+a.id,k),i?h[c]&&a.animate.apply(a,h[c]):a.animate(d,e,f,n)})},j.remove=function(){for(;this.length;)this.pop().remove();return this},j.bind=function(a,b,c){var d={};if("function"==typeof b)this.bindings[a]=b;else{var e=c||a;this.bindings[a]=function(a){d[e]=a,b.attr(d)}}return this},j.attr=function(a){var b={};for(var c in a)this.bindings[c]?this.bindings[c](a[c]):b[c]=a[c];for(var d=0,e=this.items.length;e>d;d++)this.items[d].attr(b);return this},j.clear=function(){for(;this.length;)this.pop()},j.splice=function(a,b,c){a=0>a?g(this.length+a,0):a,b=g(0,h(this.length-a,b));var d,e=[],f=[],j=[];for(d=2;d<arguments.length;d++)j.push(arguments[d]);for(d=0;b>d;d++)f.push(this[a+d]);for(;d<this.length-a;d++)e.push(this[a+d]);var k=j.length;for(d=0;d<k+e.length;d++)this.items[a+d]=this[a+d]=k>d?j[d]:e[d-k];for(d=this.items.length=this.length-=b-k;this[d];)delete this[d++];return new i(f)},j.exclude=function(a){for(var b=0,c=this.length;c>b;b++)if(this[b]==a)return this.splice(b,1),!0;return!1},j.insertAfter=function(a){for(var b=this.items.length;b--;)this.items[b].insertAfter(a);return this},j.getBBox=function(){for(var a=[],b=[],c=[],d=[],e=this.items.length;e--;)if(!this.items[e].removed){var f=this.items[e].getBBox();a.push(f.x),b.push(f.y),c.push(f.x+f.width),d.push(f.y+f.height)}return a=h.apply(0,a),b=h.apply(0,b),c=g.apply(0,c),d=g.apply(0,d),{x:a,y:b,x2:c,y2:d,width:c-a,height:d-b,cx:a+(c-a)/2,cy:b+(d-b)/2}},j.clone=function(a){a=new i;for(var b=0,c=this.items.length;c>b;b++)a.push(this.items[b].clone());return a},j.toString=function(){return"Snaps set"},j.type="set",a.Set=i,a.set=function(){var a=new i;return arguments.length&&a.push.apply(a,Array.prototype.slice.call(arguments,0)),a}}),d.plugin(function(a,c,d,e){function f(a){var b=a[0];switch(b.toLowerCase()){case"t":return[b,0,0];case"m":return[b,1,0,0,1,0,0];case"r":return 4==a.length?[b,0,a[2],a[3]]:[b,0];case"s":return 5==a.length?[b,1,1,a[3],a[4]]:3==a.length?[b,1,1]:[b,1]}}function g(b,c,d){b=b||new a.Matrix,c=c||new a.Matrix,b=a.parseTransformString(b.toTransformString())||[],c=a.parseTransformString(c.toTransformString())||[];for(var e,g,h,i,j=Math.max(b.length,c.length),k=[],n=[],o=0;j>o;o++){if(h=b[o]||f(c[o]),i=c[o]||f(h),h[0]!=i[0]||"r"==h[0].toLowerCase()&&(h[2]!=i[2]||h[3]!=i[3])||"s"==h[0].toLowerCase()&&(h[3]!=i[3]||h[4]!=i[4])){b=a._.transform2matrix(b,d()),c=a._.transform2matrix(c,d()),k=[["m",b.a,b.b,b.c,b.d,b.e,b.f]],n=[["m",c.a,c.b,c.c,c.d,c.e,c.f]];break}for(k[o]=[],n[o]=[],e=0,g=Math.max(h.length,i.length);g>e;e++)e in h&&(k[o][e]=h[e]),e in i&&(n[o][e]=i[e])}return{from:m(k),to:m(n),f:l(k)}}function h(a){return a}function i(a){return function(b){return+b.toFixed(3)+a}}function j(a){return a.join(" ")}function k(b){return a.rgb(b[0],b[1],b[2],b[3])}function l(a){var b,c,d,e,f,g,h=0,i=[];for(b=0,c=a.length;c>b;b++){for(f="[",g=['"'+a[b][0]+'"'],d=1,e=a[b].length;e>d;d++)g[d]="val["+h++ +"]";f+=g+"]",i[b]=f}return Function("val","return Snap.path.toString.call(["+i+"])")}function m(a){for(var b=[],c=0,d=a.length;d>c;c++)for(var e=1,f=a[c].length;f>e;e++)b.push(a[c][e]);return b}function n(a){return isFinite(a)}function o(b,c){return a.is(b,"array")&&a.is(c,"array")?b.toString()==c.toString():!1}var p={},q=/[%a-z]+$/i,r=String;p.stroke=p.fill="colour",c.prototype.equal=function(a,c){return b("snap.util.equal",this,a,c).firstDefined()},b.on("snap.util.equal",function(b,c){var d,e,f=r(this.attr(b)||""),s=this;if("colour"==p[b])return d=a.color(f),e=a.color(c),{from:[d.r,d.g,d.b,d.opacity],to:[e.r,e.g,e.b,e.opacity],f:k};if("viewBox"==b)return d=this.attr(b).vb.split(" ").map(Number),e=c.split(" ").map(Number),{from:d,to:e,f:j};if("transform"==b||"gradientTransform"==b||"patternTransform"==b)return"string"==typeof c&&(c=r(c).replace(/\.{3}|\u2026/g,f)),f=this.matrix,c=a._.rgTransform.test(c)?a._.transform2matrix(c,this.getBBox()):a._.transform2matrix(a._.svgTransform2string(c),this.getBBox()),g(f,c,function(){return s.getBBox(1)});if("d"==b||"path"==b)return d=a.path.toCubic(f,c),{from:m(d[0]),to:m(d[1]),f:l(d[0])};if("points"==b)return d=r(f).split(a._.separator),e=r(c).split(a._.separator),{from:d,to:e,f:function(a){return a}};if(n(f)&&n(c))return{from:parseFloat(f),to:parseFloat(c),f:h};var t=f.match(q),u=r(c).match(q);return t&&o(t,u)?{from:parseFloat(f),to:parseFloat(c),f:i(t)}:{from:this.asPX(b),to:this.asPX(b,c),f:h}})}),d.plugin(function(a,c,d,e){for(var f=c.prototype,g="hasOwnProperty",h=("createTouch"in e.doc),i=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","touchstart","touchmove","touchend","touchcancel"],j={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},k=(function(a,b){var c="y"==a?"scrollTop":"scrollLeft",d=b&&b.node?b.node.ownerDocument:e.doc;return d[c in d.documentElement?"documentElement":"body"][c]}),l=function(){return this.originalEvent.preventDefault()},m=function(){return this.originalEvent.stopPropagation()},n=function(a,b,c,d){var e=h&&j[b]?j[b]:b,f=function(e){var f=k("y",d),i=k("x",d);if(h&&j[g](b))for(var n=0,o=e.targetTouches&&e.targetTouches.length;o>n;n++)if(e.targetTouches[n].target==a||a.contains(e.targetTouches[n].target)){var p=e;e=e.targetTouches[n],e.originalEvent=p,e.preventDefault=l,e.stopPropagation=m;break}var q=e.clientX+i,r=e.clientY+f;return c.call(d,e,q,r)};return b!==e&&a.addEventListener(b,f,!1),a.addEventListener(e,f,!1),function(){return b!==e&&a.removeEventListener(b,f,!1),a.removeEventListener(e,f,!1),!0}},o=[],p=function(a){for(var c,d=a.clientX,e=a.clientY,f=k("y"),g=k("x"),i=o.length;i--;){if(c=o[i],h){for(var j,l=a.touches&&a.touches.length;l--;)if(j=a.touches[l],j.identifier==c.el._drag.id||c.el.node.contains(j.target)){d=j.clientX,e=j.clientY,(a.originalEvent?a.originalEvent:a).preventDefault();break}}else a.preventDefault();var m=c.el.node;m.nextSibling,m.parentNode,m.style.display;d+=g,e+=f,b("snap.drag.move."+c.el.id,c.move_scope||c.el,d-c.el._drag.x,e-c.el._drag.y,d,e,a)}},q=function(c){a.unmousemove(p).unmouseup(q);for(var d,e=o.length;e--;)d=o[e],d.el._drag={},b("snap.drag.end."+d.el.id,d.end_scope||d.start_scope||d.move_scope||d.el,c),b.off("snap.drag.*."+d.el.id);o=[]},r=i.length;r--;)!function(b){a[b]=f[b]=function(c,d){if(a.is(c,"function"))this.events=this.events||[],this.events.push({name:b,f:c,unbind:n(this.node||document,b,c,d||this)});else for(var e=0,f=this.events.length;f>e;e++)if(this.events[e].name==b)try{this.events[e].f.call(this)}catch(g){}return this},a["un"+b]=f["un"+b]=function(a){for(var c=this.events||[],d=c.length;d--;)if(c[d].name==b&&(c[d].f==a||!a))return c[d].unbind(),c.splice(d,1),!c.length&&delete this.events,this;return this}}(i[r]);f.hover=function(a,b,c,d){return this.mouseover(a,c).mouseout(b,d||c)},f.unhover=function(a,b){return this.unmouseover(a).unmouseout(b)};var s=[];f.drag=function(c,d,e,f,g,h){function i(i,j,l){(i.originalEvent||i).preventDefault(),k._drag.x=j,k._drag.y=l,k._drag.id=i.identifier,!o.length&&a.mousemove(p).mouseup(q),o.push({el:k,move_scope:f,start_scope:g,end_scope:h}),d&&b.on("snap.drag.start."+k.id,d),c&&b.on("snap.drag.move."+k.id,c),e&&b.on("snap.drag.end."+k.id,e),b("snap.drag.start."+k.id,g||f||k,j,l,i)}function j(a,c,d){b("snap.draginit."+k.id,k,a,c,d)}var k=this;if(!arguments.length){var l;return k.drag(function(a,b){this.attr({transform:l+(l?"T":"t")+[a,b]})},function(){l=this.transform().local})}return b.on("snap.draginit."+k.id,i),k._drag={},s.push({el:k,start:i,init:j}),k.mousedown(j),k},f.undrag=function(){for(var c=s.length;c--;)s[c].el==this&&(this.unmousedown(s[c].init),s.splice(c,1),b.unbind("snap.drag.*."+this.id),b.unbind("snap.draginit."+this.id));return!s.length&&a.unmousemove(p).unmouseup(q),this}}),d.plugin(function(a,c,d,e){var f=(c.prototype,d.prototype),g=/^\s*url\((.+)\)/,h=String,i=a._.$;a.filter={},f.filter=function(b){var d=this;"svg"!=d.type&&(d=d.paper);var e=a.parse(h(b)),f=a._.id(),g=(d.node.offsetWidth,d.node.offsetHeight,i("filter"));return i(g,{id:f,filterUnits:"userSpaceOnUse"}),g.appendChild(e.node),d.defs.appendChild(g),new c(g)},b.on("snap.util.getattr.filter",function(){b.stop();var c=i(this.node,"filter");if(c){var d=h(c).match(g);return d&&a.select(d[1])}}),b.on("snap.util.attr.filter",function(d){if(d instanceof c&&"filter"==d.type){b.stop();var e=d.node.id;e||(i(d.node,{id:d.id}),e=d.id),i(this.node,{filter:a.url(e)})}d&&"none"!=d||(b.stop(),this.node.removeAttribute("filter"))}),a.filter.blur=function(b,c){null==b&&(b=2);var d=null==c?b:[b,c];return a.format('<feGaussianBlur stdDeviation="{def}"/>',{def:d})},a.filter.blur.toString=function(){return this()},a.filter.shadow=function(b,c,d,e,f){return null==f&&(null==e?(f=d,d=4,e="#000"):(f=e,e=d,d=4)),null==d&&(d=4),null==f&&(f=1),null==b&&(b=0,c=2),null==c&&(c=b),e=a.color(e),a.format('<feGaussianBlur in="SourceAlpha" stdDeviation="{blur}"/><feOffset dx="{dx}" dy="{dy}" result="offsetblur"/><feFlood flood-color="{color}"/><feComposite in2="offsetblur" operator="in"/><feComponentTransfer><feFuncA type="linear" slope="{opacity}"/></feComponentTransfer><feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge>',{color:e,dx:b,dy:c,blur:d,opacity:f})},a.filter.shadow.toString=function(){return this()},a.filter.grayscale=function(b){return null==b&&(b=1),a.format('<feColorMatrix type="matrix" values="{a} {b} {c} 0 0 {d} {e} {f} 0 0 {g} {b} {h} 0 0 0 0 0 1 0"/>',{a:.2126+.7874*(1-b),b:.7152-.7152*(1-b),c:.0722-.0722*(1-b),d:.2126-.2126*(1-b),e:.7152+.2848*(1-b),f:.0722-.0722*(1-b),g:.2126-.2126*(1-b),h:.0722+.9278*(1-b)})},a.filter.grayscale.toString=function(){return this()},a.filter.sepia=function(b){return null==b&&(b=1),a.format('<feColorMatrix type="matrix" values="{a} {b} {c} 0 0 {d} {e} {f} 0 0 {g} {h} {i} 0 0 0 0 0 1 0"/>',{a:.393+.607*(1-b),b:.769-.769*(1-b),c:.189-.189*(1-b),d:.349-.349*(1-b),e:.686+.314*(1-b),f:.168-.168*(1-b),g:.272-.272*(1-b),h:.534-.534*(1-b),i:.131+.869*(1-b)})},a.filter.sepia.toString=function(){return this()},a.filter.saturate=function(b){return null==b&&(b=1),a.format('<feColorMatrix type="saturate" values="{amount}"/>',{amount:1-b})},a.filter.saturate.toString=function(){return this()},a.filter.hueRotate=function(b){return b=b||0,a.format('<feColorMatrix type="hueRotate" values="{angle}"/>',{angle:b})},a.filter.hueRotate.toString=function(){return this()},a.filter.invert=function(b){return null==b&&(b=1),a.format('<feComponentTransfer><feFuncR type="table" tableValues="{amount} {amount2}"/><feFuncG type="table" tableValues="{amount} {amount2}"/><feFuncB type="table" tableValues="{amount} {amount2}"/></feComponentTransfer>',{amount:b,amount2:1-b})},a.filter.invert.toString=function(){return this()},a.filter.brightness=function(b){return null==b&&(b=1),a.format('<feComponentTransfer><feFuncR type="linear" slope="{amount}"/><feFuncG type="linear" slope="{amount}"/><feFuncB type="linear" slope="{amount}"/></feComponentTransfer>',{amount:b})},a.filter.brightness.toString=function(){return this()},a.filter.contrast=function(b){return null==b&&(b=1),a.format('<feComponentTransfer><feFuncR type="linear" slope="{amount}" intercept="{amount2}"/><feFuncG type="linear" slope="{amount}" intercept="{amount2}"/><feFuncB type="linear" slope="{amount}" intercept="{amount2}"/></feComponentTransfer>',{amount:b,amount2:.5-b/2})},a.filter.contrast.toString=function(){return this()}}),d.plugin(function(a,b,c,d,e){var f=a._.box,g=a.is,h=/^[^a-z]*([tbmlrc])/i,i=function(){return"T"+this.dx+","+this.dy};b.prototype.getAlign=function(a,b){null==b&&g(a,"string")&&(b=a,a=null),a=a||this.paper;var c=a.getBBox?a.getBBox():f(a),d=this.getBBox(),e={};switch(b=b&&b.match(h),b=b?b[1].toLowerCase():"c"){case"t":e.dx=0,e.dy=c.y-d.y;break;case"b":e.dx=0,e.dy=c.y2-d.y2;break;case"m":e.dx=0,e.dy=c.cy-d.cy;break;case"l":e.dx=c.x-d.x,e.dy=0;break;case"r":e.dx=c.x2-d.x2,e.dy=0;break;default:e.dx=c.cx-d.cx,e.dy=0}return e.toString=i,e},b.prototype.align=function(a,b){return this.transform("..."+this.getAlign(a,b))}}),d.plugin(function(b,c,d,e){function f(a){a=a.split(/(?=#)/);var b=new String(a[5]);return b[50]=a[0],b[100]=a[1],b[200]=a[2],b[300]=a[3],b[400]=a[4],b[500]=a[5],b[600]=a[6],b[700]=a[7],b[800]=a[8],b[900]=a[9],a[10]&&(b.A100=a[10],b.A200=a[11],b.A400=a[12],b.A700=a[13]),b}var g="#ffebee#ffcdd2#ef9a9a#e57373#ef5350#f44336#e53935#d32f2f#c62828#b71c1c#ff8a80#ff5252#ff1744#d50000",h="#FCE4EC#F8BBD0#F48FB1#F06292#EC407A#E91E63#D81B60#C2185B#AD1457#880E4F#FF80AB#FF4081#F50057#C51162",i="#F3E5F5#E1BEE7#CE93D8#BA68C8#AB47BC#9C27B0#8E24AA#7B1FA2#6A1B9A#4A148C#EA80FC#E040FB#D500F9#AA00FF",j="#EDE7F6#D1C4E9#B39DDB#9575CD#7E57C2#673AB7#5E35B1#512DA8#4527A0#311B92#B388FF#7C4DFF#651FFF#6200EA",k="#E8EAF6#C5CAE9#9FA8DA#7986CB#5C6BC0#3F51B5#3949AB#303F9F#283593#1A237E#8C9EFF#536DFE#3D5AFE#304FFE",l="#E3F2FD#BBDEFB#90CAF9#64B5F6#64B5F6#2196F3#1E88E5#1976D2#1565C0#0D47A1#82B1FF#448AFF#2979FF#2962FF",m="#E1F5FE#B3E5FC#81D4FA#4FC3F7#29B6F6#03A9F4#039BE5#0288D1#0277BD#01579B#80D8FF#40C4FF#00B0FF#0091EA",n="#E0F7FA#B2EBF2#80DEEA#4DD0E1#26C6DA#00BCD4#00ACC1#0097A7#00838F#006064#84FFFF#18FFFF#00E5FF#00B8D4",o="#E0F2F1#B2DFDB#80CBC4#4DB6AC#26A69A#009688#00897B#00796B#00695C#004D40#A7FFEB#64FFDA#1DE9B6#00BFA5",p="#E8F5E9#C8E6C9#A5D6A7#81C784#66BB6A#4CAF50#43A047#388E3C#2E7D32#1B5E20#B9F6CA#69F0AE#00E676#00C853",q="#F1F8E9#DCEDC8#C5E1A5#AED581#9CCC65#8BC34A#7CB342#689F38#558B2F#33691E#CCFF90#B2FF59#76FF03#64DD17",r="#F9FBE7#F0F4C3#E6EE9C#DCE775#D4E157#CDDC39#C0CA33#AFB42B#9E9D24#827717#F4FF81#EEFF41#C6FF00#AEEA00",s="#FFFDE7#FFF9C4#FFF59D#FFF176#FFEE58#FFEB3B#FDD835#FBC02D#F9A825#F57F17#FFFF8D#FFFF00#FFEA00#FFD600",t="#FFF8E1#FFECB3#FFE082#FFD54F#FFCA28#FFC107#FFB300#FFA000#FF8F00#FF6F00#FFE57F#FFD740#FFC400#FFAB00",u="#FFF3E0#FFE0B2#FFCC80#FFB74D#FFA726#FF9800#FB8C00#F57C00#EF6C00#E65100#FFD180#FFAB40#FF9100#FF6D00",v="#FBE9E7#FFCCBC#FFAB91#FF8A65#FF7043#FF5722#F4511E#E64A19#D84315#BF360C#FF9E80#FF6E40#FF3D00#DD2C00",w="#EFEBE9#D7CCC8#BCAAA4#A1887F#8D6E63#795548#6D4C41#5D4037#4E342E#3E2723",x="#FAFAFA#F5F5F5#EEEEEE#E0E0E0#BDBDBD#9E9E9E#757575#616161#424242#212121",y="#ECEFF1#CFD8DC#B0BEC5#90A4AE#78909C#607D8B#546E7A#455A64#37474F#263238";b.mui={},b.flat={},b.mui.red=f(g),b.mui.pink=f(h),b.mui.purple=f(i),b.mui.deeppurple=f(j),b.mui.indigo=f(k),b.mui.blue=f(l),b.mui.lightblue=f(m),b.mui.cyan=f(n),b.mui.teal=f(o),b.mui.green=f(p),b.mui.lightgreen=f(q),b.mui.lime=f(r),b.mui.yellow=f(s),b.mui.amber=f(t),b.mui.orange=f(u),b.mui.deeporange=f(v),b.mui.brown=f(w),b.mui.grey=f(x),b.mui.bluegrey=f(y),b.flat.turquoise="#1abc9c",b.flat.greensea="#16a085",b.flat.sunflower="#f1c40f",b.flat.orange="#f39c12",b.flat.emerland="#2ecc71",b.flat.nephritis="#27ae60",b.flat.carrot="#e67e22",b.flat.pumpkin="#d35400",b.flat.peterriver="#3498db",b.flat.belizehole="#2980b9",b.flat.alizarin="#e74c3c",b.flat.pomegranate="#c0392b",b.flat.amethyst="#9b59b6",b.flat.wisteria="#8e44ad",b.flat.clouds="#ecf0f1",b.flat.silver="#bdc3c7",b.flat.wetasphalt="#34495e",b.flat.midnightblue="#2c3e50",b.flat.concrete="#95a5a6",b.flat.asbestos="#7f8c8d",b.importMUIColors=function(){for(var c in b.mui)b.mui.hasOwnProperty(c)&&(a[c]=b.mui[c])}}),d});
/*! jQuery v1.8.3 jquery.com | jquery.org/license */
(function(e,t){function _(e){var t=M[e]={};return v.each(e.split(y),function(e,n){t[n]=!0}),t}function H(e,n,r){if(r===t&&e.nodeType===1){var i="data-"+n.replace(P,"-$1").toLowerCase();r=e.getAttribute(i);if(typeof r=="string"){try{r=r==="true"?!0:r==="false"?!1:r==="null"?null:+r+""===r?+r:D.test(r)?v.parseJSON(r):r}catch(s){}v.data(e,n,r)}else r=t}return r}function B(e){var t;for(t in e){if(t==="data"&&v.isEmptyObject(e[t]))continue;if(t!=="toJSON")return!1}return!0}function et(){return!1}function tt(){return!0}function ut(e){return!e||!e.parentNode||e.parentNode.nodeType===11}function at(e,t){do e=e[t];while(e&&e.nodeType!==1);return e}function ft(e,t,n){t=t||0;if(v.isFunction(t))return v.grep(e,function(e,r){var i=!!t.call(e,r,e);return i===n});if(t.nodeType)return v.grep(e,function(e,r){return e===t===n});if(typeof t=="string"){var r=v.grep(e,function(e){return e.nodeType===1});if(it.test(t))return v.filter(t,r,!n);t=v.filter(t,r)}return v.grep(e,function(e,r){return v.inArray(e,t)>=0===n})}function lt(e){var t=ct.split("|"),n=e.createDocumentFragment();if(n.createElement)while(t.length)n.createElement(t.pop());return n}function Lt(e,t){return e.getElementsByTagName(t)[0]||e.appendChild(e.ownerDocument.createElement(t))}function At(e,t){if(t.nodeType!==1||!v.hasData(e))return;var n,r,i,s=v._data(e),o=v._data(t,s),u=s.events;if(u){delete o.handle,o.events={};for(n in u)for(r=0,i=u[n].length;r<i;r++)v.event.add(t,n,u[n][r])}o.data&&(o.data=v.extend({},o.data))}function Ot(e,t){var n;if(t.nodeType!==1)return;t.clearAttributes&&t.clearAttributes(),t.mergeAttributes&&t.mergeAttributes(e),n=t.nodeName.toLowerCase(),n==="object"?(t.parentNode&&(t.outerHTML=e.outerHTML),v.support.html5Clone&&e.innerHTML&&!v.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):n==="input"&&Et.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):n==="option"?t.selected=e.defaultSelected:n==="input"||n==="textarea"?t.defaultValue=e.defaultValue:n==="script"&&t.text!==e.text&&(t.text=e.text),t.removeAttribute(v.expando)}function Mt(e){return typeof e.getElementsByTagName!="undefined"?e.getElementsByTagName("*"):typeof e.querySelectorAll!="undefined"?e.querySelectorAll("*"):[]}function _t(e){Et.test(e.type)&&(e.defaultChecked=e.checked)}function Qt(e,t){if(t in e)return t;var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=Jt.length;while(i--){t=Jt[i]+n;if(t in e)return t}return r}function Gt(e,t){return e=t||e,v.css(e,"display")==="none"||!v.contains(e.ownerDocument,e)}function Yt(e,t){var n,r,i=[],s=0,o=e.length;for(;s<o;s++){n=e[s];if(!n.style)continue;i[s]=v._data(n,"olddisplay"),t?(!i[s]&&n.style.display==="none"&&(n.style.display=""),n.style.display===""&&Gt(n)&&(i[s]=v._data(n,"olddisplay",nn(n.nodeName)))):(r=Dt(n,"display"),!i[s]&&r!=="none"&&v._data(n,"olddisplay",r))}for(s=0;s<o;s++){n=e[s];if(!n.style)continue;if(!t||n.style.display==="none"||n.style.display==="")n.style.display=t?i[s]||"":"none"}return e}function Zt(e,t,n){var r=Rt.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function en(e,t,n,r){var i=n===(r?"border":"content")?4:t==="width"?1:0,s=0;for(;i<4;i+=2)n==="margin"&&(s+=v.css(e,n+$t[i],!0)),r?(n==="content"&&(s-=parseFloat(Dt(e,"padding"+$t[i]))||0),n!=="margin"&&(s-=parseFloat(Dt(e,"border"+$t[i]+"Width"))||0)):(s+=parseFloat(Dt(e,"padding"+$t[i]))||0,n!=="padding"&&(s+=parseFloat(Dt(e,"border"+$t[i]+"Width"))||0));return s}function tn(e,t,n){var r=t==="width"?e.offsetWidth:e.offsetHeight,i=!0,s=v.support.boxSizing&&v.css(e,"boxSizing")==="border-box";if(r<=0||r==null){r=Dt(e,t);if(r<0||r==null)r=e.style[t];if(Ut.test(r))return r;i=s&&(v.support.boxSizingReliable||r===e.style[t]),r=parseFloat(r)||0}return r+en(e,t,n||(s?"border":"content"),i)+"px"}function nn(e){if(Wt[e])return Wt[e];var t=v("<"+e+">").appendTo(i.body),n=t.css("display");t.remove();if(n==="none"||n===""){Pt=i.body.appendChild(Pt||v.extend(i.createElement("iframe"),{frameBorder:0,width:0,height:0}));if(!Ht||!Pt.createElement)Ht=(Pt.contentWindow||Pt.contentDocument).document,Ht.write("<!doctype html><html><body>"),Ht.close();t=Ht.body.appendChild(Ht.createElement(e)),n=Dt(t,"display"),i.body.removeChild(Pt)}return Wt[e]=n,n}function fn(e,t,n,r){var i;if(v.isArray(t))v.each(t,function(t,i){n||sn.test(e)?r(e,i):fn(e+"["+(typeof i=="object"?t:"")+"]",i,n,r)});else if(!n&&v.type(t)==="object")for(i in t)fn(e+"["+i+"]",t[i],n,r);else r(e,t)}function Cn(e){return function(t,n){typeof t!="string"&&(n=t,t="*");var r,i,s,o=t.toLowerCase().split(y),u=0,a=o.length;if(v.isFunction(n))for(;u<a;u++)r=o[u],s=/^\+/.test(r),s&&(r=r.substr(1)||"*"),i=e[r]=e[r]||[],i[s?"unshift":"push"](n)}}function kn(e,n,r,i,s,o){s=s||n.dataTypes[0],o=o||{},o[s]=!0;var u,a=e[s],f=0,l=a?a.length:0,c=e===Sn;for(;f<l&&(c||!u);f++)u=a[f](n,r,i),typeof u=="string"&&(!c||o[u]?u=t:(n.dataTypes.unshift(u),u=kn(e,n,r,i,u,o)));return(c||!u)&&!o["*"]&&(u=kn(e,n,r,i,"*",o)),u}function Ln(e,n){var r,i,s=v.ajaxSettings.flatOptions||{};for(r in n)n[r]!==t&&((s[r]?e:i||(i={}))[r]=n[r]);i&&v.extend(!0,e,i)}function An(e,n,r){var i,s,o,u,a=e.contents,f=e.dataTypes,l=e.responseFields;for(s in l)s in r&&(n[l[s]]=r[s]);while(f[0]==="*")f.shift(),i===t&&(i=e.mimeType||n.getResponseHeader("content-type"));if(i)for(s in a)if(a[s]&&a[s].test(i)){f.unshift(s);break}if(f[0]in r)o=f[0];else{for(s in r){if(!f[0]||e.converters[s+" "+f[0]]){o=s;break}u||(u=s)}o=o||u}if(o)return o!==f[0]&&f.unshift(o),r[o]}function On(e,t){var n,r,i,s,o=e.dataTypes.slice(),u=o[0],a={},f=0;e.dataFilter&&(t=e.dataFilter(t,e.dataType));if(o[1])for(n in e.converters)a[n.toLowerCase()]=e.converters[n];for(;i=o[++f];)if(i!=="*"){if(u!=="*"&&u!==i){n=a[u+" "+i]||a["* "+i];if(!n)for(r in a){s=r.split(" ");if(s[1]===i){n=a[u+" "+s[0]]||a["* "+s[0]];if(n){n===!0?n=a[r]:a[r]!==!0&&(i=s[0],o.splice(f--,0,i));break}}}if(n!==!0)if(n&&e["throws"])t=n(t);else try{t=n(t)}catch(l){return{state:"parsererror",error:n?l:"No conversion from "+u+" to "+i}}}u=i}return{state:"success",data:t}}function Fn(){try{return new e.XMLHttpRequest}catch(t){}}function In(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}function $n(){return setTimeout(function(){qn=t},0),qn=v.now()}function Jn(e,t){v.each(t,function(t,n){var r=(Vn[t]||[]).concat(Vn["*"]),i=0,s=r.length;for(;i<s;i++)if(r[i].call(e,t,n))return})}function Kn(e,t,n){var r,i=0,s=0,o=Xn.length,u=v.Deferred().always(function(){delete a.elem}),a=function(){var t=qn||$n(),n=Math.max(0,f.startTime+f.duration-t),r=n/f.duration||0,i=1-r,s=0,o=f.tweens.length;for(;s<o;s++)f.tweens[s].run(i);return u.notifyWith(e,[f,i,n]),i<1&&o?n:(u.resolveWith(e,[f]),!1)},f=u.promise({elem:e,props:v.extend({},t),opts:v.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:qn||$n(),duration:n.duration,tweens:[],createTween:function(t,n,r){var i=v.Tween(e,f.opts,t,n,f.opts.specialEasing[t]||f.opts.easing);return f.tweens.push(i),i},stop:function(t){var n=0,r=t?f.tweens.length:0;for(;n<r;n++)f.tweens[n].run(1);return t?u.resolveWith(e,[f,t]):u.rejectWith(e,[f,t]),this}}),l=f.props;Qn(l,f.opts.specialEasing);for(;i<o;i++){r=Xn[i].call(f,e,l,f.opts);if(r)return r}return Jn(f,l),v.isFunction(f.opts.start)&&f.opts.start.call(e,f),v.fx.timer(v.extend(a,{anim:f,queue:f.opts.queue,elem:e})),f.progress(f.opts.progress).done(f.opts.done,f.opts.complete).fail(f.opts.fail).always(f.opts.always)}function Qn(e,t){var n,r,i,s,o;for(n in e){r=v.camelCase(n),i=t[r],s=e[n],v.isArray(s)&&(i=s[1],s=e[n]=s[0]),n!==r&&(e[r]=s,delete e[n]),o=v.cssHooks[r];if(o&&"expand"in o){s=o.expand(s),delete e[r];for(n in s)n in e||(e[n]=s[n],t[n]=i)}else t[r]=i}}function Gn(e,t,n){var r,i,s,o,u,a,f,l,c,h=this,p=e.style,d={},m=[],g=e.nodeType&&Gt(e);n.queue||(l=v._queueHooks(e,"fx"),l.unqueued==null&&(l.unqueued=0,c=l.empty.fire,l.empty.fire=function(){l.unqueued||c()}),l.unqueued++,h.always(function(){h.always(function(){l.unqueued--,v.queue(e,"fx").length||l.empty.fire()})})),e.nodeType===1&&("height"in t||"width"in t)&&(n.overflow=[p.overflow,p.overflowX,p.overflowY],v.css(e,"display")==="inline"&&v.css(e,"float")==="none"&&(!v.support.inlineBlockNeedsLayout||nn(e.nodeName)==="inline"?p.display="inline-block":p.zoom=1)),n.overflow&&(p.overflow="hidden",v.support.shrinkWrapBlocks||h.done(function(){p.overflow=n.overflow[0],p.overflowX=n.overflow[1],p.overflowY=n.overflow[2]}));for(r in t){s=t[r];if(Un.exec(s)){delete t[r],a=a||s==="toggle";if(s===(g?"hide":"show"))continue;m.push(r)}}o=m.length;if(o){u=v._data(e,"fxshow")||v._data(e,"fxshow",{}),"hidden"in u&&(g=u.hidden),a&&(u.hidden=!g),g?v(e).show():h.done(function(){v(e).hide()}),h.done(function(){var t;v.removeData(e,"fxshow",!0);for(t in d)v.style(e,t,d[t])});for(r=0;r<o;r++)i=m[r],f=h.createTween(i,g?u[i]:0),d[i]=u[i]||v.style(e,i),i in u||(u[i]=f.start,g&&(f.end=f.start,f.start=i==="width"||i==="height"?1:0))}}function Yn(e,t,n,r,i){return new Yn.prototype.init(e,t,n,r,i)}function Zn(e,t){var n,r={height:e},i=0;t=t?1:0;for(;i<4;i+=2-t)n=$t[i],r["margin"+n]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}function tr(e){return v.isWindow(e)?e:e.nodeType===9?e.defaultView||e.parentWindow:!1}var n,r,i=e.document,s=e.location,o=e.navigator,u=e.jQuery,a=e.$,f=Array.prototype.push,l=Array.prototype.slice,c=Array.prototype.indexOf,h=Object.prototype.toString,p=Object.prototype.hasOwnProperty,d=String.prototype.trim,v=function(e,t){return new v.fn.init(e,t,n)},m=/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,g=/\S/,y=/\s+/,b=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,w=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,E=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,S=/^[\],:{}\s]*$/,x=/(?:^|:|,)(?:\s*\[)+/g,T=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,N=/"[^"\\\r\n]*"|true|false|null|-?(?:\d\d*\.|)\d+(?:[eE][\-+]?\d+|)/g,C=/^-ms-/,k=/-([\da-z])/gi,L=function(e,t){return(t+"").toUpperCase()},A=function(){i.addEventListener?(i.removeEventListener("DOMContentLoaded",A,!1),v.ready()):i.readyState==="complete"&&(i.detachEvent("onreadystatechange",A),v.ready())},O={};v.fn=v.prototype={constructor:v,init:function(e,n,r){var s,o,u,a;if(!e)return this;if(e.nodeType)return this.context=this[0]=e,this.length=1,this;if(typeof e=="string"){e.charAt(0)==="<"&&e.charAt(e.length-1)===">"&&e.length>=3?s=[null,e,null]:s=w.exec(e);if(s&&(s[1]||!n)){if(s[1])return n=n instanceof v?n[0]:n,a=n&&n.nodeType?n.ownerDocument||n:i,e=v.parseHTML(s[1],a,!0),E.test(s[1])&&v.isPlainObject(n)&&this.attr.call(e,n,!0),v.merge(this,e);o=i.getElementById(s[2]);if(o&&o.parentNode){if(o.id!==s[2])return r.find(e);this.length=1,this[0]=o}return this.context=i,this.selector=e,this}return!n||n.jquery?(n||r).find(e):this.constructor(n).find(e)}return v.isFunction(e)?r.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),v.makeArray(e,this))},selector:"",jquery:"1.8.3",length:0,size:function(){return this.length},toArray:function(){return l.call(this)},get:function(e){return e==null?this.toArray():e<0?this[this.length+e]:this[e]},pushStack:function(e,t,n){var r=v.merge(this.constructor(),e);return r.prevObject=this,r.context=this.context,t==="find"?r.selector=this.selector+(this.selector?" ":"")+n:t&&(r.selector=this.selector+"."+t+"("+n+")"),r},each:function(e,t){return v.each(this,e,t)},ready:function(e){return v.ready.promise().done(e),this},eq:function(e){return e=+e,e===-1?this.slice(e):this.slice(e,e+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(l.apply(this,arguments),"slice",l.call(arguments).join(","))},map:function(e){return this.pushStack(v.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:f,sort:[].sort,splice:[].splice},v.fn.init.prototype=v.fn,v.extend=v.fn.extend=function(){var e,n,r,i,s,o,u=arguments[0]||{},a=1,f=arguments.length,l=!1;typeof u=="boolean"&&(l=u,u=arguments[1]||{},a=2),typeof u!="object"&&!v.isFunction(u)&&(u={}),f===a&&(u=this,--a);for(;a<f;a++)if((e=arguments[a])!=null)for(n in e){r=u[n],i=e[n];if(u===i)continue;l&&i&&(v.isPlainObject(i)||(s=v.isArray(i)))?(s?(s=!1,o=r&&v.isArray(r)?r:[]):o=r&&v.isPlainObject(r)?r:{},u[n]=v.extend(l,o,i)):i!==t&&(u[n]=i)}return u},v.extend({noConflict:function(t){return e.$===v&&(e.$=a),t&&e.jQuery===v&&(e.jQuery=u),v},isReady:!1,readyWait:1,holdReady:function(e){e?v.readyWait++:v.ready(!0)},ready:function(e){if(e===!0?--v.readyWait:v.isReady)return;if(!i.body)return setTimeout(v.ready,1);v.isReady=!0;if(e!==!0&&--v.readyWait>0)return;r.resolveWith(i,[v]),v.fn.trigger&&v(i).trigger("ready").off("ready")},isFunction:function(e){return v.type(e)==="function"},isArray:Array.isArray||function(e){return v.type(e)==="array"},isWindow:function(e){return e!=null&&e==e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return e==null?String(e):O[h.call(e)]||"object"},isPlainObject:function(e){if(!e||v.type(e)!=="object"||e.nodeType||v.isWindow(e))return!1;try{if(e.constructor&&!p.call(e,"constructor")&&!p.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(n){return!1}var r;for(r in e);return r===t||p.call(e,r)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw new Error(e)},parseHTML:function(e,t,n){var r;return!e||typeof e!="string"?null:(typeof t=="boolean"&&(n=t,t=0),t=t||i,(r=E.exec(e))?[t.createElement(r[1])]:(r=v.buildFragment([e],t,n?null:[]),v.merge([],(r.cacheable?v.clone(r.fragment):r.fragment).childNodes)))},parseJSON:function(t){if(!t||typeof t!="string")return null;t=v.trim(t);if(e.JSON&&e.JSON.parse)return e.JSON.parse(t);if(S.test(t.replace(T,"@").replace(N,"]").replace(x,"")))return(new Function("return "+t))();v.error("Invalid JSON: "+t)},parseXML:function(n){var r,i;if(!n||typeof n!="string")return null;try{e.DOMParser?(i=new DOMParser,r=i.parseFromString(n,"text/xml")):(r=new ActiveXObject("Microsoft.XMLDOM"),r.async="false",r.loadXML(n))}catch(s){r=t}return(!r||!r.documentElement||r.getElementsByTagName("parsererror").length)&&v.error("Invalid XML: "+n),r},noop:function(){},globalEval:function(t){t&&g.test(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(C,"ms-").replace(k,L)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,n,r){var i,s=0,o=e.length,u=o===t||v.isFunction(e);if(r){if(u){for(i in e)if(n.apply(e[i],r)===!1)break}else for(;s<o;)if(n.apply(e[s++],r)===!1)break}else if(u){for(i in e)if(n.call(e[i],i,e[i])===!1)break}else for(;s<o;)if(n.call(e[s],s,e[s++])===!1)break;return e},trim:d&&!d.call("\ufeff\u00a0")?function(e){return e==null?"":d.call(e)}:function(e){return e==null?"":(e+"").replace(b,"")},makeArray:function(e,t){var n,r=t||[];return e!=null&&(n=v.type(e),e.length==null||n==="string"||n==="function"||n==="regexp"||v.isWindow(e)?f.call(r,e):v.merge(r,e)),r},inArray:function(e,t,n){var r;if(t){if(c)return c.call(t,e,n);r=t.length,n=n?n<0?Math.max(0,r+n):n:0;for(;n<r;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,n){var r=n.length,i=e.length,s=0;if(typeof r=="number")for(;s<r;s++)e[i++]=n[s];else while(n[s]!==t)e[i++]=n[s++];return e.length=i,e},grep:function(e,t,n){var r,i=[],s=0,o=e.length;n=!!n;for(;s<o;s++)r=!!t(e[s],s),n!==r&&i.push(e[s]);return i},map:function(e,n,r){var i,s,o=[],u=0,a=e.length,f=e instanceof v||a!==t&&typeof a=="number"&&(a>0&&e[0]&&e[a-1]||a===0||v.isArray(e));if(f)for(;u<a;u++)i=n(e[u],u,r),i!=null&&(o[o.length]=i);else for(s in e)i=n(e[s],s,r),i!=null&&(o[o.length]=i);return o.concat.apply([],o)},guid:1,proxy:function(e,n){var r,i,s;return typeof n=="string"&&(r=e[n],n=e,e=r),v.isFunction(e)?(i=l.call(arguments,2),s=function(){return e.apply(n,i.concat(l.call(arguments)))},s.guid=e.guid=e.guid||v.guid++,s):t},access:function(e,n,r,i,s,o,u){var a,f=r==null,l=0,c=e.length;if(r&&typeof r=="object"){for(l in r)v.access(e,n,l,r[l],1,o,i);s=1}else if(i!==t){a=u===t&&v.isFunction(i),f&&(a?(a=n,n=function(e,t,n){return a.call(v(e),n)}):(n.call(e,i),n=null));if(n)for(;l<c;l++)n(e[l],r,a?i.call(e[l],l,n(e[l],r)):i,u);s=1}return s?e:f?n.call(e):c?n(e[0],r):o},now:function(){return(new Date).getTime()}}),v.ready.promise=function(t){if(!r){r=v.Deferred();if(i.readyState==="complete")setTimeout(v.ready,1);else if(i.addEventListener)i.addEventListener("DOMContentLoaded",A,!1),e.addEventListener("load",v.ready,!1);else{i.attachEvent("onreadystatechange",A),e.attachEvent("onload",v.ready);var n=!1;try{n=e.frameElement==null&&i.documentElement}catch(s){}n&&n.doScroll&&function o(){if(!v.isReady){try{n.doScroll("left")}catch(e){return setTimeout(o,50)}v.ready()}}()}}return r.promise(t)},v.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(e,t){O["[object "+t+"]"]=t.toLowerCase()}),n=v(i);var M={};v.Callbacks=function(e){e=typeof e=="string"?M[e]||_(e):v.extend({},e);var n,r,i,s,o,u,a=[],f=!e.once&&[],l=function(t){n=e.memory&&t,r=!0,u=s||0,s=0,o=a.length,i=!0;for(;a&&u<o;u++)if(a[u].apply(t[0],t[1])===!1&&e.stopOnFalse){n=!1;break}i=!1,a&&(f?f.length&&l(f.shift()):n?a=[]:c.disable())},c={add:function(){if(a){var t=a.length;(function r(t){v.each(t,function(t,n){var i=v.type(n);i==="function"?(!e.unique||!c.has(n))&&a.push(n):n&&n.length&&i!=="string"&&r(n)})})(arguments),i?o=a.length:n&&(s=t,l(n))}return this},remove:function(){return a&&v.each(arguments,function(e,t){var n;while((n=v.inArray(t,a,n))>-1)a.splice(n,1),i&&(n<=o&&o--,n<=u&&u--)}),this},has:function(e){return v.inArray(e,a)>-1},empty:function(){return a=[],this},disable:function(){return a=f=n=t,this},disabled:function(){return!a},lock:function(){return f=t,n||c.disable(),this},locked:function(){return!f},fireWith:function(e,t){return t=t||[],t=[e,t.slice?t.slice():t],a&&(!r||f)&&(i?f.push(t):l(t)),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!r}};return c},v.extend({Deferred:function(e){var t=[["resolve","done",v.Callbacks("once memory"),"resolved"],["reject","fail",v.Callbacks("once memory"),"rejected"],["notify","progress",v.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return v.Deferred(function(n){v.each(t,function(t,r){var s=r[0],o=e[t];i[r[1]](v.isFunction(o)?function(){var e=o.apply(this,arguments);e&&v.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[s+"With"](this===i?n:this,[e])}:n[s])}),e=null}).promise()},promise:function(e){return e!=null?v.extend(e,r):r}},i={};return r.pipe=r.then,v.each(t,function(e,s){var o=s[2],u=s[3];r[s[1]]=o.add,u&&o.add(function(){n=u},t[e^1][2].disable,t[2][2].lock),i[s[0]]=o.fire,i[s[0]+"With"]=o.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t=0,n=l.call(arguments),r=n.length,i=r!==1||e&&v.isFunction(e.promise)?r:0,s=i===1?e:v.Deferred(),o=function(e,t,n){return function(r){t[e]=this,n[e]=arguments.length>1?l.call(arguments):r,n===u?s.notifyWith(t,n):--i||s.resolveWith(t,n)}},u,a,f;if(r>1){u=new Array(r),a=new Array(r),f=new Array(r);for(;t<r;t++)n[t]&&v.isFunction(n[t].promise)?n[t].promise().done(o(t,f,n)).fail(s.reject).progress(o(t,a,u)):--i}return i||s.resolveWith(f,n),s.promise()}}),v.support=function(){var t,n,r,s,o,u,a,f,l,c,h,p=i.createElement("div");p.setAttribute("className","t"),p.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",n=p.getElementsByTagName("*"),r=p.getElementsByTagName("a")[0];if(!n||!r||!n.length)return{};s=i.createElement("select"),o=s.appendChild(i.createElement("option")),u=p.getElementsByTagName("input")[0],r.style.cssText="top:1px;float:left;opacity:.5",t={leadingWhitespace:p.firstChild.nodeType===3,tbody:!p.getElementsByTagName("tbody").length,htmlSerialize:!!p.getElementsByTagName("link").length,style:/top/.test(r.getAttribute("style")),hrefNormalized:r.getAttribute("href")==="/a",opacity:/^0.5/.test(r.style.opacity),cssFloat:!!r.style.cssFloat,checkOn:u.value==="on",optSelected:o.selected,getSetAttribute:p.className!=="t",enctype:!!i.createElement("form").enctype,html5Clone:i.createElement("nav").cloneNode(!0).outerHTML!=="<:nav></:nav>",boxModel:i.compatMode==="CSS1Compat",submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,pixelPosition:!1},u.checked=!0,t.noCloneChecked=u.cloneNode(!0).checked,s.disabled=!0,t.optDisabled=!o.disabled;try{delete p.test}catch(d){t.deleteExpando=!1}!p.addEventListener&&p.attachEvent&&p.fireEvent&&(p.attachEvent("onclick",h=function(){t.noCloneEvent=!1}),p.cloneNode(!0).fireEvent("onclick"),p.detachEvent("onclick",h)),u=i.createElement("input"),u.value="t",u.setAttribute("type","radio"),t.radioValue=u.value==="t",u.setAttribute("checked","checked"),u.setAttribute("name","t"),p.appendChild(u),a=i.createDocumentFragment(),a.appendChild(p.lastChild),t.checkClone=a.cloneNode(!0).cloneNode(!0).lastChild.checked,t.appendChecked=u.checked,a.removeChild(u),a.appendChild(p);if(p.attachEvent)for(l in{submit:!0,change:!0,focusin:!0})f="on"+l,c=f in p,c||(p.setAttribute(f,"return;"),c=typeof p[f]=="function"),t[l+"Bubbles"]=c;return v(function(){var n,r,s,o,u="padding:0;margin:0;border:0;display:block;overflow:hidden;",a=i.getElementsByTagName("body")[0];if(!a)return;n=i.createElement("div"),n.style.cssText="visibility:hidden;border:0;width:0;height:0;position:static;top:0;margin-top:1px",a.insertBefore(n,a.firstChild),r=i.createElement("div"),n.appendChild(r),r.innerHTML="<table><tr><td></td><td>t</td></tr></table>",s=r.getElementsByTagName("td"),s[0].style.cssText="padding:0;margin:0;border:0;display:none",c=s[0].offsetHeight===0,s[0].style.display="",s[1].style.display="none",t.reliableHiddenOffsets=c&&s[0].offsetHeight===0,r.innerHTML="",r.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",t.boxSizing=r.offsetWidth===4,t.doesNotIncludeMarginInBodyOffset=a.offsetTop!==1,e.getComputedStyle&&(t.pixelPosition=(e.getComputedStyle(r,null)||{}).top!=="1%",t.boxSizingReliable=(e.getComputedStyle(r,null)||{width:"4px"}).width==="4px",o=i.createElement("div"),o.style.cssText=r.style.cssText=u,o.style.marginRight=o.style.width="0",r.style.width="1px",r.appendChild(o),t.reliableMarginRight=!parseFloat((e.getComputedStyle(o,null)||{}).marginRight)),typeof r.style.zoom!="undefined"&&(r.innerHTML="",r.style.cssText=u+"width:1px;padding:1px;display:inline;zoom:1",t.inlineBlockNeedsLayout=r.offsetWidth===3,r.style.display="block",r.style.overflow="visible",r.innerHTML="<div></div>",r.firstChild.style.width="5px",t.shrinkWrapBlocks=r.offsetWidth!==3,n.style.zoom=1),a.removeChild(n),n=r=s=o=null}),a.removeChild(p),n=r=s=o=u=a=p=null,t}();var D=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,P=/([A-Z])/g;v.extend({cache:{},deletedIds:[],uuid:0,expando:"jQuery"+(v.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(e){return e=e.nodeType?v.cache[e[v.expando]]:e[v.expando],!!e&&!B(e)},data:function(e,n,r,i){if(!v.acceptData(e))return;var s,o,u=v.expando,a=typeof n=="string",f=e.nodeType,l=f?v.cache:e,c=f?e[u]:e[u]&&u;if((!c||!l[c]||!i&&!l[c].data)&&a&&r===t)return;c||(f?e[u]=c=v.deletedIds.pop()||v.guid++:c=u),l[c]||(l[c]={},f||(l[c].toJSON=v.noop));if(typeof n=="object"||typeof n=="function")i?l[c]=v.extend(l[c],n):l[c].data=v.extend(l[c].data,n);return s=l[c],i||(s.data||(s.data={}),s=s.data),r!==t&&(s[v.camelCase(n)]=r),a?(o=s[n],o==null&&(o=s[v.camelCase(n)])):o=s,o},removeData:function(e,t,n){if(!v.acceptData(e))return;var r,i,s,o=e.nodeType,u=o?v.cache:e,a=o?e[v.expando]:v.expando;if(!u[a])return;if(t){r=n?u[a]:u[a].data;if(r){v.isArray(t)||(t in r?t=[t]:(t=v.camelCase(t),t in r?t=[t]:t=t.split(" ")));for(i=0,s=t.length;i<s;i++)delete r[t[i]];if(!(n?B:v.isEmptyObject)(r))return}}if(!n){delete u[a].data;if(!B(u[a]))return}o?v.cleanData([e],!0):v.support.deleteExpando||u!=u.window?delete u[a]:u[a]=null},_data:function(e,t,n){return v.data(e,t,n,!0)},acceptData:function(e){var t=e.nodeName&&v.noData[e.nodeName.toLowerCase()];return!t||t!==!0&&e.getAttribute("classid")===t}}),v.fn.extend({data:function(e,n){var r,i,s,o,u,a=this[0],f=0,l=null;if(e===t){if(this.length){l=v.data(a);if(a.nodeType===1&&!v._data(a,"parsedAttrs")){s=a.attributes;for(u=s.length;f<u;f++)o=s[f].name,o.indexOf("data-")||(o=v.camelCase(o.substring(5)),H(a,o,l[o]));v._data(a,"parsedAttrs",!0)}}return l}return typeof e=="object"?this.each(function(){v.data(this,e)}):(r=e.split(".",2),r[1]=r[1]?"."+r[1]:"",i=r[1]+"!",v.access(this,function(n){if(n===t)return l=this.triggerHandler("getData"+i,[r[0]]),l===t&&a&&(l=v.data(a,e),l=H(a,e,l)),l===t&&r[1]?this.data(r[0]):l;r[1]=n,this.each(function(){var t=v(this);t.triggerHandler("setData"+i,r),v.data(this,e,n),t.triggerHandler("changeData"+i,r)})},null,n,arguments.length>1,null,!1))},removeData:function(e){return this.each(function(){v.removeData(this,e)})}}),v.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=v._data(e,t),n&&(!r||v.isArray(n)?r=v._data(e,t,v.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=v.queue(e,t),r=n.length,i=n.shift(),s=v._queueHooks(e,t),o=function(){v.dequeue(e,t)};i==="inprogress"&&(i=n.shift(),r--),i&&(t==="fx"&&n.unshift("inprogress"),delete s.stop,i.call(e,o,s)),!r&&s&&s.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return v._data(e,n)||v._data(e,n,{empty:v.Callbacks("once memory").add(function(){v.removeData(e,t+"queue",!0),v.removeData(e,n,!0)})})}}),v.fn.extend({queue:function(e,n){var r=2;return typeof e!="string"&&(n=e,e="fx",r--),arguments.length<r?v.queue(this[0],e):n===t?this:this.each(function(){var t=v.queue(this,e,n);v._queueHooks(this,e),e==="fx"&&t[0]!=="inprogress"&&v.dequeue(this,e)})},dequeue:function(e){return this.each(function(){v.dequeue(this,e)})},delay:function(e,t){return e=v.fx?v.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,n){var r,i=1,s=v.Deferred(),o=this,u=this.length,a=function(){--i||s.resolveWith(o,[o])};typeof e!="string"&&(n=e,e=t),e=e||"fx";while(u--)r=v._data(o[u],e+"queueHooks"),r&&r.empty&&(i++,r.empty.add(a));return a(),s.promise(n)}});var j,F,I,q=/[\t\r\n]/g,R=/\r/g,U=/^(?:button|input)$/i,z=/^(?:button|input|object|select|textarea)$/i,W=/^a(?:rea|)$/i,X=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,V=v.support.getSetAttribute;v.fn.extend({attr:function(e,t){return v.access(this,v.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){v.removeAttr(this,e)})},prop:function(e,t){return v.access(this,v.prop,e,t,arguments.length>1)},removeProp:function(e){return e=v.propFix[e]||e,this.each(function(){try{this[e]=t,delete this[e]}catch(n){}})},addClass:function(e){var t,n,r,i,s,o,u;if(v.isFunction(e))return this.each(function(t){v(this).addClass(e.call(this,t,this.className))});if(e&&typeof e=="string"){t=e.split(y);for(n=0,r=this.length;n<r;n++){i=this[n];if(i.nodeType===1)if(!i.className&&t.length===1)i.className=e;else{s=" "+i.className+" ";for(o=0,u=t.length;o<u;o++)s.indexOf(" "+t[o]+" ")<0&&(s+=t[o]+" ");i.className=v.trim(s)}}}return this},removeClass:function(e){var n,r,i,s,o,u,a;if(v.isFunction(e))return this.each(function(t){v(this).removeClass(e.call(this,t,this.className))});if(e&&typeof e=="string"||e===t){n=(e||"").split(y);for(u=0,a=this.length;u<a;u++){i=this[u];if(i.nodeType===1&&i.className){r=(" "+i.className+" ").replace(q," ");for(s=0,o=n.length;s<o;s++)while(r.indexOf(" "+n[s]+" ")>=0)r=r.replace(" "+n[s]+" "," ");i.className=e?v.trim(r):""}}}return this},toggleClass:function(e,t){var n=typeof e,r=typeof t=="boolean";return v.isFunction(e)?this.each(function(n){v(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if(n==="string"){var i,s=0,o=v(this),u=t,a=e.split(y);while(i=a[s++])u=r?u:!o.hasClass(i),o[u?"addClass":"removeClass"](i)}else if(n==="undefined"||n==="boolean")this.className&&v._data(this,"__className__",this.className),this.className=this.className||e===!1?"":v._data(this,"__className__")||""})},hasClass:function(e){var t=" "+e+" ",n=0,r=this.length;for(;n<r;n++)if(this[n].nodeType===1&&(" "+this[n].className+" ").replace(q," ").indexOf(t)>=0)return!0;return!1},val:function(e){var n,r,i,s=this[0];if(!arguments.length){if(s)return n=v.valHooks[s.type]||v.valHooks[s.nodeName.toLowerCase()],n&&"get"in n&&(r=n.get(s,"value"))!==t?r:(r=s.value,typeof r=="string"?r.replace(R,""):r==null?"":r);return}return i=v.isFunction(e),this.each(function(r){var s,o=v(this);if(this.nodeType!==1)return;i?s=e.call(this,r,o.val()):s=e,s==null?s="":typeof s=="number"?s+="":v.isArray(s)&&(s=v.map(s,function(e){return e==null?"":e+""})),n=v.valHooks[this.type]||v.valHooks[this.nodeName.toLowerCase()];if(!n||!("set"in n)||n.set(this,s,"value")===t)this.value=s})}}),v.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){var t,n,r=e.options,i=e.selectedIndex,s=e.type==="select-one"||i<0,o=s?null:[],u=s?i+1:r.length,a=i<0?u:s?i:0;for(;a<u;a++){n=r[a];if((n.selected||a===i)&&(v.support.optDisabled?!n.disabled:n.getAttribute("disabled")===null)&&(!n.parentNode.disabled||!v.nodeName(n.parentNode,"optgroup"))){t=v(n).val();if(s)return t;o.push(t)}}return o},set:function(e,t){var n=v.makeArray(t);return v(e).find("option").each(function(){this.selected=v.inArray(v(this).val(),n)>=0}),n.length||(e.selectedIndex=-1),n}}},attrFn:{},attr:function(e,n,r,i){var s,o,u,a=e.nodeType;if(!e||a===3||a===8||a===2)return;if(i&&v.isFunction(v.fn[n]))return v(e)[n](r);if(typeof e.getAttribute=="undefined")return v.prop(e,n,r);u=a!==1||!v.isXMLDoc(e),u&&(n=n.toLowerCase(),o=v.attrHooks[n]||(X.test(n)?F:j));if(r!==t){if(r===null){v.removeAttr(e,n);return}return o&&"set"in o&&u&&(s=o.set(e,r,n))!==t?s:(e.setAttribute(n,r+""),r)}return o&&"get"in o&&u&&(s=o.get(e,n))!==null?s:(s=e.getAttribute(n),s===null?t:s)},removeAttr:function(e,t){var n,r,i,s,o=0;if(t&&e.nodeType===1){r=t.split(y);for(;o<r.length;o++)i=r[o],i&&(n=v.propFix[i]||i,s=X.test(i),s||v.attr(e,i,""),e.removeAttribute(V?i:n),s&&n in e&&(e[n]=!1))}},attrHooks:{type:{set:function(e,t){if(U.test(e.nodeName)&&e.parentNode)v.error("type property can't be changed");else if(!v.support.radioValue&&t==="radio"&&v.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}},value:{get:function(e,t){return j&&v.nodeName(e,"button")?j.get(e,t):t in e?e.value:null},set:function(e,t,n){if(j&&v.nodeName(e,"button"))return j.set(e,t,n);e.value=t}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(e,n,r){var i,s,o,u=e.nodeType;if(!e||u===3||u===8||u===2)return;return o=u!==1||!v.isXMLDoc(e),o&&(n=v.propFix[n]||n,s=v.propHooks[n]),r!==t?s&&"set"in s&&(i=s.set(e,r,n))!==t?i:e[n]=r:s&&"get"in s&&(i=s.get(e,n))!==null?i:e[n]},propHooks:{tabIndex:{get:function(e){var n=e.getAttributeNode("tabindex");return n&&n.specified?parseInt(n.value,10):z.test(e.nodeName)||W.test(e.nodeName)&&e.href?0:t}}}}),F={get:function(e,n){var r,i=v.prop(e,n);return i===!0||typeof i!="boolean"&&(r=e.getAttributeNode(n))&&r.nodeValue!==!1?n.toLowerCase():t},set:function(e,t,n){var r;return t===!1?v.removeAttr(e,n):(r=v.propFix[n]||n,r in e&&(e[r]=!0),e.setAttribute(n,n.toLowerCase())),n}},V||(I={name:!0,id:!0,coords:!0},j=v.valHooks.button={get:function(e,n){var r;return r=e.getAttributeNode(n),r&&(I[n]?r.value!=="":r.specified)?r.value:t},set:function(e,t,n){var r=e.getAttributeNode(n);return r||(r=i.createAttribute(n),e.setAttributeNode(r)),r.value=t+""}},v.each(["width","height"],function(e,t){v.attrHooks[t]=v.extend(v.attrHooks[t],{set:function(e,n){if(n==="")return e.setAttribute(t,"auto"),n}})}),v.attrHooks.contenteditable={get:j.get,set:function(e,t,n){t===""&&(t="false"),j.set(e,t,n)}}),v.support.hrefNormalized||v.each(["href","src","width","height"],function(e,n){v.attrHooks[n]=v.extend(v.attrHooks[n],{get:function(e){var r=e.getAttribute(n,2);return r===null?t:r}})}),v.support.style||(v.attrHooks.style={get:function(e){return e.style.cssText.toLowerCase()||t},set:function(e,t){return e.style.cssText=t+""}}),v.support.optSelected||(v.propHooks.selected=v.extend(v.propHooks.selected,{get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}})),v.support.enctype||(v.propFix.enctype="encoding"),v.support.checkOn||v.each(["radio","checkbox"],function(){v.valHooks[this]={get:function(e){return e.getAttribute("value")===null?"on":e.value}}}),v.each(["radio","checkbox"],function(){v.valHooks[this]=v.extend(v.valHooks[this],{set:function(e,t){if(v.isArray(t))return e.checked=v.inArray(v(e).val(),t)>=0}})});var $=/^(?:textarea|input|select)$/i,J=/^([^\.]*|)(?:\.(.+)|)$/,K=/(?:^|\s)hover(\.\S+|)\b/,Q=/^key/,G=/^(?:mouse|contextmenu)|click/,Y=/^(?:focusinfocus|focusoutblur)$/,Z=function(e){return v.event.special.hover?e:e.replace(K,"mouseenter$1 mouseleave$1")};v.event={add:function(e,n,r,i,s){var o,u,a,f,l,c,h,p,d,m,g;if(e.nodeType===3||e.nodeType===8||!n||!r||!(o=v._data(e)))return;r.handler&&(d=r,r=d.handler,s=d.selector),r.guid||(r.guid=v.guid++),a=o.events,a||(o.events=a={}),u=o.handle,u||(o.handle=u=function(e){return typeof v=="undefined"||!!e&&v.event.triggered===e.type?t:v.event.dispatch.apply(u.elem,arguments)},u.elem=e),n=v.trim(Z(n)).split(" ");for(f=0;f<n.length;f++){l=J.exec(n[f])||[],c=l[1],h=(l[2]||"").split(".").sort(),g=v.event.special[c]||{},c=(s?g.delegateType:g.bindType)||c,g=v.event.special[c]||{},p=v.extend({type:c,origType:l[1],data:i,handler:r,guid:r.guid,selector:s,needsContext:s&&v.expr.match.needsContext.test(s),namespace:h.join(".")},d),m=a[c];if(!m){m=a[c]=[],m.delegateCount=0;if(!g.setup||g.setup.call(e,i,h,u)===!1)e.addEventListener?e.addEventListener(c,u,!1):e.attachEvent&&e.attachEvent("on"+c,u)}g.add&&(g.add.call(e,p),p.handler.guid||(p.handler.guid=r.guid)),s?m.splice(m.delegateCount++,0,p):m.push(p),v.event.global[c]=!0}e=null},global:{},remove:function(e,t,n,r,i){var s,o,u,a,f,l,c,h,p,d,m,g=v.hasData(e)&&v._data(e);if(!g||!(h=g.events))return;t=v.trim(Z(t||"")).split(" ");for(s=0;s<t.length;s++){o=J.exec(t[s])||[],u=a=o[1],f=o[2];if(!u){for(u in h)v.event.remove(e,u+t[s],n,r,!0);continue}p=v.event.special[u]||{},u=(r?p.delegateType:p.bindType)||u,d=h[u]||[],l=d.length,f=f?new RegExp("(^|\\.)"+f.split(".").sort().join("\\.(?:.*\\.|)")+"(\\.|$)"):null;for(c=0;c<d.length;c++)m=d[c],(i||a===m.origType)&&(!n||n.guid===m.guid)&&(!f||f.test(m.namespace))&&(!r||r===m.selector||r==="**"&&m.selector)&&(d.splice(c--,1),m.selector&&d.delegateCount--,p.remove&&p.remove.call(e,m));d.length===0&&l!==d.length&&((!p.teardown||p.teardown.call(e,f,g.handle)===!1)&&v.removeEvent(e,u,g.handle),delete h[u])}v.isEmptyObject(h)&&(delete g.handle,v.removeData(e,"events",!0))},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(n,r,s,o){if(!s||s.nodeType!==3&&s.nodeType!==8){var u,a,f,l,c,h,p,d,m,g,y=n.type||n,b=[];if(Y.test(y+v.event.triggered))return;y.indexOf("!")>=0&&(y=y.slice(0,-1),a=!0),y.indexOf(".")>=0&&(b=y.split("."),y=b.shift(),b.sort());if((!s||v.event.customEvent[y])&&!v.event.global[y])return;n=typeof n=="object"?n[v.expando]?n:new v.Event(y,n):new v.Event(y),n.type=y,n.isTrigger=!0,n.exclusive=a,n.namespace=b.join("."),n.namespace_re=n.namespace?new RegExp("(^|\\.)"+b.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,h=y.indexOf(":")<0?"on"+y:"";if(!s){u=v.cache;for(f in u)u[f].events&&u[f].events[y]&&v.event.trigger(n,r,u[f].handle.elem,!0);return}n.result=t,n.target||(n.target=s),r=r!=null?v.makeArray(r):[],r.unshift(n),p=v.event.special[y]||{};if(p.trigger&&p.trigger.apply(s,r)===!1)return;m=[[s,p.bindType||y]];if(!o&&!p.noBubble&&!v.isWindow(s)){g=p.delegateType||y,l=Y.test(g+y)?s:s.parentNode;for(c=s;l;l=l.parentNode)m.push([l,g]),c=l;c===(s.ownerDocument||i)&&m.push([c.defaultView||c.parentWindow||e,g])}for(f=0;f<m.length&&!n.isPropagationStopped();f++)l=m[f][0],n.type=m[f][1],d=(v._data(l,"events")||{})[n.type]&&v._data(l,"handle"),d&&d.apply(l,r),d=h&&l[h],d&&v.acceptData(l)&&d.apply&&d.apply(l,r)===!1&&n.preventDefault();return n.type=y,!o&&!n.isDefaultPrevented()&&(!p._default||p._default.apply(s.ownerDocument,r)===!1)&&(y!=="click"||!v.nodeName(s,"a"))&&v.acceptData(s)&&h&&s[y]&&(y!=="focus"&&y!=="blur"||n.target.offsetWidth!==0)&&!v.isWindow(s)&&(c=s[h],c&&(s[h]=null),v.event.triggered=y,s[y](),v.event.triggered=t,c&&(s[h]=c)),n.result}return},dispatch:function(n){n=v.event.fix(n||e.event);var r,i,s,o,u,a,f,c,h,p,d=(v._data(this,"events")||{})[n.type]||[],m=d.delegateCount,g=l.call(arguments),y=!n.exclusive&&!n.namespace,b=v.event.special[n.type]||{},w=[];g[0]=n,n.delegateTarget=this;if(b.preDispatch&&b.preDispatch.call(this,n)===!1)return;if(m&&(!n.button||n.type!=="click"))for(s=n.target;s!=this;s=s.parentNode||this)if(s.disabled!==!0||n.type!=="click"){u={},f=[];for(r=0;r<m;r++)c=d[r],h=c.selector,u[h]===t&&(u[h]=c.needsContext?v(h,this).index(s)>=0:v.find(h,this,null,[s]).length),u[h]&&f.push(c);f.length&&w.push({elem:s,matches:f})}d.length>m&&w.push({elem:this,matches:d.slice(m)});for(r=0;r<w.length&&!n.isPropagationStopped();r++){a=w[r],n.currentTarget=a.elem;for(i=0;i<a.matches.length&&!n.isImmediatePropagationStopped();i++){c=a.matches[i];if(y||!n.namespace&&!c.namespace||n.namespace_re&&n.namespace_re.test(c.namespace))n.data=c.data,n.handleObj=c,o=((v.event.special[c.origType]||{}).handle||c.handler).apply(a.elem,g),o!==t&&(n.result=o,o===!1&&(n.preventDefault(),n.stopPropagation()))}}return b.postDispatch&&b.postDispatch.call(this,n),n.result},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return e.which==null&&(e.which=t.charCode!=null?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,n){var r,s,o,u=n.button,a=n.fromElement;return e.pageX==null&&n.clientX!=null&&(r=e.target.ownerDocument||i,s=r.documentElement,o=r.body,e.pageX=n.clientX+(s&&s.scrollLeft||o&&o.scrollLeft||0)-(s&&s.clientLeft||o&&o.clientLeft||0),e.pageY=n.clientY+(s&&s.scrollTop||o&&o.scrollTop||0)-(s&&s.clientTop||o&&o.clientTop||0)),!e.relatedTarget&&a&&(e.relatedTarget=a===e.target?n.toElement:a),!e.which&&u!==t&&(e.which=u&1?1:u&2?3:u&4?2:0),e}},fix:function(e){if(e[v.expando])return e;var t,n,r=e,s=v.event.fixHooks[e.type]||{},o=s.props?this.props.concat(s.props):this.props;e=v.Event(r);for(t=o.length;t;)n=o[--t],e[n]=r[n];return e.target||(e.target=r.srcElement||i),e.target.nodeType===3&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,s.filter?s.filter(e,r):e},special:{load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(e,t,n){v.isWindow(this)&&(this.onbeforeunload=n)},teardown:function(e,t){this.onbeforeunload===t&&(this.onbeforeunload=null)}}},simulate:function(e,t,n,r){var i=v.extend(new v.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?v.event.trigger(i,null,t):v.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},v.event.handle=v.event.dispatch,v.removeEvent=i.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,t,n){var r="on"+t;e.detachEvent&&(typeof e[r]=="undefined"&&(e[r]=null),e.detachEvent(r,n))},v.Event=function(e,t){if(!(this instanceof v.Event))return new v.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault()?tt:et):this.type=e,t&&v.extend(this,t),this.timeStamp=e&&e.timeStamp||v.now(),this[v.expando]=!0},v.Event.prototype={preventDefault:function(){this.isDefaultPrevented=tt;var e=this.originalEvent;if(!e)return;e.preventDefault?e.preventDefault():e.returnValue=!1},stopPropagation:function(){this.isPropagationStopped=tt;var e=this.originalEvent;if(!e)return;e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=tt,this.stopPropagation()},isDefaultPrevented:et,isPropagationStopped:et,isImmediatePropagationStopped:et},v.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){v.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,s=e.handleObj,o=s.selector;if(!i||i!==r&&!v.contains(r,i))e.type=s.origType,n=s.handler.apply(this,arguments),e.type=t;return n}}}),v.support.submitBubbles||(v.event.special.submit={setup:function(){if(v.nodeName(this,"form"))return!1;v.event.add(this,"click._submit keypress._submit",function(e){var n=e.target,r=v.nodeName(n,"input")||v.nodeName(n,"button")?n.form:t;r&&!v._data(r,"_submit_attached")&&(v.event.add(r,"submit._submit",function(e){e._submit_bubble=!0}),v._data(r,"_submit_attached",!0))})},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&v.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){if(v.nodeName(this,"form"))return!1;v.event.remove(this,"._submit")}}),v.support.changeBubbles||(v.event.special.change={setup:function(){if($.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio")v.event.add(this,"propertychange._change",function(e){e.originalEvent.propertyName==="checked"&&(this._just_changed=!0)}),v.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),v.event.simulate("change",this,e,!0)});return!1}v.event.add(this,"beforeactivate._change",function(e){var t=e.target;$.test(t.nodeName)&&!v._data(t,"_change_attached")&&(v.event.add(t,"change._change",function(e){this.parentNode&&!e.isSimulated&&!e.isTrigger&&v.event.simulate("change",this.parentNode,e,!0)}),v._data(t,"_change_attached",!0))})},handle:function(e){var t=e.target;if(this!==t||e.isSimulated||e.isTrigger||t.type!=="radio"&&t.type!=="checkbox")return e.handleObj.handler.apply(this,arguments)},teardown:function(){return v.event.remove(this,"._change"),!$.test(this.nodeName)}}),v.support.focusinBubbles||v.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,r=function(e){v.event.simulate(t,e.target,v.event.fix(e),!0)};v.event.special[t]={setup:function(){n++===0&&i.addEventListener(e,r,!0)},teardown:function(){--n===0&&i.removeEventListener(e,r,!0)}}}),v.fn.extend({on:function(e,n,r,i,s){var o,u;if(typeof e=="object"){typeof n!="string"&&(r=r||n,n=t);for(u in e)this.on(u,n,r,e[u],s);return this}r==null&&i==null?(i=n,r=n=t):i==null&&(typeof n=="string"?(i=r,r=t):(i=r,r=n,n=t));if(i===!1)i=et;else if(!i)return this;return s===1&&(o=i,i=function(e){return v().off(e),o.apply(this,arguments)},i.guid=o.guid||(o.guid=v.guid++)),this.each(function(){v.event.add(this,e,i,r,n)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,n,r){var i,s;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,v(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if(typeof e=="object"){for(s in e)this.off(s,n,e[s]);return this}if(n===!1||typeof n=="function")r=n,n=t;return r===!1&&(r=et),this.each(function(){v.event.remove(this,e,r,n)})},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},live:function(e,t,n){return v(this.context).on(e,this.selector,t,n),this},die:function(e,t){return v(this.context).off(e,this.selector||"**",t),this},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return arguments.length===1?this.off(e,"**"):this.off(t,e||"**",n)},trigger:function(e,t){return this.each(function(){v.event.trigger(e,t,this)})},triggerHandler:function(e,t){if(this[0])return v.event.trigger(e,t,this[0],!0)},toggle:function(e){var t=arguments,n=e.guid||v.guid++,r=0,i=function(n){var i=(v._data(this,"lastToggle"+e.guid)||0)%r;return v._data(this,"lastToggle"+e.guid,i+1),n.preventDefault(),t[i].apply(this,arguments)||!1};i.guid=n;while(r<t.length)t[r++].guid=n;return this.click(i)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),v.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){v.fn[t]=function(e,n){return n==null&&(n=e,e=null),arguments.length>0?this.on(t,null,e,n):this.trigger(t)},Q.test(t)&&(v.event.fixHooks[t]=v.event.keyHooks),G.test(t)&&(v.event.fixHooks[t]=v.event.mouseHooks)}),function(e,t){function nt(e,t,n,r){n=n||[],t=t||g;var i,s,a,f,l=t.nodeType;if(!e||typeof e!="string")return n;if(l!==1&&l!==9)return[];a=o(t);if(!a&&!r)if(i=R.exec(e))if(f=i[1]){if(l===9){s=t.getElementById(f);if(!s||!s.parentNode)return n;if(s.id===f)return n.push(s),n}else if(t.ownerDocument&&(s=t.ownerDocument.getElementById(f))&&u(t,s)&&s.id===f)return n.push(s),n}else{if(i[2])return S.apply(n,x.call(t.getElementsByTagName(e),0)),n;if((f=i[3])&&Z&&t.getElementsByClassName)return S.apply(n,x.call(t.getElementsByClassName(f),0)),n}return vt(e.replace(j,"$1"),t,n,r,a)}function rt(e){return function(t){var n=t.nodeName.toLowerCase();return n==="input"&&t.type===e}}function it(e){return function(t){var n=t.nodeName.toLowerCase();return(n==="input"||n==="button")&&t.type===e}}function st(e){return N(function(t){return t=+t,N(function(n,r){var i,s=e([],n.length,t),o=s.length;while(o--)n[i=s[o]]&&(n[i]=!(r[i]=n[i]))})})}function ot(e,t,n){if(e===t)return n;var r=e.nextSibling;while(r){if(r===t)return-1;r=r.nextSibling}return 1}function ut(e,t){var n,r,s,o,u,a,f,l=L[d][e+" "];if(l)return t?0:l.slice(0);u=e,a=[],f=i.preFilter;while(u){if(!n||(r=F.exec(u)))r&&(u=u.slice(r[0].length)||u),a.push(s=[]);n=!1;if(r=I.exec(u))s.push(n=new m(r.shift())),u=u.slice(n.length),n.type=r[0].replace(j," ");for(o in i.filter)(r=J[o].exec(u))&&(!f[o]||(r=f[o](r)))&&(s.push(n=new m(r.shift())),u=u.slice(n.length),n.type=o,n.matches=r);if(!n)break}return t?u.length:u?nt.error(e):L(e,a).slice(0)}function at(e,t,r){var i=t.dir,s=r&&t.dir==="parentNode",o=w++;return t.first?function(t,n,r){while(t=t[i])if(s||t.nodeType===1)return e(t,n,r)}:function(t,r,u){if(!u){var a,f=b+" "+o+" ",l=f+n;while(t=t[i])if(s||t.nodeType===1){if((a=t[d])===l)return t.sizset;if(typeof a=="string"&&a.indexOf(f)===0){if(t.sizset)return t}else{t[d]=l;if(e(t,r,u))return t.sizset=!0,t;t.sizset=!1}}}else while(t=t[i])if(s||t.nodeType===1)if(e(t,r,u))return t}}function ft(e){return e.length>1?function(t,n,r){var i=e.length;while(i--)if(!e[i](t,n,r))return!1;return!0}:e[0]}function lt(e,t,n,r,i){var s,o=[],u=0,a=e.length,f=t!=null;for(;u<a;u++)if(s=e[u])if(!n||n(s,r,i))o.push(s),f&&t.push(u);return o}function ct(e,t,n,r,i,s){return r&&!r[d]&&(r=ct(r)),i&&!i[d]&&(i=ct(i,s)),N(function(s,o,u,a){var f,l,c,h=[],p=[],d=o.length,v=s||dt(t||"*",u.nodeType?[u]:u,[]),m=e&&(s||!t)?lt(v,h,e,u,a):v,g=n?i||(s?e:d||r)?[]:o:m;n&&n(m,g,u,a);if(r){f=lt(g,p),r(f,[],u,a),l=f.length;while(l--)if(c=f[l])g[p[l]]=!(m[p[l]]=c)}if(s){if(i||e){if(i){f=[],l=g.length;while(l--)(c=g[l])&&f.push(m[l]=c);i(null,g=[],f,a)}l=g.length;while(l--)(c=g[l])&&(f=i?T.call(s,c):h[l])>-1&&(s[f]=!(o[f]=c))}}else g=lt(g===o?g.splice(d,g.length):g),i?i(null,o,g,a):S.apply(o,g)})}function ht(e){var t,n,r,s=e.length,o=i.relative[e[0].type],u=o||i.relative[" "],a=o?1:0,f=at(function(e){return e===t},u,!0),l=at(function(e){return T.call(t,e)>-1},u,!0),h=[function(e,n,r){return!o&&(r||n!==c)||((t=n).nodeType?f(e,n,r):l(e,n,r))}];for(;a<s;a++)if(n=i.relative[e[a].type])h=[at(ft(h),n)];else{n=i.filter[e[a].type].apply(null,e[a].matches);if(n[d]){r=++a;for(;r<s;r++)if(i.relative[e[r].type])break;return ct(a>1&&ft(h),a>1&&e.slice(0,a-1).join("").replace(j,"$1"),n,a<r&&ht(e.slice(a,r)),r<s&&ht(e=e.slice(r)),r<s&&e.join(""))}h.push(n)}return ft(h)}function pt(e,t){var r=t.length>0,s=e.length>0,o=function(u,a,f,l,h){var p,d,v,m=[],y=0,w="0",x=u&&[],T=h!=null,N=c,C=u||s&&i.find.TAG("*",h&&a.parentNode||a),k=b+=N==null?1:Math.E;T&&(c=a!==g&&a,n=o.el);for(;(p=C[w])!=null;w++){if(s&&p){for(d=0;v=e[d];d++)if(v(p,a,f)){l.push(p);break}T&&(b=k,n=++o.el)}r&&((p=!v&&p)&&y--,u&&x.push(p))}y+=w;if(r&&w!==y){for(d=0;v=t[d];d++)v(x,m,a,f);if(u){if(y>0)while(w--)!x[w]&&!m[w]&&(m[w]=E.call(l));m=lt(m)}S.apply(l,m),T&&!u&&m.length>0&&y+t.length>1&&nt.uniqueSort(l)}return T&&(b=k,c=N),x};return o.el=0,r?N(o):o}function dt(e,t,n){var r=0,i=t.length;for(;r<i;r++)nt(e,t[r],n);return n}function vt(e,t,n,r,s){var o,u,f,l,c,h=ut(e),p=h.length;if(!r&&h.length===1){u=h[0]=h[0].slice(0);if(u.length>2&&(f=u[0]).type==="ID"&&t.nodeType===9&&!s&&i.relative[u[1].type]){t=i.find.ID(f.matches[0].replace($,""),t,s)[0];if(!t)return n;e=e.slice(u.shift().length)}for(o=J.POS.test(e)?-1:u.length-1;o>=0;o--){f=u[o];if(i.relative[l=f.type])break;if(c=i.find[l])if(r=c(f.matches[0].replace($,""),z.test(u[0].type)&&t.parentNode||t,s)){u.splice(o,1),e=r.length&&u.join("");if(!e)return S.apply(n,x.call(r,0)),n;break}}}return a(e,h)(r,t,s,n,z.test(e)),n}function mt(){}var n,r,i,s,o,u,a,f,l,c,h=!0,p="undefined",d=("sizcache"+Math.random()).replace(".",""),m=String,g=e.document,y=g.documentElement,b=0,w=0,E=[].pop,S=[].push,x=[].slice,T=[].indexOf||function(e){var t=0,n=this.length;for(;t<n;t++)if(this[t]===e)return t;return-1},N=function(e,t){return e[d]=t==null||t,e},C=function(){var e={},t=[];return N(function(n,r){return t.push(n)>i.cacheLength&&delete e[t.shift()],e[n+" "]=r},e)},k=C(),L=C(),A=C(),O="[\\x20\\t\\r\\n\\f]",M="(?:\\\\.|[-\\w]|[^\\x00-\\xa0])+",_=M.replace("w","w#"),D="([*^$|!~]?=)",P="\\["+O+"*("+M+")"+O+"*(?:"+D+O+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+_+")|)|)"+O+"*\\]",H=":("+M+")(?:\\((?:(['\"])((?:\\\\.|[^\\\\])*?)\\2|([^()[\\]]*|(?:(?:"+P+")|[^:]|\\\\.)*|.*))\\)|)",B=":(even|odd|eq|gt|lt|nth|first|last)(?:\\("+O+"*((?:-\\d)?\\d*)"+O+"*\\)|)(?=[^-]|$)",j=new RegExp("^"+O+"+|((?:^|[^\\\\])(?:\\\\.)*)"+O+"+$","g"),F=new RegExp("^"+O+"*,"+O+"*"),I=new RegExp("^"+O+"*([\\x20\\t\\r\\n\\f>+~])"+O+"*"),q=new RegExp(H),R=/^(?:#([\w\-]+)|(\w+)|\.([\w\-]+))$/,U=/^:not/,z=/[\x20\t\r\n\f]*[+~]/,W=/:not\($/,X=/h\d/i,V=/input|select|textarea|button/i,$=/\\(?!\\)/g,J={ID:new RegExp("^#("+M+")"),CLASS:new RegExp("^\\.("+M+")"),NAME:new RegExp("^\\[name=['\"]?("+M+")['\"]?\\]"),TAG:new RegExp("^("+M.replace("w","w*")+")"),ATTR:new RegExp("^"+P),PSEUDO:new RegExp("^"+H),POS:new RegExp(B,"i"),CHILD:new RegExp("^:(only|nth|first|last)-child(?:\\("+O+"*(even|odd|(([+-]|)(\\d*)n|)"+O+"*(?:([+-]|)"+O+"*(\\d+)|))"+O+"*\\)|)","i"),needsContext:new RegExp("^"+O+"*[>+~]|"+B,"i")},K=function(e){var t=g.createElement("div");try{return e(t)}catch(n){return!1}finally{t=null}},Q=K(function(e){return e.appendChild(g.createComment("")),!e.getElementsByTagName("*").length}),G=K(function(e){return e.innerHTML="<a href='#'></a>",e.firstChild&&typeof e.firstChild.getAttribute!==p&&e.firstChild.getAttribute("href")==="#"}),Y=K(function(e){e.innerHTML="<select></select>";var t=typeof e.lastChild.getAttribute("multiple");return t!=="boolean"&&t!=="string"}),Z=K(function(e){return e.innerHTML="<div class='hidden e'></div><div class='hidden'></div>",!e.getElementsByClassName||!e.getElementsByClassName("e").length?!1:(e.lastChild.className="e",e.getElementsByClassName("e").length===2)}),et=K(function(e){e.id=d+0,e.innerHTML="<a name='"+d+"'></a><div name='"+d+"'></div>",y.insertBefore(e,y.firstChild);var t=g.getElementsByName&&g.getElementsByName(d).length===2+g.getElementsByName(d+0).length;return r=!g.getElementById(d),y.removeChild(e),t});try{x.call(y.childNodes,0)[0].nodeType}catch(tt){x=function(e){var t,n=[];for(;t=this[e];e++)n.push(t);return n}}nt.matches=function(e,t){return nt(e,null,null,t)},nt.matchesSelector=function(e,t){return nt(t,null,null,[e]).length>0},s=nt.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(i===1||i===9||i===11){if(typeof e.textContent=="string")return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=s(e)}else if(i===3||i===4)return e.nodeValue}else for(;t=e[r];r++)n+=s(t);return n},o=nt.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?t.nodeName!=="HTML":!1},u=nt.contains=y.contains?function(e,t){var n=e.nodeType===9?e.documentElement:e,r=t&&t.parentNode;return e===r||!!(r&&r.nodeType===1&&n.contains&&n.contains(r))}:y.compareDocumentPosition?function(e,t){return t&&!!(e.compareDocumentPosition(t)&16)}:function(e,t){while(t=t.parentNode)if(t===e)return!0;return!1},nt.attr=function(e,t){var n,r=o(e);return r||(t=t.toLowerCase()),(n=i.attrHandle[t])?n(e):r||Y?e.getAttribute(t):(n=e.getAttributeNode(t),n?typeof e[t]=="boolean"?e[t]?t:null:n.specified?n.value:null:null)},i=nt.selectors={cacheLength:50,createPseudo:N,match:J,attrHandle:G?{}:{href:function(e){return e.getAttribute("href",2)},type:function(e){return e.getAttribute("type")}},find:{ID:r?function(e,t,n){if(typeof t.getElementById!==p&&!n){var r=t.getElementById(e);return r&&r.parentNode?[r]:[]}}:function(e,n,r){if(typeof n.getElementById!==p&&!r){var i=n.getElementById(e);return i?i.id===e||typeof i.getAttributeNode!==p&&i.getAttributeNode("id").value===e?[i]:t:[]}},TAG:Q?function(e,t){if(typeof t.getElementsByTagName!==p)return t.getElementsByTagName(e)}:function(e,t){var n=t.getElementsByTagName(e);if(e==="*"){var r,i=[],s=0;for(;r=n[s];s++)r.nodeType===1&&i.push(r);return i}return n},NAME:et&&function(e,t){if(typeof t.getElementsByName!==p)return t.getElementsByName(name)},CLASS:Z&&function(e,t,n){if(typeof t.getElementsByClassName!==p&&!n)return t.getElementsByClassName(e)}},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace($,""),e[3]=(e[4]||e[5]||"").replace($,""),e[2]==="~="&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),e[1]==="nth"?(e[2]||nt.error(e[0]),e[3]=+(e[3]?e[4]+(e[5]||1):2*(e[2]==="even"||e[2]==="odd")),e[4]=+(e[6]+e[7]||e[2]==="odd")):e[2]&&nt.error(e[0]),e},PSEUDO:function(e){var t,n;if(J.CHILD.test(e[0]))return null;if(e[3])e[2]=e[3];else if(t=e[4])q.test(t)&&(n=ut(t,!0))&&(n=t.indexOf(")",t.length-n)-t.length)&&(t=t.slice(0,n),e[0]=e[0].slice(0,n)),e[2]=t;return e.slice(0,3)}},filter:{ID:r?function(e){return e=e.replace($,""),function(t){return t.getAttribute("id")===e}}:function(e){return e=e.replace($,""),function(t){var n=typeof t.getAttributeNode!==p&&t.getAttributeNode("id");return n&&n.value===e}},TAG:function(e){return e==="*"?function(){return!0}:(e=e.replace($,"").toLowerCase(),function(t){return t.nodeName&&t.nodeName.toLowerCase()===e})},CLASS:function(e){var t=k[d][e+" "];return t||(t=new RegExp("(^|"+O+")"+e+"("+O+"|$)"))&&k(e,function(e){return t.test(e.className||typeof e.getAttribute!==p&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r,i){var s=nt.attr(r,e);return s==null?t==="!=":t?(s+="",t==="="?s===n:t==="!="?s!==n:t==="^="?n&&s.indexOf(n)===0:t==="*="?n&&s.indexOf(n)>-1:t==="$="?n&&s.substr(s.length-n.length)===n:t==="~="?(" "+s+" ").indexOf(n)>-1:t==="|="?s===n||s.substr(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,n,r){return e==="nth"?function(e){var t,i,s=e.parentNode;if(n===1&&r===0)return!0;if(s){i=0;for(t=s.firstChild;t;t=t.nextSibling)if(t.nodeType===1){i++;if(e===t)break}}return i-=r,i===n||i%n===0&&i/n>=0}:function(t){var n=t;switch(e){case"only":case"first":while(n=n.previousSibling)if(n.nodeType===1)return!1;if(e==="first")return!0;n=t;case"last":while(n=n.nextSibling)if(n.nodeType===1)return!1;return!0}}},PSEUDO:function(e,t){var n,r=i.pseudos[e]||i.setFilters[e.toLowerCase()]||nt.error("unsupported pseudo: "+e);return r[d]?r(t):r.length>1?(n=[e,e,"",t],i.setFilters.hasOwnProperty(e.toLowerCase())?N(function(e,n){var i,s=r(e,t),o=s.length;while(o--)i=T.call(e,s[o]),e[i]=!(n[i]=s[o])}):function(e){return r(e,0,n)}):r}},pseudos:{not:N(function(e){var t=[],n=[],r=a(e.replace(j,"$1"));return r[d]?N(function(e,t,n,i){var s,o=r(e,null,i,[]),u=e.length;while(u--)if(s=o[u])e[u]=!(t[u]=s)}):function(e,i,s){return t[0]=e,r(t,null,s,n),!n.pop()}}),has:N(function(e){return function(t){return nt(e,t).length>0}}),contains:N(function(e){return function(t){return(t.textContent||t.innerText||s(t)).indexOf(e)>-1}}),enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&!!e.checked||t==="option"&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},parent:function(e){return!i.pseudos.empty(e)},empty:function(e){var t;e=e.firstChild;while(e){if(e.nodeName>"@"||(t=e.nodeType)===3||t===4)return!1;e=e.nextSibling}return!0},header:function(e){return X.test(e.nodeName)},text:function(e){var t,n;return e.nodeName.toLowerCase()==="input"&&(t=e.type)==="text"&&((n=e.getAttribute("type"))==null||n.toLowerCase()===t)},radio:rt("radio"),checkbox:rt("checkbox"),file:rt("file"),password:rt("password"),image:rt("image"),submit:it("submit"),reset:it("reset"),button:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&e.type==="button"||t==="button"},input:function(e){return V.test(e.nodeName)},focus:function(e){var t=e.ownerDocument;return e===t.activeElement&&(!t.hasFocus||t.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},active:function(e){return e===e.ownerDocument.activeElement},first:st(function(){return[0]}),last:st(function(e,t){return[t-1]}),eq:st(function(e,t,n){return[n<0?n+t:n]}),even:st(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:st(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:st(function(e,t,n){for(var r=n<0?n+t:n;--r>=0;)e.push(r);return e}),gt:st(function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e})}},f=y.compareDocumentPosition?function(e,t){return e===t?(l=!0,0):(!e.compareDocumentPosition||!t.compareDocumentPosition?e.compareDocumentPosition:e.compareDocumentPosition(t)&4)?-1:1}:function(e,t){if(e===t)return l=!0,0;if(e.sourceIndex&&t.sourceIndex)return e.sourceIndex-t.sourceIndex;var n,r,i=[],s=[],o=e.parentNode,u=t.parentNode,a=o;if(o===u)return ot(e,t);if(!o)return-1;if(!u)return 1;while(a)i.unshift(a),a=a.parentNode;a=u;while(a)s.unshift(a),a=a.parentNode;n=i.length,r=s.length;for(var f=0;f<n&&f<r;f++)if(i[f]!==s[f])return ot(i[f],s[f]);return f===n?ot(e,s[f],-1):ot(i[f],t,1)},[0,0].sort(f),h=!l,nt.uniqueSort=function(e){var t,n=[],r=1,i=0;l=h,e.sort(f);if(l){for(;t=e[r];r++)t===e[r-1]&&(i=n.push(r));while(i--)e.splice(n[i],1)}return e},nt.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},a=nt.compile=function(e,t){var n,r=[],i=[],s=A[d][e+" "];if(!s){t||(t=ut(e)),n=t.length;while(n--)s=ht(t[n]),s[d]?r.push(s):i.push(s);s=A(e,pt(i,r))}return s},g.querySelectorAll&&function(){var e,t=vt,n=/'|\\/g,r=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,i=[":focus"],s=[":active"],u=y.matchesSelector||y.mozMatchesSelector||y.webkitMatchesSelector||y.oMatchesSelector||y.msMatchesSelector;K(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||i.push("\\["+O+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)"),e.querySelectorAll(":checked").length||i.push(":checked")}),K(function(e){e.innerHTML="<p test=''></p>",e.querySelectorAll("[test^='']").length&&i.push("[*^$]="+O+"*(?:\"\"|'')"),e.innerHTML="<input type='hidden'/>",e.querySelectorAll(":enabled").length||i.push(":enabled",":disabled")}),i=new RegExp(i.join("|")),vt=function(e,r,s,o,u){if(!o&&!u&&!i.test(e)){var a,f,l=!0,c=d,h=r,p=r.nodeType===9&&e;if(r.nodeType===1&&r.nodeName.toLowerCase()!=="object"){a=ut(e),(l=r.getAttribute("id"))?c=l.replace(n,"\\$&"):r.setAttribute("id",c),c="[id='"+c+"'] ",f=a.length;while(f--)a[f]=c+a[f].join("");h=z.test(e)&&r.parentNode||r,p=a.join(",")}if(p)try{return S.apply(s,x.call(h.querySelectorAll(p),0)),s}catch(v){}finally{l||r.removeAttribute("id")}}return t(e,r,s,o,u)},u&&(K(function(t){e=u.call(t,"div");try{u.call(t,"[test!='']:sizzle"),s.push("!=",H)}catch(n){}}),s=new RegExp(s.join("|")),nt.matchesSelector=function(t,n){n=n.replace(r,"='$1']");if(!o(t)&&!s.test(n)&&!i.test(n))try{var a=u.call(t,n);if(a||e||t.document&&t.document.nodeType!==11)return a}catch(f){}return nt(n,null,null,[t]).length>0})}(),i.pseudos.nth=i.pseudos.eq,i.filters=mt.prototype=i.pseudos,i.setFilters=new mt,nt.attr=v.attr,v.find=nt,v.expr=nt.selectors,v.expr[":"]=v.expr.pseudos,v.unique=nt.uniqueSort,v.text=nt.getText,v.isXMLDoc=nt.isXML,v.contains=nt.contains}(e);var nt=/Until$/,rt=/^(?:parents|prev(?:Until|All))/,it=/^.[^:#\[\.,]*$/,st=v.expr.match.needsContext,ot={children:!0,contents:!0,next:!0,prev:!0};v.fn.extend({find:function(e){var t,n,r,i,s,o,u=this;if(typeof e!="string")return v(e).filter(function(){for(t=0,n=u.length;t<n;t++)if(v.contains(u[t],this))return!0});o=this.pushStack("","find",e);for(t=0,n=this.length;t<n;t++){r=o.length,v.find(e,this[t],o);if(t>0)for(i=r;i<o.length;i++)for(s=0;s<r;s++)if(o[s]===o[i]){o.splice(i--,1);break}}return o},has:function(e){var t,n=v(e,this),r=n.length;return this.filter(function(){for(t=0;t<r;t++)if(v.contains(this,n[t]))return!0})},not:function(e){return this.pushStack(ft(this,e,!1),"not",e)},filter:function(e){return this.pushStack(ft(this,e,!0),"filter",e)},is:function(e){return!!e&&(typeof e=="string"?st.test(e)?v(e,this.context).index(this[0])>=0:v.filter(e,this).length>0:this.filter(e).length>0)},closest:function(e,t){var n,r=0,i=this.length,s=[],o=st.test(e)||typeof e!="string"?v(e,t||this.context):0;for(;r<i;r++){n=this[r];while(n&&n.ownerDocument&&n!==t&&n.nodeType!==11){if(o?o.index(n)>-1:v.find.matchesSelector(n,e)){s.push(n);break}n=n.parentNode}}return s=s.length>1?v.unique(s):s,this.pushStack(s,"closest",e)},index:function(e){return e?typeof e=="string"?v.inArray(this[0],v(e)):v.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.prevAll().length:-1},add:function(e,t){var n=typeof e=="string"?v(e,t):v.makeArray(e&&e.nodeType?[e]:e),r=v.merge(this.get(),n);return this.pushStack(ut(n[0])||ut(r[0])?r:v.unique(r))},addBack:function(e){return this.add(e==null?this.prevObject:this.prevObject.filter(e))}}),v.fn.andSelf=v.fn.addBack,v.each({parent:function(e){var t=e.parentNode;return t&&t.nodeType!==11?t:null},parents:function(e){return v.dir(e,"parentNode")},parentsUntil:function(e,t,n){return v.dir(e,"parentNode",n)},next:function(e){return at(e,"nextSibling")},prev:function(e){return at(e,"previousSibling")},nextAll:function(e){return v.dir(e,"nextSibling")},prevAll:function(e){return v.dir(e,"previousSibling")},nextUntil:function(e,t,n){return v.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return v.dir(e,"previousSibling",n)},siblings:function(e){return v.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return v.sibling(e.firstChild)},contents:function(e){return v.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:v.merge([],e.childNodes)}},function(e,t){v.fn[e]=function(n,r){var i=v.map(this,t,n);return nt.test(e)||(r=n),r&&typeof r=="string"&&(i=v.filter(r,i)),i=this.length>1&&!ot[e]?v.unique(i):i,this.length>1&&rt.test(e)&&(i=i.reverse()),this.pushStack(i,e,l.call(arguments).join(","))}}),v.extend({filter:function(e,t,n){return n&&(e=":not("+e+")"),t.length===1?v.find.matchesSelector(t[0],e)?[t[0]]:[]:v.find.matches(e,t)},dir:function(e,n,r){var i=[],s=e[n];while(s&&s.nodeType!==9&&(r===t||s.nodeType!==1||!v(s).is(r)))s.nodeType===1&&i.push(s),s=s[n];return i},sibling:function(e,t){var n=[];for(;e;e=e.nextSibling)e.nodeType===1&&e!==t&&n.push(e);return n}});var ct="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",ht=/ jQuery\d+="(?:null|\d+)"/g,pt=/^\s+/,dt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,vt=/<([\w:]+)/,mt=/<tbody/i,gt=/<|&#?\w+;/,yt=/<(?:script|style|link)/i,bt=/<(?:script|object|embed|option|style)/i,wt=new RegExp("<(?:"+ct+")[\\s/>]","i"),Et=/^(?:checkbox|radio)$/,St=/checked\s*(?:[^=]|=\s*.checked.)/i,xt=/\/(java|ecma)script/i,Tt=/^\s*<!(?:\[CDATA\[|\-\-)|[\]\-]{2}>\s*$/g,Nt={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},Ct=lt(i),kt=Ct.appendChild(i.createElement("div"));Nt.optgroup=Nt.option,Nt.tbody=Nt.tfoot=Nt.colgroup=Nt.caption=Nt.thead,Nt.th=Nt.td,v.support.htmlSerialize||(Nt._default=[1,"X<div>","</div>"]),v.fn.extend({text:function(e){return v.access(this,function(e){return e===t?v.text(this):this.empty().append((this[0]&&this[0].ownerDocument||i).createTextNode(e))},null,e,arguments.length)},wrapAll:function(e){if(v.isFunction(e))return this.each(function(t){v(this).wrapAll(e.call(this,t))});if(this[0]){var t=v(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstChild&&e.firstChild.nodeType===1)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return v.isFunction(e)?this.each(function(t){v(this).wrapInner(e.call(this,t))}):this.each(function(){var t=v(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=v.isFunction(e);return this.each(function(n){v(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){v.nodeName(this,"body")||v(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(e){(this.nodeType===1||this.nodeType===11)&&this.appendChild(e)})},prepend:function(){return this.domManip(arguments,!0,function(e){(this.nodeType===1||this.nodeType===11)&&this.insertBefore(e,this.firstChild)})},before:function(){if(!ut(this[0]))return this.domManip(arguments,!1,function(e){this.parentNode.insertBefore(e,this)});if(arguments.length){var e=v.clean(arguments);return this.pushStack(v.merge(e,this),"before",this.selector)}},after:function(){if(!ut(this[0]))return this.domManip(arguments,!1,function(e){this.parentNode.insertBefore(e,this.nextSibling)});if(arguments.length){var e=v.clean(arguments);return this.pushStack(v.merge(this,e),"after",this.selector)}},remove:function(e,t){var n,r=0;for(;(n=this[r])!=null;r++)if(!e||v.filter(e,[n]).length)!t&&n.nodeType===1&&(v.cleanData(n.getElementsByTagName("*")),v.cleanData([n])),n.parentNode&&n.parentNode.removeChild(n);return this},empty:function(){var e,t=0;for(;(e=this[t])!=null;t++){e.nodeType===1&&v.cleanData(e.getElementsByTagName("*"));while(e.firstChild)e.removeChild(e.firstChild)}return this},clone:function(e,t){return e=e==null?!1:e,t=t==null?e:t,this.map(function(){return v.clone(this,e,t)})},html:function(e){return v.access(this,function(e){var n=this[0]||{},r=0,i=this.length;if(e===t)return n.nodeType===1?n.innerHTML.replace(ht,""):t;if(typeof e=="string"&&!yt.test(e)&&(v.support.htmlSerialize||!wt.test(e))&&(v.support.leadingWhitespace||!pt.test(e))&&!Nt[(vt.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(dt,"<$1></$2>");try{for(;r<i;r++)n=this[r]||{},n.nodeType===1&&(v.cleanData(n.getElementsByTagName("*")),n.innerHTML=e);n=0}catch(s){}}n&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(e){return ut(this[0])?this.length?this.pushStack(v(v.isFunction(e)?e():e),"replaceWith",e):this:v.isFunction(e)?this.each(function(t){var n=v(this),r=n.html();n.replaceWith(e.call(this,t,r))}):(typeof e!="string"&&(e=v(e).detach()),this.each(function(){var t=this.nextSibling,n=this.parentNode;v(this).remove(),t?v(t).before(e):v(n).append(e)}))},detach:function(e){return this.remove(e,!0)},domManip:function(e,n,r){e=[].concat.apply([],e);var i,s,o,u,a=0,f=e[0],l=[],c=this.length;if(!v.support.checkClone&&c>1&&typeof f=="string"&&St.test(f))return this.each(function(){v(this).domManip(e,n,r)});if(v.isFunction(f))return this.each(function(i){var s=v(this);e[0]=f.call(this,i,n?s.html():t),s.domManip(e,n,r)});if(this[0]){i=v.buildFragment(e,this,l),o=i.fragment,s=o.firstChild,o.childNodes.length===1&&(o=s);if(s){n=n&&v.nodeName(s,"tr");for(u=i.cacheable||c-1;a<c;a++)r.call(n&&v.nodeName(this[a],"table")?Lt(this[a],"tbody"):this[a],a===u?o:v.clone(o,!0,!0))}o=s=null,l.length&&v.each(l,function(e,t){t.src?v.ajax?v.ajax({url:t.src,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0}):v.error("no ajax"):v.globalEval((t.text||t.textContent||t.innerHTML||"").replace(Tt,"")),t.parentNode&&t.parentNode.removeChild(t)})}return this}}),v.buildFragment=function(e,n,r){var s,o,u,a=e[0];return n=n||i,n=!n.nodeType&&n[0]||n,n=n.ownerDocument||n,e.length===1&&typeof a=="string"&&a.length<512&&n===i&&a.charAt(0)==="<"&&!bt.test(a)&&(v.support.checkClone||!St.test(a))&&(v.support.html5Clone||!wt.test(a))&&(o=!0,s=v.fragments[a],u=s!==t),s||(s=n.createDocumentFragment(),v.clean(e,n,s,r),o&&(v.fragments[a]=u&&s)),{fragment:s,cacheable:o}},v.fragments={},v.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){v.fn[e]=function(n){var r,i=0,s=[],o=v(n),u=o.length,a=this.length===1&&this[0].parentNode;if((a==null||a&&a.nodeType===11&&a.childNodes.length===1)&&u===1)return o[t](this[0]),this;for(;i<u;i++)r=(i>0?this.clone(!0):this).get(),v(o[i])[t](r),s=s.concat(r);return this.pushStack(s,e,o.selector)}}),v.extend({clone:function(e,t,n){var r,i,s,o;v.support.html5Clone||v.isXMLDoc(e)||!wt.test("<"+e.nodeName+">")?o=e.cloneNode(!0):(kt.innerHTML=e.outerHTML,kt.removeChild(o=kt.firstChild));if((!v.support.noCloneEvent||!v.support.noCloneChecked)&&(e.nodeType===1||e.nodeType===11)&&!v.isXMLDoc(e)){Ot(e,o),r=Mt(e),i=Mt(o);for(s=0;r[s];++s)i[s]&&Ot(r[s],i[s])}if(t){At(e,o);if(n){r=Mt(e),i=Mt(o);for(s=0;r[s];++s)At(r[s],i[s])}}return r=i=null,o},clean:function(e,t,n,r){var s,o,u,a,f,l,c,h,p,d,m,g,y=t===i&&Ct,b=[];if(!t||typeof t.createDocumentFragment=="undefined")t=i;for(s=0;(u=e[s])!=null;s++){typeof u=="number"&&(u+="");if(!u)continue;if(typeof u=="string")if(!gt.test(u))u=t.createTextNode(u);else{y=y||lt(t),c=t.createElement("div"),y.appendChild(c),u=u.replace(dt,"<$1></$2>"),a=(vt.exec(u)||["",""])[1].toLowerCase(),f=Nt[a]||Nt._default,l=f[0],c.innerHTML=f[1]+u+f[2];while(l--)c=c.lastChild;if(!v.support.tbody){h=mt.test(u),p=a==="table"&&!h?c.firstChild&&c.firstChild.childNodes:f[1]==="<table>"&&!h?c.childNodes:[];for(o=p.length-1;o>=0;--o)v.nodeName(p[o],"tbody")&&!p[o].childNodes.length&&p[o].parentNode.removeChild(p[o])}!v.support.leadingWhitespace&&pt.test(u)&&c.insertBefore(t.createTextNode(pt.exec(u)[0]),c.firstChild),u=c.childNodes,c.parentNode.removeChild(c)}u.nodeType?b.push(u):v.merge(b,u)}c&&(u=c=y=null);if(!v.support.appendChecked)for(s=0;(u=b[s])!=null;s++)v.nodeName(u,"input")?_t(u):typeof u.getElementsByTagName!="undefined"&&v.grep(u.getElementsByTagName("input"),_t);if(n){m=function(e){if(!e.type||xt.test(e.type))return r?r.push(e.parentNode?e.parentNode.removeChild(e):e):n.appendChild(e)};for(s=0;(u=b[s])!=null;s++)if(!v.nodeName(u,"script")||!m(u))n.appendChild(u),typeof u.getElementsByTagName!="undefined"&&(g=v.grep(v.merge([],u.getElementsByTagName("script")),m),b.splice.apply(b,[s+1,0].concat(g)),s+=g.length)}return b},cleanData:function(e,t){var n,r,i,s,o=0,u=v.expando,a=v.cache,f=v.support.deleteExpando,l=v.event.special;for(;(i=e[o])!=null;o++)if(t||v.acceptData(i)){r=i[u],n=r&&a[r];if(n){if(n.events)for(s in n.events)l[s]?v.event.remove(i,s):v.removeEvent(i,s,n.handle);a[r]&&(delete a[r],f?delete i[u]:i.removeAttribute?i.removeAttribute(u):i[u]=null,v.deletedIds.push(r))}}}}),function(){var e,t;v.uaMatch=function(e){e=e.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}},e=v.uaMatch(o.userAgent),t={},e.browser&&(t[e.browser]=!0,t.version=e.version),t.chrome?t.webkit=!0:t.webkit&&(t.safari=!0),v.browser=t,v.sub=function(){function e(t,n){return new e.fn.init(t,n)}v.extend(!0,e,this),e.superclass=this,e.fn=e.prototype=this(),e.fn.constructor=e,e.sub=this.sub,e.fn.init=function(r,i){return i&&i instanceof v&&!(i instanceof e)&&(i=e(i)),v.fn.init.call(this,r,i,t)},e.fn.init.prototype=e.fn;var t=e(i);return e}}();var Dt,Pt,Ht,Bt=/alpha\([^)]*\)/i,jt=/opacity=([^)]*)/,Ft=/^(top|right|bottom|left)$/,It=/^(none|table(?!-c[ea]).+)/,qt=/^margin/,Rt=new RegExp("^("+m+")(.*)$","i"),Ut=new RegExp("^("+m+")(?!px)[a-z%]+$","i"),zt=new RegExp("^([-+])=("+m+")","i"),Wt={BODY:"block"},Xt={position:"absolute",visibility:"hidden",display:"block"},Vt={letterSpacing:0,fontWeight:400},$t=["Top","Right","Bottom","Left"],Jt=["Webkit","O","Moz","ms"],Kt=v.fn.toggle;v.fn.extend({css:function(e,n){return v.access(this,function(e,n,r){return r!==t?v.style(e,n,r):v.css(e,n)},e,n,arguments.length>1)},show:function(){return Yt(this,!0)},hide:function(){return Yt(this)},toggle:function(e,t){var n=typeof e=="boolean";return v.isFunction(e)&&v.isFunction(t)?Kt.apply(this,arguments):this.each(function(){(n?e:Gt(this))?v(this).show():v(this).hide()})}}),v.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Dt(e,"opacity");return n===""?"1":n}}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":v.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,n,r,i){if(!e||e.nodeType===3||e.nodeType===8||!e.style)return;var s,o,u,a=v.camelCase(n),f=e.style;n=v.cssProps[a]||(v.cssProps[a]=Qt(f,a)),u=v.cssHooks[n]||v.cssHooks[a];if(r===t)return u&&"get"in u&&(s=u.get(e,!1,i))!==t?s:f[n];o=typeof r,o==="string"&&(s=zt.exec(r))&&(r=(s[1]+1)*s[2]+parseFloat(v.css(e,n)),o="number");if(r==null||o==="number"&&isNaN(r))return;o==="number"&&!v.cssNumber[a]&&(r+="px");if(!u||!("set"in u)||(r=u.set(e,r,i))!==t)try{f[n]=r}catch(l){}},css:function(e,n,r,i){var s,o,u,a=v.camelCase(n);return n=v.cssProps[a]||(v.cssProps[a]=Qt(e.style,a)),u=v.cssHooks[n]||v.cssHooks[a],u&&"get"in u&&(s=u.get(e,!0,i)),s===t&&(s=Dt(e,n)),s==="normal"&&n in Vt&&(s=Vt[n]),r||i!==t?(o=parseFloat(s),r||v.isNumeric(o)?o||0:s):s},swap:function(e,t,n){var r,i,s={};for(i in t)s[i]=e.style[i],e.style[i]=t[i];r=n.call(e);for(i in t)e.style[i]=s[i];return r}}),e.getComputedStyle?Dt=function(t,n){var r,i,s,o,u=e.getComputedStyle(t,null),a=t.style;return u&&(r=u.getPropertyValue(n)||u[n],r===""&&!v.contains(t.ownerDocument,t)&&(r=v.style(t,n)),Ut.test(r)&&qt.test(n)&&(i=a.width,s=a.minWidth,o=a.maxWidth,a.minWidth=a.maxWidth=a.width=r,r=u.width,a.width=i,a.minWidth=s,a.maxWidth=o)),r}:i.documentElement.currentStyle&&(Dt=function(e,t){var n,r,i=e.currentStyle&&e.currentStyle[t],s=e.style;return i==null&&s&&s[t]&&(i=s[t]),Ut.test(i)&&!Ft.test(t)&&(n=s.left,r=e.runtimeStyle&&e.runtimeStyle.left,r&&(e.runtimeStyle.left=e.currentStyle.left),s.left=t==="fontSize"?"1em":i,i=s.pixelLeft+"px",s.left=n,r&&(e.runtimeStyle.left=r)),i===""?"auto":i}),v.each(["height","width"],function(e,t){v.cssHooks[t]={get:function(e,n,r){if(n)return e.offsetWidth===0&&It.test(Dt(e,"display"))?v.swap(e,Xt,function(){return tn(e,t,r)}):tn(e,t,r)},set:function(e,n,r){return Zt(e,n,r?en(e,t,r,v.support.boxSizing&&v.css(e,"boxSizing")==="border-box"):0)}}}),v.support.opacity||(v.cssHooks.opacity={get:function(e,t){return jt.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var n=e.style,r=e.currentStyle,i=v.isNumeric(t)?"alpha(opacity="+t*100+")":"",s=r&&r.filter||n.filter||"";n.zoom=1;if(t>=1&&v.trim(s.replace(Bt,""))===""&&n.removeAttribute){n.removeAttribute("filter");if(r&&!r.filter)return}n.filter=Bt.test(s)?s.replace(Bt,i):s+" "+i}}),v(function(){v.support.reliableMarginRight||(v.cssHooks.marginRight={get:function(e,t){return v.swap(e,{display:"inline-block"},function(){if(t)return Dt(e,"marginRight")})}}),!v.support.pixelPosition&&v.fn.position&&v.each(["top","left"],function(e,t){v.cssHooks[t]={get:function(e,n){if(n){var r=Dt(e,t);return Ut.test(r)?v(e).position()[t]+"px":r}}}})}),v.expr&&v.expr.filters&&(v.expr.filters.hidden=function(e){return e.offsetWidth===0&&e.offsetHeight===0||!v.support.reliableHiddenOffsets&&(e.style&&e.style.display||Dt(e,"display"))==="none"},v.expr.filters.visible=function(e){return!v.expr.filters.hidden(e)}),v.each({margin:"",padding:"",border:"Width"},function(e,t){v.cssHooks[e+t]={expand:function(n){var r,i=typeof n=="string"?n.split(" "):[n],s={};for(r=0;r<4;r++)s[e+$t[r]+t]=i[r]||i[r-2]||i[0];return s}},qt.test(e)||(v.cssHooks[e+t].set=Zt)});var rn=/%20/g,sn=/\[\]$/,on=/\r?\n/g,un=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,an=/^(?:select|textarea)/i;v.fn.extend({serialize:function(){return v.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?v.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||an.test(this.nodeName)||un.test(this.type))}).map(function(e,t){var n=v(this).val();return n==null?null:v.isArray(n)?v.map(n,function(e,n){return{name:t.name,value:e.replace(on,"\r\n")}}):{name:t.name,value:n.replace(on,"\r\n")}}).get()}}),v.param=function(e,n){var r,i=[],s=function(e,t){t=v.isFunction(t)?t():t==null?"":t,i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};n===t&&(n=v.ajaxSettings&&v.ajaxSettings.traditional);if(v.isArray(e)||e.jquery&&!v.isPlainObject(e))v.each(e,function(){s(this.name,this.value)});else for(r in e)fn(r,e[r],n,s);return i.join("&").replace(rn,"+")};var ln,cn,hn=/#.*$/,pn=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,dn=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,vn=/^(?:GET|HEAD)$/,mn=/^\/\//,gn=/\?/,yn=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,bn=/([?&])_=[^&]*/,wn=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,En=v.fn.load,Sn={},xn={},Tn=["*/"]+["*"];try{cn=s.href}catch(Nn){cn=i.createElement("a"),cn.href="",cn=cn.href}ln=wn.exec(cn.toLowerCase())||[],v.fn.load=function(e,n,r){if(typeof e!="string"&&En)return En.apply(this,arguments);if(!this.length)return this;var i,s,o,u=this,a=e.indexOf(" ");return a>=0&&(i=e.slice(a,e.length),e=e.slice(0,a)),v.isFunction(n)?(r=n,n=t):n&&typeof n=="object"&&(s="POST"),v.ajax({url:e,type:s,dataType:"html",data:n,complete:function(e,t){r&&u.each(r,o||[e.responseText,t,e])}}).done(function(e){o=arguments,u.html(i?v("<div>").append(e.replace(yn,"")).find(i):e)}),this},v.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(e,t){v.fn[t]=function(e){return this.on(t,e)}}),v.each(["get","post"],function(e,n){v[n]=function(e,r,i,s){return v.isFunction(r)&&(s=s||i,i=r,r=t),v.ajax({type:n,url:e,data:r,success:i,dataType:s})}}),v.extend({getScript:function(e,n){return v.get(e,t,n,"script")},getJSON:function(e,t,n){return v.get(e,t,n,"json")},ajaxSetup:function(e,t){return t?Ln(e,v.ajaxSettings):(t=e,e=v.ajaxSettings),Ln(e,t),e},ajaxSettings:{url:cn,isLocal:dn.test(ln[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":Tn},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":e.String,"text html":!0,"text json":v.parseJSON,"text xml":v.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:Cn(Sn),ajaxTransport:Cn(xn),ajax:function(e,n){function T(e,n,s,a){var l,y,b,w,S,T=n;if(E===2)return;E=2,u&&clearTimeout(u),o=t,i=a||"",x.readyState=e>0?4:0,s&&(w=An(c,x,s));if(e>=200&&e<300||e===304)c.ifModified&&(S=x.getResponseHeader("Last-Modified"),S&&(v.lastModified[r]=S),S=x.getResponseHeader("Etag"),S&&(v.etag[r]=S)),e===304?(T="notmodified",l=!0):(l=On(c,w),T=l.state,y=l.data,b=l.error,l=!b);else{b=T;if(!T||e)T="error",e<0&&(e=0)}x.status=e,x.statusText=(n||T)+"",l?d.resolveWith(h,[y,T,x]):d.rejectWith(h,[x,T,b]),x.statusCode(g),g=t,f&&p.trigger("ajax"+(l?"Success":"Error"),[x,c,l?y:b]),m.fireWith(h,[x,T]),f&&(p.trigger("ajaxComplete",[x,c]),--v.active||v.event.trigger("ajaxStop"))}typeof e=="object"&&(n=e,e=t),n=n||{};var r,i,s,o,u,a,f,l,c=v.ajaxSetup({},n),h=c.context||c,p=h!==c&&(h.nodeType||h instanceof v)?v(h):v.event,d=v.Deferred(),m=v.Callbacks("once memory"),g=c.statusCode||{},b={},w={},E=0,S="canceled",x={readyState:0,setRequestHeader:function(e,t){if(!E){var n=e.toLowerCase();e=w[n]=w[n]||e,b[e]=t}return this},getAllResponseHeaders:function(){return E===2?i:null},getResponseHeader:function(e){var n;if(E===2){if(!s){s={};while(n=pn.exec(i))s[n[1].toLowerCase()]=n[2]}n=s[e.toLowerCase()]}return n===t?null:n},overrideMimeType:function(e){return E||(c.mimeType=e),this},abort:function(e){return e=e||S,o&&o.abort(e),T(0,e),this}};d.promise(x),x.success=x.done,x.error=x.fail,x.complete=m.add,x.statusCode=function(e){if(e){var t;if(E<2)for(t in e)g[t]=[g[t],e[t]];else t=e[x.status],x.always(t)}return this},c.url=((e||c.url)+"").replace(hn,"").replace(mn,ln[1]+"//"),c.dataTypes=v.trim(c.dataType||"*").toLowerCase().split(y),c.crossDomain==null&&(a=wn.exec(c.url.toLowerCase()),c.crossDomain=!(!a||a[1]===ln[1]&&a[2]===ln[2]&&(a[3]||(a[1]==="http:"?80:443))==(ln[3]||(ln[1]==="http:"?80:443)))),c.data&&c.processData&&typeof c.data!="string"&&(c.data=v.param(c.data,c.traditional)),kn(Sn,c,n,x);if(E===2)return x;f=c.global,c.type=c.type.toUpperCase(),c.hasContent=!vn.test(c.type),f&&v.active++===0&&v.event.trigger("ajaxStart");if(!c.hasContent){c.data&&(c.url+=(gn.test(c.url)?"&":"?")+c.data,delete c.data),r=c.url;if(c.cache===!1){var N=v.now(),C=c.url.replace(bn,"$1_="+N);c.url=C+(C===c.url?(gn.test(c.url)?"&":"?")+"_="+N:"")}}(c.data&&c.hasContent&&c.contentType!==!1||n.contentType)&&x.setRequestHeader("Content-Type",c.contentType),c.ifModified&&(r=r||c.url,v.lastModified[r]&&x.setRequestHeader("If-Modified-Since",v.lastModified[r]),v.etag[r]&&x.setRequestHeader("If-None-Match",v.etag[r])),x.setRequestHeader("Accept",c.dataTypes[0]&&c.accepts[c.dataTypes[0]]?c.accepts[c.dataTypes[0]]+(c.dataTypes[0]!=="*"?", "+Tn+"; q=0.01":""):c.accepts["*"]);for(l in c.headers)x.setRequestHeader(l,c.headers[l]);if(!c.beforeSend||c.beforeSend.call(h,x,c)!==!1&&E!==2){S="abort";for(l in{success:1,error:1,complete:1})x[l](c[l]);o=kn(xn,c,n,x);if(!o)T(-1,"No Transport");else{x.readyState=1,f&&p.trigger("ajaxSend",[x,c]),c.async&&c.timeout>0&&(u=setTimeout(function(){x.abort("timeout")},c.timeout));try{E=1,o.send(b,T)}catch(k){if(!(E<2))throw k;T(-1,k)}}return x}return x.abort()},active:0,lastModified:{},etag:{}});var Mn=[],_n=/\?/,Dn=/(=)\?(?=&|$)|\?\?/,Pn=v.now();v.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Mn.pop()||v.expando+"_"+Pn++;return this[e]=!0,e}}),v.ajaxPrefilter("json jsonp",function(n,r,i){var s,o,u,a=n.data,f=n.url,l=n.jsonp!==!1,c=l&&Dn.test(f),h=l&&!c&&typeof a=="string"&&!(n.contentType||"").indexOf("application/x-www-form-urlencoded")&&Dn.test(a);if(n.dataTypes[0]==="jsonp"||c||h)return s=n.jsonpCallback=v.isFunction(n.jsonpCallback)?n.jsonpCallback():n.jsonpCallback,o=e[s],c?n.url=f.replace(Dn,"$1"+s):h?n.data=a.replace(Dn,"$1"+s):l&&(n.url+=(_n.test(f)?"&":"?")+n.jsonp+"="+s),n.converters["script json"]=function(){return u||v.error(s+" was not called"),u[0]},n.dataTypes[0]="json",e[s]=function(){u=arguments},i.always(function(){e[s]=o,n[s]&&(n.jsonpCallback=r.jsonpCallback,Mn.push(s)),u&&v.isFunction(o)&&o(u[0]),u=o=t}),"script"}),v.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(e){return v.globalEval(e),e}}}),v.ajaxPrefilter("script",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),v.ajaxTransport("script",function(e){if(e.crossDomain){var n,r=i.head||i.getElementsByTagName("head")[0]||i.documentElement;return{send:function(s,o){n=i.createElement("script"),n.async="async",e.scriptCharset&&(n.charset=e.scriptCharset),n.src=e.url,n.onload=n.onreadystatechange=function(e,i){if(i||!n.readyState||/loaded|complete/.test(n.readyState))n.onload=n.onreadystatechange=null,r&&n.parentNode&&r.removeChild(n),n=t,i||o(200,"success")},r.insertBefore(n,r.firstChild)},abort:function(){n&&n.onload(0,1)}}}});var Hn,Bn=e.ActiveXObject?function(){for(var e in Hn)Hn[e](0,1)}:!1,jn=0;v.ajaxSettings.xhr=e.ActiveXObject?function(){return!this.isLocal&&Fn()||In()}:Fn,function(e){v.extend(v.support,{ajax:!!e,cors:!!e&&"withCredentials"in e})}(v.ajaxSettings.xhr()),v.support.ajax&&v.ajaxTransport(function(n){if(!n.crossDomain||v.support.cors){var r;return{send:function(i,s){var o,u,a=n.xhr();n.username?a.open(n.type,n.url,n.async,n.username,n.password):a.open(n.type,n.url,n.async);if(n.xhrFields)for(u in n.xhrFields)a[u]=n.xhrFields[u];n.mimeType&&a.overrideMimeType&&a.overrideMimeType(n.mimeType),!n.crossDomain&&!i["X-Requested-With"]&&(i["X-Requested-With"]="XMLHttpRequest");try{for(u in i)a.setRequestHeader(u,i[u])}catch(f){}a.send(n.hasContent&&n.data||null),r=function(e,i){var u,f,l,c,h;try{if(r&&(i||a.readyState===4)){r=t,o&&(a.onreadystatechange=v.noop,Bn&&delete Hn[o]);if(i)a.readyState!==4&&a.abort();else{u=a.status,l=a.getAllResponseHeaders(),c={},h=a.responseXML,h&&h.documentElement&&(c.xml=h);try{c.text=a.responseText}catch(p){}try{f=a.statusText}catch(p){f=""}!u&&n.isLocal&&!n.crossDomain?u=c.text?200:404:u===1223&&(u=204)}}}catch(d){i||s(-1,d)}c&&s(u,f,c,l)},n.async?a.readyState===4?setTimeout(r,0):(o=++jn,Bn&&(Hn||(Hn={},v(e).unload(Bn)),Hn[o]=r),a.onreadystatechange=r):r()},abort:function(){r&&r(0,1)}}}});var qn,Rn,Un=/^(?:toggle|show|hide)$/,zn=new RegExp("^(?:([-+])=|)("+m+")([a-z%]*)$","i"),Wn=/queueHooks$/,Xn=[Gn],Vn={"*":[function(e,t){var n,r,i=this.createTween(e,t),s=zn.exec(t),o=i.cur(),u=+o||0,a=1,f=20;if(s){n=+s[2],r=s[3]||(v.cssNumber[e]?"":"px");if(r!=="px"&&u){u=v.css(i.elem,e,!0)||n||1;do a=a||".5",u/=a,v.style(i.elem,e,u+r);while(a!==(a=i.cur()/o)&&a!==1&&--f)}i.unit=r,i.start=u,i.end=s[1]?u+(s[1]+1)*n:n}return i}]};v.Animation=v.extend(Kn,{tweener:function(e,t){v.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");var n,r=0,i=e.length;for(;r<i;r++)n=e[r],Vn[n]=Vn[n]||[],Vn[n].unshift(t)},prefilter:function(e,t){t?Xn.unshift(e):Xn.push(e)}}),v.Tween=Yn,Yn.prototype={constructor:Yn,init:function(e,t,n,r,i,s){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=s||(v.cssNumber[n]?"":"px")},cur:function(){var e=Yn.propHooks[this.prop];return e&&e.get?e.get(this):Yn.propHooks._default.get(this)},run:function(e){var t,n=Yn.propHooks[this.prop];return this.options.duration?this.pos=t=v.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):Yn.propHooks._default.set(this),this}},Yn.prototype.init.prototype=Yn.prototype,Yn.propHooks={_default:{get:function(e){var t;return e.elem[e.prop]==null||!!e.elem.style&&e.elem.style[e.prop]!=null?(t=v.css(e.elem,e.prop,!1,""),!t||t==="auto"?0:t):e.elem[e.prop]},set:function(e){v.fx.step[e.prop]?v.fx.step[e.prop](e):e.elem.style&&(e.elem.style[v.cssProps[e.prop]]!=null||v.cssHooks[e.prop])?v.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},Yn.propHooks.scrollTop=Yn.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},v.each(["toggle","show","hide"],function(e,t){var n=v.fn[t];v.fn[t]=function(r,i,s){return r==null||typeof r=="boolean"||!e&&v.isFunction(r)&&v.isFunction(i)?n.apply(this,arguments):this.animate(Zn(t,!0),r,i,s)}}),v.fn.extend({fadeTo:function(e,t,n,r){return this.filter(Gt).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=v.isEmptyObject(e),s=v.speed(t,n,r),o=function(){var t=Kn(this,v.extend({},e),s);i&&t.stop(!0)};return i||s.queue===!1?this.each(o):this.queue(s.queue,o)},stop:function(e,n,r){var i=function(e){var t=e.stop;delete e.stop,t(r)};return typeof e!="string"&&(r=n,n=e,e=t),n&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,n=e!=null&&e+"queueHooks",s=v.timers,o=v._data(this);if(n)o[n]&&o[n].stop&&i(o[n]);else for(n in o)o[n]&&o[n].stop&&Wn.test(n)&&i(o[n]);for(n=s.length;n--;)s[n].elem===this&&(e==null||s[n].queue===e)&&(s[n].anim.stop(r),t=!1,s.splice(n,1));(t||!r)&&v.dequeue(this,e)})}}),v.each({slideDown:Zn("show"),slideUp:Zn("hide"),slideToggle:Zn("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){v.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),v.speed=function(e,t,n){var r=e&&typeof e=="object"?v.extend({},e):{complete:n||!n&&t||v.isFunction(e)&&e,duration:e,easing:n&&t||t&&!v.isFunction(t)&&t};r.duration=v.fx.off?0:typeof r.duration=="number"?r.duration:r.duration in v.fx.speeds?v.fx.speeds[r.duration]:v.fx.speeds._default;if(r.queue==null||r.queue===!0)r.queue="fx";return r.old=r.complete,r.complete=function(){v.isFunction(r.old)&&r.old.call(this),r.queue&&v.dequeue(this,r.queue)},r},v.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},v.timers=[],v.fx=Yn.prototype.init,v.fx.tick=function(){var e,n=v.timers,r=0;qn=v.now();for(;r<n.length;r++)e=n[r],!e()&&n[r]===e&&n.splice(r--,1);n.length||v.fx.stop(),qn=t},v.fx.timer=function(e){e()&&v.timers.push(e)&&!Rn&&(Rn=setInterval(v.fx.tick,v.fx.interval))},v.fx.interval=13,v.fx.stop=function(){clearInterval(Rn),Rn=null},v.fx.speeds={slow:600,fast:200,_default:400},v.fx.step={},v.expr&&v.expr.filters&&(v.expr.filters.animated=function(e){return v.grep(v.timers,function(t){return e===t.elem}).length});var er=/^(?:body|html)$/i;v.fn.offset=function(e){if(arguments.length)return e===t?this:this.each(function(t){v.offset.setOffset(this,e,t)});var n,r,i,s,o,u,a,f={top:0,left:0},l=this[0],c=l&&l.ownerDocument;if(!c)return;return(r=c.body)===l?v.offset.bodyOffset(l):(n=c.documentElement,v.contains(n,l)?(typeof l.getBoundingClientRect!="undefined"&&(f=l.getBoundingClientRect()),i=tr(c),s=n.clientTop||r.clientTop||0,o=n.clientLeft||r.clientLeft||0,u=i.pageYOffset||n.scrollTop,a=i.pageXOffset||n.scrollLeft,{top:f.top+u-s,left:f.left+a-o}):f)},v.offset={bodyOffset:function(e){var t=e.offsetTop,n=e.offsetLeft;return v.support.doesNotIncludeMarginInBodyOffset&&(t+=parseFloat(v.css(e,"marginTop"))||0,n+=parseFloat(v.css(e,"marginLeft"))||0),{top:t,left:n}},setOffset:function(e,t,n){var r=v.css(e,"position");r==="static"&&(e.style.position="relative");var i=v(e),s=i.offset(),o=v.css(e,"top"),u=v.css(e,"left"),a=(r==="absolute"||r==="fixed")&&v.inArray("auto",[o,u])>-1,f={},l={},c,h;a?(l=i.position(),c=l.top,h=l.left):(c=parseFloat(o)||0,h=parseFloat(u)||0),v.isFunction(t)&&(t=t.call(e,n,s)),t.top!=null&&(f.top=t.top-s.top+c),t.left!=null&&(f.left=t.left-s.left+h),"using"in t?t.using.call(e,f):i.css(f)}},v.fn.extend({position:function(){if(!this[0])return;var e=this[0],t=this.offsetParent(),n=this.offset(),r=er.test(t[0].nodeName)?{top:0,left:0}:t.offset();return n.top-=parseFloat(v.css(e,"marginTop"))||0,n.left-=parseFloat(v.css(e,"marginLeft"))||0,r.top+=parseFloat(v.css(t[0],"borderTopWidth"))||0,r.left+=parseFloat(v.css(t[0],"borderLeftWidth"))||0,{top:n.top-r.top,left:n.left-r.left}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||i.body;while(e&&!er.test(e.nodeName)&&v.css(e,"position")==="static")e=e.offsetParent;return e||i.body})}}),v.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,n){var r=/Y/.test(n);v.fn[e]=function(i){return v.access(this,function(e,i,s){var o=tr(e);if(s===t)return o?n in o?o[n]:o.document.documentElement[i]:e[i];o?o.scrollTo(r?v(o).scrollLeft():s,r?s:v(o).scrollTop()):e[i]=s},e,i,arguments.length,null)}}),v.each({Height:"height",Width:"width"},function(e,n){v.each({padding:"inner"+e,content:n,"":"outer"+e},function(r,i){v.fn[i]=function(i,s){var o=arguments.length&&(r||typeof i!="boolean"),u=r||(i===!0||s===!0?"margin":"border");return v.access(this,function(n,r,i){var s;return v.isWindow(n)?n.document.documentElement["client"+e]:n.nodeType===9?(s=n.documentElement,Math.max(n.body["scroll"+e],s["scroll"+e],n.body["offset"+e],s["offset"+e],s["client"+e])):i===t?v.css(n,r,i,u):v.style(n,r,i,u)},n,o?i:t,o,null)}})}),e.jQuery=e.$=v,typeof define=="function"&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return v})})(window);
(function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"==typeof window?"undefined"==typeof global?"undefined"==typeof self?this:self:global:window,t.vg=e(),vg=t.vg}})(function(){var e=Math.tan,s=Math.cos,d=Math.sin,l=Math.PI,h=Math.sqrt,y=Math.ceil,_=Math.log,v=Math.round,S=Math.pow,w=Math.min,T=Math.floor,A=Math.max,L=Math.abs,E;return function d(p,e,t){function a(r,i){if(!e[r]){if(!p[r]){var s="function"==typeof require&&require;if(!i&&s)return s(r,!0);if(n)return n(r,!0);var o=new Error("Cannot find module '"+r+"'");throw o.code="MODULE_NOT_FOUND",o}var u=e[r]={exports:{}};p[r][0].call(u.exports,function(t){var e=p[r][1][t];return a(e?e:t)},u,u.exports,d,p,e,t)}return e[r].exports}for(var n="function"==typeof require&&require,r=0;r<t.length;r++)a(t[r]);return a}({1:[function(e,t){t.exports={version:"2.6.5",dataflow:e("vega-dataflow"),parse:e("./src/parse/"),scene:{Bounder:e("./src/scene/Bounder"),Builder:e("./src/scene/Builder"),Encoder:e("./src/scene/Encoder"),GroupBuilder:e("./src/scene/GroupBuilder"),visit:e("./src/scene/visit")},transforms:e("./src/transforms"),Transform:e("./src/transforms/Transform"),BatchTransform:e("./src/transforms/BatchTransform"),Parameter:e("./src/transforms/Parameter"),schema:e("./src/core/schema"),config:e("./src/core/config"),util:e("./src/util"),logging:e("vega-logging"),debug:e("vega-logging").debug}},{"./src/core/config":92,"./src/core/schema":93,"./src/parse/":98,"./src/scene/Bounder":110,"./src/scene/Builder":111,"./src/scene/Encoder":112,"./src/scene/GroupBuilder":113,"./src/scene/visit":118,"./src/transforms":146,"./src/transforms/BatchTransform":120,"./src/transforms/Parameter":136,"./src/transforms/Transform":141,"./src/util":149,"vega-dataflow":42,"vega-logging":49}],2:[function(){},{}],3:[function(e,t,a){(function(e,n){"object"==typeof a&&"undefined"!=typeof t?n(a):"function"==typeof E&&E.amd?E(["exports"],n):n(e.d3_dsv={})})(this,function(e){"use strict";function t(e){return new i(e)}function a(e){return new Function("d","return {"+e.map(function(e,t){return JSON.stringify(e)+": d["+t+"]"}).join(",")+"}")}function n(e,t){var n=a(e);return function(a,r){return t(n(a),r,e)}}// Compute unique columns in order of discovery.
function r(e){var t=Object.create(null),a=[];return e.forEach(function(e){for(var n in e)n in t||a.push(t[n]=n)}),a}function i(e){function t(t){return t.map(i).join(e)}function i(e){return s.test(e)?"\""+e.replace(/\"/g,"\"\"")+"\"":e}var s=new RegExp("[\""+e+"\n]"),d=e.charCodeAt(0);this.parse=function(e,t){var r=this.parseRows(e,function(e,r){return s?s(e,r-1):void(d=e,s=t?n(e,t):a(e))}),s,d;return r.columns=d,r},this.parseRows=function(e,r){// is the current token followed by EOL?
function i(){if(u>=p)return o;// special case: end of file
if(m)return m=!1,s;// special case: end of line
// special case: quotes
var t=u,a;if(34===e.charCodeAt(t)){for(var n=t;n++<p;)if(34===e.charCodeAt(n)){if(34!==e.charCodeAt(n+1))break;++n}return u=n+2,a=e.charCodeAt(n+1),13===a?(m=!0,10===e.charCodeAt(n+2)&&++u):10===a&&(m=!0),e.slice(t+1,n).replace(/""/g,"\"")}// common case: find next delimiter or newline
for(;u<p;){var r=1;if(a=e.charCodeAt(u++),10===a)m=!0;// \n
else if(13===a)m=!0,10===e.charCodeAt(u)&&(++u,++r);// \r|\r\n
else if(a!==d)continue;return e.slice(t,u-r)}// special case: last token before EOF
return e.slice(t)}for(var s={},// sentinel value for end-of-line
o={},// sentinel value for end-of-file
l=[],// output rows
p=e.length,u=0,// current character index
c=0,// the current line number
g,// the current token
m;(g=i())!==o;){for(var h=[];g!==s&&g!==o;)h.push(g),g=i();r&&null==(h=r(h,c++))||l.push(h)}return l},this.format=function(t,a){return null==a&&(a=r(t)),[a.map(i).join(e)].concat(t.map(function(t){return a.map(function(e){return i(t[e])}).join(e)})).join("\n")},this.formatRows=function(e){return e.map(t).join("\n")}}t.prototype=i.prototype;var s=t(","),d=t("\t");e.version="0.1.14",e.dsv=t,e.csv=s,e.tsv=d})},{}],4:[function(e,t,a){(function(e,n){"object"==typeof a&&"undefined"!=typeof t?n(a):"function"==typeof E&&E.amd?E("d3-format",["exports"],n):n(e.d3_format={})})(this,function(e){"use strict";// Computes the decimal coefficient and exponent of the specified number x with
// significant digits p, where x is positive and p is in [1, 21] or undefined.
// For example, formatDecimal(1.23) returns ["123", 0].
function t(e,t){if(0>(n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e")))return null;// NaN, Infinity
var a=e.slice(0,n),n;// The string returned by toExponential either has the form \d\.\d+e[-+]\d+
// (e.g., 1.2e+3) or the form \de[-+]\d+ (e.g., 1e+3).
return[1<a.length?a[0]+a.slice(2):a,+e.slice(n+1)]}function a(e){return e=t(L(e)),e?e[1]:NaN}function n(e,a){return function(n,r){for(var s=n.length,d=[],t=0,o=e[0],l=0;0<s&&0<o&&(l+o+1>r&&(o=A(1,r-l)),d.push(n.substring(s-=o,s+o)),!((l+=o+1)>r));)o=e[t=(t+1)%e.length];return d.reverse().join(a)}}function r(e,a){var n=t(e,a);if(!n)return e+"";var r=n[0],i=n[1];return 0>i?"0."+Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+Array(i-r.length+2).join("0")}function i(e){return new s(e)}function s(e){if(!(c=u.exec(e)))throw new Error("invalid format: "+e);var t=c[1]||" ",a=c[2]||">",n=c[3]||"-",r=c[4]||"",i=!!c[5],s=c[6]&&+c[6],d=!!c[7],o=c[8]&&+c[8].slice(1),l=c[9]||"",c;// The "n" type is an alias for ",g".
"n"===l?(d=!0,l="g"):!p[l]&&(l=""),(i||"0"===t&&"="===a)&&(i=!0,t="0",a="="),this.fill=t,this.align=a,this.sign=n,this.symbol=r,this.zero=i,this.width=s,this.comma=d,this.precision=o,this.type=l}function d(e){return e}function o(e){function t(e){e=i(e);var t=e.fill,a=e.align,d=e.sign,u=e.symbol,m=e.zero,h=e.width,f=e.comma,y=e.precision,_=e.type,v="$"===u?s[0]:"#"===u&&/[boxX]/.test(_)?"0"+_.toLowerCase():"",x="$"===u?s[1]:/[%p]/.test(_)?"%":"",b=p[_],k=!_||/[defgprs%]/.test(_);// Compute the prefix and suffix.
// For SI-prefix, the suffix is lazily computed.
// What format function should we use?
// Is this an integer type?
// Can this type generate exponential notation?
// Set the default precision if not specified,
// or clamp the specified precision to the supported range.
// For significant precision, it must be in [1, 21].
// For fixed precision, it must be in [0, 20].
return y=null==y?_?6:12:/[gprs]/.test(_)?A(1,w(21,y)):A(0,w(20,y)),function(e){var s=v,p=x;if("c"===_)p=b(e)+p,e="";else{e=+e;// Convert negative to positive, and compute the prefix.
// Note that -0 is not less than 0, but 1 / -0 is!
var u=(0>e||0>1/e)&&(e*=-1,!0);// Perform the initial formatting.
// If the original value was negative, it may be rounded to zero during
// formatting; treat this as (positive) zero.
if(e=b(e,y),u){var S=-1,w=e.length,T;for(u=!1;++S<w;)if(T=e.charCodeAt(S),48<T&&58>T||"x"===_&&96<T&&103>T||"X"===_&&64<T&&71>T){u=!0;break}}// Compute the prefix and suffix.
// Break the formatted value into the integer value part that can be
// grouped, and fractional or exponential suffix part that is not.
if(s=(u?"("===d?d:"-":"-"===d||"("===d?"":d)+s,p=p+("s"===_?g[8+l/3]:"")+(u&&"("===d?")":""),k)for(var S=-1,w=e.length,T;++S<w;)if(T=e.charCodeAt(S),48>T||57<T){p=(46===T?o+e.slice(S+1):e.slice(S))+p,e=e.slice(0,S);break}}// If the fill character is not "0", grouping is applied before padding.
f&&!m&&(e=r(e,1/0));// Compute the padding.
var A=s.length+e.length+p.length,L=A<h?Array(h-A+1).join(t):"";// If the fill character is "0", grouping is applied after padding.
// Reconstruct the final output based on the desired alignment.
return f&&m&&(e=r(L+e,L.length?h-p.length:1/0),L=""),"<"===a?s+e+p+L:"="===a?s+L+e+p:"^"===a?L.slice(0,A=L.length>>1)+s+e+p+L.slice(A):L+s+e+p}}var r=e.grouping&&e.thousands?n(e.grouping,e.thousands):d,s=e.currency,o=e.decimal;return{format:t,formatPrefix:function(n,r){var s=t((n=i(n),n.type="f",n)),d=3*A(-8,w(8,T(a(r)/3))),e=S(10,-d),o=g[8+d/3];return function(t){return s(e*t)+o}}}}var l;var p={"":function(e,t){e=e.toPrecision(t);out:for(var a=e.length,n=1,r=-1,s;n<a;++n)switch(e[n]){case".":r=s=n;break;case"0":0===r&&(r=n),s=n;break;case"e":break out;default:0<r&&(r=0);}return 0<r?e.slice(0,r)+e.slice(s+1):e},"%":function(e,t){return(100*e).toFixed(t)},b:function(e){return v(e).toString(2)},c:function(e){return e+""},d:function(e){return v(e).toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return v(e).toString(8)},p:function(e,t){return r(100*e,t)},r:r,s:function(e,a){var r=t(e,a);if(!r)return e+"";var s=r[0],d=r[1],o=d-(l=3*A(-8,w(8,T(d/3))))+1,i=s.length;return o===i?s:o>i?s+Array(o-i+1).join("0"):0<o?s.slice(0,o)+"."+s.slice(o):"0."+Array(1-o).join("0")+t(e,A(0,a+o-1))[0];// less than 1y!
},X:function(e){return v(e).toString(16).toUpperCase()},x:function(e){return v(e).toString(16)}},u=/^(?:(.)?([<>=^]))?([+\-\( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?([a-z%])?$/i;// [[fill]align][sign][symbol][0][width][,][.precision][type]
s.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(null==this.width?"":A(1,0|this.width))+(this.comma?",":"")+(null==this.precision?"":"."+A(0,0|this.precision))+this.type};var g=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];var m=o({decimal:".",thousands:",",grouping:[3],currency:["$",""]}),h=o({decimal:",",thousands:".",grouping:[3],currency:["","\xA0\u20AC"]}),f=o({decimal:",",thousands:"\xA0",grouping:[3],currency:["","\xA0K\u010D"]}),y=o({decimal:",",thousands:"'",grouping:[3],currency:["","\xA0CHF"]}),_=o({decimal:",",thousands:".",grouping:[3],currency:["","\xA0\u20AC"]}),x=o({decimal:".",thousands:",",grouping:[3],currency:["$",""]}),b=o({decimal:".",thousands:",",grouping:[3],currency:["\xA3",""]}),k=o({decimal:",",thousands:".",grouping:[3],currency:["","\xA0\u20AC"]}),E=o({decimal:",",thousands:"\xA0",grouping:[3],currency:["","\xA0\u20AC"]}),C=o({decimal:",",thousands:"\xA0",grouping:[3],currency:["","$"]}),M=o({decimal:",",thousands:".",grouping:[3],currency:["","\xA0\u20AC"]}),D=o({decimal:".",thousands:",",grouping:[3],currency:["\u20AA",""]}),j=o({decimal:",",thousands:"\xA0",grouping:[3],currency:["","\xA0Ft"]}),P=o({decimal:",",thousands:".",grouping:[3],currency:["\u20AC",""]}),I=o({decimal:".",thousands:",",grouping:[3],currency:["","\u5186"]}),z=o({decimal:".",thousands:",",grouping:[3],currency:["\u20A9",""]}),N=o({decimal:",",thousands:".",grouping:[3],currency:["","\xA0\u0434\u0435\u043D."]}),O=o({decimal:",",thousands:".",grouping:[3],currency:["\u20AC\xA0",""]}),U=o({decimal:",",thousands:".",grouping:[3],currency:["","z\u0142"]}),F=o({decimal:",",thousands:".",grouping:[3],currency:["R$",""]}),R=o({decimal:",",thousands:"\xA0",grouping:[3],currency:["","\xA0\u0440\u0443\u0431."]}),B=o({decimal:",",thousands:"\xA0",grouping:[3],currency:["","SEK"]}),q=o({decimal:".",thousands:",",grouping:[3],currency:["\xA5",""]});var G=m.format,$=m.formatPrefix;e.version="0.4.2",e.format=G,e.formatPrefix=$,e.locale=o,e.localeCaEs=h,e.localeCsCz=f,e.localeDeCh=y,e.localeDeDe=_,e.localeEnCa=x,e.localeEnGb=b,e.localeEnUs=m,e.localeEsEs=k,e.localeFiFi=E,e.localeFrCa=C,e.localeFrFr=M,e.localeHeIl=D,e.localeHuHu=j,e.localeItIt=P,e.localeJaJp=I,e.localeKoKr=z,e.localeMkMk=N,e.localeNlNl=O,e.localePlPl=U,e.localePtBr=F,e.localeRuRu=R,e.localeSvSe=B,e.localeZhCn=q,e.formatSpecifier=i,e.precisionFixed=function(e){return A(0,-a(L(e)))},e.precisionPrefix=function(e,t){return A(0,3*A(-8,w(8,T(a(t)/3)))-a(L(e)))},e.precisionRound=function(e,t){return e=L(e),t=L(t)-e,A(0,a(t)-a(e))+1}})},{}],5:[function(e,t,a){(function(n,r){"object"==typeof a&&"undefined"!=typeof t?r(a,e("d3-time")):"function"==typeof E&&E.amd?E("d3-time-format",["exports","d3-time"],r):r(n.d3_time_format={},n.d3_time)})(this,function(e,t){"use strict";function a(e){if(0<=e.y&&100>e.y){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function n(e){if(0<=e.y&&100>e.y){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function r(e){return{y:e,m:0,d:1,H:0,M:0,S:0,L:0}}function i(e){function t(e,t){return function(a){var r=[],s=-1,d=0,o=e.length,n,l,p;for(a instanceof Date||(a=new Date(+a));++s<o;)37===e.charCodeAt(s)&&(r.push(e.slice(d,s)),null==(l=ee[n=e.charAt(++s)])?l="e"===n?" ":"0":n=e.charAt(++s),(p=t[n])&&(n=p(a,l)),r.push(n),d=s+1);return r.push(e.slice(d,s)),r.join("")}}function i(e,t){return function(a){var o=r(1900),d=s(o,e,a+="",0);if(d!=a.length)return null;// The am-pm flag is 0 for AM, and 1 for PM.
// Convert day-of-week and week-of-year to day-of-year.
if("p"in o&&(o.H=o.H%12+12*o.p),"W"in o||"U"in o){"w"in o||(o.w="W"in o?1:0);var i="Z"in o?n(r(o.y)).getUTCDay():t(r(o.y)).getDay();o.m=0,o.d="W"in o?(o.w+6)%7+7*o.W-(i+5)%7:o.w+7*o.U-(i+6)%7}// If a time zone is specified, all fields are interpreted as UTC and then
// offset according to the specified time zone.
return"Z"in o?(o.H+=0|o.Z/100,o.M+=o.Z%100,n(o)):t(o);// Otherwise, all fields are in local time.
}}function s(e,t,a,r){for(var s=0,d=t.length,n=a.length,o,l;s<d;){if(r>=n)return-1;if(o=t.charCodeAt(s++),37===o){if(o=t.charAt(s++),l=xe[o in ee?t.charAt(s++):o],!l||0>(r=l(e,a,r)))return-1;}else if(o!=a.charCodeAt(r++))return-1}return r}var Q=e.dateTime,te=e.date,ae=e.time,ne=e.periods,re=e.days,ie=e.shortDays,se=e.months,de=e.shortMonths,oe=o(ne),le=l(ne),pe=o(re),ue=l(re),ce=o(ie),ge=l(ie),me=o(se),he=l(se),fe=o(de),ye=l(de),_e={a:function(e){return ie[e.getDay()]},A:function(e){return re[e.getDay()]},b:function(e){return de[e.getMonth()]},B:function(e){return se[e.getMonth()]},c:null,d:w,e:w,H:T,I:A,j:L,L:E,m:C,M:M,p:function(e){return ne[+(12<=e.getHours())]},S:D,U:j,w:P,W:I,x:null,X:null,y:z,Y:N,Z:O,"%":Z},ve={a:function(e){return ie[e.getUTCDay()]},A:function(e){return re[e.getUTCDay()]},b:function(e){return de[e.getUTCMonth()]},B:function(e){return se[e.getUTCMonth()]},c:null,d:U,e:U,H:F,I:R,j:B,L:q,m:G,M:$,p:function(e){return ne[+(12<=e.getUTCHours())]},S:H,U:Y,w:V,W:W,x:null,X:null,y:X,Y:J,Z:K,"%":Z},xe={a:function(e,t,a){var r=ce.exec(t.slice(a));return r?(e.w=ge[r[0].toLowerCase()],a+r[0].length):-1},A:function(e,t,a){var r=pe.exec(t.slice(a));return r?(e.w=ue[r[0].toLowerCase()],a+r[0].length):-1},b:function(e,t,a){var r=fe.exec(t.slice(a));return r?(e.m=ye[r[0].toLowerCase()],a+r[0].length):-1},B:function(e,t,a){var r=me.exec(t.slice(a));return r?(e.m=he[r[0].toLowerCase()],a+r[0].length):-1},c:function(e,t,a){return s(e,Q,t,a)},d:y,e:y,H:v,I:v,j:_,L:k,m:f,M:x,p:function(e,t,a){var r=oe.exec(t.slice(a));return r?(e.p=le[r[0].toLowerCase()],a+r[0].length):-1},S:b,U:u,w:p,W:c,x:function(e,t,a){return s(e,te,t,a)},X:function(e,t,a){return s(e,ae,t,a)},y:m,Y:g,Z:h,"%":S};// These recursive directive definitions must be deferred.
return _e.x=t(te,_e),_e.X=t(ae,_e),_e.c=t(Q,_e),ve.x=t(te,ve),ve.X=t(ae,ve),ve.c=t(Q,ve),{format:function(e){var n=t(e+="",_e);return n.parse=i(e,a),n.toString=function(){return e},n},utcFormat:function(e){var a=t(e+="",ve);return a.parse=i(e,n),a.toString=function(){return e},a}}}function s(e,t,a){var n=0>e?"-":"",r=(n?-e:e)+"",i=r.length;return n+(i<a?Array(a-i+1).join(t)+r:r)}function d(e){return e.replace(ne,"\\$&")}function o(e){return new RegExp("^(?:"+e.map(d).join("|")+")","i")}function l(e){for(var t={},a=-1,r=e.length;++a<r;)t[e[a].toLowerCase()]=a;return t}function p(e,t,a){var r=te.exec(t.slice(a,a+1));return r?(e.w=+r[0],a+r[0].length):-1}function u(e,t,a){var r=te.exec(t.slice(a));return r?(e.U=+r[0],a+r[0].length):-1}function c(e,t,a){var r=te.exec(t.slice(a));return r?(e.W=+r[0],a+r[0].length):-1}function g(e,t,a){var r=te.exec(t.slice(a,a+4));return r?(e.y=+r[0],a+r[0].length):-1}function m(e,t,a){var r=te.exec(t.slice(a,a+2));return r?(e.y=+r[0]+(68<+r[0]?1900:2e3),a+r[0].length):-1}function h(e,t,a){var r=/^(Z)|([+-]\d\d)(?:\:?(\d\d))?/.exec(t.slice(a,a+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),a+r[0].length):-1}function f(e,t,a){var r=te.exec(t.slice(a,a+2));return r?(e.m=r[0]-1,a+r[0].length):-1}function y(e,t,a){var r=te.exec(t.slice(a,a+2));return r?(e.d=+r[0],a+r[0].length):-1}function _(e,t,a){var r=te.exec(t.slice(a,a+3));return r?(e.m=0,e.d=+r[0],a+r[0].length):-1}function v(e,t,a){var r=te.exec(t.slice(a,a+2));return r?(e.H=+r[0],a+r[0].length):-1}function x(e,t,a){var r=te.exec(t.slice(a,a+2));return r?(e.M=+r[0],a+r[0].length):-1}function b(e,t,a){var r=te.exec(t.slice(a,a+2));return r?(e.S=+r[0],a+r[0].length):-1}function k(e,t,a){var r=te.exec(t.slice(a,a+3));return r?(e.L=+r[0],a+r[0].length):-1}function S(e,t,a){var r=ae.exec(t.slice(a,a+1));return r?a+r[0].length:-1}function w(e,t){return s(e.getDate(),t,2)}function T(e,t){return s(e.getHours(),t,2)}function A(e,t){return s(e.getHours()%12||12,t,2)}function L(e,a){return s(1+t.day.count(t.year(e),e),a,3)}function E(e,t){return s(e.getMilliseconds(),t,3)}function C(e,t){return s(e.getMonth()+1,t,2)}function M(e,t){return s(e.getMinutes(),t,2)}function D(e,t){return s(e.getSeconds(),t,2)}function j(e,a){return s(t.sunday.count(t.year(e),e),a,2)}function P(e){return e.getDay()}function I(e,a){return s(t.monday.count(t.year(e),e),a,2)}function z(e,t){return s(e.getFullYear()%100,t,2)}function N(e,t){return s(e.getFullYear()%1e4,t,4)}function O(e){var t=e.getTimezoneOffset();return(0<t?"-":(t*=-1,"+"))+s(0|t/60,"0",2)+s(t%60,"0",2)}function U(e,t){return s(e.getUTCDate(),t,2)}function F(e,t){return s(e.getUTCHours(),t,2)}function R(e,t){return s(e.getUTCHours()%12||12,t,2)}function B(e,a){return s(1+t.utcDay.count(t.utcYear(e),e),a,3)}function q(e,t){return s(e.getUTCMilliseconds(),t,3)}function G(e,t){return s(e.getUTCMonth()+1,t,2)}function $(e,t){return s(e.getUTCMinutes(),t,2)}function H(e,t){return s(e.getUTCSeconds(),t,2)}function Y(e,a){return s(t.utcSunday.count(t.utcYear(e),e),a,2)}function V(e){return e.getUTCDay()}function W(e,a){return s(t.utcMonday.count(t.utcYear(e),e),a,2)}function X(e,t){return s(e.getUTCFullYear()%100,t,2)}function J(e,t){return s(e.getUTCFullYear()%1e4,t,4)}function K(){return"+0000"}function Z(){return"%"}function Q(e){return e.toISOString()}var ee={"-":"",_:" ",0:"0"},te=/^\s*\d+/,ae=/^%/,ne=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,re=i({dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),ie=i({dateTime:"%A, %e de %B de %Y, %X",date:"%d/%m/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["diumenge","dilluns","dimarts","dimecres","dijous","divendres","dissabte"],shortDays:["dg.","dl.","dt.","dc.","dj.","dv.","ds."],months:["gener","febrer","mar\xE7","abril","maig","juny","juliol","agost","setembre","octubre","novembre","desembre"],shortMonths:["gen.","febr.","mar\xE7","abr.","maig","juny","jul.","ag.","set.","oct.","nov.","des."]}),se=i({dateTime:"%A, der %e. %B %Y, %X",date:"%d.%m.%Y",time:"%H:%M:%S",periods:["AM","PM"],// unused
days:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],shortDays:["So","Mo","Di","Mi","Do","Fr","Sa"],months:["Januar","Februar","M\xE4rz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],shortMonths:["Jan","Feb","Mrz","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"]}),de=i({dateTime:"%A, der %e. %B %Y, %X",date:"%d.%m.%Y",time:"%H:%M:%S",periods:["AM","PM"],// unused
days:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],shortDays:["So","Mo","Di","Mi","Do","Fr","Sa"],months:["Januar","Februar","M\xE4rz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],shortMonths:["Jan","Feb","Mrz","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"]}),oe=i({dateTime:"%a %b %e %X %Y",date:"%Y-%m-%d",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),le=i({dateTime:"%a %e %b %X %Y",date:"%d/%m/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),pe=i({dateTime:"%A, %e de %B de %Y, %X",date:"%d/%m/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["domingo","lunes","martes","mi\xE9rcoles","jueves","viernes","s\xE1bado"],shortDays:["dom","lun","mar","mi\xE9","jue","vie","s\xE1b"],months:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],shortMonths:["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"]}),ue=i({dateTime:"%A, %-d. %Bta %Y klo %X",date:"%-d.%-m.%Y",time:"%H:%M:%S",periods:["a.m.","p.m."],days:["sunnuntai","maanantai","tiistai","keskiviikko","torstai","perjantai","lauantai"],shortDays:["Su","Ma","Ti","Ke","To","Pe","La"],months:["tammikuu","helmikuu","maaliskuu","huhtikuu","toukokuu","kes\xE4kuu","hein\xE4kuu","elokuu","syyskuu","lokakuu","marraskuu","joulukuu"],shortMonths:["Tammi","Helmi","Maalis","Huhti","Touko","Kes\xE4","Hein\xE4","Elo","Syys","Loka","Marras","Joulu"]}),ce=i({dateTime:"%a %e %b %Y %X",date:"%Y-%m-%d",time:"%H:%M:%S",periods:["",""],days:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],shortDays:["dim","lun","mar","mer","jeu","ven","sam"],months:["janvier","f\xE9vrier","mars","avril","mai","juin","juillet","ao\xFBt","septembre","octobre","novembre","d\xE9cembre"],shortMonths:["jan","f\xE9v","mar","avr","mai","jui","jul","ao\xFB","sep","oct","nov","d\xE9c"]}),ge=i({dateTime:"%A, le %e %B %Y, %X",date:"%d/%m/%Y",time:"%H:%M:%S",periods:["AM","PM"],// unused
days:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],shortDays:["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],months:["janvier","f\xE9vrier","mars","avril","mai","juin","juillet","ao\xFBt","septembre","octobre","novembre","d\xE9cembre"],shortMonths:["janv.","f\xE9vr.","mars","avr.","mai","juin","juil.","ao\xFBt","sept.","oct.","nov.","d\xE9c."]}),me=i({dateTime:"%A, %e \u05D1%B %Y %X",date:"%d.%m.%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["\u05E8\u05D0\u05E9\u05D5\u05DF","\u05E9\u05E0\u05D9","\u05E9\u05DC\u05D9\u05E9\u05D9","\u05E8\u05D1\u05D9\u05E2\u05D9","\u05D7\u05DE\u05D9\u05E9\u05D9","\u05E9\u05D9\u05E9\u05D9","\u05E9\u05D1\u05EA"],shortDays:["\u05D0\u05F3","\u05D1\u05F3","\u05D2\u05F3","\u05D3\u05F3","\u05D4\u05F3","\u05D5\u05F3","\u05E9\u05F3"],months:["\u05D9\u05E0\u05D5\u05D0\u05E8","\u05E4\u05D1\u05E8\u05D5\u05D0\u05E8","\u05DE\u05E8\u05E5","\u05D0\u05E4\u05E8\u05D9\u05DC","\u05DE\u05D0\u05D9","\u05D9\u05D5\u05E0\u05D9","\u05D9\u05D5\u05DC\u05D9","\u05D0\u05D5\u05D2\u05D5\u05E1\u05D8","\u05E1\u05E4\u05D8\u05DE\u05D1\u05E8","\u05D0\u05D5\u05E7\u05D8\u05D5\u05D1\u05E8","\u05E0\u05D5\u05D1\u05DE\u05D1\u05E8","\u05D3\u05E6\u05DE\u05D1\u05E8"],shortMonths:["\u05D9\u05E0\u05D5\u05F3","\u05E4\u05D1\u05E8\u05F3","\u05DE\u05E8\u05E5","\u05D0\u05E4\u05E8\u05F3","\u05DE\u05D0\u05D9","\u05D9\u05D5\u05E0\u05D9","\u05D9\u05D5\u05DC\u05D9","\u05D0\u05D5\u05D2\u05F3","\u05E1\u05E4\u05D8\u05F3","\u05D0\u05D5\u05E7\u05F3","\u05E0\u05D5\u05D1\u05F3","\u05D3\u05E6\u05DE\u05F3"]}),he=i({dateTime:"%Y. %B %-e., %A %X",date:"%Y. %m. %d.",time:"%H:%M:%S",periods:["de.","du."],// unused
days:["vas\xE1rnap","h\xE9tf\u0151","kedd","szerda","cs\xFCt\xF6rt\xF6k","p\xE9ntek","szombat"],shortDays:["V","H","K","Sze","Cs","P","Szo"],months:["janu\xE1r","febru\xE1r","m\xE1rcius","\xE1prilis","m\xE1jus","j\xFAnius","j\xFAlius","augusztus","szeptember","okt\xF3ber","november","december"],shortMonths:["jan.","feb.","m\xE1r.","\xE1pr.","m\xE1j.","j\xFAn.","j\xFAl.","aug.","szept.","okt.","nov.","dec."]}),fe=i({dateTime:"%A %e %B %Y, %X",date:"%d/%m/%Y",time:"%H:%M:%S",periods:["AM","PM"],// unused
days:["Domenica","Luned\xEC","Marted\xEC","Mercoled\xEC","Gioved\xEC","Venerd\xEC","Sabato"],shortDays:["Dom","Lun","Mar","Mer","Gio","Ven","Sab"],months:["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"],shortMonths:["Gen","Feb","Mar","Apr","Mag","Giu","Lug","Ago","Set","Ott","Nov","Dic"]}),ye=i({dateTime:"%Y %b %e %a %X",date:"%Y/%m/%d",time:"%H:%M:%S",periods:["AM","PM"],days:["\u65E5\u66DC\u65E5","\u6708\u66DC\u65E5","\u706B\u66DC\u65E5","\u6C34\u66DC\u65E5","\u6728\u66DC\u65E5","\u91D1\u66DC\u65E5","\u571F\u66DC\u65E5"],shortDays:["\u65E5","\u6708","\u706B","\u6C34","\u6728","\u91D1","\u571F"],months:["\u7766\u6708","\u5982\u6708","\u5F25\u751F","\u536F\u6708","\u7690\u6708","\u6C34\u7121\u6708","\u6587\u6708","\u8449\u6708","\u9577\u6708","\u795E\u7121\u6708","\u971C\u6708","\u5E2B\u8D70"],shortMonths:["1\u6708","2\u6708","3\u6708","4\u6708","5\u6708","6\u6708","7\u6708","8\u6708","9\u6708","10\u6708","11\u6708","12\u6708"]}),_e=i({dateTime:"%Y/%m/%d %a %X",date:"%Y/%m/%d",time:"%H:%M:%S",periods:["\uC624\uC804","\uC624\uD6C4"],days:["\uC77C\uC694\uC77C","\uC6D4\uC694\uC77C","\uD654\uC694\uC77C","\uC218\uC694\uC77C","\uBAA9\uC694\uC77C","\uAE08\uC694\uC77C","\uD1A0\uC694\uC77C"],shortDays:["\uC77C","\uC6D4","\uD654","\uC218","\uBAA9","\uAE08","\uD1A0"],months:["1\uC6D4","2\uC6D4","3\uC6D4","4\uC6D4","5\uC6D4","6\uC6D4","7\uC6D4","8\uC6D4","9\uC6D4","10\uC6D4","11\uC6D4","12\uC6D4"],shortMonths:["1\uC6D4","2\uC6D4","3\uC6D4","4\uFFFD\uFFFD\uFFFD","5\uC6D4","6\uC6D4","7\uC6D4","8\uC6D4","9\uC6D4","10\uC6D4","11\uC6D4","12\uC6D4"]}),ve=i({dateTime:"%A, %e %B %Y \u0433. %X",date:"%d.%m.%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["\u043D\u0435\u0434\u0435\u043B\u0430","\u043F\u043E\u043D\u0435\u0434\u0435\u043B\u043D\u0438\u043A","\u0432\u0442\u043E\u0440\u043D\u0438\u043A","\u0441\u0440\u0435\u0434\u0430","\u0447\u0435\u0442\u0432\u0440\u0442\u043E\u043A","\u043F\u0435\u0442\u043E\u043A","\u0441\u0430\u0431\u043E\u0442\u0430"],shortDays:["\u043D\u0435\u0434","\u043F\u043E\u043D","\u0432\u0442\u043E","\u0441\u0440\u0435","\u0447\u0435\u0442","\u043F\u0435\u0442","\u0441\u0430\u0431"],months:["\u0458\u0430\u043D\u0443\u0430\u0440\u0438","\u0444\u0435\u0432\u0440\u0443\u0430\u0440\u0438","\u043C\u0430\u0440\u0442","\u0430\u043F\u0440\u0438\u043B","\u043C\u0430\u0458","\u0458\u0443\u043D\u0438","\u0458\u0443\u043B\u0438","\u0430\u0432\u0433\u0443\u0441\u0442","\u0441\u0435\u043F\u0442\u0435\u043C\u0432\u0440\u0438","\u043E\u043A\u0442\u043E\u043C\u0432\u0440\u0438","\u043D\u043E\u0435\u043C\u0432\u0440\u0438","\u0434\u0435\u043A\u0435\u043C\u0432\u0440\u0438"],shortMonths:["\u0458\u0430\u043D","\u0444\u0435\u0432","\u043C\u0430\u0440","\u0430\u043F\u0440","\u043C\u0430\u0458","\u0458\u0443\u043D","\u0458\u0443\u043B","\u0430\u0432\u0433","\u0441\u0435\u043F","\u043E\u043A\u0442","\u043D\u043E\u0435","\u0434\u0435\u043A"]}),xe=i({dateTime:"%a %e %B %Y %T",date:"%d-%m-%Y",time:"%H:%M:%S",periods:["AM","PM"],// unused
days:["zondag","maandag","dinsdag","woensdag","donderdag","vrijdag","zaterdag"],shortDays:["zo","ma","di","wo","do","vr","za"],months:["januari","februari","maart","april","mei","juni","juli","augustus","september","oktober","november","december"],shortMonths:["jan","feb","mrt","apr","mei","jun","jul","aug","sep","okt","nov","dec"]}),be=i({dateTime:"%A, %e %B %Y, %X",date:"%d/%m/%Y",time:"%H:%M:%S",periods:["AM","PM"],// unused
days:["Niedziela","Poniedzia\u0142ek","Wtorek","\u015Aroda","Czwartek","Pi\uFFFD\uFFFDtek","Sobota"],shortDays:["Niedz.","Pon.","Wt.","\u015Ar.","Czw.","Pt.","Sob."],months:["Stycze\u0144","Luty","Marzec","Kwiecie\u0144","Maj","Czerwiec","Lipiec","Sierpie\u0144","Wrzesie\u0144","Pa\u017Adziernik","Listopad","Grudzie\u0144"],shortMonths:["Stycz.","Luty","Marz.","Kwie.","Maj","Czerw.","Lipc.","Sierp.","Wrz.","Pa\u017Adz.","Listop.","Grudz."]/* In Polish language abbraviated months are not commonly used so there is a dispute about the proper abbraviations. */}),ke=i({dateTime:"%A, %e de %B de %Y. %X",date:"%d/%m/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Domingo","Segunda","Ter\xE7a","Quarta","Quinta","Sexta","S\xE1bado"],shortDays:["Dom","Seg","Ter","Qua","Qui","Sex","S\xE1b"],months:["Janeiro","Fevereiro","Mar\xE7o","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],shortMonths:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"]}),Se=i({dateTime:"%A, %e %B %Y \u0433. %X",date:"%d.%m.%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["\u0432\u043E\u0441\u043A\u0440\u0435\u0441\u0435\u043D\u044C\u0435","\u043F\u043E\u043D\u0435\u0434\u0435\u043B\u044C\u043D\u0438\u043A","\u0432\u0442\u043E\u0440\u043D\u0438\u043A","\u0441\u0440\u0435\u0434\u0430","\u0447\u0435\u0442\u0432\u0435\u0440\u0433","\u043F\u044F\u0442\u043D\u0438\u0446\u0430","\u0441\u0443\u0431\u0431\u043E\u0442\u0430"],shortDays:["\u0432\u0441","\u043F\u043D","\u0432\u0442","\u0441\u0440","\u0447\u0442","\u043F\u0442","\u0441\u0431"],months:["\u044F\u043D\u0432\u0430\u0440\u044F","\u0444\u0435\u0432\u0440\u0430\u043B\u044F","\u043C\u0430\u0440\u0442\u0430","\u0430\u043F\u0440\u0435\u043B\u044F","\u043C\u0430\u044F","\u0438\u044E\u043D\u044F","\u0438\u044E\u043B\u044F","\u0430\u0432\u0433\u0443\u0441\u0442\u0430","\u0441\u0435\u043D\u0442\u044F\u0431\u0440\u044F","\u043E\u043A\u0442\u044F\u0431\u0440\u044F","\u043D\u043E\u044F\u0431\u0440\u044F","\u0434\u0435\u043A\u0430\u0431\u0440\u044F"],shortMonths:["\u044F\u043D\u0432","\u0444\u0435\u0432","\u043C\u0430\u0440","\u0430\u043F\u0440","\u043C\u0430\u0439","\u0438\u044E\u043D","\u0438\u044E\u043B","\u0430\u0432\u0433","\u0441\u0435\u043D","\u043E\u043A\u0442","\u043D\u043E\u044F","\u0434\u0435\u043A"]}),we=i({dateTime:"%A den %d %B %Y %X",date:"%Y-%m-%d",time:"%H:%M:%S",periods:["fm","em"],days:["S\xF6ndag","M\xE5ndag","Tisdag","Onsdag","Torsdag","Fredag","L\xF6rdag"],shortDays:["S\xF6n","M\xE5n","Tis","Ons","Tor","Fre","L\xF6r"],months:["Januari","Februari","Mars","April","Maj","Juni","Juli","Augusti","September","Oktober","November","December"],shortMonths:["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Aug","Sep","Okt","Nov","Dec"]}),Te=i({dateTime:"%a %b %e %X %Y",date:"%Y/%-m/%-d",time:"%H:%M:%S",periods:["\u4E0A\u5348","\u4E0B\u5348"],days:["\u661F\u671F\u65E5","\u661F\u671F\u4E00","\u661F\u671F\u4E8C","\u661F\u671F\u4E09","\u661F\u671F\u56DB","\u661F\u671F\u4E94","\u661F\u671F\u516D"],shortDays:["\u661F\u671F\u65E5","\u661F\u671F\u4E00","\u661F\u671F\u4E8C","\u661F\u671F\u4E09","\u661F\u671F\u56DB","\u661F\u671F\u4E94","\u661F\u671F\u516D"],months:["\u4E00\u6708","\u4E8C\u6708","\u4E09\u6708","\u56DB\u6708","\u4E94\u6708","\u516D\u6708","\u4E03\u6708","\u516B\u6708","\u4E5D\u6708","\u5341\u6708","\u5341\u4E00\u6708","\u5341\u4E8C\u6708"],shortMonths:["\u4E00\u6708","\u4E8C\u6708","\u4E09\u6708","\u56DB\u6708","\u4E94\u6708","\u516D\u6708","\u4E03\u6708","\u516B\u6708","\u4E5D\u6708","\u5341\u6708","\u5341\u4E00\u6708","\u5341\u4E8C\u6708"]});Q.parse=function(e){var t=new Date(e);return isNaN(t)?null:t},Q.toString=function(){return"%Y-%m-%dT%H:%M:%S.%LZ"};var Ae=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?Q:re.utcFormat("%Y-%m-%dT%H:%M:%S.%LZ"),Le=re.format,Ee=re.utcFormat;e.version="0.2.1",e.format=Le,e.utcFormat=Ee,e.locale=i,e.localeCaEs=ie,e.localeDeCh=se,e.localeDeDe=de,e.localeEnCa=oe,e.localeEnGb=le,e.localeEnUs=re,e.localeEsEs=pe,e.localeFiFi=ue,e.localeFrCa=ce,e.localeFrFr=ge,e.localeHeIl=me,e.localeHuHu=he,e.localeItIt=fe,e.localeJaJp=ye,e.localeKoKr=_e,e.localeMkMk=ve,e.localeNlNl=xe,e.localePlPl=be,e.localePtBr=ke,e.localeRuRu=Se,e.localeSvSe=we,e.localeZhCn=Te,e.isoFormat=Ae})},{"d3-time":6}],6:[function(e,t,a){(function(e,n){"object"==typeof a&&"undefined"!=typeof t?n(a):"function"==typeof E&&E.amd?E("d3-time",["exports"],n):n(e.d3_time={})})(this,function(e){"use strict";function t(e,a,n,s){function o(t){return e(t=new Date(+t)),t}return o.floor=o,o.round=function(t){var n=new Date(+t),r=new Date(t-1);return e(n),e(r),a(r,1),t-n<r-t?n:r},o.ceil=function(t){return e(t=new Date(t-1)),a(t,1),t},o.offset=function(e,t){return a(e=new Date(+e),null==t?1:T(t)),e},o.range=function(t,n,r){var i=[];if(t=new Date(t-1),n=new Date(+n),r=null==r?1:T(r),!(t<n)||!(0<r))return i;// also handles Invalid Date
for(a(t,1),e(t),t<n&&i.push(new Date(+t));a(t,r),e(t),t<n;)i.push(new Date(+t));return i},o.filter=function(n){return t(function(t){for(;e(t),!n(t);)t.setTime(t-1)},function(e,t){for(;0<=--t;)for(;a(e,1),!n(e););})},n&&(o.count=function(t,a){return r.setTime(+t),i.setTime(+a),e(r),e(i),T(n(r,i))},o.every=function(e){return e=T(e),isFinite(e)&&0<e?1<e?o.filter(s?function(t){return 0==s(t)%e}:function(t){return 0==o.count(0,t)%e}):o:null}),o}function a(e){return t(function(t){t.setHours(0,0,0,0),t.setDate(t.getDate()-(t.getDay()+7-e)%7)},function(e,t){e.setDate(e.getDate()+7*t)},function(e,t){return(t-e-6e4*(t.getTimezoneOffset()-e.getTimezoneOffset()))/6048e5})}function n(e){return t(function(t){t.setUTCHours(0,0,0,0),t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7)},function(e,t){e.setUTCDate(e.getUTCDate()+7*t)},function(e,t){return(t-e)/6048e5})}var r=new Date,i=new Date;var s=t(function(){// noop
},function(e,t){e.setTime(+e+t)},function(e,t){return t-e});// An optimized implementation for this simple case.
s.every=function(e){return e=T(e),isFinite(e)&&0<e?1<e?t(function(t){t.setTime(T(t/e)*e)},function(t,a){t.setTime(+t+a*e)},function(t,a){return(a-t)/e}):s:null};var d=t(function(e){e.setMilliseconds(0)},function(e,t){e.setTime(+e+1e3*t)},function(e,t){return(t-e)/1e3},function(e){return e.getSeconds()}),o=t(function(e){e.setSeconds(0,0)},function(e,t){e.setTime(+e+6e4*t)},function(e,t){return(t-e)/6e4},function(e){return e.getMinutes()}),l=t(function(e){e.setMinutes(0,0,0)},function(e,t){e.setTime(+e+36e5*t)},function(e,t){return(t-e)/36e5},function(e){return e.getHours()}),p=t(function(e){e.setHours(0,0,0,0)},function(e,t){e.setDate(e.getDate()+t)},function(e,t){return(t-e-6e4*(t.getTimezoneOffset()-e.getTimezoneOffset()))/864e5},function(e){return e.getDate()-1}),u=a(0),c=a(1),g=a(2),m=a(3),h=a(4),f=a(5),y=a(6),_=t(function(e){e.setHours(0,0,0,0),e.setDate(1)},function(e,t){e.setMonth(e.getMonth()+t)},function(e,t){return t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())},function(e){return e.getMonth()}),v=t(function(e){e.setHours(0,0,0,0),e.setMonth(0,1)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()}),x=t(function(e){e.setUTCMilliseconds(0)},function(e,t){e.setTime(+e+1e3*t)},function(e,t){return(t-e)/1e3},function(e){return e.getUTCSeconds()}),b=t(function(e){e.setUTCSeconds(0,0)},function(e,t){e.setTime(+e+6e4*t)},function(e,t){return(t-e)/6e4},function(e){return e.getUTCMinutes()}),k=t(function(e){e.setUTCMinutes(0,0,0)},function(e,t){e.setTime(+e+36e5*t)},function(e,t){return(t-e)/36e5},function(e){return e.getUTCHours()}),S=t(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/864e5},function(e){return e.getUTCDate()-1}),w=n(0),A=n(1),L=n(2),E=n(3),C=n(4),M=n(5),D=n(6),j=t(function(e){e.setUTCHours(0,0,0,0),e.setUTCDate(1)},function(e,t){e.setUTCMonth(e.getUTCMonth()+t)},function(e,t){return t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())},function(e){return e.getUTCMonth()}),P=t(function(e){e.setUTCHours(0,0,0,0),e.setUTCMonth(0,1)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()}),I=s.range,z=d.range,N=o.range,O=l.range,U=p.range,F=u.range,R=c.range,B=g.range,q=m.range,G=h.range,$=f.range,H=y.range,Y=u.range,V=_.range,W=v.range,X=x.range,J=b.range,K=k.range,Z=S.range,Q=w.range,ee=A.range,te=L.range,ae=E.range,ne=C.range,re=M.range,ie=D.range,se=w.range,de=j.range,oe=P.range;e.version="0.1.1",e.milliseconds=I,e.seconds=z,e.minutes=N,e.hours=O,e.days=U,e.sundays=F,e.mondays=R,e.tuesdays=B,e.wednesdays=q,e.thursdays=G,e.fridays=$,e.saturdays=H,e.weeks=Y,e.months=V,e.years=W,e.utcMillisecond=s,e.utcMilliseconds=I,e.utcSeconds=X,e.utcMinutes=J,e.utcHours=K,e.utcDays=Z,e.utcSundays=Q,e.utcMondays=ee,e.utcTuesdays=te,e.utcWednesdays=ae,e.utcThursdays=ne,e.utcFridays=re,e.utcSaturdays=ie,e.utcWeeks=se,e.utcMonths=de,e.utcYears=oe,e.millisecond=s,e.second=d,e.minute=o,e.hour=l,e.day=p,e.sunday=u,e.monday=c,e.tuesday=g,e.wednesday=m,e.thursday=h,e.friday=f,e.saturday=y,e.week=u,e.month=_,e.year=v,e.utcSecond=x,e.utcMinute=b,e.utcHour=k,e.utcDay=S,e.utcSunday=w,e.utcMonday=A,e.utcTuesday=L,e.utcWednesday=E,e.utcThursday=C,e.utcFriday=M,e.utcSaturday=D,e.utcWeek=w,e.utcMonth=j,e.utcYear=P,e.interval=t})},{}],7:[function(e,t){t.exports={_args:[[{raw:"datalib@^1.7.1",scope:null,escapedName:"datalib",name:"datalib",rawSpec:"^1.7.1",spec:">=1.7.1 <2.0.0",type:"range"},"/Users/arvind/Research/vega2/vega3-2"]],_from:"datalib@>=1.7.1 <2.0.0",_id:"datalib@1.7.3",_inCache:!0,_installable:!0,_location:"/datalib",_nodeVersion:"0.12.7",_npmOperationalInternal:{host:"packages-16-east.internal.npmjs.com",tmp:"tmp/datalib-1.7.3.tgz_1476399375564_0.8775846140924841"},_npmUser:{name:"jheer",email:"jeffrey.heer@gmail.com"},_npmVersion:"2.12.1",_phantomChildren:{},_requested:{raw:"datalib@^1.7.1",scope:null,escapedName:"datalib",name:"datalib",rawSpec:"^1.7.1",spec:">=1.7.1 <2.0.0",type:"range"},_requiredBy:["/","/vega-dataflow","/vega-scenegraph"],_resolved:"https://registry.npmjs.org/datalib/-/datalib-1.7.3.tgz",_shasum:"4722715bb91f5a2411cf42bf984932cc403eba48",_shrinkwrap:null,_spec:"datalib@^1.7.1",_where:"/Users/arvind/Research/vega2/vega3-2",author:{name:"Jeffrey Heer",url:"http://idl.cs.washington.edu"},browser:{buffer:!1,fs:!1,http:!1,request:!1,"sync-request":!1,url:!1},bugs:{url:"https://github.com/vega/datalib/issues"},contributors:[{name:"Michael Correll",url:"http://pages.cs.wisc.edu/~mcorrell/"},{name:"Ryan Russell",url:"https://github.com/RussellSprouts"}],dependencies:{"d3-dsv":"0.1","d3-format":"0.4","d3-time":"0.1","d3-time-format":"0.2",request:"^2.67.0","sync-request":"^2.1.0",topojson:"^1.6.19"},description:"JavaScript utilites for loading, summarizing and working with data.",devDependencies:{browserify:"^12.0.1",chai:"^3.4.1",istanbul:"latest",jshint:"^2.9.1-rc1",mocha:"^2.3.4","uglify-js":"^2.6.1"},directories:{},dist:{shasum:"4722715bb91f5a2411cf42bf984932cc403eba48",tarball:"https://registry.npmjs.org/datalib/-/datalib-1.7.3.tgz"},gitHead:"0087f0a1e9e9f819bffb309fa10b4ac3c9292486",homepage:"https://github.com/vega/datalib#readme",keywords:["data","table","statistics","parse","csv","tsv","json","utility"],license:"BSD-3-Clause",main:"src/index.js",maintainers:[{name:"jheer",email:"jeffrey.heer@gmail.com"}],name:"datalib",optionalDependencies:{},readme:"ERROR: No README data found!",repository:{type:"git",url:"git+ssh://git@github.com/vega/datalib.git"},scripts:{build:"browserify src/index.js -d -s dl -o datalib.js",cover:"TZ=America/Los_Angeles istanbul cover _mocha -- --recursive test/",deploy:"npm run test && scripts/deploy.sh",lint:"jshint src/",postbuild:"uglifyjs datalib.js -c -m -o datalib.min.js",test:"npm run lint && TZ=America/Los_Angeles mocha --recursive test/"},version:"1.7.3"}},{}],8:[function(e,t){var a=e("./util"),n=e("./time"),r=n.utc,i=t.exports;i.$year=a.$func("year",n.year.unit),i.$month=a.$func("month",n.months.unit),i.$date=a.$func("date",n.dates.unit),i.$day=a.$func("day",n.weekdays.unit),i.$hour=a.$func("hour",n.hours.unit),i.$minute=a.$func("minute",n.minutes.unit),i.$second=a.$func("second",n.seconds.unit),i.$utcYear=a.$func("utcYear",r.year.unit),i.$utcMonth=a.$func("utcMonth",r.months.unit),i.$utcDate=a.$func("utcDate",r.dates.unit),i.$utcDay=a.$func("utcDay",r.weekdays.unit),i.$utcHour=a.$func("utcHour",r.hours.unit),i.$utcMinute=a.$func("utcMinute",r.minutes.unit),i.$utcSecond=a.$func("utcSecond",r.seconds.unit)},{"./time":30,"./util":31}],9:[function(e,t){function a(){this._cells={},this._aggr=[],this._stream=!1}function n(e){if(r.isArray(e))return e;if(null==e)return[];var t=[],a,n;for(a in e)n=r.array(e[a]),t.push({name:a,ops:n});return t}// Cell Management
var r=e("../util"),s=e("./measures"),d=e("./collector"),o=a.Flags={ADD_CELL:1,MOD_CELL:2},l=a.prototype;// Parameters
// key accessor to use for streaming removes
// Input: array of objects of the form
// {name: string, get: function}
// Input: array of objects of the form
// {name: string, ops: [string, ...]}
// Convenience method to summarize by count
// Override to perform custom tuple value assignment
// Override to perform custom tuple ingestion
// Process Tuples
// consolidate removals
l.stream=function(e){return null==e?this._stream:(this._stream=!!e,this._aggr=[],this)},l.key=function(e){return null==e?this._key:(this._key=r.$(e),this)},l.groupby=function(e){return this._dims=r.array(e).map(function(e,t){if(e=r.isString(e)?{name:e,get:r.$(e)}:r.isFunction(e)?{name:r.name(e)||e.name||"_"+t,get:e}:e.name&&r.isFunction(e.get)?e:null,null==e)throw"Invalid groupby argument: "+e;return e}),this.clear()},l.summarize=function(e){e=n(e),this._count=!0;var t=this._aggr=[],a,d,o,l,p,u,c;for(o=0;o<e.length;++o){for(l=0,a=[],d=e[o];l<d.ops.length;++l)p=d.ops[l],"count"!==p&&(this._count=!1),u=d.as&&d.as[l]||p+("*"===d.name?"":"_"+d.name),a.push(s[p](u));c=d.get&&r.$(d.get)||("*"===d.name?r.identity:r.$(d.name)),t.push({name:d.name,measures:s.create(a,this._stream,// streaming remove flag
c,// input tuple getter
this._assign)// output tuple setter
})}return this.clear()},l.count=function(){return this.summarize({"*":"count"})},l._assign=function(e,t,a){e[t]=a},l.clear=function(){return this._cells={},this},l._cellkey=function(e){var t=this._dims,a=t.length,n=t[0].get(e)+"",r;for(r=1;r<a;++r)n+="|"+t[r].get(e);return n},l._cell=function(e){var t=this._dims.length?this._cellkey(e):"";return this._cells[t]||(this._cells[t]=this._newcell(e,t))},l._newcell=function(e,t){var a={num:0,tuple:this._newtuple(e,t),flag:o.ADD_CELL,aggs:{}},n=this._aggr,r;for(r=0;r<n.length;++r)a.aggs[n[r].name]=new n[r].measures(a,a.tuple);return a.collect&&(a.data=new d(this._key)),a},l._newtuple=function(e){var a=this._dims,r={},t,s;for(t=0,s=a.length;t<s;++t)r[a[t].name]=a[t].get(e);return this._ingest(r)},l._ingest=r.identity,l._add=function(e){var t=this._cell(e),a=this._aggr,n;if(t.num+=1,!this._count)for(t.collect&&t.data.add(e),n=0;n<a.length;++n)t.aggs[a[n].name].add(e);t.flag|=o.MOD_CELL,this._on_add&&this._on_add(e,t)},l._rem=function(e){var t=this._cell(e),a=this._aggr,n;if(t.num-=1,!this._count)for(t.collect&&t.data.rem(e),n=0;n<a.length;++n)t.aggs[a[n].name].rem(e);t.flag|=o.MOD_CELL,this._on_rem&&this._on_rem(e,t)},l._mod=function(e,t){var a=this._cell(t),n=this._cell(e),s=this._aggr,d;for(a===n?a.collect&&!r.isObject(e)&&(a.data.rem(t),a.data.add(e)):(a.num-=1,n.num+=1,a.collect&&a.data.rem(t),n.collect&&n.data.add(e)),d=0;d<s.length;++d)a.aggs[s[d].name].rem(t),n.aggs[s[d].name].add(e);a.flag|=o.MOD_CELL,n.flag|=o.MOD_CELL,this._on_mod&&this._on_mod(e,t,a,n)},l._markMod=function(e){var t=this._cell(e);t.flag|=o.MOD_CELL},l.result=function(){var e=[],t=this._aggr,a,n,r;for(r in this._cells){if(a=this._cells[r],0<a.num){// update tuple properties
for(a.collect&&a.data.values(),n=0;n<t.length;++n)a.aggs[t[n].name].set();// add output tuple
e.push(a.tuple)}else delete this._cells[r];a.flag=0}return this._rems=!1,e},l.changes=function(e){var t=e||{add:[],rem:[],mod:[]},a=this._aggr,n,r,s,d;for(d in this._cells){// update tuple properties
for(n=this._cells[d],r=n.flag,n.collect&&n.data.values(),s=0;s<a.length;++s)n.aggs[a[s].name].set();// organize output tuples
0>=n.num?(t.rem.push(n.tuple),delete this._cells[d],this._on_drop&&this._on_drop(n)):(this._on_keep&&this._on_keep(n),r&o.ADD_CELL?t.add.push(n.tuple):r&o.MOD_CELL&&t.mod.push(n.tuple)),n.flag=0}return this._rems=!1,t},l.execute=function(e){return this.clear().insert(e).result()},l.insert=function(e){this._consolidate();for(var t=0;t<e.length;++t)this._add(e[t]);return this},l.remove=function(e){if(!this._stream)throw"Aggregator not configured for streaming removes. Call stream(true) prior to calling summarize.";for(var t=0;t<e.length;++t)this._rem(e[t]);return this._rems=!0,this},l._consolidate=function(){if(this._rems){for(var e in this._cells)this._cells[e].collect&&this._cells[e].data.values();this._rems=!1}},t.exports=a},{"../util":31,"./collector":10,"./measures":12}],10:[function(e,t){function a(e){this._add=[],this._rem=[],this._key=e||null,this._last=null}var s=e("../util"),d=e("../stats"),o=a.prototype;// memoizing statistics methods
o.add=function(e){this._add.push(e)},o.rem=function(e){this._rem.push(e)},o.values=function(){if(this._get=null,0===this._rem.length)return this._add;var e=this._add,t=this._rem,a=this._key,r=Array(e.length-t.length),o,l,p,u;if(!s.isObject(t[0]))for(u=d.count.map(t),o=0,l=0,p=e.length;o<p;++o)0<u[e[o]]?u[e[o]]-=1:r[l++]=e[o];else if(a)for(u=s.toMap(t,a),o=0,l=0,p=e.length;o<p;++o)u.hasOwnProperty(a(e[o]))||(r[l++]=e[o]);else{// no unique key, mark tuples directly
for(o=0,p=t.length;o<p;++o)t[o].__dl_rem__=1;for(o=0,l=0,p=e.length;o<p;++o)e[o].__dl_rem__||(r[l++]=e[o]);for(o=0,p=t.length;o<p;++o)delete t[o].__dl_rem__}return this._rem=[],this._add=r},o.extent=function(e){if(this._get!==e||!this._ext){var t=this.values(),a=d.extent.index(t,e);this._ext=[t[a[0]],t[a[1]]],this._get=e}return this._ext},o.argmin=function(e){return this.extent(e)[0]},o.argmax=function(e){return this.extent(e)[1]},o.min=function(e){var t=this.extent(e)[0];return null==t?+Infinity:e(t)},o.max=function(e){var t=this.extent(e)[1];return null==t?-Infinity:e(t)},o.quartile=function(e){return this._get===e&&this._q||(this._q=d.quartile(this.values(),e),this._get=e),this._q},o.q1=function(e){return this.quartile(e)[0]},o.q2=function(e){return this.quartile(e)[1]},o.q3=function(e){return this.quartile(e)[2]},t.exports=a},{"../stats":28,"../util":31}],11:[function(e,t){var n=e("../util"),r=e("./aggregator");t.exports=function(){// flatten arguments into a single array
var e=[].reduce.call(arguments,function(e,t){return e.concat(n.array(t))},[]);// create and return an aggregator
return new r().groupby(e).summarize({"*":"values"})}},{"../util":31,"./aggregator":9}],12:[function(e,t){function a(e){return function(t){var a=r.extend({init:"",add:"",rem:"",idx:0},e);return a.out=t||e.name,a}}function n(e,t){function a(e,n){function r(t){e[t]||a(e,e[t]=i[t]())}return n.req&&n.req.forEach(r),t&&n.str&&n.str.forEach(r),e}var n=e.reduce(a,e.reduce(function(e,t){return e[t.name]=t,e},{}));return r.vals(n).sort(function(e,t){return e.idx-t.idx})}var r=e("../util"),i={values:a({name:"values",init:"cell.collect = true;",set:"cell.data.values()",idx:-1}),count:a({name:"count",set:"cell.num"}),missing:a({name:"missing",set:"this.missing"}),valid:a({name:"valid",set:"this.valid"}),sum:a({name:"sum",init:"this.sum = 0;",add:"this.sum += v;",rem:"this.sum -= v;",set:"this.sum"}),mean:a({name:"mean",init:"this.mean = 0;",add:"var d = v - this.mean; this.mean += d / this.valid;",rem:"var d = v - this.mean; this.mean -= this.valid ? d / this.valid : this.mean;",set:"this.mean"}),average:a({name:"average",set:"this.mean",req:["mean"],idx:1}),variance:a({name:"variance",init:"this.dev = 0;",add:"this.dev += d * (v - this.mean);",rem:"this.dev -= d * (v - this.mean);",set:"this.valid > 1 ? this.dev / (this.valid-1) : 0",req:["mean"],idx:1}),variancep:a({name:"variancep",set:"this.valid > 1 ? this.dev / this.valid : 0",req:["variance"],idx:2}),stdev:a({name:"stdev",set:"this.valid > 1 ? Math.sqrt(this.dev / (this.valid-1)) : 0",req:["variance"],idx:2}),stdevp:a({name:"stdevp",set:"this.valid > 1 ? Math.sqrt(this.dev / this.valid) : 0",req:["variance"],idx:2}),stderr:a({name:"stderr",set:"this.valid > 1 ? Math.sqrt(this.dev / (this.valid * (this.valid-1))) : 0",req:["variance"],idx:2}),median:a({name:"median",set:"cell.data.q2(this.get)",req:["values"],idx:3}),q1:a({name:"q1",set:"cell.data.q1(this.get)",req:["values"],idx:3}),q3:a({name:"q3",set:"cell.data.q3(this.get)",req:["values"],idx:3}),distinct:a({name:"distinct",set:"this.distinct(cell.data.values(), this.get)",req:["values"],idx:3}),argmin:a({name:"argmin",add:"if (v < this.min) this.argmin = t;",rem:"if (v <= this.min) this.argmin = null;",set:"this.argmin = this.argmin || cell.data.argmin(this.get)",req:["min"],str:["values"],idx:3}),argmax:a({name:"argmax",add:"if (v > this.max) this.argmax = t;",rem:"if (v >= this.max) this.argmax = null;",set:"this.argmax = this.argmax || cell.data.argmax(this.get)",req:["max"],str:["values"],idx:3}),min:a({name:"min",init:"this.min = +Infinity;",add:"if (v < this.min) this.min = v;",rem:"if (v <= this.min) this.min = NaN;",set:"this.min = (isNaN(this.min) ? cell.data.min(this.get) : this.min)",str:["values"],idx:4}),max:a({name:"max",init:"this.max = -Infinity;",add:"if (v > this.max) this.max = v;",rem:"if (v >= this.max) this.max = NaN;",set:"this.max = (isNaN(this.max) ? cell.data.max(this.get) : this.max)",str:["values"],idx:4}),modeskew:a({name:"modeskew",set:"this.dev===0 ? 0 : (this.mean - cell.data.q2(this.get)) / Math.sqrt(this.dev/(this.valid-1))",req:["mean","variance","median"],idx:5})};i.create=function(t,a,i,s){var d=n(t,a),o="this.cell = cell; this.tuple = t; this.valid = 0; this.missing = 0;",l="if (v==null) this.missing++; if (!this.isValid(v)) return; ++this.valid;",p="if (v==null) this.missing--; if (!this.isValid(v)) return; --this.valid;",u="var t = this.tuple; var cell = this.cell;";return d.forEach(function(e){0>e.idx?(o=e.init+o,l=e.add+l,p=e.rem+p):(o+=e.init,l+=e.add,p+=e.rem)}),t.slice().sort(function(e,t){return e.idx-t.idx}).forEach(function(e){u+="this.assign(t,'"+e.out+"',"+e.set+");"}),u+="return t;",o=Function("cell","t",o),o.prototype.assign=s,o.prototype.add=Function("t","var v = this.get(t);"+l),o.prototype.rem=Function("t","var v = this.get(t);"+p),o.prototype.set=Function(u),o.prototype.get=i,o.prototype.distinct=e("../stats").count.distinct,o.prototype.isValid=r.isValid,o.fields=t.map(r.$("out")),o},t.exports=i},{"../stats":28,"../util":31}],13:[function(e,t){function a(e){if(!e)throw Error("Missing binning options.");// determine range
var t=e.maxbins||15,a=e.base||10,d=_(a),o=e.div||[5,2],l=e.min,p=e.max,u=p-l,c,g,m,h,f,x,b;if(e.step)c=e.step;else if(e.steps)c=e.steps[w(e.steps.length-1,n(e.steps,u/t,0,e.steps.length))];else{// increase step size if too many bins
for(g=y(_(t)/d),m=e.minstep||0,c=A(m,S(a,v(_(u)/d)-g));y(u/c)>t;)c*=a;// decrease step size if allowed
for(x=0;x<o.length;++x)f=c/o[x],f>=m&&u/f<=t&&(c=f)}// update precision, min and max
return f=_(c),h=0<=f?0:~~(-f/d)+1,b=S(a,-h-1),l=w(l,T(l/c+b)*c),p=y(p/c)*c,{start:l,stop:p,step:c,unit:{precision:h},value:r,index:s}}function n(e,t,a,n){for(;a<n;){var r=a+n>>>1;0>l.cmp(e[r],t)?a=r+1:n=r}return a}function r(e){return this.step*T(e/this.step+u)}function s(e){return T((e-this.start)/this.step+u)}function d(e){return this.unit.date(r.call(this,e))}function o(e){return s.call(this,this.unit.unit(e))}var l=e("../util"),p=e("../time"),u=1e-15;a.date=function(e){if(!e)throw Error("Missing date binning options.");// find time step, then bin
var t=e.utc?p.utc:p,n=e.min,r=e.max,i=e.maxbins||20,s=e.minbins||4,l=e.unit?t[e.unit]:t.find(+r-+n,s,i),u=a({min:null==l.min?l.unit(n):l.min,max:null==l.max?l.unit(r):l.max,maxbins:i,minstep:l.minstep,steps:l.step});return u.unit=l,u.index=o,e.raw||(u.value=d),u},t.exports=a},{"../time":30,"../util":31}],14:[function(e,t){function a(e){var a=e.type,t=null;return(null==a||u[a])&&("integer"===a&&null==e.minstep&&(e.minstep=1),t="date"===a?s.date(e):s(e)),t}function n(){var e=arguments,t=0,a=l.isArray(e[t])?e[t++]:null,n=l.isFunction(e[t])||l.isString(e[t])?l.$(e[t++]):null,r=l.extend({},e[t]);if(a&&(r.type=r.type||o(a,n),u[r.type])){var s=p.extent(a,n);r=l.extend({min:s[0],max:s[1]},r)}return n&&(r.accessor=n),r}function r(e,t,a){for(var n=d.range(a.start,a.stop+a.step/2,a.step).map(function(e){return{value:a.value(e),count:0}}),r=0,s,o;r<e.length;++r)if(s=t?t(e[r]):e[r],l.isValid(s)){if(o=a.index(s),0>o||o>=n.length||!isFinite(o))continue;n[o].count+=1}return n.bins=a,n}function i(e,t,a){var n=p.unique(e,t),r=p.count.map(e,t);return n.map(function(e){return{value:e,count:r[e]}}).sort(l.comparator(a?"-count":"+value"))}var s=e("./bins"),d=e("../generate"),o=e("../import/type"),l=e("../util"),p=e("../stats"),u={integer:1,number:1,date:1};t.exports={$bin:function(e,t,r){r=n(e,t,r);var i=a(r);return i?l.$func("bin",i.unit.unit?function(e){return i.value(i.unit.unit(e))}:function(e){return i.value(e)})(r.accessor):r.accessor||l.identity},histogram:function(e,t,s){s=n(e,t,s);var d=a(s);return d?r(e,s.accessor,d):i(e,s.accessor,s&&s.sort)}}},{"../generate":17,"../import/type":26,"../stats":28,"../util":31,"./bins":13}],15:[function(e,t){function a(e){return["valid:    "+e.valid,"missing:  "+e.missing,"distinct: "+e.distinct,"min:      "+e.min,"max:      "+e.max,"median:   "+e.median,"mean:     "+e.mean,"stdev:    "+e.stdev,"modeskew: "+e.modeskew].join("\n")}function r(e){var t=["valid:    "+e.valid,"missing:  "+e.missing,"distinct: "+e.distinct,"top values: "],n=e.unique,a=s.keys(n).sort(function(e,t){return n[t]-n[e]}).slice(0,6).map(function(e){return" '"+e+"' ("+n[e]+")"});return t.concat(a).join("\n")}var s=e("./util"),d=e("./import/type"),o=e("./stats"),p=e("./template");t.exports={table:function(e,n){n=s.extend({separator:" ",minwidth:8,maxwidth:15},n);var r=n.fields||s.keys(e[0]),g=d.all(e);if(n.start||n.limit){var m=n.start||0,t=n.limit?m+n.limit:e.length;e=e.slice(m,t)}// determine char width of fields
var a=r.map(function(a){var r=u[g[a]]||"",i=p("{{"+a+r+"}}"),t=o.max(e,function(e){return i(e).length});return t=A(w(a.length,n.minwidth),t),0<n.maxwidth?w(t,n.maxwidth):t}),i=r.map(function(e,t){return s.truncate(s.pad(e,a[t],"center"),a[t])}).join(n.separator),l=p(r.map(function(e,t){return"{{"+e+(u[g[e]]||"")+("|pad:"+a[t]+","+(c[g[e]]||"right"))+("|truncate:"+a[t])+"}}"}).join(n.separator));// print header row
// build template function for each row
// print table
return i+"\n"+e.map(l).join("\n")},// format a data table
summary:function(e){e=e?e.__summary__?e:o.summary(e):this;var t=[],d,l;for(d=0,l=e.length;d<l;++d)t.push("-- "+e[d].field+" --"),"string"===e[d].type||10>e[d].distinct?t.push(r(e[d])):t.push(a(e[d])),t.push("");return t.join("\n")}// format a data table summary
};var u={date:"|time:\"%m/%d/%Y %H:%M:%S\"",number:"|number:\".4f\"",integer:"|number:\"d\""},c={number:"left",integer:"left"}},{"./import/type":26,"./stats":28,"./template":29,"./util":31}],16:[function(e,t){// -- Locales ----
// transform 'en-US' style locale string to match d3-format v0.4+ convention
function a(e){return 4<e.length&&"locale"+(e[0].toUpperCase()+e[1].toLowerCase()+e[3].toUpperCase()+e[4].toLowerCase())}function n(e){var t=m.isString(e)?x[a(e)]:x.locale(e);if(null==t)throw Error("Unrecognized locale: "+e);b=t}function r(e){var t=m.isString(e)?v[a(e)]:v.locale(e);if(null==t)throw Error("Unrecognized locale: "+e);k=t,E=C=M=D=null}// -- Number Formatting ----
function i(e,t){var a=Math.LN10;e.length||(e=[0]),null==t&&(t=10);var n=e[0],r=e[e.length-1];r<n&&(d=r,r=n,n=d);var i=r-n||(t=1,n||r||1),s=S(10,T(_(i/t)/a)),d=i/t/s;// Filter ticks to get closer to the desired count.
// Round start and stop values to step interval.
return d>=j?s*=10:d>=P?s*=5:d>=I&&(s*=2),[y(n/s)*s,T(r/s)*s+s/2,// inclusive
s]}function s(e,t){return function(a){var r=e(a),i=r.indexOf(t);if(0>i)return r;for(var n=d(r,i),s=n<r.length?r.slice(n):"";--n>i;)if("0"!==r[n]){++n;break}return r.slice(0,n)+s}}function d(e,t){var a=e.lastIndexOf("e"),n;if(0<a)return a;for(a=e.length;--a>t;)if(n=e.charCodeAt(a),48<=n&&57>=n)return a+1;// is digit
}function o(e){var t=b.format(".1f")(1)[1];// get decimal char
switch(null==e&&(e=","),e=x.formatSpecifier(e),null==e.precision&&(e.precision=12),e.type){case"%":e.precision-=2;break;case"e":e.precision-=1;}return s(b.format(e),t)}function l(e,t,a){var n=i(e,t);switch(null==a&&(a=",f"),a=x.formatSpecifier(a),a.type){case"s":{var r=A(L(n[0]),L(n[1]));return null==a.precision&&(a.precision=x.precisionPrefix(n[2],r)),b.formatPrefix(a,r)}case"":case"e":case"g":case"p":case"r":{null==a.precision&&(a.precision=x.precisionRound(n[2],A(L(n[0]),L(n[1])))-("e"===a.type));break}case"f":case"%":{null==a.precision&&(a.precision=x.precisionFixed(n[2])-2*("%"===a.type));break}}return b.format(a)}// -- Datetime Formatting ----
function p(){var e=k.format,t=e(".%L"),a=e(":%S"),n=e("%I:%M"),r=e("%I %p"),i=e("%a %d"),s=e("%b %d"),o=e("%B"),l=e("%Y");return function(e){var p=+e;return(f.second(e)<p?t:f.minute(e)<p?a:f.hour(e)<p?n:f.day(e)<p?r:f.month(e)<p?f.week(e)<p?i:s:f.year(e)<p?o:l)(e)}}function u(){var e=k.utcFormat,t=e(".%L"),a=e(":%S"),n=e("%I:%M"),r=e("%I %p"),i=e("%a %d"),s=e("%b %d"),o=e("%B"),l=e("%Y");return function(e){var p=+e;return(f.utcSecond(e)<p?t:f.utcMinute(e)<p?a:f.utcHour(e)<p?n:f.utcDay(e)<p?r:f.utcMonth(e)<p?f.utcWeek(e)<p?i:s:f.utcYear(e)<p?o:l)(e)}}function c(e,t){var a=t?C||(C=k.format("%b")):E||(E=k.format("%B"));return w.setMonth(e),a(w)}function g(e,t){var a=t?D||(D=k.format("%a")):M||(M=k.format("%A"));return w.setMonth(0),w.setDate(2+e),a(w)}var m=e("./util"),f=e("d3-time"),v=e("d3-time-format"),x=e("d3-format"),b=x,// defaults to EN-US
k=v,// defaults to EN-US
w=new Date(2e3,0,1),E,C,M,D;t.exports={// Update number formatter to use provided locale configuration.
// For more see https://github.com/d3/d3-format
numberLocale:n,number:function(e){return b.format(e)},numberPrefix:function(e,t){return b.formatPrefix(e,t)},// Update time formatter to use provided locale configuration.
// For more see https://github.com/d3/d3-time-format
timeLocale:r,time:function(e){return k.format(e)},utc:function(e){return k.utcFormat(e)},// Set number and time locale simultaneously.
locale:function(e){n(e),r(e)},// automatic formatting functions
auto:{number:o,linear:l,time:function(){return p()},utc:function(){return u()}},month:c,// format month name from integer code
day:g,// format week day name from integer code
quarter:function(e){return T(e.getMonth()/3)+1},// format quarter name from timestamp
utcQuarter:function(e){return T(e.getUTCMonth()/3)+1}// format quarter name from utc timestamp
};var j=h(50),P=h(10),I=h(2)},{"./util":31,"d3-format":4,"d3-time":6,"d3-time-format":5}],17:[function(e,t){var a=e("./util"),r=t.exports;r.repeat=function(e,t){var n=Array(t),a;for(a=0;a<t;++a)n[a]=e;return n},r.zeros=function(e){return r.repeat(0,e)},r.range=function(e,t,a){if(3>arguments.length&&(a=1,2>arguments.length&&(t=e,e=0)),(t-e)/a==1/0)throw new Error("Infinite range");var n=[],r=-1,s;if(0>a)for(;(s=e+a*++r)>t;)n.push(s);else for(;(s=e+a*++r)<t;)n.push(s);return n},r.random={},r.random.uniform=function(e,t){void 0===t&&(t=void 0===e?1:e,e=0);var a=t-e,i=function(){return e+a*Math.random()};return i.samples=function(e){return r.zeros(e).map(i)},i.pdf=function(n){return n>=e&&n<=t?1/a:0},i.cdf=function(n){return n<e?0:n>t?1:(n-e)/a},i.icdf=function(t){return 0<=t&&1>=t?e+t*a:NaN},i},r.random.integer=function(e,t){void 0===t&&(t=e,e=0);var n=t-e,i=function(){return e+T(n*Math.random())};return i.samples=function(e){return r.zeros(e).map(i)},i.pdf=function(a){return a===T(a)&&a>=e&&a<t?1/n:0},i.cdf=function(a){var r=T(a);return r<e?0:r>=t?1:(r-e+1)/n},i.icdf=function(t){return 0<=t&&1>=t?e-1+T(t*n):NaN},i},r.random.normal=function(e,t){var a=Math.exp;e=e||0,t=t||1;var i=function(){var a=0,r=0,i,s;if(void 0!==n)return a=n,n=void 0,a;do a=2*Math.random()-1,r=2*Math.random()-1,i=a*a+r*r;while(0===i||1<i);return s=h(-2*_(i)/i),n=e+r*s*t,e+a*s*t},n;return i.samples=function(e){return r.zeros(e).map(i)},i.pdf=function(n){var r=a(S(n-e,2)/(-2*S(t,2)));return 1/(t*h(2*l))*r},i.cdf=function(n){// Approximation from West (2009)
// Better Approximations to Cumulative Normal Functions
var r=(n-e)/t,i=L(r),s;if(37<i)s=0;else{var d=a(-i*i/2),o;7.07106781186547>i?(o=.0352624965998911*i+.700383064443688,o=o*i+6.37396220353165,o=o*i+33.912866078383,o=o*i+112.079291497871,o=o*i+221.213596169931,o=o*i+220.206867912376,s=d*o,o=.0883883476483184*i+1.75566716318264,o=o*i+16.064177579207,o=o*i+86.7807322029461,o=o*i+296.564248779674,o=o*i+637.333633378831,o=o*i+793.826512519948,o=o*i+440.413735824752,s/=o):(o=i+.65,o=i+4/o,o=i+3/o,o=i+2/o,o=i+1/o,s=d/o/2.506628274631)}return 0<r?1-s:s},i.icdf=function(n){var r=Math.SQRT2;// Approximation of Probit function using inverse error function.
if(0>=n||1<=n)return NaN;var i=2*n-1,d=8*(l-3)/(3*l*(4-l)),o=2/(l*d)+_(1-S(i,2))/2,a=_(1-i*i)/d,p=(0<i?1:-1)*h(h(o*o-a)-o);return e+t*r*p},i},r.random.bootstrap=function(e,t){// Generates a bootstrap sample from a set of observations.
// Smooth bootstrapping adds random zero-centered noise to the samples.
var n=e.filter(a.isValid),i=n.length,s=t?r.random.normal(0,t):null,d=function(){return n[~~(Math.random()*i)]+(s?s():0)};return d.samples=function(e){return r.zeros(e).map(d)},d}},{"./util":31}],18:[function(e,t){function a(e,t){if(e){var a=t.header;e=(a?a.join(t.delimiter)+"\n":"")+e}return r.dsv(t.delimiter).parse(e)}var n=e("../../util"),r=e("d3-dsv");a.delimiter=function(e){var t={delimiter:e};return function(e,r){return a(e,r?n.extend(r,t):t)}},t.exports=a},{"../../util":31,"d3-dsv":3}],19:[function(e,t){var a=e("./dsv");t.exports={json:e("./json"),topojson:e("./topojson"),treejson:e("./treejson"),dsv:a,csv:a.delimiter(","),tsv:a.delimiter("\t")}},{"./dsv":18,"./json":20,"./topojson":21,"./treejson":22}],20:[function(e,t){var a=e("../../util");t.exports=function(e,t){var n=a.isObject(e)&&!a.isBuffer(e)?e:JSON.parse(e);return t&&t.property&&(n=a.accessor(t.property)(n)),n}},{"../../util":31}],21:[function(e,t){var a=e("./json"),n=function(e,r){var i=n.topojson;if(null==i)throw Error("TopoJSON library not loaded.");var s=a(e,r),t;if(r&&r.feature){if(t=s.objects[r.feature])return i.feature(s,t).features;throw Error("Invalid TopoJSON object: "+r.feature)}else if(r&&r.mesh){if(t=s.objects[r.mesh])return[i.mesh(s,s.objects[r.mesh])];throw Error("Invalid TopoJSON object: "+r.mesh)}else throw Error("Missing TopoJSON feature or mesh parameter.")};n.topojson=e("topojson"),t.exports=n},{"./json":20,topojson:32}],22:[function(e,t){function a(e,t){function a(e,t){e[r]=t,s.push(e);var d=e[n];if(d)for(var o=0;o<d.length;++o)a(d[o],e)}var n=t&&t.children||"children",r=t&&t.parent||"parent",s=[];return a(e,null),s.root=e,s}var n=e("./json");t.exports=function(e,t){return a(n(e,t),t)}},{"./json":20}],23:[function(e,t){function n(e,t){return n.loader(e,t)}// Validate and cleanup URL to ensure that it is allowed to be accessed
// Returns cleaned up URL, or false if access is not allowed
function r(e){var t=e.responseType;return t&&"text"!==t?e.response:// null on error
e.responseText;// '' on error
}function i(e,t,a){function i(){var e=o.status;!e&&r(o)||200<=e&&300>e||304===e?a(null,o.responseText):a(o,null)}var s=!!a,o=new XMLHttpRequest;// If IE does not support CORS, use XDomainRequest (copied from d3.xhr)
/* istanbul ignore else */if("undefined"!=typeof XDomainRequest&&!("withCredentials"in o)&&/^(http(s)?:)?\/\//.test(e)&&(o=new XDomainRequest),s&&("onload"in o?o.onload=o.onerror=i:o.onreadystatechange=function(){3<o.readyState&&i()}),o.open("GET",e,s),o.setRequestHeader){var l=d.extend({},n.headers,t.headers);for(var p in l)o.setRequestHeader(p,l[p])}return(o.send(),!s&&r(o))?o.responseText:void 0}function s(e,t){return null!=e&&0===e.lastIndexOf(t,0)}// Allow these functions to be overriden by the user of the library
var d=e("../util"),o=/^([A-Za-z]+:)?\/\//;// Matches absolute URLs with optional protocol
//   https://...    file://...    //...
// Special treatment in node.js for the file: protocol
// Default settings
n.loader=function(e,t){var a=t||function(t){throw t},r;try{r=n.sanitizeUrl(e)}catch(e){return void a(e)}return r?n.useXHR?n.xhr(r,e,t):s(r,"file://")?n.file(r.slice(7),e,t):0>r.indexOf("://")?n.file(r,e,t):n.http(r,e,t):void a("Invalid URL: "+e.url)},n.sanitizeUrl=function(t){var r=t.url;if(!r&&t.file)return"file://"+t.file;// In case this is a relative url (has no host), prepend opt.baseURL
// If opt.domainWhiteList is set, only allows url, whose hostname
// * Is the same as the origin (window.location.hostname)
// * Equals one of the values in the whitelist
// * Is a proper subdomain of one of the values in the whitelist
if(t.baseURL&&!o.test(r)&&(!s(r,"/")&&"/"!==t.baseURL[t.baseURL.length-1]&&(r="/"+r),r=t.baseURL+r),!n.useXHR&&s(r,"//")&&(r=(t.defaultProtocol||"http")+":"+r),t.domainWhiteList){var i,d;if(n.useXHR){var l=document.createElement("a");l.href=r,""===l.host&&(l.href=l.href),i=l.hostname.toLowerCase(),d=window.location.hostname}else{// relative protocol is broken: https://github.com/defunctzombie/node-url/issues/5
var a=e("url").parse(r);i=a.hostname,d=null}if(d!==i){var p=t.domainWhiteList.some(function(e){var t=i.length-e.length;return e===i||1<t&&"."===i[t-1]&&i.lastIndexOf(e)===t});if(!p)throw"URL is not whitelisted: "+r}}return r},n.xhr=i,n.file=function(t,a,n){var r=e("fs");return n?void r.readFile(t,n):r.readFileSync(t,"utf8")},n.http=function(t,a,r){var i=d.extend({},n.headers,a.headers),s={url:t,encoding:null,gzip:!0,headers:i};return r?void e("request")(s,function(e,t,a){e||200!==t.statusCode?(e=e||"Load failed with response code "+t.statusCode+".",r(e,null)):r(null,a)}):e("sync-request")("GET",t,s).getBody()},n.useXHR="undefined"!=typeof XMLHttpRequest,n.headers={},t.exports=n},{"../util":31,fs:2,request:2,"sync-request":2,url:2}],24:[function(e,t){function a(e,t){var a=t&&t.type||"json";return e=d[a](e,t),t&&t.parse&&n(e,t.parse),e}function n(e,a){var n=e.length,l,p,u,t,c,g;for(a="auto"===a?s.inferAll(e):r.duplicate(a),l=r.keys(a),p=l.map(function(e){var n=a[e];if(n&&0===n.indexOf("date:")){var t=n.split(/:(.+)?/,2),// split on first :
r=t[1];if("'"===r[0]&&"'"===r[r.length-1]||"\""===r[0]&&"\""===r[r.length-1])r=r.slice(1,-1);else throw Error("Format pattern must be quoted: "+r);return r=o(r),function(e){return r.parse(e)}}if(!s.parsers[n])throw Error("Illegal format pattern: "+e+":"+n);return s.parsers[n]}),(t=0,g=l.length);t<n;++t)for(u=e[t],c=0;c<g;++c)u[l[c]]=p[c](u[l[c]]);s.annotation(e,a)}var r=e("../util"),s=e("./type"),d=e("./formats"),o=e("../format").time;a.formats=d,t.exports=a},{"../format":16,"../util":31,"./formats":19,"./type":26}],25:[function(e,t){var a=e("../util"),n=e("./load"),r=e("./read");t.exports=a.keys(r.formats).reduce(function(e,t){return e[t]=function(e,i,s){a.isString(e)&&(e={url:e}),2===arguments.length&&a.isFunction(i)&&(s=i,i=void 0),i=a.extend({parse:"auto"},i),i.type=t;// load data
var d=n(e,s?function(e,t){if(e)return void s(e,null);try{t=r(t,i),s(null,t)}catch(t){s(t,null)}}:void 0);// data loaded, now parse it (sync)
if(!s)return r(d,i)},e},{})},{"../util":31,"./load":23,"./read":24}],26:[function(e,t){function a(e){return s.keys(e)}function n(e){return"["+e+"]"}function r(e,t){e=s.array(e),t=s.$(t);var a,r,d;// if data array has type annotations, use them
if(e.__types__&&(a=t(e.__types__),s.isString(a)))return a;for(r=0,d=e.length;!s.isValid(a)&&r<d;++r)a=t?t(e[r]):e[r];return s.isDate(a)?"date":s.isNumber(a)?"number":s.isBoolean(a)?"boolean":s.isString(a)?"string":null}function i(e,t){e=s.array(e),t=s.$(t);var a=["boolean","integer","number","date"],n,r,d;// types to test for, in precedence order
for(n=0;n<e.length;++n){// test value against remaining types
for(d=t?t(e[n]):e[n],r=0;r<a.length;++r)s.isValid(d)&&!o[a[r]](d)&&(a.splice(r,1),r-=1);// if no types left, return 'string'
if(0===a.length)return"string"}return a[0]}var s=e("../util"),d={boolean:s.boolean,integer:s.number,number:s.number,date:s.date,string:function(e){return null==e||""===e?null:e+""}},o={boolean:function(e){return"true"===e||"false"===e||s.isBoolean(e)},integer:function(e){return o.number(e)&&(e=+e)==~~e},number:function(e){return!isNaN(+e)&&!s.isDate(e)},date:function(e){return!isNaN(Date.parse(e))}};r.annotation=function(e,t){return t?void(e.__types__=t):e&&e.__types__||null},r.all=function(e,t){if(e.length){var i=t?s.identity:(t=a(e[0]),n);return t.reduce(function(t,a){return t[a]=r(e,i(a)),t},{})}},r.infer=i,r.inferAll=function(e,t){var r=t?s.identity:(t=a(e[0]),n);return t.reduce(function(t,a){return t[a]=i(e,r(a)),t},{})},r.parsers=d,t.exports=r},{"../util":31}],27:[function(e,t){var a=e("./util"),n={version:e("../package.json").version,load:e("./import/load"),read:e("./import/read"),type:e("./import/type"),Aggregator:e("./aggregate/aggregator"),groupby:e("./aggregate/groupby"),bins:e("./bins/bins"),$bin:e("./bins/histogram").$bin,histogram:e("./bins/histogram").histogram,format:e("./format"),template:e("./template"),time:e("./time")};// backwards-compatible, deprecated API
// will remove in the future
a.extend(n,a),a.extend(n,e("./accessor")),a.extend(n,e("./generate")),a.extend(n,e("./stats")),a.extend(n,e("./import/readers")),a.extend(n.format,e("./format-tables")),n.print={table:n.format.table,summary:n.format.summary},t.exports=n},{"../package.json":7,"./accessor":8,"./aggregate/aggregator":9,"./aggregate/groupby":11,"./bins/bins":13,"./bins/histogram":14,"./format":16,"./format-tables":15,"./generate":17,"./import/load":23,"./import/read":24,"./import/readers":25,"./import/type":26,"./stats":28,"./template":29,"./time":30,"./util":31}],28:[function(e,t){var d=Math.LN2;// Perform a z-test of means. Returns the p-value.
// Assuming we have a list of values, and a null hypothesis. If no null
// hypothesis, assume our null hypothesis is mu=0.
function n(e,t,a){var n=e&&e.nullh||0,r=p.random.normal(0,1),i=g.mean(t,a),s=g.stdev(t,a)/h(g.count.valid(t,a));if(0==s)// Test not well defined when standard error is 0.
return 0==i-n?1:0;// Two-sided, so twice the one-sided cdf.
return 2*r.cdf(-L((i-n)/s))}// Perform a two sample paired z-test of means. Returns the p-value.
function r(e,t,n,a){var r=a?t.map(o.$(n)):t,s=a?t.map(o.$(a)):n,d=g.count(r),l=g.count(s),p=[],u;if(d!==l)throw Error("Array lengths must match.");for(u=0;u<d;++u)// Only valid differences should contribute to the test statistic
o.isValid(r[u])&&o.isValid(s[u])&&p.push(r[u]-s[u]);return g.z.test(p,e&&e.nullh||0)}// Perform a two sample z-test of means. Returns the p-value.
function i(e,t,n,a){var r=a?t.map(o.$(n)):t,i=a?t.map(o.$(a)):n,s=g.count.valid(r),d=g.count.valid(i),l=p.random.normal(0,1),u=g.mean(r)-g.mean(i)-(e&&e.nullh||0),c=h(g.variance(r)/s+g.variance(i)/d);if(0===c)// Not well defined when pooled standard error is 0.
return 0==u?1:0;// Two-tailed, so twice the one-sided cdf.
return 2*l.cdf(-L(u/c))}// Construct a mean-centered distance matrix for an array of numbers.
var o=e("./util"),l=e("./import/type"),p=e("./generate"),g=t.exports;// Collect unique values.
// Output: an array of unique values, in first-observed order
// Return the length of the input array.
// Count the number of non-null, non-undefined, non-NaN values.
// Count the number of null or undefined values.
// Count the number of distinct values.
// Null, undefined and NaN are each considered distinct values.
// Construct a map from distinct values to occurrence counts.
// Compute the median of an array of numbers.
// Computes the quartile boundaries of an array of numbers.
// Compute the quantile of a sorted array of numbers.
// Adapted from the D3.js implementation.
// Compute the sum of an array of numbers.
// Compute the mean (average) of an array of numbers.
// Compute the geometric mean of an array of numbers.
// Compute the harmonic mean of an array of numbers.
// Compute the sample variance of an array of numbers.
// Compute the sample standard deviation of an array of numbers.
// Compute the Pearson mode skewness ((median-mean)/stdev) of an array of numbers.
// Find the minimum value in an array.
// Find the maximum value in an array.
// Find the minimum and maximum of an array of values.
// Find the integer indices of the minimum and maximum values.
// Compute the dot product of two arrays of numbers.
// Compute the vector distance between two arrays of numbers.
// Default is Euclidean (exp=2) distance, configurable via exp argument.
// Compute the Cohen's d effect size between two arrays of numbers.
// Computes the covariance between two arrays of numbers
// Compute ascending rank scores for an array of values.
// Ties are assigned their collective mean rank.
// Compute the sample Pearson product-moment correlation of two arrays of numbers.
// Compute the Spearman rank correlation of two arrays of values.
// Compute the distance correlation of two arrays of numbers.
// http://en.wikipedia.org/wiki/Distance_correlation
// Simple linear regression.
// Returns a "fit" object with slope (m), intercept (b),
// r value (R), and sum-squared residual error (rss).
// Namespace for bootstrap
// Construct a bootstrapped confidence interval at a given percentile level
// Arguments are an array, an optional n (defaults to 1000),
//  an optional alpha (defaults to 0.05), and an optional smoothing parameter
// Namespace for z-tests
// Construct a z-confidence interval at a given significance level
// Arguments are an array and an optional alpha (defaults to 0.05).
// Perform a z-test of means. Returns the p-value.
// If a single array is provided, performs a one-sample location test.
// If two arrays or a table and two accessors are provided, performs
// a two-sample location test. A paired test is performed if specified
// by the options hash.
// The options hash format is: {paired: boolean, nullh: number}.
// http://en.wikipedia.org/wiki/Z-test
// http://en.wikipedia.org/wiki/Paired_difference_test
// Compute the Shannon entropy (log base 2) of an array of counts.
// Compute the mutual information between two discrete variables.
// Returns an array of the form [MI, MI_distance]
// MI_distance is defined as 1 - I(a,b) / H(a,b).
// http://en.wikipedia.org/wiki/Mutual_information
// Compute the mutual information between two discrete variables.
// Compute the mutual information distance between two discrete variables.
// MI_distance is defined as 1 - I(a,b) / H(a,b).
// Compute a profile of summary statistics for a variable.
// Compute profiles for all variables in a data set.
g.unique=function(e,t,a){t=o.$(t),a=a||[];var r={},s,d,l;for(d=0,l=e.length;d<l;++d)s=t?t(e[d]):e[d],s in r||(r[s]=1,a.push(s));return a},g.count=function(e){return e&&e.length||0},g.count.valid=function(e,t){t=o.$(t);var a=0,r,s,d;for(s=0,d=e.length;s<d;++s)r=t?t(e[s]):e[s],o.isValid(r)&&(a+=1);return a},g.count.missing=function(e,t){t=o.$(t);var a=0,r,s,d;for(s=0,d=e.length;s<d;++s)r=t?t(e[s]):e[s],null==r&&(a+=1);return a},g.count.distinct=function(e,t){t=o.$(t);var a={},r=0,s,d,l;for(d=0,l=e.length;d<l;++d)s=t?t(e[d]):e[d],s in a||(a[s]=1,r+=1);return r},g.count.map=function(e,t){t=o.$(t);var a={},r,s,d;for(s=0,d=e.length;s<d;++s)r=t?t(e[s]):e[s],a[r]=r in a?a[r]+1:1;return a},g.median=function(e,t){return t&&(e=e.map(o.$(t))),e=e.filter(o.isValid).sort(o.cmp),g.quantile(e,.5)},g.quartile=function(e,t){t&&(e=e.map(o.$(t))),e=e.filter(o.isValid).sort(o.cmp);var a=g.quantile;return[a(e,.25),a(e,.5),a(e,.75)]},g.quantile=function(t,a,n){n===void 0&&(n=a,a=o.identity),a=o.$(a);var r=(t.length-1)*n+1,i=T(r),s=+a(t[i-1]),d=r-i;return d?s+d*(a(t[i])-s):s},g.sum=function(e,t){t=o.$(t);for(var a=0,r=0,s=e.length,n;r<s;++r)n=t?t(e[r]):e[r],o.isValid(n)&&(a+=n);return a},g.mean=function(e,t){t=o.$(t);var a=0,r,s,d,l,p;for(s=0,l=0,d=e.length;s<d;++s)p=t?t(e[s]):e[s],o.isValid(p)&&(r=p-a,a+=r/++l);return a},g.mean.geometric=function(e,t){t=o.$(t);var a=1,r,s,d,l;for(l=0,r=0,s=e.length;l<s;++l)if(d=t?t(e[l]):e[l],o.isValid(d)){if(0>=d)throw Error("Geometric mean only defined for positive values.");a*=d,++r}return a=0<r?S(a,1/r):0,a},g.mean.harmonic=function(e,t){t=o.$(t);var a=0,r,s,d,l;for(l=0,r=0,s=e.length;l<s;++l)d=t?t(e[l]):e[l],o.isValid(d)&&(a+=1/d,++r);return r/a},g.variance=function(e,t){if(t=o.$(t),!o.isArray(e)||2>e.length)return 0;var a=0,n=0,r,s,d,l;for(s=0,d=0;s<e.length;++s)l=t?t(e[s]):e[s],o.isValid(l)&&(r=l-a,a+=r/++d,n+=r*(l-a));return n/=d-1,n},g.stdev=function(e,t){return h(g.variance(e,t))},g.modeskew=function(e,t){var a=g.mean(e,t),n=g.median(e,t),r=g.stdev(e,t);return 0===r?0:(a-n)/r},g.min=function(e,t){return g.extent(e,t)[0]},g.max=function(e,t){return g.extent(e,t)[1]},g.extent=function(e,t){t=o.$(t);var r=e.length,n,s,d,l;for(l=0;l<r;++l)if(d=t?t(e[l]):e[l],o.isValid(d)){n=s=d;break}for(;l<r;++l)d=t?t(e[l]):e[l],o.isValid(d)&&(d<n&&(n=d),d>s&&(s=d));return[n,s]},g.extent.index=function(e,t){t=o.$(t);var r=-1,s=-1,d=e.length,n,l,p,u;for(u=0;u<d;++u)if(p=t?t(e[u]):e[u],o.isValid(p)){n=l=p,r=s=u;break}for(;u<d;++u)p=t?t(e[u]):e[u],o.isValid(p)&&(p<n&&(n=p,r=u),p>l&&(l=p,s=u));return[r,s]},g.dot=function(e,t,n){var r=0,s,d;if(!n){if(e.length!==t.length)throw Error("Array lengths must match.");for(s=0;s<e.length;++s)d=e[s]*t[s],d==d&&(r+=d)}else for(t=o.$(t),n=o.$(n),s=0;s<e.length;++s)d=t(e[s])*n(e[s]),d==d&&(r+=d);return r},g.dist=function(t,r,l,p){var u=o.isFunction(l)||o.isString(l),c=t,g=u?t:r,m=u?p:l,e=2===m||null==m,f=t.length,n=0,y,_;for(u&&(r=o.$(r),l=o.$(l)),_=0;_<f;++_)y=u?r(c[_])-l(g[_]):c[_]-g[_],n+=e?y*y:S(L(y),m);return e?h(n):S(n,1/m)},g.cohensd=function(e,t,a){var n=a?e.map(o.$(t)):e,r=a?e.map(o.$(a)):t,i=g.mean(n),d=g.mean(r),l=g.count.valid(n),p=g.count.valid(r);if(0>=l+p-2)// if both arrays are size 1, or one is empty, there's no effect size
return 0;// pool standard deviation
var u=g.variance(n),c=g.variance(r),m=h(((l-1)*u+(p-1)*c)/(l+p-2));// if there is no variance, there's no effect size
return 0===m?0:(i-d)/m},g.covariance=function(e,t,a){var r=a?e.map(o.$(t)):e,s=a?e.map(o.$(a)):t,d=r.length,n=g.mean(r),l=g.mean(s),p=0,u=0,m,h,f,_,v;if(d!==s.length)throw Error("Input lengths must match.");for(m=0;m<d;++m)if(h=r[m],_=o.isValid(h),f=s[m],v=o.isValid(f),_&&v)p+=(h-n)*(f-l),++u;else if(_||v)throw Error("Valid values must align.");return p/(u-1)},g.rank=function(e,t){t=o.$(t)||o.identity;var s=e.map(function(e,a){return{idx:a,val:t(e)}}).sort(o.comparator("val")),a=e.length,n=Array(a),r=-1,d={},l,u,c;for(l=0;l<a;++l){if(u=s[l].val,0>r&&d===u)r=l-1;else if(-1<r&&d!==u){for(c=1+(l-1+r)/2;r<l;++r)n[s[r].idx]=c;r=-1}n[s[l].idx]=l+1,d=u}if(-1<r)for(c=1+(a-1+r)/2;r<a;++r)n[s[r].idx]=c;return n},g.cor=function(e,t,r){var i=r;r=i?e.map(o.$(r)):t,t=i?e.map(o.$(t)):e;var s=g.dot(t,r),d=g.mean(t),l=g.mean(r),p=g.stdev(t),u=g.stdev(r),c=e.length;return(s-c*d*l)/((c-1)*p*u)},g.cor.rank=function(e,t,a){var r=a?g.rank(e,t):g.rank(e),o=a?g.rank(e,a):g.rank(t),l=e.length,n,p,u;for(n=0,p=0;n<l;++n)u=r[n]-o[n],p+=u*u;return 1-6*p/(l*(l*l-1))},g.cor.dist=function(e,t,a){var r=a?e.map(o.$(t)):e,s=a?e.map(o.$(a)):t,d=g.dist.mat(r),l=g.dist.mat(s),p=d.length,n,u,c,m;for(n=0,u=0,c=0,m=0;n<p;++n)u+=d[n]*d[n],c+=l[n]*l[n],m+=d[n]*l[n];return h(m/h(u*c))},g.linearRegression=function(e,t,a){var r=a?e.map(o.$(t)):e,s=a?e.map(o.$(a)):t,d=r.length,n=g.covariance(r,s),// will throw err if valid vals don't align
l=g.stdev(r),p=g.stdev(s),u=n/(l*l),c=g.mean(s)-u*g.mean(r),m={slope:u,intercept:c,R:n/(l*p),rss:0},h,f;for(f=0;f<d;++f)o.isValid(r[f])&&o.isValid(s[f])&&(h=u*r[f]+c-s[f],m.rss+=h*h);return m},g.bootstrap={},g.bootstrap.ci=function(e,t,a,n,r){var s,d,l,u,c,m,h;for(o.isFunction(t)||o.isString(t)?(s=e.map(o.$(t)),d=a,l=n,u=r):(s=e,d=t,l=a,u=n),d=d?+d:1e3,l=l||.05,c=p.random.bootstrap(s,u),(h=0,m=Array(d));h<d;++h)m[h]=g.mean(c.samples(s.length));return m.sort(o.numcmp),[g.quantile(m,l/2),g.quantile(m,1-l/2)]},g.z={},g.z.ci=function(e,t,a){var n=e,r=t;(o.isFunction(t)||o.isString(t))&&(n=e.map(o.$(t)),r=a),r=r||.05;var i=.05===r?1.96:p.random.normal(0,1).icdf(1-r/2),s=g.mean(n),d=g.stdev(n)/h(g.count.valid(n));return[s-i*d,s+i*d]},g.z.test=function(e,t,a,s){return o.isFunction(a)||o.isString(a)?(s&&s.paired?r:i)(s,e,t,a):o.isArray(t)?(a&&a.paired?r:i)(a,e,t):o.isFunction(t)||o.isString(t)?n(a,e,t):n(t,e)},g.dist.mat=function(e){var t=e.length,a=t*t,n=Array(a),r=p.zeros(t),s=0,d,o,l;for(o=0;o<t;++o)for(n[o*t+o]=0,l=o+1;l<t;++l)n[o*t+l]=d=L(e[o]-e[l]),n[l*t+o]=d,r[o]+=d,r[l]+=d;for(o=0;o<t;++o)s+=r[o],r[o]/=t;for(s/=a,o=0;o<t;++o)for(l=o;l<t;++l)n[o*t+l]+=s-r[o]-r[l],n[l*t+o]=n[o*t+l];return n},g.entropy=function(e,t){t=o.$(t);var a=0,r=0,l=e.length,n,u;for(n=0;n<l;++n)a+=t?t(e[n]):e[n];if(0===a)return 0;for(n=0;n<l;++n)u=(t?t(e[n]):e[n])/a,u&&(r+=u*_(u));return-r/d},g.mutual=function(e,r,a,l){var u=l?e.map(o.$(r)):e,c=l?e.map(o.$(a)):r,g=l?e.map(o.$(l)):a,m={},h={},f=g.length,n=0,y=0,v=0,x,b,k;for(k=0;k<f;++k)m[u[k]]=0,h[c[k]]=0;for(k=0;k<f;++k)m[u[k]]+=g[k],h[c[k]]+=g[k],n+=g[k];for(b=1/(n*d),k=0;k<f;++k)0!==g[k]&&(x=n*g[k]/(m[u[k]]*h[c[k]]),y+=g[k]*b*_(x),v+=g[k]*b*_(g[k]/n));return[y,1+y/v]},g.mutual.info=function(e,t,a,n){return g.mutual(e,t,a,n)[0]},g.mutual.dist=function(e,t,a,n){return g.mutual(e,t,a,n)[1]},g.profile=function(e,t){var a=0,n=0,r=0,s=0,d=null,p=null,c=0,m=[],f={},u,y,_,b,k;// compute summary stats
for(_=0;_<e.length;++_)// update unique values
b=t?t(e[_]):e[_],f[b]=b in f?f[b]+1:(s+=1,1),null==b?++r:o.isValid(b)&&(k="string"==typeof b?b.length:b,(null==d||k<d)&&(d=k),(null==p||k>p)&&(p=k),u=k-a,a+=u/++n,c+=u*(k-a),m.push(k));return c/=n-1,y=h(c),m.sort(o.cmp),{type:l(e,t),unique:f,count:e.length,valid:n,missing:r,distinct:s,min:d,max:p,mean:a,stdev:y,median:b=g.quantile(m,.5),q1:g.quantile(m,.25),q3:g.quantile(m,.75),modeskew:0===y?0:(a-b)/y}},g.summary=function(e,t){t=t||o.keys(e[0]);var a=t.map(function(t){var a=g.profile(e,o.$(t));return a.field=t,a});return a.__summary__=!0,a}},{"./generate":17,"./import/type":26,"./util":31}],29:[function(e,t){function n(e){var t=r(e,"d");/* jshint evil: true */return t="var __t; return "+t+";",new Function("d",t).bind(p)}// Generate source code for a template function.
// text: the template text
// variable: the name of the data object variable ('obj' by default)
// properties: optional hash for collecting all accessed properties
function r(e,t,a){t=t||"obj";var n=0,r="'";// Compile the template source, escaping string literals appropriately.
return e.replace(u,function(d,o,l){// Adobe VMs need the match returned to produce the correct offest.
return r+=e.slice(n,l).replace(h,s),n=l+d.length,o&&(r+="'\n+((__t=("+i(o,t,a)+"))==null?'':__t)+\n'"),d}),r+"'"}function i(e,t,r){function s(e){return e=e||"",h?(h=!1,y="String("+y+")"+e):y+=e,y}function l(){return"(typeof "+y+"===\"number\"?new Date("+y+"):"+y+")"}function p(e){var t=x[0];if("'"===t[0]&&"'"===t[t.length-1]||"\""===t[0]&&"\""===t[t.length-1])t=t.slice(1,-1);else throw Error("Format pattern must be quoted: "+t);S=d(t,e),h=!1;var a="number"===e?y:l();y="this.formats["+S+"]("+a+")"}var u=e.match(c),m=u.shift().trim(),h=!0;r&&(r[m]=1);for(var y=n.property(t,m),_=0;_<u.length;++_){var v=u[_],x=null,k,S,w;switch(0<(k=v.indexOf(":"))&&(v=v.slice(0,k),x=u[_].slice(k+1).match(g).map(function(e){return e.trim()})),v=v.trim(),v){case"length":s(".length");break;case"lower":s(".toLowerCase()");break;case"upper":s(".toUpperCase()");break;case"lower-locale":s(".toLocaleLowerCase()");break;case"upper-locale":s(".toLocaleUpperCase()");break;case"trim":s(".trim()");break;case"left":S=o.number(x[0]),s(".slice(0,"+S+")");break;case"right":S=o.number(x[0]),s(".slice(-"+S+")");break;case"mid":S=o.number(x[0]),w=S+o.number(x[1]),s(".slice(+"+S+","+w+")");break;case"slice":S=o.number(x[0]),s(".slice("+S+(1<x.length?","+o.number(x[1]):"")+")");break;case"truncate":S=o.number(x[0]),w=x[1],w="left"!==w&&"middle"!==w&&"center"!==w?"right":w,y="this.truncate("+s()+","+S+",'"+w+"')";break;case"pad":S=o.number(x[0]),w=x[1],w="left"!==w&&"middle"!==w&&"center"!==w?"right":w,y="this.pad("+s()+","+S+",'"+w+"')";break;case"number":p("number");break;case"time":p("time");break;case"time-utc":p("utc");break;case"month":y="this.month("+y+")";break;case"month-abbrev":y="this.month("+y+",true)";break;case"day":y="this.day("+y+")";break;case"day-abbrev":y="this.day("+y+",true)";break;case"quarter":y="this.quarter("+y+")";break;case"quarter-utc":y="this.utcQuarter("+y+")";break;default:throw Error("Unrecognized template filter: "+v);}}return y}function s(e){return"\\"+m[e]}function d(e,t){var a=t+":"+e;if(null==p.format_map[a]){var n=l[t](e),r=p.formats.length;return p.formats.push(n),p.format_map[a]=r,r}return p.format_map[a]}var o=e("./util"),l=e("./format"),p={formats:[],format_map:{},truncate:o.truncate,pad:o.pad,day:l.day,month:l.month,quarter:l.quarter,utcQuarter:l.utcQuarter};n.source=r,n.context=p,n.format=function(e,t){return p.formats[d(e,t)]},t.exports=n,n.clearFormatCache=function(){p.formats=[],p.format_map={}},n.property=function(e,t){var a=o.field(t).map(o.str).join("][");return e+"["+a+"]"};var u=/\{\{(.+?)\}\}|$/g,c=/(?:"[^"]*"|\'[^\']*\'|[^\|"]+|[^\|\']+)+/g,g=/(?:"[^"]*"|\'[^\']*\'|[^,"]+|[^,\']+)+/g,m={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},h=/\\|'|\r|\n|\u2028|\u2029/g;// Certain characters need to be escaped so that they can be put into a
// string literal.
},{"./format":16,"./util":31}],30:[function(e,t){function a(e){return o.setTime(+e),o}// create a time unit entry
function n(t,a,n,r,i,s){var d={type:t,date:a,unit:n};return r?d.step=r:d.minstep=1,null!=i&&(d.min=i),null!=s&&(d.max=s),d}function r(e,t,a,r,i,s){return n(e,function(e){return t.offset(a,e)},function(e){return t.count(a,e)},r,i,s)}function i(e,t,a,r){var s=g[0],d,o,l;for(d=1,o=g.length;d<o;++d)if(s=g[d],t>s[0]){if(l=t/s[0],l>r)return e[g[d-1][1]];if(l>=a)return e[s[1]]}return e[g[o-1][1]]}function s(e){var t={},a,r;for(a=0,r=e.length;a<r;++a)t[e[a].type]=e[a];return t.find=function(t,a,n){return i(e,t,a,n)},t}var d=e("d3-time"),o=new Date,l=new Date(0,0,1).setFullYear(0),// Jan 1, 0 AD
p=new Date(Date.UTC(0,0,1)).setUTCFullYear(0),u=[r("second",d.second,l),r("minute",d.minute,l),r("hour",d.hour,l),r("day",d.day,l,[1,7]),r("month",d.month,l,[1,3,6]),r("year",d.year,l),// periodic units
n("seconds",function(e){return new Date(1970,0,1,0,0,e)},function(e){return a(e).getSeconds()},null,0,59),n("minutes",function(e){return new Date(1970,0,1,0,e)},function(e){return a(e).getMinutes()},null,0,59),n("hours",function(e){return new Date(1970,0,1,e)},function(e){return a(e).getHours()},null,0,23),n("weekdays",function(e){return new Date(1970,0,4+e)},function(e){return a(e).getDay()},[1],0,6),n("dates",function(e){return new Date(1970,0,e)},function(e){return a(e).getDate()},[1],1,31),n("months",function(e){return new Date(1970,e%12,1)},function(e){return a(e).getMonth()},[1],0,11)],c=[r("second",d.utcSecond,p),r("minute",d.utcMinute,p),r("hour",d.utcHour,p),r("day",d.utcDay,p,[1,7]),r("month",d.utcMonth,p,[1,3,6]),r("year",d.utcYear,p),// periodic units
n("seconds",function(e){return new Date(Date.UTC(1970,0,1,0,0,e))},function(e){return a(e).getUTCSeconds()},null,0,59),n("minutes",function(e){return new Date(Date.UTC(1970,0,1,0,e))},function(e){return a(e).getUTCMinutes()},null,0,59),n("hours",function(e){return new Date(Date.UTC(1970,0,1,e))},function(e){return a(e).getUTCHours()},null,0,23),n("weekdays",function(e){return new Date(Date.UTC(1970,0,4+e))},function(e){return a(e).getUTCDay()},[1],0,6),n("dates",function(e){return new Date(Date.UTC(1970,0,e))},function(e){return a(e).getUTCDate()},[1],1,31),n("months",function(e){return new Date(Date.UTC(1970,e%12,1))},function(e){return a(e).getUTCMonth()},[1],0,11)],g=[[31536e6,5],// 1-year
[7776e6,4],// 3-month
[2592e6,4],// 1-month
[12096e5,3],// 2-week
[6048e5,3],// 1-week
[1728e5,3],// 2-day
[864e5,3],// 1-day
[432e5,2],// 12-hour
[216e5,2],// 6-hour
[108e5,2],// 3-hour
[36e5,2],// 1-hour
[18e5,1],// 30-minute
[9e5,1],// 15-minute
[3e5,1],// 5-minute
[6e4,1],// 1-minute
[3e4,0],// 30-second
[15e3,0],// 15-second
[5e3,0],// 5-second
[1e3,0]// 1-second
];t.exports=s(u),t.exports.utc=s(c)},{"d3-time":6}],31:[function(e,t){(function(e){function a(e,t){var a="",n;for(n=0;n<e;++n)a+=t;return a}function n(e,t,a){var n=0,r=e.split(d);return e=a?(r=r.reverse()).filter(function(e){return n+=e.length,n<=t}).reverse():r.filter(function(e){return n+=e.length,n<=t}),e.length?e.join("").trim():r[0].slice(0,t)}var r=t.exports;// utility functions
r.namedfunc=function(e,t){return t.__name__=e,t},r.name=function(e){return null==e?null:e.__name__},r.identity=function(e){return e},r.true=r.namedfunc("true",function(){return!0}),r.false=r.namedfunc("false",function(){return!1}),r.duplicate=function(e){return JSON.parse(JSON.stringify(e))},r.equal=function(e,t){return JSON.stringify(e)===JSON.stringify(t)},r.extend=function(e){for(var t=1,a=arguments.length,n,r;t<a;++t)for(r in n=arguments[t],n)e[r]=n[r];return e},r.length=function(e){return null!=e&&null!=e.length?e.length:null},r.keys=function(e){var t=[],a;for(a in e)t.push(a);return t},r.vals=function(e){var t=[],a;for(a in e)t.push(e[a]);return t},r.toMap=function(e,t){return(t=r.$(t))?e.reduce(function(e,a){return e[t(a)]=1,e},{}):e.reduce(function(e,t){return e[t]=1,e},{})},r.keystr=function(e){// use to ensure consistent key generation across modules
var t=e.length;if(!t)return"";for(var a=e[0]+"",n=1;n<t;++n)a+="|"+(e[n]+"");return a};// type checking functions
var i=Object.prototype.toString;r.isObject=function(e){return e===Object(e)},r.isFunction=function(e){return"[object Function]"===i.call(e)},r.isString=function(e){return"string"==typeof value||"[object String]"===i.call(e)},r.isArray=Array.isArray||function(e){return"[object Array]"===i.call(e)},r.isNumber=function(e){return"number"==typeof e||"[object Number]"===i.call(e)},r.isBoolean=function(e){return!0===e||!1===e||"[object Boolean]"==i.call(e)},r.isDate=function(e){return"[object Date]"===i.call(e)},r.isValid=function(e){return null!=e&&e===e},r.isBuffer="function"==typeof e&&e.isBuffer||r.false,r.number=function(e){return null==e||""===e?null:+e},r.boolean=function(e){return null==e||""===e?null:"false"!=e&&!!e},r.date=function(e,t){var a=t?t:Date;return null==e||""===e?null:a.parse(e)},r.array=function(e){return null==e?[]:r.isArray(e)?e:[e]},r.str=function(e){return r.isArray(e)?"["+e.map(r.str)+"]":r.isObject(e)||r.isString(e)?// Output valid JSON and JS source strings.
// See http://timelessrepo.com/json-isnt-a-javascript-subset
JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e};// data access functions
var s=/\[(.*?)\]|[^.\[]+/g;r.field=function(e){return(e+"").match(s).map(function(e){return"["===e[0]?"'"!==e[1]&&"\""!==e[1]?e.slice(1,-1):e.slice(2,-2).replace(/\\(["'])/g,"$1"):e})},r.accessor=function(e){/* jshint evil: true */return null==e||r.isFunction(e)?e:r.namedfunc(e,Function("x","return x["+r.field(e).map(r.str).join("][")+"];"))},r.$=r.accessor,r.mutator=function(e){var t;return r.isString(e)&&1<(t=r.field(e)).length?function(e,a){for(var n=0;n<t.length-1;++n)e=e[t[n]];e[t[n]]=a}:function(t,a){t[e]=a}},r.$func=function(e,t){return function(a){a=r.$(a)||r.identity;var i=e+(r.name(a)?"_"+r.name(a):"");return r.namedfunc(i,function(e){return t(a(e))})}},r.$valid=r.$func("valid",r.isValid),r.$length=r.$func("length",r.length),r.$in=function(e,t){e=r.$(e);var a=r.isArray(t)?r.toMap(t):t;return function(t){return!!a[e(t)]}},r.comparator=function(e){var t=[];return void 0===e&&(e=[]),e=r.array(e).map(function(e){var a=1;return"-"===e[0]?(a=-1,e=e.slice(1)):"+"===e[0]&&(a=1,e=e.slice(1)),t.push(a),r.accessor(e)}),function(s,a){var d,o,l,p;for(d=0,o=e.length;d<o;++d)if(l=e[d],p=r.cmp(l(s),l(a)),p)return p*t[d];return 0}},r.cmp=function(e,t){return(e<t||null==e)&&null!=t?-1:(e>t||null==t)&&null!=e?1:(t=t instanceof Date?+t:t,e=e instanceof Date?+e:e)!==e&&t===t?-1:t!==t&&e===e?1:0},r.numcmp=function(e,t){return e-t},r.stablesort=function(e,t,n){var r=e.reduce(function(e,t,a){return e[n(t)]=a,e},{});return e.sort(function(e,a){var i=t(e),s=t(a);return i<s?-1:i>s?1:r[n(e)]-r[n(a)]}),e},r.permute=function(e){for(var t=e.length,a,n;t;)n=T(Math.random()*t--),a=e[t],e[t]=e[n],e[n]=a},r.pad=function(e,t,n,r){r=r||" ";var i=t-e.length;if(0>=i)return e;return"left"===n?a(i,r)+e:"middle"===n||"center"===n?a(T(i/2),r)+e+a(y(i/2),r):e+a(i,r)},r.truncate=function(e,t,a,r,i){var s=e.length;if(s<=t)return e;i=i===void 0?"\u2026":i+"";var d=A(0,t-i.length);switch(a){case"left":return i+(r?n(e,d,1):e.slice(s-d));case"middle":case"center":var o=y(d/2),l=T(d/2);return(r?n(e,o):e.slice(0,o))+i+(r?n(e,l,1):e.slice(s-l));default:return(r?n(e,d):e.slice(0,d))+i;}};var d=/([\u0009\u000A\u000B\u000C\u000D\u0020\u00A0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u2028\u2029\u3000\uFEFF])/}).call(this,e("buffer").Buffer)},{buffer:2}],32:[function(e,t,a){(function(e,n){"object"==typeof a&&"undefined"!=typeof t?n(a):"function"==typeof E&&E.amd?E(["exports"],n):n(e.topojson=e.topojson||{})})(this,function(e){"use strict";function t(){}function a(e){if(!e)return t;var a=e.scale[0],n=e.scale[1],r=e.translate[0],s=e.translate[1],d,o;return function(e,t){t||(d=o=0),e[0]=(d+=e[0])*a+r,e[1]=(o+=e[1])*n+s}}function n(e){if(!e)return t;var a=e.scale[0],n=e.scale[1],r=e.translate[0],s=e.translate[1],d,o;return function(e,t){t||(d=o=0);var i=v((e[0]-r)/a),l=v((e[1]-s)/n);e[0]=i-d,e[1]=l-o,d=i,o=l}}function r(e,a){for(var n=e.length,r=n-a,s;r<--n;)s=e[r],e[r++]=e[n],e[n]=s}function s(e,t){for(var a=0,n=e.length;a<n;){var r=a+n>>>1;e[r]<t?a=r+1:n=r}return a}function d(e,t){var a={type:"Feature",id:t.id,properties:t.properties||{},geometry:l(e,t)};return null==t.id&&delete a.id,a}function l(e,t){function s(e,t){t.length&&t.pop();for(var i=m[0>e?~e:e],a=0,s=i.length,n;a<s;++a)t.push(n=i[a].slice()),g(n,a);0>e&&r(t,s)}function d(e){return e=e.slice(),g(e,0),e}function l(e){for(var t=[],a=0,r=e.length;a<r;++a)s(e[a],t);return 2>t.length&&t.push(t[0].slice()),t}function p(e){for(var t=l(e);4>t.length;)t.push(t[0].slice());return t}function u(e){return e.map(p)}function c(e){var a=e.type;return"GeometryCollection"===a?{type:a,geometries:e.geometries.map(c)}:a in h?{type:a,coordinates:h[a](e)}:null}var g=a(e.transform),m=e.arcs,h={Point:function(e){return d(e.coordinates)},MultiPoint:function(e){return e.coordinates.map(d)},LineString:function(e){return l(e.arcs)},MultiLineString:function(e){return e.arcs.map(l)},Polygon:function(e){return u(e.arcs)},MultiPolygon:function(e){return e.arcs.map(u)}};return c(t)}function p(e,a){function n(t){var a=e.arcs[0>t?~t:t],n=a[0],r;return e.transform?(r=[0,0],a.forEach(function(e){r[0]+=e[0],r[1]+=e[1]})):r=a[a.length-1],0>t?[r,n]:[n,r]}function r(e,t){for(var a in e){var n=e[a];delete t[n.start],delete n.start,delete n.end,n.forEach(function(e){s[0>e?~e:e]=1}),l.push(n)}}var s={},d={},o={},l=[],p=-1;// Stitch empty arcs first, since they may be subsumed by other arcs.
return a.forEach(function(n,r){var i=e.arcs[0>n?~n:n],s;!(3>i.length)||i[1][0]||i[1][1]||(s=a[++p],a[p]=n,a[r]=s)}),a.forEach(function(t){var a=n(t),e=a[0],r=a[1],i,s;if(i=o[e]){if(delete o[i.end],i.push(t),i.end=r,s=d[r]){delete d[s.start];var l=s===i?i:i.concat(s);d[l.start=i.start]=o[l.end=s.end]=l}else d[i.start]=o[i.end]=i;}else if(!(i=d[r]))i=[t],d[i.start=e]=o[i.end=r]=i;else if(delete d[i.start],i.unshift(t),i.start=e,s=o[e]){delete o[s.end];var p=s===i?i:s.concat(i);d[p.start=s.start]=o[p.end=i.end]=p}else d[i.start]=o[i.end]=i}),r(o,d),r(d,o),a.forEach(function(e){s[0>e?~e:e]||l.push([e])}),l}function u(e,t,a){function r(e){var t=0>e?~e:e;(c[t]||(c[t]=[])).push({i:e,g:m})}function s(e){e.forEach(r)}function d(e){e.forEach(s)}function l(e){"GeometryCollection"===e.type?e.geometries.forEach(l):e.type in g&&(m=e,g[e.type](e.arcs))}var u=[];if(1<arguments.length){var c=[],g={LineString:s,MultiLineString:d,Polygon:d,MultiPolygon:function(e){e.forEach(d)}},m;l(t),c.forEach(3>arguments.length?function(e){u.push(e[0].i)}:function(e){a(e[0].g,e[e.length-1].g)&&u.push(e[0].i)})}else for(var h=0,o=e.arcs.length;h<o;++h)u.push(h);return{type:"MultiLineString",arcs:p(e,u)}}function c(e){var t=e[0],a=e[1],n=e[2];return L((t[0]-n[0])*(a[1]-t[1])-(t[0]-a[0])*(n[1]-t[1]))}function g(e){for(var t=-1,r=e.length,n=e[r-1],s=0,d;++t<r;)d=n,n=e[t],s+=d[0]*n[1]-d[1]*n[0];return s/2}function m(e,t){function a(e){e.forEach(function(t){t.forEach(function(t){(i[t=0>t?~t:t]||(i[t]=[])).push(e)})}),s.push(e)}function r(t){return L(g(l(e,{type:"Polygon",arcs:[t]}).coordinates[0]))}var i={},s=[],d=[];return t.forEach(function(e){"Polygon"===e.type?a(e.arcs):"MultiPolygon"===e.type&&e.arcs.forEach(a)}),s.forEach(function(e){if(!e._){var t=[],a=[e];for(e._=1,d.push(t);e=a.pop();)t.push(e),e.forEach(function(e){e.forEach(function(e){i[0>e?~e:e].forEach(function(e){e._||(e._=1,a.push(e))})})})}}),s.forEach(function(e){delete e._}),{type:"MultiPolygon",arcs:d.map(function(a){var s=[],d;// Extract the exterior (unique) arcs.
// If more than one ring is returned,
// at most one of these rings can be the exterior;
// choose the one with the greatest absolute area.
if(a.forEach(function(e){e.forEach(function(e){e.forEach(function(e){2>i[0>e?~e:e].length&&s.push(e)})})}),s=p(e,s),1<(d=s.length))for(var o=1,l=r(s[0]),u,c;o<d;++o)(u=r(s[o]))>l&&(c=s[0],s[0]=s[o],s[o]=c,l=u);return s})}}function h(e){function t(e,t){e.forEach(function(e){0>e&&(e=~e);var n=d[e];n?n.push(t):d[e]=[t]})}function a(e,a){e.forEach(function(e){t(e,a)})}function r(e,t){"GeometryCollection"===e.type?e.geometries.forEach(function(e){r(e,t)}):e.type in l&&l[e.type](e.arcs,t)}var d={},// arc index -> array of object indexes
o=e.map(function(){return[]}),l={LineString:t,MultiLineString:a,Polygon:a,MultiPolygon:function(e,t){e.forEach(function(e){a(e,t)})}};for(var p in e.forEach(r),d)for(var u=d[p],c=u.length,g=0;g<c;++g)for(var m=g+1;m<c;++m){var h=u[g],f=u[m],y;(y=o[h])[p=s(y,f)]!==f&&y.splice(p,0,f),(y=o[f])[p=s(y,h)]!==h&&y.splice(p,0,h)}return o}function f(e,t){return e[1][2]-t[1][2]}function y(){function e(e,t){for(;0<t;){var a=(t+1>>1)-1,r=n[a];if(0<=f(e,r))break;n[r._=t]=r,n[e._=t=a]=e}}function t(e,t){for(;;){var a=t+1<<1,r=a-1,d=t,o=n[d];if(r<s&&0>f(n[r],o)&&(o=n[d=r]),a<s&&0>f(n[a],o)&&(o=n[d=a]),d===t)break;n[o._=t]=o,n[e._=t=d]=e}}var a={},n=[],s=0;return a.push=function(t){return e(n[t._=s]=t,s++),s},a.pop=function(){if(!(0>=s)){var e=n[0],a;return 0<--s&&(a=n[s],t(n[a._=0]=a,0)),e}},a.remove=function(a){var r=a._,i;if(n[r]===a)return r!==--s&&(i=n[s],(0>f(i,a)?e:t)(n[i._=r]=i,r)),r;// invalid request
},a}e.version="1.6.27",e.mesh=function(e){return l(e,u.apply(this,arguments))},e.meshArcs=u,e.merge=function(e){return l(e,m.apply(this,arguments))},e.mergeArcs=m,e.feature=function(e,t){return"GeometryCollection"===t.type?{type:"FeatureCollection",features:t.geometries.map(function(t){return d(e,t)})}:d(e,t)},e.neighbors=h,e.presimplify=function(e,t){function r(e){o.remove(e),e[1][2]=t(e),o.push(e)}var s=a(e.transform),d=n(e.transform),o=y();return t||(t=c),e.arcs.forEach(function(e){var a=[],l=0,u,c,g,m;// To store each points effective area, we create a new array rather than
// extending the passed-in point to workaround a Chrome/V8 bug (getting
// stuck in smi mode). For midpoints, the initial effective area of
// Infinity will be computed in the next step.
for(c=0,g=e.length;c<g;++c)m=e[c],s(e[c]=[m[0],m[1],1/0],c);for(c=1,g=e.length-1;c<g;++c)u=e.slice(c-1,c+2),u[1][2]=t(u),a.push(u),o.push(u);for(c=0,g=a.length;c<g;++c)u=a[c],u.previous=a[c-1],u.next=a[c+1];for(;u=o.pop();){var h=u.previous,f=u.next;// If the area of the current point is less than that of the previous point
// to be eliminated, use the latter's area instead. This ensures that the
// current point cannot be eliminated without eliminating previously-
// eliminated points.
u[1][2]<l?u[1][2]=l:l=u[1][2],h&&(h.next=f,h[2]=u[2],r(h)),f&&(f.previous=h,f[0]=u[0],r(f))}e.forEach(d)}),e},Object.defineProperty(e,"__esModule",{value:!0})})},{}],33:[function(e,t){function a(e,t){t.stamp=e?e.stamp:0,t.sort=e?e.sort:null,t.facet=e?e.facet:null,t.trans=e?e.trans:null,t.dirty=e?e.dirty:[],t.request=e?e.request:null;for(var a=0,s=r.length,n;a<s;++a)t[n=r[a]]=e?e[n]:{}}var r=e("./Dependencies").ALL;t.exports={create:function(e,t){var n={};return a(e,n),n.add=[],n.mod=[],n.rem=[],n.reflow=t,n},copy:a}},{"./Dependencies":36}],34:[function(e,t){function a(e){i.init.call(this,e),this._data=[],this.router(!0).collector(!0)}var n=e("vega-logging"),r=e("./Tuple"),i=e("./Node").prototype,s=e("./ChangeSet"),d=a.prototype=Object.create(i);d.constructor=a,d.data=function(){return this._data},d.evaluate=function(e){n.debug(e,["collecting"]);// Create a new output changeset to prevent pollution when the Graph
// merges reflow and regular changesets.
var t=s.create(e);return e.rem.length&&(this._data=r.idFilter(this._data,e.rem),t.rem=e.rem.slice(0)),e.add.length&&(this._data=this._data.concat(e.add),t.add=e.add.slice(0)),e.mod.length&&(t.mod=e.mod.slice(0)),e.sort&&this._data.sort(e.sort),e.reflow&&(t.mod=t.mod.concat(r.idFilter(this._data,t.add,t.mod,t.rem)),t.reflow=!1),t},t.exports=a},{"./ChangeSet":33,"./Node":39,"./Tuple":41,"vega-logging":49}],35:[function(e,t){// jshint ignore:line
function a(e,t,a){// Output changeset
// Pipeline of transformations.
// Collector to materialize output of pipeline.
this._graph=e,this._name=t,this._data=[],this._source=null,this._facet=a,this._input=o.create(),this._output=null,this._indexes={},this._indexFields=[],this._inputNode=null,this._outputNode=null,this._pipeline=null,this._collector=null,this._mutates=!1}// Input node applies the datasource's delta, and propagates it to
// the rest of the pipeline. It receives touches to reflow data.
function n(e){var t=new u(e._graph).router(!0).collector(!0);return t.data=function(){return e._data},t.evaluate=function(t){d.debug(t,["input",e._name]);var a=e._input,n=o.create(t),r;// Delta might contain fields updated through API
for(r in a.fields)n.fields[r]=1;// update data
return a.rem.length&&(e._data=p.idFilter(e._data,a.rem)),a.add.length&&(e._data=e._data.concat(a.add)),a.sort&&e._data.sort(a.sort),t.reflow&&(a.mod=a.mod.concat(p.idFilter(e._data,a.add,a.mod,a.rem))),e._input=o.create(),n.add=a.add,n.mod=a.mod,n.rem=a.rem,n.facet=e._facet,n},t}// Output node captures the last changeset seen by this datasource
// (needed for joins and builds) and materializes any nested data.
// If this datasource is faceted, materializes the values in the facet.
function r(e){function t(t){var a=e._indexFields,n,r,d,o,l,u;for(n=0;n<a.length;++n){for(o=a[n],l=e._indexes[o],d=s.$(o),r=0;r<t.add.length;++r)u=d(t.add[r]),p.prev_init(t.add[r]),l[u]=(l[u]||0)+1;for(r=0;r<t.rem.length;++r)u=d(t.rem[r]),l[u]=(l[u]||0)-1;for(r=0;r<t.mod.length;++r)u=d(t.mod[r]._prev),l[u]=(l[u]||0)-1,u=d(t.mod[r]),l[u]=(l[u]||0)+1}}var a=new u(e._graph).router(!0).reflows(!0).collector(!0);return a.data=function(){return e._collector?e._collector.data():e._data},a.evaluate=function(a){d.debug(a,["output",e._name]),t(a);var n=o.create(a,!0);return e._facet&&(e._facet.values=e.values(),a.facet=null),e._output=a,n.data[e._name]=1,n},a}function i(e){var t=new u(e._graph).router(!0);return t.evaluate=function(t){// Tuple derivation carries a cost. So only derive if the pipeline has
// operators that mutate, and thus would override the source data.
if(e.mutates()){var a=e._srcMap||(e._srcMap={}),// to propagate tuples correctly
n=o.create(t);return n.add=t.add.map(function(e){return a[e._id]=p.derive(e)}),n.mod=t.mod.map(function(e){return p.rederive(e,a[e._id])}),n.rem=t.rem.map(function(e){var t=a[e._id];return a[e._id]=null,t}),e._input=n}return e._input=t},t}var s=e("datalib"),d=e("vega-logging"),o=e("./ChangeSet"),l=e("./Collector"),p=e("./Tuple"),u=e("./Node"),c=a.prototype;c.name=function(e){return arguments.length?(this._name=e,this):this._name},c.source=function(e){return arguments.length?this._source=this._graph.data(e):this._source},c.insert=function(e){return this._input.add=this._input.add.concat(e.map(p.ingest)),this},c.remove=function(e){var t=this._data.filter(e);return this._input.rem=this._input.rem.concat(t),this},c.update=function(e,t,a){var n=this._input.mod,r=p.idMap(n);return this._input.fields[t]=1,this._data.filter(e).forEach(function(e){var i=e[t],s=a(e);i!==s&&(p.set(e,t,s),1!==r[e._id]&&(n.push(e),r[e._id]=1))}),this},c.values=function(e){return arguments.length?(this._input.rem=this._data.slice(),e&&this.insert(e),this):this._collector.data();// Replace backing data
},c.mutates=function(e){return arguments.length?(this._mutates=this._mutates||e,this):this._mutates},c.last=function(){return this._output},c.fire=function(e){return e&&(this._input=e),this._graph.propagate(this._input,this._pipeline[0]),this},c.pipeline=function(e){if(!arguments.length)return this._pipeline;var t=this._graph,a;return e.unshift(this._inputNode=n(this)),a=t.preprocess(e),a.router&&e.push(a.collector=new l(t)),e.push(this._outputNode=r(this)),this._collector=a.collector,this._mutates=!!a.mutates,t.connect(this._pipeline=e),this},c.synchronize=function(){return this._graph.synchronize(this._pipeline),this},c.getIndex=function(e){var t=this.values(),a=this._indexes,n=this._indexFields,r=s.$(e),d,o,l,u;if(!a[e])for(a[e]=d={},n.push(e),(o=0,l=t.length);o<l;++o)u=r(t[o]),d[u]=(d[u]||0)+1,p.prev_init(t[o]);return a[e]},c.listener=function(){return i(this).addListener(this._inputNode)},c.addListener=function(e){return e instanceof a?this._collector.addListener(e.listener()):this._outputNode.addListener(e),this},c.removeListener=function(e){this._outputNode.removeListener(e)},c.listeners=function(e){return(e?this._collector:this._outputNode).listeners()},t.exports=a},{"./ChangeSet":33,"./Collector":34,"./Node":39,"./Tuple":41,datalib:27,"vega-logging":49}],36:[function(e,t){var a=t.exports={ALL:["data","fields","scales","signals"]};a.ALL.forEach(function(e){a[e.toUpperCase()]=e})},{}],37:[function(e,t){function a(){}var r=e("datalib"),n=e("vega-logging"),s=e("./Heap"),d=e("./ChangeSet"),o=e("./DataSource"),l=e("./Collector"),p=e("./Tuple"),u=e("./Signal"),c=e("./Dependencies"),g=a.prototype;// Retain for backwards-compatibility
// Retain for backwards-compatibility
// Stamp should be specified with caution. It is necessary for inline datasources,
// which need to be populated during the same cycle even though propagation has
// passed that part of the dataflow graph. 
// If skipSignals is true, Signal nodes do not get reevaluated but their listeners
// are queued for propagation. This is useful when setting signal values in batch
// (e.g., time travel to the initial state).
// Perform final bookkeeping on the graph, after propagation is complete.
//  - For all updated datasources, synchronize their previous values.
// Process a new branch of the dataflow graph prior to connection:
// (1) Insert new Collector nodes as needed.
// (2) Track + return mutation/routing status of the branch.
g.init=function(){this._stamp=0,this._rank=0,this._data={},this._signals={},this._requestedIndexes={},this.doNotPropagate={}},g.rank=function(){return++this._rank},g.values=function(e,t,a){var s=e===c.SIGNALS?this._signals:this._data,d=t===void 0?r.keys(s):t,n,o;if(Array.isArray(d)){for(n=a||{},o=0;o<d.length;++o)n[d[o]]=s[d[o]].values();return n}return s[d].values()},g.dataValues=function(e){return this.values(c.DATA,e)},g.signalValues=function(e){return this.values(c.SIGNALS,e)},g.data=function(e,t,a){var n=this._data;if(!arguments.length){var r=[],i;for(i in n)r.push(n[i]);return r}return 1===arguments.length?n[e]:n[e]=new o(this,e,a).pipeline(t)},g.signal=function(e,t){if(1===arguments.length){var a=this;return Array.isArray(e)?e.map(function(e){return a._signals[e]}):this._signals[e]}return this._signals[e]=new u(this,e,t)},g.signalRef=function(e){Array.isArray(e)||(e=r.field(e));var t=this.signal(e[0]).value();if(1<e.length)for(var a=1,s=e.length;a<s;++a)t=t[e[a]];return t},g.requestIndex=function(e,t){var a=this._requestedIndexes,n=a[e]||(a[e]={});return n[t]=!0,this},g.buildIndexes=function(){var e=this._requestedIndexes,t=r.keys(e),a,n,s,o,l,p,u,c;for(a=0,n=t.length;a<n;++a){if(p=this.data(l=t[a]),!p)throw Error("Data source "+r.str(l)+" does not exist.");for(u=r.keys(e[l]),s=0,o=u.length;s<o;++s)null!==(c=u[s])&&(p.getIndex(c),e[l][c]=null)}return this},g.propagate=function(e,t,a,n){var r={},o=new s(function(e,t){// Sort on qrank (queue-rank).
// Rank can change during propagation due to rewiring.
return e._qrank-t._qrank}),l,p,c,g,m,h,f,y;// new PQ with each propagation cycle so that we can pulse branches
// of the dataflow graph during a propagation (e.g., when creating
// a new inline datasource).
if(e.stamp)throw Error("Pulse already has a non-zero stamp.");for(e.stamp=a||++this._stamp,r[t._id]=e,o.push(t.qrank(!0));0<o.size();)if(t=o.peek(),y=t instanceof u,e=r[t._id],t.rank()!==t.qrank())// A node's rank might change during a propagation. Re-queue if so.
o.replace(t.qrank(!0));else// Propagate the pulse.
if(o.pop(),r[t._id]=null,l=t._listeners,y&&(!y||n)||(e=this.evaluate(e,t)),e!==this.doNotPropagate)for(!e.reflow&&t.reflows()&&(e=d.create(e,!0)),h=0,f=l.length;h<f;++h)if(p=l[h],void 0!==(c=r[p._id])){if(null===c)throw Error("Already propagated to node.");if(c===e)continue;// Re-queueing the same pulse.
// We've already queued this node. Ensure there should be at most one
// pulse with tuples (add/mod/rem), and the remainder will be reflows.
if(g=e.add.length||e.mod.length||e.rem.length,m=c.add.length||c.mod.length||c.rem.length,g&&m)throw Error("Multiple changeset pulses to same node");// Combine reflow and tuples into a single pulse.
r[p._id]=g?e:c,r[p._id].reflow=e.reflow||c.reflow}else// First time we're seeing this node, queue it for propagation.
o.push(p.qrank(!0)),r[p._id]=e;return this.done(e)},g.done=function(e){for(var t in n.debug(e,["bookkeeping"]),e.data)this.data(t).synchronize();return this},g.preprocess=function(e){for(var t=this,a=0,n=0,r,s,d,o;n<e.length;++n)r=e[n],r.batch()&&!r._collector&&(s||!d?(r=new l(t),e.splice(n,0,r),s=!1):r._collector=d),(o=r.collector())&&(d=r),s=s||r.router()&&!o,a=a||r.mutates(),r.produces()&&(e.splice(n+1,0,new l(t)),s=!1);return{router:s,collector:d,mutates:a}},g.connect=function(e){var t,a,s,d,o,l,p,u,g,h;// connect the pipeline
for(o=0,l=e.length;o<l;++o){for(a=e[o],a.collector()&&(t=a),s=a.dependency(c.DATA),(p=0,u=s.length);p<u;++p){if(!(g=this.data(h=s[p])))throw new Error("Unknown data source "+r.str(h));g.addListener(t)}for(d=a.dependency(c.SIGNALS),p=0,u=d.length;p<u;++p){if(!(g=this.signal(h=d[p])))throw new Error("Unknown signal "+r.str(h));g.addListener(t)}0<o&&e[o-1].addListener(a)}return e},g.disconnect=function(e){var t,a,r,s,d,o,l,p;for(d=0,o=e.length;d<o;++d){for(a=e[d],a.collector()&&(t=a),r=a.dependency(c.DATA),(l=0,p=r.length);l<p;++l)this.data(r[l]).removeListener(t);for(s=a.dependency(c.SIGNALS),l=0,p=s.length;l<p;++l)this.signal(s[l]).removeListener(t);a.disconnect()}return e},g.synchronize=function(e){var t={},a,r,s,o,l,u,c,g;for(s=0,o=e.length;s<o;++s)if(a=e[s],a.collector())for(l=0,r=a.data(),u=r.length;l<u;++l)g=(c=r[l])._id,t[g]||(p.prev_update(c),t[g]=1);return this},g.reevaluate=function(e,t){var a=e.reflow&&t.last()>=e.stamp,n=t.router()||e.add.length||e.rem.length;return n||!a||t.reevaluate(e)},g.evaluate=function(e,t){return this.reevaluate(e,t)?(e=t.evaluate(e),t.last(e.stamp),e):e},t.exports=a},{"./ChangeSet":33,"./Collector":34,"./DataSource":35,"./Dependencies":36,"./Heap":38,"./Signal":40,"./Tuple":41,datalib:27,"vega-logging":49}],38:[function(e,t){function a(e){this.cmp=e,this.nodes=[]}function n(e,t,a,n){var r,i,s;for(r=e[a];a>t;){if(s=a-1>>1,i=e[s],0>n(r,i)){e[a]=i,a=s;continue}break}return e[a]=r}function r(e,t,a){for(var r=t,i=e.length,s=e[t],d=2*t+1,o;d<i;)o=d+1,o<i&&0<=a(e[d],e[o])&&(d=o),e[t]=e[d],t=d,d=2*t+1;return e[t]=s,n(e,r,t,a)}var i=a.prototype;i.size=function(){return this.nodes.length},i.clear=function(){return this.nodes=[],this},i.peek=function(){return this.nodes[0]},i.push=function(e){var t=this.nodes;return t.push(e),n(t,0,t.length-1,this.cmp)},i.pop=function(){var e=this.nodes,t=e.pop(),a;return e.length?(a=e[0],e[0]=t,r(e,0,this.cmp)):a=t,a},i.replace=function(e){var t=this.nodes,a=t[0];return t[0]=e,r(t,0,this.cmp),a},i.pushpop=function(e){var t=this.nodes,a=t[0];return t.length&&0>this.cmp(a,e)&&(t[0]=e,e=a,r(t,0,this.cmp)),e},t.exports=a},{}],39:[function(e,t){function a(e){e&&this.init(e)}var r=e("./Dependencies").ALL,s=0,d=a.Flags={Router:1,// Responsible for propagating tuples, cannot be skipped.
Collector:2,// Holds a materialized dataset, pulse node to reflow.
Produces:4,// Produces new tuples. 
Mutates:8,// Sets properties of incoming tuples.
Reflows:16,// Forwards a reflow pulse.
Batch:32// Performs batch data processing, needs collector.
},o=a.prototype;// -- status flags ---
// Evaluate this dataflow node for the current pulse.
// Subclasses should override to perform custom processing.
// Should this node be re-evaluated for the current pulse?
// Searches pulse to see if any dependencies have updated.
o.init=function(e){this._id=++s,this._graph=e,this._rank=e.rank(),this._qrank=null,this._stamp=0,this._listeners=[],this._listeners._ids={},this._deps={};for(var t=0,a=r.length;t<a;++t)this._deps[r[t]]=[];// Initialize status flags.
return this._flags=0,this},o.rank=function(){return this._rank},o.rerank=function(){for(var e=this._graph,t=[this],a;t.length;)a=t.shift(),a._rank=e.rank(),t.unshift.apply(t,a.listeners());return this},o.qrank=function()/* set */{return arguments.length?(this._qrank=this._rank,this):this._qrank},o.last=function(e){return arguments.length?(this._stamp=e,this):this._stamp},o._setf=function(e,t){return t?this._flags|=e:this._flags&=~e,this},o.router=function(e){return arguments.length?this._setf(d.Router,e):this._flags&d.Router},o.collector=function(e){return arguments.length?this._setf(d.Collector,e):this._flags&d.Collector},o.produces=function(e){return arguments.length?this._setf(d.Produces,e):this._flags&d.Produces},o.mutates=function(e){return arguments.length?this._setf(d.Mutates,e):this._flags&d.Mutates},o.reflows=function(e){return arguments.length?this._setf(d.Reflows,e):this._flags&d.Reflows},o.batch=function(e){return arguments.length?this._setf(d.Batch,e):this._flags&d.Batch},o.dependency=function(e,t){var a=this._deps[e],r=a._names||(a._names={});// To prevent dupe deps
// Get dependencies of the given type
if(1===arguments.length)return a;if(null===t)// Clear dependencies of the given type
a.splice(0,a.length),a._names={};else if(!Array.isArray(t)){// Separate this case to avoid cost of array creation
if(r[t])return this;a.push(t),r[t]=1}else for(var n=0,s=t.length,d;n<s;++n)d=t[n],r[d]||(a.push(d),r[d]=1);return this},o.listeners=function(){return this._listeners},o.addListener=function(e){if(!(e instanceof a))throw Error("Listener is not a Node");return this._listeners._ids[e._id]?this:(this._listeners.push(e),this._listeners._ids[e._id]=1,this._rank>e._rank&&e.rerank(),this)},o.removeListener=function(e){if(!this._listeners._ids[e._id])return!1;var t=this._listeners.indexOf(e),a=0<=t;return a&&(this._listeners.splice(t,1),this._listeners._ids[e._id]=null),a},o.disconnect=function(){this._listeners=[],this._listeners._ids={}},o.evaluate=function(e){return e},o.reevaluate=function(e){var t,a,s,d,o,l;for(s=0,d=r.length;s<d;++s)for(t=r[s],a=this._deps[t],(o=0,l=a.length);o<l;++o)if(e[t][a[o]])return!0;return!1},a.reset=function(){s=0},t.exports=a},{"./Dependencies":36}],40:[function(e,t){function a(e,t,a){return i.init.call(this,e),this._name=t,this._value=a,this._verbose=!1,this._handlers=[],this}var n=e("./ChangeSet"),r=e("./Node"),// jshint ignore:line
i=r.prototype,s=a.prototype=Object.create(i);// Alias to value, for shared API with DataSource
s.constructor=a,s.name=function(){return this._name},s.value=function(e){return arguments.length?(this._value=e,this):this._value},s.values=s.value,s.verbose=function(e){return arguments.length?(this._verbose=!!e,this):this._verbose},s.evaluate=function(e){return e.signals[this._name]?e:this._graph.doNotPropagate},s.fire=function(e){e||(e=n.create(null,!0)),e.signals[this._name]=1,this._graph.propagate(e,this)},s.on=function(e){var t=this,a=new r(this._graph);return a.evaluate=function(a){return e(t.name(),t.value()),a},this._handlers.push({handler:e,node:a}),this.addListener(a)},s.off=function(e){var t=this._handlers,a,n;for(a=t.length;0<=--a;)e&&t[a].handler!==e||(n=t.splice(a,1)[0],this.removeListener(n.node));return this},t.exports=a},{"./ChangeSet":33,"./Node":39}],41:[function(e,t){function a(e){return e=e===Object(e)?e:{data:e},e._id=++i,e._prev&&(e._prev=null),e}function n(e,t){t=t||{};for(var a=0,r=e.length;a<r;++a)t[e[a]._id]=1;return t}function r(e,t){for(var a in t=t||{},e)"_prev"!==a&&"_id"!==a&&(t[a]=e[a]);return t}var i=0;t.exports={ingest:a,idMap:n,derive:function(e){return a(r(e))},rederive:function(e,a){return r(e,a)},set:function(e,t,a){return e[t]===a?0:(e[t]=a,1)},prev:function(e){return e._prev||e},prev_init:function(e){e._prev||(e._prev={_id:e._id})},prev_update:function(e){var t=e._prev,a,n;if(t)for(a in e)"_prev"!==a&&"_id"!==a&&(t[a]=(n=e[a])instanceof Object&&n._prev?n._prev:n)},reset:function(){i=0},idFilter:function(e){for(var t={},a=arguments.length;0<--a;)n(arguments[a],t);return e.filter(function(e){return!t[e._id]})}}},{}],42:[function(e,t){t.exports={ChangeSet:e("./ChangeSet"),Collector:e("./Collector"),DataSource:e("./DataSource"),Dependencies:e("./Dependencies"),Graph:e("./Graph"),Node:e("./Node"),Signal:e("./Signal"),Tuple:e("./Tuple"),debug:e("vega-logging").debug}},{"./ChangeSet":33,"./Collector":34,"./DataSource":35,"./Dependencies":36,"./Graph":37,"./Node":39,"./Signal":40,"./Tuple":41,"vega-logging":49}],43:[function(e,t){t.exports=function(){"use strict";/*
				 * Generated by PEG.js 0.9.0.
				 *
				 * http://pegjs.org/
				 */function e(t,a,n,r){this.message=t,this.expected=a,this.found=n,this.location=r,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,e)}function t(t){function a(e){var a=Me[e],n,r;if(a)return a;for(n=e-1;!Me[n];)n--;for(a=Me[n],a={line:a.line,column:a.column,seenCR:a.seenCR};n<e;)r=t.charAt(n),"\n"===r?(!a.seenCR&&a.line++,a.column=1,a.seenCR=!1):"\r"===r||"\u2028"===r||"\u2029"===r?(a.line++,a.column=1,a.seenCR=!0):(a.column++,a.seenCR=!1),n++;return Me[e]=a,a}function n(e,t){var n=a(e),r=a(t);return{start:{offset:e,line:n.line,column:n.column},end:{offset:t,line:r.line,column:r.column}}}function r(e){Ee<De||(Ee>De&&(De=Ee,je=[]),je.push(e))}function i(){var e;return e=s(),e}function s(){var e,a,n,i,o,l;return e=Ee,a=d(),a===v?(Ee=e,e=v):(n=f(),n===v?(Ee=e,e=v):(44===t.charCodeAt(Ee)?(i=",",Ee++):(i=v,r(k)),i===v?(Ee=e,e=v):(o=f(),o===v?(Ee=e,e=v):(l=s(),l===v?(Ee=e,e=v):(Ce=e,a=S(a,l),e=a))))),e===v&&(e=Ee,a=d(),a!==v&&(Ce=e,a=w(a)),e=a),e}function d(){var e,a,n,i,s,l,p,u,c,g,m,h,y,_;return e=Ee,91===t.charCodeAt(Ee)?(a="[",Ee++):(a=v,r(T)),a===v?(Ee=e,e=v):(n=f(),n===v?(Ee=e,e=v):(i=o(),i===v?(Ee=e,e=v):(s=f(),s===v?(Ee=e,e=v):(44===t.charCodeAt(Ee)?(l=",",Ee++):(l=v,r(k)),l===v?(Ee=e,e=v):(p=f(),p===v?(Ee=e,e=v):(u=o(),u===v?(Ee=e,e=v):(c=f(),c===v?(Ee=e,e=v):(93===t.charCodeAt(Ee)?(g="]",Ee++):(g=v,r(A)),g===v?(Ee=e,e=v):(m=f(),m===v?(Ee=e,e=v):(62===t.charCodeAt(Ee)?(h=">",Ee++):(h=v,r(L)),h===v?(Ee=e,e=v):(y=f(),y===v?(Ee=e,e=v):(_=d(),_===v?(Ee=e,e=v):(Ce=e,a=E(i,u,_),e=a))))))))))))),e===v&&(e=o()),e}function o(){var e,t,a,n;if(e=Ee,t=l(),t!==v){if(a=[],n=c(),n!==v)for(;n!==v;)a.push(n),n=c();else a=v;a===v?(Ee=e,e=v):(Ce=e,t=C(t,a),e=t)}else Ee=e,e=v;return e===v&&(e=Ee,t=l(),t!==v&&(Ce=e,t=M(t)),e=t),e}function l(){var e,a,n,i,d;return e=Ee,40===t.charCodeAt(Ee)?(a="(",Ee++):(a=v,r(D)),a===v?(Ee=e,e=v):(n=s(),n===v?(Ee=e,e=v):(41===t.charCodeAt(Ee)?(i=")",Ee++):(i=v,r(j)),i===v?(Ee=e,e=v):(Ce=e,a=P(n),e=a))),e===v&&(e=Ee,64===t.charCodeAt(Ee)?(a="@",Ee++):(a=v,r(I)),a===v?(Ee=e,e=v):(n=g(),n===v?(Ee=e,e=v):(58===t.charCodeAt(Ee)?(i=":",Ee++):(i=v,r(z)),i===v?(Ee=e,e=v):(d=u(),d===v?(Ee=e,e=v):(Ce=e,a=N(n,d),e=a)))),e===v&&(e=Ee,a=p(),a===v?(Ee=e,e=v):(58===t.charCodeAt(Ee)?(n=":",Ee++):(n=v,r(z)),n===v?(Ee=e,e=v):(i=u(),i===v?(Ee=e,e=v):(Ce=e,a=O(a,i),e=a))),e===v&&(e=Ee,a=m(),a===v?(Ee=e,e=v):(58===t.charCodeAt(Ee)?(n=":",Ee++):(n=v,r(z)),n===v?(Ee=e,e=v):(i=u(),i===v?(Ee=e,e=v):(Ce=e,a=U(a,i),e=a))),e===v&&(e=Ee,a=u(),a!==v&&(Ce=e,a=F(a)),e=a,e===v&&(e=Ee,a=g(),a!==v&&(Ce=e,a=R(a)),e=a))))),e}function p(){var e;return"rect"===t.substr(Ee,4)?(e="rect",Ee+=4):(e=v,r(B)),e===v&&("symbol"===t.substr(Ee,6)?(e="symbol",Ee+=6):(e=v,r(q)),e===v&&("path"===t.substr(Ee,4)?(e="path",Ee+=4):(e=v,r(G)),e===v&&("arc"===t.substr(Ee,3)?(e="arc",Ee+=3):(e=v,r($)),e===v&&("area"===t.substr(Ee,4)?(e="area",Ee+=4):(e=v,r(H)),e===v&&("line"===t.substr(Ee,4)?(e="line",Ee+=4):(e=v,r(Y)),e===v&&("rule"===t.substr(Ee,4)?(e="rule",Ee+=4):(e=v,r(V)),e===v&&("image"===t.substr(Ee,5)?(e="image",Ee+=5):(e=v,r(W)),e===v&&("text"===t.substr(Ee,4)?(e="text",Ee+=4):(e=v,r(X)),e===v&&("group"===t.substr(Ee,5)?(e="group",Ee+=5):(e=v,r(J))))))))))),e}function u(){var e;return"mousedown"===t.substr(Ee,9)?(e="mousedown",Ee+=9):(e=v,r(K)),e===v&&("mouseup"===t.substr(Ee,7)?(e="mouseup",Ee+=7):(e=v,r(Z)),e===v&&("click"===t.substr(Ee,5)?(e="click",Ee+=5):(e=v,r(Q)),e===v&&("dblclick"===t.substr(Ee,8)?(e="dblclick",Ee+=8):(e=v,r(ee)),e===v&&("wheel"===t.substr(Ee,5)?(e="wheel",Ee+=5):(e=v,r(te)),e===v&&("keydown"===t.substr(Ee,7)?(e="keydown",Ee+=7):(e=v,r(ae)),e===v&&("keypress"===t.substr(Ee,8)?(e="keypress",Ee+=8):(e=v,r(ne)),e===v&&("keyup"===t.substr(Ee,5)?(e="keyup",Ee+=5):(e=v,r(re)),e===v&&("mousewheel"===t.substr(Ee,10)?(e="mousewheel",Ee+=10):(e=v,r(ie)),e===v&&("mousemove"===t.substr(Ee,9)?(e="mousemove",Ee+=9):(e=v,r(se)),e===v&&("mouseout"===t.substr(Ee,8)?(e="mouseout",Ee+=8):(e=v,r(de)),e===v&&("mouseover"===t.substr(Ee,9)?(e="mouseover",Ee+=9):(e=v,r(oe)),e===v&&("mouseenter"===t.substr(Ee,10)?(e="mouseenter",Ee+=10):(e=v,r(le)),e===v&&("touchstart"===t.substr(Ee,10)?(e="touchstart",Ee+=10):(e=v,r(pe)),e===v&&("touchmove"===t.substr(Ee,9)?(e="touchmove",Ee+=9):(e=v,r(ue)),e===v&&("touchend"===t.substr(Ee,8)?(e="touchend",Ee+=8):(e=v,r(ce)),e===v&&("dragenter"===t.substr(Ee,9)?(e="dragenter",Ee+=9):(e=v,r(ge)),e===v&&("dragover"===t.substr(Ee,8)?(e="dragover",Ee+=8):(e=v,r(me)),e===v&&("dragleave"===t.substr(Ee,9)?(e="dragleave",Ee+=9):(e=v,r(he)))))))))))))))))))),e}function c(){var e,a,n,i;return e=Ee,91===t.charCodeAt(Ee)?(a="[",Ee++):(a=v,r(T)),a===v?(Ee=e,e=v):(n=h(),n===v?(Ee=e,e=v):(93===t.charCodeAt(Ee)?(i="]",Ee++):(i=v,r(A)),i===v?(Ee=e,e=v):(Ce=e,a=fe(n),e=a))),e}function g(){var e,a,n;if(e=Ee,a=[],ye.test(t.charAt(Ee))?(n=t.charAt(Ee),Ee++):(n=v,r(_e)),n!==v)for(;n!==v;)a.push(n),ye.test(t.charAt(Ee))?(n=t.charAt(Ee),Ee++):(n=v,r(_e));else a=v;return a!==v&&(Ce=e,a=ve(a)),e=a,e}function m(){var e,a,n;if(e=Ee,a=[],xe.test(t.charAt(Ee))?(n=t.charAt(Ee),Ee++):(n=v,r(be)),n!==v)for(;n!==v;)a.push(n),xe.test(t.charAt(Ee))?(n=t.charAt(Ee),Ee++):(n=v,r(be));else a=v;return a!==v&&(Ce=e,a=ke(a)),e=a,e}function h(){var e,a,n;if(e=Ee,a=[],Se.test(t.charAt(Ee))?(n=t.charAt(Ee),Ee++):(n=v,r(we)),n!==v)for(;n!==v;)a.push(n),Se.test(t.charAt(Ee))?(n=t.charAt(Ee),Ee++):(n=v,r(we));else a=v;return a!==v&&(Ce=e,a=Te(a)),e=a,e}function f(){var e,a;for(e=[],Ae.test(t.charAt(Ee))?(a=t.charAt(Ee),Ee++):(a=v,r(Le));a!==v;)e.push(a),Ae.test(t.charAt(Ee))?(a=t.charAt(Ee),Ee++):(a=v,r(Le));return e}var y=1<arguments.length?arguments[1]:{},_=this,v={},x={start:i},b=i,k={type:"literal",value:",",description:"\",\""},S=function(e,t){return[e].concat(t)},w=function(e){return[e]},T={type:"literal",value:"[",description:"\"[\""},A={type:"literal",value:"]",description:"\"]\""},L={type:"literal",value:">",description:"\">\""},E=function(e,t,a){return{start:e,middle:a,end:t,str:"["+e.str+", "+t.str+"] > "+a.str}},C=function(e,t){return e.filters=t,e.str+=t.map(function(e){return"["+e+"]"}).join(""),e},M=function(e){return e},D={type:"literal",value:"(",description:"\"(\""},j={type:"literal",value:")",description:"\")\""},P=function(e){return{stream:e,str:"("+e.map(function(e){return e.str}).join(", ")+")"}},I={type:"literal",value:"@",description:"\"@\""},z={type:"literal",value:":",description:"\":\""},N=function(t,a){return{event:a,name:t,str:"@"+t+":"+a}},O=function(t,a){return{event:a,mark:t,str:t+":"+a}},U=function(a,t){return{event:t,target:a,str:a+":"+t}},F=function(t){return{event:t,str:t}},R=function(e){return{signal:e,str:e}},B={type:"literal",value:"rect",description:"\"rect\""},q={type:"literal",value:"symbol",description:"\"symbol\""},G={type:"literal",value:"path",description:"\"path\""},$={type:"literal",value:"arc",description:"\"arc\""},H={type:"literal",value:"area",description:"\"area\""},Y={type:"literal",value:"line",description:"\"line\""},V={type:"literal",value:"rule",description:"\"rule\""},W={type:"literal",value:"image",description:"\"image\""},X={type:"literal",value:"text",description:"\"text\""},J={type:"literal",value:"group",description:"\"group\""},K={type:"literal",value:"mousedown",description:"\"mousedown\""},Z={type:"literal",value:"mouseup",description:"\"mouseup\""},Q={type:"literal",value:"click",description:"\"click\""},ee={type:"literal",value:"dblclick",description:"\"dblclick\""},te={type:"literal",value:"wheel",description:"\"wheel\""},ae={type:"literal",value:"keydown",description:"\"keydown\""},ne={type:"literal",value:"keypress",description:"\"keypress\""},re={type:"literal",value:"keyup",description:"\"keyup\""},ie={type:"literal",value:"mousewheel",description:"\"mousewheel\""},se={type:"literal",value:"mousemove",description:"\"mousemove\""},de={type:"literal",value:"mouseout",description:"\"mouseout\""},oe={type:"literal",value:"mouseover",description:"\"mouseover\""},le={type:"literal",value:"mouseenter",description:"\"mouseenter\""},pe={type:"literal",value:"touchstart",description:"\"touchstart\""},ue={type:"literal",value:"touchmove",description:"\"touchmove\""},ce={type:"literal",value:"touchend",description:"\"touchend\""},ge={type:"literal",value:"dragenter",description:"\"dragenter\""},me={type:"literal",value:"dragover",description:"\"dragover\""},he={type:"literal",value:"dragleave",description:"\"dragleave\""},fe=function(t){return t},ye=/^[a-zA-Z0-9_\-]/,_e={type:"class",value:"[a-zA-Z0-9_-]",description:"[a-zA-Z0-9_-]"},ve=function(e){return e.join("")},xe=/^[a-zA-Z0-9\-_  #.>+~[\]=|\^$*]/,be={type:"class",value:"[a-zA-Z0-9-_  #\\.\\>\\+~\\[\\]=|\\^\\$\\*]",description:"[a-zA-Z0-9-_  #\\.\\>\\+~\\[\\]=|\\^\\$\\*]"},ke=function(e){return e.join("")},Se=/^['"a-zA-Z0-9_().><=! \t-&|~]/,we={type:"class",value:"['\"a-zA-Z0-9_\\(\\)\\.\\>\\<\\=\\! \\t-&|~]",description:"['\"a-zA-Z0-9_\\(\\)\\.\\>\\<\\=\\! \\t-&|~]"},Te=function(e){return e.join("")},Ae=/^[ \t\r\n]/,Le={type:"class",value:"[ \\t\\r\\n]",description:"[ \\t\\r\\n]"},Ee=0,Ce=0,Me=[{line:1,column:1,seenCR:!1}],De=0,je=[],Pe;if("startRule"in y){if(!(y.startRule in x))throw new Error("Can't start parsing from rule \""+y.startRule+"\".");b=x[y.startRule]}if(Pe=b(),Pe!==v&&Ee===t.length)return Pe;throw Pe!==v&&Ee<t.length&&r({type:"end",description:"end of input"}),function(t,a,n,r){return null!==a&&function(e){var t=1;for(e.sort(function(e,t){return e.description<t.description?-1:e.description>t.description?1:0});t<e.length;)e[t-1]===e[t]?e.splice(t,1):t++}(a),new e(null===t?function(e,t){var a=Array(e.length),n,r,s;for(s=0;s<e.length;s++)a[s]=e[s].description;return n=1<e.length?a.slice(0,-1).join(", ")+" or "+a[e.length-1]:a[0],r=t?"\""+function(e){function t(e){return e.charCodeAt(0).toString(16).toUpperCase()}return e.replace(/\\/g,"\\\\").replace(/"/g,"\\\"").replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(e){return"\\x0"+t(e)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(e){return"\\x"+t(e)}).replace(/[\u0100-\u0FFF]/g,function(e){return"\\u0"+t(e)}).replace(/[\u1000-\uFFFF]/g,function(e){return"\\u"+t(e)})}(t)+"\"":"end of input","Expected "+n+" but "+r+" found."}(a,n):t,a,n,r)}(null,je,De<t.length?t.charAt(De):null,De<t.length?n(De,De+1):n(De,De))}return function(e,t){function a(){this.constructor=e}a.prototype=t.prototype,e.prototype=new a}(e,Error),{SyntaxError:e,parse:t}}()},{}],44:[function(e,t){function a(e){var t={},a,r;for(a=0,r=e.length;a<r;++a)t[e[a]]=1;return t}function n(e){var t=[],a;for(a in e)t.push(a);return t}t.exports=function(t){function r(e){var t={code:i(e),globals:n(m),fields:n(h),dataSources:n(f),defs:o};return m={},h={},f={},t}/* istanbul ignore next */function i(e){if("string"==typeof e)return e;var t=_[e.type];if(null==t)throw new Error("Unsupported type: "+e.type);return t(e)}t=t||{};var s=t.constants||e("./constants"),d=(t.functions||e("./functions"))(i),o=t.functionDefs?t.functionDefs(i):{},l=t.idWhiteList?a(t.idWhiteList):null,p=t.idBlackList?a(t.idBlackList):null,u=0,c=t.fieldVar||"datum",g=t.globalVar||"signals",m={},h={},f={},y="function"==typeof g?g:function(e){return g+"[\""+e+"\"]"},_={Literal:function(e){return e.raw},Identifier:function(e){var t=e.name;if(0<u)return t;if(s.hasOwnProperty(t))return s[t];if(l)return l.hasOwnProperty(t)?t:(m[t]=1,y(t));if(p&&p.hasOwnProperty(t))throw new Error("Illegal identifier: "+t);return t},Program:function(e){return e.body.map(i).join("\n")},MemberExpression:function(e){var t=!e.computed,a=i(e.object);t&&(u+=1);var n=i(e.property);return a===c&&(h[n]=1),t&&(u-=1),a+(t?"."+n:"["+n+"]")},CallExpression:function(e){if("Identifier"!==e.callee.type)throw new Error("Illegal callee type: "+e.callee.type);var t=e.callee.name,a=e.arguments,n=d.hasOwnProperty(t)&&d[t];if(!n)throw new Error("Unrecognized function: "+t);return n instanceof Function?n(a,m,h,f):n+"("+a.map(i).join(",")+")"},ArrayExpression:function(e){return"["+e.elements.map(i).join(",")+"]"},BinaryExpression:function(e){return"("+i(e.left)+e.operator+i(e.right)+")"},UnaryExpression:function(e){return"("+e.operator+i(e.argument)+")"},ConditionalExpression:function(e){return"("+i(e.test)+"?"+i(e.consequent)+":"+i(e.alternate)+")"},LogicalExpression:function(e){return"("+i(e.left)+e.operator+i(e.right)+")"},ObjectExpression:function(e){return"{"+e.properties.map(i).join(",")+"}"},Property:function(e){u+=1;var t=i(e.key);return u-=1,t+":"+i(e.value)},ExpressionStatement:function(e){return i(e.expression)}};return r.functions=d,r.functionDefs=o,r.constants=s,r}},{"./constants":45,"./functions":46}],45:[function(e,t){t.exports={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2"}},{}],46:[function(e,t){t.exports=function(e){function t(t,a,n,r){var i=e(a[0]);return n&&(i=n+"("+i+")",0===n.lastIndexOf("new ",0)&&(i="("+i+")")),i+"."+t+(0>r?"":0===r?"()":"("+a.slice(1).map(e).join(",")+")")}function a(e,a,n){return function(r){return t(e,r,a,n)}}return{// MATH functions
isNaN:"isNaN",isFinite:"isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(t){if(3>t.length)throw new Error("Missing arguments to clamp function.");if(3<t.length)throw new Error("Too many arguments to clamp function.");var n=t.map(e);return"Math.max("+n[1]+", Math.min("+n[2]+","+n[0]+"))"},// DATE functions
now:"Date.now",utc:"Date.UTC",datetime:"new Date",date:a("getDate","new Date",0),day:a("getDay","new Date",0),year:a("getFullYear","new Date",0),month:a("getMonth","new Date",0),hours:a("getHours","new Date",0),minutes:a("getMinutes","new Date",0),seconds:a("getSeconds","new Date",0),milliseconds:a("getMilliseconds","new Date",0),time:a("getTime","new Date",0),timezoneoffset:a("getTimezoneOffset","new Date",0),utcdate:a("getUTCDate","new Date",0),utcday:a("getUTCDay","new Date",0),utcyear:a("getUTCFullYear","new Date",0),utcmonth:a("getUTCMonth","new Date",0),utchours:a("getUTCHours","new Date",0),utcminutes:a("getUTCMinutes","new Date",0),utcseconds:a("getUTCSeconds","new Date",0),utcmilliseconds:a("getUTCMilliseconds","new Date",0),// shared sequence functions
length:a("length",null,-1),indexof:a("indexOf",null),lastindexof:a("lastIndexOf",null),// STRING functions
parseFloat:"parseFloat",parseInt:"parseInt",upper:a("toUpperCase","String",0),lower:a("toLowerCase","String",0),slice:a("slice","String"),substring:a("substring","String"),replace:a("replace","String"),// REGEXP functions
regexp:"RegExp",test:a("test","RegExp"),// Control Flow functions
if:function(t){if(3>t.length)throw new Error("Missing arguments to if function.");if(3<t.length)throw new Error("Too many arguments to if function.");var n=t.map(e);return n[0]+"?"+n[1]+":"+n[2]}}}},{}],47:[function(e,t){var a=e("./parser"),n=e("./codegen"),r=t.exports={parse:function(e,t){return a.parse("("+e+")",t)},code:function(e){return n(e)},compiler:function(e,t){e=e.slice();var a=n(t),i=e.length,s=function(t){var n=a(r.parse(t));e[i]="\"use strict\"; return ("+n.code+");";var s=Function.apply(null,e);// call often faster than apply, use if args low enough
return n.fn=8<e.length?function(){return s.apply(n,arguments)}:function(t,a,r,i,d,e,o){return s.call(n,t,a,r,i,d,e,o)},n};return s.codegen=a,s},functions:e("./functions"),constants:e("./constants")}},{"./codegen":44,"./constants":45,"./functions":46,"./parser":48}],48:[function(e,t){/*
			  The following expression parser is based on Esprima (http://esprima.org/).
			  Original header comment and license for Esprima is included here:

			  Copyright (C) 2013 Ariya Hidayat <ariya.hidayat@gmail.com>
			  Copyright (C) 2013 Thaddee Tyl <thaddee.tyl@gmail.com>
			  Copyright (C) 2013 Mathias Bynens <mathias@qiwi.be>
			  Copyright (C) 2012 Ariya Hidayat <ariya.hidayat@gmail.com>
			  Copyright (C) 2012 Mathias Bynens <mathias@qiwi.be>
			  Copyright (C) 2012 Joost-Wim Boekesteijn <joost-wim@boekesteijn.nl>
			  Copyright (C) 2012 Kris Kowal <kris.kowal@cixar.com>
			  Copyright (C) 2012 Yusuke Suzuki <utatane.tea@gmail.com>
			  Copyright (C) 2012 Arpad Borsos <arpad.borsos@googlemail.com>
			  Copyright (C) 2011 Ariya Hidayat <ariya.hidayat@gmail.com>

			  Redistribution and use in source and binary forms, with or without
			  modification, are permitted provided that the following conditions are met:

			    * Redistributions of source code must retain the above copyright
			      notice, this list of conditions and the following disclaimer.
			    * Redistributions in binary form must reproduce the above copyright
			      notice, this list of conditions and the following disclaimer in the
			      documentation and/or other materials provided with the distribution.

			  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
			  AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
			  IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
			  ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> BE LIABLE FOR ANY
			  DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
			  (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
			  LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
			  ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
			  (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
			  THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
			*//* istanbul ignore next */t.exports=function(){"use strict";var ve=String.fromCharCode;// Ensure the condition is true, otherwise throw an error.
// This is only to have a better contract semantic, i.e. another safety net
// to catch a logic error. The condition shall be fulfilled in normal case.
// Do NOT use this to enforce a certain condition on any user input.
function e(e,t){if(!e)throw new Error("ASSERT: "+t)}function t(e){return 48<=e&&57>=e;// 0..9
}function a(e){return 0<="0123456789abcdefABCDEF".indexOf(e)}function n(e){return 0<="01234567".indexOf(e)}// 7.2 White Space
function r(e){return 32===e||9===e||11===e||12===e||160===e||5760<=e&&0<=[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)}// 7.3 Line Terminators
function i(e){return 10===e||13===e||8232===e||8233===e}// 7.6 Identifier Names and Identifiers
function s(e){return 36===e||95===e||// $ (dollar) and _ (underscore)
65<=e&&90>=e||// A..Z
97<=e&&122>=e||// a..z
92===e||// \ (backslash)
128<=e&&Te.NonAsciiIdentifierStart.test(ve(e))}function d(e){return 36===e||95===e||// $ (dollar) and _ (underscore)
65<=e&&90>=e||// A..Z
97<=e&&122>=e||// a..z
48<=e&&57>=e||// 0..9
92===e||// \ (backslash)
128<=e&&Te.NonAsciiIdentifierPart.test(ve(e))}// 7.6.1.2 Future Reserved Words
function o(e){return!("class"!==e&&"enum"!==e&&"export"!==e&&"extends"!==e&&"import"!==e&&"super"!==e)}function l(e){return!("implements"!==e&&"interface"!==e&&"package"!==e&&"private"!==e&&"protected"!==e&&"public"!==e&&"static"!==e&&"yield"!==e&&"let"!==e)}// 7.6.1.1 Keywords
function p(e){if(Le&&l(e))return!0;// 'const' is specialized as Keyword in V8.
// 'yield' and 'let' are for compatiblity with SpiderMonkey and ES.next.
// Some others are from future reserved words.
switch(e.length){case 2:return"if"===e||"in"===e||"do"===e;case 3:return"var"===e||"for"===e||"new"===e||"try"===e||"let"===e;case 4:return"this"===e||"else"===e||"case"===e||"void"===e||"with"===e||"enum"===e;case 5:return"while"===e||"break"===e||"catch"===e||"throw"===e||"const"===e||"yield"===e||"class"===e||"super"===e;case 6:return"return"===e||"typeof"===e||"delete"===e||"switch"===e||"export"===e||"import"===e;case 7:return"default"===e||"finally"===e||"extends"===e;case 8:return"function"===e||"continue"===e||"debugger"===e;case 10:return"instanceof"===e;default:return!1;}}function u(){var e,t;for(t=0===Ee;Ee<De;)if(e=Ae.charCodeAt(Ee),r(e))++Ee;else if(i(e))++Ee,13===e&&10===Ae.charCodeAt(Ee)&&++Ee,++Ce,Me=Ee,t=!0;else break}function c(e){var t=0,n,r,s;for(r="u"===e?4:2,n=0;n<r;++n)if(Ee<De&&a(Ae[Ee]))s=Ae[Ee++],t=16*t+"0123456789abcdef".indexOf(s.toLowerCase());else return"";return ve(t)}function g(){var e,t,n,r;for(e=Ae[Ee],t=0,"}"===e&&F({},we.UnexpectedToken,"ILLEGAL");Ee<De&&(e=Ae[Ee++],!!a(e));)t=16*t+"0123456789abcdef".indexOf(e.toLowerCase());// UTF-16 Encoding
return((1114111<t||"}"!==e)&&F({},we.UnexpectedToken,"ILLEGAL"),65535>=t)?ve(t):(n=(t-65536>>10)+55296,r=(1023&t-65536)+56320,ve(n,r))}function m(){var e,t;for(e=Ae.charCodeAt(Ee++),t=ve(e),92===e&&(117!==Ae.charCodeAt(Ee)&&F({},we.UnexpectedToken,"ILLEGAL"),++Ee,e=c("u"),(!e||"\\"===e||!s(e.charCodeAt(0)))&&F({},we.UnexpectedToken,"ILLEGAL"),t=e);Ee<De&&(e=Ae.charCodeAt(Ee),!!d(e));)++Ee,t+=ve(e),92===e&&(t=t.substr(0,t.length-1),117!==Ae.charCodeAt(Ee)&&F({},we.UnexpectedToken,"ILLEGAL"),++Ee,e=c("u"),(!e||"\\"===e||!d(e.charCodeAt(0)))&&F({},we.UnexpectedToken,"ILLEGAL"),t+=e);return t}function h(){var e,t;for(e=Ee++;Ee<De;){if(t=Ae.charCodeAt(Ee),92===t)return Ee=e,m();if(d(t))++Ee;else break}return Ae.slice(e,Ee)}function f(){var e,t,a;return e=Ee,t=92===Ae.charCodeAt(Ee)?m():h(),a=1===t.length?xe.Identifier:p(t)?xe.Keyword:"null"===t?xe.NullLiteral:"true"===t||"false"===t?xe.BooleanLiteral:xe.Identifier,{type:a,value:t,lineNumber:Ce,lineStart:Me,start:e,end:Ee}}// 7.7 Punctuators
function y(){var e=Ee,t=Ae.charCodeAt(Ee),a=Ae[Ee],n,r,i,s;switch(t){// Check for most common single-character punctuators.
case 46:// . dot
case 40:// ( open bracket
case 41:// ) close bracket
case 59:// ; semicolon
case 44:// , comma
case 123:// { open curly brace
case 125:// } close curly brace
case 91:// [
case 93:// ]
case 58:// :
case 63:// ?
case 126:return++Ee,Ie.tokenize&&(40===t?Ie.openParenToken=Ie.tokens.length:123===t&&(Ie.openCurlyToken=Ie.tokens.length)),{type:xe.Punctuator,value:ve(t),lineNumber:Ce,lineStart:Me,start:e,end:Ee};default:// '=' (U+003D) marks an assignment or comparison operator.
if(n=Ae.charCodeAt(Ee+1),61===n)switch(t){case 43:// +
case 45:// -
case 47:// /
case 60:// <
case 62:// >
case 94:// ^
case 124:// |
case 37:// %
case 38:// &
case 42:return Ee+=2,{type:xe.Punctuator,value:ve(t)+ve(n),lineNumber:Ce,lineStart:Me,start:e,end:Ee};case 33:// !
case 61:return Ee+=2,61===Ae.charCodeAt(Ee)&&++Ee,{type:xe.Punctuator,value:Ae.slice(e,Ee),lineNumber:Ce,lineStart:Me,start:e,end:Ee};}}// 4-character punctuator: >>>=
// Other 2-character punctuators: ++ -- << >> && ||
return(s=Ae.substr(Ee,4),">>>="===s)?(Ee+=4,{type:xe.Punctuator,value:s,lineNumber:Ce,lineStart:Me,start:e,end:Ee}):(i=s.substr(0,3),">>>"===i||"<<="===i||">>="===i)?(Ee+=3,{type:xe.Punctuator,value:i,lineNumber:Ce,lineStart:Me,start:e,end:Ee}):(r=i.substr(0,2),a===r[1]&&0<="+-<>&|".indexOf(a)||"=>"===r?(Ee+=2,{type:xe.Punctuator,value:r,lineNumber:Ce,lineStart:Me,start:e,end:Ee}):0<="<>=!+-*%&|^/".indexOf(a)?(++Ee,{type:xe.Punctuator,value:a,lineNumber:Ce,lineStart:Me,start:e,end:Ee}):void F({},we.UnexpectedToken,"ILLEGAL"));// 3-character punctuators: === !== >>> <<= >>=
// 1-character punctuators: < > = ! + - * % & | ^ /
}// 7.8.3 Numeric Literals
function _(e){for(var t="";Ee<De&&!!a(Ae[Ee]);)t+=Ae[Ee++];return 0===t.length&&F({},we.UnexpectedToken,"ILLEGAL"),s(Ae.charCodeAt(Ee))&&F({},we.UnexpectedToken,"ILLEGAL"),{type:xe.NumericLiteral,value:parseInt("0x"+t,16),lineNumber:Ce,lineStart:Me,start:e,end:Ee}}function v(e){for(var a="0"+Ae[Ee++];Ee<De&&!!n(Ae[Ee]);)a+=Ae[Ee++];return(s(Ae.charCodeAt(Ee))||t(Ae.charCodeAt(Ee)))&&F({},we.UnexpectedToken,"ILLEGAL"),{type:xe.NumericLiteral,value:parseInt(a,8),octal:!0,lineNumber:Ce,lineStart:Me,start:e,end:Ee}}function x(){var a,r,i;if(i=Ae[Ee],e(t(i.charCodeAt(0))||"."===i,"Numeric literal must start with a decimal digit or a decimal point"),r=Ee,a="","."!==i){// Hex number starts with '0x'.
// Octal number starts with '0'.
if(a=Ae[Ee++],i=Ae[Ee],"0"===a){if("x"===i||"X"===i)return++Ee,_(r);if(n(i))return v(r);// decimal number starts with '0' such as '09' is illegal.
i&&t(i.charCodeAt(0))&&F({},we.UnexpectedToken,"ILLEGAL")}for(;t(Ae.charCodeAt(Ee));)a+=Ae[Ee++];i=Ae[Ee]}if("."===i){for(a+=Ae[Ee++];t(Ae.charCodeAt(Ee));)a+=Ae[Ee++];i=Ae[Ee]}if("e"===i||"E"===i)if(a+=Ae[Ee++],i=Ae[Ee],("+"===i||"-"===i)&&(a+=Ae[Ee++]),t(Ae.charCodeAt(Ee)))for(;t(Ae.charCodeAt(Ee));)a+=Ae[Ee++];else F({},we.UnexpectedToken,"ILLEGAL");return s(Ae.charCodeAt(Ee))&&F({},we.UnexpectedToken,"ILLEGAL"),{type:xe.NumericLiteral,value:parseFloat(a),lineNumber:Ce,lineStart:Me,start:r,end:Ee}}// 7.8.4 String Literals
function b(){var t="",a=!1,r,s,d,o,l,p,u,m;for(u=Ce,m=Me,r=Ae[Ee],e("'"===r||"\""===r,"String literal must starts with a quote"),s=Ee,++Ee;Ee<De;)if(d=Ae[Ee++],d===r){r="";break}else if("\\"===d)d=Ae[Ee++],d&&i(d.charCodeAt(0))?(++Ce,"\r"===d&&"\n"===Ae[Ee]&&++Ee,Me=Ee):"u"===d||"x"===d?"{"===Ae[Ee]?(++Ee,t+=g()):(p=Ee,l=c(d),l?t+=l:(Ee=p,t+=d)):"n"===d?t+="\n":"r"===d?t+="\r":"t"===d?t+="\t":"b"===d?t+="\b":"f"===d?t+="\f":"v"===d?t+="\x0B":n(d)?(o="01234567".indexOf(d),0!==o&&(a=!0),Ee<De&&n(Ae[Ee])&&(a=!0,o=8*o+"01234567".indexOf(Ae[Ee++]),0<="0123".indexOf(d)&&Ee<De&&n(Ae[Ee])&&(o=8*o+"01234567".indexOf(Ae[Ee++]))),t+=ve(o)):t+=d;else if(i(d.charCodeAt(0)))break;else t+=d;return""!==r&&F({},we.UnexpectedToken,"ILLEGAL"),{type:xe.StringLiteral,value:t,octal:a,startLineNumber:u,startLineStart:m,lineNumber:Ce,lineStart:Me,start:s,end:Ee}}function k(e,t){var a=e;0<=t.indexOf("u")&&(a=a.replace(/\\u\{([0-9a-fA-F]+)\}/g,function(e,t){return 1114111>=parseInt(t,16)?"x":void F({},we.InvalidRegExp)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));// First, detect invalid regular expressions.
try{new RegExp(a)}catch(t){F({},we.InvalidRegExp)}// Return a regular expression object for this pattern-flag pair, or
// `null` in case the current environment doesn't support the flags it
// uses.
try{return new RegExp(e,t)}catch(e){return null}}function S(){var t,a,n,r,s;for(t=Ae[Ee],e("/"===t,"Regular expression literal must start with a slash"),a=Ae[Ee++],n=!1,r=!1;Ee<De;)if(t=Ae[Ee++],a+=t,"\\"===t)t=Ae[Ee++],i(t.charCodeAt(0))&&F({},we.UnterminatedRegExp),a+=t;else if(i(t.charCodeAt(0)))F({},we.UnterminatedRegExp);else if(n)"]"===t&&(n=!1);else if("/"===t){r=!0;break}else"["===t&&(n=!0);return r||F({},we.UnterminatedRegExp),s=a.substr(1,a.length-2),{value:s,literal:a}}function w(){var e,t,a,n;for(t="",a="";Ee<De&&(e=Ae[Ee],!!d(e.charCodeAt(0)));)if(++Ee,!("\\"===e&&Ee<De))a+=e,t+=e;else if(e=Ae[Ee],"u"===e){if(++Ee,n=Ee,e=c("u"),e)for(a+=e,t+="\\u";n<Ee;++n)t+=Ae[n];else Ee=n,a+="u",t+="\\u";R({},we.UnexpectedToken,"ILLEGAL")}else t+="\\",R({},we.UnexpectedToken,"ILLEGAL");return{value:a,literal:t}}function T(){var e,t,a,n;return je=null,u(),e=Ee,t=S(),a=w(),n=k(t.value,a.value),Ie.tokenize?{type:xe.RegularExpression,value:n,regex:{pattern:t.value,flags:a.value},lineNumber:Ce,lineStart:Me,start:e,end:Ee}:{literal:t.literal+a.literal,value:n,regex:{pattern:t.value,flags:a.value},start:e,end:Ee}}function A(){var e,t,a,n;return u(),e=Ee,t={start:{line:Ce,column:Ee-Me}},a=T(),t.end={line:Ce,column:Ee-Me},Ie.tokenize||(0<Ie.tokens.length&&(n=Ie.tokens[Ie.tokens.length-1],n.range[0]===e&&"Punctuator"===n.type&&("/"===n.value||"/="===n.value)&&Ie.tokens.pop()),Ie.tokens.push({type:"RegularExpression",value:a.literal,regex:a.regex,range:[e,Ee],loc:t})),a}function L(e){return e.type===xe.Identifier||e.type===xe.Keyword||e.type===xe.BooleanLiteral||e.type===xe.NullLiteral}function E(){var e,t;// Using the following algorithm:
// https://github.com/mozilla/sweet.js/wiki/design
if(e=Ie.tokens[Ie.tokens.length-1],!e)// Nothing before that: it cannot be a division.
return A();if("Punctuator"===e.type){if("]"===e.value)return y();if(")"===e.value)return t=Ie.tokens[Ie.openParenToken-1],t&&"Keyword"===t.type&&("if"===t.value||"while"===t.value||"for"===t.value||"with"===t.value)?A():y();if("}"===e.value){// Dividing a function by anything makes little sense,
// but we have to check for that.
if(!(Ie.tokens[Ie.openCurlyToken-3]&&"Keyword"===Ie.tokens[Ie.openCurlyToken-3].type)){if(!(Ie.tokens[Ie.openCurlyToken-4]&&"Keyword"===Ie.tokens[Ie.openCurlyToken-4].type))return y();if(t=Ie.tokens[Ie.openCurlyToken-5],!t)return A()}else if(t=Ie.tokens[Ie.openCurlyToken-4],!t)return y();return y()}return A()}return"Keyword"===e.type&&"this"!==e.value?A():y()}function C(){var e;// Very common: ( and ) and ;
// Dot (.) U+002E can also start a floating-point number, hence the need
// to check the next character.
// Slash (/) U+002F can also start a regex.
return(u(),Ee>=De)?{type:xe.EOF,lineNumber:Ce,lineStart:Me,start:Ee,end:Ee}:(e=Ae.charCodeAt(Ee),s(e)?f():40===e||41===e||59===e?y():39===e||34===e?b():46===e?t(Ae.charCodeAt(Ee+1))?x():y():t(e)?x():Ie.tokenize&&47===e?E():y());// String literal starts with single quote (U+0027) or double quote (U+0022).
}function M(){var e,t,a,n;return u(),e={start:{line:Ce,column:Ee-Me}},t=C(),e.end={line:Ce,column:Ee-Me},t.type!==xe.EOF&&(a=Ae.slice(t.start,t.end),n={type:be[t.type],value:a,range:[t.start,t.end],loc:e},t.regex&&(n.regex={pattern:t.regex.pattern,flags:t.regex.flags}),Ie.tokens.push(n)),t}function D(){var e;return e=je,Ee=e.end,Ce=e.lineNumber,Me=e.lineStart,je="undefined"==typeof Ie.tokens?C():M(),Ee=e.end,Ce=e.lineNumber,Me=e.lineStart,e}function j(){var e,t,a;e=Ee,t=Ce,a=Me,je="undefined"==typeof Ie.tokens?C():M(),Ee=e,Ce=t,Me=a}function P(){this.line=Ce,this.column=Ee-Me}function I(){this.start=new P,this.end=null}function z(e){this.start=e.type===xe.StringLiteral?{line:e.startLineNumber,column:e.start-e.startLineStart}:{line:e.lineNumber,column:e.start-e.lineStart},this.end=null}function N(){// Skip comment.
Ee=je.start,je.type===xe.StringLiteral?(Ce=je.startLineNumber,Me=je.startLineStart):(Ce=je.lineNumber,Me=je.lineStart),Ie.range&&(this.range=[Ee,0]),Ie.loc&&(this.loc=new I)}function O(e){Ie.range&&(this.range=[e.start,0]),Ie.loc&&(this.loc=new z(e))}// Return true if there is a line terminator before the next token.
function U(){var e,t,a,n;return e=Ee,t=Ce,a=Me,u(),n=Ce!==t,Ee=e,Ce=t,Me=a,n}// Throw an exception
function F(t,a){var n=Array.prototype.slice.call(arguments,2),r=a.replace(/%(\d)/g,function(t,a){return e(a<n.length,"Message reference must be in range"),n[a]}),i;throw"number"==typeof t.lineNumber?(i=new Error("Line "+t.lineNumber+": "+r),i.index=t.start,i.lineNumber=t.lineNumber,i.column=t.start-Me+1):(i=new Error("Line "+Ce+": "+r),i.index=Ee,i.lineNumber=Ce,i.column=Ee-Me+1),i.description=r,i}function R(){try{F.apply(null,arguments)}catch(t){if(Ie.errors)Ie.errors.push(t);else throw t}}// Throw an exception because of the token.
function B(e){if(e.type===xe.EOF&&F(e,we.UnexpectedEOS),e.type===xe.NumericLiteral&&F(e,we.UnexpectedNumber),e.type===xe.StringLiteral&&F(e,we.UnexpectedString),e.type===xe.Identifier&&F(e,we.UnexpectedIdentifier),e.type===xe.Keyword){if(o(e.value))F(e,we.UnexpectedReserved);else if(Le&&l(e.value))return void R(e,we.StrictReservedWord);F(e,we.UnexpectedToken,e.value)}// BooleanLiteral, NullLiteral, or Punctuator.
F(e,we.UnexpectedToken,e.value)}// Expect the next token to match the specified punctuator.
// If not, an exception will be thrown.
function q(e){var t=D();(t.type!==xe.Punctuator||t.value!==e)&&B(t)}/**
				 * @name expectTolerant
				 * @description Quietly expect the given token value when in tolerant mode, otherwise delegates
				 * to <code>expect(value)</code>
				 * @param {String} value The value we are expecting the lookahead token to have
				 * @since 2.0
				 */function G(e){if(Ie.errors){var t=je;t.type!==xe.Punctuator&&t.value!==e?R(t,we.UnexpectedToken,t.value):D()}else q(e)}// Return true if the next token matches the specified punctuator.
function $(e){return je.type===xe.Punctuator&&je.value===e}// Return true if the next token matches the specified keyword
function H(e){return je.type===xe.Keyword&&je.value===e}function Y(){var e;// Catch the very common case first: immediately a semicolon (U+003B).
if(59===Ae.charCodeAt(Ee)||$(";"))return void D();e=Ce,u();Ce===e&&(je.type===xe.EOF||$("}")||B(je))}// 11.1.4 Array Initialiser
function V(){var e=[],t=new N;for(q("[");!$("]");)$(",")?(D(),e.push(null)):(e.push(le()),$("]")||q(","));return D(),t.finishArrayExpression(e)}// 11.1.5 Object Initialiser
function W(){var e=new N,t;// Note: This function is called only from parseObjectProperty(), where
// EOF and Punctuator tokens are already filtered out.
return t=D(),t.type===xe.StringLiteral||t.type===xe.NumericLiteral?(Le&&t.octal&&R(t,we.StrictOctalLiteral),e.finishLiteral(t)):e.finishIdentifier(t.value)}function X(){var e=new N,t,a,n,r;return t=je,t.type===xe.Identifier?(n=W(),q(":"),r=le(),e.finishProperty("init",n,r)):t.type===xe.EOF||t.type===xe.Punctuator?void B(t):(a=W(),q(":"),r=le(),e.finishProperty("init",a,r))}function J(){var e=[],t={},a=String,n=new N,r,i,s,d;for(q("{");!$("}");)r=X(),i=r.key.type===ke.Identifier?r.key.name:a(r.key.value),d="init"===r.kind?Se.Data:"get"===r.kind?Se.Get:Se.Set,s="$"+i,Object.prototype.hasOwnProperty.call(t,s)?(t[s]===Se.Data?Le&&d===Se.Data?R({},we.StrictDuplicateProperty):d!==Se.Data&&R({},we.AccessorDataProperty):d===Se.Data?R({},we.AccessorDataProperty):t[s]&d&&R({},we.AccessorGetSet),t[s]|=d):t[s]=d,e.push(r),$("}")||G(",");return q("}"),n.finishObjectExpression(e)}// 11.1.6 The Grouping Operator
function K(){var e;return q("("),++Pe.parenthesisCount,e=pe(),q(")"),e}// 11.1 Primary Expressions
function Z(){var e,t,a,n;if($("("))return K();if($("["))return V();if($("{"))return J();if(e=je.type,n=new N,e===xe.Identifier||ze[je.value])a=n.finishIdentifier(D().value);else if(e===xe.StringLiteral||e===xe.NumericLiteral)Le&&je.octal&&R(je,we.StrictOctalLiteral),a=n.finishLiteral(D());else if(e===xe.Keyword)throw new Error("Disabled.");else e===xe.BooleanLiteral?(t=D(),t.value="true"===t.value,a=n.finishLiteral(t)):e===xe.NullLiteral?(t=D(),t.value=null,a=n.finishLiteral(t)):$("/")||$("/=")?(a="undefined"==typeof Ie.tokens?n.finishLiteral(T()):n.finishLiteral(A()),j()):B(D());return a}// 11.2 Left-Hand-Side Expressions
function Q(){var e=[];if(q("("),!$(")"))for(;Ee<De&&(e.push(le()),!$(")"));)G(",");return q(")"),e}function ee(){var e=new N,t;return t=D(),L(t)||B(t),e.finishIdentifier(t.value)}function te(){return q("."),ee()}function ae(){var e;return q("["),e=pe(),q("]"),e}function ne(){var e=Pe.allowIn,t,a,n,r;for(r=je,Pe.allowIn=!0,t=Z();;)if($("."))n=te(),t=new O(r).finishMemberExpression(".",t,n);else if($("("))a=Q(),t=new O(r).finishCallExpression(t,a);else if($("["))n=ae(),t=new O(r).finishMemberExpression("[",t,n);else break;return Pe.allowIn=e,t}// 11.3 Postfix Expressions
function re(){var e=ne();if(je.type===xe.Punctuator&&($("++")||$("--"))&&!U())throw new Error("Disabled.");return e}// 11.4 Unary Operators
function ie(){var e,t,a;if(je.type!==xe.Punctuator&&je.type!==xe.Keyword)t=re();else if($("++")||$("--"))throw new Error("Disabled.");else if($("+")||$("-")||$("~")||$("!"))a=je,e=D(),t=ie(),t=new O(a).finishUnaryExpression(e.value,t);else if(H("delete")||H("void")||H("typeof"))throw new Error("Disabled.");else t=re();return t}function se(e,t){var a=0;if(e.type!==xe.Punctuator&&e.type!==xe.Keyword)return 0;switch(e.value){case"||":a=1;break;case"&&":a=2;break;case"|":a=3;break;case"^":a=4;break;case"&":a=5;break;case"==":case"!=":case"===":case"!==":a=6;break;case"<":case">":case"<=":case">=":case"instanceof":a=7;break;case"in":a=t?7:0;break;case"<<":case">>":case">>>":a=8;break;case"+":case"-":a=9;break;case"*":case"/":case"%":a=11;break;default:}return a}// 11.5 Multiplicative Operators
// 11.6 Additive Operators
// 11.7 Bitwise Shift Operators
// 11.8 Relational Operators
// 11.9 Equality Operators
// 11.10 Binary Bitwise Operators
// 11.11 Binary Logical Operators
function de(){var e,t,a,n,r,s,d,o,l,p;if(e=je,l=ie(),n=je,r=se(n,Pe.allowIn),0===r)return l;for(n.prec=r,D(),t=[e,je],d=ie(),s=[l,n,d];0<(r=se(je,Pe.allowIn));){// Reduce: make a binary expression from the three topmost entries.
for(;2<s.length&&r<=s[s.length-2].prec;)d=s.pop(),o=s.pop().value,l=s.pop(),t.pop(),a=new O(t[t.length-1]).finishBinaryExpression(o,l,d),s.push(a);// Shift.
n=D(),n.prec=r,s.push(n),t.push(je),a=ie(),s.push(a)}// Final reduce to clean-up the stack.
for(p=s.length-1,a=s[p],t.pop();1<p;)a=new O(t.pop()).finishBinaryExpression(s[p-1].value,s[p-2],a),p-=2;return a}// 11.12 Conditional Operator
function oe(){var e,t,a,n,r;return r=je,e=de(),$("?")&&(D(),t=Pe.allowIn,Pe.allowIn=!0,a=le(),Pe.allowIn=t,q(":"),n=le(),e=new O(r).finishConditionalExpression(e,a,n)),e}// 11.13 Assignment Operators
function le(){var e,t,a,n;return e=Pe.parenthesisCount,n=je,t=je,a=oe(),a}// 11.14 Comma Operator
function pe(){var e=le();if($(","))throw new Error("Disabled.");// no sequence expressions
return e}// 12.4 Expression Statement
function ue(e){var t=pe();return Y(),e.finishExpressionStatement(t)}// 12 Statements
function ce(){var e=je.type,t,a;if(e===xe.EOF&&B(je),e===xe.Punctuator&&"{"===je.value)throw new Error("Disabled.");// block statement
if(a=new N,e===xe.Punctuator)switch(je.value){case";":throw new Error("Disabled.");// empty statement
case"(":return ue(a);default:}else if(e===xe.Keyword)throw new Error("Disabled.");// keyword
return t=pe(),Y(),a.finishExpressionStatement(t)}// 14 Program
function ge(){if(je.type===xe.Keyword)switch(je.value){case"const":case"let":throw new Error("Disabled.");case"function":throw new Error("Disabled.");default:return ce();}return je.type===xe.EOF?void 0:ce()}function me(){for(var e=[],t,a,n,r;Ee<De&&(a=je,a.type===xe.StringLiteral)&&!(t=ge(),e.push(t),t.expression.type!==ke.Literal);)n=Ae.slice(a.start+1,a.end-1),"use strict"===n?(Le=!0,r&&R(r,we.StrictOctalLiteral)):!r&&a.octal&&(r=a);for(;Ee<De&&(t=ge(),"undefined"!=typeof t);)e.push(t);return e}function he(){var e,t;return u(),j(),t=new N,Le=!0,e=me(),t.finishProgram(e)}function fe(){var e=[],t,a,n;for(t=0;t<Ie.tokens.length;++t)a=Ie.tokens[t],n={type:a.type,value:a.value},a.regex&&(n.regex={pattern:a.regex.pattern,flags:a.regex.flags}),Ie.range&&(n.range=a.range),Ie.loc&&(n.loc=a.loc),e.push(n);Ie.tokens=e}function ye(e,t){var a,n;a=String,"string"==typeof e||e instanceof String||(e=a(e)),Ae=e,Ee=0,Ce=0<Ae.length?1:0,Me=0,De=Ae.length,je=null,Pe={allowIn:!0,labelSet:{},inFunctionBody:!1,inIteration:!1,inSwitch:!1,lastCommentStart:-1},Ie={},t=t||{},t.tokens=!0,Ie.tokens=[],Ie.tokenize=!0,Ie.openParenToken=-1,Ie.openCurlyToken=-1,Ie.range="boolean"==typeof t.range&&t.range,Ie.loc="boolean"==typeof t.loc&&t.loc,"boolean"==typeof t.tolerant&&t.tolerant&&(Ie.errors=[]);try{if(j(),je.type===xe.EOF)return Ie.tokens;for(D();je.type!==xe.EOF;)try{D()}catch(e){if(Ie.errors){Ie.errors.push(e);// We have to break on the first error
// to avoid infinite loops.
break}else throw e}fe(),n=Ie.tokens,"undefined"!=typeof Ie.errors&&(n.errors=Ie.errors)}catch(t){throw t}finally{Ie={}}return n}function _e(e,t){var a,n;n=String,"string"==typeof e||e instanceof String||(e=n(e)),Ae=e,Ee=0,Ce=0<Ae.length?1:0,Me=0,De=Ae.length,je=null,Pe={allowIn:!0,labelSet:{},parenthesisCount:0,inFunctionBody:!1,inIteration:!1,inSwitch:!1,lastCommentStart:-1},Ie={},"undefined"!=typeof t&&(Ie.range="boolean"==typeof t.range&&t.range,Ie.loc="boolean"==typeof t.loc&&t.loc,Ie.loc&&null!==t.source&&t.source!==void 0&&(Ie.source=n(t.source)),"boolean"==typeof t.tokens&&t.tokens&&(Ie.tokens=[]),"boolean"==typeof t.tolerant&&t.tolerant&&(Ie.errors=[]));try{a=he(),"undefined"!=typeof Ie.tokens&&(fe(),a.tokens=Ie.tokens),"undefined"!=typeof Ie.errors&&(a.errors=Ie.errors)}catch(t){throw t}finally{Ie={}}return a}var xe,be,ke,Se,we,Te,Ae,Le,Ee,Ce,Me,De,je,Pe,Ie;xe={BooleanLiteral:1,EOF:2,Identifier:3,Keyword:4,NullLiteral:5,NumericLiteral:6,Punctuator:7,StringLiteral:8,RegularExpression:9},be={},be[xe.BooleanLiteral]="Boolean",be[xe.EOF]="<end>",be[xe.Identifier]="Identifier",be[xe.Keyword]="Keyword",be[xe.NullLiteral]="Null",be[xe.NumericLiteral]="Numeric",be[xe.Punctuator]="Punctuator",be[xe.StringLiteral]="String",be[xe.RegularExpression]="RegularExpression",ke={AssignmentExpression:"AssignmentExpression",ArrayExpression:"ArrayExpression",BinaryExpression:"BinaryExpression",CallExpression:"CallExpression",ConditionalExpression:"ConditionalExpression",ExpressionStatement:"ExpressionStatement",Identifier:"Identifier",Literal:"Literal",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",ObjectExpression:"ObjectExpression",Program:"Program",Property:"Property",UnaryExpression:"UnaryExpression"},Se={Data:1,Get:2,Set:4},we={UnexpectedToken:"Unexpected token %0",UnexpectedNumber:"Unexpected number",UnexpectedString:"Unexpected string",UnexpectedIdentifier:"Unexpected identifier",UnexpectedReserved:"Unexpected reserved word",UnexpectedEOS:"Unexpected end of input",NewlineAfterThrow:"Illegal newline after throw",InvalidRegExp:"Invalid regular expression",UnterminatedRegExp:"Invalid regular expression: missing /",InvalidLHSInAssignment:"Invalid left-hand side in assignment",InvalidLHSInForIn:"Invalid left-hand side in for-in",MultipleDefaultsInSwitch:"More than one default clause in switch statement",NoCatchOrFinally:"Missing catch or finally after try",UnknownLabel:"Undefined label '%0'",Redeclaration:"%0 '%1' has already been declared",IllegalContinue:"Illegal continue statement",IllegalBreak:"Illegal break statement",IllegalReturn:"Illegal return statement",StrictModeWith:"Strict mode code may not include a with statement",StrictCatchVariable:"Catch variable may not be eval or arguments in strict mode",StrictVarName:"Variable name may not be eval or arguments in strict mode",StrictParamName:"Parameter name eval or arguments is not allowed in strict mode",StrictParamDupe:"Strict mode function may not have duplicate parameter names",StrictFunctionName:"Function name may not be eval or arguments in strict mode",StrictOctalLiteral:"Octal literals are not allowed in strict mode.",StrictDelete:"Delete of an unqualified identifier in strict mode.",StrictDuplicateProperty:"Duplicate data property in object literal not allowed in strict mode",AccessorDataProperty:"Object literal may not have data and accessor property with the same name",AccessorGetSet:"Object literal may not have multiple get/set accessors with the same name",StrictLHSAssignment:"Assignment to eval or arguments is not allowed in strict mode",StrictLHSPostfix:"Postfix increment/decrement may not have eval or arguments operand in strict mode",StrictLHSPrefix:"Prefix increment/decrement may not have eval or arguments operand in strict mode",StrictReservedWord:"Use of future reserved word in strict mode"},Te={NonAsciiIdentifierStart:/[--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------]/,NonAsciiIdentifierPart:/[--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------]/},O.prototype=N.prototype={finish:function(){Ie.range&&(this.range[1]=Ee),Ie.loc&&(this.loc.end=new P,Ie.source&&(this.loc.source=Ie.source))},finishArrayExpression:function(e){return this.type=ke.ArrayExpression,this.elements=e,this.finish(),this},finishAssignmentExpression:function(e,t,a){return this.type=ke.AssignmentExpression,this.operator=e,this.left=t,this.right=a,this.finish(),this},finishBinaryExpression:function(e,t,a){return this.type="||"===e||"&&"===e?ke.LogicalExpression:ke.BinaryExpression,this.operator=e,this.left=t,this.right=a,this.finish(),this},finishCallExpression:function(e,t){return this.type=ke.CallExpression,this.callee=e,this.arguments=t,this.finish(),this},finishConditionalExpression:function(e,t,a){return this.type=ke.ConditionalExpression,this.test=e,this.consequent=t,this.alternate=a,this.finish(),this},finishExpressionStatement:function(e){return this.type=ke.ExpressionStatement,this.expression=e,this.finish(),this},finishIdentifier:function(e){return this.type=ke.Identifier,this.name=e,this.finish(),this},finishLiteral:function(e){return this.type=ke.Literal,this.value=e.value,this.raw=Ae.slice(e.start,e.end),e.regex&&("//"==this.raw&&(this.raw="/(?:)/"),this.regex=e.regex),this.finish(),this},finishMemberExpression:function(e,t,a){return this.type=ke.MemberExpression,this.computed="["===e,this.object=t,this.property=a,this.finish(),this},finishObjectExpression:function(e){return this.type=ke.ObjectExpression,this.properties=e,this.finish(),this},finishProgram:function(e){return this.type=ke.Program,this.body=e,this.finish(),this},finishProperty:function(e,t,a){return this.type=ke.Property,this.key=t,this.value=a,this.kind=e,this.finish(),this},finishUnaryExpression:function(e,t){return this.type=ke.UnaryExpression,this.operator=e,this.argument=t,this.prefix=!0,this.finish(),this}};var ze={if:1,this:1};return{tokenize:ye,parse:_e}}()},{}],49:[function(e,t){function a(e,t){if(a.enable){var r=Function.prototype.bind.call(console.log,console),i={prevTime:Date.now()-n,stamp:e.stamp};e.add&&(i.add=e.add.length,i.mod=e.mod.length,i.rem=e.rem.length,i.reflow=!!e.reflow),r.apply(console,(t.push(JSON.stringify(i)),t)),n=Date.now()}}var n=Date.now();t.exports={log:function(e){console.log("[Vega Log]",e)},error:function(e){console.error("[Vega Err]",e)},debug:(a.enable=!1,a)}},{}],50:[function(e,t){t.exports={path:e("./path"),render:e("./render"),Item:e("./util/Item"),bound:e("./util/bound"),Bounds:e("./util/Bounds"),canvas:e("./util/canvas"),Gradient:e("./util/Gradient"),toJSON:e("./util/scene").toJSON,fromJSON:e("./util/scene").fromJSON}},{"./path":52,"./render":72,"./util/Bounds":78,"./util/Gradient":80,"./util/Item":82,"./util/bound":83,"./util/canvas":84,"./util/scene":86}],51:[function(e,t){// Copied from Inkscape svgtopdf, thanks!
var a={},n={},r=[].join;t.exports={segments:function(e,t,n,o,p,u,c,g,m){var f=Math.atan2,_=r.call(arguments);if(a[_])return a[_];var v=c*(l/180),x=d(v),b=s(v);n=L(n),o=L(o);var k=.5*(b*(g-e))+.5*(x*(m-t)),S=.5*(b*(m-t))-.5*(x*(g-e)),w=k*k/(n*n)+S*S/(o*o);1<w&&(w=h(w),n*=w,o*=w);var T=b/n,A=x/n,E=-x/o,C=b/o,M=T*g+A*m,D=E*g+C*m,j=T*e+A*t,P=E*e+C*t,I=1/((j-M)*(j-M)+(P-D)*(P-D))-.25;0>I&&(I=0);var z=h(I);u==p&&(z=-z);var N=.5*(M+j)-z*(P-D),O=.5*(D+P)+z*(j-M),U=f(D-O,M-N),F=f(P-O,j-N),R=F-U;0>R&&1===u?R+=2*l:0<R&&0==u&&(R-=2*l);for(var B=y(L(R/(.5*l+.001))),q=[],G=0;G<B;++G){var $=U+G*R/B,H=U+(G+1)*R/B;q[G]=[N,O,$,H,n,o,x,b]}return a[_]=q},bezier:function(e){var a=r.call(e);if(n[a])return n[a];var i=e[0],o=e[1],l=e[2],p=e[3],u=e[4],c=e[5],g=e[6],m=e[7],h=m*u,f=-g*c,y=g*u,_=m*c,v=s(l),x=d(l),b=s(p),k=d(p),S=.5*(p-l),w=d(.5*S),T=8/3*w*w/d(S),t=i+v-T*x,A=o+x+T*v,L=i+b,E=o+k,C=L+T*k,M=E-T*b;return n[a]=[h*t+f*A,y*t+_*A,h*C+f*M,y*C+_*M,h*L+f*E,y*L+_*E]},cache:{segments:a,bezier:n}}},{}],52:[function(e,t){t.exports={parse:e("./parse"),render:e("./render")}},{"./parse":53,"./render":54}],53:[function(e,t){// Path parsing and rendering code adapted from fabric.js -- Thanks!
var a={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},r=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\d)([-+])/g,/\s|,|###/];t.exports=function(e){var t=[],s,d,o,l,p,u,c,g,h,f,y;// First, break path into command sequence
// Next, parse each command in turn
for(s=e.slice().replace(r[0],"###$1").split(r[1]).slice(1),g=0,f=s.length;g<f;++g){for(d=s[g],o=d.slice(1).trim().replace(r[2],"$1###$2").split(r[3]),u=d.charAt(0),l=[u],(h=0,y=o.length);h<y;++h)(p=+o[h])===p&&// not NaN
l.push(p);if(c=a[u.toLowerCase()],l.length-1>c)for(h=1,y=l.length;h<y;h+=c)t.push([u].concat(l.slice(h,h+c)));else t.push(l)}return t}},{}],54:[function(e,t){function a(e,t,a,r){for(var s=n.segments(r[5],// end x
r[6],// end y
r[0],// radius x
r[1],// radius y
r[3],// large flag
r[4],// sweep flag
r[2],// rotation
t,a),d=0,o;d<s.length;++d)o=n.bezier(s[d]),e.bezierCurveTo.apply(e,o)}var n=e("./arc");t.exports=function(e,n,r,s){var// current instruction
d=null,o=0,// current x
p=0,// current y
u=0,// current control point x
c=0,g,// current control point y
m,h,f,_;null==r&&(r=0),null==s&&(s=0),e.beginPath();for(var v=0,b=n.length;v<b;++v){switch(g=n[v],g[0]){// first letter
case"l":o+=g[1],p+=g[2],e.lineTo(o+r,p+s);break;case"L":o=g[1],p=g[2],e.lineTo(o+r,p+s);break;case"h":o+=g[1],e.lineTo(o+r,p+s);break;case"H":o=g[1],e.lineTo(o+r,p+s);break;case"v":p+=g[1],e.lineTo(o+r,p+s);break;case"V":p=g[1],e.lineTo(o+r,p+s);break;case"m":o+=g[1],p+=g[2],e.moveTo(o+r,p+s);break;case"M":o=g[1],p=g[2],e.moveTo(o+r,p+s);break;case"c":m=o+g[5],h=p+g[6],u=o+g[3],c=p+g[4],e.bezierCurveTo(o+g[1]+r,// x1
p+g[2]+s,// y1
u+r,// x2
c+s,// y2
m+r,h+s),o=m,p=h;break;case"C":o=g[5],p=g[6],u=g[3],c=g[4],e.bezierCurveTo(g[1]+r,g[2]+s,u+r,c+s,o+r,p+s);break;case"s":m=o+g[3],h=p+g[4],u=2*o-u,c=2*p-c,e.bezierCurveTo(u+r,c+s,o+g[1]+r,p+g[2]+s,m+r,h+s),u=o+g[1],c=p+g[2],o=m,p=h;break;case"S":m=g[3],h=g[4],u=2*o-u,c=2*p-c,e.bezierCurveTo(u+r,c+s,g[1]+r,g[2]+s,m+r,h+s),o=m,p=h,u=g[1],c=g[2];break;case"q":m=o+g[3],h=p+g[4],u=o+g[1],c=p+g[2],e.quadraticCurveTo(u+r,c+s,m+r,h+s),o=m,p=h;break;case"Q":m=g[3],h=g[4],e.quadraticCurveTo(g[1]+r,g[2]+s,m+r,h+s),o=m,p=h,u=g[1],c=g[2];break;case"t":m=o+g[1],h=p+g[2],null===d[0].match(/[QqTt]/)?(u=o,c=p):"t"===d[0]?(u=2*o-f,c=2*p-_):"q"===d[0]&&(u=2*o-u,c=2*p-c),f=u,_=c,e.quadraticCurveTo(u+r,c+s,m+r,h+s),o=m,p=h,u=o+g[1],c=p+g[2];break;case"T":m=g[1],h=g[2],u=2*o-u,c=2*p-c,e.quadraticCurveTo(u+r,c+s,m+r,h+s),o=m,p=h;break;case"a":a(e,o+r,p+s,[g[1],g[2],g[3],g[4],g[5],g[6]+o+r,g[7]+p+s]),o+=g[6],p+=g[7];break;case"A":a(e,o+r,p+s,[g[1],g[2],g[3],g[4],g[5],g[6]+r,g[7]+s]),o=g[6],p=g[7];break;case"z":case"Z":e.closePath();}d=g}}},{"./arc":51}],55:[function(e,t){function a(){this._active=null,this._handlers={}}var n=a.prototype;// add an event handler
// subclasses should override
// remove an event handler
// subclasses should override
// return an array with all registered event handlers
n.initialize=function(e,t,a){return this._el=e,this._obj=a||null,this.padding(t)},n.element=function(){return this._el},n.padding=function(e){return this._padding=e||{top:0,left:0,bottom:0,right:0},this},n.scene=function(e){return arguments.length?(this._scene=e,this):this._scene},n.on=function()/*type, handler*/{},n.off=function()/*type, handler*/{},n.handlers=function(){var e=this._handlers,t=[],a;for(a in e)t.push.apply(t,e[a]);return t},n.eventName=function(e){var t=e.indexOf(".");return 0>t?e:e.slice(0,t)},t.exports=a},{}],56:[function(e,t){function a(){this._el=null,this._bgcolor=null}var n=a.prototype;// Returns the parent container element for a visualization
// Returns the scene element (e.g., canvas or SVG) of the visualization
// Subclasses must override if the first child is not the scene element
n.initialize=function(e,t,a,n){return this._el=e,this.resize(t,a,n)},n.element=function(){return this._el},n.scene=function(){return this._el&&this._el.firstChild},n.background=function(e){return 0===arguments.length?this._bgcolor:(this._bgcolor=e,this)},n.resize=function(e,t,a){return this._width=e,this._height=t,this._padding=a||{top:0,left:0,bottom:0,right:0},this},n.render=function()/*scene, items*/{return this},t.exports=a},{}],57:[function(e,t){function a(){s.call(this),this._down=null,this._touch=null,this._first=!0}function n(e,t,n){return function(r){var i=this._active,a=this.pickEvent(r);a===i?this.fire(e,r):(this.fire(n,r),this._active=a,this.fire(t,r),this.fire(e,r))}}function r(e){return function(t){this.fire(e,t),this._active=null}}var i=e("../../util/dom"),s=e("../Handler"),d=e("./marks"),o=s.prototype,l=a.prototype=Object.create(o);// retrieve the current canvas context
// supported events
// to keep firefox happy
// fire an event
// add an event handler
// remove an event handler
// find the scenegraph item at the current mouse position
// x, y -- the absolute x, y mouse coordinates on the canvas element
// gx, gy -- the relative coordinates within the current group
l.constructor=a,l.initialize=function(e,t,a){// add event listeners
var n=this._canvas=i.find(e,"canvas");if(n){var r=this;this.events.forEach(function(e){n.addEventListener(e,function(t){l[e]?l[e].call(r,t):r.fire(e,t)})})}return o.initialize.call(this,e,t,a)},l.canvas=function(){return this._canvas},l.context=function(){return this._canvas.getContext("2d")},l.events=["keydown","keypress","keyup","dragenter","dragleave","dragover","mousedown","mouseup","mousemove","mouseout","mouseover","click","dblclick","wheel","mousewheel","touchstart","touchmove","touchend"],l.DOMMouseScroll=function(e){this.fire("mousewheel",e)},l.mousemove=n("mousemove","mouseover","mouseout"),l.dragover=n("dragover","dragenter","dragleave"),l.mouseout=r("mouseout"),l.dragleave=r("dragleave"),l.mousedown=function(e){this._down=this._active,this.fire("mousedown",e)},l.click=function(e){this._down===this._active&&(this.fire("click",e),this._down=null)},l.touchstart=function(e){this._touch=this.pickEvent(e.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire("touchstart",e,!0)},l.touchmove=function(e){this.fire("touchmove",e,!0)},l.touchend=function(e){this.fire("touchend",e,!0),this._touch=null},l.fire=function(e,t,n){var r=n?this._touch:this._active,a=this._handlers[e],s,d;if(a)for(t.vegaType=e,s=0,d=a.length;s<d;++s)a[s].handler.call(this._obj,t,r)},l.on=function(e,t){var a=this.eventName(e),n=this._handlers;return(n[a]||(n[a]=[])).push({type:e,handler:t}),this},l.off=function(e,t){var a=this.eventName(e),n=this._handlers[a],r;if(n){for(r=n.length;0<=--r;)n[r].type===e&&(t&&n[r].handler!==t||n.splice(r,1));return this}},l.pickEvent=function(e){var t=this._canvas.getBoundingClientRect(),a=this._padding,n,r;return this.pick(this._scene,n=e.clientX-t.left,r=e.clientY-t.top,n-a.left,r-a.top)},l.pick=function(e,t,a,n,r){var i=this.context(),s=d[e.marktype];return s.pick.call(this,i,e,t,a,n,r)},t.exports=a},{"../../util/dom":85,"../Handler":55,"./marks":64}],58:[function(e,t){function a(e){l.call(this),this._loader=new d(e)}function n(e,t){if(!t)return null;var a=new s,d,o,l,u,c;for(d=0,o=t.length;d<o;++d)l=t[d],u=l.mark,c=u.group,l=p[u.marktype].nested?u:l,a.union(r(l.bounds,c)),l["bounds:prev"]&&a.union(r(l["bounds:prev"],c));return a.round(),e.beginPath(),e.rect(a.x1,a.y1,a.width(),a.height()),e.clip(),a}function r(e,t){if(null==t)return e;for(var a=e.clone();null!=t;t=t.mark.group)a.translate(t.x||0,t.y||0);return a}var i=e("../../util/dom"),s=e("../../util/Bounds"),d=e("../../util/ImageLoader"),o=e("../../util/canvas"),l=e("../Renderer"),p=e("./marks");a.RETINA=!0;var u=l.prototype,c=a.prototype=Object.create(u);c.constructor=a,c.initialize=function(e,t,a,n){return this._canvas=o.instance(t,a),e&&(i.clear(e,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),u.initialize.call(this,e,t,a,n)},c.resize=function(e,t,n){return u.resize.call(this,e,t,n),o.resize(this._canvas,this._width,this._height,this._padding,a.RETINA),this},c.canvas=function(){return this._canvas},c.context=function(){return this._canvas?this._canvas.getContext("2d"):null},c.pendingImages=function(){return this._loader.pending()},c.render=function(e,t){var a=this.context(),r=this._padding,i=this._width+r.left+r.right,s=this._height+r.top+r.bottom,d;// setup
// clear scene cache
return this._scene=e,a.save(),d=n(a,t),this.clear(-r.left,-r.top,i,s),this.draw(a,e,d),a.restore(),this._scene=null,this},c.draw=function(e,t,a){var n=p[t.marktype];n.draw.call(this,e,t,a)},c.clear=function(e,t,a,n){var r=this.context();r.clearRect(e,t,a,n),null!=this._bgcolor&&(r.fillStyle=this._bgcolor,r.fillRect(e,t,a,n))},c.loadImage=function(e){var t=this,a=this._scene;return this._loader.loadImage(e,function(){t.renderAsync(a)})},c.renderAsync=function(e){// TODO make safe for multiple scene rendering?
var t=this;t._async_id&&clearTimeout(t._async_id),t._async_id=setTimeout(function(){t.render(e),delete t._async_id},10)},t.exports=a},{"../../util/Bounds":78,"../../util/ImageLoader":81,"../../util/canvas":84,"../../util/dom":85,"../Renderer":56,"./marks":64}],59:[function(e,t){t.exports={Handler:e("./CanvasHandler"),Renderer:e("./CanvasRenderer")}},{"./CanvasHandler":57,"./CanvasRenderer":58}],60:[function(e,t){function a(e,t){var a=t.x||0,n=t.y||0,i=t.innerRadius||0,s=t.outerRadius||0,d=(t.startAngle||0)-r,o=(t.endAngle||0)-r;e.beginPath(),0===i?e.moveTo(a,n):e.arc(a,n,i,d,o,0),e.arc(a,n,s,o,d,1),e.closePath()}var n=e("./util"),r=l/2;t.exports={draw:n.drawAll(a),pick:n.pickPath(a)}},{"./util":71}],61:[function(e,t){function a(e,t){var a=t[0],n=a.pathCache||(a.pathCache=r(s(t)));i(e,n)}var n=e("./util"),r=e("../../../path/parse"),i=e("../../../path/render"),s=e("../../../util/svg").path.area,d=n.testPath(a);t.exports={draw:n.drawOne(a),pick:function(e,t,a,n,r,i){var s=t.items,o=t.bounds;return s&&s.length&&(!o||o.contains(r,i))?(null!=e.pixelratio&&1!==e.pixelratio&&(a*=e.pixelratio,n*=e.pixelratio),d(e,s,a,n)?s[0]:null):null},nested:!0}},{"../../../path/parse":53,"../../../path/render":54,"../../../util/svg":87,"./util":71}],62:[function(e,t){var a=e("./util"),n=[];t.exports={draw:function(e,t,r){if(t.items&&t.items.length){var s=t.items,d=this,o,l,p,u,c,g,f,y,_,v,x,b,k;for(v=0,x=s.length;v<x;++v){// draw group contents
for(o=s[v],p=o.axisItems||n,l=o.items||n,u=o.legendItems||n,c=o.x||0,g=o.y||0,f=o.width||0,y=o.height||0,(o.stroke||o.fill)&&(_=null==o.opacity?1:o.opacity,0<_&&(o.fill&&a.fill(e,o,_)&&e.fillRect(c,g,f,y),o.stroke&&a.stroke(e,o,_)&&e.strokeRect(c,g,f,y))),e.save(),e.translate(c,g),o.clip&&(e.beginPath(),e.rect(0,0,f,y),e.clip()),r&&r.translate(-c,-g),(b=0,k=p.length);b<k;++b)"back"===p[b].layer&&d.draw(e,p[b],r);for(b=0,k=l.length;b<k;++b)d.draw(e,l[b],r);for(b=0,k=p.length;b<k;++b)"back"!==p[b].layer&&d.draw(e,p[b],r);for(b=0,k=u.length;b<k;++b)d.draw(e,u[b],r);// restore graphics context
r&&r.translate(c,g),e.restore()}}},pick:function(e,t,a,r,s,d){if(t.bounds&&!t.bounds.contains(s,d))return null;var o=t.items||n,l,p,u,c,g,m,h,f,y,_,v;for(y=o.length;0<=--y;)if(p=o[y],v=p.bounds,!v||v.contains(s,d)){for(u=p.axisItems||n,c=p.items||n,g=p.legendItems||n,h=p.x||0,f=p.y||0,e.save(),e.translate(h,f),h=s-h,f=d-f,_=g.length;0<=--_;)if(l=g[_],!1!==l.interactive&&(m=this.pick(l,a,r,h,f),m))return e.restore(),m;for(_=u.length;0<=--_;)if(l=u[_],!1!==l.interactive&&"back"!==l.layer&&(m=this.pick(l,a,r,h,f),m))return e.restore(),m;for(_=c.length;0<=--_;)if(l=c[_],!1!==l.interactive&&(m=this.pick(l,a,r,h,f),m))return e.restore(),m;for(_=u.length;0<=--_;)if(l=u[_],!1!==l.interative&&"back"===l.layer&&(m=this.pick(l,a,r,h,f),m))return e.restore(),m;if(e.restore(),!1!==t.interactive&&(p.fill||p.stroke)&&0<=h&&h<=p.width&&0<=f&&f<=p.height)return p}// passed bounds check, so test sub-groups
return null}}},{"./util":71}],63:[function(e,t){var a=e("./util");t.exports={draw:function(e,t,a){if(t.items&&t.items.length)for(var n=this,r=t.items,s=0,d=r.length,l;void 0>s;++s)if(l=r[s],!a||a.intersects(l.bounds)){l.image&&l.image.url===l.url||(l.image=n.loadImage(l.url),l.image.url=l.url);var p=l.x||0,u=l.y||0,c=l.width||l.image&&l.image.width||0,g=l.height||l.image&&l.image.height||0,m;p-="center"===l.align?c/2:"right"===l.align?c:0,u-="middle"===l.baseline?g/2:"bottom"===l.baseline?g:0,l.image.loaded&&(e.globalAlpha=null==(m=l.opacity)?1:m,e.drawImage(l.image,p,u,c,g))}// bounds check
},pick:a.pick()}},{"./util":71}],64:[function(e,t){t.exports={arc:e("./arc"),area:e("./area"),group:e("./group"),image:e("./image"),line:e("./line"),path:e("./path"),rect:e("./rect"),rule:e("./rule"),symbol:e("./symbol"),text:e("./text")}},{"./arc":60,"./area":61,"./group":62,"./image":63,"./line":65,"./path":66,"./rect":67,"./rule":68,"./symbol":69,"./text":70}],65:[function(e,t){function a(e,t){var a=t[0],n=a.pathCache||(a.pathCache=r(s(t)));i(e,n)}var n=e("./util"),r=e("../../../path/parse"),i=e("../../../path/render"),s=e("../../../util/svg").path.line,d=n.testPath(a,!1);t.exports={draw:n.drawOne(a),pick:function(e,t,a,n,r,i){var s=t.items,o=t.bounds;return s&&s.length&&(!o||o.contains(r,i))?(null!=e.pixelratio&&1!==e.pixelratio&&(a*=e.pixelratio,n*=e.pixelratio),d(e,s,a,n)?s[0]:null):null},nested:!0}},{"../../../path/parse":53,"../../../path/render":54,"../../../util/svg":87,"./util":71}],66:[function(e,t){function a(e,t){if(null==t.path)return!0;var a=t.pathCache||(t.pathCache=r(t.path));i(e,a,t.x,t.y)}var n=e("./util"),r=e("../../../path/parse"),i=e("../../../path/render");t.exports={draw:n.drawAll(a),pick:n.pickPath(a)}},{"../../../path/parse":53,"../../../path/render":54,"./util":71}],67:[function(e,t){var a=e("./util");t.exports={draw:function(e,t,n){if(t.items&&t.items.length)for(var r=t.items,s=0,d=r.length,l,p,u,c,g,m;void 0>s;++s)l=r[s],n&&!n.intersects(l.bounds)||(p=null==l.opacity?1:l.opacity,0!==p&&(u=l.x||0,c=l.y||0,g=l.width||0,m=l.height||0,l.fill&&a.fill(e,l,p)&&e.fillRect(u,c,g,m),l.stroke&&a.stroke(e,l,p)&&e.strokeRect(u,c,g,m)))},pick:a.pick()}},{"./util":71}],68:[function(e,t){function a(e,t){var a=t.x||0,n=t.y||0,r=null==t.x2?a:t.x2,i=null==t.y2?n:t.y2,s=t.strokeWidth,d=t.strokeCap;e.lineWidth=null==s?1:s,e.lineCap=null==d?"butt":d,e.beginPath(),e.moveTo(a,n),e.lineTo(r,i)}var n=e("./util");t.exports={draw:function(e,t,a){if(t.items&&t.items.length)for(var r=t.items,s=0,d=r.length,l,p,u,c,g,m;void 0>s;++s)l=r[s],a&&!a.intersects(l.bounds)||(p=null==l.opacity?1:l.opacity,0!==p&&(u=l.x||0,c=l.y||0,g=null==l.x2?u:l.x2,m=null==l.y2?c:l.y2,l.stroke&&n.stroke(e,l,p)&&(e.beginPath(),e.moveTo(u,c),e.lineTo(g,m),e.stroke())))},pick:n.pick(function(e,t,n,r){return!!e.isPointInStroke&&(a(e,t),e.isPointInStroke(n,r))})}},{"./util":71}],69:[function(t,a){function n(e,a){var n=null==a.size?100:a.size,s=a.x,o=a.y,g,m,f,y;if(e.beginPath(),null==a.shape||"circle"===a.shape)return g=h(n/l),e.arc(s,o,g,0,2*l,0),void e.closePath();switch(a.shape){case"cross":g=h(n/5)/2,m=3*g,e.moveTo(s-m,o-g),e.lineTo(s-g,o-g),e.lineTo(s-g,o-m),e.lineTo(s+g,o-m),e.lineTo(s+g,o-g),e.lineTo(s+m,o-g),e.lineTo(s+m,o+g),e.lineTo(s+g,o+g),e.lineTo(s+g,o+m),e.lineTo(s-g,o+m),e.lineTo(s-g,o+g),e.lineTo(s-m,o+g);break;case"diamond":y=h(n/(2*c)),f=y*c,e.moveTo(s,o-y),e.lineTo(s+f,o),e.lineTo(s,o+y),e.lineTo(s-f,o);break;case"square":m=h(n),g=m/2,e.rect(s-g,o-g,m,m);break;case"triangle-down":f=h(n/u),y=f*u/2,e.moveTo(s,o+y),e.lineTo(s+f,o-y),e.lineTo(s-f,o-y);break;case"triangle-up":f=h(n/u),y=f*u/2,e.moveTo(s,o-y),e.lineTo(s+f,o+y),e.lineTo(s-f,o+y);break;// custom shape
default:var _=i(d(a.shape),n);p(e,_,s,o);}e.closePath()}// Scale custom shapes (defined within a unit square) by given size.
function i(e,t){var a=h(t),r,s,d,o,l;for(r=0,s=e.length;r<s;++r)for(l=e[r],d=1,o=l.length;d<o;++d)l[d]*=a;return e}var s=t("./util"),d=t("../../../path/parse"),p=t("../../../path/render"),u=h(3),c=e(30*l/180);a.exports={draw:s.drawAll(n),pick:s.pickPath(n)}},{"../../../path/parse":53,"../../../path/render":54,"./util":71}],70:[function(e,t){var a=e("../../../util/Bounds"),n=e("../../../util/bound").text,p=e("../../../util/text"),u=e("./util"),c=new a;t.exports={draw:function(e,a,n){if(a.items&&a.items.length)for(var c=a.items,g=0,m=c.length,h,f,_,v,b,k,S;void 0>g;++g)h=c[g],n&&!n.intersects(h.bounds)||(S=p.value(h.text),S&&(f=null==h.opacity?1:h.opacity,0!==f&&(e.font=p.font(h),e.textAlign=h.align||"left",_=h.x||0,v=h.y||0,(b=h.radius)&&(k=(h.theta||0)-l/2,_+=b*s(k),v+=b*d(k)),h.angle&&(e.save(),e.translate(_,v),e.rotate(h.angle*l/180),_=v=0),_+=h.dx||0,v+=(h.dy||0)+p.offset(h),h.fill&&u.fill(e,h,f)&&e.fillText(S,_,v),h.stroke&&u.stroke(e,h,f)&&e.strokeText(S,_,v),h.angle&&e.restore())))},pick:u.pick(function(e,t,r,i,o,p){if(0>=t.fontSize)return!1;if(!t.angle)return!0;// bounds sufficient if no rotation
// project point into space of unrotated bounds
var u=n(t,c,!0),g=-t.angle*l/180,a=s(g),m=d(g),h=t.x,f=t.y;return u.contains(a*o-m*p+(h-h*a+f*m),m*o+a*p+(f-h*m-f*a))})}},{"../../../util/Bounds":78,"../../../util/bound":83,"../../../util/text":88,"./util":71}],71:[function(e,t){function a(e,t,a,n){if(!e(t,n)){var r=null==a.opacity?1:a.opacity;0===r||(a.fill&&s(t,a,r)&&t.fill(),a.stroke&&d(t,a,r)&&t.stroke())}}function n(e,t,n,r){var s,d,o;for(s=0,d=n.items.length;s<d;++s)o=n.items[s],(!r||r.intersects(o.bounds))&&a(e,t,o,o)}function r(e){return e||(e=u),function(t,a,n,r,s,d){if(!a.items.length)return null;var l,p,u;for(null!=t.pixelratio&&1!==t.pixelratio&&(n*=t.pixelratio,r*=t.pixelratio),u=a.items.length;0<=--u;)// first hit test against bounding box
if(l=a.items[u],p=l.bounds,(!p||p.contains(s,d))&&p&&e(t,l,n,r,s,d))// if in bounding box, perform more careful test
return l;return null}}function i(e,t){return function(a,n,r,i){var s=Array.isArray(n)?n[0]:n,d=null==t?s.fill:t,o=s.stroke&&a.isPointInStroke,l,p;return o&&(l=s.strokeWidth,p=s.strokeCap,a.lineWidth=null==l?1:l,a.lineCap=null==p?"butt":p),!e(a,n)&&(d&&a.isPointInPath(r,i)||o&&a.isPointInStroke(r,i))}}function s(e,t,a){return a*=null==t.fillOpacity?1:t.fillOpacity,!!(0<a)&&(e.globalAlpha=a,e.fillStyle=l(e,t,t.fill),!0)}function d(e,t,a){var n=null==(n=t.strokeWidth)?1:n,r;return!(0>=n)&&(a*=null==t.strokeOpacity?1:t.strokeOpacity,!!(0<a)&&(e.globalAlpha=a,e.strokeStyle=l(e,t,t.stroke),e.lineWidth=n,e.lineCap=null==(r=t.strokeCap)?"butt":r,e.vgLineDash(t.strokeDash||null),e.vgLineDashOffset(t.strokeDashOffset||0),!0))}function l(e,t,a){return a.id?p(e,a,t.bounds):a}function p(e,t,a){var r=a.width(),s=a.height(),d=a.x1+t.x1*r,o=a.y1+t.y1*s,l=a.x1+t.x2*r,p=a.y1+t.y2*s,u=e.createLinearGradient(d,o,l,p),c=t.stops,g,m;for(g=0,m=c.length;g<m;++g)u.addColorStop(c[g].offset,c[g].color);return u}var u=function(){return!0};t.exports={drawOne:function(e){return function(t,n,r){n.items.length&&(r&&!r.intersects(n.bounds)||a(e,t,n.items[0],n.items))}},drawAll:function(e){return function(t,a,r){n(e,t,a,r)}},pick:r,pickPath:function(e){return r(i(e))},testPath:i,stroke:d,fill:s,color:l,gradient:p}},{}],72:[function(e,t){t.exports={canvas:e("./canvas"),svg:e("./svg")}},{"./canvas":59,"./svg":76}],73:[function(e,t){function a(){r.call(this)}var n=e("../../util/dom"),r=e("../Handler"),i=r.prototype,s=a.prototype=Object.create(i);// wrap an event listener for the SVG DOM
// add an event handler
// remove an event handler
s.constructor=a,s.initialize=function(e,t,a){return this._svg=n.find(e,"svg"),i.initialize.call(this,e,t,a)},s.svg=function(){return this._svg},s.listener=function(e){var t=this;return function(a){var n=a.target,r=n.__data__;a.vegaType=a.type,r=Array.isArray(r)?r[0]:r,e.call(t._obj,a,r)}},s.on=function(e,t){var a=this.eventName(e),n=this._svg,r=this._handlers,i={type:e,handler:t,listener:this.listener(t)};return(r[a]||(r[a]=[])).push(i),n.addEventListener(a,i.listener),this},s.off=function(e,t){var a=this.eventName(e),n=this._svg,r=this._handlers[a],s;if(r){for(s=r.length;0<=--s;)(r[s].type!==e||t)&&r[s].handler!==t||(n.removeEventListener(a,r[s].listener),r.splice(s,1));return this}},t.exports=a},{"../../util/dom":85,"../Handler":55}],74:[function(e,t){function a(e){c.call(this),this._loader=new u(e),this._dirtyID=0}function n(e,t,a){var r,s,d;for(e=h.child(e,a,"linearGradient",y),e.setAttribute("id",t.id),e.setAttribute("x1",t.x1),e.setAttribute("x2",t.x2),e.setAttribute("y1",t.y1),e.setAttribute("y2",t.y2),(r=0,s=t.stops.length);r<s;++r)d=h.child(e,r,"stop",y),d.setAttribute("offset",t.stops[r].offset),d.setAttribute("stop-color",t.stops[r].color);h.clear(e,r)}function r(e,t,a){var n;e=h.child(e,a,"clipPath",y),e.setAttribute("id",t.id),n=h.child(e,0,"rect",y),n.setAttribute("x",0),n.setAttribute("y",0),n.setAttribute("width",t.width),n.setAttribute("height",t.height)}function s(e,t){for(;e&&e.dirty!==t;e=e.mark.group)if(e.dirty=t,e.mark&&e.mark.dirty!==t)e.mark.dirty=t;else return}// -- Construct & maintain scenegraph to SVG mapping ---
// Draw a mark container.
// Bind a scenegraph item to an SVG DOM element.
// Create new SVG elements as needed.
function o(e,t,a,n,r){// create svg element, bind item data for D3 compatibility
var i=h.child(e,n,t.tag,y,null,r);// create background rect
if(i.__data__=a,i.__values__={fill:"default"},"g"===t.tag){var s=h.child(i,0,"rect",y,"background");s.__data__=a}// add pointer from scenegraph item to svg element
return a._svg=i}// -- Set attributes & styles on SVG elements ---
function l(e,t,a){// early exit if value is unchanged
t===x[e]||(// note current value for future comparison
null==t?a?v.removeAttributeNS(a,e):v.removeAttribute(e):a?v.setAttributeNS(a,e,t):v.setAttribute(e,t),x[e]=t)}function p(){return"undefined"==typeof window?"":window.location.href}var u=e("../../util/ImageLoader"),c=e("../Renderer"),g=e("../../util/text"),h=e("../../util/dom"),f=e("../../util/svg"),y=f.metadata.xmlns,d=e("./marks"),m=c.prototype,_=a.prototype=Object.create(m);_.constructor=a,_.initialize=function(e,t,a,n){return e&&(this._svg=h.child(e,0,"svg",y,"marks"),h.clear(e,1),this._root=h.child(this._svg,0,"g",y),h.clear(this._svg,1)),this._defs={clip_id:1,gradient:{},clipping:{}},this.background(this._bgcolor),m.initialize.call(this,e,t,a,n)},_.background=function(e){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",e),m.background.apply(this,arguments)},_.resize=function(e,t,a){if(m.resize.call(this,e,t,a),this._svg){var n=this._width,r=this._height,i=this._padding;this._svg.setAttribute("width",n+i.left+i.right),this._svg.setAttribute("height",r+i.top+i.bottom),this._root.setAttribute("transform","translate("+i.left+","+i.top+")")}return this},_.svg=function(){if(!this._svg)return null;var e={class:"marks",width:this._width+this._padding.left+this._padding.right,height:this._height+this._padding.top+this._padding.bottom};for(var t in f.metadata)e[t]=f.metadata[t];return h.openTag("svg",e)+this._svg.innerHTML+h.closeTag("svg")},_.imageURL=function(e){return this._loader.imageURL(e)},_.render=function(e,t){return this._dirtyCheck(t)&&(this._dirtyAll&&this._resetDefs(),this.draw(this._root,e,-1),h.clear(this._root,1)),this.updateDefs(),this},_.draw=function(e,t,a){this.drawMark(e,t,a,d[t.marktype])},_.updateDefs=function(){var e=this._svg,t=this._defs,a=t.el,i=0,s;for(s in t.gradient)a||(a=t.el=h.child(e,0,"defs",y)),n(a,t.gradient[s],i++);for(s in t.clipping)a||(a=t.el=h.child(e,0,"defs",y)),r(a,t.clipping[s],i++);// clean-up
a&&(0==i?(e.removeChild(a),t.el=null):h.clear(a,i))},_._resetDefs=function(){var e=this._defs;e.clip_id=1,e.gradient={},e.clipping={}},_.isDirty=function(e){return this._dirtyAll||e.dirty===this._dirtyID},_._dirtyCheck=function(e){if(this._dirtyAll=!0,!e)return!0;var t=++this._dirtyID,a,r,l,p,u,c,g;for(u=0,c=e.length;u<c;++u){if(a=e[u],r=a.mark,r.marktype!==l&&(l=r.marktype,p=d[l]),"exit"===a.status){a._svg&&(p.nest&&a.mark.items.length?(this._update(p,a._svg,a.mark.items[0]),g=a.mark.items[0],g._svg=a._svg,g._update=t):h.remove(a._svg),a._svg=null);continue}if(a=p.nest?r.items[0]:a,a._update===t)// Already processed
continue;else a._svg?// UPDATE
this._update(p,a._svg,a):(// ENTER
this._dirtyAll=!1,s(a,t));a._update=t}return!this._dirtyAll},_.drawMark=function(e,t,a,r){if(this.isDirty(t)){var s=r.nest?t.items&&t.items.length?[t.items[0]]:[]:t.items||[],l=!1===t.interactive?"none":null,u="g"===r.tag,g=h.cssClass(t),m,f,_,v,x,b;for(m=h.child(e,a+1,"g",y,g),m.setAttribute("class",g),t._svg=m,!u&&l&&m.style.setProperty("pointer-events",l),(f=0,_=s.length);f<_;++f)this.isDirty(x=s[f])&&(b=!(this._dirtyAll||x._svg),v=o(m,r,x,f,b),this._update(r,v,x),u&&(b&&(this._dirtyAll=!0),this._recurse(v,x),b&&(this._dirtyAll=!1)));return h.clear(m,f),m}},_._recurse=function(e,t){var a=t.items||[],n=t.legendItems||[],r=t.axisItems||[],i=0,s,o;for(s=0,o=r.length;s<o;++s)"back"===r[s].layer&&this.drawMark(e,r[s],i++,d.group);for(s=0,o=a.length;s<o;++s)this.draw(e,a[s],i++);for(s=0,o=r.length;s<o;++s)"back"!==r[s].layer&&this.drawMark(e,r[s],i++,d.group);for(s=0,o=n.length;s<o;++s)this.drawMark(e,n[s],i++,d.group);// remove any extraneous DOM elements
h.clear(e,1+i)};var v=null,// temp var for current SVG element
x=null,b={group:function(e,t,a){v=t.childNodes[0],x=t.__values__,e.background(l,a,this);var n=!1===a.mark.interactive?"none":null;n!==x.events&&(v.style.setProperty("pointer-events",n),x.events=n)},text:function(e,t,a){var n=g.value(a.text);n!==x.text&&(t.textContent=n,x.text=n),n=g.font(a),n!==x.font&&(t.style.setProperty("font",n),x.font=n)}};// temp var for current values hash
// Extra configuration for certain mark types
_._update=function(e,t,a){v=t,x=t.__values__,e.attr(l,a,this);// some marks need special treatment
var n=b[e.type];// apply svg css styles
// note: element may be modified by 'extra' method
n&&n(e,t,a),this.style(v,a)},_.style=function(e,t){if(null!=t){var a,r,s,d,o;for(a=0,r=f.styleProperties.length;a<r;++a)s=f.styleProperties[a],o=t[s],o===x[s]||(d=f.styles[s],null==o?"fill"===d?e.style.setProperty(d,"none"):e.style.removeProperty(d):(o.id&&(this._defs.gradient[o.id]=o,o="url("+p()+"#"+o.id+")"),e.style.setProperty(d,o+"")),x[s]=o)}},t.exports=a},{"../../util/ImageLoader":81,"../../util/dom":85,"../../util/svg":87,"../../util/text":88,"../Renderer":56,"./marks":77}],75:[function(e,t){function a(e){d.call(this),this._loader=new o(e),this._text={head:"",root:"",foot:"",defs:"",body:""},this._defs={clip_id:1,gradient:{},clipping:{}}}function n(e,t,a,n){y[n||e]=t}function r(e,t,a,r){if(null==e)return"";var d="",o,u,c,g,m;for("bgrect"===a&&!1===t.interactive&&(d+="pointer-events: none;"),"text"===a&&(d+="font: "+p.font(e)+";"),(o=0,u=l.styleProperties.length);o<u;++o)c=l.styleProperties[o],g=l.styles[c],m=e[c],null==m?"fill"===g&&(d+=(d.length?" ":"")+"fill: none;"):(m.id&&(r.gradient[m.id]=m,m="url(#"+m.id+")"),d+=(d.length?" ":"")+g+": "+m+";");return d?"style=\""+d+"\"":null}function s(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}var d=e("../Renderer"),o=e("../../util/ImageLoader"),l=e("../../util/svg"),p=e("../../util/text"),u=e("../../util/dom"),c=u.openTag,g=u.closeTag,m=e("./marks"),h=d.prototype,f=a.prototype=Object.create(h);f.constructor=a,f.resize=function(e,a,n){h.resize.call(this,e,a,n);var r=this._padding,i=this._text,t={class:"marks",width:this._width+r.left+r.right,height:this._height+r.top+r.bottom};for(var s in l.metadata)t[s]=l.metadata[s];return i.head=c("svg",t),i.root=c("g",{transform:"translate("+r.left+","+r.top+")"}),i.foot=g("g")+g("svg"),this},f.svg=function(){var e=this._text;return e.head+e.defs+e.root+e.body+e.foot},f.render=function(e){return this._text.body=this.mark(e),this._text.defs=this.buildDefs(),this},f.reset=function(){return this._defs.clip_id=0,this},f.buildDefs=function(){var e=this._defs,t="",a,n,r,s;for(n in e.gradient){for(r=e.gradient[n],s=r.stops,t+=c("linearGradient",{id:n,x1:r.x1,x2:r.x2,y1:r.y1,y2:r.y2}),a=0;a<s.length;++a)t+=c("stop",{offset:s[a].offset,"stop-color":s[a].color})+g("stop");t+=g("linearGradient")}for(n in e.clipping)r=e.clipping[n],t+=c("clipPath",{id:n}),t+=c("rect",{x:0,y:0,width:r.width,height:r.height})+g("rect"),t+=g("clipPath");return 0<t.length?c("defs")+t+g("defs"):""},f.imageURL=function(e){return this._loader.imageURL(e)};var y;f.attributes=function(e,t){return y={},e(n,t,this),y},f.mark=function(e){var t=m[e.marktype],a=t.tag,n=t.attr,d=t.nest||!1,o=d?e.items&&e.items.length?[e.items[0]]:[]:e.items||[],l=this._defs,h="",f,y,_;// render contained elements
for("g"!==a&&!1===e.interactive&&(f="style=\"pointer-events: none;\""),h+=c("g",{class:u.cssClass(e)},f),y=0;y<o.length;++y)_=o[y],f="g"===a?null:r(_,e,a,l),h+=c(a,this.attributes(n,_),f),"text"===a?h+=s(p.value(_.text)):"g"===a&&(h+=c("rect",this.attributes(t.background,_),r(_,e,"bgrect",l))+g("rect"),h+=this.markGroup(_)),h+=g(a);// render closing group tag
return h+g("g")},f.markGroup=function(e){var t="",a=e.axisItems||[],n=e.items||[],r=e.legendItems||[],i,s;for(i=0,s=a.length;i<s;++i)"back"===a[i].layer&&(t+=this.mark(a[i]));for(i=0,s=n.length;i<s;++i)t+=this.mark(n[i]);for(i=0,s=a.length;i<s;++i)"back"!==a[i].layer&&(t+=this.mark(a[i]));for(i=0,s=r.length;i<s;++i)t+=this.mark(r[i]);return t},t.exports=a},{"../../util/ImageLoader":81,"../../util/dom":85,"../../util/svg":87,"../../util/text":88,"../Renderer":56,"./marks":77}],76:[function(e,t){t.exports={Handler:e("./SVGHandler"),Renderer:e("./SVGRenderer"),string:{Renderer:e("./SVGStringRenderer")}}},{"./SVGHandler":73,"./SVGRenderer":74,"./SVGStringRenderer":75}],77:[function(e,t){function a(e){return n(e.x||0,e.y||0)}function n(e,t){return"translate("+e+","+t+")"}var i=e("../../util/text"),o=e("../../util/svg"),p=o.symbolTypes,u=o.textAlign,c=o.path;t.exports={arc:{tag:"path",type:"arc",attr:function(e,t){e("transform",a(t)),e("d",c.arc(t))}},area:{tag:"path",type:"area",nest:!0,attr:function(e,t){var a=t.mark.items;a.length&&e("d",c.area(a))}},group:{tag:"g",type:"group",attr:function(e,t,n){var r=null,i,s;e("transform",a(t)),t.clip&&(i=n._defs,r=t.clip_id||(t.clip_id="clip"+i.clip_id++),s=i.clipping[r]||(i.clipping[r]={id:r}),s.width=t.width||0,s.height=t.height||0),e("clip-path",r?"url(#"+r+")":null)},background:function(e,t){e("class","background"),e("width",t.width||0),e("height",t.height||0)}},image:{tag:"image",type:"image",attr:function(e,t,a){var r=t.x||0,i=t.y||0,s=t.width||0,d=t.height||0,o=a.imageURL(t.url);r-="center"===t.align?s/2:"right"===t.align?s:0,i-="middle"===t.baseline?d/2:"bottom"===t.baseline?d:0,e("href",o,"http://www.w3.org/1999/xlink","xlink:href"),e("transform",n(r,i)),e("width",s),e("height",d)}},line:{tag:"path",type:"line",nest:!0,attr:function(e,t){var a=t.mark.items;a.length&&e("d",c.line(a))}},path:{tag:"path",type:"path",attr:function(e,t){e("transform",a(t)),e("d",t.path)}},rect:{tag:"rect",type:"rect",nest:!1,attr:function(e,t){e("transform",a(t)),e("width",t.width||0),e("height",t.height||0)}},rule:{tag:"line",type:"rule",attr:function(e,t){e("transform",a(t)),e("x2",null==t.x2?0:t.x2-(t.x||0)),e("y2",null==t.y2?0:t.y2-(t.y||0))}},symbol:{tag:"path",type:"symbol",attr:function(e,t){var n=!t.shape||p[t.shape]?c.symbol(t):c.resize(t.shape,t.size);e("transform",a(t)),e("d",n)}},text:{tag:"text",type:"text",nest:!1,attr:function(e,p){var o=p.dx||0,c=(p.dy||0)+i.offset(p),g=p.x||0,m=p.y||0,h=p.angle||0,a=p.radius||0,r;a&&(r=(p.theta||0)-l/2,g+=a*s(r),m+=a*d(r)),e("text-anchor",u[p.align]||"start"),h?(r=n(g,m)+" rotate("+h+")",(o||c)&&(r+=" "+n(o,c))):r=n(g+o,m+c),e("transform",r)}}}},{"../../util/svg":87,"../../util/text":88}],78:[function(e,t){function a(e){this.clear(),e&&this.union(e)}var n=a.prototype;n.clone=function(){return new a(this)},n.clear=function(){var e=Number.MAX_VALUE;return this.x1=+e,this.y1=+e,this.x2=-e,this.y2=-e,this},n.set=function(e,t,a,n){return this.x1=e,this.y1=t,this.x2=a,this.y2=n,this},n.add=function(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},n.expand=function(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},n.round=function(){return this.x1=T(this.x1),this.y1=T(this.y1),this.x2=y(this.x2),this.y2=y(this.y2),this},n.translate=function(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},n.rotate=function(e,t,a){var n=s(e),r=d(e),i=t-t*n+a*r,o=a-t*r-a*n,l=this.x1,p=this.x2,u=this.y1,c=this.y2;return this.clear().add(n*l-r*u+i,r*l+n*u+o).add(n*l-r*c+i,r*l+n*c+o).add(n*p-r*u+i,r*p+n*u+o).add(n*p-r*c+i,r*p+n*c+o)},n.union=function(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},n.encloses=function(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},n.alignsWith=function(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},n.intersects=function(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},n.contains=function(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},n.width=function(){return this.x2-this.x1},n.height=function(){return this.y2-this.y1},t.exports=a},{}],79:[function(e,t){t.exports=function(e){function t(){}function a(t,a){e.add(t,a)}return{bounds:function(t){return arguments.length?(e=t,this):e},beginPath:t,closePath:t,moveTo:a,lineTo:a,quadraticCurveTo:function(t,a,n,r){e.add(t,a),e.add(n,r)},bezierCurveTo:function(t,a,n,r,i,s){e.add(t,a),e.add(n,r),e.add(i,s)}}}},{}],80:[function(e,t){function a(e){this.id="gradient_"+n++,this.type=e||"linear",this.stops=[],this.x1=0,this.x2=1,this.y1=0,this.y2=0}var n=0,r=a.prototype;r.stop=function(e,t){return this.stops.push({offset:e,color:t}),this},t.exports=a},{}],81:[function(e,t){(function(a){function n(e){this._pending=0,this._config=e||n.Config}// Overridable global default load configuration
function r(e,t){var a=s.sanitizeUrl(this.params(e));if(!a)return t&&t(e,null),null;var n=this,r=new Image;return n._pending+=1,r.onload=function(){n._pending-=1,r.loaded=!0,t&&t(null,r)},r.src=a,r}function i(e,t){var n=this,r=new("undefined"==typeof window?"undefined"==typeof a?null:a.canvas:window.canvas).Image;return n._pending+=1,s(this.params(e),function(e,a){return n._pending-=1,e?(t&&t(e,null),null):void(r.src=a,r.loaded=!0,t&&t(null,r))}),r}var s=e("datalib/src/import/load");n.Config=null;var d=n.prototype;d.pending=function(){return this._pending},d.params=function(e){var t={url:e},a;for(a in this._config)t[a]=this._config[a];return t},d.imageURL=function(e){return s.sanitizeUrl(this.params(e))},d.loadImage=function(e,t){return s.useXHR?r.call(this,e,t):i.call(this,e,t)},t.exports=n}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{"datalib/src/import/load":23}],82:[function(e,t){function a(e){this.mark=e}var n=a.prototype;n.hasPropertySet=function(e){var t=this.mark.def.properties;return t&&null!=t[e]},n.cousin=function(e,t){if(0===e)return this;e=e||-1;var a=this.mark,n=a.group,r=null==t?a.items.indexOf(this):t,i=n.items.indexOf(a)+e;return n.items[i].items[r]},n.sibling=function(e){if(0===e)return this;e=e||-1;var t=this.mark,a=t.items.indexOf(this)+e;return t.items[a]},n.remove=function(){var e=this,t=e.mark.items,a=t.indexOf(e);return 0<=a&&(a===t.length-1?t.pop():t.splice(a,1)),e},n.touch=function(){this.pathCache&&(this.pathCache=null)},t.exports=a},{}],83:[function(t,a){function n(){return j||(j=_.instance(1,1).getContext("2d"))}function p(e,t){return e.stroke&&0!==e.opacity&&0!==e.stokeOpacity&&t.expand(null==e.strokeWidth?1:e.strokeWidth),t}function u(e,t,a,n,r){return null==t?a.set(0,0,0,0):(T(P.bounds(a),t,n,r),p(e,a)),a}function c(e,i,o){var p=n(),u=b.size(e),c=e.align,a=e.radius||0,r=e.x||0,g=e.y||0,m=e.dx||0,h=(e.dy||0)+b.offset(e)-v(.8*u),// use 4/5 offset
f,_;return a&&(_=(e.theta||0)-l/2,r+=a*s(_),g+=a*d(_)),p.font=b.font(e),f=p.measureText(b.value(e.text)).width,"center"===c?m-=f/2:"right"===c&&(m-=f),i.set(m+=r,h+=g,m+f,h+u),e.angle&&!o&&i.rotate(e.angle*l/180,r,g),i.expand(o?0:1)}function g(e,t,a){var n=e.axisItems||[],r=e.items||[],i=e.legendItems||[],s,d;if(!e.clip){for(s=0,d=n.length;s<d;++s)t.union(n[s].bounds);for(s=0,d=r.length;s<d;++s)r[s].bounds&&t.union(r[s].bounds);if(a)for(s=0,d=i.length;s<d;++s)t.union(i[s].bounds)}return(e.clip||e.width||e.height)&&p(e,t.add(0,0).add(e.width||0,e.height||0)),t.translate(e.x||0,e.y||0)}function m(e,t,a){var n=e.mark.marktype;t=t||r[n],t.nest&&(e=e.mark);var i=e.bounds,s=e["bounds:prev"]||(e["bounds:prev"]=new y);return i?(s.clear().union(i),i.clear()):e.bounds=new y,t(e,e.bounds,a),i||s.clear().union(e.bounds),e.bounds}var f=t("./BoundsContext"),y=t("./Bounds"),_=t("./canvas"),x=t("./svg"),b=t("./text"),k=t("../path"),S=k.parse,T=k.render,L=x.path.area,E=x.path.line,C=l/2,M=h(3),D=e(30*l/180),j=null,P=f(),r={group:g,symbol:function(e,a){var n=null==e.size?100:e.size,i=e.x||0,s=e.y||0,d,o,u,c;switch(e.shape){case"cross":o=3*h(n/5)/2,a.set(i-o,s-o,i+o,s+o);break;case"diamond":c=h(n/(2*D)),u=c*D,a.set(i-u,s-c,i+u,s+c);break;case"square":o=h(n),d=o/2,a.set(i-d,s-d,i+d,s+d);break;case"triangle-down":u=h(n/M),c=u*M/2,a.set(i-u,s-c,i+u,s+c);break;case"triangle-up":u=h(n/M),c=u*M/2,a.set(i-u,s-c,i+u,s+c);break;default:d=h(n/l),a.set(i-d,s-d,i+d,s+d);}return p(e,a)},image:function(e,t){var a=e.x||0,n=e.y||0,r=e.width||0,i=e.height||0;return a-="center"===e.align?r/2:"right"===e.align?r:0,n-="middle"===e.baseline?i/2:"bottom"===e.baseline?i:0,t.set(a,n,a+r,n+i)},rect:function(e,t){var a,n;return p(e,t.set(a=e.x||0,n=e.y||0,a+e.width||0,n+e.height||0))},rule:function(e,t){var a,n;return p(e,t.set(a=e.x||0,n=e.y||0,null==e.x2?a:e.x2,null==e.y2?n:e.y2))},arc:function(e,t){var r=e.x||0,o=e.y||0,l=e.innerRadius||0,u=e.outerRadius||0,c=(e.startAngle||0)-C,g=(e.endAngle||0)-C,m=1/0,h=-Infinity,f=1/0,_=-Infinity,v=[c,g],b=c-c%C,k,S,T,L,E,M,D,j,P;for(S=0;4>S&&b<g;++S,b+=C)v.push(b);for(S=0,T=v.length;S<T;++S)k=v[S],L=s(k),M=l*L,j=u*L,E=d(k),D=l*E,P=u*E,m=w(m,M,j),h=A(h,M,j),f=w(f,D,P),_=A(_,D,P);return p(e,t.set(r+m,o+f,r+h,o+_))},text:c,path:function(e,t){var a=e.path?e.pathCache||(e.pathCache=S(e.path)):null;return u(e,a,t,e.x,e.y)},area:function(e,t){if(0===e.items.length)return t;var a=e.items,n=a[0],r=n.pathCache||(n.pathCache=S(L(a)));return u(n,r,t)},line:function(e,t){if(0===e.items.length)return t;var a=e.items,n=a[0],r=n.pathCache||(n.pathCache=S(E(a)));return u(n,r,t)}};r.area.nest=!0,r.line.nest=!0;var I={mark:null};a.exports={mark:function(e,t,a){var s=e.marktype,d=r[s],l=e.items,p=l&&l.length,u,c,g,h;if(d.nest)return g=p?l[0]:(I.mark=e,I),h=m(g,d,a),t=t&&t.union(h)||h,t;if(t=t||e.bounds&&e.bounds.clear()||new y,p)for(u=0,c=l.length;u<c;++u)t.union(m(l[u],d,a));return e.bounds=t},item:m,text:c,group:g}},{"../path":52,"./Bounds":78,"./BoundsContext":79,"./canvas":84,"./svg":87,"./text":88}],84:[function(e,t){(function(e){function a(e){var t=e.getContext("2d"),a=window&&window.devicePixelRatio||1,n=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1,r=a/n;// get canvas pixel data
if(a!==n){// set actual and visible canvas size
var i=e.width,s=e.height;e.width=i*r,e.height=s*r,e.style.width=i+"px",e.style.height=s+"px"}return r}function n(e){var t=e.getContext("2d");if(!t.vgLineDash){// already initialized!
var a=function(){},n=[];return t.setLineDash?(t.vgLineDash=function(e){this.setLineDash(e||n)},t.vgLineDashOffset=function(e){this.lineDashOffset=e}):void 0===t.webkitLineDash?void 0===t.mozDash?(t.vgLineDash=a,t.vgLineDashOffset=a):(t.vgLineDash=function(e){this.mozDash=e},t.vgLineDashOffset=a):(t.vgLineDash=function(e){this.webkitLineDash=e||n},t.vgLineDashOffset=function(e){this.webkitLineDashOffset=e}),e}}t.exports={instance:function(t,a){t=t||1,a=a||1;var r;if("undefined"!=typeof document&&document.createElement)r=document.createElement("canvas"),r.width=t,r.height=a;else{var i="undefined"==typeof window?"undefined"==typeof e?null:e.canvas:window.canvas;if(!i.prototype)return null;r=new i(t,a)}return n(r)},resize:function(e,t,n,r,i){var d=this._ctx=e.getContext("2d"),o=1;return e.width=t+r.left+r.right,e.height=n+r.top+r.bottom,i&&"undefined"!=typeof HTMLElement&&e instanceof HTMLElement&&(d.pixelratio=o=a(e)||1),d.setTransform(o,0,0,o,o*r.left,o*r.top),e},lineDash:n}}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{}],85:[function(e,t){// create a new DOM element
function n(e,t,a){return a?e.createElementNS(a,t):e.createElement(t)}// remove element from DOM
// recursively remove parent elements if empty
function r(e){if(e){var t=e.parentNode;t&&(t.removeChild(e),(!t.childNodes||!t.childNodes.length)&&r(t))}}t.exports={// find first child element with matching tag
find:function(e,t){t=t.toLowerCase();for(var a=0,r=e.childNodes.length;a<r;++a)if(e.childNodes[a].tagName.toLowerCase()===t)return e.childNodes[a]},// retrieve child element at given index
// create & insert if doesn't exist or if tag/className do not match
child:function(e,t,r,i,s,d){var o,l;return o=l=e.childNodes[t],(!o||d||o.tagName.toLowerCase()!==r.toLowerCase()||s&&o.getAttribute("class")!=s)&&(o=n(e.ownerDocument,r,i),e.insertBefore(o,l||null),s&&o.setAttribute("class",s)),o},// remove all child elements at or above the given index
clear:function(e,t){for(var a=e.childNodes.length;a>t;)e.removeChild(e.childNodes[--a]);return e},remove:r,// generate css class name for mark
cssClass:function(e){return"mark-"+e.marktype+(e.name?" "+e.name:"")},// generate string for an opening xml tag
// tag: the name of the xml tag
// attr: hash of attribute name-value pairs to include
// raw: additional raw string to include in tag markup
openTag:function(e,t,a){var n="<"+e,r,i;if(t)for(r in t)i=t[r],null!=i&&(n+=" "+r+"=\""+i+"\"");return a&&(n+=" "+a),n+">"},// generate string for closing xml tag
// tag: the name of the xml tag
closeTag:function(e){return"</"+e+">"}}},{}],86:[function(e,t){function a(e){var t=e.marktype,o,l,p,u,c;for(p=0,u=d.length;p<u;++p)if(c=e[d[p]])for(o=0,l=c.length;o<l;++o)c[o][t?"mark":"group"]=e,t&&"group"!==t||a(c[o]);return t&&r.mark(e),e}var r=e("../util/bound"),d=["items","axisItems","legendItems"],o=["marktype","name","interactive","clip","items","axisItems","legendItems","layer","x","y","width","height","align","baseline",// layout
"fill","fillOpacity","opacity",// fill
"stroke","strokeOpacity","strokeWidth","strokeCap",// stroke
"strokeDash","strokeDashOffset",// stroke dash
"startAngle","endAngle","innerRadius","outerRadius",// arc
"interpolate","tension","orient",// area, line
"url",// image
"path",// path
"x2","y2",// rule
"size","shape",// symbol
"text","angle","theta","radius","dx","dy",// text
"font","fontSize","fontWeight","fontStyle","fontVariant"// font
];t.exports={toJSON:function(e,t){return JSON.stringify(e,o,t)},fromJSON:function(e){var t="string"==typeof e?JSON.parse(e):e;return a(t)}}},{"../util/bound":83}],87:[function(e,t){(function(a){function n(e){return e.x||0}function r(e){return e.y||0}var i=e("datalib"),s=("undefined"==typeof window?"undefined"==typeof a?null:a.d3:window.d3).svg,d=e("../path/parse"),l=s.area().x(n).y1(r).y0(function(e){return(e.y||0)+(e.height||0)}),p=s.area().y(r).x1(n).x0(function(e){return(e.x||0)+(e.width||0)}),u=s.line().x(n).y(r);t.exports={metadata:{version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"},path:{arc:s.arc(),symbol:s.symbol().type(function(e){return e.shape||"circle"}).size(function(e){return null==e.size?100:e.size}),area:function(e){var t=e[0];return("horizontal"===t.orient?p:l).interpolate(t.interpolate||"linear").tension(t.tension||.7)(e)},line:function(e){var t=e[0];return u.interpolate(t.interpolate||"linear").tension(t.tension||.7)(e)},resize:function(e,t){var a=d(e),r="",s,o,l,p,u,c,g;for(t=h(t),p=0,u=a.length;p<u;++p)for(s=a[p],c=0,g=s.length;c<g&&!("Z"===s[c]);++c)(o=+s[c])===o&&(l=e.indexOf(o),r+=e.substring(0,l)+o*t,e=e.substring(l+(o+"").length));return r+"Z"}},symbolTypes:i.toMap(s.symbolTypes),textAlign:{left:"start",center:"middle",right:"end"},textBaseline:{top:"before-edge",bottom:"after-edge",middle:"central"},styles:{fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeWidth:"stroke-width",strokeOpacity:"stroke-opacity",strokeCap:"stroke-linecap",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",opacity:"opacity"},styleProperties:["fill","fillOpacity","stroke","strokeWidth","strokeOpacity","strokeCap","strokeDash","strokeDashOffset","opacity"]}}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{"../path/parse":53,datalib:27}],88:[function(e,t){function a(e){return null==e.fontSize?11:e.fontSize}t.exports={size:a,value:function(e){return null==e?"":e+""},font:function(e,t){var n=e.font;return t&&n&&(n=(n+"").replace(/\"/g,"'")),""+(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+a(e)+"px "+(n||"sans-serif")},offset:function(e){// perform our own font baseline calculation
// why? not all browsers support SVG 1.1 'alignment-baseline' :(
var t=e.baseline,n=a(e);return v("top"===t?.93*n:"middle"===t?.3*n:"bottom"===t?-.21*n:0)}}},{}],89:[function(e,t){function a(e,t,a){s.call(this,e,t,a),this._type="canvas",this._renderers={canvas:r,svg:i}}var n=e("vega-scenegraph").render,r=n.canvas,i=n.svg.string,s=e("./View"),d=a.prototype=new s;d.renderer=function(e){return e&&(this._type=e),s.prototype.renderer.apply(this,arguments)},d.canvas=function(){return"canvas"===this._type?this._renderer.canvas():null},d.canvasAsync=function(e){function t(){0===a.pendingImages()?(n.render(),e(n.canvas())):setTimeout(t,10)}// if images loading, poll until ready
var a=this._renderer,n=this;return"canvas"===this._type?void(0<a.pendingImages()?t():e(this.canvas())):null},d.svg=function(){return"svg"===this._type?this._renderer.svg():null},d.initialize=function(){var e=this._width,t=this._height,a=this._bgcolor,n=this._padding,r=this.model().config();return this._viewport&&(e=this._viewport[0]-(n?n.left+n.right:0),t=this._viewport[1]-(n?n.top+n.bottom:0)),this._renderer=(this._renderer||new this._io.Renderer(r.load)).initialize(null,e,t,n).background(a),(this._repaint=!0,this)},t.exports=a},{"./View":91,"vega-scenegraph":50}],90:[function(e,t){function a(e){// Root scenegraph node.
// Index of group items.
// Top-level scenegraph builder.
this._defs={},this._predicates={},this._scene=null,this._groups=null,this._node=null,this._builder=null,this._reset={axes:!1,legends:!1},this.config(e),this.expr=u(this),d.init.call(this)}function n(e){var t=this,a={};return r.isArray(e)?(e.forEach(function(e){a[e]=t._predicates[e]}),a):this._predicates[e]}var r=e("datalib"),i=e("vega-dataflow"),s=i.ChangeSet,d=i.Graph.prototype,o=i.Node,// jshint ignore:line
l=e("../scene/GroupBuilder"),p=e("../scene/visit"),u=e("../parse/expr"),c=e("./config"),g=a.prototype=Object.create(d);g.constructor=a,g.defs=function(e){return arguments.length?(this._defs=e,this):this._defs},g.config=function(e){if(!arguments.length)return this._config;for(var t in this._config=Object.create(c),e){var a=e[t],n=this._config[t];this._config[t]=r.isObject(a)&&r.isObject(n)?r.extend({},n,a):a}return this},g.width=function(e){return this._defs&&(this._defs.width=e),this._defs&&this._defs.marks&&(this._defs.marks.width=e),this._scene&&(this._scene.items[0].width=e,this._scene.items[0]._dirty=!0),this._reset.axes=!0,this},g.height=function(e){return this._defs&&(this._defs.height=e),this._defs&&this._defs.marks&&(this._defs.marks.height=e),this._scene&&(this._scene.items[0].height=e,this._scene.items[0]._dirty=!0),this._reset.axes=!0,this},g.node=function(){return this._node||(this._node=new o(this))},g.data=function(){var e=d.data.apply(this,arguments);return 1<arguments.length&&this.node().addListener(e.pipeline()[0]),e},g.predicate=function(e,t){return 1===arguments.length?n.call(this,e):this._predicates[e]=t},g.predicates=function(){return this._predicates},g.scene=function(e){if(!arguments.length)return this._scene;this._builder&&(this.node().removeListener(this._builder),this._builder._groupBuilder.disconnect());var t=this,a=this._builder=new o(this);return a.evaluate=function(n){if(a._groupBuilder)return n;var r=a._groupBuilder=new l(t,t._defs.marks,t._scene={}),i=r.pipeline();return t._groups={},this.addListener(r.connect()),i[i.length-1].addListener(e),n},this.addListener(a),this},g.group=function(e,t){var a=this._groups;return 1===arguments.length?a[e]:(a[e]=t,this)},g.reset=function(){return this._scene&&this._reset.axes&&(p(this._scene,function(e){e.axes&&e.axes.forEach(function(e){e.reset()})}),this._reset.axes=!1),this._scene&&this._reset.legends&&(p(this._scene,function(e){e.legends&&e.legends.forEach(function(e){e.reset()})}),this._reset.legends=!1),this},g.addListener=function(e){this.node().addListener(e)},g.removeListener=function(e){this.node().removeListener(e)},g.fire=function(e){e||(e=s.create()),this.propagate(e,this.node())},t.exports=a},{"../parse/expr":97,"../scene/GroupBuilder":113,"../scene/visit":118,"./config":92,datalib:27,"vega-dataflow":42}],91:[function(e,t){(function(a){function n(e,t,a){// Set cursor based on hover propset?
// Targeted update for streaming changes
// Batch set signals can skip reevaluation.
// Full re-render on every re-init
this._el=null,this._model=null,this._width=this.__width=t||500,this._height=this.__height=a||300,this._bgcolor=null,this._cursor=!0,this._autopad=1,this._padding={top:0,left:0,bottom:0,right:0},this._viewport=null,this._renderer=null,this._handler=null,this._streamer=null,this._skipSignals=!1,this._changeset=null,this._repaint=!0,this._renderers=c,this._io=null,this._api={}}// Sandboxed streaming data API
function r(e){var t=this,a=this._model.data(e);if(!a)return m.error("Data source \""+e+"\" is not defined.");var n=a.pipeline()[0],r=this._streamer,i={};// If we have it stashed, don't create a new closure.
return this._api[e]?this._api[e]:(i.insert=function(s){return a.insert(l.duplicate(s)),r.addListener(n),t._changeset.data[e]=1,i},i.update=function(){return r.addListener(n),t._changeset.data[e]=1,(a.update.apply(a,arguments),i)},i.remove=function(){return r.addListener(n),t._changeset.data[e]=1,(a.remove.apply(a,arguments),i)},i.values=function(){return a.values()},this._api[e]=i)}function i(e,t){var a=this._changeset,n=this._model.signal(e);return n?void(this._streamer.addListener(n.value(t)),a.signals[e]=1,a.reflow=!0):m.error("Signal \""+e+"\" is not defined.")}function s(){var e=this.model().scene(),t=e.items[0].legendItems,a=0,n=t.length,r,s;// For strict padding, clip legend height to prevent a tiny data rectangle.
if(this._strict){for(r=g.mark(e,null,!1);a<n;++a)s=t[a].bounds,r.add(s.x1,0).add(s.x2,0);return r}return e.bounds}function d(){var e=this;return e._renderNode=new p.Node(e._model).router(!0),e._renderNode.evaluate=function(t){m.debug(t,["rendering"]);var a=e._model.scene(),n=e._handler;return n&&n.scene&&n.scene(a),t.trans?t.trans.start(function(t){e._renderer.render(a,t)}):e._repaint?e._renderer.render(a):t.dirty.length&&e._renderer.render(a,t.dirty),t.dirty.length&&(t.dirty.forEach(function(e){e._dirty=!1}),a.items[0]._dirty=!1),e._repaint=e._skipSignals=!1,t},(e._model.scene(e._renderNode),!0)}var o="undefined"==typeof window?"undefined"==typeof a?null:a.d3:window.d3,l=e("datalib"),p=e("vega-dataflow"),u=e("vega-scenegraph"),c=u.render,g=u.bound,m=e("vega-logging"),h=p.Dependencies,f=e("../parse/streams"),_=e("../scene/Encoder"),x=e("../scene/Transition"),b=n.prototype;b.model=function(e){return arguments.length?(this._model!==e&&(this._model=e,this._streamer=new p.Node(e),this._streamer._rank=-1,this._changeset=p.ChangeSet.create(),this._handler&&this._handler.model(e)),this):this._model},b.data=function(e){var t=this;return arguments.length?l.isString(e)?r.call(t,e):(l.isObject(e)&&l.keys(e).forEach(function(a){var n=r.call(t,a);e[a](n)}),this):t._model.values()};var k=l.toMap(["width","height","padding"]);b.signal=function(e,t,a){var n=this._model,r,s;// Getter. Returns the value for the specified signal, or
// returns all signal values.
if(!arguments.length)return n.values(h.SIGNALS);// Setter. Can be done in batch or individually. In either case,
// the final argument determines if set signals should be skipped.
if(1===arguments.length&&l.isString(e))return n.values(h.SIGNALS,e);for(r in l.isObject(e)?(s=e,a=t):(s={},s[e]=t),s)k[r]?this[r](s[r]):i.call(this,r,s[r]);return this._skipSignals=a,this},b.width=function(e){return arguments.length?(this.__width!==e&&(this._width=this.__width=e,this.model().width(e),this.initialize(),this._strict&&(this._autopad=1),i.call(this,"width",e)),this):this.__width},b.height=function(e){return arguments.length?(this.__height!==e&&(this._height=this.__height=e,this.model().height(e),this.initialize(),this._strict&&(this._autopad=1),i.call(this,"height",e)),this):this.__height},b.background=function(e){return arguments.length?(this._bgcolor!==e&&(this._bgcolor=e,this.initialize()),this):this._bgcolor},b.padding=function(e){return arguments.length?(this._padding!==e&&(l.isString(e)?(this._autopad=1,this._padding={top:0,left:0,bottom:0,right:0},this._strict="strict"===e):(this._autopad=0,this._padding=e,this._strict=!1),this._renderer&&this._renderer.resize(this._width,this._height,this._padding),this._handler&&this._handler.padding(this._padding),i.call(this,"padding",this._padding)),this._repaint=!0,this):this._padding},b.autopad=function(e){if(1>this._autopad)return this;this._autopad=0;var a=s.call(this),n=this._padding,d=this.model().config(),o=d.autopadInset,p=0>a.x1?y(-a.x1)+o:0,l=0>a.y1?y(-a.y1)+o:0,t=a.x2>this._width?y(+a.x2-this._width)+o:0;return a=a.y2>this._height?y(+a.y2-this._height)+o:0,n={left:p,top:l,right:t,bottom:a},this._strict?(this._autopad=0,this._padding=n,this._width=A(0,this.__width-(p+t)),this._height=A(0,this.__height-(l+a)),this._model.width(this._width).height(this._height).reset(),i.call(this,"width",this._width),i.call(this,"height",this._height),i.call(this,"padding",n),this.initialize().update({props:"enter"}).update({props:"update"})):this.padding(n).update(e),this},b.viewport=function(e){return arguments.length?(this._viewport!==e&&(this._viewport=e,this.initialize()),this):this._viewport},b.renderer=function(e){if(!arguments.length)return this._renderer;if(this._renderers[e])e=this._renderers[e];else if(l.isString(e))throw new Error("Unknown renderer: "+e);else if(!e)throw new Error("No renderer specified");return this._io!==e&&(this._io=e,this._renderer=null,this.initialize(),this._build&&this.render()),this},b.initialize=function(e){var t=this,a=t._width,n=t._height,r=t._padding,i=t._bgcolor,s=this.model().config(),d;return(!arguments.length||null===e)&&(e=this._el?this._el.parentNode:null,!e)?this:(o.select(e).select("div.vega").remove(),this._el=e=o.select(e).append("div").attr("class","vega").style("position","relative").node(),t._viewport&&o.select(e).style("width",(t._viewport[0]||a)+"px").style("height",(t._viewport[1]||n)+"px").style("overflow","auto"),c.canvas.Renderer.RETINA=s.render.retina,t._renderer=(t._renderer||new this._io.Renderer(s.load)).initialize(e,a,n,r).background(i),d=t._handler,t._handler=new this._io.Handler().initialize(e,r,t),d?d.handlers().forEach(function(e){t._handler.on(e.type,e.handler)}):t._detach=f(this),(this._repaint=!0,this));// clear pre-existing container
},b.destroy=function(){this._detach&&this._detach()},b.update=function(e){e=e||{};var t=this,a=this._model,n=this._streamer,r=this._changeset,i=e.duration?new x(e.duration,e.ease):null;if(i&&(r.trans=i),void 0!==e.props){if(0<l.keys(r.data).length)throw Error("New data values are not reflected in the visualization. Please call view.update() before updating a specified property set.");r.reflow=!0,r.request=e.props}var s=t._build;return t._build=t._build||d.call(this),e.items&&s?(_.update(a,e.trans,e.props,e.items,r.dirty),t._renderNode.evaluate(r)):n.listeners().length&&s?(this._repaint&&n.addListener(a.node()),a.propagate(r,n,null,this._skipSignals),n.disconnect()):a.fire(r),t._changeset=p.ChangeSet.create(),t.autopad(e)},b.toImageURL=function(e){var t=this,a;// lookup appropriate renderer
switch(e||"png"){case"canvas":case"png":a=c.canvas.Renderer;break;case"svg":a=c.svg.string.Renderer;break;default:throw Error("Unrecognized renderer type: "+e);}var n=c.canvas.Renderer.RETINA;c.canvas.Renderer.RETINA=!1;// ignore retina screen
// render the scenegraph
var r=new a(t._model.config.load).initialize(null,t._width,t._height,t._padding).background(t._bgcolor).render(t._model.scene());// restore retina settings
// return data url
if(c.canvas.Renderer.RETINA=n,"svg"===e){var i=new Blob([r.svg()],{type:"image/svg+xml"});return window.URL.createObjectURL(i)}return r.canvas().toDataURL("image/png")},b.render=function(e){return this._renderer.render(this._model.scene(),e),this},b.on=function(){return this._handler.on.apply(this._handler,arguments),this},b.onSignal=function(e,t){var a=this._model.signal(e);return a?a.on(t):m.error("Signal \""+e+"\" is not defined."),this},b.off=function(){return this._handler.off.apply(this._handler,arguments),this},b.offSignal=function(e,t){var a=this._model.signal(e);return a?a.off(t):m.error("Signal \""+e+"\" is not defined."),this},n.factory=function(t){var a=e("./HeadlessView");return function(e){e=e||{};var r=t.defs(),i=(e.el?new n:new a).model(t).renderer(e.renderer||"canvas").width(r.width).height(r.height).background(r.background).padding(r.padding).viewport(r.viewport).initialize(e.el);return e.data&&i.data(e.data),e.el&&(!1!==e.hover&&i.on("mouseover",function(e,t){t&&t.hasPropertySet("hover")&&this.update({props:"hover",items:t})}).on("mouseout",function(e,t){t&&t.hasPropertySet("hover")&&this.update({props:"update",items:t})}),!1!==e.cursor&&i.onSignal("cursor",function(e,t){var a=o.select("body");l.isString(t)?(i._cursor="default"===t,a.style("cursor",t)):l.isObject(t)&&i._cursor&&a.style("cursor",t.default)})),i}},t.exports=n}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{"../parse/streams":108,"../scene/Encoder":112,"../scene/Transition":115,"./HeadlessView":89,datalib:27,"vega-dataflow":42,"vega-logging":49,"vega-scenegraph":50}],92:[function(e,t){(function(e){var a="undefined"==typeof window?"undefined"==typeof e?null:e.d3:window.d3,n={};// inset padding for automatic padding calculation
// extensible scale lookup table
// all d3.scale.* instances also supported
// default rendering settings
// root scenegraph group
// default axis properties
// default legend properties
// default color values
// default scale ranges
n.load={// base url for loading external data files
// used only for server-side operation
baseURL:"",// Allows domain restriction when using data loading via XHR.
// To enable, set it to a list of allowed domains
// e.g., ['wikipedia.org', 'eff.org']
domainWhiteList:!1},n.autopadInset=5,n.scale={time:a.time.scale,utc:a.time.scale.utc},n.render={retina:!0},n.scene={fill:void 0,fillOpacity:void 0,stroke:void 0,strokeOpacity:void 0,strokeWidth:void 0,strokeDash:void 0,strokeDashOffset:void 0},n.axis={layer:"back",ticks:10,padding:3,axisColor:"#000",axisWidth:1,gridColor:"#000",gridOpacity:.15,tickColor:"#000",tickLabelColor:"#000",tickWidth:1,tickSize:6,tickLabelFontSize:11,tickLabelFont:"sans-serif",titleColor:"#000",titleFont:"sans-serif",titleFontSize:11,titleFontWeight:"bold",titleOffset:"auto",titleOffsetAutoMin:30,titleOffsetAutoMax:1e4,titleOffsetAutoMargin:4},n.legend={orient:"right",offset:20,padding:3,// padding between legend items and border
margin:2,// extra margin between two consecutive legends
gradientStrokeColor:"#888",gradientStrokeWidth:1,gradientHeight:16,gradientWidth:100,labelColor:"#000",labelFontSize:10,labelFont:"sans-serif",labelAlign:"left",labelBaseline:"middle",labelOffset:8,symbolShape:"circle",symbolSize:50,symbolColor:"#888",symbolStrokeWidth:1,titleColor:"#000",titleFont:"sans-serif",titleFontSize:11,titleFontWeight:"bold"},n.color={rgb:[128,128,128],lab:[50,0,0],hcl:[0,0,50],hsl:[0,0,.5]},n.range={category10:a.scale.category10().range(),category20:a.scale.category20().range(),category20b:a.scale.category20b().range(),category20c:a.scale.category20c().range(),shapes:["circle","cross","diamond","square","triangle-down","triangle-up"]},t.exports=n}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{}],93:[function(e,t){function a(e,t,a){var r=e.schema;r&&(r.refs&&n.extend(a.refs,r.refs),r.defs&&n.extend(a.defs,r.defs))}var n=e("datalib"),r=e("../parse"),i=e("../scene/Scale"),s=e("./config");t.exports=function(e){var t=null;return e=e||{},e.url?t=n.json(n.extend({url:e.url},s.load)):(t={$schema:"http://json-schema.org/draft-04/schema#",title:"Vega Visualization Specification Language",defs:{},refs:{},$ref:"#/defs/spec"},n.keys(r).forEach(function(n){a(r[n],e,t)}),a(i,e,t)),e.properties&&n.keys(e.properties).forEach(function(a){t.defs.propset.properties[a]={$ref:"#/refs/"+e.properties[a]+"Value"}}),e.propertySets&&n.keys(e.propertySets).forEach(function(e){t.defs.mark.properties.properties.properties[e]={$ref:"#/defs/propset"}}),t}},{"../parse":98,"../scene/Scale":114,"./config":92,datalib:27}],94:[function(e,t){function a(e,t,a,n,i){// axis scale
var o;t.scale!==void 0&&n.scale(o=i.scale(t.scale));// grid by scaletype
var l=e.grid;r.isObject(l)&&(e.grid=l[o.type]===void 0?l.default:l[o.type]),n.orient(s(t,e,"orient",d[t.type])),n.offset(s(t,e,"offset",0)),n.layer(s(t,e,"layer","front")),n.grid(s(t,e,"grid",!1)),n.title(t.title||null),n.titleOffset(s(t,e,"titleOffset")),n.tickValues(t.values||null),n.tickFormat(t.format||null),n.tickFormatType(t.formatType||null),n.tickSubdivide(t.subdivide||0),n.tickPadding(s(t,e,"tickPadding",e.padding));// axis tick size(s)
var u=s(t,e,"tickSize"),c=[u,u,u];c[0]=s(t,e,"tickSizeMajor",c[0]),c[1]=s(t,e,"tickSizeMinor",c[1]),c[2]=s(t,e,"tickSizeEnd",c[2]),c.length&&n.tickSize.apply(n,c),n.tickCount(s(t,e,"ticks"));// style properties
var g=t.properties;g&&g.ticks?(n.majorTickProperties(g.majorTicks?r.extend({},g.ticks,g.majorTicks):g.ticks),n.minorTickProperties(g.minorTicks?r.extend({},g.ticks,g.minorTicks):g.ticks)):(n.majorTickProperties(g&&g.majorTicks||{}),n.minorTickProperties(g&&g.minorTicks||{})),n.tickLabelProperties(g&&g.labels||{}),n.titleProperties(g&&g.title||{}),n.gridLineProperties(g&&g.grid||{}),n.domainProperties(g&&g.axis||{})}function n(e){var t=e.config(),a=t.axis;return{x:r.extend(r.duplicate(a),t.axis_x),y:r.extend(r.duplicate(a),t.axis_y)}}var r=e("datalib"),i=e("../scene/axis"),s=e("../util/theme-val"),d={x:"bottom",y:"left",top:"top",bottom:"bottom",left:"left",right:"right"};t.exports=function(e,t,r,s){var d=n(e);(t||[]).forEach(function(t,n){r[n]=r[n]||i(e,d[t.type]),a(d[t.type],t,n,r[n],s)})}},{"../scene/axis":116,"../util/theme-val":150,datalib:27}],95:[function(e,t){(function(e){var a="undefined"==typeof window?"undefined"==typeof e?null:e.d3:window.d3;t.exports=function(e){// return null if input is null or undefined
return null==e?null:a.rgb(e)+"";// run through d3 rgb to sanity check
}}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{}],96:[function(e,t){function a(e,t,i){function s(e,t){r.error("PARSE DATA FAILED: "+t.name+" "+e),p=-1,i(e)}function o(t){return function(a,r){if(a)s(a,t);else if(0<p)try{e.data(t.name).values(n.read(r,t.format)),0==--p&&i()}catch(e){s(e,t)}}}// process each data set definition
var l=e.config(),p=0;return(t||[]).forEach(function(t){t.url&&(p+=1,n.load(n.extend({url:t.url},l.load),o(t)));try{a.datasource(e,t)}catch(e){s(e,t)}}),0==p&&setTimeout(i,1),t}var n=e("datalib"),r=e("vega-logging"),i=e("./transforms"),s=e("./modify");a.datasource=function(e,t){var a=(t.transform||[]).map(function(a){return i(e,a)}),r=(t.modify||[]).map(function(a){return s(e,a,t)}),d=e.data(t.name,r.concat(a));return t.values?d.values(n.read(t.values,t.format)):t.source&&(d.source(t.source).addListener(d),e.removeListener(d.pipeline()[0])),d},t.exports=a},{"./modify":102,"./transforms":109,datalib:27,"vega-logging":49}],97:[function(e,t){function a(e){return function(t){t=t.map(e);var a=t.length;if(1>a||2<a)throw Error("open takes exactly 1 or 2 arguments.");return"this.defs.open(this.model, "+t[0]+(1<a?","+t[1]:"")+")"}}function n(e,t,a){if("undefined"!=typeof window&&window&&window.open){var n=g.extend({type:"open",url:t,name:a},e.config().load),r=g.load.sanitizeUrl(n);if(r)window.open(r,a);else throw Error("Invalid URL: "+n.url)}else throw Error("Open function can only be invoked in a browser.")}function r(e,t){return function(a){a=a.map(e);var r=a.length;if(2>r||3<r)throw Error("scale takes exactly 2 or 3 arguments.");return"this.defs.scale(this.model, "+t+", "+a[0]+","+a[1]+(2<r?","+a[2]:"")+")"}}function i(e,t,a,n,r){// Verify scope is valid
if(r&&r.scale||(r=r&&r.mark?r.mark.group:e.scene().items[0]),e.group(r._id)!==r)throw Error("Scope for scale \""+a+"\" is not a valid group item.");var i=r.scale(a);return i?t?i.invert(n):i(n):n}function s(e,t,a,n){var r=t,i=a;return t>a&&(r=a,i=t),n?r<e&&i>e:r<=e&&i>=e}function d(e){return function(t,a,n,r){var i;if(3!==t.length)throw Error("indata takes 3 arguments.");if("Literal"!==t[0].type)throw Error("Data source name must be a literal for indata.");return i=t[0].value,r[i]=1,"Literal"===t[2].type&&d.model.requestIndex(i,t[2].value),t=t.map(e),"this.defs.indata(this.model,"+t[0]+","+t[1]+","+t[2]+")"}}function o(e,t,a,n){var r=e.data(t),i=r.getIndex(n);return 0<i[a]}function l(e,t){return m.format(e,"number")(t)}function p(e,t){return m.format(e,"time")(t)}function u(e,t){return m.format(e,"utc")(t)}function c(e){return function(t){d.model=e;var a=y(t);return a.model=e,a.sig=e?e._signals:{},a}}var g=e("datalib"),m=g.template,h=e("vega-expression"),f=["datum","parent","event","signals"],y=h.compiler(f,{idWhiteList:f,fieldVar:f[0],globalVar:function(e){return"this.sig["+g.str(e)+"]._value"},functions:function(e){var t=h.functions(e);return t.eventItem="event.vg.getItem",t.eventGroup="event.vg.getGroup",t.eventX="event.vg.getX",t.eventY="event.vg.getY",t.open=a(e),t.scale=r(e,!1),t.iscale=r(e,!0),t.inrange="this.defs.inrange",t.indata=d(e),t.format="this.defs.format",t.timeFormat="this.defs.timeFormat",t.utcFormat="this.defs.utcFormat",t},functionDefs:function()/*codegen*/{return{scale:i,inrange:s,indata:o,format:l,timeFormat:p,utcFormat:u,open:n}}});c.scale=i,c.codegen=y.codegen,t.exports=c},{datalib:27,"vega-expression":47}],98:[function(e,t){t.exports={axes:e("./axes"),background:e("./background"),data:e("./data"),events:e("vega-event-selector"),expr:e("./expr"),legends:e("./legends"),mark:e("./mark"),marks:e("./marks"),modify:e("./modify"),padding:e("./padding"),predicates:e("./predicates"),properties:e("./properties"),signals:e("./signals"),spec:e("./spec"),streams:e("./streams"),transforms:e("./transforms")}},{"./axes":94,"./background":95,"./data":96,"./expr":97,"./legends":99,"./mark":100,"./marks":101,"./modify":102,"./padding":103,"./predicates":104,"./properties":105,"./signals":106,"./spec":107,"./streams":108,"./transforms":109,"vega-event-selector":43}],99:[function(e,t){function a(e,t,a,n){a.size(e.size?n.scale(e.size):null),a.shape(e.shape?n.scale(e.shape):null),a.fill(e.fill?n.scale(e.fill):null),a.stroke(e.stroke?n.scale(e.stroke):null),a.opacity(e.opacity?n.scale(e.opacity):null),e.orient&&a.orient(e.orient),null!=e.offset&&a.offset(e.offset),a.title(e.title||null),a.values(e.values||null),a.format(e.format===void 0?null:e.format),a.formatType(e.formatType||null);// style properties
var r=e.properties;a.titleProperties(r&&r.title||{}),a.labelProperties(r&&r.labels||{}),a.legendProperties(r&&r.legend||{}),a.symbolProperties(r&&r.symbols||{}),a.gradientProperties(r&&r.gradient||{})}var n=e("../scene/legend");t.exports=function(e,t,r,i){(t||[]).forEach(function(t,s){r[s]=r[s]||n(e),a(t,s,r[s],i)})}},{"../scene/legend":117}],100:[function(e,t){function a(e,t,i){var s=t.properties||i&&(t.properties={}),d=s.enter||i&&(s.enter={}),o=t.marks,l=e.config().marks||{};if(i){"symbol"===t.type&&!d.size&&l.symbolSize&&(d.size={value:l.symbolSize});// Themes define a default "color" that maps to fill/stroke based on mark type.
var p={arc:"fill",area:"fill",rect:"fill",symbol:"fill",text:"fill",line:"stroke",path:"stroke",rule:"stroke"}[t.type];// Set default mark color if no color is given in spec, and only do so for
// user-defined marks (not axis/legend marks).
!d[p]&&l.color&&(d[p]={value:l.color})}// parse mark property definitions
return n.keys(s).forEach(function(a){s[a]=r(e,t.type,s[a])}),t.delay&&(t.delay=r(e,t.type,{delay:t.delay})),o&&(t.marks=o.map(function(t){return a(e,t,!0)})),t}var n=e("datalib"),r=e("./properties");t.exports=a},{"./properties":105,datalib:27}],101:[function(e,t){function a(e,t){var a=t.config().scene,o={},l,u,c,g,h;for(l=0,u=c=d.length;l<u;++l)g=d[l],void 0===(h=e[g])?a[g]?o[g]={value:a[g]}:--c:o[g]=h.signal?h:{value:h};return c?{update:r(t,"group",o)}:{}}var n=e("./mark"),r=e("./properties"),d=["fill","fillOpacity","stroke","strokeOpacity","strokeWidth","strokeDash","strokeDashOffset"];t.exports=function(e,t,r,i){return{type:"group",width:r,height:i,properties:a(t.scene||{},e),scales:t.scales||[],axes:t.axes||[],legends:t.legends||[],marks:(t.marks||[]).map(function(t){return n(e,t,!0)})}}},{"./mark":100,"./properties":105}],102:[function(e,t){function a(e,t,a,n){var r=!0,s=e.length,d,o,l,p;for(d=a.length-1;0<=d;--d){for(o=0;o<s;++o)if(l=e[o],p=t&&l(t)||t,l(a[d])!==p){r=!1;break}r&&n.push.apply(n,a.splice(d,1)),r=!0}}function n(e,a,n){var r=o.ingest(a);e.add.push(r),n._data.push(r)}var r=e("datalib"),i=e("vega-logging"),s=e("vega-dataflow"),d=s.Node,// jshint ignore:line
o=s.Tuple,l=s.Dependencies,p={INSERT:"insert",REMOVE:"remove",UPSERT:"upsert",TOGGLE:"toggle",CLEAR:"clear"},u=[];t.exports=function(e,s,c){var g=s.signal?r.field(s.signal):null,m=g?g[0]:null,h=s.predicate?e.predicate(s.predicate.name||s.predicate):null,f=s.test?e.expr(s.test):null,y=null===h&&null===f,_=s.type===p.CLEAR,v=r.array(s.field||"data"),b=v.map(r.accessor),k=v.map(r.mutator),S=new d(e).router(_);return S.evaluate=function(x){var S,w;if(null!==h&&(S=e.values(l.DATA,h.data||u),w=e.values(l.SIGNALS,h.signals||u),y=h.call(h,{},S,w,e._predicates)),null!==f&&(w=e.values(l.SIGNALS,f.globals||u),y=f.fn()),i.debug(x,[s.type+"ing",y]),!y||!_&&!x.signals[m])return x;var T=g?e.signalRef(s.signal):null,A=e.data(c.name),d=null,L=[],E=[],C=0,M;return r.isObject(T)?(M=T,!s.field&&(v=r.keys(M),b=v.map(r.accessor),k=v.map(r.mutator))):(M={},k.forEach(function(e){e(M,T)})),s.type===p.INSERT?n(x,M,A):s.type===p.REMOVE?(a(b,T,x.mod,x.rem),a(b,T,x.add,E),a(b,T,A._data,E)):s.type===p.UPSERT?(x.mod.forEach(function(e){var t=b.every(function(t){return t(e)===t(M)});t&&(C=(r.extend(e,M),C+1))}),0==C&&n(x,M,A)):s.type===p.TOGGLE?(a(b,T,x.mod,E),x.rem.push.apply(x.rem,E),a(b,T,x.add,L),L.length||E.length?A._data=A._data.filter(function(e){return 0>E.indexOf(e)&&0>L.indexOf(e)}):(x.add.push(d=o.ingest(M)),A._data.push(d))):s.type===p.CLEAR&&(x.rem.push.apply(x.rem,x.mod.splice(0)),x.add.splice(0),A._data.splice(0)),v.forEach(function(e){x.fields[e]=1}),x},m&&S.dependency(l.SIGNALS,m),h&&(S.dependency(l.DATA,h.data),S.dependency(l.SIGNALS,h.signals)),f&&(S.dependency(l.SIGNALS,f.globals),S.dependency(l.DATA,f.dataSources)),S}},{datalib:27,"vega-dataflow":42,"vega-logging":49}],103:[function(e,t){var a=e("datalib");t.exports=function(e){return null==e?"auto":a.isObject(e)?e:a.isNumber(e)?{top:e,left:e,right:e,bottom:e}:"strict"===e?e:"auto"}},{datalib:27}],104:[function(e,t){function a(e,t){var a=d.field(e),n="signals["+a.map(d.str).join("][")+"]";return t[a[0]]=1,n}function n(e,t){function n(e){u[e]=1}function r(e){c[e]=1}var s=[],l=[],u={},c={};return d.array(t).forEach(function(t,o){var i="o"+o,c="";if(void 0!==t.value)c=d.str(t.value);else if(t.arg)c="args["+d.str(t.arg)+"]";else if(t.signal)c=a(t.signal,u);else if(t.predicate){var g=t.predicate,m=g&&(g.name||g),h=e.predicate(m),f="predicates["+d.str(m)+"]";h.signals.forEach(n),h.data.forEach(r),d.isObject(g)&&d.keys(g).forEach(function(e){if("name"!==e){var t=g[e];c+="args["+d.str(e)+"] = ",t.signal?c+=a(t.signal,u):t.arg&&(c+="args["+d.str(t.arg)+"]"),c+=", "}}),c+=f+".call("+f+", args, db, signals, predicates)"}s.push(i),l.push(i+"=("+c+")")}),{code:"var "+s.join(", ")+";\n"+l.join(";\n")+";\n",signals:d.keys(u),data:d.keys(c)}}function r(e,t){var a=n(e,t.operands);return"="===t.type&&(t.type="=="),a.code+="o0 = o0 instanceof Date ? o0.getTime() : o0;\no1 = o1 instanceof Date ? o1.getTime() : o1;\n",{code:a.code+"return "+["o0","o1"].join(t.type)+";",signals:a.signals,data:a.data}}function i(e,t){for(var a=n(e,t.operands),r=[],s=0,d=t.operands.length;r.push("o"+s++)<d;);return"and"===t.type?t.type="&&":"or"===t.type&&(t.type="||"),{code:a.code+"return "+r.join(t.type)+";",signals:a.signals,data:a.data}}// Populate ops such that ultimate scale/inversion function will be in `scale` var.
function s(e,t){var a="var scale = ",n=t.length;return d.isString(e)?(t.push({value:e}),a+="this.root().scale(o"+n+")"):e.arg?(t.push(e),a+="o"+n):e.name&&(t.push(d.isString(e.name)?{value:e.name}:e.name),a+="(this.isFunction(o"+n+") ? o"+n+" : ",e.scope?(t.push(e.scope),a+="((o"+(n+1)+".scale || this.root().scale)(o"+n+") || this.nullScale)"):a+="this.root().scale(o"+n+")",a+=")"),!0===e.invert&&(a+=".invert"),a+";\n"}var d=e("datalib"),o={"=":r,"==":r,"!=":r,">":r,">=":r,"<":r,"<=":r,and:i,"&&":i,or:i,"||":i,in:function(e,t){var a=[t.item],r="";t.range&&a.push.apply(a,t.range),t.scale&&(r=s(t.scale,a));var i=n(e,a);if(r=i.code+r+"\n  var ordSet = null;\n",t.data){var o=d.field(t.field).map(d.str);r+="var where = function(d) { return d["+o.join("][")+"] == o0 };\n",r+="return db["+d.str(t.data)+"].filter(where).length > 0;"}else t.range&&(t.scale&&(r+="if (scale.length == 2) {\n  ordSet = scale(o1, o2);\n} else {\n  o1 = scale(o1);\no2 = scale(o2);\n}"),r+="return ordSet !== null ? ordSet.indexOf(o0) !== -1 :\n  o1 < o2 ? o1 <= o0 && o0 <= o2 : o2 <= o0 && o0 <= o1;");return{code:r,signals:i.signals,data:i.data.concat(t.data?[t.data]:[])}}},l=function(){return 0};l.invert=l,t.exports=function(e,t){return(t||[]).forEach(function(t){var a=o[t.type](e,t),n=Function("args","db","signals","predicates",a.code);/* jshint evil:true */n.root=function(){return e.scene().items[0]},n.nullScale=l,n.isFunction=d.isFunction,n.signals=a.signals,n.data=a.data,e.predicate(t.name,n)}),t}},{datalib:27}],105:[function(e,t){(function(a){function n(e,t){return g.isObject(e)||(e={reflow:!1,nested:[]},h.forEach(function(t){e[t]=[]})),g.isObject(t)&&(e.reflow=e.reflow||t.reflow,e.nested.push.apply(e.nested,t.nested),h.forEach(function(a){e[a].push.apply(e[a],t[a])})),e}function r(e,t){return t.path||("area"===e||"line"===e)&&(t.x||t.x2||t.width||t.y||t.y2||t.height||t.tension||t.interpolate)}function s(e,t,a){var n=a.shape,r=0,i,s;if(n&&(i=n.value)){for(t.shape&&t.shape[i]&&(i=t.shape[i]),n="";null!==(s=f.exec(i));)n+=i.substring(r,s.index),n+=e.expr(s[1]).fn(),r=f.lastIndex;a.shape.value=n+i.substring(r)}}function d(e,t,a,s){var d=e.config(),l=n(),u=[],c="";return(a||[]).forEach(function(m,r){var i=o(d,t,m);if(n(l,i),m.test){// rule uses an expression instead of a predicate.
var h=e.expr(m.test);l.signals.push.apply(l.signals,h.globals),l.data.push.apply(l.data,h.dataSources),c+="if (exprs["+s.length+"](item.datum, item.mark.group.datum, null)) {\n    d += set(o, "+g.str(t)+", "+i.val+");",c+=a[r+1]?"\n  } else ":"  }",s.push(h.fn)}else{var f=m.predicate,y=f&&(f.name||f),_=e.predicate(y),v="predicates["+g.str(y)+"]",p=[],x=t+"_arg"+r;g.isObject(f)&&g.keys(f).forEach(function(e){if("name"!==e){var t=o(d,r,f[e],!0);p.push(g.str(e)+": "+t.val),n(l,t)}}),y?(l.signals.push.apply(l.signals,_.signals),l.data.push.apply(l.data,_.data),u.push(x+" = {\n    "+p.join(",\n    ")+"\n  }"),c+="if ("+v+".call("+v+","+x+", db, signals, predicates)) {\n    d += set(o, "+g.str(t)+", "+i.val+");",c+=a[r+1]?"\n  } else ":"  }"):c+="{\n    d += set(o, "+g.str(t)+", "+i.val+");\n  }\n"}}),u.length&&(c="var "+u.join(",\n      ")+";\n  "+c),(l.code=c,l)}function o(e,t,a,r){if(null==a)return null;if("fill"===t||"stroke"===t){if(a.c)return l(e,"hcl",a.h,a.c,a.l);if(a.h||a.s)return l(e,"hsl",a.h,a.s,a.l);if(a.l||a.a)return l(e,"lab",a.l,a.a,a.b);if(a.r||a.g||a.b)return l(e,"rgb",a.r,a.g,a.b)}// initialize value
var i=null,s=null,d=n(),o=null,c=null,m=null,h={};// Collate dependencies
return void 0!==a.template&&(i=g.template.source(a.template,"tmpl",h),g.keys(h).forEach(function(e){var t=g.field(e),n=t.shift();"parent"===n||"group"===n?d.nested.push({parent:"parent"===n,group:"group"===n,level:1}):"datum"===n?d.fields.push(t[0]):d.signals.push(n)})),void 0!==a.value&&(i=g.str(a.value)),void 0!==a.signal&&(o=g.field(a.signal),i="signals["+o.map(g.str).join("][")+"]",d.signals.push(o.shift())),void 0!==a.field&&(a.field=g.isString(a.field)?{datum:a.field}:a.field,c=p(a.field),i=c.val,n(d,c)),void 0!==a.scale&&(m=u(a.scale),s=m.val,n(d,m),d.scales.push(a.scale.name||a.scale),null!==i||a.band||a.mult||a.offset||!r?i=s+(a.band?".rangeBand()":"("+(null===i?"item.datum.data":i)+")"):r&&(i=s)),i="("+(a.mult?g.number(a.mult)+" * ":"")+i+")"+(a.offset?" + "+g.number(a.offset):""),(d.val=i,d)}function l(e,t,a,r,i){var s=a?o(e,"",a):e.color[t][0],d=r?o(e,"",r):e.color[t][1],l=i?o(e,"",i):e.color[t][2],p=n();[s,d,l].forEach(function(e){g.isArray||n(p,e)});var u="(this.d3."+t+"("+[s.val,d.val,l.val].join(",")+") + \"\")";return p.val=u,p}// {field: {datum: "foo"} }  -> item.datum.foo
// {field: {group: "foo"} }  -> group.foo
// {field: {parent: "foo"} } -> group.datum.foo
function p(e){if(g.isString(e))return{val:g.field(e).map(g.str).join("][")};// Resolve nesting/parent lookups
var t=e.level||1,a=(e.group||e.parent)&&t,i=a?Array(t).join("group.mark."):"",s=p(e.datum||e.group||e.parent||e.signal),r=s.val,d=n(null,s);return e.datum?(r="item.datum["+r+"]",d.fields.push(e.datum)):e.group?(r=i+"group["+r+"]",d.nested.push({level:t,group:!0})):e.parent?(r=i+"group.datum["+r+"]",d.nested.push({level:t,parent:!0})):e.signal&&(r="signals["+r+"]",d.signals.push(g.field(e.signal)[0]),d.reflow=!0),d.val=r,d}// {scale: "x"}
// {scale: {name: "x"}},
// {scale: fieldRef}
function u(e){var t=null,a=null,r=n();return t=g.isString(e)?g.str(e):e.name?g.isString(e.name)?g.str(e.name):(a=p(e.name)).val:(a=p(e)).val,t="(item.mark._scaleRefs["+t+"] = 1, group.scale("+t+"))",e.invert&&(t+=".invert"),a&&a.nested.forEach(function(e){e.scale=!0}),a?(a.val=t,a):(r.val=t,r)}var c="undefined"==typeof window?"undefined"==typeof a?null:a.d3:window.d3,g=e("datalib"),i=e("vega-logging"),m=e("vega-dataflow").Tuple,h=["signals","scales","data","fields"],f=/{{(.*?)}}/g;t.exports=function(e,t,a){function n(e){if(null!=S[e]){var t=g.array(S[e]),a,r;for(a=0,r=t.length;a<r;++a)v[e][t[a]]=1}}function l(e){var t=(e.parent?"parent_":"group_")+e.level;v._nRefs[t]=e}var p=e.config(),u="",f=g.keys(a),y=[],_={},v={signals:{},scales:{},data:{},fields:{},nested:[],_nRefs:{},// Temp stash to de-dupe nested refs.
reflow:!1},// parsed expressions injected in the generated code
x,b,k,S;for(u+="var o = trans ? {} : item, d=0, exprs=this.exprs, set=this.tpl.set, tmpl=signals||{}, t;\ntmpl.datum  = item.datum;\ntmpl.group  = group;\ntmpl.parent = group.datum;\n",s(e,p,a),(x=0,b=f.length);x<b;++x)S=a[k=f[x]],u+=0<x?"\n  ":"  ",S.rule?(S=d(e,k,S.rule,y),u+="\n  "+S.code):g.isArray(S)?(S=d(e,k,S,y),u+="\n  "+S.code):(S=o(p,k,S),u+="d += set(o, "+g.str(k)+", "+S.val+");"),_[k]=!0,h.forEach(n),v.reflow=v.reflow||S.reflow,S.nested.length&&S.nested.forEach(l);// If nested references are present, sort them based on their level
// to speed up determination of whether encoders should be reeval'd.
g.keys(v._nRefs).forEach(function(e){v.nested.push(v._nRefs[e])}),v.nested.sort(function(e,t){return e=e.level,t=t.level,e<t?-1:e>t?1:e>=t?0:NaN}),_.x2&&(_.x?(u+="\n  if (o.x > o.x2) { \n    t = o.x;\n    d += set(o, 'x', o.x2);\n    d += set(o, 'x2', t); \n  };",u+="\n  d += set(o, 'width', (o.x2 - o.x));"):_.width?u+="\n  d += set(o, 'x', (o.x2 - o.width));":u+="\n  d += set(o, 'x', o.x2);"),_.xc&&(_.width?u+="\n  d += set(o, 'x', (o.xc - o.width/2));":u+="\n  d += set(o, 'x', o.xc);"),_.y2&&(_.y?(u+="\n  if (o.y > o.y2) { \n    t = o.y;\n    d += set(o, 'y', o.y2);\n    d += set(o, 'y2', t);\n  };",u+="\n  d += set(o, 'height', (o.y2 - o.y));"):_.height?u+="\n  d += set(o, 'y', (o.y2 - o.height));":u+="\n  d += set(o, 'y', o.y2);"),_.yc&&(_.height?u+="\n  d += set(o, 'y', (o.yc - o.height/2));":u+="\n  d += set(o, 'y', o.yc);"),r(t,_)&&(u+="\n  d += (item.touch(), 1);"),u+="\n  if (trans) trans.interpolate(item, o);",u+="\n  return d > 0;";try{/* jshint evil:true */var w=Function("item","group","trans","db","signals","predicates",u);return w.tpl=m,w.exprs=y,w.util=g,w.d3=c,g.extend(w,g.template.context),{encode:w,signals:g.keys(v.signals),scales:g.keys(v.scales),data:g.keys(v.data),fields:g.keys(v.fields),nested:v.nested,reflow:v.reflow}}catch(t){i.error(t),i.log(u)}}}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{datalib:27,"vega-dataflow":42,"vega-logging":49}],106:[function(e,t){function a(e,t){return(t||[]).forEach(function(t){if(-1!==o.indexOf(t.name))throw Error("Signal name \""+t.name+"\" is a reserved keyword ("+o.join(", ")+").");var a=e.signal(t.name,t.init).verbose(t.verbose);t.init&&t.init.expr&&(t.init.expr=e.expr(t.init.expr),a.value(n(e,t.init))),t.expr&&(t.expr=e.expr(t.expr),a.evaluate=function(r){var i=n(e,t),s=r.signals;return(i!==a.value()||a.verbose())&&(a.value(i),s[t.name]=1),s[t.name]?r:e.doNotPropagate},a.dependency(d,t.expr.globals),t.expr.globals.forEach(function(t){e.signal(t).addListener(a)}))}),t}function n(t,n){var r=n.expr,e=r.fn();return n.scale?a.scale(t,n,e):e}var r=e("datalib"),i=e("./expr"),d=e("vega-dataflow").Dependencies.SIGNALS,o=["datum","event","signals","width","height","padding"].concat(r.keys(i.codegen.functions));a.scale=function(t,a,n,s,d){var o=a.scale,l=o.name||o.signal||o,p=o.scope,u;return p&&(p.signal?p=t.signalRef(p.signal):r.isString(p)&&(u=o._expr=o._expr||t.expr(p),p=u.fn(s,d))),i.scale(t,o.invert,l,n,p)},t.exports=a},{"./expr":97,datalib:27,"vega-dataflow":42}],107:[function(e,t){var a=e("datalib"),n=e("vega-logging"),r=e("../util/theme-val"),i=e("../core/Model"),s=e("../core/View");/**
			 * Parse graph specification
			 * @param spec (object)
			 * @param config (optional object)
			 * @param viewFactory (optional function)
			 * @param callback (error, model)
			 */t.exports=function(t/*, [config,] [viewFactory,] callback */){function d(t){try{t=a.duplicate(t);var n=e("./"),i=r(t,h,"width",500),s=r(t,h,"height",500),d=n.padding(r(t,h,"padding")),p=r(t,h,"background");// create signals for width, height, padding, and cursor
g.signal("width",i),g.signal("height",s),g.signal("padding",d),o(t),g.defs({width:i,height:s,padding:d,viewport:t.viewport||null,background:n.background(p),signals:n.signals(g,t.signals),predicates:n.predicates(g,t.predicates),marks:n.marks(g,t,i,s),data:n.data(g,t.data,l)})}catch(e){l(e)}}function o(e){var t=e.signals||(e.signals=[]),a;t.some(function(e){return"cursor"===e.name&&(a=e,!0)}),a||t.push(a={name:"cursor",streams:[]}),a.init=a.init||{},a.streams.unshift({type:"mousemove",expr:"eventItem().cursor === cursor.default ? cursor : {default: eventItem().cursor}"})}function l(e){var t;e?n.error(e):t=m(g.buildIndexes()),c&&(1<c.length?c(e,t):!e&&c(t),c=null)}// do not assign any values to callback, as it will change arguments
var p=arguments.length,u=2,c=arguments[p-1],g=new i,m=s.factory,h;if(p>u&&a.isFunction(arguments[p-u])&&(m=arguments[p-u],++u),p>u&&a.isObject(arguments[p-u])&&g.config(arguments[p-u]),h=g.config(),a.isObject(t))d(t);else if(a.isString(t)){var f=a.extend({url:t},h.load);a.json(f,function(e,t){e?l("SPECIFICATION LOAD FAILED: "+e):d(t)})}else l("INVALID SPECIFICATION: Must be a valid JSON object or URL.")}},{"../core/Model":90,"../core/View":91,"../util/theme-val":150,"./":98,datalib:27,"vega-logging":49}],108:[function(e,t){(function(a){var n="undefined"==typeof window?"undefined"==typeof a?null:a.d3:window.d3,r=e("datalib"),d=e("vega-dataflow"),i=e("vega-event-selector"),s=e("./signals"),o={getItem:function(){return this.item},getGroup:function(e){var t=e?this.name[e]:this.group,a=t&&t.mark,n=a&&(a.interactive||a.interactive===void 0);return n?t:{}},getXY:function(e){var t={x:this.x,y:this.y};for("string"==typeof e&&(e=this.name[e]);e;e=e.mark&&e.mark.group)t.x-=e.x||0,t.y-=e.y||0;return t},getX:function(e){return this.getXY(e).x},getY:function(e){return this.getXY(e).y}};t.exports=function(e){// -- helper functions -----
function t(t,a){var r=n.mouse((n.event=t,e.renderer().scene())),s=e.padding(),d={},l,p,u;if(a)for(l=a.mark,p="group"===l.marktype?a:l.group,u=a;null!=u;u=u.mark.group)u.mark.def.name&&(d[u.mark.def.name]=u);d.root=e.model().scene().items[0],t.vg=Object.create(o),t.vg.group=p,t.vg.item=a||{},t.vg.name=d,t.vg.x=r[0]-s.left,t.vg.y=r[1]-s.top}function a(e,t,a,r,o){function l(e){return!e.fn(a,r,o)}var p=e.handlers[t],u=e.nodes[t],c=d.ChangeSet.create(null,!0),m=!1,f,y,_,v;for(y=0,_=p.length;y<_;++y)v=p[y],m=v.filters.some(l),m||(f=v.exp.fn(a,r,o),v.spec.scale&&(f=s.scale(g,v.spec,f,a,o)),(f!==v.signal.value()||v.signal.verbose())&&(v.signal.value(f),c.signals[v.signal.name()]=1));g.propagate(c,u)}function l(e,t,a,n){t.forEach(function(t){t.event?p(e,t,a,n):t.signal?u(e,t,a,n):t.start?c(e,t,a,n):t.stream&&(t.filters&&t.stream.forEach(function(e){e.filters=r.array(e.filters).concat(t.filters)}),l(e,t.stream,a,n))})}function p(e,t,a,n){var i=t.event,s=t.name,o=t.mark,l=t.target,p=r.array(t.filters),u=l?v:_,c=l?l+":"+i:i,m=u.nodes[c]||(u.nodes[c]=new d.Node(g)),h=u.handlers[c]||(u.handlers[c]=[]);s?p.push("!!event.vg.name[\""+s+"\"]"):o&&p.push("event.vg.item.mark && event.vg.item.mark.marktype==="+r.str(o)),h.push({signal:e,exp:a,spec:n,filters:p.map(function(e){return g.expr(e)})}),m.addListener(e)}function u(e,t,a,r){var i=e.name(),n=g.signal(i+"_vgEVALUATOR",null);n.evaluate=function(n){if(!n.signals[t.signal])return g.doNotPropagate;var d=a.fn();return r.scale&&(d=s.scale(g,r,d)),(d!==e.value()||e.verbose())&&(e.value(d),n.signals[i]=1,n.reflow=!0),n},n.dependency(d.Dependencies.SIGNALS,t.signal),n.addListener(e),g.signal(t.signal).addListener(n)}function c(e,t,a,n){var r=e.name(),i=r+"_vgGATEKEEPER",s=t.middle,d=s.filters||(s.filters=[]),o=g.signal(i)||g.signal(i,!1);// Register an anonymous signal to act as a gatekeeper. Its value is
// true or false depending on whether the start or end streams occur.
// The middle signal then simply filters for the gatekeeper's value.
l(o,[t.start],m,{}),l(o,[t.end],h,{}),d.push(o.name()),l(e,[t.middle],a,n)}var g=e.model(),m=g.expr("true"),h=g.expr("false"),f=g.defs().signals,y={handlers:{},nodes:{}},_=r.duplicate(y),// Internal event processing
v=r.duplicate(y);// External event processing
// export detach method
return r.array(f).forEach(function(e){var t=g.signal(e.name);e.expr||// Cannot have an expr and stream definition.
r.array(e.streams).forEach(function(e){var a=i.parse(e.type),n=g.expr(e.expr);l(t,a,n,e)})}),r.keys(_.handlers).forEach(function(n){e.on(n,function(e,r){e.preventDefault(),t(e,r),a(_,n,r&&r.datum||{},r&&r.mark&&r.mark.group&&r.mark.group.datum||{},e)})}),r.keys(v.handlers).forEach(function(e){function r(r){t(r),a(v,e,n.select(this).datum(),this.parentNode&&n.select(this.parentNode).datum(),r)}if("undefined"!=typeof window){for(var s=v.handlers[e],d=e.split(":"),// --> no element pseudo-selectors
o="window"===d[0]?[window]:window.document.querySelectorAll(d[0]),l=0;l<o.length;++l)o[l].addEventListener(d[1],r);s.elements=o,s.listener=r}// No external support
}),v.detach=function(){r.keys(v.handlers).forEach(function(e){for(var a=v.handlers[e],n=e.split(":"),t=r.array(a.elements),s=0;s<t.length;++s)t[s].removeEventListener(n[1],a.listener)})},v.detach}}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{"./signals":106,datalib:27,"vega-dataflow":42,"vega-event-selector":43}],109:[function(e,t){var a=e("datalib"),n=e("../transforms/index");t.exports=function(e,t){var r=n[t.type],i;if(!r)throw new Error("\""+t.type+"\" is not a valid transformation");return i=new r(e),t.output&&i.output(t.output),a.keys(t).forEach(function(e){"type"===e||"output"===e||i.param(e,t[e])}),i}},{"../transforms/index":146,datalib:27}],110:[function(e,t){function a(e,t){return this._mark=t,s.prototype.init.call(this,e).router(!0).reflows(!0).mutates(!0)}var n=e("datalib"),r=e("vega-dataflow"),i=e("vega-scenegraph"),s=r.Node,// jshint ignore:line
d=e("vega-logging"),o=i.bound,l=i.Bounds,p=e("./Encoder"),u=a.prototype=new s;u.evaluate=function(e){d.debug(e,["bounds",this._mark.marktype]);var t=this._mark,a=t.marktype,s="group"===a,u=t.items,c=0<n.array(t.def.legends).length,g=t.bounds,m=!g||e.rem.length,h,f,y,_,v,x;if("line"===a||"area"===a)o.mark(t,null,s&&!c);else if(e.add.forEach(function(e){o.item(e),m=m||g&&!g.encloses(e.bounds)}),e.mod.forEach(function(e){m=m||g&&g.alignsWith(e.bounds),o.item(e)}),m)for(g=t.bounds&&t.bounds.clear()||(t.bounds=new l),h=0,f=u.length;h<f;++h)g.union(u[h].bounds);if(s&&c){for(h=0,f=u.length;h<f;++h)for(v=u[h],v._legendPositions=null,(y=0,_=v.legendItems.length);y<_;++y)x=v.legendItems[y],p.update(this._graph,e.trans,"legendPosition",x.items,e.dirty),o.mark(x,null,!1);o.mark(t,null,!0)}return r.ChangeSet.create(e,!0)},t.exports=a},{"./Encoder":112,datalib:27,"vega-dataflow":42,"vega-logging":49,"vega-scenegraph":50}],111:[function(e,t){function a(){return arguments.length?this.init.apply(this,arguments):this}// Reactive geometry and mark-level transformations are handled here
// because they need their group's data-joined context.
function n(){var e=this._def.from,t=e.mark,a,n,r,i,s,d,o;if(t)i=this.sibling(t),a=i._isSuper?i:i._bounder,n=["vg",this._parent_id,t,a.listeners(!0).length].join("_"),r={name:n,transform:e.transform,modify:e.modify};else{if(a=this._graph.data(this._from),!a)throw Error("Data source \""+this._from+"\" is not defined.");n=["vg",this._from,this._def.type,a.listeners(!0).length].join("_"),r={name:n,source:this._from,transform:e.transform,modify:e.modify}}this._from=n,this._ds=_.datasource(this._graph,r),t?(o=new u(this._graph).addListener(this._ds.listener()),o.evaluate=function(e){var t=m.create(e),a=i._output;return t.add=a.add,t.mod=a.mod,t.rem=a.rem,t},a.addListener(o)):(s=this._ds.source().last(),d=m.create(s),d.add=s.add,d.mod=s.mod,d.rem=s.rem,d.stamp=null,this._graph.propagate(d,this._ds.listener(),s.stamp))}function r(){var e=g.ingest(new l(this._mark));// For the root node's item
return this._def.width&&g.set(e,"width",this._def.width),this._def.height&&g.set(e,"height",this._def.height),e}function i(e,t,a,n,d){var o=s(this._def.key||(n?"_id":null)),l=this._mark.items||[],p=n?e.rem:l,u=g.idMap(!n||d?a:e.mod),c=[],m,h,f,y,_,x,b;// Only mark rems as exiting. Due to keyf, there may be an add/mod
// tuple that replaces it.
for(m=0,f=p.length;m<f;++m)y=p[m]===l[m]?l[m]:o?this._map[o(p[m])]:p[m],y.status=v.EXIT;for(m=0,f=a.length;m<f;++m)_=a[m],y=o?this._map[h=o(_)]:l[m],x=!y&&(y=r.call(this),!0),y.status=x?v.ENTER:v.UPDATE,b=!x&&y.datum!==_,y.datum=_,o&&(g.set(y,"key",h),this._map[h]=y),x?t.add.push(y):(b||u[_._id])&&t.mod.push(y),c.push(y);for(m=0,f=p.length;m<f;++m)y=p[m]===l[m]?l[m]:o?this._map[h=o(p[m])]:p[m],y.status===v.EXIT&&(y._dirty=!0,e.dirty.push(y),c.push(y),t.rem.push(y),o&&(this._map[h]=null));return this._mark.items=c,t}function s(e){if(null==e)return null;var t=d.array(e).map(d.accessor);return function(e){for(var a="",r=0,d=t.length;r<d;++r)0<r&&(a+="|"),a+=t[r](e)+"";return a}}var d=e("datalib"),o=e("vega-logging"),l=e("vega-scenegraph").Item,p=e("vega-dataflow"),u=p.Node,// jshint ignore:line
c=p.Dependencies,g=p.Tuple,m=p.ChangeSet,h={},f=e("./Encoder"),y=e("./Bounder"),_=e("../parse/data"),v=a.STATUS={ENTER:"enter",UPDATE:"update",EXIT:"exit"},x=a.prototype=new u;x.init=function(e,t,a,r,i,s){return u.prototype.init.call(this,e).router(!0).collector(!0),this._def=t,this._mark=a,this._from=(t.from?t.from.data:null)||s,this._ds=d.isString(this._from)?e.data(this._from):null,this._map={},this._status=null,a.def=t,a.marktype=t.type,a.interactive=!1!==t.interactive,a.items=[],d.isValid(t.name)&&(a.name=t.name),this._parent=r,this._parent_id=i,t.from&&(t.from.mark||t.from.transform||t.from.modify)&&n.call(this),this._isSuper="group"!==this._def.type,this._encoder=new f(this._graph,this._mark,this),this._bounder=new y(this._graph,this._mark),this._output=null,this._ds&&this._encoder.dependency(c.DATA,this._from),this.dependency(c.DATA,this._encoder.dependency(c.DATA)),this.dependency(c.SCALES,this._encoder.dependency(c.SCALES)),this.dependency(c.SIGNALS,this._encoder.dependency(c.SIGNALS)),this},x.ds=function(){return this._ds},x.parent=function(){return this._parent},x.encoder=function(){return this._encoder},x.pipeline=function(){return[this]},x.connect=function(){var e=this;return this._graph.connect(this.pipeline()),this._encoder._scales.forEach(function(t){(t=e._parent.scale(t))&&t.addListener(e)}),this._parent&&(this._isSuper?this.addListener(this._parent._collector):this._bounder.addListener(this._parent._collector)),(this._status=1,this)},x.disconnect=function(){function e(e){for(var a=0,n=e.length,r;a<n;++a)(r=t._parent.scale(e[a]))&&r.removeListener(t)}var t=this;return this._listeners.length?(u.prototype.disconnect.call(this),this._graph.disconnect(this.pipeline()),e(this._encoder._scales),e(d.keys(this._mark._scaleRefs)),(this._status=2,this)):this},x.sibling=function(e){return this._parent.child(e,this._parent_id)},x.evaluate=function(e){o.debug(e,["building",this._from||this._def.from,this._def.type]);var t=this,a=this._mark.def,n=a.properties||{},r=n.update||{},s=m.create(e),l,p,u,g;if(this._ds){if(u=s.data[g=this._ds.name()],s.data[g]=null,l=this._encoder.reevaluate(s),s.data[g]=u,p=this._ds.last(),!p)throw Error("Builder evaluated before backing DataSource.");p.stamp>this._stamp?i.call(this,p,s,this._ds.values(),!0,l):l&&(s.mod=this._mark.items.slice())}else u=d.isFunction(this._def.from)?this._def.from():[h],i.call(this,e,s,u);// Stash output before Bounder for downstream reactive geometry.
return this._output=s=this._graph.evaluate(s,this._encoder),r.nested&&r.nested.length&&1===this._status&&d.keys(this._mark._scaleRefs).forEach(function(e){var a=t._parent.scale(e);a&&(a.addListener(t),t.dependency(c.SCALES,e),t._encoder.dependency(c.SCALES,e))}),this._isSuper&&(s.mod=s.mod.filter(function(e){return e._dirty}),s=this._graph.evaluate(s,this._bounder)),s},t.exports=a},{"../parse/data":96,"./Bounder":110,"./Encoder":112,datalib:27,"vega-dataflow":42,"vega-logging":49,"vega-scenegraph":50}],112:[function(e,t){function a(e,t,a){var n=t.def.properties||{},r=n.enter,i=n.update,d=n.exit;l.prototype.init.call(this,e),this._mark=t,this._builder=a;var o=this._scales=[];// Only scales used in the 'update' property set are set as
// encoder depedencies to have targeted reevaluations. However,
// we still want scales in 'enter' and 'exit' to be evaluated
// before the encoder.
return r&&o.push.apply(o,r.scales),i&&(this.dependency(p.DATA,i.data),this.dependency(p.SIGNALS,i.signals),this.dependency(p.FIELDS,i.fields),this.dependency(p.SCALES,i.scales),o.push.apply(o,i.scales)),d&&o.push.apply(o,d.scales),this.mutates(!0)}// Only marshal necessary data and signal values
function n(e,t,a,n){var r=a.add.length,i,s,d;return(i=n.enter)&&(s=i[e]).length&&r&&(d=t.values(e,s,d=d||{})),(i=n.exit)&&(s=i[e]).length&&a.rem.length&&(d=t.values(e,s,d=d||{})),(i=n.update)&&(s=i[e]).length&&(r||a.mod.length)&&(d=t.values(e,s,d=d||{})),d||c}function r(e,t,a,n,r,i,s){var d=e.encode,o=t._dirty,l=d.call(d,t,t.mark.group||t,a,n,r,i);t._dirty=l||o,l&&!o&&s.push(t)}// If a specified property set called, or update property set
// uses nested fieldrefs, reevaluate all items.
// Test if any nested refs trigger a reflow of mark items.
function i(){for(var e=this._mark.def.properties.update.nested,t=this._builder,a=0,n=0,r=e.length,s,d,o;n<r;++n)// Scale references are resolved via this._mark._scaleRefs which are
// added to dependency lists + connected in Builder.evaluate.
if(s=e[n],!s.scale){for(;a<s.level;++a)t=t.parent(),d=t.ds();// Compare stamps to determine if a change in a group's properties
// or data should trigger a reeval. We cannot check anything fancier
// (e.g., pulse.fields) as the ref may use item.datum.
if(o=(s.group?t.encoder():d.last())._stamp,o>this._stamp)return!0}return!1}// Short-circuit encoder if user specifies items
var s=e("datalib"),d=e("vega-logging"),o=e("vega-dataflow"),l=o.Node,// jshint ignore:line
p=o.Dependencies,u=e("vega-scenegraph").bound,c={},g=a.prototype=new l;g.evaluate=function(t){d.debug(t,["encoding",this._mark.def.type]);var a=this._graph,s=this._mark.def.properties||{},o=this._mark.items,l=s.enter,u=s.update,g=s.exit,m=t.dirty,h=a.predicates(),f=t.request,y=this._mark.group,_=y&&(y.mark.axis||y.mark.legend),v=c,x=c,b,k,S,w;if(f&&!_){if((w=s[f])&&t.mod.length)for(v=w.data?a.values(p.DATA,w.data):null,x=w.signals?a.values(p.SIGNALS,w.signals):null,(b=0,k=t.mod.length);b<k;++b)S=t.mod[b],r.call(this,w,S,t.trans,v,x,h,m);return t;// exit early if given request
}// Items marked for removal are at the tail of items. Process them first.
for(v=n(p.DATA,a,t,s),x=n(p.SIGNALS,a,t,s),(b=0,k=t.rem.length);b<k;++b)S=t.rem[b],g&&r.call(this,g,S,t.trans,v,x,h,m),t.trans&&!g?t.trans.interpolate(S,c):!t.trans&&o.pop();var T=e("./Builder").STATUS.UPDATE;for(b=0,k=t.add.length;b<k;++b)S=t.add[b],l&&r.call(this,l,S,t.trans,v,x,h,m),u&&r.call(this,u,S,t.trans,v,x,h,m),S.status=T;if(u)for(b=0,k=t.mod.length;b<k;++b)S=t.mod[b],r.call(this,u,S,t.trans,v,x,h,m);return t},g.reevaluate=function(e){var t=this._mark.def,a=t.properties||{},n=s.isFunction(t.from)||t.orient||e.request||l.prototype.reevaluate.call(this,e);return n||!!a.update&&i.call(this)},a.update=function(e,t,a,n,d){n=s.array(n);var o=e.predicates(),l=e.values(p.DATA),c=e.values(p.SIGNALS),g,m,h,f,y;for(g=0,m=n.length;g<m;++g)h=n[g],f=h.mark.def.properties,y=f&&f[a],y&&(r.call(null,y,h,t,l,c,o,d),u.item(h))},t.exports=a},{"./Builder":111,datalib:27,"vega-dataflow":42,"vega-logging":49,"vega-scenegraph":50}],113:[function(e,t){function n(){return this._children={},this._scaler=null,this._recursor=null,this._scales={},this.scale=i.bind(this),arguments.length?this.init.apply(this,arguments):this}function r(e){function t(e){e.type!=x.MARK||e.inline||s._graph.data(e.from)===void 0||s._recursor.removeListener(e.builder)}function a(t){var a=t.scale();e.scales[a.scaleName]&&t.reset().def()}function n(t){var a=t.size()||t.shape()||t.fill()||t.stroke()||t.opacity();e.scales[a.scaleName]&&t.reset().def()}function r(e){s._recursor.removeListener(e.builder),e.builder.disconnect()}var s=this,u=0<p.array(this._def.marks).length,g=0<p.array(this._def.axes).length,m=0<p.array(this._def.legends).length,h=!1,f,y,_,v,b,k,S;for(f=0,v=e.add.length;f<v;++f)b=e.add[f],u&&d.call(this,e,b),g&&o.call(this,e,b),m&&l.call(this,e,b);// Wire up new children builders in reverse to minimize graph rewrites.
for(f=e.add.length-1;0<=f;--f)for(b=e.add[f],y=this._children[b._id].length-1;0<=y;--y)// This new child needs to be built during this propagation cycle.
// We could add its builder as a listener off the _recursor node,
// but try to inline it if we can to minimize graph dispatches.
// Reactive geom source
// Reactive geom target
_=this._children[b._id][y],_.builder.connect(),k=_.builder.pipeline(),S=_.builder._def,h=S.type!==x.GROUP,h=h&&void 0!==this._graph.data(_.from),h=h&&1===k[k.length-1].listeners().length,h=h&&S.from&&!S.from.mark,_.inline=h,h?this._graph.evaluate(e,_.builder):this._recursor.addListener(_.builder);for(f=0,v=e.mod.length;f<v;++f)b=e.mod[f],u&&s._children[b._id].forEach(t),g&&b.axes.forEach(a),m&&b.legends.forEach(n);for(f=0,v=e.rem.length;f<v;++f)// For deleted groups, disconnect their children
b=e.rem[f],s._children[b._id].forEach(r),delete s._children[b._id];return e}function i(e,t){var a=this,n=null;if(2===arguments.length)return a._scales[e]=t,t;for(;null==n&&(n=a._scales[e],a=a.mark?a.mark.group:a._parent,!!a););return n}function s(e,t){// Index group by ID to enable safe scoped scale lookups.
h.debug(e,["building group",t._id]),t._scales=t._scales||{},t.scale=i.bind(t),t.items=t.items||[],this._children[t._id]=this._children[t._id]||[],t.axes=t.axes||[],t.axisItems=t.axisItems||[],t.legends=t.legends||[],t.legendItems=t.legendItems||[],this._graph.group(t._id,t)}function d(e,t){h.debug(e,["building children marks #"+t._id]);var a=this._def.marks,r,s,d,o,l,p;for(o=0,l=a.length;o<l;++o)r=a[o],s=r.from||{},d=t.datum._facetID,t.items[o]={group:t,_scaleRefs:{}},p=r.type===x.GROUP?new n:new f,p.init(this._graph,r,t.items[o],this,t._id,d),this._children[t._id].push({builder:p,from:s.data||(s.mark?"vg_"+t._id+"_"+s.mark:d),type:x.MARK})}function o(e,t){var a=t.axes,r=t.axisItems,s=this;_(this._graph,this._def.axes,a,t),a.forEach(function(e,a){var i=s._def.axes[a].scale,d=e.def(),o=null;r[a]={group:t,axis:e,layer:d.layer},o=d.type===x.GROUP?new n:new f,o.init(s._graph,d,r[a],s).dependency(c.SCALES,i),s._children[t._id].push({builder:o,type:x.AXIS,scale:i})})}function l(e,t){var a=t.legends,r=t.legendItems,s=this;v(this._graph,this._def.legends,a,t),a.forEach(function(e,a){var i=e.size()||e.shape()||e.fill()||e.stroke()||e.opacity(),d=e.def(),o=null;r[a]={group:t,legend:e},o=d.type===x.GROUP?new n:new f,o.init(s._graph,d,r[a],s).dependency(c.SCALES,i),s._children[t._id].push({builder:o,type:x.LEGEND,scale:i})})}var p=e("datalib"),a=e("vega-dataflow"),u=a.Node,// jshint ignore:line
c=a.Dependencies,g=a.Tuple,m=a.Collector,h=e("vega-logging"),f=e("./Builder"),y=e("./Scale"),_=e("../parse/axes"),v=e("../parse/legends"),x=n.TYPES={GROUP:"group",MARK:"mark",AXIS:"axis",LEGEND:"legend"},b=n.prototype=new f;b.init=function(e,t){var a=this,n;this._scaler=new u(e),(t.scales||[]).forEach(function(t){t=a.scale(n=t.name,new y(e,t,a)),a.scale(n+":prev",t),a._scaler.addListener(t)}// Scales should be computed after group is encoded
),this._recursor=new u(e),this._recursor.evaluate=r.bind(this);var i=(t.axes||[]).reduce(function(e,t){return e[t.scale]=1,e},{});return i=(t.legends||[]).reduce(function(e,t){return e[t.size||t.shape||t.fill||t.stroke||t.opacity]=1,e},i),this._recursor.dependency(c.SCALES,p.keys(i)),this._collector=new m(e),f.prototype.init.apply(this,arguments)},b.evaluate=function(){var e=f.prototype.evaluate.apply(this,arguments),t=this._graph,a=this,n=this._scales,r=this._mark.items;// If scales need to be reevaluated, we need to send all group items forward.
if(e.mod.length<r.length){var i=p.keys(n).some(function(t){return n[t].reevaluate(e)});!i&&this._def.axes&&(i=this._def.axes.reduce(function(t,n){return t||e.scales[n.scale]},!1)),!i&&this._def.legends&&(i=this._def.legends.reduce(function(t,a){return t||e.scales[a.size||a.shape||a.fill||a.stroke]},!1)),i&&(e.mod=e.mod.concat(g.idFilter(r,e.mod,e.add,e.rem)))}return e.add.forEach(function(t){s.call(a,e,t)}),e.rem.forEach(function(e){t.group(e._id,null)}),e},b.pipeline=function(){return[this,this._scaler,this._recursor,this._collector,this._bounder]},b.disconnect=function(){var e=this;return p.keys(e._children).forEach(function(t){e._children[t].forEach(function(t){e._recursor.removeListener(t.builder),t.builder.disconnect()})}),e._children={},f.prototype.disconnect.call(this)},b.child=function(e,t){for(var a=this._children[t],n=0,r=a.length,s;n<r&&(s=a[n],s.type!=x.MARK||s.builder._def.name!=e);++n);return s.builder},t.exports=n},{"../parse/axes":94,"../parse/legends":99,"./Builder":111,"./Scale":114,datalib:27,"vega-dataflow":42,"vega-logging":49}],114:[function(e,t){(function(a){function n(e,t,a){return this._def=t,this._parent=a,this._updated=!1,S.prototype.init.call(this,e).reflows(!0)}function r(e){var t=this._def.name,a=t+":prev",n=i.call(this,e.scale(t)),r=n.type===C.ORDINAL?d:l,s=v.call(this,e);return r.call(this,n,s,e),e.scale(t,n),e.scale(a,e.scale(a)||n),n}function i(e){var t=this._graph.config(),a=this._def.type||C.LINEAR;if(!e||a!==e.type){var n=t.scale[a]||x.scale[a];if(!n)throw Error("Unrecognized scale type: "+a);(e=n()).type=e.type||a,e.scaleName=this._def.name,e._prev={}}return e}function d(e,t,a){var n=this._def,r=e._prev,i=!1,s=y.call(this,n.padding)||0,d=null==n.outerPadding?s:y.call(this,n.outerPadding),l=n.points&&y.call(this,n.points),p=y.call(this,n.round)||null==n.round,u=!0,c,g;// range pre-processing for data-driven ranges
// range
if(k.isObject(n.range)&&!k.isArray(n.range)&&(i=!0,t=f.call(this,M.RANGE,n.range,e,a)),c=f.call(this,M.DOMAIN,n.domain,e,a),c&&!k.equal(r.domain,c)&&(e.domain(c),r.domain=c,this._updated=!0),!k.equal(r.range,t)){// width-defined range
if(n.bandSize){var m=y.call(this,n.bandSize),h=c.length,_=n.points?s*m:s*m*(h-1)+2*d,v;t[0]>t[1]?(v=t[1]||0,t=[v+(m*h+_),v]):(v=t[0]||0,t=[v,v+(m*h+_)]),n.reverse&&(t=t.reverse())}g="string"==typeof t[0],g||2<t.length||1===t.length||i?(e.range(t),u=!1):l&&p?e.rangeRoundPoints(t,s):l?e.rangePoints(t,s):p?e.rangeRoundBands(t,s,d):e.rangeBands(t,s,d),r.range=t,this._updated=!0}!e.invert&&u&&o(e)}// "Polyfill" ordinal scale inversion. Currently, only ordinal scales
// with ordered numeric ranges are supported.
function o(e){e.invert=function(t,i){var s=e.range(),d=s[0]<s[1],o=d?P:I;if(1===arguments.length){if(!k.isNumber(t))throw Error("Ordinal scale inversion is only supported for numeric input ("+t+").");return e.domain()[o(s,t)]}if(2===arguments.length){// Invert extents
if(!k.isNumber(t)||!k.isNumber(i))throw Error("Extents to ordinal invert are not numbers ("+t+", "+i+").");var l=e.domain(),p=o(s,t),u=o(s,i),c=s.length-1,n;return u<p&&(n=p,p=u,u=p),0>p&&(p=0),u>c&&(u=c),(d?k.range(p,u+1):k.range(u,p-1,-1)).map(function(e){return l[e]})}}}function l(e,t,a){var n=this._def,r=e._prev,i=y.call(this,n.round),s=y.call(this,n.exponent),d=y.call(this,n.clamp),o=y.call(this,n.nice),l,p;// domain
l=n.type===C.QUANTILE?f.call(this,M.DOMAIN,n.domain,e,a):_.call(this,e,a),l&&!k.equal(r.domain,l)&&(e.domain(l),r.domain=l,this._updated=!0),"height"===y.call(this,n.range)&&(t=t.reverse()),t&&!k.equal(r.range,t)&&(e[i&&e.rangeRound?"rangeRound":"range"](t),r.range=t,this._updated=!0),s&&n.type===C.POWER&&e.exponent(s),d&&e.clamp(!0),o&&(n.type===C.TIME?(p=x.time[o],!p&&b.error("Unrecognized interval: "+p),e.nice(p)):e.nice())}function p(e){return e.type===C.ORDINAL||e.type===C.QUANTILE}function u(e){return e.fields||k.array(e)}function c(e){return e.some(function(e){return!e.data||e.data&&k.array(e.field).some(function(e){return e.parent})})}function g(e,t){return k.array(e.field).map(function(e){return e.parent?k.accessor(e.parent)(t.datum):e;// String or {'signal'}
})}// Scale datarefs can be computed over multiple schema types.
// This function determines the type of aggregator created, and
// what data is sent to it: values, tuples, or multi-tuples that must
// be standardized into a consistent schema.
function m(e,t){var a=u(e);// If we're operating over only a single domain, send full tuples
// through for efficiency (fewer accessor creations/calls)
// If we don't sort, then we can send values directly to aggrs as well
return 1==a.length&&1==k.array(a[0].field).length?L.TYPES.TUPLE:p(t)?k.isObject(e.sort)?L.TYPES.MULTI:L.TYPES.VALUE:L.TYPES.VALUE;// With quantitative scales, we only care about min/max.
}function h(e,t,a,n){var r=u(t),i=c(r),s=m(t,a),d=p(a),o=t.sort,l="_"+e,h=g(r[0],n);if(a[l]||this[l])return a[l]||this[l];var f=new L(this._graph).type(s),y,_;// If a scale's dataref doesn't inherit data from the group, we can
// store the dataref aggregator at the Scale (dataflow node) level.
return i?a[l]=f:this[l]=f,d?s===L.TYPES.VALUE?(y=[{name:M.GROUPBY,get:k.identity}],_={"*":M.COUNT}):s===L.TYPES.TUPLE?(y=[{name:M.GROUPBY,get:k.$(h[0])}],_=k.isObject(o)?[{field:M.VALUE,get:k.$(o.field),ops:[o.op]}]:{"*":M.COUNT}):(y=M.GROUPBY,_=[{field:M.VALUE,ops:[o.op]}]):(y=[],_=[{field:M.VALUE,get:s==L.TYPES.TUPLE?k.$(h[0]):k.identity,ops:[M.MIN,M.MAX],as:[M.MIN,M.MAX]}]),f.param("groupby",y).param("summarize",_),(f._lastUpdate=-1,f)}function f(e,t,a,n){function r(e){d.dependency(T.SIGNALS,e)}if(null==t)return[];if(k.isArray(t))return t.map(y.bind(this));var d=this,o=this._graph,l=u(t),f=c(l),_=m(t,a),v=h.apply(this,arguments),x=t.sort,b=p(a),S,s,w,A,E,C,D,P,I,z;if(f||!f&&v._lastUpdate<this._stamp){for(S=0,s=l.length;S<s;++S)if(E=l[S],I=E.data||n.datum._facetID,P=o.data(I).last(),!(P.stamp<=this._stamp)){for(C=g(E,n),w=0,A=C.length;w<A;++w)// Else (Tuple-case) is handled by the aggregator accessors by default
D=C[w],_===L.TYPES.VALUE?v.accessors(null,D):_===L.TYPES.MULTI&&v.accessors(D,E.sort||x.field),v.evaluate(P);this.dependency(T.DATA,I),v.dependency(T.SIGNALS).forEach(r)}v._lastUpdate=this._stamp,P=v.aggr().result(),b?(k.isObject(x)?(z=x.op+"_"+M.VALUE,z=k.comparator(z)):!0===x&&(z=k.comparator(M.GROUPBY)),z&&(P=P.sort(z)),v._values=P.map(function(e){return e[M.GROUPBY]})):(P=P[0],v._values=k.isValid(P)?[P[M.MIN],P[M.MAX]]:[])}return v._values}function y(e){if(!e||!e.signal)return e;var t=e.signal,a;return this.dependency(T.SIGNALS,(a=k.field(t))[0]),this._graph.signalRef(a)}function _(e,t){var a=this._def,n=[null,null],r,i;return void 0!==a.domain&&(n=k.isObject(a.domain)?f.call(this,M.DOMAIN,a.domain,e,t):n),i=n.length-1,void 0!==a.domainMin&&(k.isObject(a.domainMin)?a.domainMin.signal?n[0]=k.isValid(r=y.call(this,a.domainMin))?r:n[0]:n[0]=f.call(this,M.DOMAIN+M.MIN,a.domainMin,e,t)[0]:n[0]=a.domainMin),void 0!==a.domainMax&&(k.isObject(a.domainMax)?a.domainMax.signal?n[i]=k.isValid(r=y.call(this,a.domainMax))?r:n[i]:n[i]=f.call(this,M.DOMAIN+M.MAX,a.domainMax,e,t)[1]:n[i]=a.domainMax),a.type!==C.LOG&&a.type!==C.TIME&&a.type!==C.TIME_UTC&&(a.zero||void 0===a.zero)&&(n[0]=w(0,n[0]),n[i]=A(0,n[i])),n}function v(e){var t=this._def,a=this._graph.config(),n=y.call(this,t.range),r=[null,null];if(void 0!==n)if("string"==typeof n){if(E[n])r=[0,e[n]];else if(a.range[n])r=a.range[n];else return b.error("Unrecogized range: "+n),r;}else if(k.isArray(n))r=k.duplicate(n).map(y.bind(this));else{if(k.isObject(n))return null;// early exit
r=[0,n]}if(void 0!==t.rangeMin&&(r[0]=t.rangeMin.signal?y.call(this,t.rangeMin):t.rangeMin),void 0!==t.rangeMax&&(r[r.length-1]=t.rangeMax.signal?y.call(this,t.rangeMax):t.rangeMax),void 0!==t.reverse){var i=y.call(this,t.reverse);k.isObject(i)&&(i=k.accessor(i.field)(e.datum)),i&&(r=r.reverse())}var s=r[0],d=r[r.length-1];return(null===s&&null!==d||null!==s&&null===d)&&b.error("Range is underspecified. Please ensure either the \"range\" property or both \"rangeMin\" and \"rangeMax\" are specified."),r}var x="undefined"==typeof window?"undefined"==typeof a?null:a.d3:window.d3,k=e("datalib"),s=e("vega-dataflow"),b=e("vega-logging"),S=s.Node,// jshint ignore:line
T=s.Dependencies,L=e("../transforms/Aggregate"),E={width:1,height:1},C={LINEAR:"linear",ORDINAL:"ordinal",LOG:"log",POWER:"pow",SQRT:"sqrt",TIME:"time",TIME_UTC:"utc",QUANTILE:"quantile",QUANTIZE:"quantize",THRESHOLD:"threshold"},M={DOMAIN:"domain",RANGE:"range",COUNT:"count",GROUPBY:"groupby",MIN:"min",MAX:"max",VALUE:"value",ASC:"asc",DESC:"desc"},D=n.prototype=new S;D.evaluate=function(e){var t=this,a=function(e){r.call(t,e)};return this._updated=!1,e.add.forEach(a),e.mod.forEach(a),this._updated&&(e.scales[this._def.name]=1,b.debug(e,["scale",this._def.name])),s.ChangeSet.create(e,!0)},D.dependency=function(e,t){if(2==arguments.length){var a=e===T.DATA?"data":"signal";t=k.array(t);for(var n=0,r=t.length;n<r;++n)this._graph[a](t[n]).addListener(this._parent)}return S.prototype.dependency.call(this,e,t)};var j=x.bisector(k.numcmp).right,P=function(e,t){return j(e,t)-1},I=x.bisector(function(e,t){return-1*k.numcmp(e,t)}).left;t.exports=n}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{"../transforms/Aggregate":119,datalib:27,"vega-dataflow":42,"vega-logging":49}],115:[function(e,t){(function(a){function n(e,t){this.duration=e||500,this.ease=t&&i.ease(t)||i.ease("cubic-in-out"),this.updates={next:null}}function r(t){for(var a=this.updates,r=a,d=r.next,l=this.duration,p=!0,u,c,g,m,h,y;null!=d;r=d,d=r.next){if(u=d.item,c=u.delay||0,g=(t-c)/l,0>g){p=!1;continue}for(1<g&&(g=1),m=d.ease(g),(h=0,y=d.length);h<y;++h)u[d[h].property]=d[h](m);u.touch(),s.item(u),1===g?(d.remove&&(u.status=o.EXIT,u.remove()),r.next=d.next,d=r):p=!1}return this.callback(),p}var i="undefined"==typeof window?"undefined"==typeof a?null:a.d3:window.d3,s=e("vega-scenegraph").bound,d=e("vega-dataflow").Tuple,o=e("./Builder").STATUS,l=n.prototype,p={text:1,url:1};l.interpolate=function(e,t){var a=null,n,r,s,l;for(n in t)r=e[n],s=t[n],r!==s&&(p[n]||void 0===r?d.set(e,n,s):"number"!=typeof r||isFinite(r)?(l=i.interpolate(r,s),l.property=n,(a||(a=[])).push(l)):d.set(e,n,s));return null===a&&e.status===o.EXIT&&(a=[]),null!=a&&(a.item=e,a.ease=e.mark.ease||this.ease,a.next=this.updates.next,this.updates.next=a),this},l.start=function(e){for(var a=this,t=a.updates,n=t.next;null!=n;t=n,n=t.next)n.item.status===o.EXIT&&(// Only mark item as exited when it is removed.
n.item.status=o.UPDATE,n.remove=!0);a.callback=e,i.timer(function(e){return r.call(a,e)})},t.exports=n}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{"./Builder":111,"vega-dataflow":42,"vega-scenegraph":50}],116:[function(e,t){function a(e,t,a){var s=[];if(a&&1<t.length){for(var o=r(e.domain()),l=-1,p=t.length,n=(t[1]-t[0])/++a,d,u;++l<p;)for(d=a;0<--d;)(u=+t[l]-d*n)>=o[0]&&s.push(u);for(--l,d=0;++d<a&&(u=+t[l]+d*n)<o[1];)s.push(u)}return s}function r(e){var t=e[0],a=e[e.length-1];return t<a?[t,a]:[a,t]}function i(e){return e.rangeExtent?e.rangeExtent():r(e.range())}function s(e,t,a,n,r,i){r=A(r,0)+i,("left"===e||"top"===e)&&(r*=-1),"top"===e||"bottom"===e?(f.extend(t.properties.enter,{x:a,y:{value:r}}),f.extend(t.properties.update,{x:n,y:{value:r},align:{value:"center"},baseline:{value:S[e]}})):(f.extend(t.properties.enter,{x:{value:r},y:a}),f.extend(t.properties.update,{x:{value:r},y:n,align:{value:k[e]},baseline:{value:"middle"}}))}function d(e,t,a,n,r,i,s,d){var o="left"===e||"top"===e?-1:1;// Update offset of tick placement to be in between ordinal marks
// instead of directly aligned with.
if(r=r===1/0?"top"===e||"bottom"===e?{field:{group:"height",level:2},mult:-o,offset:d*-o}:{field:{group:"width",level:2},mult:-o,offset:d*-o}:{value:o*r,offset:d},"between"===s.tickPlacement&&"ordinal"===i.type){var l=i.range(),p=.5+(i.rangeBand()||(l[1]-l[0])/2);n=a=f.duplicate(n),n.offset=a.offset=p}"top"===e||"bottom"===e?(f.extend(t.properties.enter,{x:a,y:{value:0},y2:r}),f.extend(t.properties.update,{x:n,y:{value:0},y2:r}),f.extend(t.properties.exit,{x:n})):(f.extend(t.properties.enter,{x:{value:0},x2:r,y:a}),f.extend(t.properties.update,{x:{value:0},x2:r,y:n}),f.extend(t.properties.exit,{y:n}))}function o(e,t,a,n){var r=t.properties.update,i=~~((a[0]+a[1])/2),s="top"===e||"left"===e?-1:1;"bottom"===e||"top"===e?(r.x={value:i},r.angle={value:0},0<=n&&(r.y={value:s*n})):(r.y={value:i},r.angle={value:"left"===e?-90:90},0<=n&&(r.x={value:s*n}))}function l(e,t,a,n){var r;("top"===e||"left"===e)&&(n=-1*n),r="bottom"===e||"top"===e?"M"+a[0]+","+n+"V0H"+a[1]+"V"+n:"M"+n+","+a[0]+"H0V"+a[1]+"H"+n,t.properties.update.path={value:r}}function p(e,t,a){var r=a?{}:e,i=e.mark.def.offset,s=e.mark.def.orient,d=t.width,o=t.height;// TODO fallback to global w,h?
if(f.isArray(i)){var l=i[0],p=i[1];switch(s){case"left":{n.set(r,"x",-l),n.set(r,"y",p);break}case"right":{n.set(r,"x",d+l),n.set(r,"y",p);break}case"bottom":{n.set(r,"x",l),n.set(r,"y",o+p);break}case"top":{n.set(r,"x",l),n.set(r,"y",-p);break}default:n.set(r,"x",l),n.set(r,"y",p);}}else switch(f.isObject(i)&&(i=-t.scale(i.scale)(i.value)),s){case"left":{n.set(r,"x",-i),n.set(r,"y",0);break}case"right":{n.set(r,"x",d+i),n.set(r,"y",0);break}case"bottom":{n.set(r,"x",0),n.set(r,"y",o+i);break}case"top":{n.set(r,"x",0),n.set(r,"y",-i);break}default:n.set(r,"x",0),n.set(r,"y",0);}return a&&a.interpolate(e,r),!0}function u(e){return{type:"rule",interactive:!1,key:"data",properties:{enter:{stroke:{value:e.tickColor},strokeWidth:{value:e.tickWidth},opacity:{value:1e-6}},exit:{opacity:{value:1e-6}},update:{opacity:{value:1}}}}}function c(e){return{type:"text",interactive:!0,key:"data",properties:{enter:{fill:{value:e.tickLabelColor},font:{value:e.tickLabelFont},fontSize:{value:e.tickLabelFontSize},opacity:{value:1e-6},text:{field:"label"}},exit:{opacity:{value:1e-6}},update:{opacity:{value:1}}}}}function g(e){return{type:"text",interactive:!0,properties:{enter:{font:{value:e.titleFont},fontSize:{value:e.titleFontSize},fontWeight:{value:e.titleFontWeight},fill:{value:e.titleColor},align:{value:"center"},baseline:{value:"middle"},text:{field:"data"}},update:{}}}}function h(e){return{type:"path",interactive:!1,properties:{enter:{x:{value:.5},y:{value:.5},stroke:{value:e.axisColor},strokeWidth:{value:e.axisWidth}},update:{}}}}var f=e("datalib"),n=e("vega-dataflow").Tuple,y=e("../parse/mark"),_=e("../util"),v=new(e("vega-scenegraph").Bounds),b={top:1,right:1,bottom:1,left:1},k={bottom:"center",top:"center",left:"right",right:"left"},S={bottom:"top",top:"bottom",left:"middle",right:"middle"};t.exports=function(e,t){function r(){M.type=null}function x(e){return{data:e}}function k(e){var t=U||(J.ticks?J.ticks(q):J.domain()),n=a(J,t,B).map(x);return t=t.map(function(t){return t=x(t),t.label=e(t.data),t}),[t,n]}function S(e){var a=e.orient,r=e.marks[5].properties.update,i=r.encode,s=t.titleOffsetAutoMin,d=t.titleOffsetAutoMax,l=t.titleOffsetAutoMargin;// Offset axis title using bounding box of axis domain and labels
// Assumes other components are **encoded and bounded** beforehand
r.encode=function(e,t,r,p,u,c){var g=i.call(i,e,t,r,p,u,c),m="bottom"===a||"top"===a?"y":"x";if(null!=V[m])return g;v.clear().union(t.items[3].bounds).union(t.items[4].bounds);var h=r?{}:e,o="left"===a||"right"===a?"width":"height",f="top"===a||"left"===a?-1:1,y=~~(v[o]()+e.fontSize/2+l);return n.set(h,m,f*w(A(s,y),d)),r&&r.interpolate(e,h),!0}}function T(a){// setup scale mapping
var n,r,m;"ordinal"===a.type?(n={scale:a.scaleName,offset:.5+a.rangeBand()/2},r=n):(n={scale:a.scaleName,offset:.5},r={scale:a.scaleName+":prev",offset:.5}),m=i(a),f.extend(X.gridLines,u(t)),f.extend(X.majorTicks,u(t)),f.extend(X.minorTicks,u(t)),f.extend(X.tickLabels,c(t)),f.extend(X.domain,h(t)),f.extend(X.title,g(t)),X.gridLines.properties.enter.stroke={value:t.gridColor},X.gridLines.properties.enter.strokeOpacity={value:t.gridOpacity},X.gridLines.properties.enter.strokeWidth={value:t.gridWidth},X.gridLines.properties.enter.strokeDash={value:t.gridDash},d(L,X.gridLines,r,n,1/0,a,t,E),d(L,X.majorTicks,r,n,I,a,t),d(L,X.minorTicks,r,n,z,a,t),s(L,X.tickLabels,r,n,I,O),l(L,X.domain,m,N),o(L,X.title,m,+C||-1),f.extend(X.gridLines.properties.update,G),f.extend(X.majorTicks.properties.update,H),f.extend(X.minorTicks.properties.update,Y),f.extend(X.tickLabels.properties.update,$),f.extend(X.domain.properties.update,W),f.extend(X.title.properties.update,V);var _=[X.gridLines,X.majorTicks,X.minorTicks,X.tickLabels,X.domain,X.title];f.extend(M,{type:"group",interactive:!1,properties:{enter:{encode:p,scales:[a.scaleName],signals:[],data:[]},update:{encode:p,scales:[a.scaleName],signals:[],data:[]}}}),M.marks=_.map(function(t){return y(e,t)})}var L=t.orient,E=0,C=t.titleOffset,M={},D="front",j=!1,P=null,I=t.tickSize,z=t.tickSize,N=t.tickSize,O=t.tickPadding||t.padding,U=null,F=null,R=null,B=0,q=t.ticks,G={},$={},H={},Y={},V={},W={},X={// Axis marks as references for updates
gridLines:{},majorTicks:{},minorTicks:{},tickLabels:{},domain:{},title:{}},m={},J;return m.def=function(){M.type||T(J);var e=_.getTickFormat(J,q,R,F),t=k(e),a=P?[P].map(x):[];return M.marks[0].from=function(){return j?t[0]:[]},M.marks[1].from=function(){return t[0]},M.marks[2].from=function(){return t[1]},M.marks[3].from=M.marks[1].from,M.marks[4].from=function(){return[1]},M.marks[5].from=function(){return a},M.offset=E,M.orient=L,M.layer=D,"auto"===C&&S(M),M},m.scale=function(e){return arguments.length?(J!==e&&(J=e,r()),m):J},m.orient=function(e){return arguments.length?(L!==e&&(L=e in b?e+"":t.orient,r()),m):L},m.title=function(e){return arguments.length?(P!==e&&(P=e,r()),m):P},m.tickCount=function(e){return arguments.length?(q=e,m):q},m.tickValues=function(e){return arguments.length?(U=e,m):U},m.tickFormat=function(e){return arguments.length?(F!==e&&(F=e,r()),m):F},m.tickFormatType=function(e){return arguments.length?(R!==e&&(R=e,r()),m):R},m.tickSize=function(e,t){if(!arguments.length)return I;var a=arguments.length-1,n=+e,i=1<a?+t:I,s=0<a?+arguments[a]:I;return(I!==n||z!==i||N!==s)&&r(),I=n,z=i,N=s,m},m.tickSubdivide=function(e){return arguments.length?(B=+e,m):B},m.offset=function(e){return arguments.length?(E=f.isObject(e)?e:+e,m):E},m.tickPadding=function(e){return arguments.length?(O!==+e&&(O=+e,r()),m):O},m.titleOffset=function(e){return arguments.length?(C!==e&&(C=e,r()),m):C},m.layer=function(e){return arguments.length?(D!==e&&(D=e,r()),m):D},m.grid=function(e){return arguments.length?(j!==e&&(j=e,r()),m):j},m.gridLineProperties=function(e){return arguments.length?(G!==e&&(G=e),m):G},m.majorTickProperties=function(e){return arguments.length?(H!==e&&(H=e),m):H},m.minorTickProperties=function(e){return arguments.length?(Y!==e&&(Y=e),m):Y},m.tickLabelProperties=function(e){return arguments.length?($!==e&&($=e),m):$},m.titleProperties=function(e){return arguments.length?(V!==e&&(V=e),m):V},m.domainProperties=function(e){return arguments.length?(W!==e&&(W=e),m):W},m.reset=function(){return r(),m},m}},{"../parse/mark":100,"../util":149,datalib:27,"vega-dataflow":42,"vega-scenegraph":50}],117:[function(e,t){(function(a){function r(e,t,a,n,r,s,d){var l=n?{}:t,o=t.mark.def,p=o.offset,u=o.orient,c=2*o.padding,g="left"===u?0:a.width,m=~~t.bounds.width()+(t.width?0:c),h=~~t.bounds.height()+(t.height?0:c),f=a._legendPositions||(a._legendPositions={right:.5,left:.5}),y;if(l.x=.5,l.y=.5,l.width=m,l.height=h,"left"===u||"right"===u){l.y=f[u],f[u]+=h+o.margin;// Calculate axis offset.
var _=a.axes,v=a.axisItems,x=b[u];for(y=0;y<_.length;++y)_[y].orient()===u&&(g=A(g,L(v[y].bounds[x])))}"left"===u?l.x-=g+p+m:"right"===u?l.x+=g+p:"top-left"===u?(l.x+=p,l.y+=p):"top-right"===u?(l.x+=a.width-m-p,l.y+=p):"bottom-left"===u?(l.x+=p,l.y+=a.height-h-p):"bottom-right"===u?(l.x+=a.width-m-p,l.y+=a.height-h-p):void 0;var k=e.baseline,S=0;for(y=0;y<a.legendItems.length;y++){var w=a.legendItems[y];S+=w.bounds.height()+(t.height?0:c)}"middle"===k?l.y+=p+a.height/2-S/2:"bottom"===k&&(l.y+=p+a.height-S),n&&n.interpolate(t,l);var T=t.mark.def.properties.enter.encode;return T.call(T,t,a,n,r,s,d),!0}function i(t,a,n,r,i,s){var d=t.properties.enter,e=t.properties.update;a&&(d.size=e.size={scale:a.scaleName,field:"data"}),n&&(d.shape=e.shape={scale:n.scaleName,field:"data"}),r&&(d.fill=e.fill={scale:r.scaleName,field:"data"}),i&&(d.stroke=e.stroke={scale:i.scaleName,field:"data"}),s&&(e.opacity={scale:s.scaleName,field:"data"})}function s(e){return{type:"text",interactive:!1,key:"data",properties:{enter:{x:{value:0},y:{value:0},fill:{value:e.titleColor},font:{value:e.titleFont},fontSize:{value:e.titleFontSize},fontWeight:{value:e.titleFontWeight},baseline:{value:"top"},text:{field:"data"},opacity:{value:1e-6}},exit:{opacity:{value:1e-6}},update:{opacity:{value:1}}}}}function d(e){return{type:"symbol",interactive:!1,key:"data",properties:{enter:{x:{field:"offset",mult:.5},y:{scale:"legend",field:"index"},shape:{value:e.symbolShape},size:{value:e.symbolSize},stroke:{value:e.symbolColor},strokeWidth:{value:e.symbolStrokeWidth},opacity:{value:1e-6}},exit:{opacity:{value:1e-6}},update:{x:{field:"offset",mult:.5},y:{scale:"legend",field:"index"},opacity:{value:1}}}}}function o(e){return{type:"text",interactive:!1,key:"data",properties:{enter:{x:{field:"offset",offset:5},y:{scale:"legend",field:"index"},fill:{value:e.labelColor},font:{value:e.labelFont},fontSize:{value:e.labelFontSize},align:{value:e.labelAlign},baseline:{value:e.labelBaseline},text:{field:"label"},opacity:{value:1e-6}},exit:{opacity:{value:1e-6}},update:{opacity:{value:1},x:{field:"offset",offset:5},y:{scale:"legend",field:"index"}}}}}function l(e){return{type:"rect",interactive:!1,properties:{enter:{x:{value:0},y:{value:0},width:{value:e.gradientWidth},height:{value:e.gradientHeight},stroke:{value:e.gradientStrokeColor},strokeWidth:{value:e.gradientStrokeWidth},opacity:{value:1e-6}},exit:{opacity:{value:1e-6}},update:{x:{value:0},y:{value:0},opacity:{value:1}}}}}function p(e){return{type:"text",interactive:!1,key:"data",properties:{enter:{x:{scale:"legend",field:"data"},y:{value:20},dy:{value:2},fill:{value:e.labelColor},font:{value:e.labelFont},fontSize:{value:e.labelFontSize},align:{field:"align"},baseline:{value:"top"},text:{field:"label"},opacity:{value:1e-6}},exit:{opacity:{value:1e-6}},update:{x:{scale:"legend",field:"data"},y:{value:20},opacity:{value:1}}}}}var u="undefined"==typeof window?"undefined"==typeof a?null:a.d3:window.d3,c=e("datalib"),g=e("vega-scenegraph").Gradient,y=e("../parse/properties"),_=e("../parse/mark"),x=e("../util"),b={left:"x1",right:"x2","top-left":"x1","top-right":"x2","bottom-left":"x1","bottom-right":"x2"};t.exports=function(e){function t(){Y.type=null}function a(e,t){return{data:e,index:t}}function n(e){return"ordinal"===e||"quantize"===e||"quantile"===e||"threshold"===e}function f(e){var t=k(T,A,L,E,C),r=(null==D?e.ticks?e.ticks.apply(e,F):e.domain():D).map(a),s=x.getTickFormat(e,r.length,P,j),d=u.range(r.length),o,l,p;// generate data
// determine spacing between legend entries
T?(l=r.map(function(e){return h(T(e.data))}),p=u.max(l),l=l.reduce(function(e,t,a,n){return 0<a&&(e[a]=e[a-1]+n[a-1]/2+5),e[a]+=t/2,e},[0]).map(Math.round)):(p=v(h(z.symbolSize)),l=M||(o=$.fontSize)&&o.value+5||z.labelFontSize+5,l=d.map(function(e,t){return v(p/2+t*l)}));// account for padding and title size
var g=U,m;I&&(m=G.fontSize,g+=5+(m&&m.value||z.titleFontSize));for(var f=0,y=l.length;f<y;++f)l[f]+=g;// build scale for label layout
t.scales=t.scales||[{}],c.extend(t.scales[0],{name:"legend",type:"ordinal",points:!0,domain:d,range:l});// update legend def
var n=(I?[I]:[]).map(a);return r.forEach(function(e){e.label=s(e.data),e.offset=p}),t.marks[0].from=function(){return n},t.marks[1].from=function(){return r},t.marks[2].from=t.marks[1].from,t}function k(t,a,n,l,p){// setup legend marks
var u=c.extend(H.titles,s(z)),g=c.extend(H.symbols,d(z)),m=c.extend(H.labels,o(z));// extend legend marks
return i(g,t,a,n,l,p),c.extend(u.properties.update,G),c.extend(g.properties.update,B),c.extend(m.properties.update,$),u.properties.enter.x.value+=U,u.properties.enter.y.value+=U,m.properties.enter.x.offset+=U+1,g.properties.enter.x.offset=U+1,m.properties.update.x.offset+=U+1,g.properties.update.x.offset=U+1,c.extend(Y,{type:"group",interactive:!1,properties:{enter:y(e,"group",R),legendPosition:{encode:r.bind(null,z),signals:[],scales:[],data:[],fields:[]}}}),Y.marks=[u,g,m].map(function(t){return _(e,t)}),Y}function S(e){var t=w(e),n=e.domain(),r=(null==D?n:D).map(a),i=q.width&&q.width.value||z.gradientWidth,s=x.getTickFormat(e,r.length,P,j);// build scale for label layout
t.scales=t.scales||[{}];var d=c.extend(t.scales[0],{name:"legend",type:e.type,round:!0,zero:!1,domain:[n[0],n[n.length-1]],range:[U,i+U]});"pow"===e.type&&(d.exponent=e.exponent());// update legend def
var o=(I?[I]:[]).map(a);return r.forEach(function(e,t){e.label=s(e.data),e.align=t==r.length-1?"right":0===t?"left":"center"}),t.marks[0].from=function(){return o},t.marks[1].from=function(){return[1]},t.marks[2].from=function(){return r},t}function w(t){// setup legend marks
var a=c.extend(H.titles,s(z)),d=c.extend(H.gradient,l(z)),o=c.extend(H.labels,p(z)),u=new g,m=t.domain(),h=m[0],v=m[m.length-1],x=t.copy().domain([h,v]).range([0,1]),f="linear"!==t.type&&t.ticks?t.ticks.call(t,15):m;// setup color gradient
h!==f[0]&&f.unshift(h),v!==f[f.length-1]&&f.push(v);for(var b=0,k=f.length;b<k;++b)u.stop(x(f[b]),t(f[b]));d.properties.enter.fill={value:u},c.extend(a.properties.update,G),c.extend(d.properties.update,q),c.extend(o.properties.update,$);// account for gradient size
var n=d.properties,S=q.height,w=S&&S.value||n.enter.height.value;// account for title size as needed
if(o.properties.enter.y.value=w,o.properties.update.y.value=w,I){var T=a.properties,A=G.fontSize,L=4+(A&&A.value||T.enter.fontSize.value);d.properties.enter.y.value+=L,o.properties.enter.y.value+=L,d.properties.update.y.value+=L,o.properties.update.y.value+=L}// padding from legend border
return a.properties.enter.x.value+=U,a.properties.enter.y.value+=U,d.properties.enter.x.value+=U,d.properties.enter.y.value+=U,o.properties.enter.y.value+=U,d.properties.update.x.value+=U,d.properties.update.y.value+=U,o.properties.update.y.value+=U,c.extend(Y,{type:"group",interactive:!1,properties:{enter:y(e,"group",R),legendPosition:{encode:r.bind(null,z),signals:[],scales:[],data:[],fields:[]}}}),Y.marks=[a,d,o].map(function(t){return _(e,t)}),Y}var T=null,A=null,L=null,E=null,C=null,M=null,D=null,j=null,P=null,I=null,z=e.config().legend,N=z.orient,O=z.offset,U=z.padding,F=[5],R={},B={},q={},G={},$={},H={// Legend marks as references for updates
titles:{},symbols:{},labels:{},gradient:{}},m={},Y={};return m.def=function(){var e=T||A||L||E||C;return Y.type||(Y=e!=L&&e!=E||n(e.type)?f(e):S(e)),Y.orient=N,Y.offset=O,Y.padding=U,Y.margin=z.margin,Y},m.size=function(e){return arguments.length?(T!==e&&(T=e,t()),m):T},m.shape=function(e){return arguments.length?(A!==e&&(A=e,t()),m):A},m.fill=function(e){return arguments.length?(L!==e&&(L=e,t()),m):L},m.stroke=function(e){return arguments.length?(E!==e&&(E=e,t()),m):E},m.opacity=function(e){return arguments.length?(C!==e&&(C=e,t()),m):C},m.title=function(e){return arguments.length?(I!==e&&(I=e,t()),m):I},m.format=function(e){return arguments.length?(j!==e&&(j=e,t()),m):j},m.formatType=function(e){return arguments.length?(P!==e&&(P=e,t()),m):P},m.spacing=function(e){return arguments.length?(M!==+e&&(M=+e,t()),m):M},m.orient=function(e){return arguments.length?(N=e in b?e+"":z.orient,m):N},m.offset=function(e){return arguments.length?(O=+e,m):O},m.values=function(e){return arguments.length?(D=e,m):D},m.legendProperties=function(e){return arguments.length?(R=e,m):R},m.symbolProperties=function(e){return arguments.length?(B=e,m):B},m.gradientProperties=function(e){return arguments.length?(q=e,m):q},m.labelProperties=function(e){return arguments.length?($=e,m):$},m.titleProperties=function(e){return arguments.length?(G=e,m):G},m.reset=function(){return t(),m},m}}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{"../parse/mark":100,"../parse/properties":105,"../util":149,datalib:27,"vega-scenegraph":50}],118:[function(e,t){t.exports=function e(t,a){var r,d,o,l,p;if(a(t))return!0;var u=["items","axisItems","legendItems"];for(o=0,l=u.length;o<l;++o)if(p=t[u[o]])for(r=0,d=p.length;r<d;++r)if(e(p[r],a))return!0}},{}],119:[function(e,t){function a(e){return p.prototype.init.call(this,e),p.addParameters(this,{groupby:{type:"array<field>"},summarize:{type:"custom",set:function(e){function t(e){e.signal&&(a[e.signal]=1)}var a={},n=this._transform,s,d,o,p,u,c;if(!r.isArray(p=e))for(u in p=[],e)c=r.array(e[u]),p.push({field:u,ops:c});for(s=0,d=p.length;s<d;++s)o=p[s],o.field.signal&&(a[o.field.signal]=1),r.array(o.ops).forEach(t),r.array(o.as).forEach(t);return n._fields=p,n._aggr=null,n.dependency(l.SIGNALS,r.keys(a)),n}}}),this._aggr=null,this._input=null,this._args=null,this._fields=[],this._out=[],this._type=m.TUPLE,this._acc={groupby:r.true,value:r.true},this.router(!0).produces(!0)}function n(e){// Collect the output fields set by this aggregate.
var t=[],a,r,s,d,o,l,p;for(o=e._dims,a=0,r=o.length;a<r;++a)t.push(o[a].name);for(l=e._aggr,a=0,r=l.length;a<r;++a)for(p=l[a].measures.fields,s=0,d=p.length;s<d;++s)t.push(p[s]);return t}var r=e("datalib"),i=e("vega-dataflow"),s=e("vega-logging"),d=i.ChangeSet,o=i.Tuple,l=i.Dependencies,p=e("./Transform"),u=e("./Facetor"),c=a.prototype=Object.create(p.prototype);c.constructor=a;var m=a.TYPES={VALUE:1,TUPLE:2,MULTI:3};a.VALID_OPS=["values","count","valid","missing","distinct","sum","mean","average","variance","variancep","stdev","stdevp","median","q1","q3","modeskew","min","max","argmin","argmax"],c.type=function(e){return this._type=e,this},c.accessors=function(e,t){var a=this._acc;a.groupby=r.$(e)||r.true,a.value=r.$(t)||r.true},c.aggr=function(){if(this._aggr)return this._aggr;var e=this._graph,t=!1,a=[],i=this.param("groupby").field,s=function(t){return t.signal?e.signalRef(t.signal):t},d=this._fields.map(function(e){var n={name:s(e.field),as:r.array(e.as),ops:r.array(s(e.ops)).map(s),get:e.get};return t=t||null!=n.get,a.push(n.name),n});// Prepare summarize fields.
i.forEach(function(e){e.get&&(t=!0),a.push(e.name||e)}),this._args=t||!d.length?null:a,d.length||(d={"*":"values"});// Instantiate our aggregator instance.
// Facetor is a special subclass that can facet into data pipelines.
var o=this._aggr=new u().groupby(i).stream(!0).summarize(d);// Collect output fields sets by this aggregate.
return this._out=n(o),this._type!==m.VALUE&&o.key("_id"),o},c.transform=function(e,t){s.debug(e,["aggregate"]);var a=d.create(e),n=this.aggr(),r=this._out,l=this._args,u=!0,c=o.prev,p,g,h,f,y;// Upon reset, retract prior tuples and re-initialize.
// Get update methods according to input type.
if(t&&(a.rem.push.apply(a.rem,n.result()),n.clear(),this._aggr=null,n=this.aggr()),this._type===m.TUPLE)p=function(e){n._add(e),o.prev_init(e)},g=function(e){n._rem(c(e))},h=function(e){n._mod(e,c(e))},f=function(e){n._markMod(e,c(e))};else{var _=this._acc.groupby,v=this._acc.value,b=this._type===m.VALUE?v:function(e){return{_id:e._id,groupby:_(e),value:v(e)}};p=function(e){n._add(b(e)),o.prev_init(e)},g=function(e){n._rem(b(c(e)))},h=function(e){n._mod(b(e),b(c(e)))},f=function(e){n._mark(b(e),b(c(e)))}}if(e.add.forEach(p),t)e.mod.forEach(p);else{// If possible, check argument fields to see if we need to re-process mods.
if(e.rem.forEach(g),l)for(y=0,u=!1;y<l.length;++y)if(e.fields[l[y]]){u=!0;break}e.mod.forEach(u?h:f)}// Indicate output fields and return aggregate tuples.
for(y=0;y<r.length;++y)a.fields[r[y]]=1;return n._input=e,n.changes(a)},t.exports=a},{"./Facetor":125,"./Transform":141,datalib:27,"vega-dataflow":42,"vega-logging":49}],120:[function(e,t){function a(){// Nearest appropriate collector.
// Set by the dataflow Graph during connection.
this._collector=null}var n=e("./Transform").prototype,r=a.prototype=Object.create(n);r.constructor=a,r.init=function(e){return n.init.call(this,e),this.batch(!0)},r.transform=function(e,t){return this.batchTransform(e,this._collector.data(),t)},r.batchTransform=function()/* input, data, reset */{},t.exports=a},{"./Transform":141}],121:[function(e,t){function a(e){return d.prototype.init.call(this,e),s.addParameters(this,{field:{type:"field"},min:{type:"value"},max:{type:"value"},base:{type:"value",default:10},maxbins:{type:"value",default:20},step:{type:"value"},steps:{type:"value"},minstep:{type:"value"},div:{type:"array<value>",default:[5,2]}}),this._output={start:"bin_start",end:"bin_end",mid:"bin_mid"},this.mutates(!0)}var n=e("datalib"),r=e("vega-dataflow").Tuple,i=e("vega-logging"),s=e("./Transform"),d=e("./BatchTransform"),o=a.prototype=Object.create(d.prototype);o.constructor=a,o.extent=function(t){// TODO only recompute extent upon data or field change?
var a=[this.param("min"),this.param("max")],e;return(null==a[0]||null==a[1])&&(e=n.extent(t,this.param("field").accessor),null==a[0]&&(a[0]=e[0]),null==a[1]&&(a[1]=e[1])),a},o.batchTransform=function(e,t){function a(e){var t=c(e);t=null==t?null:m.start+h*~~((t-m.start)/h),r.set(e,o.start,t),r.set(e,o.end,t+h),r.set(e,o.mid,t+h/2)}i.debug(e,["binning"]);var d=this.extent(t),o=this._output,l=this.param("step"),p=this.param("steps"),u=this.param("minstep"),c=this.param("field").accessor,g={min:d[0],max:d[1],base:this.param("base"),maxbins:this.param("maxbins"),div:this.param("div")};l&&(g.step=l),p&&(g.steps=p),u&&(g.minstep=u);var m=n.bins(g),h=m.step;return e.add.forEach(a),e.mod.forEach(a),e.rem.forEach(a),e.fields[o.start]=1,e.fields[o.end]=1,e.fields[o.mid]=1,e},t.exports=a},{"./BatchTransform":120,"./Transform":141,datalib:27,"vega-dataflow":42,"vega-logging":49}],122:[function(e,t){function a(e){return s.prototype.init.call(this,e),s.addParameters(this,{field:{type:"field",default:"data"},pattern:{type:"value",default:"[\\w']+"},case:{type:"value",default:"lower"},stopwords:{type:"value",default:""}}),this._output={text:"text",count:"count"},this.router(!0).produces(!0)}var n=e("vega-dataflow"),r=n.Tuple,i=e("vega-logging"),s=e("./Transform"),d=a.prototype=Object.create(s.prototype);d.constructor=a,d.transform=function(e,t){function a(e){return r.prev_init(e),s(e)}function n(e){return s(r.prev(e))}i.debug(e,["countpattern"]);var s=this.param("field").accessor,d=this.param("pattern"),o=this.param("stopwords"),l=!1;// update parameters
// generate output tuples
return this._stop!==o&&(this._stop=o,this._stop_re=new RegExp("^"+o+"$","i"),t=!0),this._pattern!==d&&(this._pattern=d,this._match=new RegExp(this._pattern,"g"),t=!0),t&&(this._counts={}),this._add(e.add,a),t||this._rem(e.rem,n),(t||(l=e.fields[s.field]))&&(l&&this._rem(e.mod,n),this._add(e.mod,a)),this._changeset(e)},d._changeset=function(e){var a=this._counts,i=this._tuples||(this._tuples={}),s=n.ChangeSet.create(e),d=this._output,o,l,p;for(o in a)l=i[o],p=a[o]||0,!l&&p?(i[o]=l=r.ingest({}),l[d.text]=o,l[d.count]=p,s.add.push(l)):0===p?(l&&s.rem.push(l),delete a[o],delete i[o]):l[d.count]!==p&&(r.set(l,d.count,p),s.mod.push(l));return s},d._tokenize=function(e){switch(this.param("case")){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase();}return e.match(this._match)},d._add=function(e,a){var n=this._counts,r=this._stop_re,s,d,o,l;for(o=0;o<e.length;++o)for(s=this._tokenize(a(e[o])),d=0;d<s.length;++d)r.test(l=s[d])||(n[l]=1+(n[l]||0))},d._rem=function(e,a){var n=this._counts,r=this._stop_re,s,d,o,l;for(o=0;o<e.length;++o)for(s=this._tokenize(a(e[o])),d=0;d<s.length;++d)r.test(l=s[d])||(n[l]-=1)},t.exports=a},{"./Transform":141,"vega-dataflow":42,"vega-logging":49}],123:[function(e,t){function a(e){return h.prototype.init.call(this,e),m.addParameters(this,{with:{type:"data"},diagonal:{type:"value",default:"true"},filter:{type:"expr"}}),this._output={left:"a",right:"b"},this._lastWith=null,this._cids={},this._cache={},this.router(!0).produces(!0)}// Each cached incoming tuple also has a flag to determine whether
// any tuples were filtered.
function n(e,a){var t=this._cache,n=t[e._id]||(t[e._id]={c:[],f:!1});n.c.push(a)}function r(e,t,a){return e?t._id+"_"+a._id:a._id+"_"+t._id}function s(e,a,s,d,o,l,p){for(var u=this._output,g=this._cache,m=this._cids,h=e.add,f=!1,_=0,v=s.length,x={},b,k;_<v;++_)b=s[_],k=r(a,p,b),m[k]||p._id===b._id&&!d||(c.set(x,u.left,a?p:b),c.set(x,u.right,a?b:p),!o||o(x)?(h.push(x=c.ingest(x)),n.call(this,p,x),p._id!==b._id&&n.call(this,b,x),l[x._id]=1,m[k]=!0,x={}):(g[b._id]&&(g[b._id].f=!0),f=!0));g[p._id]&&(g[p._id].f=f)}function d(e,a,n,d,o,p,u,c){var g=this._output,m=this._cache,h=this._cids,f=m[c._id],_=f&&f.c,v=!f||f.f,x=e.mod,b=e.rem,k,S,w,T,A;// If we have cached values, iterate through them for lazy
// removal, and to re-run the filter.
if(_)for(k=_.length-1;0<=k;--k){// Lazy removal: y was previously rem'd, so clean up the cache.
if(S=_[k],T=c===S[g.left],w=T?S[g.right]:S[g.left],A=r(T,c,w),!m[w._id]){h[A]=!1,_.splice(k,1);continue}if(!o||o(S)){if(p[S._id])continue;x.push(S),p[S._id]=1}else u[S._id]||b.push.apply(b,_.splice(k,1)),u[S._id]=1,h[A]=!1,f.f=!0}// If we have a filter param, call add to catch any tuples that may
// have previously been filtered.
o&&v&&s.call(this,e,a,n,d,o,p,c)}function o(e,a,n,s){var d=this._output,o=this._cache[s._id],p=this._cids,u=e.rem,c,g,m,h,f;if(o){for(c=0,g=o.c.length;c<g;++c)m=o.c[c],f=s===m[d.left],h=f?m[d.right]:m[d.left],p[r(f,s,h)]=!1,n[m._id]||(u.push(m),n[m._id]=1);this._cache[s._id]=null}}function l(e,a){var n=this._cache,r=p.keys(n),s=e.rem,d,o,l,u,c,g;for(d=0,o=r.length;d<o;++d)for(c=n[r[d]],l=0,u=c.c.length;l<u;++l)g=c.c[l],a[g._id]||(s.push(g),a[g._id]=1);this._cache={},this._cids={},this._lastWith=null}var p=e("datalib"),i=e("vega-dataflow"),u=i.ChangeSet,c=i.Tuple,g=e("vega-logging"),m=e("./Transform"),h=e("./BatchTransform"),f=a.prototype=Object.create(h.prototype);f.constructor=a,f.batchTransform=function(e,t,a){g.debug(e,["crossing"]);var n=this.param("with"),r=this.param("diagonal"),i=this._output,p=this.param("filter")||null,c=!n.name,m=c?e:n.source.last(),h=c?t:n.source.values(),f=u.create(e),y={},_={};// Track IDs to prevent dupe mod/rem tuples.
// If signal values (for diag or test) have changed, purge the cache
// and re-run cross in batch mode. Otherwise stream cross values.
return a?(l.call(this,f,_),t.forEach(s.bind(this,f,!0,h,r,p,y)),this._lastWith=m.stamp):(e.rem.forEach(o.bind(this,f,!0,_)),e.add.forEach(s.bind(this,f,!0,h,r,p,y)),m.stamp>this._lastWith&&(m.rem.forEach(o.bind(this,f,!1,_)),m.add.forEach(s.bind(this,f,!1,t,r,p,y)),m.mod.forEach(d.bind(this,f,!1,t,r,p,y,_)),this._lastWith=m.stamp),e.mod.forEach(d.bind(this,f,!0,h,r,p,y,_))),f.fields[i.left]=1,f.fields[i.right]=1,f},t.exports=a},{"./BatchTransform":120,"./Transform":141,datalib:27,"vega-dataflow":42,"vega-logging":49}],124:[function(e,t){function a(t){return n.addParameters(this,{transform:{type:"custom",set:function(e){return this._transform._pipeline=e,this._transform},get:function(){var a=e("../parse/transforms"),n=this._transform;return n._pipeline.map(function(e){return a(n._graph,e)})}}}),this._pipeline=[],r.call(this,t)}var n=e("./Transform"),r=e("./Aggregate"),i=a.prototype=Object.create(r.prototype);i.constructor=a,i.aggr=function(){return r.prototype.aggr.call(this).facet(this)},i.transform=function(e,t){var a=r.prototype.transform.call(this,e,t);// New facet cells should trigger a re-ranking of the dataflow graph.
// This ensures facet datasources are computed before scenegraph nodes.
// We rerank the Facet's first listener, which is the next node in the
// datasource's pipeline.
return e.add.length&&this.listeners()[0].rerank(),a},t.exports=a},{"../parse/transforms":109,"./Aggregate":119,"./Transform":141}],125:[function(e,t){function a(){i.call(this),this._facet=null,this._facetID=++p}function n(e){l.debug({},["disconnecting cell",this.tuple._id]);var t=this.ds.pipeline();e.removeListener(t[0]),e._graph.removeListener(t[0]),e._graph.disconnect(t)}var r=e("datalib"),i=r.Aggregator,s=i.prototype,d=e("vega-dataflow"),o=d.Tuple,l=e("vega-logging"),p=0,u=a.prototype=Object.create(s);u.constructor=a,u.facet=function(e){return arguments.length?(this._facet=e,this):this._facet},u._ingest=function(e){return o.ingest(e,null)},u._assign=o.set,u._newcell=function(e,t){var a=s._newcell.call(this,e,t),r=this._facet;if(r){var i=r._graph,d=a.tuple,o=r.param("transform");a.ds=i.data(d._facetID,o,d),a.disconnect=n,r.addListener(o[0])}return a},u._newtuple=function(e,a){var n=s._newtuple.call(this,e);return this._facet&&(o.set(n,"key",a),o.set(n,"_facetID",this._facetID+"_"+a)),n},u.clear=function(){if(this._facet)for(var e in this._cells)this._cells[e].disconnect(this._facet);return s.clear.call(this)},u._on_add=function(e,t){this._facet&&t.ds._input.add.push(e)},u._on_rem=function(e,t){this._facet&&t.ds._input.rem.push(e)},u._on_mod=function(e,t,a,n){this._facet&&(a===n?a.ds._input.mod.push(e):(a.ds._input.rem.push(e),n.ds._input.add.push(e)))},u._on_drop=function(e){this._facet&&e.disconnect(this._facet)},u._on_keep=function(e){this._facet&&d.ChangeSet.copy(this._input,e.ds._input)},t.exports=a},{datalib:27,"vega-dataflow":42,"vega-logging":49}],126:[function(e,t){function a(e){return i.prototype.init.call(this,e),i.addParameters(this,{test:{type:"expr"}}),this._skip={},this.router(!0)}var n=e("vega-dataflow"),r=e("vega-logging"),i=e("./Transform"),s=a.prototype=Object.create(i.prototype);s.constructor=a,s.transform=function(e){r.debug(e,["filtering"]);var t=n.ChangeSet.create(e),a=this._skip,i=this.param("test");return e.rem.forEach(function(e){1===a[e._id]?a[e._id]=0:t.rem.push(e)}),e.add.forEach(function(e){i(e)?t.add.push(e):a[e._id]=1}),e.mod.forEach(function(e){var n=i(e),r=1===a[e._id];n&&r?(a[e._id]=0,t.add.push(e)):n&&!r?t.mod.push(e):!n&&r||(t.rem.push(e),a[e._id]=1)}),t},t.exports=a},{"./Transform":141,"vega-dataflow":42,"vega-logging":49}],127:[function(e,t){function a(e){return s.prototype.init.call(this,e),s.addParameters(this,{fields:{type:"array<field>"}}),this._output={key:"key",value:"value"},this._cache={},this.router(!0).produces(!0)}var n=e("vega-dataflow"),r=n.Tuple,i=e("vega-logging"),s=e("./Transform"),d=a.prototype=Object.create(s.prototype);d.constructor=a,d._reset=function(e,t){for(var a in this._cache)t.rem.push.apply(t.rem,this._cache[a]);this._cache={}},d._tuple=function(e,t,a){var n=this._cache[e._id]||(this._cache[e._id]=Array(a));return n[t]?r.rederive(e,n[t]):n[t]=r.derive(e)},d._fn=function(e,a,s){var o,l,p,u,c,g;for(o=0,p=e.length;o<p;++o)for(c=e[o],l=0,u=a.field.length;l<u;++l)g=this._tuple(c,l,u),r.set(g,this._output.key,a.field[l]),r.set(g,this._output.value,a.accessor[l](c)),s.push(g)},d.transform=function(e,t){i.debug(e,["folding"]);var a=this,r=this.param("fields"),s=n.ChangeSet.create(e);return t&&this._reset(e,s),this._fn(e.add,r,s.add),this._fn(e.mod,r,t?s.add:s.mod),e.rem.forEach(function(e){s.rem.push.apply(s.rem,a._cache[e._id]),a._cache[e._id]=null}),(e.add.length||e.rem.length||r.field.some(function(t){return!!e.fields[t]}))&&(s.fields[this._output.key]=1,s.fields[this._output.value]=1),s},t.exports=a},{"./Transform":141,"vega-dataflow":42,"vega-logging":49}],128:[function(e,t){(function(a){function n(t){return l.prototype.init.call(this,t),this._prev=null,this._interactive=!1,this._setup=!0,this._nodes=[],this._links=[],this._layout=r.layout.force(),l.addParameters(this,{size:{type:"array<value>",default:e("./screen").size},bound:{type:"value",default:!0},links:{type:"data"},// TODO: for now force these to be value params only (pun-intended)
// Can update to include fields after Parameter refactoring.
linkStrength:{type:"value",default:1},linkDistance:{type:"value",default:20},charge:{type:"value",default:-30},chargeDistance:{type:"value",default:1/0},friction:{type:"value",default:.9},theta:{type:"value",default:.8},gravity:{type:"value",default:.1},alpha:{type:"value",default:.1},iterations:{type:"value",default:500},interactive:{type:"value",default:this._interactive},active:{type:"value",default:this._prev},fixed:{type:"data"}}),this._output={x:"layout_x",y:"layout_y"},this.mutates(!0)}var r="undefined"==typeof window?"undefined"==typeof a?null:a.d3:window.d3,i=e("vega-dataflow"),s=i.Tuple,d=i.ChangeSet,o=e("vega-logging"),l=e("./Transform"),p=n.prototype=Object.create(l.prototype);p.constructor=n,p.transform=function(e,t){o.debug(e,["force"]),t-=e.signals.active?1:0;// get variables
var a=this.param("interactive"),n=this.param("links").source,r=n.last(),d=this.param("active"),l=this._output,p=this._layout,u=this._nodes,c=this._links;// configure nodes, links and layout
// run batch layout
if(r.stamp<e.stamp&&(r=null),this.configure(e,r,a,t),!a){for(var g=this.param("iterations"),m=0;m<g;++m)p.tick();p.stop()}// update node positions
return this.update(d),(t||d!==this._prev&&d&&d.update)&&p.alpha(this.param("alpha")),d!==this._prev&&(this._prev=d),e.rem.length&&p.nodes(this._nodes=s.idFilter(u,e.rem)),r&&r.rem.length&&p.links(this._links=s.idFilter(c,r.rem)),e.fields[l.x]=1,e.fields[l.y]=1,e},p.configure=function(e,t,n,r){// check if we need to run configuration
var s=this._layout,o=this._setup||e.add.length||t&&t.add.length||n!==this._interactive||this.param("charge")!==s.charge()||this.param("linkStrength")!==s.linkStrength()||this.param("linkDistance")!==s.linkDistance();if((o||r)&&s.size(this.param("size")).chargeDistance(this.param("chargeDistance")).theta(this.param("theta")).gravity(this.param("gravity")).friction(this.param("friction")),!!o){this._setup=!1,this._interactive=n;var l=this,p=this._graph,u=this._nodes,c=this._links,g,m;// process added nodes
for(g=e.add,m=0;m<g.length;++m)u.push({tuple:g[m]});// process added edges
if(t)for(g=t.add,m=0;m<g.length;++m)// TODO add configurable source/target accessors
// TODO support lookup by node id
// TODO process 'mod' of edge source or target?
c.push({tuple:g[m],source:u[g[m].source],target:u[g[m].target]});// setup handler for force layout tick events
var h=n?function(){p.propagate(d.create(null,!0),l)}:null;// configure the rest of the layout
s.linkStrength(this.param("linkStrength")).linkDistance(this.param("linkDistance")).charge(this.param("charge")).nodes(u).links(c).on("tick",h).start().alpha(this.param("alpha"))}// if no more updates needed, return now
},p.update=function(e){var a=this._output,r=this.param("bound"),d=this.param("fixed"),o=this.param("size"),l=this._nodes,p={},u,c,g,m,h,f;if(d&&d.source)for(d=d.source.values(),c=0,g=d.length;c<g;++c)p[d[c].id]=1;for(c=0;c<l.length;++c)g=l[c],m=g.tuple,u=m._id,e&&e.id===u?(g.fixed=1,e.update&&(g.x=g.px=e.x,g.y=g.py=e.y)):g.fixed=p[u]||0,h=r?A(0,w(g.x,o[0])):g.x,f=r?A(0,w(g.y,o[1])):g.y,s.set(m,a.x,h),s.set(m,a.y,f)},t.exports=n}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{"./Transform":141,"./screen":147,"vega-dataflow":42,"vega-logging":49}],129:[function(e,t){function a(e){return s.prototype.init.call(this,e),s.addParameters(this,{field:{type:"value"},expr:{type:"expr"}}),this.mutates(!0)}var n=e("vega-dataflow"),r=n.Tuple,i=e("vega-logging"),s=e("./Transform"),d=a.prototype=Object.create(s.prototype);d.constructor=a,d.transform=function(e){function t(e){r.set(e,a,n(e)),s=!0}i.debug(e,["formulating"]);var a=this.param("field"),n=this.param("expr"),s=!1;return e.add.forEach(t),this.reevaluate(e)&&e.mod.forEach(t),s&&(e.fields[a]=1),e},t.exports=a},{"./Transform":141,"vega-dataflow":42,"vega-logging":49}],130:[function(e,t){(function(a){function n(e){return o.prototype.init.call(this,e),o.addParameters(this,n.Parameters),o.addParameters(this,{lon:{type:"field"},lat:{type:"field"}}),this._output={x:"layout_x",y:"layout_y"},this.mutates(!0)}var r="undefined"==typeof window?"undefined"==typeof a?null:a.d3:window.d3,i=e("datalib"),s=e("vega-dataflow").Tuple,d=e("vega-logging"),o=e("./Transform");n.Parameters={projection:{type:"value",default:"mercator"},center:{type:"array<value>"},translate:{type:"array<value>",default:e("./screen").center},rotate:{type:"array<value>"},scale:{type:"value"},precision:{type:"value"},clipAngle:{type:"value"},clipExtent:{type:"value"}},n.d3Projection=function(){var e=this.param("projection"),t=n.Parameters,a,s,d;for(s in e!==this._mode&&(this._mode=e,this._projection=r.geo[e]()),a=this._projection,t)if("projection"!==s&&a[s]){if(d=this.param(s),void 0===d||i.isArray(d)&&0===d.length)continue;d!==a[s]()&&a[s](d)}return a};var l=n.prototype=Object.create(o.prototype);l.constructor=n,l.transform=function(e){function t(e){var t=[r(e),i(e)],n=o(t)||[null,null];s.set(e,a.x,n[0]),s.set(e,a.y,n[1])}d.debug(e,["geo"]);var a=this._output,r=this.param("lon").accessor,i=this.param("lat").accessor,o=n.d3Projection.call(this);return e.add.forEach(t),this.reevaluate(e)&&(e.mod.forEach(t),e.rem.forEach(t)),e.fields[a.x]=1,e.fields[a.y]=1,e},t.exports=n}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{"./Transform":141,"./screen":147,datalib:27,"vega-dataflow":42,"vega-logging":49}],131:[function(e,t){(function(a){function n(e){return l.prototype.init.call(this,e),l.addParameters(this,o.Parameters),l.addParameters(this,{field:{type:"field",default:null}}),this._output={path:"layout_path"},this.mutates(!0)}var r="undefined"==typeof window?"undefined"==typeof a?null:a.d3:window.d3,i=e("datalib"),s=e("vega-dataflow").Tuple,d=e("vega-logging"),o=e("./Geo"),l=e("./Transform"),p=n.prototype=Object.create(l.prototype);p.constructor=n,p.transform=function(e){function t(e){s.set(e,a.path,p(n(e)))}d.debug(e,["geopath"]);var a=this._output,n=this.param("field").accessor||i.identity,l=o.d3Projection.call(this),p=r.geo.path().projection(l);return e.add.forEach(t),this.reevaluate(e)&&(e.mod.forEach(t),e.rem.forEach(t)),e.fields[a.path]=1,e},t.exports=n}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{"./Geo":130,"./Transform":141,datalib:27,"vega-dataflow":42,"vega-logging":49}],132:[function(e,t){(function(a){function n(t){return l.prototype.init.call(this,t),o.addParameters(this,{// hierarchy parameters
sort:{type:"array<field>",default:null},children:{type:"field",default:"children"},parent:{type:"field",default:"parent"},field:{type:"value",default:null},// layout parameters
mode:{type:"value",default:"tidy"},// tidy, cluster, partition
size:{type:"array<value>",default:e("./screen").size},nodesize:{type:"array<value>",default:null},orient:{type:"value",default:"cartesian"}}),this._mode=null,this._output={x:"layout_x",y:"layout_y",width:"layout_width",height:"layout_height",depth:"layout_depth"},this.mutates(!0)}var r="undefined"==typeof window?"undefined"==typeof a?null:a.d3:window.d3,i=e("datalib"),s=e("vega-dataflow").Tuple,d=e("vega-logging"),o=e("./Transform"),l=e("./BatchTransform"),p={cartesian:function(e,t){return e.parent===t.parent?1:2},radial:function(e,t){return(e.parent===t.parent?1:2)/e.depth}},u=n.prototype=Object.create(l.prototype);u.constructor=n,u.batchTransform=function(e,t){d.debug(e,["hierarchy layout"]);// get variables
var a=this._layout,o=this._output,l=this.param("mode"),u=this.param("sort"),c=this.param("nodesize"),g=this.param("parent").accessor,m=t.filter(function(e){return null===g(e)})[0];// return changeset
return l!==this._mode&&(this._mode=l,"tidy"===l&&(l="tree"),a=this._layout=r.layout[l]()),e.fields[o.x]=1,e.fields[o.y]=1,e.fields[o.depth]=1,"partition"===l?(e.fields[o.width]=1,e.fields[o.height]=1,a.value(this.param("field").accessor)):a.separation(p[this.param("orient")]),c.length&&"partition"!==l?a.nodeSize(c):a.size(this.param("size")),a.sort(u.field.length?i.comparator(u.field):null).children(this.param("children").accessor).nodes(m),t.forEach(function(e){s.set(e,o.x,e.x),s.set(e,o.y,e.y),s.set(e,o.depth,e.depth),"partition"===l&&(s.set(e,o.width,e.dx),s.set(e,o.height,e.dy))}),e},t.exports=n}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{"./BatchTransform":120,"./Transform":141,"./screen":147,datalib:27,"vega-dataflow":42,"vega-logging":49}],133:[function(e,t){function a(e){return u.prototype.init.call(this,e),p.addParameters(this,{groupby:{type:"array<field>"},orderby:{type:"array<field>"},field:{type:"field"},method:{type:"value",default:"value"},value:{type:"value",default:0}}),this.router(!0).produces(!0)}function r(e,a,n,r){var s={_imputed:!0},t;for(t=0;t<a.length;++t)s[e[t]]=a[t];for(t=0;t<r.length;++t)s[n[t]]=r[t];return l.ingest(s)}function s(e,t,a){var n=[],r=function(e){return e(p)},s=function(e){return p=e,a.map(r)},o,l,p,u,c,m,h,f;// partition data points into groups
for(m=n.domain=d.unique(e,s),f=m.length,h=m.reduce(function(e,t,a){return e[t]={value:t,index:a},e},{}),(o={},l=0);l<e.length;++l)p=e[l],u=null==t?[]:t.map(r),c=o[u]||(n.push(o[u]=Array(f)),o[u].values=u,o[u]),c[h[s(p)].index]=p;return n}var d=e("datalib"),o=e("vega-logging"),l=e("vega-dataflow").Tuple,p=e("./Transform"),u=e("./BatchTransform"),c=a.prototype=Object.create(u.prototype);c.constructor=a,c.batchTransform=function(e,a){function l(e){return null==e?null:f(e)}o.debug(e,["imputing"]);var p=this.param("groupby"),u=this.param("orderby"),c=this.param("method"),g=this.param("value"),h=this.param("field"),f=h.accessor,y=h.field,_=this._imputed||[],v=[],x=s(a,p.accessor,u.accessor),b=x.domain,k,S,w,T,A,L;for(w=0,A=x.length;w<A;++w)// add tuples for missing values
for(k=x[w],"value"!==c&&(g=d[c](k,l)),(S=0,T=k.length);S<T;++S)null==k[S]&&(L=r(p.field,k.values,u.field,b[S]),L[y]=g,v.push(L));// update changeset with imputed tuples
for(S=0,T=v.length;S<T;++S)e.add.push(v[S]);for(S=0,T=_.length;S<T;++S)e.rem.push(_[S]);return this._imputed=v,e},t.exports=a},{"./BatchTransform":120,"./Transform":141,datalib:27,"vega-dataflow":42,"vega-logging":49}],134:[function(e,t){function a(e){return i.prototype.init.call(this,e),i.addParameters(this,{sourceX:{type:"field",default:"_source.layout_x"},sourceY:{type:"field",default:"_source.layout_y"},targetX:{type:"field",default:"_target.layout_x"},targetY:{type:"field",default:"_target.layout_y"},tension:{type:"value",default:.2},shape:{type:"value",default:"line"}}),this._output={path:"layout_path"},this.mutates(!0)}var n=e("vega-dataflow").Tuple,r=e("vega-logging"),i=e("./Transform"),o=a.prototype=Object.create(i.prototype);o.constructor=a;var p={line:function(e,t,a,n){return"M"+e+","+t+"L"+a+","+n},curve:function(e,t,a,n,r){var i=a-e,s=n-t,d=r*(i+s),o=r*(s-i);return"M"+e+","+t+"C"+(e+d)+","+(t+o)+" "+(a+o)+","+(n-d)+" "+a+","+n},cornerX:function(e,t,a,n){return"M"+e+","+t+"V"+n+"H"+a},cornerY:function(e,t,a,n){return"M"+e+","+t+"H"+a+"V"+n},cornerR:function(e,t,a,n){var r=s(e),i=d(e),o=s(a),p=d(a),u=L(a-e)>l?a<=e:a>e;return"M"+t*r+","+t*i+"A"+t+","+t+" 0 0,"+(u?1:0)+" "+t*o+","+t*p+"L"+n*o+","+n*p},diagonalX:function(e,t,a,n){var r=(e+a)/2;return"M"+e+","+t+"C"+r+","+t+" "+r+","+n+" "+a+","+n},diagonalY:function(e,t,a,n){var r=(t+n)/2;return"M"+e+","+t+"C"+e+","+r+" "+a+","+r+" "+a+","+n},diagonalR:function(e,t,a,n){var r=s(e),i=d(e),o=s(a),l=d(a),p=(t+n)/2;return"M"+t*r+","+t*i+"C"+p*r+","+p*i+" "+p*o+","+p*l+" "+n*o+","+n*l}};o.transform=function(e){function t(e){var t=i(s(e),d(e),o(e),l(e),u);n.set(e,a.path,t)}r.debug(e,["linkpath"]);var a=this._output,i=p[this.param("shape")]||p.line,s=this.param("sourceX").accessor,d=this.param("sourceY").accessor,o=this.param("targetX").accessor,l=this.param("targetY").accessor,u=this.param("tension");return e.add.forEach(t),this.reevaluate(e)&&(e.mod.forEach(t),e.rem.forEach(t)),e.fields[a.path]=1,e},t.exports=a},{"./Transform":141,"vega-dataflow":42,"vega-logging":49}],135:[function(e,t){function a(e){return i.prototype.init.call(this,e),i.addParameters(this,{on:{type:"data"},onKey:{type:"field",default:null},as:{type:"array<value>"},keys:{type:"array<field>",default:["data"]},default:{type:"value"}}),this.mutates(!0)}var n=e("vega-dataflow").Tuple,r=e("vega-logging"),i=e("./Transform"),s=a.prototype=Object.create(i.prototype);s.constructor=a,s.transform=function(e,t){function a(e){for(var t=0,a;t<c.length;++t)a=h[c[t](e)]||m,n.set(e,g[t],a)}r.debug(e,["lookup"]);var s=this.param("on"),d=s.source.last(),o=s.source.values(),l=this.param("onKey"),p=l.field,u=this.param("keys"),c=u.accessor,g=this.param("as"),m=this.param("default"),h=this._lut,f,y;// build lookup table on init, withKey modified, or tuple add/rem
if(null==h||this._on!==p||p&&d.fields[p]||d.add.length||d.rem.length){if(p)for(l=l.accessor,h={},f=0;f<o.length;++f)h[l(y=o[f])]=y;else// otherwise, use index-based lookup
h=o;this._lut=h,this._on=p,t=!0}e.add.forEach(a);var _=u.field.some(function(t){return e.fields[t]});return(_||t)&&(e.mod.forEach(a),e.rem.forEach(a)),g.forEach(function(t){e.fields[t]=1}),e},t.exports=a},{"./Transform":141,"vega-dataflow":42,"vega-logging":49}],136:[function(e,t){function a(e,t,a){// If parameter is defined w/signals, it must be resolved
// on every pulse.
this._name=e,this._type=t,this._transform=a,this._value=[],this._accessors=[],this._resolution=!1,this._signals=[]}function r(){var e=i.test(this._type),t=d.test(this._type),a=o.test(this._type),n=e?this._value:this._value[0],r=e?this._accessors:this._accessors[0];return!s.isValid(r)&&p.test(this._type)?n:t?{name:n,source:r}:a?{field:n,accessor:r}:n}var s=e("datalib"),n=e("vega-dataflow").Dependencies,i=/array/i,d=/data/i,o=/field/i,l=/expr/i,p=/value/i,u=a.prototype;u.get=function(){var e=this._transform._graph,t=d.test(this._type),a=o.test(this._type),l,p,u,c,g;// If we don't require resolution, return the value immediately.
if(!this._resolution)return r.call(this);if(t)return this._accessors=this._value.map(function(t){return e.data(t)}),r.call(this);// TODO: support signal as dataTypes
for(l=0,p=this._signals.length;l<p;++l)u=this._signals[l],c=u.index,g=u.value(e),a&&(this._accessors[c]=this._value[c]==g?this._accessors[c]:s.accessor(g)),this._value[c]=g;return r.call(this)},u.set=function(e){var t=this,a=t._transform._graph,r=l.test(this._type),p=d.test(this._type),u=o.test(this._type);return t._signals=[],this._value=s.array(e).map(function(d,o){var i;return s.isString(d)?r?(i=a.expr(d),t._transform.dependency(n.FIELDS,i.fields),t._transform.dependency(n.SIGNALS,i.globals),t._transform.dependency(n.DATA,i.dataSources),i.fn):(u?(// Backwards compatibility
t._accessors[o]=s.accessor(d),t._transform.dependency(n.FIELDS,s.field(d))):p&&(t._resolution=!0,t._transform.dependency(n.DATA,d)),d):void 0===d.value?void 0===d.field?void 0===d.signal?void 0===d.expr?d:(t._resolution=!0,i=a.expr(d.expr),t._transform.dependency(n.SIGNALS,i.globals),t._signals.push({index:o,value:function(){return i.fn()}}),d.expr):(t._resolution=!0,t._transform.dependency(n.SIGNALS,s.field(d.signal)[0]),t._signals.push({index:o,value:function(e){return e.signalRef(d.signal)}}),d.signal):(t._accessors[o]=s.accessor(d.field),t._transform.dependency(n.FIELDS,s.field(d.field)),d.field):d.value}),t._transform},t.exports=a},{datalib:27,"vega-dataflow":42}],137:[function(e,t){function a(e){return p.prototype.init.call(this,e),o.addParameters(this,{field:{type:"field",default:null},startAngle:{type:"value",default:0},endAngle:{type:"value",default:2*l},sort:{type:"value",default:!1}}),this._output={start:"layout_start",end:"layout_end",mid:"layout_mid"},this.mutates(!0)}function n(){return 1}var r=e("datalib"),s=e("vega-dataflow").Tuple,d=e("vega-logging"),o=e("./Transform"),p=e("./BatchTransform"),u=a.prototype=Object.create(p.prototype);u.constructor=a,u.batchTransform=function(e,o){d.debug(e,["pie"]);var l=this._output,p=this.param("field").accessor||n,u=this.param("startAngle"),c=this.param("endAngle"),g=this.param("sort"),m=o.map(p),h=u,f=(c-u)/r.sum(m),y=r.range(o.length),_,x,b;for(g&&y.sort(function(e,t){return m[e]-m[t]}),_=0;_<y.length;++_)x=o[y[_]],b=m[y[_]],s.set(x,l.start,h),s.set(x,l.mid,h+.5*b*f),s.set(x,l.end,h+=b*f);return e.fields[l.start]=1,e.fields[l.end]=1,e.fields[l.mid]=1,e},t.exports=a},{"./BatchTransform":120,"./Transform":141,datalib:27,"vega-dataflow":42,"vega-logging":49}],138:[function(e,t){function a(e){return s.prototype.init.call(this,e),i.addParameters(this,{field:{type:"field",default:null},normalize:{type:"value",default:!1}}),this._output={rank:"rank"},this.mutates(!0)}var n=e("vega-dataflow").Tuple,r=e("vega-logging"),i=e("./Transform"),s=e("./BatchTransform"),d=a.prototype=Object.create(s.prototype);d.constructor=a,d.batchTransform=function(e,t){r.debug(e,["rank"]);var a=this._output.rank,s=this.param("normalize"),o=this.param("field").accessor,l={},p=t.length,u,c,g,m;// If we have a field accessor, first compile distinct keys.
if(o)for(u=0,c=0;u<p;++u)g=t[u],l[m=o(g)]=l[m]||(l[m]=++c);// Assign ranks to all tuples.
for(u=0;u<p&&(g=t[u]);++u)o&&(m=o(g))?n.set(g,a,s?l[m]/c:l[m]):n.set(g,a,s?(u+1)/p:u+1);return e.fields[a]=1,e},t.exports=a},{"./BatchTransform":120,"./Transform":141,"vega-dataflow":42,"vega-logging":49}],139:[function(e,t){function a(e){i.prototype.init.call(this,e),i.addParameters(this,{by:{type:"array<field>"}}),this.router(!0)}var n=e("datalib"),r=e("vega-logging"),i=e("./Transform"),s=a.prototype=Object.create(i.prototype);s.constructor=a,s.transform=function(e){return r.debug(e,["sorting"]),(e.add.length||e.mod.length||e.rem.length)&&(e.sort=n.comparator(this.param("by").field)),e},t.exports=a},{"./Transform":141,datalib:27,"vega-logging":49}],140:[function(e,t){function a(e){return o.prototype.init.call(this,e),d.addParameters(this,{groupby:{type:"array<field>"},sortby:{type:"array<field>"},field:{type:"field"},offset:{type:"value",default:"zero"}}),this._output={start:"layout_start",end:"layout_end",mid:"layout_mid"},this.mutates(!0)}function n(e,t,a,n){var r=[],d=function(e){return e(p)},o,l,p,u,c,m,h;// partition data points into stack groups
if(null==t)r.push(e.slice());else for(o={},l=0;l<e.length;++l)p=e[l],u=t.map(d),c=o[u]||(r.push(o[u]=[]),o[u]),c.push(p);// compute sums of groups, sort groups as needed
for(u=0,h=0;u<r.length;++u){for(c=r[u],l=0,m=0;l<c.length;++l)m+=n(c[l]);c.sum=m,m>h&&(h=m),null!=a&&c.sort(a)}return r.max=h,r}var r=e("datalib"),i=e("vega-dataflow").Tuple,s=e("vega-logging"),d=e("./Transform"),o=e("./BatchTransform"),l=a.prototype=Object.create(o.prototype);l.constructor=a,l.batchTransform=function(e,t){s.debug(e,["stacking"]);// compute stack layouts per group
// partition, sum, and sort the stack groups
for(var d=this.param("groupby").accessor,o=r.comparator(this.param("sortby").field),l=this.param("field").accessor,p=this.param("offset"),u=this._output,c=n(t,d,o,l),g=0,m=c.max;g<c.length;++g){var h=c[g],f=h.sum,y="center"===p?(m-f)/2:0,_="normalize"===p?1/f:1,k=y,S=0,w,T,A;// set stack coordinates for each datum in group
for(w=0;w<h.length;++w)// use previous value for start point
// compute end point
T=h[w],A=k,S+=l(T),k=_*S+y,i.set(T,u.start,A),i.set(T,u.end,k),i.set(T,u.mid,.5*(A+k))}return e.fields[u.start]=1,e.fields[u.end]=1,e.fields[u.mid]=1,e},t.exports=a},{"./BatchTransform":120,"./Transform":141,datalib:27,"vega-dataflow":42,"vega-logging":49}],141:[function(e,t){function a(e){e&&r.init.call(this,e)}var n=e("vega-dataflow"),r=n.Node.prototype,// jshint ignore:line
i=n.Dependencies,s=e("./Parameter");a.addParameters=function(e,t){for(var a in e._parameters=e._parameters||{},t){var n=t[a],r=new s(a,n.type,e);e._parameters[a]=r,"custom"===n.type&&(n.set&&(r.set=n.set.bind(r)),n.get&&(r.get=n.get.bind(r))),n.hasOwnProperty("default")&&r.set(n.default)}};var d=a.prototype=Object.create(r);// Perform transformation. Subclasses should override.
d.constructor=a,d.param=function(e,t){var a=this._parameters[e];return a===void 0?this:1===arguments.length?a.get():a.set(t)},d.transform=function(e/*, reset */){return e},d.evaluate=function(e){// Many transforms store caches that must be invalidated if
// a signal value has changed.
var t=this._stamp<e.stamp&&this.dependency(i.SIGNALS).reduce(function(t,a){return t+=e.signals[a]?1:0},0);return this.transform(e,t)},d.output=function(e){for(var t in this._output)void 0!==e[t]&&(this._output[t]=e[t]);return this},t.exports=a},{"./Parameter":136,"vega-dataflow":42}],142:[function(e,t){function a(e){return o.prototype.init.call(this,e),d.addParameters(this,{groupby:{type:"array<field>"}}),this._output={children:"children",parent:"parent"},this.router(!0).produces(!0)}var n=e("datalib"),r=e("vega-dataflow").Tuple,s=e("vega-logging"),d=e("./Transform"),o=e("./BatchTransform"),l=a.prototype=Object.create(o.prototype);l.constructor=a,l.batchTransform=function(e,t){function a(e,t,n){var i=u[e].execute(n);t[o]=i,i.forEach(function(i){i[l]=t,g.push(r.ingest(i)),e+1<d.length?a(e+1,i,i[o]):i[o].forEach(function(e){e[l]=i})})}s.debug(e,["treeifying"]);var d=this.param("groupby").field,o=this._output.children,l=this._output.parent,p=[{name:"*",ops:["values"],as:[o]}],u=d.map(function(e){return n.groupby(e).summarize(p)}),c=this._internal||[],g=[],m=r.ingest({}),h,f;// update changeset with internal nodes
for(m[l]=null,g.push(m),a(0,m,t),(h=0,f=g.length);h<f;++h)e.add.push(g[h]);for(h=0,f=c.length;h<f;++h)e.rem.push(c[h]);return this._internal=g,e},t.exports=a},{"./BatchTransform":120,"./Transform":141,datalib:27,"vega-dataflow":42,"vega-logging":49}],143:[function(e,t){(function(a){function n(t){return l.prototype.init.call(this,t),o.addParameters(this,{// hierarchy parameters
sort:{type:"array<field>",default:["-value"]},children:{type:"field",default:"children"},parent:{type:"field",default:"parent"},field:{type:"field",default:"value"},// treemap parameters
size:{type:"array<value>",default:e("./screen").size},round:{type:"value",default:!0},sticky:{type:"value",default:!1},ratio:{type:"value",default:p},padding:{type:"value",default:null},mode:{type:"value",default:"squarify"}}),this._layout=r.layout.treemap(),this._output={x:"layout_x",y:"layout_y",width:"layout_width",height:"layout_height",depth:"layout_depth"},this.mutates(!0)}var r="undefined"==typeof window?"undefined"==typeof a?null:a.d3:window.d3,i=e("datalib"),s=e("vega-dataflow").Tuple,d=e("vega-logging"),o=e("./Transform"),l=e("./BatchTransform"),p=.5*(1+h(5)),u=n.prototype=Object.create(l.prototype);u.constructor=n,u.batchTransform=function(e,t){d.debug(e,["treemap"]);// get variables
var a=this._layout,r=this._output,o=this.param("sticky"),l=this.param("parent").accessor,p=t.filter(function(e){return null===l(e)})[0];// layout.sticky resets state _regardless_ of input value
// so, we perform out own check first
return a.sticky()!==o&&a.sticky(o),a.sort(i.comparator(this.param("sort").field)).children(this.param("children").accessor).value(this.param("field").accessor).size(this.param("size")).round(this.param("round")).ratio(this.param("ratio")).padding(this.param("padding")).mode(this.param("mode")).nodes(p),t.forEach(function(e){s.set(e,r.x,e.x),s.set(e,r.y,e.y),s.set(e,r.width,e.dx),s.set(e,r.height,e.dy),s.set(e,r.depth,e.depth)}),e.fields[r.x]=1,e.fields[r.y]=1,e.fields[r.width]=1,e.fields[r.height]=1,e.fields[r.depth]=1,e},t.exports=n}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{"./BatchTransform":120,"./Transform":141,"./screen":147,datalib:27,"vega-dataflow":42,"vega-logging":49}],144:[function(e,t){(function(a){function n(t){return l.prototype.init.call(this,t),o.addParameters(this,{clipExtent:{type:"array<value>",default:e("./screen").extent},x:{type:"field",default:"layout_x"},y:{type:"field",default:"layout_y"}}),this._layout=r.geom.voronoi(),this._output={path:"layout_path"},this.mutates(!0)}var r="undefined"==typeof window?"undefined"==typeof a?null:a.d3:window.d3,s=e("vega-dataflow/src/Tuple"),d=e("vega-logging"),o=e("./Transform"),l=e("./BatchTransform"),p=n.prototype=Object.create(l.prototype);p.constructor=n,p.batchTransform=function(e,t){d.debug(e,["voronoi"]);// build and assign path strings
// configure layout
for(var a=this._output.path,n=this._layout.clipExtent(this.param("clipExtent")).x(this.param("x").accessor).y(this.param("y").accessor)(t),r=0;r<t.length;++r)n[r]&&s.set(t[r],a,"M"+n[r].join("L")+"Z");// return changeset
return e.fields[a]=1,e},t.exports=n}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{"./BatchTransform":120,"./Transform":141,"./screen":147,"vega-dataflow/src/Tuple":41,"vega-logging":49}],145:[function(e,t){(function(a){function n(t){return g.prototype.init.call(this,t),c.addParameters(this,{size:{type:"array<value>",default:e("./screen").size},text:{type:"field",default:"data"},rotate:{type:"field|value",default:0},font:{type:"field|value",default:{value:"sans-serif"}},fontSize:{type:"field|value",default:14},fontStyle:{type:"field|value",default:{value:"normal"}},fontWeight:{type:"field|value",default:{value:"normal"}},fontScale:{type:"array<value>",default:[10,50]},padding:{type:"value",default:1},spiral:{type:"value",default:"archimedean"}}),this._layout=o().canvas(l.instance),this._output={x:"layout_x",y:"layout_y",font:"layout_font",fontSize:"layout_fontSize",fontStyle:"layout_fontStyle",fontWeight:"layout_fontWeight",rotate:"layout_rotate"},this.mutates(!0)}function r(e){return e&&e.accessor||e}function i(e){var t=Object.create(e);return t._tuple=e,t}var s=e("datalib"),d="undefined"==typeof window?"undefined"==typeof a?null:a.d3:window.d3,o="undefined"==typeof window?"undefined"==typeof a?null:a.d3.layout.cloud:window.d3.layout.cloud,l=e("vega-scenegraph").canvas,p=e("vega-dataflow/src/Tuple"),u=e("vega-logging"),c=e("./Transform"),g=e("./BatchTransform"),m=n.prototype=Object.create(g.prototype);m.constructor=n,m.batchTransform=function(e,t){u.debug(e,["wordcloud"]);// get variables
var a=this._layout,n=this._output,o=this.param("fontSize"),l=o.accessor&&this.param("fontScale"),c,g;// return changeset
for(var m in o=o.accessor||d.functor(o),l.length&&(g=d.scale.sqrt().domain(s.extent(t,c=o)).range(l),o=function(e){return g(c(e))}),a.size(this.param("size")).text(r(this.param("text"))).padding(this.param("padding")).spiral(this.param("spiral")).rotate(r(this.param("rotate"))).font(r(this.param("font"))).fontStyle(r(this.param("fontStyle"))).fontWeight(r(this.param("fontWeight"))).fontSize(o).words(t.map(i))// wrap to avoid tuple writes
.on("end",function(e){var r=a.size(),s=r[0]>>1,d=r[1]>>1,o,l,u,c;for(u=0,c=e.length;u<c;++u)o=e[u],l=o._tuple,p.set(l,n.x,o.x+s),p.set(l,n.y,o.y+d),p.set(l,n.font,o.font),p.set(l,n.fontSize,o.size),p.set(l,n.fontStyle,o.style),p.set(l,n.fontWeight,o.weight),p.set(l,n.rotate,o.rotate)}).start(),n)e.fields[n[m]]=1;return e},t.exports=n}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{"./BatchTransform":120,"./Transform":141,"./screen":147,datalib:27,"vega-dataflow/src/Tuple":41,"vega-logging":49,"vega-scenegraph":50}],146:[function(e,t){t.exports={aggregate:e("./Aggregate"),bin:e("./Bin"),cross:e("./Cross"),countpattern:e("./CountPattern"),linkpath:e("./LinkPath"),facet:e("./Facet"),filter:e("./Filter"),fold:e("./Fold"),force:e("./Force"),formula:e("./Formula"),geo:e("./Geo"),geopath:e("./GeoPath"),hierarchy:e("./Hierarchy"),impute:e("./Impute"),lookup:e("./Lookup"),pie:e("./Pie"),rank:e("./Rank"),sort:e("./Sort"),stack:e("./Stack"),treeify:e("./Treeify"),treemap:e("./Treemap"),voronoi:e("./Voronoi"),wordcloud:e("./Wordcloud")}},{"./Aggregate":119,"./Bin":121,"./CountPattern":122,"./Cross":123,"./Facet":124,"./Filter":126,"./Fold":127,"./Force":128,"./Formula":129,"./Geo":130,"./GeoPath":131,"./Hierarchy":132,"./Impute":133,"./LinkPath":134,"./Lookup":135,"./Pie":137,"./Rank":138,"./Sort":139,"./Stack":140,"./Treeify":142,"./Treemap":143,"./Voronoi":144,"./Wordcloud":145}],147:[function(e,t){t.exports={size:[{signal:"width"},{signal:"height"}],mid:[{expr:"width/2"},{expr:"height/2"}],extent:[{expr:"[-padding.left, -padding.top]"},{expr:"[width+padding.right, height+padding.bottom]"}]}},{}],148:[function(e,t){function a(e){switch(e.type){case"time":return"time";case"utc":return"utc";case"ordinal":return"string";default:return"number";}}// Adapted from d3 log scale
// TODO customize? replace with range-size-aware filtering?
function n(t,a,n,r){function i(e){return(0>a[0]?-_(0<e?0:-e):_(0>e?0:e))/_(d)}function s(e){return 0>a[0]?-S(d,-e):S(d,e)}if(null==n)return r;var d=t.base(),o=w(d,t.ticks().length/n),l=0<a[0]?(p=1e-12,y):(p=-1e-12,T),p;return function(e){return s(l(i(e)+p))/e>=o?r(e):""}}function r(e,t,a,r){var s=i.format,d="log"===e.type,o;return"number"===a?(o=e.domain(),d?n(e,o,t,s.auto.number(r||null)):s.auto.linear(o,t,r||null)):"time"===a?(r?s:s.auto).time(r):"utc"===a?(r?s:s.auto).utc(r):String}var i=e("datalib");t.exports={getTickFormat:function(e,t,n,i){var s=n||a(e);return r(e,t,s,i)}}},{datalib:27}],149:[function(e,t){var a=e("datalib"),n={};a.extend(n,e("./format")),t.exports=a.extend(n,a)},{"./format":148,datalib:27}],150:[function(e,t){t.exports=function(e,t,a,n){if(e[a]!==void 0)return e[a];return void 0!==t&&void 0!==t[a]?t[a]:void 0===n?void 0:n}},{}]},{},[1])(1)});
(function(e,t){'object'==typeof exports&&'undefined'!=typeof module?t(exports):'function'==typeof define&&define.amd?define(['exports'],t):t(vega={})})(this,function(e){'use strict';var GE=Math.tan,YE=Number.MAX_VALUE,HE=String.fromCharCode,VE=Math.LN2,XE=Math.E,ZE=Math.atan,JE=Math.atan2,QE=Math.cos,KE=Math.sin,eS=Math.asin,tS=Math.acos,nS=Math.SQRT2,aS=Math.PI,iS=Math.min,dS=Math.sqrt,rS=Math.LN10,lS=Math.abs,oS=Math.round,sS=Math.floor,fS=Math.max,cS=Math.ceil,uS=Math.sign,pS=Math.pow,gS=Math.log,mS=Math.exp;function r(e,t,n){return e.fields=t||[],e.fname=n,e}function o(e){return null==e?null:e.fname}function s(e){return null==e?null:e.fields}function u(e){throw Error(e)}function p(e){function t(){a.push(n+e.substring(o,f)),n='',o=f+1}var a=[],d=null,r=0,l=e.length,n='',o,f,g;for(e+='',o=f=0;f<l;++f)if(g=e[f],'\\'===g)n+=e.substring(o,f),o=++f;else if(g===d)t(),d=null,r=-1;else if(d)continue;else o===r&&'"'===g?(o=f+1,d=g):o===r&&'\''===g?(o=f+1,d=g):'.'!==g||r?'['===g?(f>o&&t(),r=o=f+1):']'===g&&(r||u('Access path missing open bracket: '+e),0<r&&t(),r=0,o=f+1):f>o?t():o=f+1;return r&&u('Access path missing closing bracket: '+e),d&&u('Access path missing closing quote: '+e),f>o&&(f++,t()),a}function g(e){return e===Object(e)}function m(e){return'string'==typeof e}function h(e){return hS(e)?'['+e.map(h)+']':g(e)||m(e)?// Output valid JSON and JS source strings.
// See http://timelessrepo.com/json-isnt-a-javascript-subset
JSON.stringify(e).replace('\u2028','\\u2028').replace('\u2029','\\u2029'):e}function t(e,t){var n=p(e),a='return _['+n.map(h).join('][')+'];';return r(Function('_',a),[e=1===n.length?n[0]:e],t||e)}function n(e,t,n){var a=[t].concat([].slice.call(n));console[e].apply(console,a)}function a(e){var t=e||0;return{level:function(e){return arguments.length?(t=+e,this):t},error:function(){return 1<=t&&n('error','ERROR',arguments),this},warn:function(){return 2<=t&&n('warn','WARN',arguments),this},info:function(){return 3<=t&&n('log','INFO',arguments),this},debug:function(){return 4<=t&&n('log','DEBUG',arguments),this}}}function f(e){return e[e.length-1]}function c(e){return null==e||''===e?null:+e}function b(e){return function(t){return e*mS(t)}}function v(e){return function(t){return gS(e*t)}}function k(e){return function(t){return 0>t?-pS(-t,e):pS(t,e)}}function w(e,t,n,a){var i=n(e[0]),d=n(f(e)),r=(d-i)*t;return[a(i-r),a(d-r)]}function S(e,t){return w(e,t,c,id)}function z(e,t){var n=uS(e[0]);return w(e,t,v(n),b(n))}function R(e,t,n){return w(e,t,k(n),k(1/n))}function $(e,t,n,a,i){var d=a(e[0]),r=a(f(e)),l=null==t?(d+r)/2:a(t);return[i(l+(d-l)*n),i(l+(r-l)*n)]}function O(e,t,n){return $(e,t,n,c,id)}function T(e,t,n){var a=uS(e[0]);return $(e,t,n,v(a),b(a))}function L(e,t,n,a){return $(e,t,n,k(a),k(1/a))}function P(e){return null==e?[]:hS(e)?e:[e]}function M(e){return'function'==typeof e}function U(e,a){var l=[],o=(e=P(e)).map(function(e,t){return null==e?null:(l.push(t),M(e)?e:p(e).map(h).join(']['))}),c=l.length-1,n=P(a),g='var u,v;return ',m,y,b,_,x,k,w,E,S;if(0>c)return null;for(y=0;y<=c;++y)m=l[y],b=o[m],M(b)?(k='f'+m,_='(u=this.'+k+'(a))',x='(v=this.'+k+'(b))',(w=w||{})[k]=b):(_='(u=a['+b+'])',x='(v=b['+b+'])'),k='((v=v instanceof Date?+v:v),(u=u instanceof Date?+u:u))','descending'===n[m]?(S=-1,E=1):(S=1,E=-1),g+='('+_+'<'+x+'||u==null)&&v!=null?'+E+':(u>v||v==null)&&u!=null?'+S+':'+k+'!==u&&v===v?'+E+':v!==v&&u===u?'+S+(m<c?':':':0');return b=Function('a','b',g+';'),w&&(b=b.bind(w)),e=e.reduce(function(e,t){return M(t)?(s(t)||[]).forEach(function(t){e[t]=1}):null!=t&&(e[t+'']=1),e},{}),r(b,Object.keys(e))}function j(e){return M(e)?e:function(){return e}}function q(t,n){function a(){n(d),i=d=null}var i,d;return function(n){d=n,i&&clearTimeout(i),i=setTimeout(a,t)}}function F(e){for(var t=1,n=arguments.length,a,d;t<n;++t)for(d in a=arguments[t],a)e[d]=a[d];return e}function I(e,t){var d=-1,r=e.length,n,l,o,s,f;if(null==t){for(;++d<r;)if(l=e[d],null!=l&&l>=l){n=o=l;break}for(s=f=d;++d<r;)l=e[d],null!=l&&(n>l&&(n=l,s=d),o<l&&(o=l,f=d))}else{for(;++d<r;)if(l=t(e[d],d,e),null!=l&&l>=l){n=o=l;break}for(s=f=d;++d<r;)l=t(e[d],d,e),null!=l&&(n>l&&(n=l,s=d),o<l&&(o=l,f=d))}return[s,f]}function N(e){function t(e){return n.hasOwnProperty(e)&&n[e]!==vS}var n={},a,i;return a={size:0,empty:0,object:n,has:t,get:function(e){return t(e)?n[e]:void 0},set:function(e,i){return t(e)||(++a.size,n[e]===vS&&--a.empty),n[e]=i,this},delete:function(e){return t(e)&&(--a.size,++a.empty,n[e]=vS),this},clear:function(){a.size=a.empty=0,a.object=n={}},test:function(e){return arguments.length?(i=e,a):i},clean:function(){var e={},t=0,d,r;for(d in n)r=n[d],r===vS||i&&i(r)||(e[d]=r,++t);a.size=t,a.empty=0,a.object=n=e}},e&&Object.keys(e).forEach(function(t){a.set(t,e[t])}),a}function W(e,t){var n=e.prototype=Object.create(t.prototype);return n.constructor=e,n}function G(e){return'boolean'==typeof e}function Y(e){return'[object Date]'===Object.prototype.toString.call(e)}function H(e){return'number'==typeof e}function V(e){return'[object RegExp]'===Object.prototype.toString.call(e)}function X(e,t){e&&(e=t?P(e).map(function(e){return e.replace(/\\(.)/g,'$1')}):P(e));var n=e&&e.length?Function('_','return \'\'+'+e.map(function(e){return'_['+(t?h(e):p(e).map(h).join(']['))+']'}).join('+\'|\'+')+';'):function(){return''};return r(n,e,'key')}function Z(e,t,n,a){var d=t.length,r=n.length;if(!r)return t;if(!d)return n;for(var l=a||new t.constructor(d+r),o=0,s=0,f=0;o<d&&s<r;++f)l[f]=0<e(t[o],n[s])?n[s++]:t[o++];for(;o<d;++o,++f)l[f]=t[o];for(;s<r;++s,++f)l[f]=n[s];return l}function J(e,t){for(var n='';0<=--t;)n+=e;return n}function Q(e,t,a,i){var d=a||' ',r=e+'',l=t-r.length;return 0>=l?r:'left'===i?J(d,l)+r:'center'===i?J(d,~~(l/2))+r+J(d,cS(l/2)):r+J(d,l)}function K(e){return null==e||''===e?null:!!(e&&'false'!=e&&'0'!=e)&&!!e}function ee(e){return H(e)?e:Y(e)?e:Date.parse(e)}function te(e,t){return t=t||ee,null==e||''===e?null:t(e)}function ne(e){return null==e||''===e?null:e+''}function ae(e){for(var t={},a=0,d=e.length;a<d;++a)t[e[a]]=!0;return t}function ie(t,a,i,d){var r=null==d?'\u2026':d,e=t+'',o=e.length,n=fS(0,a-r.length);return o<=a?e:'left'===i?r+e.slice(o-n):'center'===i?e.slice(0,cS(n/2))+r+e.slice(o-~~(n/2)):e.slice(0,n)+r}function de(e,a,d){if(e){var r=0,l=e.length,n;if(a)for(;r<l;++r)(n=a(e[r]))&&d(n,r,e);else e.forEach(d)}}function le(e){var t=e||id,n=[],a={};return n.add=function(e){var i=t(e);return a[i]||(a[i]=1,n.push(e)),n},n.remove=function(e){var i=t(e),d;return a[i]&&(a[i]=0,0<=(d=n.indexOf(e))&&n.splice(d,1)),n},n}/**
   * Checks if an input value is a registered tuple.
   * @param {*} t - The value to check.
   * @return {boolean} True if the input is a tuple, false otherwise.
   */function oe(e){return!!(e&&se(e))}/**
   * Returns the id of a tuple.
   * @param {object} t - The input tuple.
   * @return {*} the tuple id.
   */function se(e){return e[kS]}/**
   * Sets the id of a tuple.
   * @param {object} t - The input tuple.
   * @param {*} id - The id value to set.
   * @return {object} the input tuple.
   */function fe(e,t){return e[kS]=t,e}/**
   * Ingest an object or value as a data tuple.
   * If the input value is an object, an id field will be added to it. For
   * efficiency, the input object is modified directly. A copy is not made.
   * If the input value is a literal, it will be wrapped in a new object
   * instance, with the value accessible as the 'data' property.
   * @param datum - The value to ingest.
   * @return {object} The ingested data tuple.
   */function ce(e){var n=e===Object(e)?e:{data:e};return se(n)?n:fe(n,wS++)}/**
   * Given a source tuple, return a derived copy.
   * @param {object} t - The source tuple.
   * @return {object} The derived tuple.
   */function ue(e){return pe(e,ce({}))}/**
   * Rederive a derived tuple by copying values from the source tuple.
   * @param {object} t - The source tuple.
   * @param {object} d - The derived tuple.
   * @return {object} The derived tuple.
   */function pe(e,t){for(var n in e)t[n]=e[n];return t}/**
   * Replace an existing tuple with a new tuple.
   * @param {object} t - The existing data tuple.
   * @param {object} d - The new tuple that replaces the old.
   * @return {object} The new tuple.
   */function ge(e,t){return fe(t,se(e))}function me(e){return e&&e.constructor===he}function he(){var e=[],// insert tuples
r=[],// remove tuples
l=[],// modify tuples
o=[],// remove by predicate
s=[],// modify by predicate
c=!1;return{constructor:he,insert:function(a){for(var t=P(a),d=0,r=t.length;d<r;++d)e.push(t[d]);return this},remove:function(e){for(var t=M(e)?o:r,a=P(e),d=0,l=a.length;d<l;++d)t.push(a[d]);return this},modify:function(e,t,n){var a={field:t,value:j(n)};return M(e)?(a.filter=e,s.push(a)):(a.tuple=e,l.push(a)),this},encode:function(e,t){return M(e)?s.push({filter:e,field:t}):l.push({tuple:e,field:t}),this},reflow:function(){return c=!0,this},pulse:function(a,d){// modify helper method
function u(e,t,n){n?e[t]=n(e):a.encode=t,c||(g[se(e)]=e)}// process individual tuples to modify
var p={},g={},h,y,b,_,x,v;// build lookup table of current tuples
for(h=0,y=d.length;h<y;++h)p[se(d[h])]=1;// process individual tuples to remove
for(h=0,y=r.length;h<y;++h)x=r[h],p[se(x)]=-1;// process predicate-based removals
for(h=0,y=o.length;h<y;++h)_=o[h],d.forEach(function(e){_(e)&&(p[se(e)]=-1)});// process all add tuples
for(h=0,y=e.length;h<y;++h)x=e[h],v=se(x),p[v]?p[v]=1:a.add.push(ce(e[h]));// populate pulse rem list
for(h=0,y=d.length;h<y;++h)x=d[h],0>p[se(x)]&&a.rem.push(x);for(h=0,y=l.length;h<y;++h)b=l[h],x=b.tuple,_=b.field,v=p[se(x)],0<v&&(u(x,_,b.value),a.modifies(_));// process predicate-based modifications
for(h=0,y=s.length;h<y;++h)b=s[h],_=b.filter,d.forEach(function(e){_(e)&&0<p[se(e)]&&u(e,b.field,b.value)}),a.modifies(b.field);// upon reflow request, populate mod with all non-removed tuples
// otherwise, populate mod with modified tuples only
if(c)a.mod=r.length||o.length?d.filter(function(e){return 0<p[se(e)]}):d.slice();else for(v in g)a.mod.push(g[v]);return a}}}/**
   * Hash that tracks modifications to assigned values.
   * Callers *must* use the set method to update values.
   */function ye(){Object.defineProperty(this,'_:mod:_',{writable:!0,value:{}})}/**
   * An Operator is a processing node in a dataflow graph.
   * Each operator stores a value and an optional value update function.
   * Operators can accept a hash of named parameters. Parameter values can
   * either be direct (JavaScript literals, arrays, objects) or indirect
   * (other operators whose values will be pulled dynamically). Operators
   * included as parameters will have this operator added as a dependency.
   * @constructor
   * @param {*} [init] - The initial value for this operator.
   * @param {function(object, Pulse)} [update] - An update function. Upon
   *   evaluation of this operator, the update function will be invoked and the
   *   return value will be used as the new value of this operator.
   * @param {object} [params] - The parameters for this operator.
   * @param {boolean} [react=true] - Flag indicating if this operator should
   *   listen for changes to upstream operators included as parameters.
   * @see parameters
   */function be(e,t,n,a){this.id=++SS,this.value=e,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,t&&(this._update=t),n&&this.parameters(n,a)}function _e(e){return function(t){var n=this.flags;return 0===arguments.length?!!(n&e):(this.flags=t?n|e:n&~e,this)}}/**
   * Indicates that operator evaluation should be skipped on the next pulse.
   * This operator will still propagate incoming pulses, but its update function
   * will not be invoked. The skip flag is reset after every pulse, so calling
   * this method will affect processing of the next pulse only.
   *//**
   * Add an operator to the dataflow graph. This function accepts a
   * variety of input argument types. The basic signature supports an
   * initial value, update function and parameters. If the first parameter
   * is an Operator instance, it will be added directly. If it is a
   * constructor for an Operator subclass, a new instance will be instantiated.
   * Otherwise, if the first parameter is a function instance, it will be used
   * as the update function and a null initial value is assumed.
   * @param {*} init - One of: the operator to add, the initial value of
   *   the operator, an operator class to instantiate, or an update function.
   * @param {function} [update] - The operator update function.
   * @param {object} [params] - The operator parameters.
   * @param {boolean} [react=true] - Flag indicating if this operator should
   *   listen for changes to upstream operators included as parameters.
   * @return {Operator} - The added operator.
   *//**
   * Connect a target operator as a dependent of source operators.
   * If necessary, this method will rerank the target operator and its
   * dependents to ensure propagation proceeds in a topologically sorted order.
   * @param {Operator} target - The target operator.
   * @param {Array<Operator>} - The source operators that should propagate
   *   to the target operator.
   *//**
   * Models an event stream.
   * @constructor
   * @param {function(Object, number): boolean} [filter] - Filter predicate.
   *   Events pass through when truthy, events are suppressed when falsy.
   * @param {function(Object): *} [apply] - Applied to input events to produce
   *   new event values.
   * @param {function(Object)} [receive] - Event callback function to invoke
   *   upon receipt of a new event. Use to override standard event processing.
   */function xe(e,t,n){this.id=++DS,this.value=null,n&&(this.receive=n),e&&(this._filter=e),t&&(this._apply=t)}/**
   * Creates a new event stream instance with the provided
   * (optional) filter, apply and receive functions.
   * @param {function(Object, number): boolean} [filter] - Filter predicate.
   *   Events pass through when truthy, events are suppressed when falsy.
   * @param {function(Object): *} [apply] - Applied to input events to produce
   *   new event values.
   * @see EventStream
   */function ve(e,t,n){return new xe(e,t,n)}/**
   * Create a new event stream from an event source.
   * @param {object} source - The event source to monitor. The input must
   *  support the addEventListener method.
   * @param {string} type - The event type.
   * @param {function(object): boolean} [filter] - Event filter function.
   * @param {function(object): *} [apply] - Event application function.
   *   If provided, this function will be invoked and the result will be
   *   used as the downstream event value.
   * @return {EventStream}
   *//**
   * Creates a new loader instance that provides methods for requesting files
   * from either the network or disk, and for sanitizing request URIs.
   * @param {object} [options] - Optional default loading options to use.
   * @return {object} - A new loader instance.
   */// Matches absolute URLs with optional protocol
//   https://...    file://...    //...
function ke(e){return{options:e||{},sanitize:Ee,load:we,file:Ce,http:Se}}/**
   * Load an external resource, typically either from the web or from the local
   * filesystem. This function uses {@link sanitize} to first sanitize the uri,
   * then calls either {@link http} (for web requests) or {@link file} (for
   * filesystem loading).
   * @param {string} uri - The resource indicator (e.g., URL or filename).
   * @param {object} [options] - Optional loading options. These options will
   *   override any existing default options.
   * @return {Promise} - A promise that resolves to the loaded content.
   */function we(e,t){var n=this;return n.sanitize(e,t).then(function(e){var a=e.href;return e.localFile?n.file(a):n.http(a,t)})}/**
   * URI sanitizer function.
   * @param {string} uri - The uri (url or filename) to sanity check.
   * @param {object} options - An options hash.
   * @return {Promise} - A promise that resolves to an object containing
   *  sanitized uri data, or rejects it the input uri is deemed invalid.
   *  The properties of the resolved object are assumed to be
   *  valid attributes for an HTML 'a' tag. The sanitized uri *must* be
   *  provided by the 'href' property of the returned object.
   */function Ee(e,t){return t=F({},this.options,t),new Promise(function(n,a){var d={href:null},r,l,o,s;return null==e||'string'!=typeof e?void a('Sanitize failure, invalid URI: '+h(e)):void(// should we load from file system?
// set non-enumerable mode flag to indicate local file load
// set uri
// return
l=$S.test(e),(s=t.baseURL)&&!l&&(!i(e,'/')&&'/'!==s[s.length-1]&&(e='/'+e),e=s+e),o=(r=i(e,'file://'))||'file'===t.mode||'http'!==t.mode&&!l&&De(),r?e=e.slice(7):i(e,'//')&&('file'===t.defaultProtocol?(e=e.slice(2),o=!0):e=(t.defaultProtocol||'http')+':'+e),Object.defineProperty(d,'localFile',{value:!!o}),d.href=e,t.target&&(d.target=t.target+''),n(d))})}/**
   * HTTP request loader.
   * @param {string} url - The url to request.
   * @param {object} options - An options hash.
   * @return {Promise} - A promise that resolves to the file contents.
   */function Se(e,t){return ze(e,F({},this.options.http,t)).then(function(e){if(!e.ok)throw e.status+''+e.statusText;return e.text()})}/**
   * File system loader.
   * @param {string} filename - The file system path to load.
   * @return {Promise} - A promise that resolves to the file contents.
   */function Ce(e){return new Promise(function(t,n){var a=De();a?a.readFile(e,function(e,a){e?n(e):t(a)}):n('No file system access for '+e)})}function ze(e,t){var n='function'==typeof fetch?fetch:require('node-fetch');return n?n(e,t):Promise.reject('No fetch method available.')}function De(){var e='function'==typeof require&&require('fs');return e&&M(e.readFile)?e:null}function i(e,t){return null!=e&&0===e.lastIndexOf(t,0)}function d(e,d){if(!e||!e.length)return'unknown';var r=0,l=e.length,o=TS.length,s=TS.map(function(e,t){return t+1}),a,f,c;for(f=0,l=e.length;f<l;++f)for(a=d?e[f][d]:e[f],c=0;c<o;++c)if(s[c]&&Re(a)&&!TS[c](a)&&(s[c]=0,++r,r===TS.length))return'string';return r=s.reduce(function(e,t){return 0===e?t:e},0)-1,AS[r]}function l(e,t){return t.reduce(function(t,n){return t[n]=d(e,n),t},{})}// -- Type Checks ----
function Re(e){return null!=e&&e===e}function $e(e){return!isNaN(+e)&&!(e instanceof Date)}function Oe(e){return new Function('d','return {'+e.map(function(e,t){return JSON.stringify(e)+': d['+t+']'}).join(',')+'}')}function Te(e,t){var n=Oe(e);return function(a,d){return t(n(a),d,e)}}// Compute unique columns in order of discovery.
function Ae(e){var t=Object.create(null),n=[];return e.forEach(function(e){for(var a in e)a in t||n.push(t[a]=a)}),n}function Le(e){function t(e,a){function i(){if(f)return PS;if(u)return u=!1,LS;// Unescape quotes.
var t=o,n,a;if(34===e.charCodeAt(t)){for(;o++<l&&34!==e.charCodeAt(o)||34===e.charCodeAt(++o););return(n=o)>=l?f=!0:10===(a=e.charCodeAt(o++))?u=!0:13===a&&(u=!0,10===e.charCodeAt(o)&&++o),e.slice(t+1,n-1).replace(/""/g,'"')}// Find next delimiter or newline.
for(;o<l;){if((a=e.charCodeAt(n=o++))===10)u=!0;else if(a===13)u=!0,10===e.charCodeAt(o)&&++o;else if(a!==d)continue;return e.slice(t,n)}// Return last token before EOF.
return f=!0,e.slice(t,l)}var r=[],// output rows
l=e.length,o=0,// current character index
s=0,// current token
f=0>=l,// current token followed by EOF?
u=!1,// current line number
p;// current token followed by EOL?
// Strip the trailing newline.
for(10===e.charCodeAt(l-1)&&--l,13===e.charCodeAt(l-1)&&--l;(p=i())!==PS;){for(var c=[];p!==LS&&p!==PS;)c.push(p),p=i();a&&null==(c=a(c,s++))||r.push(c)}return r}function n(t){return t.map(a).join(e)}function a(e){return null==e?'':i.test(e+='')?'"'+e.replace(/"/g,'""')+'"':e}var i=new RegExp('["'+e+'\n\r]'),d=e.charCodeAt(0);return{parse:function(e,n){var a=t(e,function(e,t){return d?d(e,t-1):void(r=e,d=n?Te(e,n):Oe(e))}),d,r;return a.columns=r||[],a},parseRows:t,format:function(t,n){return null==n&&(n=Ae(t)),[n.map(a).join(e)].concat(t.map(function(t){return n.map(function(e){return a(t[e])}).join(e)})).join('\n')},formatRows:function(e){return e.map(n).join('\n')}}}function Pe(e){return function(t,n){var a={delimiter:e};return Me(t,n?F(n,a):a)}}function Me(e,t){return t.header&&(e=t.header.map(h).join(t.delimiter)+'\n'+e),Le(t.delimiter).parse(e+'')}function Ue(e){return!!('function'==typeof Buffer&&M(Buffer.isBuffer))&&Buffer.isBuffer(e)}function je(e,n){var a=n&&n.property?t(n.property):id;return g(e)&&!Ue(e)?qe(a(e)):a(JSON.parse(e))}function qe(e,t){return t&&t.copy?JSON.parse(JSON.stringify(e)):e}function Fe(e){return e}function Ie(e){if(null==e)return Fe;var t=e.scale[0],a=e.scale[1],i=e.translate[0],d=e.translate[1],r,l;return function(e,o){o||(r=l=0);var s=2,f=e.length,n=Array(f);for(n[0]=(r+=e[0])*t+i,n[1]=(l+=e[1])*a+d;s<f;)n[s]=e[s],++s;return n}}function Ne(e,a){for(var n=e.length,d=n-a,r;d<--n;)r=e[d],e[d++]=e[n],e[n]=r}function Be(e,t){return'GeometryCollection'===t.type?{type:'FeatureCollection',features:t.geometries.map(function(t){return We(e,t)})}:We(e,t)}function We(e,t){var n=t.id,a=t.bbox,i=null==t.properties?{}:t.properties,d=Ge(e,t);return null==n&&null==a?{type:'Feature',properties:i,geometry:d}:null==a?{type:'Feature',id:n,properties:i,geometry:d}:{type:'Feature',id:n,bbox:a,properties:i,geometry:d}}function Ge(e,t){function a(e,t){t.length&&t.pop();for(var i=c[0>e?~e:e],a=0,d=i.length;a<d;++a)t.push(f(i[a],a));0>e&&Ne(t,d)}function i(e){return f(e)}function d(e){for(var t=[],d=0,r=e.length;d<r;++d)a(e[d],t);// This should never happen per the specification.
return 2>t.length&&t.push(t[0]),t}function r(e){for(var t=d(e);4>t.length;)t.push(t[0]);// This may happen if an arc has only two points.
return t}function l(e){return e.map(r)}function s(e){var t=e.type,n;switch(t){case'GeometryCollection':return{type:t,geometries:e.geometries.map(s)};case'Point':n=i(e.coordinates);break;case'MultiPoint':n=e.coordinates.map(i);break;case'LineString':n=d(e.arcs);break;case'MultiLineString':n=e.arcs.map(d);break;case'Polygon':n=l(e.arcs);break;case'MultiPolygon':n=e.arcs.map(l);break;default:return null;}return{type:t,coordinates:n}}var f=Ie(e.transform),c=e.arcs;return s(t)}function Ye(e,n){function a(t){var n=e.arcs[0>t?~t:t],a=n[0],i;return e.transform?(i=[0,0],n.forEach(function(e){i[0]+=e[0],i[1]+=e[1]})):i=n[n.length-1],0>t?[i,a]:[a,i]}function i(e,t){for(var n in e){var a=e[n];delete t[a.start],delete a.start,delete a.end,a.forEach(function(e){d[0>e?~e:e]=1}),o.push(a)}}var d={},r={},l={},o=[],s=-1;// Stitch empty arcs first, since they may be subsumed by other arcs.
return n.forEach(function(a,i){var d=e.arcs[0>a?~a:a],r;!(3>d.length)||d[1][0]||d[1][1]||(r=n[++s],n[s]=a,n[i]=r)}),n.forEach(function(t){var n=a(t),e=n[0],i=n[1],d,o;if(d=l[e]){if(delete l[d.end],d.push(t),d.end=i,o=r[i]){delete r[o.start];var s=o===d?d:d.concat(o);r[s.start=d.start]=l[s.end=o.end]=s}else r[d.start]=l[d.end]=d;}else if(!(d=r[i]))d=[t],r[d.start=e]=l[d.end=i]=d;else if(delete r[d.start],d.unshift(t),d.start=e,o=l[e]){delete l[o.end];var c=o===d?d:o.concat(d);r[c.start=o.start]=l[c.end=d.end]=c}else r[d.start]=l[d.end]=d}),i(l,r),i(r,l),n.forEach(function(e){d[0>e?~e:e]||o.push([e])}),o}function He(e){return Ge(e,Ve.apply(this,arguments))}function Ve(e,t,a){var d,r,l;if(1<arguments.length)d=Xe(e,t,a);else for(r=0,d=Array(l=e.arcs.length);r<l;++r)d[r]=r;return{type:'MultiLineString',arcs:Ye(e,d)}}function Xe(e,t,n){function a(e){var t=0>e?~e:e;(s[t]||(s[t]=[])).push({i:e,g:f})}function i(e){e.forEach(a)}function d(e){e.forEach(i)}function r(e){e.forEach(d)}function l(e){switch(f=e,e.type){case'GeometryCollection':e.geometries.forEach(l);break;case'LineString':i(e.arcs);break;case'MultiLineString':case'Polygon':d(e.arcs);break;case'MultiPolygon':r(e.arcs);}}var o=[],s=[],f;return l(t),s.forEach(null==n?function(e){o.push(e[0].i)}:function(e){n(e[0].g,e[e.length-1].g)&&o.push(e[0].i)}),o}function Ze(e,t){return 1<arguments.length?(jS[e]=t,this):jS.hasOwnProperty(e)?jS[e]:null}function Je(e,t,n,a){function i(t){return e(t=new Date(+t)),t}return i.floor=i,i.ceil=function(n){return e(n=new Date(n-1)),t(n,1),e(n),n},i.round=function(e){var t=i(e),n=i.ceil(e);return e-t<n-e?t:n},i.offset=function(e,n){return t(e=new Date(+e),null==n?1:sS(n)),e},i.range=function(n,a,d){var r=[],l;if(n=i.ceil(n),d=null==d?1:sS(d),!(n<a)||!(0<d))return r;// also handles Invalid Date
do r.push(l=new Date(+n)),t(n,d),e(n);while(l<n&&n<a);return r},i.filter=function(n){return Je(function(t){if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)},function(e,a){if(e>=e)if(0>a)for(;0>=++a;)for(;t(e,-1),!n(e););// eslint-disable-line no-empty
else for(;0<=--a;)for(;t(e,1),!n(e););// eslint-disable-line no-empty
})},n&&(i.count=function(t,a){return qS.setTime(+t),FS.setTime(+a),e(qS),e(FS),sS(n(qS,FS))},i.every=function(e){return e=sS(e),isFinite(e)&&0<e?1<e?i.filter(a?function(t){return 0==a(t)%e}:function(t){return 0==i.count(0,t)%e}):i:null}),i}function Qe(e){return Je(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(e,t){e.setDate(e.getDate()+7*t)},function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*60000)/604800000})}function Ke(e){return Je(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+7*t)},function(e,t){return(t-e)/604800000})}function et(e){if(0<=e.y&&100>e.y){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function tt(e){if(0<=e.y&&100>e.y){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function nt(e){return{y:e,m:0,d:1,H:0,M:0,S:0,L:0}}function at(e){function t(e,t){return function(a){var d=[],r=-1,l=0,o=e.length,n,s,f;for(a instanceof Date||(a=new Date(+a));++r<o;)37===e.charCodeAt(r)&&(d.push(e.slice(l,r)),null==(s=OC[n=e.charAt(++r)])?s='e'===n?' ':'0':n=e.charAt(++r),(f=t[n])&&(n=f(a,s)),d.push(n),l=r+1);return d.push(e.slice(l,r)),d.join('')}}function n(e,t){return function(n){var r=nt(1900),d=a(r,e,n+='',0),i,l;if(d!=n.length)return null;// If a UNIX timestamp is specified, return it.
if('Q'in r)return new Date(r.Q);// The am-pm flag is 0 for AM, and 1 for PM.
// Convert day-of-week and week-of-year to day-of-year.
if('p'in r&&(r.H=r.H%12+12*r.p),'V'in r){if(1>r.V||53<r.V)return null;'w'in r||(r.w=1),'Z'in r?(i=tt(nt(r.y)),l=i.getUTCDay(),i=4<l||0===l?bC.ceil(i):bC(i),i=mC.offset(i,7*(r.V-1)),r.y=i.getUTCFullYear(),r.m=i.getUTCMonth(),r.d=i.getUTCDate()+(r.w+6)%7):(i=t(nt(r.y)),l=i.getDay(),i=4<l||0===l?QS.ceil(i):QS(i),i=XS.offset(i,7*(r.V-1)),r.y=i.getFullYear(),r.m=i.getMonth(),r.d=i.getDate()+(r.w+6)%7)}else('W'in r||'U'in r)&&('w'in r||(r.w='u'in r?r.u%7:'W'in r?1:0),l='Z'in r?tt(nt(r.y)).getUTCDay():t(nt(r.y)).getDay(),r.m=0,r.d='W'in r?(r.w+6)%7+7*r.W-(l+5)%7:r.w+7*r.U-(l+6)%7);// If a time zone is specified, all fields are interpreted as UTC and then
// offset according to the specified time zone.
return'Z'in r?(r.H+=0|r.Z/100,r.M+=r.Z%100,tt(r)):t(r);// Otherwise, all fields are in local time.
}}function a(e,t,a,d){for(var r=0,l=t.length,n=a.length,o,s;r<l;){if(d>=n)return-1;if(o=t.charCodeAt(r++),37===o){if(o=t.charAt(r++),s=C[o in OC?t.charAt(r++):o],!s||0>(d=s(e,a,d)))return-1;}else if(o!=a.charCodeAt(d++))return-1}return d}var r=e.dateTime,l=e.date,o=e.time,s=e.periods,f=e.days,c=e.shortDays,u=e.months,p=e.shortMonths,g=rt(s),m=lt(s),h=rt(f),y=lt(f),b=rt(c),_=lt(c),x=rt(u),v=lt(u),k=rt(p),w=lt(p),E={a:function(e){return c[e.getDay()]},A:function(e){return f[e.getDay()]},b:function(e){return p[e.getMonth()]},B:function(e){return u[e.getMonth()]},c:null,d:zt,e:zt,f:Tt,H:Dt,I:Rt,j:$t,L:Ot,m:At,M:Lt,p:function(e){return s[+(12<=e.getHours())]},Q:sn,s:fn,S:Pt,u:Mt,U:Ut,V:jt,w:qt,W:Ft,x:null,X:null,y:It,Y:Nt,Z:Bt,"%":on},S={a:function(e){return c[e.getUTCDay()]},A:function(e){return f[e.getUTCDay()]},b:function(e){return p[e.getUTCMonth()]},B:function(e){return u[e.getUTCMonth()]},c:null,d:Wt,e:Wt,f:Xt,H:Gt,I:Yt,j:Ht,L:Vt,m:Zt,M:Jt,p:function(e){return s[+(12<=e.getUTCHours())]},Q:sn,s:fn,S:Qt,u:Kt,U:en,V:tn,w:nn,W:an,x:null,X:null,y:dn,Y:rn,Z:ln,"%":on},C={a:function(e,t,a){var i=b.exec(t.slice(a));return i?(e.w=_[i[0].toLowerCase()],a+i[0].length):-1},A:function(e,t,a){var i=h.exec(t.slice(a));return i?(e.w=y[i[0].toLowerCase()],a+i[0].length):-1},b:function(e,t,a){var i=k.exec(t.slice(a));return i?(e.m=w[i[0].toLowerCase()],a+i[0].length):-1},B:function(e,t,a){var i=x.exec(t.slice(a));return i?(e.m=v[i[0].toLowerCase()],a+i[0].length):-1},c:function(e,t,n){return a(e,r,t,n)},d:yt,e:yt,f:wt,H:_t,I:_t,j:bt,L:kt,m:ht,M:xt,p:function(e,t,a){var i=g.exec(t.slice(a));return i?(e.p=m[i[0].toLowerCase()],a+i[0].length):-1},Q:St,s:Ct,S:vt,u:st,U:ft,V:ct,w:ot,W:ut,x:function(e,t,n){return a(e,l,t,n)},X:function(e,t,n){return a(e,o,t,n)},y:gt,Y:pt,Z:mt,"%":Et};// These recursive directive definitions must be deferred.
return E.x=t(l,E),E.X=t(o,E),E.c=t(r,E),S.x=t(l,S),S.X=t(o,S),S.c=t(r,S),{format:function(e){var n=t(e+='',E);return n.toString=function(){return e},n},parse:function(e){var t=n(e+='',et);return t.toString=function(){return e},t},utcFormat:function(e){var n=t(e+='',S);return n.toString=function(){return e},n},utcParse:function(e){var t=n(e,tt);return t.toString=function(){return e},t}}}function it(e,t,n){var a=0>e?'-':'',i=(a?-e:e)+'',d=i.length;return a+(d<n?Array(n-d+1).join(t)+i:i)}function dt(e){return e.replace(LC,'\\$&')}function rt(e){return new RegExp('^(?:'+e.map(dt).join('|')+')','i')}function lt(e){for(var t={},a=-1,d=e.length;++a<d;)t[e[a].toLowerCase()]=a;return t}function ot(e,t,a){var i=TC.exec(t.slice(a,a+1));return i?(e.w=+i[0],a+i[0].length):-1}function st(e,t,a){var i=TC.exec(t.slice(a,a+1));return i?(e.u=+i[0],a+i[0].length):-1}function ft(e,t,a){var i=TC.exec(t.slice(a,a+2));return i?(e.U=+i[0],a+i[0].length):-1}function ct(e,t,a){var i=TC.exec(t.slice(a,a+2));return i?(e.V=+i[0],a+i[0].length):-1}function ut(e,t,a){var i=TC.exec(t.slice(a,a+2));return i?(e.W=+i[0],a+i[0].length):-1}function pt(e,t,a){var i=TC.exec(t.slice(a,a+4));return i?(e.y=+i[0],a+i[0].length):-1}function gt(e,t,a){var i=TC.exec(t.slice(a,a+2));return i?(e.y=+i[0]+(68<+i[0]?1900:2e3),a+i[0].length):-1}function mt(e,t,a){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(a,a+6));return i?(e.Z=i[1]?0:-(i[2]+(i[3]||'00')),a+i[0].length):-1}function ht(e,t,a){var i=TC.exec(t.slice(a,a+2));return i?(e.m=i[0]-1,a+i[0].length):-1}function yt(e,t,a){var i=TC.exec(t.slice(a,a+2));return i?(e.d=+i[0],a+i[0].length):-1}function bt(e,t,a){var i=TC.exec(t.slice(a,a+3));return i?(e.m=0,e.d=+i[0],a+i[0].length):-1}function _t(e,t,a){var i=TC.exec(t.slice(a,a+2));return i?(e.H=+i[0],a+i[0].length):-1}function xt(e,t,a){var i=TC.exec(t.slice(a,a+2));return i?(e.M=+i[0],a+i[0].length):-1}function vt(e,t,a){var i=TC.exec(t.slice(a,a+2));return i?(e.S=+i[0],a+i[0].length):-1}function kt(e,t,a){var i=TC.exec(t.slice(a,a+3));return i?(e.L=+i[0],a+i[0].length):-1}function wt(e,t,a){var i=TC.exec(t.slice(a,a+6));return i?(e.L=sS(i[0]/1e3),a+i[0].length):-1}function Et(e,t,a){var i=AC.exec(t.slice(a,a+1));return i?a+i[0].length:-1}function St(e,t,a){var i=TC.exec(t.slice(a));return i?(e.Q=+i[0],a+i[0].length):-1}function Ct(e,t,a){var i=TC.exec(t.slice(a));return i?(e.Q=1e3*+i[0],a+i[0].length):-1}function zt(e,t){return it(e.getDate(),t,2)}function Dt(e,t){return it(e.getHours(),t,2)}function Rt(e,t){return it(e.getHours()%12||12,t,2)}function $t(e,t){return it(1+XS.count(sC(e),e),t,3)}function Ot(e,t){return it(e.getMilliseconds(),t,3)}function Tt(e,t){return Ot(e,t)+'000'}function At(e,t){return it(e.getMonth()+1,t,2)}function Lt(e,t){return it(e.getMinutes(),t,2)}function Pt(e,t){return it(e.getSeconds(),t,2)}function Mt(e){var t=e.getDay();return 0===t?7:t}function Ut(e,t){return it(JS.count(sC(e),e),t,2)}function jt(e,t){var n=e.getDay();return e=4<=n||0===n?tC(e):tC.ceil(e),it(tC.count(sC(e),e)+(4===sC(e).getDay()),t,2)}function qt(e){return e.getDay()}function Ft(e,t){return it(QS.count(sC(e),e),t,2)}function It(e,t){return it(e.getFullYear()%100,t,2)}function Nt(e,t){return it(e.getFullYear()%1e4,t,4)}function Bt(e){var t=e.getTimezoneOffset();return(0<t?'-':(t*=-1,'+'))+it(0|t/60,'0',2)+it(t%60,'0',2)}function Wt(e,t){return it(e.getUTCDate(),t,2)}function Gt(e,t){return it(e.getUTCHours(),t,2)}function Yt(e,t){return it(e.getUTCHours()%12||12,t,2)}function Ht(e,t){return it(1+mC.count(RC(e),e),t,3)}function Vt(e,t){return it(e.getUTCMilliseconds(),t,3)}function Xt(e,t){return Vt(e,t)+'000'}function Zt(e,t){return it(e.getUTCMonth()+1,t,2)}function Jt(e,t){return it(e.getUTCMinutes(),t,2)}function Qt(e,t){return it(e.getUTCSeconds(),t,2)}function Kt(e){var t=e.getUTCDay();return 0===t?7:t}function en(e,t){return it(yC.count(RC(e),e),t,2)}function tn(e,t){var n=e.getUTCDay();return e=4<=n||0===n?vC(e):vC.ceil(e),it(vC.count(RC(e),e)+(4===RC(e).getUTCDay()),t,2)}function nn(e){return e.getUTCDay()}function an(e,t){return it(bC.count(RC(e),e),t,2)}function dn(e,t){return it(e.getUTCFullYear()%100,t,2)}function rn(e,t){return it(e.getUTCFullYear()%1e4,t,4)}function ln(){return'+0000'}function on(){return'%'}function sn(e){return+e}function fn(e){return sS(+e/1e3)}function cn(e){return PC=at(e),MC=PC.format,UC=PC.parse,jC=PC.utcFormat,qC=PC.utcParse,PC}function un(e,t,n){t=t||{};var a=Ze(t.type||'json');return a||u('Unknown data format type: '+t.type),e=a(e,t),t.parse&&pn(e,t.parse,n),e.hasOwnProperty('columns')&&delete e.columns,e}function pn(e,t,a){if(e.length){a=a||UC;var d=e.columns||Object.keys(e[0]),r,o,s,f,c,u,p;for('auto'===t&&(t=l(e,d)),d=Object.keys(t),r=d.map(function(e){var n=t[e],i,d;if(n&&(0===n.indexOf('date:')||0===n.indexOf('utc:')))return i=n.split(/:(.+)?/,2),d=i[1],('\''===d[0]&&'\''===d[d.length-1]||'"'===d[0]&&'"'===d[d.length-1])&&(d=d.slice(1,-1)),'utc'===i[0]?qC(d):a(d);if(!OS[n])throw Error('Illegal format pattern: '+e+':'+n);return OS[n]}),(f=0,u=e.length,p=d.length);f<u;++f)for(o=e[f],c=0;c<p;++c)s=d[c],o[s]=r[c](o[s])}// early exit for empty data
}/**
   * Ingests new data into the dataflow. First parses the data using the
   * vega-loader read method, then pulses a changeset to the target operator.
   * @param {Operator} target - The Operator to target with ingested data,
   *   typically a Collect transform instance.
   * @param {*} data - The input data, prior to parsing. For JSON this may
   *   be a string or an object. For CSV, TSV, etc should be a string.
   * @param {object} format - The data format description for parsing
   *   loaded data. This object is passed to the vega-loader read method.
   * @returns {Dataflow}
   */function gn(e){var t=new Promise(function(t,a){n=function(){t(e)},i=a}),n,i;return t.requests=0,t.done=function(){0==--t.requests&&e.runAfter(function(){e._pending=null;try{e.run(),e._pending?e._pending.then(n):n()}catch(e){i(e)}})},e._pending=t}/**
   * Request data from an external source, parse it, and pulse a changeset
   * to the specified target operator.
   * @param {Operator} target - The Operator to target with the loaded data,
   *   typically a Collect transform instance.
   * @param {string} url - The URL from which to load the data. This string
   *   is passed to the vega-loader load method.
   * @param {object} [format] - The data format description for parsing
   *   loaded data. This object is passed to the vega-loader read method.
   * @return {Promise} A Promise that resolves upon completion of the request.
   *   Resolves to a status code: 0 success, -1 load fail, -2 parse fail.
   *//**
   * Perform operator updates in response to events. Applies an
   * update function to compute a new operator value. If the update function
   * returns a {@link ChangeSet}, the operator will be pulsed with those tuple
   * changes. Otherwise, the operator value will be updated to the return value.
   * @param {EventStream|Operator} source - The event source to react to.
   *   This argument can be either an EventStream or an Operator.
   * @param {Operator|function(object):Operator} target - The operator to update.
   *   This argument can either be an Operator instance or (if the source
   *   argument is an EventStream), a function that accepts an event object as
   *   input and returns an Operator to target.
   * @param {function(Parameters,Event): *} [update] - Optional update function
   *   to compute the new operator value, or a literal value to set. Update
   *   functions expect to receive a parameter object and event as arguments.
   *   This function can either return a new operator value or (if the source
   *   argument is an EventStream) a {@link ChangeSet} instance to pulse
   *   the target operator with tuple changes.
   * @param {object} [params] - The update function parameters.
   * @param {object} [options] - Additional options hash. If not overridden,
   *   updated operators will be skipped by default.
   * @param {boolean} [options.skip] - If true, the operator will
   *  be skipped: it will not be evaluated, but its dependents will be.
   * @param {boolean} [options.force] - If true, the operator will
   *   be re-evaluated even if its value has not changed.
   * @return {Dataflow}
   */function mn(n,e,a,i,d,r){var l=F({},r,NC),o,s;M(a)||(a=j(a)),i===void 0?o=function(t){n.touch(a(t))}:M(i)?(s=new be(null,i,d,!1),o=function(i){var e=a(i),t;s.evaluate(i),me(t=s.value)?n.pulse(e,t,r):n.update(e,t,l)}):o=function(t){n.update(a(t),i,l)},e.apply(o)}function hn(e,t,n,a,i,d){var r,l;a===void 0?l=n:(r=M(a)?a:j(a),a=n?function(e,t){var a=r(e,t);return n.skip()||(n.skip(a!==this.value).value=a),a}:r,l=new be(null,a,i,!1),l.modified(d&&d.force),l.rank=0,n&&(l.skip(!0),l.value=n.value,l.targets().add(n))),t.targets().add(l)}/**
   * Assigns a rank to an operator. Ranks are assigned in increasing order
   * by incrementing an internal rank counter.
   * @param {Operator} op - The operator to assign a rank.
   *//**
   * Re-ranks an operator and all downstream target dependencies. This
   * is necessary when upstream depencies of higher rank are added to
   * a target operator.
   * @param {Operator} op - The operator to re-rank.
   *//**
   * A Pulse enables inter-operator communication during a run of the
   * dataflow graph. In addition to the current timestamp, a pulse may also
   * contain a change-set of added, removed or modified data tuples, as well as
   * a pointer to a full backing data source. Tuple change sets may not
   * be fully materialized; for example, to prevent needless array creation
   * a change set may include larger arrays and corresponding filter functions.
   * The pulse provides a {@link visit} method to enable proper and efficient
   * iteration over requested data tuples.
   *
   * In addition, each pulse can track modification flags for data tuple fields.
   * Responsible transform operators should call the {@link modifies} method to
   * indicate changes to data fields. The {@link modified} method enables
   * querying of this modification state.
   *
   * @constructor
   * @param {Dataflow} dataflow - The backing dataflow instance.
   * @param {number} stamp - The current propagation timestamp.
   * @param {string} [encode] - An optional encoding set name, which is then
   *   accessible as Pulse.encode. Operators can respond to (or ignore) this
   *   setting as appropriate. This parameter can be used in conjunction with
   *   the Encode transform in the vega-encode module.
   *//**
   * Sentinel value indicating pulse propagation should stop.
   */function yn(e,t,n){this.dataflow=e,this.stamp=null==t?-1:t,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function bn(e,n){return e?function(a,t){return e(a,t)&&n(a,t)}:n}/**
   * Materialize one or more tuple sets in this pulse. If the tuple set(s) have
   * a registered filter function, it will be applied and the tuple set(s) will
   * be replaced with materialized tuple arrays.
   * @param {number} flags - Flags indicating the tuple set(s) to materialize.
   * @return {Pulse} - Returns this pulse instance.
   */function _n(e,t){var n=[];return de(e,t,function(e){n.push(e)}),n}function xn(e,t){var n={};return e.visit(t,function(e){n[se(e)]=1}),function(e){return n[se(e)]?null:e}}/**
   * Visit one or more tuple sets in this pulse.
   * @param {number} flags - Flags indicating the tuple set(s) to visit.
   *   Legal values are ADD, REM, MOD and SOURCE (if a backing data source
   *   has been set).
   * @param {function(object):*} - Visitor function invoked per-tuple.
   * @return {Pulse} - Returns this pulse instance.
   *//**
   * Represents a set of multiple pulses. Used as input for operators
   * that accept multiple pulses at a time. Contained pulses are
   * accessible via the public "pulses" array property. This pulse doe
   * not carry added, removed or modified tuples directly. However,
   * the visit method can be used to traverse all such tuples contained
   * in sub-pulses with a timestamp matching this parent multi-pulse.
   * @constructor
   * @param {Dataflow} dataflow - The backing dataflow instance.
   * @param {number} stamp - The timestamp.
   * @param {Array<Pulse>} pulses - The sub-pulses for this multi-pulse.
   */function vn(e,t,a,d){var r=this,l=0,o,s,u,p,g;for(this.dataflow=e,this.stamp=t,this.fields=null,this.encode=d||null,this.pulses=a,(u=0,p=a.length);u<p;++u)if(o=a[u],o.stamp===t){if(o.fields)for(g in s=r.fields||(r.fields={}),o.fields)s[g]=1;o.changed(r.ADD)&&(l|=r.ADD),o.changed(r.REM)&&(l|=r.REM),o.changed(r.MOD)&&(l|=r.MOD)}this.changes=l}/**
   * Runs the dataflow. This method will increment the current timestamp
   * and process all updated, pulsed and touched operators. When run for
   * the first time, all registered operators will be processed. If there
   * are pending data loading operations, this method will return immediately
   * without evaluating the dataflow. Instead, the dataflow will be
   * asynchronously invoked when data loading completes. To track when dataflow
   * evaluation completes, use the {@link runAsync} method instead.
   * @param {string} [encode] - The name of an encoding set to invoke during
   *   propagation. This value is added to generated Pulse instances;
   *   operators can then respond to (or ignore) this setting as appropriate.
   *   This parameter can be used in conjunction with the Encode transform in
   *   the vega-encode module.
   */function kn(e,t){try{t(e)}catch(t){e.error(t)}}/**
   * Runs the dataflow and returns a Promise that resolves when the
   * propagation cycle completes. The standard run method may exit early
   * if there are pending data loading operations. In contrast, this
   * method returns a Promise to allow callers to receive notification
   * when dataflow evaluation completes.
   * @return {Promise} - A promise that resolves to this dataflow.
   *//**
   * Schedules a callback function to be invoked after the current pulse
   * propagation completes. If no propagation is currently occurring,
   * the function is invoked immediately.
   * @param {function(Dataflow)} callback - The callback function to run.
   *   The callback will be invoked with this Dataflow instance as its
   *   sole argument.
   * @param {boolean} enqueue - A boolean flag indicating that the
   *   callback should be queued up to run after the next propagation
   *   cycle, suppressing immediate invocation when propagation is not
   *   currently occurring.
   *//**
   * Enqueue an operator into the priority queue for evaluation. The operator
   * will be enqueued if it has no registered pulse for the current cycle, or if
   * the force argument is true. Upon enqueue, this method also sets the
   * operator's qrank to the current rank value.
   * @param {Operator} op - The operator to enqueue.
   * @param {boolean} [force] - A flag indicating if the operator should be
   *   forceably added to the queue, even if it has already been previously
   *   enqueued during the current pulse propagation. This is useful when the
   *   dataflow graph is dynamically modified and the operator rank changes.
   *//**
   * Provide a correct pulse for evaluating an operator. If the operator has an
   * explicit source operator, we will try to pull the pulse(s) from it.
   * If there is an array of source operators, we build a multi-pulse.
   * Otherwise, we return a current pulse with correct source data.
   * If the pulse is the pulse map has an explicit target set, we use that.
   * Else if the pulse on the upstream source operator is current, we use that.
   * Else we use the pulse from the pulse map, but copy the source tuple array.
   * @param {Operator} op - The operator for which to get an input pulse.
   * @param {string} [encode] - An (optional) encoding set name with which to
   *   annotate the returned pulse. See {@link run} for more information.
   *//**
   * Touches an operator, scheduling it to be evaluated. If invoked outside of
   * a pulse propagation, the operator will be evaluated the next time this
   * dataflow is run. If invoked in the midst of pulse propagation, the operator
   * will be queued for evaluation if and only if the operator has not yet been
   * evaluated on the current propagation timestamp.
   * @param {Operator} op - The operator to touch.
   * @param {object} [options] - Additional options hash.
   * @param {boolean} [options.skip] - If true, the operator will
   *   be skipped: it will not be evaluated, but its dependents will be.
   * @return {Dataflow}
   *//**
   * Updates the value of the given operator.
   * @param {Operator} op - The operator to update.
   * @param {*} value - The value to set.
   * @param {object} [options] - Additional options hash.
   * @param {boolean} [options.force] - If true, the operator will
   *   be re-evaluated even if its value has not changed.
   * @param {boolean} [options.skip] - If true, the operator will
   *   be skipped: it will not be evaluated, but its dependents will be.
   * @return {Dataflow}
   *//**
   * Pulses an operator with a changeset of tuples. If invoked outside of
   * a pulse propagation, the pulse will be applied the next time this
   * dataflow is run. If invoked in the midst of pulse propagation, the pulse
   * will be added to the set of active pulses and will be applied if and
   * only if the target operator has not yet been evaluated on the current
   * propagation timestamp.
   * @param {Operator} op - The operator to pulse.
   * @param {ChangeSet} value - The tuple changeset to apply.
   * @param {object} [options] - Additional options hash.
   * @param {boolean} [options.skip] - If true, the operator will
   *   be skipped: it will not be evaluated, but its dependents will be.
   * @return {Dataflow}
   */function wn(e){this.cmp=e,this.nodes=[]}function En(e,t,n,a){var i,d,r;for(i=e[n];n>t;){if(r=n-1>>1,d=e[r],0>a(i,d)){e[n]=d,n=r;continue}break}return e[n]=i}function Sn(e,t,n){for(var a=t,i=e.length,d=e[t],r=2*t+1,l;r<i;)l=r+1,l<i&&0<=n(e[r],e[l])&&(r=l),e[t]=e[r],t=r,r=2*t+1;return e[t]=d,En(e,a,t,n)}/**
   * A dataflow graph for reactive processing of data streams.
   * @constructor
   */function Cn(){this._log=a(),this.logLevel(1),this._clock=0,this._rank=0;try{this._loader=ke()}catch(t){// do nothing if loader module is unavailable
}this._touched=le(bS),this._pulses={},this._pulse=null,this._heap=new wn(function(e,t){return e.qrank-t.qrank}),this._postrun=[]}// LOGGING AND ERROR HANDLING
function zn(e){return function(){return this._log[e].apply(this,arguments)}}/**
   * Logs an error message. By default, logged messages are written to console
   * output. The message will only be logged if the current log level is high
   * enough to permit error messages.
   *//**
   * Abstract class for operators that process data tuples.
   * Subclasses must provide a {@link transform} method for operator processing.
   * @constructor
   * @param {*} [init] - The initial value for this operator.
   * @param {object} [params] - The parameters for this operator.
   * @param {Operator} [source] - The operator from which to receive pulses.
   */function Dn(e,t){be.call(this,e,null,t)}function Rn(e){var n=$n(e);return n&&n.Definition||null}function $n(e){return e=e&&e.toLowerCase(),ZC.hasOwnProperty(e)?ZC[e]:null}// Utilities
function On(e){return function(t){for(var a=e.length,n=1,d=e[0](t)+'';n<a;++n)d+='|'+e[n](t);return d}}function Tn(e){return e&&e.length?1===e.length?e[0]:On(e):function(){return''}}function An(e,t,n){return n||e+(t?'_'+t:'')}function Ln(e,t){return JC[e](t)}function Pn(e){return function(t){var n=F({init:'',add:'',rem:'',idx:0},e);return n.out=t||e.name,n}}function Mn(e,t){return e.idx-t.idx}function Un(e,t){function n(e,i){function a(t){e[t]||n(e,e[t]=JC[t]())}return i.req&&i.req.forEach(a),t&&i.str&&i.str.forEach(a),e}var a=e.reduce(n,e.reduce(function(e,t){return e[t.name]=t,e},{})),i=[],d;for(d in a)i.push(a[d]);return i.sort(Mn)}function jn(e,t){var n=Un(e,!0),// assume streaming removes may occur
i='var cell = this.cell; this.valid = 0; this.missing = 0;',d='this.cell = cell; this.init();',r='if(v==null){++this.missing; return;} if(v!==v) return; ++this.valid;',l='if(v==null){--this.missing; return;} if(v!==v) return; --this.valid;',o='var cell = this.cell;';return n.forEach(function(e){i+=e.init,r+=e.add,l+=e.rem}),e.slice().sort(Mn).forEach(function(e){o+='t[\''+e.out+'\']='+e.set+';'}),o+='return t;',d=Function('cell',d),d.prototype.init=Function(i),d.prototype.add=Function('v','t',r),d.prototype.rem=Function('v','t',l),d.prototype.set=Function('t',o),d.prototype.get=t||id,d.fields=e.map(function(e){return e.out}),d}function qn(e){// determine range
var t=e.maxbins||20,a=e.base||10,d=gS(a),r=e.divide||[5,2],l=e.extent[0],o=e.extent[1],s=o-l,f,c,u,p,g,m,h,y;if(e.step)f=e.step;else if(e.steps){for(g=s/t,m=0,h=e.steps.length;m<h&&e.steps[m]<g;++m);f=e.steps[fS(0,m-1)]}else{// increase step size if too many bins
for(c=cS(gS(t)/d),u=e.minstep||0,f=fS(u,pS(a,oS(gS(s)/d)-c));cS(s/f)>t;)f*=a;// decrease step size if allowed
for(m=0,h=r.length;m<h;++m)g=f/r[m],g>=u&&s/g<=t&&(f=g)}// update precision, min and max
return g=gS(f),p=0<=g?0:~~(-g/d)+1,y=pS(a,-p-1),(e.nice||void 0===e.nice)&&(g=sS(l/f+y)*f,l=l<g?g-f:g,o=cS(o/f)*f),{start:l,stop:o,step:f}}function Fn(e,t){var d=[],r=e.length,n=-1,l;if(null==t)for(;++n<r;)isNaN(l=In(e[n]))||d.push(l);else for(;++n<r;)isNaN(l=In(t(e[n],n,e)))||d.push(l);return d}function In(e){return null===e?NaN:+e}function Nn(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Bn(e){return 1===e.length&&(e=Wn(e)),{left:function(t,n,a,i){for(null==a&&(a=0),null==i&&(i=t.length);a<i;){var d=a+i>>>1;0>e(t[d],n)?a=d+1:i=d}return a},right:function(t,n,a,i){for(null==a&&(a=0),null==i&&(i=t.length);a<i;){var d=a+i>>>1;0<e(t[d],n)?i=d:a=d+1}return a}}}function Wn(e){return function(t,n){return Nn(e(t),n)}}function Gn(e,t){let n=0,a=0,i=0,d;if(t===void 0)for(let t of e)null!=t&&(t=+t)>=t&&(d=t-a,a+=d/++n,i+=d*(t-a));else{let r=-1;for(let l of e)null!=(l=t(l,++r,e))&&(l=+l)>=l&&(d=l-a,a+=d/++n,i+=d*(l-a))}return 1<n?i/(n-1):void 0}function Yn(e,t){let n,a;if(t===void 0)for(let t of e)null!=t&&t>=t&&(void 0===n?n=a=t:(n>t&&(n=t),a<t&&(a=t)));else{let i=-1;for(let d of e)null!=(d=t(d,++i,e))&&d>=d&&(void 0===n?n=a=d:(n>d&&(n=d),a<d&&(a=d)))}return[n,a]}function Hn(e,t,a){e=+e,t=+t,a=2>(r=arguments.length)?(t=e,e=0,1):3>r?1:+a;for(var d=-1,r=0|fS(0,cS((t-e)/a)),l=Array(r);++d<r;)l[d]=e+d*a;return l}function Vn(e,t,n){var a=lS(t-e)/fS(0,n),i=pS(10,sS(gS(a)/rS)),d=a/i;return d>=nz?i*=10:d>=az?i*=5:d>=iz&&(i*=2),t<e?-i:i}function Jn(e){return null===e?NaN:+e}function Qn(e,t,a=Jn){if(o=e.length){if(0>=(t=+t)||2>o)return+a(e[0],0,e);if(1<=t)return+a(e[o-1],o-1,e);var d=(o-1)*t,i=sS(d),r=+a(e[i],i,e),l=+a(e[i+1],i+1,e),o;return r+(l-r)*(d-i)}}function Kn(e,t){let n;if(t===void 0)for(let t of e)null!=t&&t>=t&&(void 0===n||n<t)&&(n=t);else{let a=-1;for(let i of e)null!=(i=t(i,++a,e))&&i>=i&&(void 0===n||n<i)&&(n=i)}return n}function ea(e,t){let n=0,a=0;if(t===void 0)for(let t of e)null!=t&&(t=+t)>=t&&(++n,a+=t);else{let i=-1;for(let d of e)null!=(d=t(d,++i,e))&&(d=+d)>=d&&(++n,a+=d)}return n?a/n:void 0}// Based on https://github.com/mourner/quickselect
// ISC license, Copyright 2018 Vladimir Agafonkin.
function ta(e,a,d=0,r=e.length-1,l=Nn){for(;r>d;){if(600<r-d){const t=r-d+1,n=a-d+1,i=gS(t),o=.5*mS(2*i/3),s=.5*dS(i*o*(t-o)/t)*(0>n-t/2?-1:1),f=fS(d,sS(a-n*o/t+s)),c=iS(r,sS(a+(t-n)*o/t+s));ta(e,a,f,c,l)}const n=e[a];let t=d,i=r;for(na(e,d,a),0<l(e[r],n)&&na(e,d,r);t<i;){for(na(e,t,i),++t,--i;0>l(e[t],n);)++t;for(;0<l(e[i],n);)--i}0===l(e[d],n)?na(e,d,i):(++i,na(e,i,r)),i<=a&&(d=i+1),a<=i&&(r=i-1)}return e}function na(e,n,a){const i=e[n];e[n]=e[a],e[a]=i}function*aa(e,t){if(t===void 0)for(let t of e)null!=t&&(t=+t)>=t&&(yield t);else{let n=-1;for(let a of e)null!=(a=t(a,++n,e))&&(a=+a)>=a&&(yield a)}}function ia(e,t){if(e=Float64Array.from(aa(e,t)),!!e.length){const t=e.length,n=t>>1;return ta(e,n-1,0),0==(1&t)&&ta(e,n,n),Qn(e,.5)}}function da(e,t){let n;if(t===void 0)for(let t of e)null!=t&&t>=t&&(void 0===n||n>t)&&(n=t);else{let a=-1;for(let i of e)null!=(i=t(i,++a,e))&&i>=i&&(void 0===n||n>i)&&(n=i)}return n}function ra(e,t){for(var n=t.length,a=Array(n);n--;)a[n]=e[t[n]];return a}function la(e,t){let n=0;if(t===void 0)for(let t of e)(t=+t)&&(n+=t);else{let a=-1;for(let i of e)(i=+t(i,++a,e))&&(n+=i)}return n}function oa(t,d,r,l){if(!t.length)return[void 0,void 0];var o=Fn(t,l),s=o.length,n=d,f,c,u,p;for(u=0,p=Array(n);u<n;++u){for(f=0,c=0;c<s;++c)f+=o[~~(e.random()*s)];p[u]=f/s}return[Qn(p.sort(Nn),r/2),Qn(p,1-r/2)]}function sa(e,t){var n=Fn(e,t);return[Qn(n.sort(Nn),.25),Qn(n,.5),Qn(n,.75)]}function fa(t,n){var a=NaN,i={},d,r;return i.mean=function(e){return arguments.length?(d=e||0,a=NaN,i):d},i.stdev=function(e){return arguments.length?(r=null==e?1:e,a=NaN,i):r},i.sample=function(){var t=0,n=0,i,l;if(a==a)return t=a,a=NaN,t;do t=2*e.random()-1,n=2*e.random()-1,i=t*t+n*n;while(0===i||1<i);return l=dS(-2*gS(i)/i),a=d+n*l*r,d+t*l*r},i.pdf=function(e){var t=mS(pS(e-d,2)/(-2*pS(r,2)));return 1/(r*dS(2*aS))*t},i.cdf=function(e){var t=(e-d)/r,n=lS(t),a;if(37<n)a=0;else{var i=mS(-n*n/2),l;7.07106781186547>n?(l=.0352624965998911*n+.700383064443688,l=l*n+6.37396220353165,l=l*n+33.912866078383,l=l*n+112.079291497871,l=l*n+221.213596169931,l=l*n+220.206867912376,a=i*l,l=.0883883476483184*n+1.75566716318264,l=l*n+16.064177579207,l=l*n+86.7807322029461,l=l*n+296.564248779674,l=l*n+637.333633378831,l=l*n+793.826512519948,l=l*n+440.413735824752,a/=l):(l=n+.65,l=n+4/l,l=n+3/l,l=n+2/l,l=n+1/l,a=i/l/2.506628274631)}return 0<t?1-a:a},i.icdf=function(e){if(0>=e||1<=e)return NaN;var t=2*e-1,n=8*(aS-3)/(3*aS*(4-aS)),i=2/(aS*n)+gS(1-pS(t,2))/2,a=gS(1-t*t)/n,l=(0<t?1:-1)*dS(dS(i*i-a)-i);return d+r*nS*l},i.mean(t).stdev(n)}// TODO: support for additional kernels?
function ca(t,a){var d=fa(),r={},l=0;return r.data=function(e){return arguments.length?(t=e,l=e?e.length:0,r.bandwidth(a)):t},r.bandwidth=function(e){return arguments.length?(a=e,!a&&t&&(a=ua(t)),r):a},r.sample=function(){return t[~~(e.random()*l)]+a*d.sample()},r.pdf=function(e){for(var n=0,r=0;r<l;++r)n+=d.pdf((e-t[r])/a);return n/a/l},r.cdf=function(e){for(var n=0,r=0;r<l;++r)n+=d.cdf((e-t[r])/a);return n/l},r.icdf=function(){throw Error('KDE icdf not supported.')},r.data(t)}// Scott, D. W. (1992) Multivariate Density Estimation:
// Theory, Practice, and Visualization. Wiley.
function ua(e){var t=e.length,n=sa(e),a=(n[2]-n[0])/1.34;return 1.06*iS(dS(Gn(e)),a)*pS(t,-.2)}function pa(t,n){function a(e){var t=[],n=0,a;for(a=0;a<d;++a)n+=t[a]=null==e[a]?1:+e[a];for(a=0;a<d;++a)t[a]/=n;return t}var i={},d=0,l;return i.weights=function(e){return arguments.length?(l=a(n=e||[]),i):n},i.distributions=function(e){return arguments.length?(e?(d=e.length,t=e):(d=0,t=[]),i.weights(n)):t},i.sample=function(){// first select distribution
for(var n=e.random(),a=t[d-1],r=l[0],o=0;o<d-1;r+=l[++o])if(n<r){a=t[o];break}// then sample from it
return a.sample()},i.pdf=function(e){for(var n=0,a=0;a<d;++a)n+=l[a]*t[a].pdf(e);return n},i.cdf=function(e){for(var n=0,a=0;a<d;++a)n+=l[a]*t[a].cdf(e);return n},i.icdf=function(){throw Error('Mixture icdf not supported.')},i.distributions(t).weights(n)}function ga(t,n){null==n&&(n=null==t?1:t,t=0);var i={},r,l,o;return i.min=function(e){return arguments.length?(r=e||0,o=l-r,i):r},i.max=function(e){return arguments.length?(l=e||0,o=l-r,i):l},i.sample=function(){return r+o*e.random()},i.pdf=function(e){return e>=r&&e<=l?1/o:0},i.cdf=function(e){return e<r?0:e>l?1:(e-r)/o},i.icdf=function(e){return 0<=e&&1>=e?r+e*o:NaN},i.min(t).max(n)}function ma(e){this._key=e?t(e):se,this.reset()}/**
   * Group-by aggregation operator.
   * @constructor
   * @param {object} params - The parameters for this operator.
   * @param {Array<function(object): *>} [params.groupby] - An array of accessors to groupby.
   * @param {Array<function(object): *>} [params.fields] - An array of accessors to aggregate.
   * @param {Array<string>} [params.ops] - An array of strings indicating aggregation operations.
   * @param {Array<string>} [params.as] - An array of output field names for aggregated values.
   * @param {boolean} [params.cross=false] - A flag indicating that the full
   *   cross-product of groupby values should be generated, including empty cells.
   *   If true, the drop parameter is ignored and empty cells are retained.
   * @param {boolean} [params.drop=true] - A flag indicating if empty cells should be removed.
   */function ha(e){// array of added output tuples
// array of modified output tuples
// number of active added tuples
// number of active modified tuples
// should empty aggregation cells be removed
// produce full cross-product of group-by values
// group-by dimension accessors
// group-by dimension names
// collection of aggregation monoids
// flag indicating only count aggregation
// collection of count fields
// previous aggregation cells
// array of dependent input tuple field names
Dn.call(this,null,e),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}/**
   * Generates a binning function for discretizing data.
   * @constructor
   * @param {object} params - The parameters for this operator. The
   *   provided values should be valid options for the {@link bin} function.
   * @param {function(object): *} params.field - The data field to bin.
   */function ya(e){Dn.call(this,null,e)}function ba(e,t,n){var a=e,i=t||[],d=n||[],r={},l=0;return{add:function(e){d.push(e)},remove:function(e){r[a(e)]=++l},size:function(){return i.length},data:function(e,t){return l&&(i=i.filter(function(e){return!r[a(e)]}),r={},l=0),t&&e&&i.sort(e),d.length&&(i=e?Z(e,i,d.sort(e)):i.concat(d),d=[]),i}}}/**
   * Collects all data tuples that pass through this operator.
   * @constructor
   * @param {object} params - The parameters for this operator.
   * @param {function(*,*): number} [params.sort] - An optional
   *   comparator function for additionally sorting the collected tuples.
   */function _a(e){Dn.call(this,[],e)}/**
   * Generates a comparator function.
   * @constructor
   * @param {object} params - The parameters for this operator.
   * @param {Array<string>} params.fields - The fields to compare.
   * @param {Array<string>} [params.orders] - The sort orders.
   *   Each entry should be one of "ascending" (default) or "descending".
   */function xa(e){be.call(this,null,va,e)}function va(e){return this.value&&!e.modified()?this.value:U(e.fields,e.orders)}/**
   * Count regexp-defined pattern occurrences in a text field.
   * @constructor
   * @param {object} params - The parameters for this operator.
   * @param {function(object): *} params.field - An accessor for the text field.
   * @param {string} [params.pattern] - RegExp string defining the text pattern.
   * @param {string} [params.case] - One of 'lower', 'upper' or null (mixed) case.
   * @param {string} [params.stopwords] - RegExp string of words to ignore.
   */function ka(e){Dn.call(this,null,e)}function wa(e,t,n){return'upper'===t?e=e.toUpperCase():'lower'===t?e=e.toLowerCase():void 0,e.match(n)}/**
   * Perform a cross-product of a tuple stream with itself.
   * @constructor
   * @param {object} params - The parameters for this operator.
   * @param {function(object):boolean} [params.filter] - An optional filter
   *   function for selectively including tuples in the cross product.
   * @param {Array<string>} [params.as] - The names of the output fields.
   */function Ea(e){Dn.call(this,null,e)}function Sa(e,d,a,r){for(var l=[],o={},s=e.length,n=0,f,c;n<s;++n)for(o[d]=c=e[n],f=0;f<s;++f)o[a]=e[f],r(o)&&(l.push(ce(o)),o={},o[d]=c);return l}/**
   * Parse a parameter object for a probability distribution.
   * @param {object} def - The distribution parameter object.
   * @param {function():Array<object>} - A method for requesting
   *   source data. Used for distributions (such as KDE) that
   *   require sample data points. This method will only be
   *   invoked if the 'from' parameter for a target data source
   *   is not provided. Typically this method returns backing
   *   source data for a Pulse object.
   * @return {object} - The output distribution object.
   */function Ca(e,t){var n=e['function'];cz.hasOwnProperty(n)||u('Unknown distribution function: '+n);var a=cz[n]();for(var i in e)// if data field, extract values
'field'===i?a.data((e.from||t()).map(e[i])):'distributions'===i?a[i](e[i].map(function(e){return Ca(e,t)})):'function'===typeof a[i]&&a[i](e[i]);return a}/**
   * Grid sample points for a probability density. Given a distribution and
   * a sampling extent, will generate points suitable for plotting either
   * PDF (probability density function) or CDF (cumulative distribution
   * function) curves.
   * @constructor
   * @param {object} params - The parameters for this operator.
   * @param {object} params.distribution - The probability distribution. This
   *   is an object parameter dependent on the distribution type.
   * @param {string} [params.method='pdf'] - The distribution method to sample.
   *   One of 'pdf' or 'cdf'.
   * @param {Array<number>} [params.extent] - The [min, max] extent over which
   *   to sample the distribution. This argument is required in most cases, but
   *   can be omitted if the distribution (e.g., 'kde') supports a 'data' method
   *   that returns numerical sample points from which the extent can be deduced.
   * @param {number} [params.steps=100] - The number of sampling steps.
   */function za(e){Dn.call(this,null,e)}function Da(e){return function(){return e.materialize(e.SOURCE).source}}/**
   * Wraps an expression function with access to external parameters.
   * @constructor
   * @param {object} params - The parameters for this operator.
   * @param {function} params.expr - The expression function. The
   *  function should accept both a datum and a parameter object.
   *  This operator's value will be a new function that wraps the
   *  expression function with access to this operator's parameters.
   */function Ra(e){be.call(this,null,$a,e),this.modified(!0)}function $a(e){var t=e.expr;return this.value&&!e.modified('expr')?this.value:r(function(n){return t(n,e)},s(t),o(t))}/**
   * Computes extents (min/max) for a data field.
   * @constructor
   * @param {object} params - The parameters for this operator.
   * @param {function(object): *} params.field - The field over which to compute extends.
   */function Oa(e){Dn.call(this,[void 0,void 0],e)}/**
   * Provides a bridge between a parent transform and a target subflow that
   * consumes only a subset of the tuples that pass through the parent.
   * @constructor
   * @param {Pulse} pulse - A pulse to use as the value of this operator.
   * @param {Transform} parent - The parent transform (typically a Facet instance).
   * @param {Transform} target - A transform that receives the subflow of tuples.
   */function Ta(e,t){be.call(this,e),this.parent=t}/**
   * Facets a dataflow into a set of subflows based on a key.
   * @constructor
   * @param {object} params - The parameters for this operator.
   * @param {function(Dataflow, string): Operator} params.subflow - A function
   *   that generates a subflow of operators and returns its root operator.
   * @param {function(object): *} params.key - The key field to facet by.
   */function Aa(e){Dn.call(this,{},e),this._keys=N();// cache previously calculated key values
// keep track of active subflows, use as targets array for listeners
// this allows us to limit propagation to only updated subflows
var t=this._targets=[];t.active=0,t.forEach=function(e){for(var a=0,d=t.active;a<d;++a)e(t[a],a,t)}}/**
   * Generates one or more field accessor functions.
   * If the 'name' parameter is an array, an array of field accessors
   * will be created and the 'as' parameter will be ignored.
   * @constructor
   * @param {object} params - The parameters for this operator.
   * @param {string} params.name - The field name(s) to access.
   * @param {string} params.as - The accessor function name.
   */function La(e){be.call(this,null,Pa,e)}function Pa(e){return this.value&&!e.modified()?this.value:hS(e.name)?P(e.name).map(function(e){return t(e)}):t(e.name,e.as)}/**
   * Filters data tuples according to a predicate function.
   * @constructor
   * @param {object} params - The parameters for this operator.
   * @param {function(object): *} params.expr - The predicate expression function
   *   that determines a tuple's filter status. Truthy values pass the filter.
   */function Ma(e){Dn.call(this,N(),e)}// use either provided alias or accessor field name
function Ua(e,t){return e?e.map(function(e,n){return t[n]||o(e)}):null}/**
   * Flattens array-typed field values into new data objects.
   * If multiple fields are specified, they are treated as parallel arrays,
   * with output values included for each matching index (or null if missing).
   * @constructor
   * @param {object} params - The parameters for this operator.
   * @param {Array<function(object): *>} params.fields - An array of field
   *   accessors for the tuple fields that should be flattened.
   * @param {Array<string>} [params.as] - Output field names for flattened
   *   array fields. Any unspecified fields will use the field name provided
   *   by the fields accessors.
   */function ja(e){Dn.call(this,[],e)}/**
   * Folds one more tuple fields into multiple tuples in which the field
   * name and values are available under new 'key' and 'value' fields.
   * @constructor
   * @param {object} params - The parameters for this operator.
   * @param {function(object): *} params.fields - An array of field accessors
   *   for the tuple fields that should be folded.
   * @param {Array<string>} [params.as] - Output field names for folded key
   *   and value fields, defaults to ['key', 'value'].
   */function qa(e){Dn.call(this,[],e)}/**
   * Invokes a function for each data tuple and saves the results as a new field.
   * @constructor
   * @param {object} params - The parameters for this operator.
   * @param {function(object): *} params.expr - The formula function to invoke for each tuple.
   * @param {string} params.as - The field name under which to save the result.
   * @param {boolean} [params.initonly=false] - If true, the formula is applied to
   *   added tuples only, and does not update in response to modifications.
   */function Fa(e){Dn.call(this,null,e)}/**
   * Generates data tuples using a provided generator function.
   * @constructor
   * @param {object} params - The parameters for this operator.
   * @param {function(Parameters): object} params.generator - A tuple generator
   *   function. This function is given the operator parameters as input.
   *   Changes to any additional parameters will not trigger re-calculation
   *   of previously generated tuples. Only future tuples are affected.
   * @param {number} params.size - The number of tuples to produce.
   */function Ia(e){Dn.call(this,[],e)}/**
   * Impute missing values.
   * @constructor
   * @param {object} params - The parameters for this operator.
   * @param {function(object): *} params.field - The value field to impute.
   * @param {Array<function(object): *>} [params.groupby] - An array of
   *   accessors to determine series within which to perform imputation.
   * @param {function(object): *} params.key - An accessor for a key value.
   *   Each key value should be unique within a group. New tuples will be
   *   imputed for any key values that are not found within a group.
   * @param {Array<*>} [params.keyvals] - Optional array of required key
   *   values. New tuples will be imputed for any key values that are not
   *   found within a group. In addition, these values will be automatically
   *   augmented with the key values observed in the input data.
   * @param {string} [method='value'] - The imputation method to use. One of
   *   'value', 'mean', 'median', 'max', 'min'.
   * @param {*} [value=0] - The constant value to use for imputation
   *   when using method 'value'.
   */function Na(e){Dn.call(this,[],e)}function Ba(e){var t=e.method||kz.value,n;return null==kz[t]?void u('Unrecognized imputation method: '+t):t===kz.value?(n=void 0===e.value?0:e.value,function(){return n}):kz[t]}function Wa(e){var n=e.field;return function(e){return e?n(e):NaN}}function Ga(e,a,d,r){var l=function(e){return e(_)},o=[],s=r?r.slice():[],f={},c={},u,p,g,m,h,y,b,_;for(s.forEach(function(e,t){f[e]=t+1}),m=0,b=e.length;m<b;++m)_=e[m],y=d(_),h=f[y]||(f[y]=s.push(y)),p=(u=a?a.map(l):wz)+'',(g=c[p])||(g=c[p]=[],o.push(g),g.values=u),g[h-1]=_;return o.domain=s,o}/**
   * Extend input tuples with aggregate values.
   * Calcuates aggregate values and joins them with the input stream.
   * @constructor
   */function Ya(e){ha.call(this,e)}/**
   * Generates a key function.
   * @constructor
   * @param {object} params - The parameters for this operator.
   * @param {Array<string>} params.fields - The field name(s) for the key function.
   * @param {boolean} params.flat - A boolean flag indicating if the field names
   *  should be treated as flat property names, side-stepping nested field
   *  lookups normally indicated by dot or bracket notation.
   */function Ha(e){be.call(this,null,Va,e)}function Va(e){return this.value&&!e.modified()?this.value:X(e.fields,e.flat)}/**
   * Load and parse data from an external source. Marshalls parameter
   * values and then invokes the Dataflow request method.
   * @constructor
   * @param {object} params - The parameters for this operator.
   * @param {string} params.url - The URL to load from.
   * @param {object} params.format - The data format options.
   */function Xa(e){Dn.call(this,null,e)}/**
   * Extend tuples by joining them with values from a lookup table.
   * @constructor
   * @param {object} params - The parameters for this operator.
   * @param {Map} params.index - The lookup table map.
   * @param {Array<function(object): *} params.fields - The fields to lookup.
   * @param {Array<string>} params.as - Output field names for each lookup value.
   * @param {*} [params.default] - A default value to use if lookup fails.
   */function Za(e){Dn.call(this,{},e)}/**
   * Computes global min/max extents over a collection of extents.
   * @constructor
   * @param {object} params - The parameters for this operator.
   * @param {Array<Array<number>>} params.extents - The input extents.
   */function Ja(e){be.call(this,null,Qa,e)}function Qa(t){if(this.value&&!t.modified())return this.value;var a=+Infinity,d=-Infinity,r=t.extents,l,o,s;for(l=0,o=r.length;l<o;++l)s=r[l],s[0]<a&&(a=s[0]),s[1]>d&&(d=s[1]);return[a,d]}/**
   * Merge a collection of value arrays.
   * @constructor
   * @param {object} params - The parameters for this operator.
   * @param {Array<Array<*>>} params.values - The input value arrrays.
   */function Ka(e){be.call(this,null,ei,e)}function ei(e){return this.value&&!e.modified()?this.value:e.values.reduce(function(e,t){return e.concat(t)},[])}/**
   * Operator whose value is simply its parameter hash. This operator is
   * useful for enabling reactive updates to values of nested objects.
   * @constructor
   * @param {object} params - The parameters for this operator.
   */function ti(e){Dn.call(this,null,e)}/**
   * Aggregate and pivot selected field values to become new fields.
   * This operator is useful to construction cross-tabulations.
   * @constructor
   * @param {Array<function(object): *>} [params.groupby] - An array of accessors
   *  to groupby. These fields act just like groupby fields of an Aggregate transform.
   * @param {function(object): *} params.field - The field to pivot on. The unique
   *  values of this field become new field names in the output stream.
   * @param {function(object): *} params.value - The field to populate pivoted fields.
   *  The aggregate values of this field become the values of the new pivoted fields.
   * @param {string} [params.op] - The aggregation operation for the value field,
   *  applied per cell in the output stream. The default is "sum".
   * @param {number} [params.limit] - An optional parameter indicating the maximum
   *  number of pivoted fields to generate. The pivoted field names are sorted in
   *  ascending order prior to enforcing the limit.
   */function ni(e){ha.call(this,e)}// Shoehorn a pivot transform into an aggregate transform!
// First collect all unique pivot field values.
// Then generate aggregate fields for each output pivot field.
function ai(e,t){var n=e.field,a=e.value,i=('count'===e.op?'__count__':e.op)||'sum',d=s(n).concat(s(a)),r=di(n,e.limit||0,t);return{key:e.key,groupby:e.groupby,ops:r.map(function(){return i}),fields:r.map(function(e){return ii(e,n,a,d)}),as:r.map(function(e){return e+''}),modified:e.modified.bind(e)}}// Generate aggregate field accessor.
// Output NaN for non-existent values; aggregator will ignore!
function ii(e,t,n,a){return r(function(a){return t(a)===e?n(a):NaN},a,e+'')}// Collect (and optionally limit) all unique pivot values.
function di(e,t,n){var a={},i=[];return n.visit(n.SOURCE,function(n){var t=e(n);a[t]||(a[t]=1,i.push(t))}),i.sort(function(e,t){return(e<t||null==e)&&null!=t?-1:(e>t||null==t)&&null!=e?1:(t=t instanceof Date?+t:t,e=e instanceof Date?+e:e)!==e&&t===t?-1:t!==t&&e===e?1:0}),t?i.slice(0,t):i}/**
   * Partitions pre-faceted data into tuple subflows.
   * @constructor
   * @param {object} params - The parameters for this operator.
   * @param {function(Dataflow, string): Operator} params.subflow - A function
   *   that generates a subflow of operators and returns its root operator.
   * @param {function(object): Array<object>} params.field - The field
   *   accessor for an array of subflow tuple objects.
   */function ri(e){Aa.call(this,e)}/**
   * Performs a relational projection, copying selected fields from source
   * tuples to a new set of derived tuples.
   * @constructor
   * @param {object} params - The parameters for this operator.
   * @param {Array<function(object): *} params.fields - The fields to project,
   *   as an array of field accessors. If unspecified, all fields will be
   *   copied with names unchanged.
   * @param {Array<string>} [params.as] - Output field names for each projected
   *   field. Any unspecified fields will use the field name provided by
   *   the field accessor.
   */function li(e){Dn.call(this,null,e)}function oi(e,a,t,d){for(var r=0,l=t.length;r<l;++r)a[d[r]]=t[r](e);return a}/**
   * Proxy the value of another operator as a pure signal value.
   * Ensures no tuples are propagated.
   * @constructor
   * @param {object} params - The parameters for this operator.
   * @param {*} params.value - The value to proxy, becomes the value of this operator.
   */function si(e){Dn.call(this,null,e)}/**
   * Relays a data stream between data processing pipelines.
   * If the derive parameter is set, this transform will create derived
   * copies of observed tuples. This provides derived data streams in which
   * modifications to the tuples do not pollute an upstream data source.
   * @param {object} params - The parameters for this operator.
   * @param {number} [params.derive=false] - Boolean flag indicating if
   *   the transform should make derived copies of incoming tuples.
   * @constructor
   */function fi(e){Dn.call(this,null,e)}/**
   * Samples tuples passing through this operator.
   * Uses reservoir sampling to maintain a representative sample.
   * @constructor
   * @param {object} params - The parameters for this operator.
   * @param {number} [params.size=1000] - The maximum number of samples.
   */function ci(e){Dn.call(this,[],e),this.count=0}/**
   * Generates data tuples for a specified sequence range of numbers.
   * @constructor
   * @param {object} params - The parameters for this operator.
   * @param {number} params.start - The first number in the sequence.
   * @param {number} params.stop - The last number (exclusive) in the sequence.
   * @param {number} [params.step=1] - The step size between numbers in the sequence.
   */function ui(e){Dn.call(this,null,e)}/**
   * Propagates a new pulse without any tuples so long as the input
   * pulse contains some added, removed or modified tuples.
   * @param {object} params - The parameters for this operator.
   * @constructor
   */function gi(e){Dn.call(this,null,e),this.modified(!0)}/**
   * An index that maps from unique, string-coerced, field values to tuples.
   * Assumes that the field serves as a unique key with no duplicate values.
   * @constructor
   * @param {object} params - The parameters for this operator.
   * @param {function(object): *} params.field - The field accessor to index.
   */function mi(e){Dn.call(this,N(),e)}/**
   * Extracts an array of values. Assumes the source data has already been
   * reduced as needed (e.g., by an upstream Aggregate transform).
   * @constructor
   * @param {object} params - The parameters for this operator.
   * @param {function(object): *} params.field - The domain field to extract.
   * @param {function(*,*): number} [params.sort] - An optional
   *   comparator function for sorting the values. The comparator will be
   *   applied to backing tuples prior to value extraction.
   */function hi(e){Dn.call(this,null,e)}function yi(e,t,n,a){var i=jz[e](t,n);return{init:i.init||el,update:function(e,n){n[a]=i.next(e)}}}function bi(e){function t(e){P(s(e)).forEach(function(e){p[e]=1})}var n=this,a=P(e.ops),d=P(e.fields),r=P(e.params),l=P(e.as),f=n.outputs=[],c=n.windows=[],p={},g={},h=!0,y=[],b=[];t(e.sort),a.forEach(function(e,n){var a=d[n],i=o(a),s=An(e,i,l[n]);// Window operation
if(t(a),f.push(s),jz.hasOwnProperty(e))c.push(yi(e,d[n],r[n],s));// Aggregate operation
else{if(null==a&&'count'!==e&&u('Null aggregate field specified.'),'count'===e)return void y.push(s);h=!1;var p=g[i];p||(p=g[i]=[],p.field=a,b.push(p)),p.push(Ln(e,s))}}),(y.length||b.length)&&(n.cell=_i(b,y,h)),n.inputs=Object.keys(p)}function _i(e,d,r){e=e.map(function(e){return jn(e,e.field)});var l={num:0,agg:null,store:!1,count:d};if(!r)for(var o=e.length,s=l.agg=Array(o),t=0;t<o;++t)s[t]=new e[t](l);if(l.store)var a=l.data=new ma;return l.add=function(e){if(l.num+=1,!r){a&&a.add(e);for(var t=0;t<o;++t)s[t].add(s[t].get(e),e)}},l.rem=function(e){if(l.num-=1,!r){a&&a.rem(e);for(var t=0;t<o;++t)s[t].rem(s[t].get(e),e)}},l.set=function(e){var t,o;// consolidate stored values
// update tuple properties
for(a&&a.values(),t=0,o=d.length;t<o;++t)e[d[t]]=l.num;if(!r)for(t=0,o=s.length;t<o;++t)s[t].set(e)},l.init=function(){l.num=0,a&&a.reset();for(var e=0;e<o;++e)s[e].init()},l}/**
   * Perform window calculations and write results to the input stream.
   * @constructor
   * @param {object} params - The parameters for this operator.
   * @param {function(*,*): number} [params.sort] - A comparator function for sorting tuples within a window.
   * @param {Array<function(object): *>} [params.groupby] - An array of accessors by which to partition tuples into separate windows.
   * @param {Array<string>} params.ops - An array of strings indicating window operations to perform.
   * @param {Array<function(object): *>} [params.fields] - An array of accessors
   *   for data fields to use as inputs to window operations.
   * @param {Array<*>} [params.params] - An array of parameter values for window operations.
   * @param {Array<string>} [params.as] - An array of output field names for window operations.
   * @param {Array<number>} [params.frame] - Window frame definition as two-element array.
   * @param {boolean} [params.ignorePeers=false] - If true, base window frame boundaries on row
   *   number alone, ignoring peers with identical sort values. If false (default),
   *   the window boundaries will be adjusted to include peer values.
   */function xi(e){Dn.call(this,{},e),this._mlen=0,this._mods=[]}function vi(e,t,a){var d=a.sort,r=d&&!a.ignorePeers,l=a.frame||[null,0],o=e.data(d),s=o.length,n=0,f=r?Bn(d):null,c={i0:0,i1:0,p0:0,p1:0,index:0,data:o,compare:d||j(-1)};for(t.init();n<s;++n)ki(c,l,n,s),r&&wi(c,f),t.update(c,o[n])}function ki(e,t,a,i){e.p0=e.i0,e.p1=e.i1,e.i0=null==t[0]?0:fS(0,a-lS(t[0])),e.i1=null==t[1]?i:iS(i,a+lS(t[1])+1),e.index=a}// if frame type is 'range', adjust window for peer values
function wi(e,t){var a=e.i0,i=e.i1-1,r=e.compare,l=e.data,d=l.length-1;0<a&&!r(l[a],l[a-1])&&(e.i0=t.left(l,l[a])),i<d&&!r(l[i],l[i+1])&&(e.i1=t.right(l,l[i]))}function Ei(e){this.clear(),e&&this.union(e)}function Si(e,t){var n=[],a;return a={id:'gradient_'+Bz++,x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:n,stop:function(e,t){return n.push({offset:e,color:t}),a}}}function Ci(e){this.mark=e,this.bounds=this.bounds||new Ei}function zi(e){Ci.call(this,e),this.items=this.items||[]}function Di(e,t){if('undefined'!=typeof document&&document.createElement){var n=document.createElement('canvas');if(n&&n.getContext)return n.width=e,n.height=t,n}return null}function Ri(){return'undefined'==typeof Image?null:Image}function $i(e,t){if(Wz)try{return new Wz(e,t)}catch(t){// do nothing, return null on error
}return null}function Oi(){return Wz&&Wz.Image||null}function Ti(e,t){return Di(e,t)||$i(e,t)||null}function Ai(){return Ri()||Oi()||null}function Li(e){this._pending=0,this._loader=e||ke()}function Pi(e){e._pending+=1}function Mi(e){e._pending-=1}function Ui(){// end of current subpath
this._x0=this._y0=// start of current subpath
this._x1=this._y1=null,this._=''}function ji(){return new Ui}function qi(e){return function(){return e}}function Fi(e){return 1<e?0:-1>e?nD:tS(e)}function Ii(e){return 1<=e?aD:-1>=e?-aD:eS(e)}function Ni(e){return e.innerRadius}function Bi(e){return e.outerRadius}function Wi(e){return e.startAngle}function Gi(e){return e.endAngle}function Yi(e){return e&&e.padAngle;// Note: optional!
}function Hi(e,n,a,i,d,r,l,o){var s=a-e,f=i-n,c=l-d,u=o-r,p=(c*(n-r)-u*(e-d))/(u*s-c*f);return[e+p*s,n+p*f]}// Compute perpendicular offset line of length rc.
// http://mathworld.wolfram.com/Circle-LineIntersection.html
function Vi(e,t,n,a,i,l,o){var s=e-n,f=t-a,c=(o?l:-l)/eD(s*s+f*f),u=c*f,p=-c*s,g=e+u,m=t+p,h=n+u,y=a+p,b=(g+h)/2,_=(m+y)/2,x=h-g,v=y-m,k=x*x+v*v,w=i-l,r=g*y-h*m,E=(0>v?-1:1)*eD(Jz(0,w*w*k-r*r)),d=(r*v-x*E)/k,S=(-r*x-v*E)/k,C=(r*v+x*E)/k,z=(-r*x+v*E)/k,D=d-b,R=S-_,$=C-b,O=z-_;// Pick the closer of the two intersection points.
// TODO Is there a faster way to determine which intersection to use?
return D*D+R*R>$*$+O*O&&(d=C,S=z),{cx:d,cy:S,x01:-u,y01:-p,x11:d*(i/w-1),y11:S*(i/w-1)}}function Xi(e){this._context=e}function Zi(e){return new Xi(e)}function Ji(e){return e[0]}function x(e){return e[1]}function y(){function e(e){var f=e.length,n=!1,c,u,p;for(null==l&&(s=o(p=ji())),c=0;c<=f;++c)!(c<f&&r(u=e[c],c,e))==n&&((n=!n)?s.lineStart():s.lineEnd()),n&&s.point(+t(u,c,e),+a(u,c,e));if(p)return s=null,p+''||null}var t=Ji,a=x,r=qi(!0),l=null,o=Zi,s=null;return e.x=function(n){return arguments.length?(t='function'==typeof n?n:qi(+n),e):t},e.y=function(t){return arguments.length?(a='function'==typeof t?t:qi(+t),e):a},e.defined=function(t){return arguments.length?(r='function'==typeof t?t:qi(!!t),e):r},e.curve=function(t){return arguments.length?(o=t,null!=l&&(s=o(l)),e):o},e.context=function(t){return arguments.length?(null==t?l=s=null:s=o(l=t),e):l},e}function Qi(){function e(e){var t=e.length,n=!1,p=Array(t),g=Array(t),m,h,y,b,_;for(null==f&&(u=c(_=ji())),m=0;m<=t;++m){if(!(m<t&&s(b=e[m],m,e))==n)if(n=!n)h=m,u.areaStart(),u.lineStart();else{for(u.lineEnd(),u.lineStart(),y=m-1;y>=h;--y)u.point(p[y],g[y]);u.lineEnd(),u.areaEnd()}n&&(p[m]=+a(b,m,e),g[m]=+l(b,m,e),u.point(r?+r(b,m,e):p[m],o?+o(b,m,e):g[m]))}if(_)return u=null,_+''||null}function t(){return y().defined(s).curve(c).context(f)}var a=Ji,r=null,l=qi(0),o=x,s=qi(!0),f=null,c=Zi,u=null;return e.x=function(t){return arguments.length?(a='function'==typeof t?t:qi(+t),r=null,e):a},e.x0=function(t){return arguments.length?(a='function'==typeof t?t:qi(+t),e):a},e.x1=function(t){return arguments.length?(r=null==t?null:'function'==typeof t?t:qi(+t),e):r},e.y=function(t){return arguments.length?(l='function'==typeof t?t:qi(+t),o=null,e):l},e.y0=function(t){return arguments.length?(l='function'==typeof t?t:qi(+t),e):l},e.y1=function(t){return arguments.length?(o=null==t?null:'function'==typeof t?t:qi(+t),e):o},e.lineX0=e.lineY0=function(){return t().x(a).y(l)},e.lineY1=function(){return t().x(a).y(o)},e.lineX1=function(){return t().x(r).y(l)},e.defined=function(t){return arguments.length?(s='function'==typeof t?t:qi(!!t),e):s},e.curve=function(t){return arguments.length?(c=t,null!=f&&(u=c(f)),e):c},e.context=function(t){return arguments.length?(null==t?f=u=null:u=c(f=t),e):f},e}function Ki(){}function ed(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function td(e){this._context=e}function nd(e){return new td(e)}function ad(e){this._context=e}function dd(e){return new ad(e)}function rd(e){this._context=e}function ld(e){return new rd(e)}function od(e,t){this._basis=new td(e),this._beta=t}function sd(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function fd(e,t){this._context=e,this._k=(1-t)/6}function cd(e,t){this._context=e,this._k=(1-t)/6}function ud(e,t){this._context=e,this._k=(1-t)/6}function pd(e,t,i){var d=e._x1,r=e._y1,l=e._x2,o=e._y2;if(e._l01_a>tD){var s=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,a=3*e._l01_a*(e._l01_a+e._l12_a);d=(d*s-e._x0*e._l12_2a+e._x2*e._l01_2a)/a,r=(r*s-e._y0*e._l12_2a+e._y2*e._l01_2a)/a}if(e._l23_a>tD){var n=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,f=3*e._l23_a*(e._l23_a+e._l12_a);l=(l*n+e._x1*e._l23_2a-t*e._l12_2a)/f,o=(o*n+e._y1*e._l23_2a-i*e._l12_2a)/f}e._context.bezierCurveTo(d,r,l,o,e._x2,e._y2)}function gd(e,t){this._context=e,this._alpha=t}function md(e,t){this._context=e,this._alpha=t}function hd(e,t){this._context=e,this._alpha=t}function yd(e){this._context=e}function bd(e){return new yd(e)}function _d(e){return 0>e?-1:1}// Calculate the slopes of the tangents (Hermite-type interpolation) based on
// the following paper: Steffen, M. 1990. A Simple Method for Monotonic
// Interpolation in One Dimension. Astronomy and Astrophysics, Vol. 239, NO.
// NOV(II), P. 443, 1990.
function xd(e,t,n){var a=e._x1-e._x0,i=t-e._x1,d=(e._y1-e._y0)/(a||void 0),r=(n-e._y1)/(i||void 0);return(_d(d)+_d(r))*iS(lS(d),lS(r),.5*lS((d*i+r*a)/(a+i)))||0}// Calculate a one-sided slope.
function vd(e,n){var t=e._x1-e._x0;return t?(3*(e._y1-e._y0)/t-n)/2:n}// According to https://en.wikipedia.org/wiki/Cubic_Hermite_spline#Representations
// "you can express cubic Hermite interpolation in terms of cubic Bzier curves
// with respect to the four values p0, p0 + m0 / 3, p1 - m1 / 3, p1".
function kd(e,t,n){var a=e._x0,i=e._y0,d=e._x1,r=e._y1,l=(d-a)/3;e._context.bezierCurveTo(a+l,i+l*t,d-l,r-l*n,d,r)}function wd(e){this._context=e}function Ed(e){this._context=new Sd(e)}function Sd(e){this._context=e}function Cd(e){return new wd(e)}function zd(e){return new Ed(e)}function Dd(e){this._context=e}// See https://www.particleincell.com/2012/bezier-splines/ for derivation.
function Rd(e){var t=e.length-1,n=Array(t),a=Array(t),d=Array(t),r,l;for(n[0]=0,a[0]=2,d[0]=e[0]+2*e[1],r=1;r<t-1;++r)n[r]=1,a[r]=4,d[r]=4*e[r]+2*e[r+1];for(n[t-1]=2,a[t-1]=7,d[t-1]=8*e[t-1]+e[t],r=1;r<t;++r)l=n[r]/a[r-1],a[r]-=l,d[r]-=l*d[r-1];for(n[t-1]=d[t-1]/a[t-1],r=t-2;0<=r;--r)n[r]=(d[r]-n[r+1])/a[r];for(a[t-1]=(e[t]+n[t-1])/2,r=0;r<t-1;++r)a[r]=2*e[r+1]-n[r+1];return[n,a]}function $d(e){return new Dd(e)}function Od(e,n){this._context=e,this._t=n}function Td(e){return new Od(e,.5)}function Ad(e){return new Od(e,0)}function Ld(e){return new Od(e,1)}function Pd(e,t,n){var a=pD.hasOwnProperty(e)&&pD[e],i=null;return a&&(i=a.curve||a[t||'vertical'],a.tension&&null!=n&&(i=i[a.tension](n))),i}// Path parsing and rendering code adapted from fabric.js -- Thanks!
function Md(e){var t=[],a,d,r,l,o,s,f,c,u,p,g;// First, break path into command sequence
// Next, parse each command in turn
for(a=e.slice().replace(mD[0],'###$1').split(mD[1]).slice(1),c=0,p=a.length;c<p;++c){for(d=a[c],r=d.slice(1).trim().replace(mD[2],'$1###$2').split(mD[3]),s=d.charAt(0),l=[s],(u=0,g=r.length);u<g;++u)(o=+r[u])===o&&// not NaN
l.push(o);if(f=gD[s.toLowerCase()],l.length-1>f)for(u=1,g=l.length;u<g;u+=f)t.push([s].concat(l.slice(u,u+f)));else t.push(l)}return t}// Copied from Inkscape svgtopdf, thanks!
function Ud(e,t,n,a,d,r,l,o,s){var f=bD.call(arguments);if(hD[f])return hD[f];var c=l*(aS/180),u=KE(c),p=QE(c);n=lS(n),a=lS(a);var g=.5*(p*(o-e))+.5*(u*(s-t)),m=.5*(p*(s-t))-.5*(u*(o-e)),h=g*g/(n*n)+m*m/(a*a);1<h&&(h=dS(h),n*=h,a*=h);var y=p/n,b=u/n,_=-u/a,x=p/a,v=y*o+b*s,k=_*o+x*s,w=y*e+b*t,E=_*e+x*t,S=1/((w-v)*(w-v)+(E-k)*(E-k))-.25;0>S&&(S=0);var C=dS(S);r==d&&(C=-C);var z=.5*(v+w)-C*(E-k),D=.5*(k+E)+C*(w-v),R=JE(k-D,v-z),$=JE(E-D,w-z),O=$-R;0>O&&1===r?O+=2*aS:0<O&&0==r&&(O-=2*aS);for(var T=cS(lS(O/(.5*aS+.001))),A=[],L=0;L<T;++L){var P=R+L*O/T,M=R+(L+1)*O/T;A[L]=[z,D,P,M,n,a,u,p]}return hD[f]=A}function jd(e){var n=bD.call(e);if(yD[n])return yD[n];var a=e[0],i=e[1],d=e[2],r=e[3],l=e[4],o=e[5],s=e[6],f=e[7],c=f*l,u=-s*o,p=s*l,g=f*o,m=QE(d),h=KE(d),y=QE(r),b=KE(r),_=.5*(r-d),x=KE(.5*_),v=8/3*x*x/KE(_),t=a+m-v*h,k=i+h+v*m,w=a+y,E=i+b,S=w+v*b,C=E-v*y;return yD[n]=[c*t+u*k,p*t+g*k,c*S+u*C,p*S+g*C,c*w+u*E,p*w+g*E]}function qd(e,t){var a=_D[0]=e[0];if('a'===a||'A'===a)_D[1]=t*e[1],_D[2]=t*e[2],_D[3]=e[3],_D[4]=e[4],_D[5]=e[5],_D[6]=t*e[6],_D[7]=t*e[7];else for(var d=1,r=e.length;d<r;++d)_D[d]=t*e[d];return _D}function Fd(e,n,a,d,r){var// current instruction
o=null,f=0,// current x
c=0,// current y
u=0,// current control point x
p=0,g,// current control point y
m,h,b,_;null==a&&(a=0),null==d&&(d=0),null==r&&(r=1),e.beginPath&&e.beginPath();for(var v=0,k=n.length;v<k;++v){switch(g=n[v],1!==r&&(g=qd(g,r)),g[0]){// first letter
case'l':f+=g[1],c+=g[2],e.lineTo(f+a,c+d);break;case'L':f=g[1],c=g[2],e.lineTo(f+a,c+d);break;case'h':f+=g[1],e.lineTo(f+a,c+d);break;case'H':f=g[1],e.lineTo(f+a,c+d);break;case'v':c+=g[1],e.lineTo(f+a,c+d);break;case'V':c=g[1],e.lineTo(f+a,c+d);break;case'm':f+=g[1],c+=g[2],e.moveTo(f+a,c+d);break;case'M':f=g[1],c=g[2],e.moveTo(f+a,c+d);break;case'c':m=f+g[5],h=c+g[6],u=f+g[3],p=c+g[4],e.bezierCurveTo(f+g[1]+a,// x1
c+g[2]+d,// y1
u+a,// x2
p+d,// y2
m+a,h+d),f=m,c=h;break;case'C':f=g[5],c=g[6],u=g[3],p=g[4],e.bezierCurveTo(g[1]+a,g[2]+d,u+a,p+d,f+a,c+d);break;case's':m=f+g[3],h=c+g[4],u=2*f-u,p=2*c-p,e.bezierCurveTo(u+a,p+d,f+g[1]+a,c+g[2]+d,m+a,h+d),u=f+g[1],p=c+g[2],f=m,c=h;break;case'S':m=g[3],h=g[4],u=2*f-u,p=2*c-p,e.bezierCurveTo(u+a,p+d,g[1]+a,g[2]+d,m+a,h+d),f=m,c=h,u=g[1],p=g[2];break;case'q':m=f+g[3],h=c+g[4],u=f+g[1],p=c+g[2],e.quadraticCurveTo(u+a,p+d,m+a,h+d),f=m,c=h;break;case'Q':m=g[3],h=g[4],e.quadraticCurveTo(g[1]+a,g[2]+d,m+a,h+d),f=m,c=h,u=g[1],p=g[2];break;case't':m=f+g[1],h=c+g[2],null===o[0].match(/[QqTt]/)?(u=f,p=c):'t'===o[0]?(u=2*f-b,p=2*c-_):'q'===o[0]&&(u=2*f-u,p=2*c-p),b=u,_=p,e.quadraticCurveTo(u+a,p+d,m+a,h+d),f=m,c=h,u=f+g[1],p=c+g[2];break;case'T':m=g[1],h=g[2],u=2*f-u,p=2*c-p,e.quadraticCurveTo(u+a,p+d,m+a,h+d),f=m,c=h;break;case'a':Id(e,f+a,c+d,[g[1],g[2],g[3],g[4],g[5],g[6]+f+a,g[7]+c+d]),f+=g[6],c+=g[7];break;case'A':Id(e,f+a,c+d,[g[1],g[2],g[3],g[4],g[5],g[6]+a,g[7]+d]),f=g[6],c=g[7];break;case'z':case'Z':e.closePath();}o=g}}function Id(e,t,n,a){for(var d=Ud(a[5],// end x
a[6],// end y
a[0],// radius x
a[1],// radius y
a[3],// large flag
a[4],// sweep flag
a[2],// rotation
t,n),r=0,l;r<d.length;++r)l=jd(d[r]),e.bezierCurveTo(l[0],l[1],l[2],l[3],l[4],l[5])}function Nd(e){return vD.hasOwnProperty(e)?vD[e]:Bd(e)}function Bd(e){if(!kD.hasOwnProperty(e)){var t=Md(e);kD[e]={draw:function(e,n){Fd(e,t,0,0,dS(n)/2)}}}return kD[e]}function Wd(e){return e.x}function Gd(e){return e.y}function Yd(e){return e.width}function Hd(e){return e.height}function Vd(e){return function(){return e}}function Xd(){function e(e,l,o){var s=null==l?+t.call(this,e):l,f=null==o?+n.call(this,e):o,c=+a.call(this,e),u=+i.call(this,e),p=+d.call(this,e),g;if(r||(r=g=ji()),0>=p)r.rect(s,f,c,u);else{var m=s+c,h=f+u;r.moveTo(s+p,f),r.lineTo(m-p,f),r.quadraticCurveTo(m,f,m,f+p),r.lineTo(m,h-p),r.quadraticCurveTo(m,h,m-p,h),r.lineTo(s+p,h),r.quadraticCurveTo(s,h,s,h-p),r.lineTo(s,f+p),r.quadraticCurveTo(s,f,s+p,f),r.closePath()}return g?(r=null,g+''||null):void 0}var t=Wd,n=Gd,a=Yd,i=Hd,d=Vd(0),r=null;return e.x=function(n){return arguments.length?(t='function'==typeof n?n:Vd(+n),e):t},e.y=function(t){return arguments.length?(n='function'==typeof t?t:Vd(+t),e):n},e.width=function(t){return arguments.length?(a='function'==typeof t?t:Vd(+t),e):a},e.height=function(t){return arguments.length?(i='function'==typeof t?t:Vd(+t),e):i},e.cornerRadius=function(t){return arguments.length?(d='function'==typeof t?t:Vd(+t),e):d},e.context=function(t){return arguments.length?(r=null==t?null:t,e):r},e}function Zd(){function e(e,d,r){var l=r/2;if(f){var o=n-d,s=e-c;if(o||s){// get normal vector
var u=dS(o*o+s*s),p=(o/=u)*i,g=(s/=u)*i,m=JE(s,o);// draw segment
a.moveTo(c-p,n-g),a.lineTo(e-o*l,d-s*l),a.arc(e,d,l,m-wD,m),a.lineTo(c+p,n+g),a.arc(c,n,i,m,m+wD)}else a.arc(e,d,l,0,2*wD);a.closePath()}else f=1;c=e,n=d,i=l}function t(t){var c=t.length,n=!1,u,p,g;for(null==a&&(a=g=ji()),u=0;u<=c;++u)!(u<c&&s(p=t[u],u,t))==n&&(n=!n)&&(f=0),n&&e(+r(p,u,t),+l(p,u,t),+o(p,u,t));if(g)return a=null,g+''||null}var a=null,r,l,o,s,f,c,n,i;return t.x=function(e){return arguments.length?(r=e,t):r},t.y=function(e){return arguments.length?(l=e,t):l},t.size=function(e){return arguments.length?(o=e,t):o},t.defined=function(e){return arguments.length?(s=e,t):s},t.context=function(e){return arguments.length?(a=null==e?null:e,t):a},t}function Jd(e){return e.x||0}function Qd(e){return e.y||0}function Kd(e){return e.cornerRadius||0}function er(e){return!1!==e.defined}function tr(e){return null==e.size?64:e.size}function nr(e){return Nd(e.shape||'circle')}function ar(e,t){return SD.context(e)(t)}function ir(e,t){var n=t[0],a=n.interpolate||'linear';return('horizontal'===n.orient?zD:CD).curve(Pd(a,n.orient,n.tension)).context(e)(t)}function dr(e,t){var n=t[0],a=n.interpolate||'linear';return DD.curve(Pd(a,n.orient,n.tension)).context(e)(t)}function rr(e,t,n,a){return RD.context(e)(t,n,a)}function lr(e,t){return(t.mark.shape||t.shape).context(e)(t)}function or(e,t){return $D.context(e)(t)}function sr(e,t){return OD.context(e)(t)}function fr(e,t){return t.stroke&&0!==t.opacity&&0!==t.strokeOpacity&&e.expand(null==t.strokeWidth?1:+t.strokeWidth),e}function cr(e){return LD=e,cr}function ur(){}function pr(e,t){LD.add(e,t)}function gr(e,t,a){for(var d=a.width(),r=a.height(),l=a.x1+t.x1*d,o=a.y1+t.y1*r,s=a.x1+t.x2*d,f=a.y1+t.y2*r,c=t.stops,u=0,p=c.length,n=e.createLinearGradient(l,o,s,f);u<p;++u)n.addColorStop(c[u].offset,c[u].color);return n}function mr(e,t,n){return n.id?gr(e,n,t.bounds):n}function hr(e,t,n){return n*=null==t.fillOpacity?1:t.fillOpacity,!!(0<n)&&(e.globalAlpha=n,e.fillStyle=mr(e,t,t.fill),!0)}function yr(e,t,n){var a=null==(a=t.strokeWidth)?1:a;return!(0>=a)&&(n*=null==t.strokeOpacity?1:t.strokeOpacity,!!(0<n)&&(e.globalAlpha=n,e.strokeStyle=mr(e,t,t.stroke),e.lineWidth=a,e.lineCap=t.strokeCap||'butt',e.lineJoin=t.strokeJoin||'miter',e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||PD),e.lineDashOffset=t.strokeDashOffset||0),!0))}function br(e,t){return e.zindex-t.zindex||e.index-t.index}function _r(e){if(!e.zdirty)return e.zitems;var t=e.items,a=[],d,r,l;for(r=0,l=t.length;r<l;++r)d=t[r],d.index=r,d.zindex&&a.push(d);return e.zdirty=!1,e.zitems=a.sort(br)}function xr(e,t){var a=e.items,d,r;if(a&&a.length){var l=_r(e);if(l&&l.length){for(d=0,r=a.length;d<r;++d)a[d].zindex||t(a[d]);a=l}for(d=0,r=a.length;d<r;++d)t(a[d])}}function vr(e,t){var n=e.items,a,d;if(!n||!n.length)return null;var r=_r(e);for(r&&r.length&&(n=r),d=n.length;0<=--d;)if(a=t(n[d]))return a;if(n===r)for(n=e.items,d=n.length;0<=--d;)if(!n[d].zindex&&(a=t(n[d])))return a;return null}function kr(e){return function(t,n,a){xr(n,function(n){(!a||a.intersects(n.bounds))&&Er(e,t,n,n)})}}function wr(e){return function(t,n,a){n.items.length&&(!a||a.intersects(n.bounds))&&Er(e,t,n.items[0],n.items)}}function Er(e,t,n,a){var i=null==n.opacity?1:n.opacity;0===i||e(t,a)||(n.fill&&hr(t,n,i)&&t.fill(),n.stroke&&yr(t,n,i)&&t.stroke())}function Sr(e){return e||(e=MD),function(t,n,a,i,d,r){return a*=t.pixelRatio,i*=t.pixelRatio,vr(n,function(n){var l=n.bounds;// first hit test against bounding box
return(!l||l.contains(d,r))&&l?e(t,n,a,i,d,r)?n:void 0:void 0;// if in bounding box, perform more careful test
})}}function Cr(e,t){return function(n,a,i,d){var r=Array.isArray(a)?a[0]:a,l=null==t?r.fill:t,o=r.stroke&&n.isPointInStroke,s,f;return o&&(s=r.strokeWidth,f=r.strokeCap,n.lineWidth=null==s?1:s,n.lineCap=null==f?'butt':f),!e(n,a)&&(l&&n.isPointInPath(i,d)||o&&n.isPointInStroke(i,d))}}function zr(e){return Sr(Cr(e))}function Dr(e,t){return'translate('+e+','+t+')'}function Rr(e){return Dr(e.x||0,e.y||0)}function $r(e,t){function n(e,n){return t(cr(e),n),fr(e,n).translate(n.x||0,n.y||0)}function a(e,n){var a=n.x||0,i=n.y||0;e.translate(a,i),e.beginPath(),t(e,n),e.translate(-a,-i)}return{type:e,tag:'path',nested:!1,attr:function(e,n){e('transform',Rr(n)),e('d',t(null,n))},bound:n,draw:kr(a),pick:zr(a)}}function Or(e,t,n){function a(e,n){var a=n.items;return 0===a.length?e:(t(cr(e),a),fr(e,a[0]))}function i(e,n){e.beginPath(),t(e,n)}var d=Cr(i);return{type:e,tag:'path',nested:!0,attr:function(e,n){var a=n.mark.items;a.length&&e('d',t(null,a))},bound:a,draw:wr(i),pick:function(e,t,n,a,i,r){var l=t.items,o=t.bounds;return l&&l.length&&(!o||o.contains(i,r))?(n*=e.pixelRatio,a*=e.pixelRatio,d(e,l,n,a)?l[0]:null):null},tip:n}}function Tr(e,t,n){var a=t.clip,i=e._defs,d=t.clip_id||(t.clip_id='clip'+qD++),r=i.clipping[d]||(i.clipping[d]={id:d});return M(a)?r.path=a(null):(r.width=n.width||0,r.height=n.height||0),'url(#'+d+')'}function Ar(e,t){if(!t.clip&&t.items)for(var n=t.items,a=0,i=n.length;a<i;++a)e.union(n[a].bounds);return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),fr(e,t),e.translate(t.x||0,t.y||0)}function Lr(e,t){var n=t.stroke?FD:0;e.beginPath(),rr(e,t,n,n)}function Pr(e,t,n,a,i,d){if(t.bounds&&!t.bounds.contains(i,d)||!t.items)return null;var r=this,l=n*e.pixelRatio,o=a*e.pixelRatio;return vr(t,function(s){var f,c,u,p;// first hit test against bounding box
// if a group is clipped, that should be handled by the bounds check.
if(p=s.bounds,!p||p.contains(i,d))return c=s.x||0,u=s.y||0,e.save(),e.translate(c,u),c=i-c,u=d-u,f=vr(s,function(e){return Mr(e,c,u)?r.pick(e,n,a,c,u):null}),!f&&!1!==t.interactive&&(s.fill||s.stroke)&&ID(e,s,l,o)&&(f=s),e.restore(),f||null;// passed bounds check, so test sub-groups
})}function Mr(e,t,n){return(!1!==e.interactive||'group'===e.marktype)&&e.bounds&&e.bounds.contains(t,n)}function Ur(e,t){var n=e.image;return n&&n.url===e.url||(n={loaded:!1,width:0,height:0},t.loadImage(e.url).then(function(t){e.image=t,e.image.url=e.url})),n}function jr(e,t){return'center'===e?t/2:'right'===e?t:0}function qr(e,t){return'middle'===e?t/2:'bottom'===e?t:0}function Fr(e,t){var n=t.image,a=t.x||0,i=t.y||0,d=(null==t.width?n&&n.width:t.width)||0,r=(null==t.height?n&&n.height:t.height)||0;return a-=jr(t.align,d),i-=qr(t.baseline,r),e.set(a,i,a+d,i+r)}function Ir(e,t){var n=t.path;if(null==n)return!0;var a=t.pathCache;a&&a.path===n||((t.pathCache=a=Md(n)).path=n),Fd(e,a,t.x,t.y)}function Nr(e,t){return Ir(cr(e),t)?e.set(0,0,0,0):fr(e,t)}function Br(e,t){var n,a;return fr(e.set(n=t.x||0,a=t.y||0,n+t.width||0,a+t.height||0),t)}function Wr(e,t){e.beginPath(),rr(e,t)}function Gr(e,t){var n,a;return fr(e.set(n=t.x||0,a=t.y||0,null==t.x2?n:t.x2,null==t.y2?a:t.y2),t)}function Yr(e,t,n){var a,i,d,r;return!!(t.stroke&&yr(e,t,n))&&(a=t.x||0,i=t.y||0,d=null==t.x2?a:t.x2,r=null==t.y2?i:t.y2,e.beginPath(),e.moveTo(a,i),e.lineTo(d,r),!0)}function Hr(e,t,n,a){return!!e.isPointInStroke&&Yr(e,t,1)&&e.isPointInStroke(n,a)}// make dumb, simple estimate if no canvas is available
function Vr(e){return JD=Qr(e),Xr(tl(e))}function Xr(e){return~~(.8*e.length*JD)}// measure text width if canvas is available
function Zr(e){return ZD.font=il(e),Jr(tl(e))}function Jr(e){return ZD.measureText(e).width}function Qr(e){return null==e.fontSize?11:e.fontSize}function Kr(e){ZD=e&&(ZD=Ti(1,1))?ZD.getContext('2d'):null,XD.width=ZD?Zr:Vr}function tl(e){var t=e.text;return null==t?'':0<e.limit?nl(e):t+''}function nl(e){var t=+e.limit,n=e.text+'',a;if(ZD?(ZD.font=il(e),a=Jr):(JD=Qr(e),a=Xr),a(n)<t)return n;var i=e.ellipsis||'\u2026',d='rtl'===e.dir,r=0,l=n.length,o;if(t-=a(i),d){for(;r<l;)o=r+l>>>1,a(n.slice(o))>t?r=o+1:l=o;return i+n.slice(r)}for(;r<l;)o=1+(r+l>>>1),a(n.slice(0,o))<t?r=o:l=o-1;return n.slice(0,r)+i}function al(e,t){var n=e.font;return(t&&n?(n+'').replace(/"/g,'\''):n)||'sans-serif'}function il(e,t){return''+(e.fontStyle?e.fontStyle+' ':'')+(e.fontVariant?e.fontVariant+' ':'')+(e.fontWeight?e.fontWeight+' ':'')+Qr(e)+'px '+al(e,t)}function dl(e){// perform our own font baseline calculation
// why? not all browsers support SVG 1.1 'alignment-baseline' :(
var t=e.baseline,n=Qr(e);return oS('top'===t?.79*n:'middle'===t?.3*n:'bottom'===t?-.21*n:0)}function rl(e,n,i){var d=XD.height(n),l=n.align,a=n.radius||0,r=n.x||0,o=n.y||0,s=n.dx||0,f=(n.dy||0)+dl(n)-oS(.8*d),// use 4/5 offset
c,u;return a&&(u=(n.theta||0)-aS/2,r+=a*QE(u),o+=a*KE(u)),c=XD.width(n),'center'===l?s-=c/2:'right'===l&&(s-=c),e.set(s+=r,f+=o,s+c,f+d),n.angle&&!i&&e.rotate(n.angle*aS/180,r,o),e.expand(i||!c?0:1)}function ll(e,t,n){var a=nR[e.mark.marktype],i=t||a.bound;return a.nested&&(e=e.mark),i(e.bounds||(e.bounds=new Ei),e,n)}function ol(e,t,a){var d=nR[e.marktype],r=d.bound,l=e.items,o=l&&l.length,s,f,c,u;if(d.nested)return o?c=l[0]:(aR.mark=e,c=aR),u=ll(c,r,a),t=t&&t.union(u)||u,t;if(t=t||e.bounds&&e.bounds.clear()||new Ei,o)for(s=0,f=l.length;s<f;++s)t.union(ll(l[s],r,a));return e.bounds=t}function sl(e,t){return JSON.stringify(e,iR,t)}function fl(e){var t='string'==typeof e?JSON.parse(e):e;return cl(t)}function cl(e){var t=e.marktype,a=e.items,d,r,l;if(a)for(r=0,l=a.length;r<l;++r)d=t?'mark':'group',a[r][d]=e,a[r].zindex&&(a[r][d].zdirty=!0),'group'===(t||d)&&cl(a[r]);return t&&ol(e),e}function ul(e){arguments.length?this.root=fl(e):(this.root=pl({marktype:'group',name:'root',role:'frame'}),this.root.items=[new zi(this.root)])}function pl(e,t){return{bounds:new Ei,clip:!!e.clip,group:t,interactive:!1!==e.interactive,items:[],marktype:e.marktype,name:e.name||void 0,role:e.role||void 0,zindex:e.zindex||0}}// create a new DOM element
function gl(e,t,n){return!e&&'undefined'!=typeof document&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}// find first child element with matching tag
function ml(e,t){t=t.toLowerCase();for(var a=e.childNodes,d=0,r=a.length;d<r;++d)if(a[d].tagName.toLowerCase()===t)return a[d]}// retrieve child element at given index
// create & insert if doesn't exist or if tags do not match
function hl(e,t,n,i){var d=e.childNodes[t],r;return d&&d.tagName.toLowerCase()===n.toLowerCase()||(r=d||null,d=gl(e.ownerDocument,n,i),e.insertBefore(d,r)),d}// remove all child elements at or above the given index
function yl(e,t){for(var n=e.childNodes,a=n.length;a>t;)e.removeChild(n[--a]);return e}// generate css class name for mark
function bl(e){return'mark-'+e.marktype+(e.role?' role-'+e.role:'')+(e.name?' '+e.name:'')}function _l(e,t){var n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function xl(e,t,n,a){var i=e&&e.mark,d,r;if(i&&(d=nR[i.marktype]).tip){for(r=_l(t,n),r[0]-=a[0],r[1]-=a[1];e=e.mark.group;)r[0]-=e.x||0,r[1]-=e.y||0;e=d.tip(i.items,r)}return e}/**
   * Create a new Handler instance.
   * @param {object} [customLoader] - Optional loader instance for
   *   href URL sanitization. If not specified, a standard loader
   *   instance will be generated.
   * @param {function} [customTooltip] - Optional tooltip handler
   *   function for custom tooltip display.
   * @constructor
   */function vl(e,t){this._active=null,this._handlers={},this._loader=e||ke(),this._tooltip=t||kl}// The default tooltip display handler.
// Sets the HTML title attribute on the visualization container.
function kl(e,t,n,a){e.element().setAttribute('title',a||'')}/**
   * Create a new Renderer instance.
   * @param {object} [loader] - Optional loader instance for
   *   image and href URL sanitization. If not specified, a
   *   standard loader instance will be generated.
   * @constructor
   */function wl(e){this._el=null,this._bgcolor=null,this._loader=new Li(e)}function El(e,t){vl.call(this,e,t),this._down=null,this._touch=null,this._first=!0}function Sl(e,t,n){return function(i){var d=this._active,a=this.pickEvent(i);a===d?this.fire(e,i):((!d||!d.exit)&&this.fire(n,i),this._active=a,this.fire(t,i),this.fire(e,i))}}function Cl(e){return function(t){this.fire(e,t),this._active=null}}function zl(e,t){var n=t.clip;if(e.save(),e.beginPath(),M(n))n(e);else{var a=t.group;e.rect(0,0,a.width||0,a.height||0)}e.clip()}function Dl(e,t,n,a,i){var d='undefined'!=typeof HTMLElement&&e instanceof HTMLElement&&null!=e.parentNode,r=e.getContext('2d'),l=d?sR:i;return e.width=t*l,e.height=n*l,d&&1!==l&&(e.style.width=t+'px',e.style.height=n+'px'),r.pixelRatio=l,r.setTransform(l,0,0,l,l*a[0],l*a[1]),e}function Rl(e){wl.call(this,e),this._redraw=!1,this._dirty=new Ei}function $l(e,t,n){return t.expand(1).round(),t.translate(-(n[0]%1),-(n[1]%1)),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}function Ol(e,t){if(null==t)return e;for(var n=uR.clear().union(e);null!=t;t=t.mark.group)n.translate(t.x||0,t.y||0);return n}function Tl(e,t){vl.call(this,e,t);var n=this;n._hrefHandler=Al(n,function(e,t){t&&t.href&&n.handleHref(e,t,t.href)}),n._tooltipHandler=Al(n,function(e,t){n.handleTooltip(e,t,e.type!=='mouseout')})}// wrap an event listener for the SVG DOM
function Al(e,t){return function(n){var a=n.target,i=a.__data__;n.vegaType=n.type,i=Array.isArray(i)?i[0]:i,t.call(e._obj,n,i)}}// add an event handler
// generate string for an opening xml tag
// tag: the name of the xml tag
// attr: hash of attribute name-value pairs to include
// raw: additional raw string to include in tag markup
function Ll(e,t,n){var a='<'+e,i,d;if(t)for(i in t)d=t[i],null!=d&&(a+=' '+i+'="'+d+'"');return n&&(a+=' '+n),a+'>'}// generate string for closing xml tag
// tag: the name of the xml tag
function Pl(e){return'</'+e+'>'}function Ml(e){wl.call(this,e),this._dirtyID=1,this._dirty=[],this._svg=null,this._root=null,this._defs=null}function Ul(e,t,a){var d,r,l;for(e=hl(e,a,'linearGradient',yR),e.setAttribute('id',t.id),e.setAttribute('x1',t.x1),e.setAttribute('x2',t.x2),e.setAttribute('y1',t.y1),e.setAttribute('y2',t.y2),(d=0,r=t.stops.length);d<r;++d)l=hl(e,d,'stop',yR),l.setAttribute('offset',t.stops[d].offset),l.setAttribute('stop-color',t.stops[d].color);yl(e,d)}function jl(e,t,n){var a;e=hl(e,n,'clipPath',yR),e.setAttribute('id',t.id),t.path?(a=hl(e,0,'path',yR),a.setAttribute('d',t.path)):(a=hl(e,0,'rect',yR),a.setAttribute('x',0),a.setAttribute('y',0),a.setAttribute('width',t.width),a.setAttribute('height',t.height))}function ql(e,t){for(;e&&e.dirty!==t;e=e.mark.group)if(e.dirty=t,e.mark&&e.mark.dirty!==t)e.mark.dirty=t;else return}// -- Construct & maintain scenegraph to SVG mapping ---
// Draw a mark container.
// Recursively process group contents.
function Fl(e,t,n){t=t.lastChild;var a=0,i;// remove any extraneous DOM elements
xr(n,function(n){i=e.draw(t,n,i),++a}),yl(t,1+a)}// Bind a scenegraph item to an SVG DOM element.
// Create new SVG elements as needed.
function Il(e,t,n,a,i){var d=e._svg,r;// create a new dom node if needed
if(!d&&(r=t.ownerDocument,d=gl(r,a,yR),e._svg=d,e.mark&&(d.__data__=e,d.__values__={fill:'default'},'g'===a)))// if group, create background and foreground elements
{var l=gl(r,'path',yR);l.setAttribute('class','background'),d.appendChild(l),l.__data__=e;var o=gl(r,'g',yR);d.appendChild(o),o.__data__=e}// (re-)insert if (a) not contained in SVG or (b) sibling order has changed
return(d.ownerSVGElement!==i||Nl(e)&&d.previousSibling!==n)&&t.insertBefore(d,n?n.nextSibling:t.firstChild),d}function Nl(e){var t=e.mark||e.group;return t&&1<t.items.length}// -- Set attributes & styles on SVG elements ---
function Bl(e,t,n){n!==xR[t]&&(null==n?e.style.removeProperty(t):e.style.setProperty(t,n+''),xR[t]=n)}function Wl(e,t,n){// early exit if value is unchanged
t===xR[e]||(// note current value for future comparison
null==t?n?_R.removeAttributeNS(n,e):_R.removeAttribute(e):n?_R.setAttributeNS(n,e,t):_R.setAttribute(e,t),xR[e]=t)}function Gl(){var e;return'undefined'==typeof window?'':(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}function Yl(e){wl.call(this,e),this._text={head:'',bg:'',root:'',foot:'',defs:'',body:''},this._defs={gradient:{},clipping:{}}}function Hl(e,t,n,a){ER[a||e]=t}function Vl(e,t,a,d){if(null==e)return'';var r='',l,o,f,c,u;for('bgrect'===a&&!1===t.interactive&&(r+='pointer-events: none; '),'text'===a&&(r+='font-family: '+al(e)+'; ',r+='font-size: '+Qr(e)+'px; ',e.fontStyle&&(r+='font-style: '+e.fontStyle+'; '),e.fontVariant&&(r+='font-variant: '+e.fontVariant+'; '),e.fontWeight&&(r+='font-weight: '+e.fontWeight+'; ')),(l=0,o=hR.length);l<o;++l)f=hR[l],c=mR[f],u=e[f],null==u?'fill'===c&&(r+='fill: none; '):'transparent'===u&&('fill'===c||'stroke'===c)?r+=c+': none; ':(u.id&&(d.gradient[u.id]=u,u='url(#'+u.id+')'),r+=c+': '+u+'; ');return r?'style="'+r.trim()+'"':null}function Xl(e){return e.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;')}function Zl(e,t){return e=((e||'')+'').toLowerCase(),1<arguments.length?(CR[e]=t,this):CR[e]}function Jl(e){var t=e.clip;if(M(t))t(cr(zR.clear()));else if(t)zR.set(0,0,e.group.width,e.group.height);else return;e.bounds.intersect(zR)}function Ql(e,t,n){return!(e!==t)||('path'===n?Kl(e,t):e instanceof Date&&t instanceof Date?+e==+t:H(e)&&H(t)?lS(e-t)<=DR:e&&t&&(g(e)||g(t))?null!=e&&null!=t&&eo(e,t):e==t)}function Kl(e,t){return Ql(Md(e),Md(t))}function eo(e,t){var n=Object.keys(e),a=Object.keys(t),d,r;if(n.length!==a.length)return!1;for(n.sort(),a.sort(),r=n.length-1;0<=r;r--)if(n[r]!=a[r])return!1;for(r=n.length-1;0<=r;r--)if(d=n[r],!Ql(e[d],t[d],d))return!1;return typeof e==typeof t}/**
   * Calculate bounding boxes for scenegraph items.
   * @constructor
   * @param {object} params - The parameters for this operator.
   * @param {object} params.mark - The scenegraph mark instance to bound.
   */function to(e){Dn.call(this,null,e)}function no(e,t,n){return t(e.bounds.clear(),e,n)}/**
   * Adds a unique identifier to all added tuples.
   * This transform creates a new signal that serves as an id counter.
   * As a result, the id counter is shared across all instances of this
   * transform, generating unique ids across multiple data streams. In
   * addition, this signal value can be included in a snapshot of the
   * dataflow state, enabling correct resumption of id allocation.
   * @constructor
   * @param {object} params - The parameters for this operator.
   * @param {string} params.as - The field name for the generated identifier.
   */function ao(e){Dn.call(this,0,e)}function io(e){var t=e._signals[':vega_identifier:'];return t||(e._signals[':vega_identifier:']=t=e.add(0)),t}/**
   * Bind scenegraph items to a scenegraph mark instance.
   * @constructor
   * @param {object} params - The parameters for this operator.
   * @param {object} params.markdef - The mark definition for creating the mark.
   *   This is an object of legal scenegraph mark properties which *must* include
   *   the 'marktype' property.
   */function ro(e){Dn.call(this,null,e)}function lo(e){var t=e.groups,n=e.parent;return t&&1===t.size?t.get(Object.keys(t.object)[0]):t&&n?t.lookup(n):null}/**
   * Analyze items for overlap, changing opacity to hide items with
   * overlapping bounding boxes. This transform will preserve at least
   * two items (e.g., first and last) even if overlap persists.
   * @param {object} params - The parameters for this operator.
   * @param {function(*,*): number} [params.sort] - A comparator
   *   function for sorting items.
   * @param {object} [params.method] - The overlap removal method to apply.
   *   One of 'parity' (default, hide every other item until there is no
   *   more overlap) or 'greedy' (sequentially scan and hide and items that
   *   overlap with the last visible item).
   * @param {object} [params.boundScale] - A scale whose range should be used
   *   to bound the items. Items exceeding the bounds of the scale range
   *   will be treated as overlapping. If null or undefined, no bounds check
   *   will be applied.
   * @param {object} [params.boundOrient] - The orientation of the scale
   *   (top, bottom, left, or right) used to bound items. This parameter is
   *   ignored if boundScale is null or undefined.
   * @param {object} [params.boundTolerance] - The tolerance in pixels for
   *   bound inclusion testing (default 1). This specifies by how many pixels
   *   an item's bounds may exceed the scale range bounds and not be culled.
   * @constructor
   */function oo(e){Dn.call(this,null,e)}// compute bounding box intersection
// allow 1 pixel of overlap tolerance
function so(e,t){return!(e.x2-1<t.x1||e.x1+1>t.x2||e.y2-1<t.y1||e.y1+1>t.y2)}function fo(e){for(var t=1,d=e.length,n=e[0].bounds,r;t<d;n=r,++t)if(so(n,r=e[t].bounds))return!0}function co(e){var t=e.bounds;return 1<t.width()&&1<t.height()}function uo(e,t,n){var a=e.range(),i=new Ei;return'top'===t||'bottom'===t?i.set(a[0],-Infinity,a[1],+Infinity):i.set(-Infinity,a[0],+Infinity,a[1]),i.expand(n||1),function(e){return i.encloses(e.bounds)}}// reset all items to be fully opaque
function po(e){return e.forEach(function(e){e.opacity=1}),e}// add all tuples to mod, fork pulse if parameters were modified
// fork prevents cross-stream tuple pollution (e.g., pulse from scale)
function go(e,t){return e.reflow(t.modified()).modifies('opacity')}/**
   * Queue modified scenegraph items for rendering.
   * @constructor
   */function mo(e){Dn.call(this,null,e)}function ho(e){// layout axes, gather legends, collect bounds
for(var t=e.items,a=t.length,n=0,d={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null},r,l;n<a;++n)if(r=t[n],l=r.items,'group'===r.marktype)switch(r.role){case'axis':case'legend':break;case'row-header':yo(l,d.rowheaders);break;case'row-footer':yo(l,d.rowfooters);break;case'column-header':yo(l,d.colheaders);break;case'column-footer':yo(l,d.colfooters);break;case'row-title':d.rowtitle=l[0];break;case'column-title':d.coltitle=l[0];break;default:yo(l,d.marks);}return d}function yo(e,t){for(var a=0,d=e.length;a<d;++a)t.push(e[a])}function bo(e){return{x1:0,y1:0,x2:e.width||0,y2:e.height||0}}function _o(e){var t=e.bounds.clone();return t.empty()?t.set(0,0,0,0):t.translate(-(e.x||0),-(e.y||0))}function xo(e,t){return'x1'===t?e.x||0:'y1'===t?e.y||0:'x2'===t?(e.x||0)+(e.width||0):'y2'===t?(e.y||0)+(e.height||0):void 0}function vo(e,t){return e.bounds[t]}function ko(e,t,n){var a=g(e)?e[t]:e;return null==a?n===void 0?0:n:a}function wo(e){return 0>e?cS(-e):0}function Eo(e,t,a){// -- layout grid headers and footers --
// aggregation functions for grid margin determination
function d(e,t){return sS(iS(e,t))}function l(e,t){return cS(fS(e,t))}// bounding box calculation methods
var o=ho(t,a),s=o.marks,f=a.bounds==='flush',u=f?bo:_o,p=new Ei(0,0,0,0),h=ko(a.align,'column'),_=ko(a.align,'row'),v=ko(a.padding,'column'),k=ko(a.padding,'row'),w=a.offset,E=t.columns||a.columns||s.length,S=0>E?1:cS(s.length/E),C=[],z=[],D=0,R=[],$=[],O=0,T=s.length,n,A,L,P,M,U,j,q,F,I,N,B;for(A=0;A<E;++A)z[A]=0;for(A=0;A<S;++A)$[A]=0;// determine offsets for each group
for(A=0;A<T;++A)M=u(s[A]),L=A%E,P=~~(A/E),j=cS(u(s[A]).x2),q=cS(u(s[A]).y2),D=fS(D,j),O=fS(O,q),z[L]=fS(z[L],j),$[P]=fS($[P],q),C.push(v+wo(M.x1)),R.push(k+wo(M.y1)),e.dirty(s[A]);// set initial alignment offsets
for(A=0;A<T;++A)0==A%E&&(C[A]=0),A<E&&(R[A]=0);// enforce column alignment constraints
if(h==='each')for(L=1;L<E;++L){for(B=0,A=L;A<T;A+=E)B<C[A]&&(B=C[A]);for(A=L;A<T;A+=E)C[A]=B+z[L-1]}else if(h==='all'){for(B=0,A=0;A<T;++A)A%E&&B<C[A]&&(B=C[A]);for(A=0;A<T;++A)A%E&&(C[A]=B+D)}else for(h=!1,L=1;L<E;++L)for(A=L;A<T;A+=E)C[A]+=z[L-1];// enforce row alignment constraints
if('each'===_)for(P=1;P<S;++P){for(B=0,A=P*E,n=A+E;A<n;++A)B<R[A]&&(B=R[A]);for(A=P*E;A<n;++A)R[A]=B+$[P-1]}else if('all'===_){for(B=0,A=E;A<T;++A)B<R[A]&&(B=R[A]);for(A=E;A<T;++A)R[A]=B+O}else for(_=!1,P=1;P<S;++P)for(A=P*E,n=A+E;A<n;++A)R[A]+=$[P-1];// perform horizontal grid layout
for(F=0,A=0;A<T;++A)U=s[A],j=U.x||0,U.x=F=C[A]+(A%E?F:0),U.bounds.translate(F-j,0);// perform vertical grid layout
for(L=0;L<E;++L)for(I=0,A=L;A<T;A+=E)U=s[A],q=U.y||0,U.y=I+=R[A],U.bounds.translate(0,I-q);// perform horizontal centering
if(ko(a.center,'column')&&1<S&&h)for(A=0;A<T;++A)U=s[A],M='all'===h?D:z[A%E],F=M-u(U).x2,0<F&&(U.x+=j=F/2,U.bounds.translate(j,0));// perform vertical centering
if(ko(a.center,'row')&&1!==E&&_)for(A=0;A<T;++A)U=s[A],M='all'===_?O:$[~~(A/E)],I=M-u(U).y2,0<I&&(U.y+=q=I/2,U.bounds.translate(0,q));// update mark bounds, mark dirty
for(A=0;A<T;++A)s[A].mark.bounds.clear();for(A=0;A<T;++A)U=s[A],e.dirty(U),p.union(U.mark.bounds.union(U.bounds));// perform row header layout
// perform column header layout
// perform row footer layout
// perform column footer layout
u=f?xo:vo,N=ko(a.headerBand,'row',null),F=So(e,o.rowheaders,s,E,S,-ko(w,'rowHeader'),d,0,u,'x1',0,E,1,N),N=ko(a.headerBand,'column',null),I=So(e,o.colheaders,s,E,E,-ko(w,'columnHeader'),d,1,u,'y1',0,1,E,N),N=ko(a.footerBand,'row',null),So(e,o.rowfooters,s,E,S,ko(w,'rowFooter'),l,0,u,'x2',E-1,E,1,N),N=ko(a.footerBand,'column',null),So(e,o.colfooters,s,E,E,ko(w,'columnFooter'),l,1,u,'y2',S*E-E,1,E,N),o.rowtitle&&(B=F-ko(w,'rowTitle'),N=ko(a.titleBand,'row',.5),Co(e,o.rowtitle,B,0,p,N)),o.coltitle&&(B=I-ko(w,'columnTitle'),N=ko(a.titleBand,'column',.5),Co(e,o.coltitle,B,1,p,N))}function So(e,t,a,d,r,l,o,s,f,c,u,p,_,v){var w=a.length,n=0,E=0,S,C,z,D,R,$,O,T,A;// if no groups, early exit and return 0
if(!w)return n;// compute margin
for(S=u;S<w;S+=p)a[S]&&(n=o(n,f(a[S],c)));// if no headers, return margin calculation
if(!t.length)return n;// check if number of headers exceeds number of rows or columns
// clear mark bounds for all headers
for(t.length>r&&(e.warn('Grid headers exceed limit: '+r),t=t.slice(0,r)),n+=l,(C=0,D=t.length);C<D;++C)e.dirty(t[C]),t[C].mark.bounds.clear();// layout each header
for(S=u,C=0,D=t.length;C<D;++C,S+=p){// search for nearest group to align to
// necessary if table has empty cells
for($=t[C],R=$.mark.bounds,z=S;0<=z&&null==(O=a[z]);z-=_);// assign coordinates and update bounds
// update current edge of layout bounds
s?(T=null==v?O.x:oS(O.bounds.x1+v*O.bounds.width()),A=n):(T=n,A=null==v?O.y:oS(O.bounds.y1+v*O.bounds.height())),R.union($.bounds.translate(T-($.x||0),A-($.y||0))),$.x=T,$.y=A,e.dirty($),E=o(E,R[c])}return E}function Co(e,t,n,a,i,d){if(t){e.dirty(t);// compute title coordinates
var r=n,l=n;a?r=oS(i.x1+d*i.width()):l=oS(i.y1+d*i.height()),t.bounds.translate(r-(t.x||0),l-(t.y||0)),t.mark.bounds.clear().union(t.bounds),t.x=r,t.y=l,e.dirty(t)}}/**
   * Layout view elements such as axes and legends.
   * Also performs size adjustments.
   * @constructor
   * @param {object} params - The parameters for this operator.
   * @param {object} params.mark - Scenegraph mark of groups to layout.
   */function zo(e){Dn.call(this,null,e)}function Do(e,t,a){var d=t.items,r=fS(0,t.width||0),l=fS(0,t.height||0),o=new Ei().set(0,0,r,l),s=o.clone(),f=o.clone(),c=[],u,p,g,m,h,y;// layout axes, gather legends, collect bounds
for(h=0,y=d.length;h<y;++h)switch(p=d[h],p.role){case'axis':m=$o(p)?s:f,m.union(To(e,p,r,l));break;case'title':u=p;break;case'legend':c.push(p);break;case'frame':case'scope':case'row-header':case'row-footer':case'row-title':case'column-header':case'column-footer':case'column-title':s.union(p.bounds),f.union(p.bounds);break;default:o.union(p.bounds);}// layout legends, adjust viewBounds
if(c.length)for(g={leftWidth:Po(e,c),margin:a.legendMargin||8,left:0,right:0,top:0,bottom:0},h=0,y=c.length;h<y;++h)if(m=Uo(e,c[h],g,s,f,r,l),a.autosize&&'fit'===a.autosize.type){// For autosize fit, incorporate the orthogonal dimension only.
// Legends that overrun the chart area will then be clipped;
// otherwise the chart area gets reduced to nothing!
var _=c[h].items[0].datum.orient;'left'===_||'right'===_?o.add(m.x1,0).add(m.x2,0):('top'===_||'bottom'===_)&&o.add(0,m.y1).add(0,m.y2)}else o.union(m);// combine bounding boxes
// perform size adjustment
o.union(s).union(f),u&&o.union(Lo(e,u,r,l,o)),qo(e,t,o,a)}function Ro(e,t,n){return e[t]===n?0:(e[t]=n,1)}function $o(e){var t=e.items[0].datum.orient;return t==='left'||t==='right'}function Oo(e){var t=+e.grid;return[e.ticks?t++:-1,// ticks index
e.labels?t++:-1,// labels index
t+ +e.domain// title index
]}function To(e,t,n,a){var d=t.items[0],r=d.datum,l=r.orient,o=Oo(r),f=d.range,c=d.offset,u=d.position,p=d.minExtent,g=d.maxExtent,m=r.title&&d.items[o[2]].items[0],h=d.titlePadding,b=d.bounds,_=0,v=0,k,w;return MR.clear().union(b),b.clear(),-1<(k=o[0])&&b.union(d.items[k].bounds),-1<(k=o[1])&&b.union(d.items[k].bounds),'top'===l?(_=u||0,v=-c,w=fS(p,iS(g,-b.y1)),m&&(w=Ao(m,w,h,0,-1,b)),b.add(0,-w).add(f,0)):'left'===l?(_=-c,v=u||0,w=fS(p,iS(g,-b.x1)),m&&(w=Ao(m,w,h,1,-1,b)),b.add(-w,0).add(0,f)):'right'===l?(_=n+c,v=u||0,w=fS(p,iS(g,b.x2)),m&&(w=Ao(m,w,h,1,1,b)),b.add(0,0).add(w,f)):'bottom'===l?(_=u||0,v=a+c,w=fS(p,iS(g,b.y2)),m&&(w=Ao(m,w,h,0,1,b)),b.add(0,0).add(f,w)):(_=d.x,v=d.y),(fr(b.translate(_,v),d),Ro(d,'x',_+PR)|Ro(d,'y',v+PR)&&(d.bounds=MR,e.dirty(d),d.bounds=b,e.dirty(d)),d.mark.bounds.clear().union(b))}function Ao(e,t,n,a,i,d){var r=e.bounds,l=0,o=0;return e.auto?(t+=n,a?l=(e.x||0)-(e.x=i*t):o=(e.y||0)-(e.y=i*t),r.translate(-l,-o),e.mark.bounds.set(r.x1,r.y1,r.x2,r.y2),a?(d.add(0,r.y1).add(0,r.y2),t+=r.width()):(d.add(r.x1,0).add(r.x2,0),t+=r.height())):d.union(r),t}function Lo(e,t,n,a,i){var d=t.items[0],r=d.orient,l=d.frame,o=d.anchor,s=d.offset,f=d.bounds,c=0,u='left'===r||'right'===r?a:n,p=0,g=0,m;// update bounds
return'group'===l?'left'===r&&(c=a,u=0):'left'===r?(c=i.y2,u=i.y1):'right'===r?(c=i.y1,u=i.y2):(c=i.x1,u=i.x2),m='start'===o?c:'end'===o?u:(c+u)/2,MR.clear().union(f),'top'===r?(p=m,g=i.y1-s):'left'===r?(p=i.x1-s,g=m):'right'===r?(p=i.x2+s,g=m):'bottom'===r?(p=m,g=i.y2+s):(p=d.x,g=d.y),(f.translate(p-d.x,g-d.y),Ro(d,'x',p)|Ro(d,'y',g)&&(d.bounds=MR,e.dirty(d),d.bounds=f,e.dirty(d)),t.bounds.clear().union(f))}function Po(e,t){return t.reduce(function(t,n){var a=n.items[0];// adjust entry to accommodate padding and title
if(Mo(e,a,a.items[0].items[0]),'left'===a.datum.orient){var i=MR.clear();a.items.forEach(function(e){i.union(e.bounds)}),t=fS(t,cS(i.width()+2*a.padding-1))}return t},0)}function Mo(e,t,n){var a=t.padding-n.x,i=t.padding-n.y;if(t.datum.title){var d=t.items[1].items[0];i+=t.titlePadding+d.fontSize}(a||i)&&(n.x+=a,n.y+=i,n.bounds.translate(a,i),n.mark.bounds.translate(a,i),e.dirty(n))}function Uo(e,t,n,a,i,d,r){var l=t.items[0],o=l.datum,s=o.orient,f=l.offset,c=l.bounds,u=0,p=0,g,m,b;return'top'===s||'bottom'===s?(b=i,u=n[s]):('left'===s||'right'===s)&&(b=a,p=n[s]),MR.clear().union(c),c.clear(),l.items.forEach(function(e){c.union(e.bounds)}),g=2*l.padding-1,m=2*l.padding-1,c.empty()||(g=cS(c.width()+g),m=cS(c.height()+m)),'symbol'===o.type&&jo(l.items[0].items[0].items[0].items),'left'===s?(u-=n.leftWidth+f-sS(b.x1),n.left+=m+n.margin):'right'===s?(u+=f+cS(b.x2),n.right+=m+n.margin):'top'===s?(p-=m+f-sS(b.y1),n.top+=g+n.margin):'bottom'===s?(p+=f+cS(b.y2),n.bottom+=g+n.margin):'top-left'===s?(u+=f,p+=f):'top-right'===s?(u+=d-g-f,p+=f):'bottom-left'===s?(u+=f,p+=r-m-f):'bottom-right'===s?(u+=d-g-f,p+=r-m-f):(u=l.x,p=l.y),(fr(c.set(u,p,u+g,p+m),l),Ro(l,'x',u)|Ro(l,'width',g)|Ro(l,'y',p)|Ro(l,'height',m)&&(l.bounds=MR,e.dirty(l),l.bounds=c,e.dirty(l)),l.mark.bounds.clear().union(c))}function jo(e){// get max widths for each column
var t=e.reduce(function(e,t){return e[t.column]=fS(t.bounds.x2-t.x,e[t.column]||0),e},{});// set dimensions of legend entry groups
e.forEach(function(e){e.width=t[e.column],e.height=e.bounds.y2-e.y})}function qo(e,t,n,a){var i=a.autosize||{},d=i.type,r=e._width,l=e._height,o=e.padding();if(!(1>e._autosize)&&d){var s=fS(0,t.width||0),f=fS(0,cS(-n.x1)),c=fS(0,cS(n.x2-s)),u=fS(0,t.height||0),p=fS(0,cS(-n.y1)),g=fS(0,cS(n.y2-u));'padding'===i.contains&&(r-=o.left+o.right,l-=o.top+o.bottom),'none'===d?(f=0,p=0,s=r,u=l):'fit'===d?(s=fS(0,r-f-c),u=fS(0,l-p-g)):'fit-x'===d?(s=fS(0,r-f-c),l=u+p+g):'fit-y'===d?(r=s+f+c,u=fS(0,l-p-g)):'pad'===d&&(r=s+f+c,l=u+p+g),e._resizeView(r,l,s,u,[f,p],i.resize)}}function Fo(e,t,n){var a=e-t+2*n;return e?0<a?a:1:0}function Io(e){return function(n){var a=n[0],i=n[1],d;return i<a&&(d=a,a=i,i=d),[e.invert(a),e.invert(i)]}}function No(e){return function(a){var d=e.range(),r=a[0],l=a[1],o=-1,s,f,c,u;for(l<r&&(f=r,r=l,l=f),c=0,u=d.length;c<u;++c)d[c]>=r&&d[c]<=l&&(0>o&&(o=c),s=c);if(!(0>o))return r=e.invertExtent(d[o]),l=e.invertExtent(d[s]),[void 0===r[0]?r[1]:r[0],void 0===l[1]?l[0]:l[1]]}}function Bo(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Wo(e){return 1===e.length&&(e=Go(e)),{left:function(t,n,a,i){for(null==a&&(a=0),null==i&&(i=t.length);a<i;){var d=a+i>>>1;0>e(t[d],n)?a=d+1:i=d}return a},right:function(t,n,a,i){for(null==a&&(a=0),null==i&&(i=t.length);a<i;){var d=a+i>>>1;0<e(t[d],n)?i=d:a=d+1}return a}}}function Go(e){return function(t,n){return Bo(e(t),n)}}function Yo(e){return null===e?NaN:+e}function Ho(e,t,a){var d=-1,r,l,o,s;if(t=+t,e=+e,a=+a,e===t&&0<a)return[e];if((r=t<e)&&(l=e,e=t,t=l),0===(s=Vo(e,t,a))||!isFinite(s))return[];if(0<s)for(e=cS(e/s),t=sS(t/s),o=Array(l=cS(t-e+1));++d<l;)o[d]=(e+d)*s;else for(e=sS(e*s),t=cS(t*s),o=Array(l=cS(e-t+1));++d<l;)o[d]=(e-d)/s;return r&&o.reverse(),o}function Vo(e,t,n){var a=(t-e)/fS(0,n),i=sS(gS(a)/rS),d=a/pS(10,i);return 0<=i?(d>=IR?10:d>=NR?5:d>=BR?2:1)*pS(10,i):-pS(10,-i)/(d>=IR?10:d>=NR?5:d>=BR?2:1)}function Xo(e,t,n){var a=lS(t-e)/fS(0,n),i=pS(10,sS(gS(a)/rS)),d=a/i;return d>=IR?i*=10:d>=NR?i*=5:d>=BR&&(i*=2),t<e?-i:i}function Zo(e,t,a){if(null==a&&(a=Yo),!!(o=e.length)){if(0>=(t=+t)||2>o)return+a(e[0],0,e);if(1<=t)return+a(e[o-1],o-1,e);var d=(o-1)*t,i=sS(d),r=+a(e[i],i,e),l=+a(e[i+1],i+1,e),o;return r+(l-r)*(d-i)}}function Jo(){}function Qo(e,t){var a=new Jo;// Copy constructor.
if(e instanceof Jo)e.each(function(e,t){a.set(t,e)});// Index array by numeric index or specified key function.
else if(Array.isArray(e)){var d=-1,r=e.length,n;if(null==t)for(;++d<r;)a.set(d,e[d]);else for(;++d<r;)a.set(t(n=e[d],d,e),n)}// Convert object to map.
else if(e)for(var l in e)a.set(l,e[l]);return a}function Ko(){function e(t,l,o,s){if(l>=a.length)return null!=d&&t.sort(d),null==r?t:r(t);for(var f=-1,c=t.length,n=a[l++],u=Qo(),p=o(),g,m,h;++f<c;)(h=u.get(g=n(m=t[f])+''))?h.push(m):u.set(g,[m]);return u.each(function(t,n){s(p,n,e(t,l,o,s))}),p}function t(e,n){if(++n>a.length)return e;var d=i[n-1],l;return null!=r&&n>=a.length?l=e.entries():(l=[],e.each(function(e,a){l.push({key:a,values:t(e,n)})})),null==d?l:l.sort(function(e,t){return d(e.key,t.key)})}var a=[],i=[],d,r,l;return l={object:function(t){return e(t,0,es,ts)},map:function(t){return e(t,0,as,is)},entries:function(n){return t(e(n,0,as,is),0)},key:function(e){return a.push(e),l},sortKeys:function(e){return i[a.length-1]=e,l},sortValues:function(e){return d=e,l},rollup:function(e){return r=e,l}}}function es(){return{}}function ts(e,t,n){e[t]=n}function as(){return Qo()}function is(e,t,n){e.set(t,n)}function ds(){}function rs(e){function t(t){var n=t+'',d=a.get(n);if(!d){if(l!==VR)return l;a.set(n,d=r.push(t))}return e[(d-1)%e.length]}var a=Qo(),r=[],l=VR;return e=null==e?[]:HR.call(e),t.domain=function(e){if(!arguments.length)return r.slice();r=[],a=Qo();for(var l=-1,o=e.length,n,s;++l<o;)a.has(s=(n=e[l])+'')||a.set(s,r.push(n));return t},t.range=function(n){return arguments.length?(e=HR.call(n),t):e.slice()},t.unknown=function(e){return arguments.length?(l=e,t):l},t.copy=function(){return rs().domain(r).range(e).unknown(l)},t}function ls(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function os(e,t){var n=Object.create(e.prototype);for(var a in t)n[a]=t[a];return n}function ss(){}function fs(e){var t;return e=(e+'').trim().toLowerCase(),(t=JR.exec(e))?(t=parseInt(t[1],16),new ms(15&t>>8|240&t>>4,15&t>>4|240&t,(15&t)<<4|15&t,1)// #f00
):(t=QR.exec(e))?cs(parseInt(t[1],16))// #ff0000
:(t=KR.exec(e))?new ms(t[1],t[2],t[3],1)// rgb(255, 0, 0)
:(t=e$.exec(e))?new ms(255*t[1]/100,255*t[2]/100,255*t[3]/100,1)// rgb(100%, 0%, 0%)
:(t=t$.exec(e))?us(t[1],t[2],t[3],t[4])// rgba(255, 0, 0, 1)
:(t=n$.exec(e))?us(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4])// rgb(100%, 0%, 0%, 1)
:(t=a$.exec(e))?ys(t[1],t[2]/100,t[3]/100,1)// hsl(120, 50%, 50%)
:(t=i$.exec(e))?ys(t[1],t[2]/100,t[3]/100,t[4])// hsla(120, 50%, 50%, 1)
:d$.hasOwnProperty(e)?cs(d$[e]):'transparent'===e?new ms(NaN,NaN,NaN,0):null}function cs(e){return new ms(255&e>>16,255&e>>8,255&e,1)}function us(e,t,n,i){return 0>=i&&(e=t=n=NaN),new ms(e,t,n,i)}function ps(e){return(e instanceof ss||(e=fs(e)),!e)?new ms:(e=e.rgb(),new ms(e.r,e.g,e.b,e.opacity))}function gs(e,t,n,a){return 1===arguments.length?ps(e):new ms(e,t,n,null==a?1:a)}function ms(e,t,n,a){this.r=+e,this.g=+t,this.b=+n,this.opacity=+a}function hs(e){return e=fS(0,iS(255,oS(e)||0)),(16>e?'0':'')+e.toString(16)}function ys(e,t,n,i){return 0>=i?e=t=n=NaN:0>=n||1<=n?e=t=NaN:0>=t&&(e=NaN),new xs(e,t,n,i)}function bs(e){if(e instanceof xs)return new xs(e.h,e.s,e.l,e.opacity);if(e instanceof ss||(e=fs(e)),!e)return new xs;if(e instanceof xs)return e;e=e.rgb();var t=e.r/255,n=e.g/255,a=e.b/255,i=iS(t,n,a),d=fS(t,n,a),r=NaN,f=d-i,c=(d+i)/2;return f?(r=t===d?(n-a)/f+6*(n<a):n===d?(a-t)/f+2:(t-n)/f+4,f/=.5>c?d+i:2-d-i,r*=60):f=0<c&&1>c?0:r,new xs(r,f,c,e.opacity)}function _s(e,t,n,a){return 1===arguments.length?bs(e):new xs(e,t,n,null==a?1:a)}function xs(e,t,n,a){this.h=+e,this.s=+t,this.l=+n,this.opacity=+a}/* From FvD 13.37, CSS Color Module Level 3 */function vs(e,t,n){return 255*(60>e?t+(n-t)*e/60:180>e?n:240>e?t+(n-t)*(240-e)/60:t)}function ks(e){if(e instanceof Es)return new Es(e.l,e.a,e.b,e.opacity);if(e instanceof Os){if(isNaN(e.h))return new Es(e.l,0,0,e.opacity);var t=e.h*r$;return new Es(e.l,QE(t)*e.c,KE(t)*e.c,e.opacity)}e instanceof ms||(e=ps(e));var n=Ds(e.r),a=Ds(e.g),i=Ds(e.b),d=Ss((.2225045*n+.7168786*a+.0606169*i)/1),r,l;return n===a&&a===i?r=l=d:(r=Ss((.4360747*n+.3850649*a+.1430804*i)/o$),l=Ss((.0139322*n+.0971045*a+.7141733*i)/Xn)),new Es(116*d-16,500*(r-d),200*(d-l),e.opacity)}function ws(e,t,n,a){return 1===arguments.length?ks(e):new Es(e,t,n,null==a?1:a)}function Es(e,t,n,a){this.l=+e,this.a=+t,this.b=+n,this.opacity=+a}function Ss(e){return e>c$?pS(e,1/3):e/f$+Zn}function Cs(e){return e>s$?e*e*e:f$*(e-Zn)}function zs(e){return 255*(.0031308>=e?12.92*e:1.055*pS(e,1/2.4)-.055)}function Ds(e){return .04045>=(e/=255)?e/12.92:pS((e+.055)/1.055,2.4)}function Rs(e){if(e instanceof Os)return new Os(e.h,e.c,e.l,e.opacity);if(e instanceof Es||(e=ks(e)),0===e.a&&0===e.b)return new Os(NaN,0,e.l,e.opacity);var t=JE(e.b,e.a)*l$;return new Os(0>t?t+360:t,dS(e.a*e.a+e.b*e.b),e.l,e.opacity)}function $s(e,t,n,a){return 1===arguments.length?Rs(e):new Os(e,t,n,null==a?1:a)}function Os(e,t,n,a){this.h=+e,this.c=+t,this.l=+n,this.opacity=+a}function Ts(e){if(e instanceof Ls)return new Ls(e.h,e.s,e.l,e.opacity);e instanceof ms||(e=ps(e));var t=e.r/255,n=e.g/255,a=e.b/255,i=(p$*a+E*t-ED*n)/(p$+E-ED),d=a-i,r=(D*(n-i)-B*d)/C,l=dS(r*r+d*d)/(D*i*(1-i)),// NaN if l=0 or l=1
s=l?JE(r,d)*l$-120:NaN;return new Ls(0>s?s+360:s,l,i,e.opacity)}function As(e,t,n,a){return 1===arguments.length?Ts(e):new Ls(e,t,n,null==a?1:a)}function Ls(e,t,n,a){this.h=+e,this.s=+t,this.l=+n,this.opacity=+a}function Ps(e,t,n,a,i){var d=e*e,r=d*e;return((1-3*e+3*d-r)*t+(4-6*d+3*r)*n+(1+3*e+3*d-3*r)*a+r*i)/6}function Ms(e){var a=e.length-1;return function(n){var d=0>=n?n=0:1<=n?(n=1,a-1):sS(n*a),i=e[d],r=e[d+1],l=0<d?e[d-1]:2*i-r,o=d<a-1?e[d+2]:2*r-i;return Ps((n-d/a)*a,l,i,r,o)}}function Us(e){var a=e.length;return function(n){var d=sS((0>(n%=1)?++n:n)*a),i=e[(d+a-1)%a],r=e[d%a],l=e[(d+1)%a],o=e[(d+2)%a];return Ps((n-d/a)*a,i,r,l,o)}}function js(e){return function(){return e}}function qs(e,n){return function(a){return e+a*n}}function Fs(e,n,i){return e=pS(e,i),n=pS(n,i)-e,i=1/i,function(a){return pS(e+a*n,i)}}function Is(e,t){var n=t-e;return n?qs(e,180<n||-180>n?n-360*oS(n/360):n):js(isNaN(e)?t:e)}function Ns(e){return 1==(e=+e)?Bs:function(t,n){return n-t?Fs(t,n,e):js(isNaN(t)?n:t)}}function Bs(e,t){var n=t-e;return n?qs(e,n):js(isNaN(e)?t:e)}function Ws(e){return function(t){var a=t.length,n=Array(a),d=Array(a),l=Array(a),o,s;for(o=0;o<a;++o)s=gs(t[o]),n[o]=s.r||0,d[o]=s.g||0,l[o]=s.b||0;return n=e(n),d=e(d),l=e(l),s.opacity=1,function(e){return s.r=n(e),s.g=d(e),s.b=l(e),s+''}}}function Gs(e,t){var n=t?t.length:0,a=e?iS(n,e.length):0,d=Array(a),r=Array(n),l;for(l=0;l<a;++l)d[l]=Qs(e[l],t[l]);for(;l<n;++l)r[l]=t[l];return function(e){for(l=0;l<a;++l)r[l]=d[l](e);return r}}function Ys(e,n){var i=new Date;return e=+e,n-=e,function(a){return i.setTime(e+n*a),i}}function Hs(e,n){return e=+e,n-=e,function(a){return e+n*a}}function Vs(e,t){var n={},i={},d;for(d in(null===e||'object'!=typeof e)&&(e={}),(null===t||'object'!=typeof t)&&(t={}),t)d in e?n[d]=Qs(e[d],t[d]):i[d]=t[d];return function(e){for(d in n)i[d]=n[d](e);return i}}function Xs(e){return function(){return e}}function Zs(e){return function(n){return e(n)+''}}function Js(e,n){var t=y$.lastIndex=b$.lastIndex=0,// string preceding current number in b, if any
d=-1,// index in s
r=[],// string constants and placeholders
l=[],// scan index for next number in b
o,// current match in a
s,// current match in b
f;// number interpolators
// Coerce inputs to strings.
// Interpolate pairs of numbers in a & b.
for(e+='',n+='';(o=y$.exec(e))&&(s=b$.exec(n));)(f=s.index)>t&&(f=n.slice(t,f),r[d]?r[d]+=f:// coalesce with previous string
r[++d]=f),(o=o[0])===(s=s[0])?r[d]?r[d]+=s:// coalesce with previous string
r[++d]=s:(r[++d]=null,l.push({i:d,x:Hs(o,s)})),t=b$.lastIndex;// Add remains of b.
// Special optimization for only a single match.
// Otherwise, interpolate each of the numbers and rejoin the string.
return t<n.length&&(f=n.slice(t),r[d]?r[d]+=f:// coalesce with previous string
r[++d]=f),2>r.length?l[0]?Zs(l[0].x):Xs(n):(n=l.length,function(e){for(var t=0,a;t<n;++t)r[(a=l[t]).i]=a.x(e);return r.join('')})}function Qs(e,n){var a=typeof n,t;return null==n||'boolean'==a?js(n):('number'==a?Hs:'string'==a?(t=fs(n))?(n=t,g$):Js:n instanceof fs?g$:n instanceof Date?Ys:Array.isArray(n)?Gs:'function'!=typeof n.valueOf&&'function'!=typeof n.toString||isNaN(n)?Vs:Hs)(e,n)}function Ks(e,n){return e=+e,n-=e,function(a){return oS(e+n*a)}}function ef(t,n,i,r,l,e){var o,s,f;return(o=dS(t*t+n*n))&&(t/=o,n/=o),(f=t*i+n*r)&&(i-=t*f,r-=n*f),(s=dS(i*i+r*r))&&(i/=s,r/=s,f/=s),t*r<n*i&&(t=-t,n=-n,f=-f,o=-o),{translateX:l,translateY:e,rotate:JE(n,t)*_$,skewX:ZE(f)*_$,scaleX:o,scaleY:s}}function tf(e){return'none'===e?x$:(re||(re=document.createElement('DIV'),L$=document.documentElement,P$=document.defaultView),re.style.transform=e,e=P$.getComputedStyle(L$.appendChild(re),null).getPropertyValue('transform'),L$.removeChild(re),e=e.slice(7,-1).split(','),ef(+e[0],+e[1],+e[2],+e[3],+e[4],+e[5]))}function nf(e){return null==e?x$:(M$||(M$=document.createElementNS('http://www.w3.org/2000/svg','g')),M$.setAttribute('transform',e),!(e=M$.transform.baseVal.consolidate()))?x$:(e=e.matrix,ef(e.a,e.b,e.c,e.d,e.e,e.f))}function af(e,t,n,i){function d(e){return e.length?e.pop()+' ':''}function r(e,a,d,r,l,o){if(e!==d||a!==r){var s=l.push('translate(',null,t,null,n);o.push({i:s-4,x:Hs(e,d)},{i:s-2,x:Hs(a,r)})}else(d||r)&&l.push('translate('+d+t+r+n)}function l(e,t,n,r){e===t?t&&n.push(d(n)+'rotate('+t+i):(180<e-t?t+=360:180<t-e&&(e+=360),r.push({i:n.push(d(n)+'rotate(',null,i)-2,x:Hs(e,t)}))}function o(e,t,n,a){e===t?t&&n.push(d(n)+'skewX('+t+i):a.push({i:n.push(d(n)+'skewX(',null,i)-2,x:Hs(e,t)})}function f(e,t,n,a,r,l){if(e!==n||t!==a){var o=r.push(d(r)+'scale(',null,',',null,')');l.push({i:o-4,x:Hs(e,n)},{i:o-2,x:Hs(t,a)})}else(1!==n||1!==a)&&r.push(d(r)+'scale('+n+','+a+')')}return function(t,n){var d=[],// string constants and placeholders
s=[];// number interpolators
// gc
return t=e(t),n=e(n),r(t.translateX,t.translateY,n.translateX,n.translateY,d,s),l(t.rotate,n.rotate,d,s),o(t.skewX,n.skewX,d,s),f(t.scaleX,t.scaleY,n.scaleX,n.scaleY,d,s),t=n=null,function(e){for(var t=-1,a=s.length,n;++t<a;)d[(n=s[t]).i]=n.x(e);return d.join('')}}}function df(e){return((e=mS(e))+1/e)/2}function rf(e){return((e=mS(e))-1/e)/2}function lf(e){return((e=mS(2*e))-1)/(e+1)}// p0 = [ux0, uy0, w0]
// p1 = [ux1, uy1, w1]
function of(e,t){var n=e[0],a=e[1],d=e[2],r=t[0],l=t[1],o=t[2],f=r-n,c=l-a,s=f*f+c*c,u,p;// Special case for u0  u1.
if(s<E$)p=gS(o/d)/w$,u=function(e){return[n+e*f,a+e*c,d*mS(w$*e*p)]};// General case.
else{var g=dS(s),m=(o*o-d*d+4*s)/(2*(2*d)*g),h=(o*o-d*d-4*s)/(2*(2*o)*g),y=gS(dS(m*m+1)-m),b=gS(dS(h*h+1)-h);p=(b-y)/w$,u=function(e){var t=e*p,i=df(y),r=d/(2*g)*(i*lf(w$*t+y)-rf(y));return[n+r*f,a+r*c,d*i/df(w$*t+y)]}}return u.duration=1e3*p,u}function sf(e){return function(n,a){var i=e((n=_s(n)).h,(a=_s(a)).h),d=Bs(n.s,a.s),r=Bs(n.l,a.l),l=Bs(n.opacity,a.opacity);return function(e){return n.h=i(e),n.s=d(e),n.l=r(e),n.opacity=l(e),n+''}}}function ff(e){return function(n,a){var i=e((n=$s(n)).h,(a=$s(a)).h),d=Bs(n.c,a.c),r=Bs(n.l,a.l),l=Bs(n.opacity,a.opacity);return function(e){return n.h=i(e),n.c=d(e),n.l=r(e),n.opacity=l(e),n+''}}}function cf(e){return function t(n){function a(a,i){var d=e((a=As(a)).h,(i=As(i)).h),r=Bs(a.s,i.s),o=Bs(a.l,i.l),l=Bs(a.opacity,i.opacity);return function(e){return a.h=d(e),a.s=r(e),a.l=o(pS(e,n)),a.opacity=l(e),a+''}}return n=+n,a.gamma=t,a}(1)}function uf(e,t){for(var a=0,d=t.length-1,n=t[0],r=Array(0>d?0:d);a<d;)r[a]=e(n,n=t[++a]);return function(e){var n=fS(0,iS(d-1,sS(e*=d)));return r[n](e-n)}}function pf(e){return function(){return e}}function gf(e){return+e}function mf(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:pf(t)}function hf(e){return function(t,n){var i=e(t=+t,n=+n);return function(e){return e<=t?0:e>=n?1:i(e)}}}function yf(e){return function(n,i){var d=e(n=+n,i=+i);return function(e){return 0>=e?n:1<=e?i:d(e)}}}function bf(e,t,n,a){var i=e[0],d=e[1],r=t[0],l=t[1];return d<i?(i=n(d,i),r=a(l,r)):(i=n(i,d),r=a(r,l)),function(e){return r(i(e))}}function _f(e,t,n,a){var l=iS(e.length,t.length)-1,o=Array(l),d=Array(l),r=-1;// Reverse descending domains.
for(e[l]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++r<l;)o[r]=n(e[r],e[r+1]),d[r]=a(t[r],t[r+1]);return function(t){var n=FR(e,t,1,l)-1;return d[n](o[n](t))}}function vf(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp())}// deinterpolate(a, b)(x) takes a domain value x in [a,b] and returns the corresponding parameter t in [0,1].
// reinterpolate(a, b)(t) takes a parameter t in [0,1] and returns the corresponding domain value x in [a,b].
function kf(e,t){function n(){return o=2<iS(i.length,d.length)?_f:bf,s=f=null,a}function a(t){return(s||(s=o(i,d,l?hf(e):e,r)))(+t)}var i=T$,d=T$,r=Qs,l=!1,o,s,f;return a.invert=function(e){return(f||(f=o(d,i,mf,l?yf(t):t)))(+e)},a.domain=function(e){return arguments.length?(i=YR.call(e,gf),n()):i.slice()},a.range=function(e){return arguments.length?(d=HR.call(e),n()):d.slice()},a.rangeRound=function(e){return d=HR.call(e),r=Ks,n()},a.clamp=function(e){return arguments.length?(l=!!e,n()):l},a.interpolate=function(e){return arguments.length?(r=e,n()):r},n()}// Computes the decimal coefficient and exponent of the specified number x with
// significant digits p, where x is positive and p is in [1, 21] or undefined.
// For example, formatDecimal(1.23) returns ["123", 0].
function wf(e,t){if(0>(a=(e=t?e.toExponential(t-1):e.toExponential()).indexOf('e')))return null;// NaN, Infinity
var n=e.slice(0,a),a;// The string returned by toExponential either has the form \d\.\d+e[-+]\d+
// (e.g., 1.2e+3) or the form \de[-+]\d+ (e.g., 1e+3).
return[1<n.length?n[0]+n.slice(2):n,+e.slice(a+1)]}function Ef(e){return e=wf(lS(e)),e?e[1]:NaN}function Sf(e,n){return function(a,d){for(var r=a.length,l=[],t=0,o=e[0],s=0;0<r&&0<o&&(s+o+1>d&&(o=fS(1,d-s)),l.push(a.substring(r-=o,r+o)),!((s+=o+1)>d));)o=e[t=(t+1)%e.length];return l.reverse().join(n)}}function Cf(e){return function(t){return t.replace(/[0-9]/g,function(t){return e[+t]})}}// [[fill]align][sign][symbol][0][width][,][.precision][~][type]
function zf(e){return new Df(e)}// instanceof
function Df(e){if(!(t=A$.exec(e)))throw new Error('invalid format: '+e);var t;this.fill=t[1]||' ',this.align=t[2]||'>',this.sign=t[3]||'-',this.symbol=t[4]||'',this.zero=!!t[5],this.width=t[6]&&+t[6],this.comma=!!t[7],this.precision=t[8]&&+t[8].slice(1),this.trim=!!t[9],this.type=t[10]||''}// Trims insignificant zeros, e.g., replaces 1.2000k with 1.2k.
function Rf(e){out:for(var t=e.length,n=1,a=-1,d;n<t;++n)switch(e[n]){case'.':a=d=n;break;case'0':0===a&&(a=n),d=n;break;default:if(0<a){if(!+e[n])break out;a=0}}return 0<a?e.slice(0,a)+e.slice(d+1):e}function $f(e,t){var n=wf(e,t);if(!n)return e+'';var a=n[0],i=n[1];return 0>i?'0.'+Array(-i).join('0')+a:a.length>i+1?a.slice(0,i+1)+'.'+a.slice(i+1):a+Array(i-a.length+2).join('0')}function Of(e){return e}function Tf(e){function t(e){function t(e){var t=b,l=_,k,w,E;if('c'===y)l=x(e)+l,e='';else{e=+e;// Perform the initial formatting.
var S=0>e;// Break the formatted value into the integer value part that can be
// grouped, and fractional or exponential suffix part that is not.
if(e=x(lS(e),m),h&&(e=Rf(e)),S&&0==+e&&(S=!1),t=(S?'('===f?f:'-':'-'===f||'('===f?'':f)+t,l=('s'===y?j$[8+q$/3]:'')+l+(S&&'('===f?')':''),v)for(k=-1,w=e.length;++k<w;)if(E=e.charCodeAt(k),48>E||57<E){l=(46===E?d+e.slice(k+1):e.slice(k))+l,e=e.slice(0,k);break}}// If the fill character is not "0", grouping is applied before padding.
g&&!u&&(e=a(e,1/0));// Compute the padding.
var C=t.length+e.length+l.length,z=C<p?Array(p-C+1).join(o):'';// If the fill character is "0", grouping is applied after padding.
// Reconstruct the final output based on the desired alignment.
switch(g&&u&&(e=a(z+e,z.length?p-l.length:1/0),z=''),s){case'<':e=t+e+l+z;break;case'=':e=t+z+e+l;break;case'^':e=z.slice(0,C=z.length>>1)+t+e+l+z.slice(C);break;default:e=z+t+e+l;}return r(e)}e=zf(e);var o=e.fill,s=e.align,f=e.sign,c=e.symbol,u=e.zero,p=e.width,g=e.comma,m=e.precision,h=e.trim,y=e.type;// The "n" type is an alias for ",g".
'n'===y?(g=!0,y='g'):!U$[y]&&(null==m&&(m=12),h=!0,y='g'),(u||'0'===o&&'='===s)&&(u=!0,o='0',s='=');// Compute the prefix and suffix.
// For SI-prefix, the suffix is lazily computed.
var b='$'===c?i[0]:'#'===c&&/[boxX]/.test(y)?'0'+y.toLowerCase():'',_='$'===c?i[1]:/[%p]/.test(y)?l:'',x=U$[y],v=/[defgprs%]/.test(y);// What format function should we use?
// Is this an integer type?
// Can this type generate exponential notation?
// Set the default precision if not specified,
// or clamp the specified precision to the supported range.
// For significant precision, it must be in [1, 21].
// For fixed precision, it must be in [0, 20].
return m=null==m?6:/[gprs]/.test(y)?fS(1,iS(21,m)):fS(0,iS(20,m)),t.toString=function(){return e+''},t}var a=e.grouping&&e.thousands?Sf(e.grouping,e.thousands):Of,i=e.currency,d=e.decimal,r=e.numerals?Cf(e.numerals):Of,l=e.percent||'%';return{format:t,formatPrefix:function(n,a){var i=t((n=zf(n),n.type='f',n)),d=3*fS(-8,iS(8,sS(Ef(a)/3))),e=pS(10,-d),r=j$[8+d/3];return function(t){return i(e*t)+r}}}}function Af(e){return F$=Tf(e),I$=F$.format,N$=F$.formatPrefix,F$}function Lf(e){return fS(0,-Ef(lS(e)))}function Pf(e,t){return fS(0,3*fS(-8,iS(8,sS(Ef(t)/3)))-Ef(lS(e)))}function Mf(e,t){return e=lS(e),t=lS(t)-e,fS(0,Ef(t)-Ef(e))+1}function Uf(e,t,n){var a=e[0],i=e[e.length-1],d=Xo(a,i,null==t?10:t),r;switch(n=zf(null==n?',f':n),n.type){case's':{var l=fS(lS(a),lS(i));return null!=n.precision||isNaN(r=Pf(d,l))||(n.precision=r),N$(n,l)}case'':case'e':case'g':case'p':case'r':{null!=n.precision||isNaN(r=Mf(d,fS(lS(a),lS(i))))||(n.precision=r-('e'===n.type));break}case'f':case'%':{null!=n.precision||isNaN(r=Lf(d))||(n.precision=r-2*('%'===n.type));break}}return I$(n)}function jf(e){var t=e.domain;return e.ticks=function(e){var n=t();return Ho(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){return Uf(t(),e,n)},e.nice=function(n){null==n&&(n=10);var a=t(),i=0,d=a.length-1,r=a[i],l=a[d],o;return l<r&&(o=r,r=l,l=o,o=i,i=d,d=o),o=Vo(r,l,n),0<o?(r=sS(r/o)*o,l=cS(l/o)*o,o=Vo(r,l,n)):0>o&&(r=cS(r*o)/o,l=sS(l*o)/o,o=Vo(r,l,n)),0<o?(a[i]=sS(r/o)*o,a[d]=cS(l/o)*o,t(a)):0>o&&(a[i]=cS(r*o)/o,a[d]=sS(l*o)/o,t(a)),e},e}function qf(){var e=kf(mf,Hs);return e.copy=function(){return vf(e,qf())},jf(e)}function Ff(){function e(e){return+e}var t=[0,1];return e.invert=e,e.domain=e.range=function(n){return arguments.length?(t=YR.call(n,gf),e):t.slice()},e.copy=function(){return Ff().domain(t)},jf(e)}function If(e,n){e=e.slice();var a=0,i=e.length-1,d=e[a],r=e[i],l;return r<d&&(l=a,a=i,i=l,l=d,d=r,r=l),e[a]=n.floor(d),e[i]=n.ceil(r),e}function Nf(e,t){return(t=gS(t/e))?function(n){return gS(n/e)/t}:pf(t)}function Bf(e,n){return 0>e?function(a){return-pS(-n,a)*pS(-e,1-a)}:function(a){return pS(n,a)*pS(e,1-a)}}function Wf(e){return isFinite(e)?+('1e'+e):0>e?0:e}function Gf(e){return 10===e?Wf:e===XE?mS:function(t){return pS(e,t)}}function Yf(e){return e===XE?gS:10===e&&Math.log10||2===e&&Math.log2||(e=gS(e),function(t){return gS(t)/e})}function Hf(e){return function(t){return-e(-t)}}function Vf(){function e(){return o=Yf(l),s=Gf(l),0>a()[0]&&(o=Hf(o),s=Hf(s)),t}var t=kf(Nf,Bf).domain([1,10]),a=t.domain,l=10,o=Yf(10),s=Gf(10);return t.base=function(t){return arguments.length?(l=+t,e()):l},t.domain=function(t){return arguments.length?(a(t),e()):a()},t.ticks=function(e){var f=a(),d=f[0],c=f[f.length-1],g;(g=c<d)&&(m=d,d=c,c=m);var m=o(d),h=o(c),y=null==e?10:+e,n=[],b,_,x;if(l%1||!(h-m<y))n=Ho(m,h,iS(h-m,y)).map(s);else if(m=oS(m)-1,h=oS(h)+1,0<d){for(;m<h;++m)for(_=1,b=s(m);_<l;++_)if(x=b*_,!(x<d)){if(x>c)break;n.push(x)}}else for(;m<h;++m)for(_=l-1,b=s(m);1<=_;--_)if(x=b*_,!(x<d)){if(x>c)break;n.push(x)}return g?n.reverse():n},t.tickFormat=function(e,n){if(null==n&&(n=10==l?'.0e':','),'function'!=typeof n&&(n=I$(n)),e===1/0)return n;null==e&&(e=10);var a=fS(1,l*e/t.ticks().length);// TODO fast estimate?
return function(e){var t=e/s(oS(o(e)));return t*l<l-.5&&(t*=l),t<=a?n(e):''}},t.nice=function(){return a(If(a(),{floor:function(e){return s(sS(o(e)))},ceil:function(e){return s(cS(o(e)))}}))},t.copy=function(){return vf(t,Vf().base(l))},t}function Xf(e,t){return 0>e?-pS(-e,t):pS(e,t)}function Zf(){function e(e,t){return(t=Xf(t,n)-(e=Xf(e,n)))?function(a){return(Xf(a,n)-e)/t}:pf(t)}function t(e,i){return i=Xf(i,n)-(e=Xf(e,n)),function(a){return Xf(e+i*a,1/n)}}var n=1,a=kf(e,t),i=a.domain;return a.exponent=function(e){return arguments.length?(n=+e,i(i())):n},a.copy=function(){return vf(a,Zf().exponent(n))},jf(a)}function Jf(){function e(){var e=0,l=fS(1,d.length);for(r=Array(l-1);++e<l;)r[e-1]=Zo(a,e/l);return t}function t(e){if(!isNaN(e=+e))return d[FR(r,e)]}var a=[],d=[],r=[];return t.invertExtent=function(e){var t=d.indexOf(e);return 0>t?[NaN,NaN]:[0<t?r[t-1]:a[0],t<r.length?r[t]:a[a.length-1]]},t.domain=function(t){if(!arguments.length)return a.slice();a=[];for(var r=0,l=t.length,n;r<l;++r)(n=t[r],null!=n&&!isNaN(n=+n))&&a.push(n);return a.sort(Bo),e()},t.range=function(t){return arguments.length?(d=HR.call(t),e()):d.slice()},t.quantiles=function(){return r.slice()},t.copy=function(){return Jf().domain(a).range(d)},t}function Qf(){function e(e){if(e<=e)return o[FR(l,e,0,r)]}function t(){var t=-1;for(l=Array(r);++t<r;)l[t]=((t+1)*d-(t-r)*a)/(r+1);return e}var a=0,d=1,r=1,l=[.5],o=[0,1];return e.domain=function(e){return arguments.length?(a=+e[0],d=+e[1],t()):[a,d]},e.range=function(e){return arguments.length?(r=(o=HR.call(e)).length-1,t()):o.slice()},e.invertExtent=function(e){var t=o.indexOf(e);return 0>t?[NaN,NaN]:1>t?[a,l[0]]:t>=r?[l[r-1],d]:[l[t-1],l[t]]},e.copy=function(){return Qf().domain([a,d]).range(o)},jf(e)}function Kf(){function e(e){if(e<=e)return a[FR(t,e,0,i)]}var t=[.5],a=[0,1],i=1;return e.domain=function(n){return arguments.length?(t=HR.call(n),i=iS(t.length,a.length-1),e):t.slice()},e.range=function(n){return arguments.length?(a=HR.call(n),i=iS(t.length,a.length-1),e):a.slice()},e.invertExtent=function(e){var n=a.indexOf(e);return[t[n-1],t[n]]},e.copy=function(){return Kf().domain(t).range(a)},e}function ec(e){return new Date(e)}function tc(e){return e instanceof Date?+e:+new Date(+e)}function nc(e,t,n,a,i,d,r,l,o){function s(l){return(r(l)<l?g:d(l)<l?m:i(l)<l?h:a(l)<l?y:t(l)<l?n(l)<l?b:_:e(l)<l?x:v)(l)}function f(t,n,a,d){// If a desired tick count is specified, pick a reasonable tick interval
// based on the extent of the domain and a rough estimate of tick size.
// Otherwise, assume interval is already a time interval and use it.
if(null==t&&(t=10),'number'==typeof t){var r=lS(a-n)/t,o=Wo(function(e){return e[2]}).right(k,r);o===k.length?(d=Xo(n/31536000000,a/31536000000,t),t=e):o?(o=k[r/k[o-1][2]<k[o][2]/r?o-1:o],d=o[1],t=o[0]):(d=fS(Xo(n,a,t),1),t=l)}return null==d?t:t.every(d)}var c=kf(mf,Hs),u=c.invert,p=c.domain,g=o('.%L'),m=o(':%S'),h=o('%I:%M'),y=o('%I %p'),b=o('%a %d'),_=o('%b %d'),x=o('%B'),v=o('%Y'),k=[[r,1,1000],[r,5,5000],[r,15,15000],[r,30,30000],[d,1,60000],[d,5,300000],[d,15,900000],[d,30,1800000],[i,1,3600000],[i,3,10800000],[i,6,21600000],[i,12,43200000],[a,1,86400000],[a,2,172800000],[n,1,604800000],[t,1,2592000000],[t,3,7776000000],[e,1,31536000000]];return c.invert=function(e){return new Date(u(e))},c.domain=function(e){return arguments.length?p(YR.call(e,tc)):p().map(ec)},c.ticks=function(e,n){var a=p(),i=a[0],d=a[a.length-1],l=d<i,r;// inclusive stop
return l&&(r=i,i=d,d=r),r=f(e,i,d,n),r=r?r.range(i,d+1):[],l?r.reverse():r},c.tickFormat=function(e,t){return null==t?s:o(t)},c.nice=function(e,t){var n=p();return(e=f(e,n[0],n[n.length-1],t))?p(If(n,e)):c},c.copy=function(){return vf(c,nc(e,t,n,a,i,d,r,l,o))},c}function ac(){return nc(sC,lC,JS,XS,HS,GS,BS,IS,MC).domain([new Date(2e3,0,1),new Date(2e3,0,2)])}function ic(){return nc(RC,zC,yC,mC,pC,cC,BS,IS,jC).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)])}function dc(){function e(){var e=i().length,t=r[1]<r[0],n=r[t-0],a=r[1-t],p=Fo(e,o,s);c=(a-n)/(p||1),l&&(c=sS(c)),n+=(a-n-c*(e-o))*f,u=c*(1-o),l&&(n=oS(n),u=oS(u));var g=Hn(e).map(function(e){return n+c*e});return d(t?g.reverse():g)}var t=rs().unknown(void 0),i=t.domain,d=t.range,r=[0,1],l=!1,o=0,s=0,f=.5,c,u;return delete t.unknown,t.domain=function(t){return arguments.length?(i(t),e()):i()},t.range=function(t){return arguments.length?(r=[+t[0],+t[1]],e()):r.slice()},t.rangeRound=function(t){return r=[+t[0],+t[1]],l=!0,e()},t.bandwidth=function(){return u},t.step=function(){return c},t.round=function(t){return arguments.length?(l=!!t,e()):l},t.padding=function(t){return arguments.length?(s=fS(0,iS(1,t)),o=s,e()):o},t.paddingInner=function(t){return arguments.length?(o=fS(0,iS(1,t)),e()):o},t.paddingOuter=function(t){return arguments.length?(s=fS(0,iS(1,t)),e()):s},t.align=function(t){return arguments.length?(f=fS(0,iS(1,t)),e()):f},t.invertRange=function(e){// bail if range has null or undefined values
// order range inputs, bail if outside of scale range
if(null!=e[0]&&null!=e[1]){var l=+e[0],o=+e[1],s=r[1]<r[0],f=s?d().reverse():d(),c=f.length-1,n,p,g;// bail if either range endpoint is invalid
// binary search to index into scale range
if(l==l&&o==o)return(o<l&&(g=l,l=o,o=g),!(o<f[0]||l>r[1-s]))?(n=fS(0,ez(f,l)-1),p=l==o?n:ez(f,o)-1,l-f[n]>u+1e-10&&++n,s&&(g=n,n=c-p,p=c-g),n>p?void 0:i().slice(n,p+1)):void 0}},t.invert=function(e){var n=t.invertRange([e,e]);return n?n[0]:n},t.copy=function(){return dc().domain(i()).range(r).round(l).paddingInner(o).paddingOuter(s).align(f)},e()}function rc(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return rc(t())},e}function lc(e){return B$.call(e,function(e){return+e})}function oc(){function e(e){return n(e)}function t(e){a=lc(e),n.domain([a[0],f(a)])}var n=qf(),a=[];return e.domain=function(n){return arguments.length?(t(n),e):a.slice()},e.range=function(t){return arguments.length?(n.range(t),e):n.range()},e.rangeRound=function(t){return arguments.length?(n.rangeRound(t),e):n.rangeRound()},e.interpolate=function(t){return arguments.length?(n.interpolate(t),e):n.interpolate()},e.invert=function(e){return n.invert(e)},e.ticks=function(t){var i=a.length,n=~~(i/(t||i));return 2>n?e.domain():a.filter(function(e,t){return!(t%n)})},e.tickFormat=function(){return n.tickFormat.apply(n,arguments)},e.copy=function(){return oc().domain(e.domain()).range(e.range())},e}function sc(){function e(e){return null==e||e!==e?void 0:n[(ez(t,e)-1)%n.length]}var t=[],n=[];return e.domain=function(n){return arguments.length?(t=lc(n),e):t.slice()},e.range=function(t){return arguments.length?(n=W$.call(t),e):n.slice()},e.tickFormat=function(){var e=qf().domain([t[0],f(t)]);return e.tickFormat.apply(e,arguments)},e.copy=function(){return sc().domain(e.domain()).range(e.range())},e}function fc(e){function t(){var e=a.domain();i=e[0],d=f(e)-i}function n(n){var a=(n-i)/d;return e(r?fS(0,iS(1,a)):a)}var a=qf(),i=0,d=1,r=!1;return n.clamp=function(e){return arguments.length?(r=!!e,n):r},n.domain=function(e){return arguments.length?(a.domain(e),t(),n):a.domain()},n.interpolator=function(t){return arguments.length?(e=t,n):e},n.copy=function(){return fc().domain(a.domain()).clamp(r).interpolator(e)},n.ticks=function(e){return a.ticks(e)},n.tickFormat=function(e,t){return a.tickFormat(e,t)},n.nice=function(e){return a.nice(e),t(),n},n}/**
   * Augment scales with their type and needed inverse methods.
   */function cc(e,t){return function(){var n=t();return n.invertRange||(n.invertRange=n.invert?Io(n):n.invertExtent?No(n):void 0),n.type=e,n}}function uc(e,t){return 1<arguments.length?(G$[e]=cc(e,t),this):G$.hasOwnProperty(e)?G$[e]:void 0}function pc(e,t){var n=t[0],a=f(t)-n;return function(t){return e(n+t*a)}}function gc(e,t,n){var a=n-t;return a&&isFinite(a)?'linear'===e.type||'sequential'===e.type?function(e){return(e-t)/a}:e.copy().domain([t,n]).range([0,1]).interpolate(mc):j(0)}function mc(e,t){return function(n){return e+n*(t-e)}}function hc(e,t){var n=O$[yc(e)];return null!=t&&n&&n.gamma?n.gamma(t):n}function yc(e){return'interpolate'+e.toLowerCase().split('-').map(function(e){return e[0].toUpperCase()+e.slice(1)}).join('')}function bc(e){for(var t=0|e.length/6,n=Array(t),a=0;a<t;)n[a]='#'+e.slice(6*a,6*++a);return n}function _c(e){for(var t=0|e.length/6,n=Array(t),a=0;a<t;)n[a]='#'+e.slice(6*a,6*++a);return n}function xc(e){return m$(e[e.length-1])}function vc(e){(0>e||1<e)&&(e-=sS(e));var n=lS(e-.5);return cT.h=360*e-100,cT.s=1.5-1.5*n,cT.l=.8-.9*n,cT+''}function kc(e){var n;return e=(.5-e)*aS,uT.r=255*(n=KE(e))*n,uT.g=255*(n=KE(e+pT))*n,uT.b=255*(n=KE(e+gT))*n,uT+''}function wc(e){var a=e.length;return function(n){return e[fS(0,iS(a-1,sS(n*a)))]}}function Ec(e,t){xT[e]=_T['interpolate'+t],_[e]=_T['scheme'+t]}// sequential single-hue
function Sc(e,t){if(1<arguments.length)return xT[e]=t,this;var n=e.split('-');return e=n[0],n=+n[1]+1,n&&_.hasOwnProperty(e)?_[e][n-1]:!n&&xT.hasOwnProperty(e)?xT[e]:void 0}function Cc(e){return vT.hasOwnProperty(e)&&vT[e]}function zc(e){return kT.hasOwnProperty(e)&&kT[e]}/**
   * Determine the tick count or interval function.
   * @param {Scale} scale - The scale for which to generate tick values.
   * @param {*} count - The desired tick count or interval specifier.
   * @return {*} - The tick count or interval function.
   */function Dc(e,t){var n;return g(t)&&(n=t.step,t=t.interval),m(t)&&(t='time'===e.type?Cc(t):'utc'===e.type?zc(t):u('Only time and utc scales accept interval strings.'),n&&(t=t.every(n))),t}/**
   * Filter a set of candidate tick values, ensuring that only tick values
   * that lie within the scale range are included.
   * @param {Scale} scale - The scale for which to generate tick values.
   * @param {Array<*>} ticks - The candidate tick values.
   * @param {*} count - The tick count or interval function.
   * @return {Array<*>} - The filtered tick values.
   */function Rc(e,t,n){var a=e.range(),i=a[0],d=f(a);if(i>d&&(a=d,d=i,i=a),t=t.filter(function(t){return t=e(t),!(t<i||t>d)}),0<n&&1<t.length){for(var r=[t[0],f(t)];t.length>n&&3<=t.length;)t=t.filter(function(e,t){return!(t%2)});3>t.length&&(t=r)}return t}/**
   * Generate tick values for the given scale and approximate tick count or
   * interval value. If the scale has a 'ticks' method, it will be used to
   * generate the ticks, with the count argument passed as a parameter. If the
   * scale lacks a 'ticks' method, the full scale domain will be returned.
   * @param {Scale} scale - The scale for which to generate tick values.
   * @param {*} [count] - The approximate number of desired ticks.
   * @return {Array<*>} - The generated tick values.
   */function $c(e,t){return e.ticks?e.ticks(t):e.domain()}/**
   * Generate a label format function for a scale. If the scale has a
   * 'tickFormat' method, it will be used to generate the formatter, with the
   * count and specifier arguments passed as parameters. If the scale lacks a
   * 'tickFormat' method, the returned formatter performs simple string coercion.
   * If the input scale is a logarithmic scale and the format specifier does not
   * indicate a desired decimal precision, a special variable precision formatter
   * that automatically trims trailing zeroes will be generated.
   * @param {Scale} scale - The scale for which to generate the label formatter.
   * @param {*} [count] - The approximate number of desired ticks.
   * @param {string} [specifier] - The format specifier. Must be a legal d3 4.0
   *   specifier string (see https://github.com/d3/d3-format#formatSpecifier).
   * @return {function(*):string} - The generated label formatter.
   */function Oc(e,t,n){var a=e.tickFormat?e.tickFormat(t,n):n?I$(n):String;return e.type==='log'?Tc(a,Ac(n)):a}function Tc(e,t){return function(n){return e(n)?t(n):''}}function Ac(e){var t=zf(e||',');if(null==t.precision){switch(t.precision=12,t.type){case'%':t.precision-=2;break;case'e':t.precision-=1;}return Lc(I$(t),// number format
I$('.1f')(1)[1]// decimal point character
)}return I$(t)}function Lc(e,t){return function(n){var a=e(n),i=a.indexOf(t),d,r;if(0>i)return a;for(d=Pc(a,i),r=d<a.length?a.slice(d):'';--d>i;)if('0'!==a[d]){++d;break}return a.slice(0,d)+r}}function Pc(e,t){var n=e.lastIndexOf('e'),a;if(0<n)return n;for(n=e.length;--n>t;)if(a=e.charCodeAt(n),48<=a&&57>=a)return n+1;// is digit
}/**
   * Generates axis ticks for visualizing a spatial scale.
   * @constructor
   * @param {object} params - The parameters for this operator.
   * @param {Scale} params.scale - The scale to generate ticks for.
   * @param {*} [params.count=10] - The approximate number of ticks, or
   *   desired tick interval, to use.
   * @param {Array<*>} [params.values] - The exact tick values to use.
   *   These must be legal domain values for the provided scale.
   *   If provided, the count argument is ignored.
   * @param {function(*):string} [params.formatSpecifier] - A format specifier
   *   to use in conjunction with scale.tickFormat. Legal values are
   *   any valid d3 4.0 format specifier.
   * @param {function(*):string} [params.format] - The format function to use.
   *   If provided, the formatSpecifier argument is ignored.
   */function Mc(e){Dn.call(this,null,e)}/**
   * Joins a set of data elements against a set of visual items.
   * @constructor
   * @param {object} params - The parameters for this operator.
   * @param {function(object): object} [params.item] - An item generator function.
   * @param {function(object): *} [params.key] - The key field associating data and visual items.
   */function Uc(e){Dn.call(this,null,e)}function jc(){return ce({})}function qc(e){return e.exit}/**
   * Invokes encoding functions for visual items.
   * @constructor
   * @param {object} params - The parameters to the encoding functions. This
   *   parameter object will be passed through to all invoked encoding functions.
   * @param {object} param.encoders - The encoding functions
   * @param {function(object, object): boolean} [param.encoders.update] - Update encoding set
   * @param {function(object, object): boolean} [param.encoders.enter] - Enter encoding set
   * @param {function(object, object): boolean} [param.encoders.exit] - Exit encoding set
   */function Fc(e){Dn.call(this,null,e)}function Ic(e,t){var n=CT[e.type];return n?n(e):$c(e,t)}function Nc(e){var t=e.domain(),a=t[0],d=f(t),r=e.range().length,n=Array(r),l=0;for(n[0]=-Infinity;++l<r;)n[l]=(l*d-(l-r)*a)/r;return n.max=+Infinity,n}function Bc(e){var t=[-Infinity].concat(e.quantiles());return t.max=+Infinity,t}function Wc(e){var t=[-Infinity].concat(e.domain());return t.max=+Infinity,t}function Gc(e){var t=e.domain();return t.max=t.pop(),t}function Yc(e,t,n){return n==='symbol'&&CT[e.type]?Hc(t):n==='discrete'?Vc(t):Xc(t)}function Hc(e){return function(t,n,a){var i=a[n+1]||a.max||+Infinity,d=Zc(t,e),r=Zc(i,e);return d&&r?d+'\u2013'+r:r?'< '+r:'\u2265 '+d}}function Vc(e){return function(t,n){return n?e(t):null}}function Xc(e){return function(t){return e(t)}}function Zc(e,t){return isFinite(e)?t(e):null}function Jc(e){var t=e.domain(),n=t.length-1,a=+t[0],i=+f(t),d=i-a;if(e.type==='threshold'){var r=n?d/n:.1;a-=r,i+=r,d=i-a}return function(e){return(e-a)/d}}/**
   * Generates legend entries for visualizing a scale.
   * @constructor
   * @param {object} params - The parameters for this operator.
   * @param {Scale} params.scale - The scale to generate items for.
   * @param {*} [params.count=5] - The approximate number of items, or
   *   desired tick interval, to use.
   * @param {Array<*>} [params.values] - The exact tick values to use.
   *   These must be legal domain values for the provided scale.
   *   If provided, the count argument is ignored.
   * @param {string} [params.formatSpecifier] - A format specifier
   *   to use in conjunction with scale.tickFormat. Legal values are
   *   any valid D3 format specifier string.
   * @param {function(*):string} [params.format] - The format function to use.
   *   If provided, the formatSpecifier argument is ignored.
   */function Qc(e){Dn.call(this,[],e)}function Kc(e){return e.source.x}function eu(e){return e.source.y}function tu(e){return e.target.x}function nu(e){return e.target.y}/**
    * Layout paths linking source and target elements.
    * @constructor
    * @param {object} params - The parameters for this operator.
    */function au(e){Dn.call(this,{},e)}// -- Link Path Generation Methods -----
function iu(e,t,n,a){return'M'+e+','+t+'L'+n+','+a}function du(e,t,n,a){var i=n-e,d=a-t,r=dS(i*i+d*d)/2,l=180*JE(d,i)/aS;return'M'+e+','+t+'A'+r+','+r+' '+l+' 0 1 '+n+','+a}function ru(e,t,n,a){var i=n-e,d=a-t,r=.2*(i+d),l=.2*(d-i);return'M'+e+','+t+'C'+(e+r)+','+(t+l)+' '+(n+l)+','+(a-r)+' '+n+','+a}/**
   * Pie and donut chart layout.
   * @constructor
   * @param {object} params - The parameters for this operator.
   * @param {function(object): *} params.field - The value field to size pie segments.
   * @param {number} [params.startAngle=0] - The start angle (in radians) of the layout.
   * @param {number} [params.endAngle=2] - The end angle (in radians) of the layout.
   * @param {boolean} [params.sort] - Boolean flag for sorting sectors by value.
   */function lu(e){Dn.call(this,null,e)}/**
   * Maintains a scale function mapping data values to visual channels.
   * @constructor
   * @param {object} params - The parameters for this operator.
   */function ou(e){Dn.call(this,null,e),this.modified(!0)}function su(e,t,a){// check raw domain, if provided use that and exit early
var i=fu(e,t.domainRaw,a);if(-1<i)return i;var d=t.domain,r=e.type,l=t.zero||void 0===t.zero&&OT[r],o,s;return d?(TT[r]&&t.padding&&d[0]!==f(d)&&(d=cu(r,d,t.range,t.padding,t.exponent)),(l||null!=t.domainMin||null!=t.domainMax||null!=t.domainMid)&&(o=(d=d.slice()).length-1||1,l&&(0<d[0]&&(d[0]=0),0>d[o]&&(d[o]=0)),null!=t.domainMin&&(d[0]=t.domainMin),null!=t.domainMax&&(d[o]=t.domainMax),null!=t.domainMid&&(s=t.domainMid,(s<d[0]||s>d[o])&&a.warn('Scale domainMid exceeds domain min or max.',s),d.splice(o,0,s))),e.domain(uu(r,d,a)),'ordinal'===r&&e.unknown(t.domainImplicit?VR:void 0),t.nice&&e.nice&&e.nice(!0!==t.nice&&Dc(e,t.nice)||null),d.length):0;// adjust continuous domain for minimum pixel padding
// return the cardinality of the domain
}function fu(e,t,n){return t?(e.domain(uu(e.type,t,n)),t.length):-1}function cu(e,t,n,a,i){var r=lS(f(n)-n[0]),l=r/(r-2*a),o='log'===e?T(t,null,l):'sqrt'===e?L(t,null,l,.5):'pow'===e?L(t,null,l,i):O(t,null,l);return t=t.slice(),t[0]=o[0],t[t.length-1]=o[1],t}function uu(e,t,n){if(e==='log'){// sum signs of domain values
// if all pos or all neg, abs(sum) === domain.length
var a=lS(t.reduce(function(e,t){return e+(0>t?-1:0<t?1:0)},0));a!==t.length&&n.warn('Log scale domain includes zero: '+h(t))}return t}function pu(e,t,n){var a=t.round||!1,i=t.range;// if range step specified, calculate full range extent
if(null!=t.rangeStep)i=gu(e.type,t,n);// else if a range scheme is defined, use that
else if(t.scheme){if(i=mu(e.type,t,n),M(i))return e.interpolator(i);// given a range array for a sequential scale, convert to interpolator
}else if(i&&'sequential'===e.type)return e.interpolator(m$(yu(i,t.reverse)));// configure rounding / interpolation
i&&t.interpolate&&e.interpolate?e.interpolate(hc(t.interpolate,t.interpolateGamma)):M(e.round)?e.round(a):M(e.rangeRound)&&e.interpolate(a?Ks:Qs),i&&e.range(yu(i,t.reverse))}function gu(e,t,n){e!=='band'&&e!=='point'&&u('Only band and point scales support rangeStep.');// calculate full range based on requested step size and padding
var a=(null==t.paddingOuter?t.padding:t.paddingOuter)||0,i=e==='point'?1:(null==t.paddingInner?t.padding:t.paddingInner)||0;return[0,t.rangeStep*Fo(n,i,a)]}function mu(e,t,n){var a=t.scheme.toLowerCase(),i=Sc(a),d=t.schemeExtent,r;// adjust and/or quantize scheme as appropriate
return i||u('Unrecognized scheme name: '+t.scheme),n='threshold'===e?n+1:'bin-ordinal'===e?n-1:'quantile'===e||'quantize'===e?+t.schemeCount||5:n,'sequential'===e?hu(i,d,t.reverse):!d&&(r=Sc(a+'-'+n))?r:M(i)?bu(hu(i,d),n):'ordinal'===e?i:i.slice(0,n)}function hu(e,t,n){return M(e)&&(t||n)?pc(e,yu(t||[0,1],n)):e}function yu(e,t){return t?e.slice().reverse():e}function bu(e,t){for(var n=Array(t),a=0;a<t;)n[a]=e(++a/(t+1));return n}/**
   * Sorts scenegraph items in the pulse source array.
   * @constructor
   * @param {object} params - The parameters for this operator.
   * @param {function(*,*): number} [params.sort] - A comparator
   *   function for sorting tuples.
   */function _u(e){Dn.call(this,null,e)}/**
   * Stack layout for visualization elements.
   * @constructor
   * @param {object} params - The parameters for this operator.
   * @param {function(object): *} params.field - The value field to stack.
   * @param {Array<function(object): *>} [params.groupby] - An array of accessors to groupby.
   * @param {function(object,object): number} [params.sort] - A comparator for stack sorting.
   * @param {string} [offset='zero'] - One of 'zero', 'center', 'normalize'.
   */function xu(e){Dn.call(this,null,e)}function vu(e,n,a,i,d){for(var r=(n-e.sum)/2,l=e.length,o=0,s;o<l;++o)s=e[o],s[i]=r,s[d]=r+=lS(a(s))}function ku(e,n,a,i,d){for(var r=1/e.sum,l=0,o=e.length,s=0,f=0,c;s<o;++s)c=e[s],c[i]=l,c[d]=l=r*(f+=lS(a(c)))}function wu(e,n,a,i,d){for(var r=0,l=0,o=e.length,s=0,f,c;s<o;++s)c=e[s],f=a(c),0>f?(c[i]=l,c[d]=l+=f):(c[i]=r,c[d]=r+=f)}function Eu(e,a,d,r){var l=[],o=function(e){return e(h)},f,c,u,p,h,y,b,_,x;// partition data points into stack groups
if(null==a)l.push(e.slice());else for(f={},c=0,u=e.length;c<u;++c)h=e[c],y=a.map(o),b=f[y],b||(f[y]=b=[],l.push(b)),b.push(h);// compute sums of groups, sort groups as needed
for(y=0,x=0,p=l.length;y<p;++y){for(b=l[y],c=0,_=0,u=b.length;c<u;++c)_+=lS(r(b[c]));b.sum=_,_>x&&(x=_),d&&b.sort(d)}return l.max=x,l}function Su(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Cu(e){return function(t,n){return Su(e(t),n)}}function zu(e,t){var a=e.length,n=-1,d,r,l;if(null==t){for(;++n<a;)// Find the first comparable value.
if(null!=(d=e[n])&&d>=d)for(r=l=d;++n<a;)// Compare the remaining values.
null!=(d=e[n])&&(r>d&&(r=d),l<d&&(l=d));}else for(;++n<a;)// Find the first comparable value.
if(null!=(d=t(e[n],n,e))&&d>=d)for(r=l=d;++n<a;)// Compare the remaining values.
null!=(d=t(e[n],n,e))&&(r>d&&(r=d),l<d&&(l=d));return[r,l]}function Du(e,t,a){e=+e,t=+t,a=2>(r=arguments.length)?(t=e,e=0,1):3>r?1:+a;for(var d=-1,r=0|fS(0,cS((t-e)/a)),l=Array(r);++d<r;)l[d]=e+d*a;return l}function Ru(e,t,n){var a=lS(t-e)/fS(0,n),i=pS(10,sS(gS(a)/rS)),d=a/i;return d>=FT?i*=10:d>=IT?i*=5:d>=NT&&(i*=2),t<e?-i:i}function $u(e){return cS(gS(e.length)/VE)+1}function Ou(e,t){var a=e.length,n=-1,d,r;if(null==t){for(;++n<a;)// Find the first comparable value.
if(null!=(d=e[n])&&d>=d)for(r=d;++n<a;)// Compare the remaining values.
null!=(d=e[n])&&d>r&&(r=d);}else for(;++n<a;)// Find the first comparable value.
if(null!=(d=t(e[n],n,e))&&d>=d)for(r=d;++n<a;)// Compare the remaining values.
null!=(d=t(e[n],n,e))&&d>r&&(r=d);return r}function Tu(e,t){return e-t}function Au(e){for(var t=0,a=e.length,n=e[a-1][1]*e[0][0]-e[a-1][0]*e[0][1];++t<a;)n+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return n}function Lu(e){return function(){return e}}function Pu(e,t){for(var a=-1,d=t.length,n;++a<d;)if(n=Mu(e,t[a]))return n;return 0}function Mu(e,t){for(var a=t[0],d=t[1],r=-1,l=0,o=e.length,n=o-1;l<o;n=l++){var s=e[l],f=s[0],c=s[1],u=e[n],p=u[0],g=u[1];if(Uu(s,u,t))return 0;c>d!=g>d&&a<(p-f)*(d-c)/(g-c)+f&&(r=-r)}return r}function Uu(e,t,n){var a;return ju(e,t,n)&&qu(e[a=+(e[0]===t[0])],n[a],t[a])}function ju(e,t,n){return(t[0]-e[0])*(n[1]-e[1])==(n[0]-e[0])*(t[1]-e[1])}function qu(e,t,n){return e<=t&&t<=n||n<=t&&t<=e}function Fu(){}function Iu(){function e(e){var n=l(e);// Convert number of thresholds into uniform thresholds.
if(!Array.isArray(n)){var a=zu(e),i=a[0],d=a[1];n=Ru(i,d,n),n=Du(sS(i/n)*n,sS(d/n)*n,n)}else n=n.slice().sort(Tu);return n.map(function(n){return t(e,n)})}// Accumulate, smooth contour rings, assign holes to exterior rings.
// Based on https://github.com/mbostock/shapefile/blob/v0.6.2/shp/polygon.js
function t(e,t){var a=[],i=[];return n(e,t,function(n){o(n,e,t),0<Au(n)?a.push([n]):i.push(n)}),i.forEach(function(e){for(var t=0,d=a.length,n;t<d;++t)if(-1!==Pu((n=a[t])[0],e))return void n.push(e)}),{type:'MultiPolygon',value:t,coordinates:a}}// Marching squares with isolines stitched into rings.
// Based on https://github.com/topojson/topojson-client/blob/v3.0.0/src/stitch.js
function n(e,t,n){function i(e){var t=[e[0][0]+s,e[0][1]+c],i=[e[1][0]+s,e[1][1]+c],d=a(t),r=a(i),u,p;(u=o[d])?(p=l[r])?(delete o[u.end],delete l[p.start],u===p?(u.ring.push(i),n(u.ring)):l[u.start]=o[p.end]={start:u.start,end:p.end,ring:u.ring.concat(p.ring)}):(delete o[u.end],u.ring.push(i),o[u.end=r]=u):(u=l[r])?(p=o[d])?(delete l[u.start],delete o[p.end],u===p?(u.ring.push(i),n(u.ring)):l[p.start]=o[u.end]={start:p.start,end:u.end,ring:p.ring.concat(u.ring)}):(delete l[u.start],u.ring.unshift(t),l[u.start=d]=u):l[d]=o[r]={start:d,end:r,ring:[t,i]}}var l=[],o=[],s,c,f,u,p,g;// Special case for the first row (y = -1, t2 = t3 = 0).
for(s=c=-1,u=e[0]>=t,GT[u<<1].forEach(i);++s<d-1;)f=u,u=e[s+1]>=t,GT[f|u<<1].forEach(i);// General case for the intermediate rows.
for(GT[u<<0].forEach(i);++c<r-1;){for(s=-1,u=e[c*d+d]>=t,p=e[c*d]>=t,GT[u<<1|p<<2].forEach(i);++s<d-1;)f=u,u=e[c*d+d+s+1]>=t,g=p,p=e[c*d+s+1]>=t,GT[f|u<<1|p<<2|g<<3].forEach(i);GT[u|p<<3].forEach(i)}// Special case for the last row (y = dy - 1, t0 = t1 = 0).
for(s=-1,p=e[c*d]>=t,GT[p<<2].forEach(i);++s<d-1;)g=p,p=e[c*d+s+1]>=t,GT[p<<2|g<<3].forEach(i);GT[p<<3].forEach(i)}function a(e){return 2*e[0]+4*(e[1]*(d+1))}function i(e,t,n){e.forEach(function(e){var a=e[0],i=e[1],l=0|a,o=0|i,s=t[o*d+l],f;0<a&&a<d&&l===a&&(f=t[o*d+l-1],e[0]=a+(n-f)/(s-f)-.5),0<i&&i<r&&o===i&&(f=t[(o-1)*d+l],e[1]=i+(n-f)/(s-f)-.5)})}var d=1,r=1,l=$u,o=i;return e.contour=t,e.size=function(t){if(!arguments.length)return[d,r];var n=cS(t[0]),a=cS(t[1]);if(!(0<n)||!(0<a))throw new Error('invalid size');return d=n,r=a,e},e.thresholds=function(t){return arguments.length?(l='function'==typeof t?t:Array.isArray(t)?Lu(WT.call(t)):Lu(t),e):l},e.smooth=function(t){return arguments.length?(o=t?i:Fu,e):o===i},e}// TODO Optimize edge cases.
// TODO Optimize index calculation.
// TODO Optimize arguments.
function Nu(e,t,a){for(var d=e.width,n=e.height,r=(a<<1)+1,l=0;l<n;++l)for(var o=0,s=0;o<d+a;++o)o<d&&(s+=e.data[o+l*d]),o>=a&&(o>=r&&(s-=e.data[o-r+l*d]),t.data[o-a+l*d]=s/iS(o+1,d-1+r-o,r))}// TODO Optimize edge cases.
// TODO Optimize index calculation.
// TODO Optimize arguments.
function Bu(e,t,a){for(var d=e.width,n=e.height,r=(a<<1)+1,l=0;l<d;++l)for(var o=0,s=0;o<n+a;++o)o<n&&(s+=e.data[l+o*d]),o>=a&&(o>=r&&(s-=e.data[l+(o-r)*d]),t.data[l+(o-a)*d]=s/iS(o+1,n-1+r-o,r))}function Wu(e){return e[0]}function Gu(e){return e[1]}function Yu(){return 1}function Hu(){function e(e){var n=new Float32Array(_*v),a=new Float32Array(_*v);e.forEach(function(e,t,a){var i=+s(e,t,a)+b>>h,d=+f(e,t,a)+b>>h,r=+c(e,t,a);0<=i&&i<_&&0<=d&&d<v&&(n[i+d*_]+=r)}),Nu({width:_,height:v,data:n},{width:_,height:v,data:a},g>>h),Bu({width:_,height:v,data:a},{width:_,height:v,data:n},g>>h),Nu({width:_,height:v,data:n},{width:_,height:v,data:a},g>>h),Bu({width:_,height:v,data:a},{width:_,height:v,data:n},g>>h),Nu({width:_,height:v,data:n},{width:_,height:v,data:a},g>>h),Bu({width:_,height:v,data:a},{width:_,height:v,data:n},g>>h);var i=w(n);// Convert number of thresholds into uniform thresholds.
if(!Array.isArray(i)){var d=Ou(n);i=Ru(0,d,i),i=Du(0,sS(d/i)*i,i),i.shift()}return Iu().thresholds(i).size([_,v])(n).map(t)}function t(e){return e.value*=pS(2,-2*h),e.coordinates.forEach(a),e}function a(e){e.forEach(i)}function i(e){e.forEach(d)}// TODO Optimize.
function d(e){e[0]=e[0]*pS(2,h)-b,e[1]=e[1]*pS(2,h)-b}function l(){return b=3*g,_=u+2*b>>h,v=p+2*b>>h,e}var s=Wu,f=Gu,c=Yu,u=960,p=500,g=20,// blur radius
h=2,// log2(grid cell size)
b=3*g,// grid offset, to pad for blur
_=u+2*b>>h,// grid width
v=p+2*b>>h,// grid height
w=Lu(20);return e.x=function(t){return arguments.length?(s='function'==typeof t?t:Lu(+t),e):s},e.y=function(t){return arguments.length?(f='function'==typeof t?t:Lu(+t),e):f},e.weight=function(t){return arguments.length?(c='function'==typeof t?t:Lu(+t),e):c},e.size=function(e){if(!arguments.length)return[u,p];var t=cS(e[0]),n=cS(e[1]);if(!(0<=t)&&!(0<=t))throw new Error('invalid size');return u=t,p=n,l()},e.cellSize=function(e){if(!arguments.length)return 1<<h;if(!(1<=(e=+e)))throw new Error('invalid cell size');return h=sS(gS(e)/VE),l()},e.thresholds=function(t){return arguments.length?(w='function'==typeof t?t:Array.isArray(t)?Lu(WT.call(t)):Lu(t),e):w},e.bandwidth=function(e){if(!arguments.length)return dS(g*(g+1));if(!(0<=(e=+e)))throw new Error('invalid bandwidth');return g=oS((dS(4*e*e+1)-1)/2),l()},e}/**
   * Generate contours based on kernel-density estimation of point data.
   * @constructor
   * @param {object} params - The parameters for this operator.
   * @param {Array<number>} params.size - The dimensions [width, height] over which to compute contours.
   *  If the values parameter is provided, this must be the dimensions of the input data.
   *  If density estimation is performed, this is the output view dimensions in pixels.
   * @param {Array<number>} [params.values] - An array of numeric values representing an
   *  width x height grid of values over which to compute contours. If unspecified, this
   *  transform will instead attempt to compute contours for the kernel density estimate
   *  using values drawn from data tuples in the input pulse.
   * @param {function(object): number} [params.x] - The pixel x-coordinate accessor for density estimation.
   * @param {function(object): number} [params.y] - The pixel y-coordinate accessor for density estimation.
   * @param {function(object): number} [params.weight] - The data point weight accessor for density estimation.
   * @param {number} [params.cellSize] - Contour density calculation cell size.
   * @param {number} [params.bandwidth] - Kernel density estimation bandwidth.
   * @param {Array<number>} [params.thresholds] - Contour threshold array. If
   *   this parameter is set, the count and nice parameters will be ignored.
   * @param {number} [params.count] - The desired number of contours.
   * @param {boolean} [params.nice] - Boolean flag indicating if the contour
   *   threshold values should be automatically aligned to "nice"
   *   human-friendly values. Setting this flag may cause the number of
   *   thresholds to deviate from the specified count.
   * @param {boolean} [params.smooth] - Boolean flag indicating if the contour
   *   polygons should be smoothed using linear interpolation. The default is
   *   true. The parameter is ignored when using density estimation.
   */function Vu(e){Dn.call(this,null,e)}function Xu(e){return function(n){for(var a=Yn(n),d=a[0],r=a[1]-d,l=[],t=1;t<=e;++t)l.push(d+r*t/(e+1));return l}}/**
   * Consolidate an array of [longitude, latitude] points or GeoJSON features
   * into a combined GeoJSON object. This transform is particularly useful for
   * combining geo data for a Projection's fit argument. The resulting GeoJSON
   * data is available as this transform's value. Input pulses are unchanged.
   * @constructor
   * @param {object} params - The parameters for this operator.
   * @param {Array<function(object): *>} [params.fields] - A two-element array
   *   of field accessors for the longitude and latitude values.
   * @param {function(object): *} params.geojson - A field accessor for
   *   retrieving GeoJSON feature data.
   */function Zu(e){Dn.call(this,null,e)}// Adds floating point numbers with twice the normal precision.
// Reference: J. R. Shewchuk, Adaptive Precision Floating-Point Arithmetic and
// Fast Robust Geometric Predicates, Discrete & Computational Geometry 18(3)
// 305363 (1997).
// Code adapted from GeographicLib by Charles F. F. Karney,
// http://geographiclib.sourceforge.net/
function Ju(){return new Qu}function Qu(){this.reset()}function Ku(e,t,n){var a=e.s=t+n,i=a-t;e.t=t-(a-i)+(n-i)}function ep(e){return 1<e?0:-1>e?KT:tS(e)}function tp(e){return 1<e?eA:-1>e?-eA:eS(e)}function np(){}function ap(e,t){e&&bA.hasOwnProperty(e.type)&&bA[e.type](e,t)}function ip(e,t,a){var d=-1,r=e.length-a,n;for(t.lineStart();++d<r;)n=e[d],t.point(n[0],n[1],n[2]);t.lineEnd()}function dp(e,t){var a=-1,d=e.length;for(t.polygonStart();++a<d;)ip(e[a],t,1);t.polygonEnd()}function rp(e,t){e&&yA.hasOwnProperty(e.type)?yA[e.type](e,t):ap(e,t)}function lp(){vA.point=sp}function op(){fp(SA,CA)}function sp(e,t){vA.point=fp,SA=e,CA=t,e*=iA,t*=iA,zA=e,DA=oA(t=t/2+tA),RA=pA(t)}function fp(e,t){e*=iA,t*=iA,t=t/2+tA;// half the angular distance from south pole
// Spherical excess E for a spherical triangle with vertices: south pole,
// previous point, current point.  Uses a formula derived from Cagnolis
// theorem.  See Todhunter, Spherical Trig. (1871), Sec. 103, Eq. (2).
var n=e-zA,a=0<=n?1:-1,i=a*n,d=oA(t),r=pA(t),l=RA*r,o=DA*d+l*oA(i),s=l*a*pA(i);// Advance the previous points.
_A.add(lA(s,o)),zA=e,DA=d,RA=r}function cp(e){return[lA(e[1],e[0]),tp(e[2])]}function up(e){var t=e[0],n=e[1],a=oA(n);return[a*oA(t),a*pA(t),pA(n)]}function pp(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function gp(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}// TODO return a
function mp(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function hp(e,t){return[e[0]*t,e[1]*t,e[2]*t]}// TODO return d
function yp(e){var t=mA(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function bp(e,t){jA.push(qA=[$A=e,TA=e]),t<OA&&(OA=t),t>AA&&(AA=t)}function _p(e,t){var n=up([e*iA,t*iA]);if(UA){var a=gp(UA,n),i=[a[1],-a[0],0],d=gp(i,a);yp(d),d=cp(d);var r=e-LA,l=0<r?1:-1,o=d[0]*aA*l,s=180<dA(r),f;s^(l*LA<o&&o<l*e)?(f=d[1]*aA,f>AA&&(AA=f)):(o=(o+360)%360-180,s^(l*LA<o&&o<l*e))?(f=-d[1]*aA,f<OA&&(OA=f)):(t<OA&&(OA=t),t>AA&&(AA=t)),s?e<LA?Sp($A,e)>Sp($A,TA)&&(TA=e):Sp(e,TA)>Sp($A,TA)&&($A=e):TA>=$A?(e<$A&&($A=e),e>TA&&(TA=e)):e>LA?Sp($A,e)>Sp($A,TA)&&(TA=e):Sp(e,TA)>Sp($A,TA)&&($A=e)}else jA.push(qA=[$A=e,TA=e]);t<OA&&(OA=t),t>AA&&(AA=t),UA=n,LA=e}function xp(){wA.point=_p}function vp(){qA[0]=$A,qA[1]=TA,wA.point=bp,UA=null}function kp(e,t){if(UA){var n=e-LA;kA.add(180<dA(n)?n+(0<n?360:-360):n)}else PA=e,MA=t;vA.point(e,t),_p(e,t)}function wp(){vA.lineStart()}function Ep(){kp(PA,MA),vA.lineEnd(),dA(kA)>JT&&($A=-(TA=180)),qA[0]=$A,qA[1]=TA,UA=null}// Finds the left-right distance between two longitudes.
// This is almost the same as (lambda1 - lambda0 + 360) % 360, except that we want
// the distance between 180 to be 360.
function Sp(e,t){return 0>(t-=e)?t+360:t}function Cp(e,t){return e[0]-t[0]}function zp(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}function Dp(e){var t,d,r,l,o,s,f;// First, sort ranges by their minimum longitudes.
if(AA=TA=-($A=OA=1/0),jA=[],rp(e,wA),d=jA.length){// Then, merge any ranges that overlap.
for(jA.sort(Cp),t=1,r=jA[0],o=[r];t<d;++t)l=jA[t],zp(r,l[0])||zp(r,l[1])?(Sp(r[0],l[1])>Sp(r[0],r[1])&&(r[1]=l[1]),Sp(l[0],r[1])>Sp(r[0],r[1])&&(r[0]=l[0])):o.push(r=l);// Finally, find the largest gap between the merged ranges.
// The final bounding box will be the inverse of this gap.
for(s=-Infinity,d=o.length-1,t=0,r=o[d];t<=d;r=l,++t)l=o[t],(f=Sp(r[1],l[0]))>s&&(s=f,$A=l[0],TA=r[1])}return jA=qA=null,$A===1/0||OA==1/0?[[NaN,NaN],[NaN,NaN]]:[[$A,OA],[TA,AA]]}// Arithmetic mean of Cartesian vectors.
function Rp(e,t){e*=iA,t*=iA;var n=oA(t);$p(n*oA(e),n*pA(e),pA(t))}function $p(e,t,n){++FA,NA+=(e-NA)/FA,BA+=(t-BA)/FA,WA+=(n-WA)/FA}function Op(){EA.point=Tp}function Tp(e,t){e*=iA,t*=iA;var n=oA(t);KA=n*oA(e),eL=n*pA(e),tL=pA(t),EA.point=Ap,$p(KA,eL,tL)}function Ap(e,t){e*=iA,t*=iA;var n=oA(t),a=n*oA(e),i=n*pA(e),d=pA(t),r=lA(mA((r=eL*d-tL*i)*r+(r=tL*a-KA*d)*r+(r=KA*i-eL*a)*r),KA*a+eL*i+tL*d);IA+=r,GA+=r*(KA+(KA=a)),YA+=r*(eL+(eL=i)),HA+=r*(tL+(tL=d)),$p(KA,eL,tL)}function Lp(){EA.point=Rp}// See J. E. Brock, The Inertia Tensor for a Spherical Triangle,
// J. Applied Mechanics 42, 239 (1975).
function Pp(){EA.point=Up}function Mp(){jp(JA,QA),EA.point=Rp}function Up(e,t){JA=e,QA=t,e*=iA,t*=iA,EA.point=jp;var n=oA(t);KA=n*oA(e),eL=n*pA(e),tL=pA(t),$p(KA,eL,tL)}function jp(e,t){e*=iA,t*=iA;var n=oA(t),a=n*oA(e),i=n*pA(e),d=pA(t),r=eL*d-tL*i,l=tL*a-KA*d,o=KA*i-eL*a,s=mA(r*r+l*l+o*o),f=tp(s),// line weight = angle
c=s&&-f/s;// area weight multiplier
VA+=c*r,XA+=c*l,ZA+=c*o,IA+=f,GA+=f*(KA+(KA=a)),YA+=f*(eL+(eL=i)),HA+=f*(tL+(tL=d)),$p(KA,eL,tL)}function qp(e){FA=IA=NA=BA=WA=GA=YA=HA=VA=XA=ZA=0,rp(e,EA);var t=VA,n=XA,a=ZA,i=t*t+n*n+a*a;// If the area-weighted ccentroid is undefined, fall back to length-weighted ccentroid.
return i<QT&&(t=GA,n=YA,a=HA,IA<JT&&(t=NA,n=BA,a=WA),i=t*t+n*n+a*a,i<QT)?[NaN,NaN]:[lA(n,t)*aA,tp(a/mA(i))*aA]}function Fp(e,t){function n(n,a){return n=e(n,a),t(n[0],n[1])}return e.invert&&t.invert&&(n.invert=function(n,a){return n=t.invert(n,a),n&&e.invert(n[0],n[1])}),n}function Ip(e,t){return[dA(e)>KT?e+oS(-e/nA)*nA:e,t]}function Np(e,t,n){return(e%=nA)?t||n?Fp(Wp(e),Gp(t,n)):Wp(e):t||n?Gp(t,n):Ip}function Bp(e){return function(t,n){return t+=e,[t>KT?t-nA:t<-KT?t+nA:t,n]}}function Wp(e){var t=Bp(e);return t.invert=Bp(-e),t}function Gp(e,t){function n(e,t){var n=oA(t),l=oA(e)*n,o=pA(e)*n,s=pA(t),f=s*a+l*i;return[lA(o*d-f*r,l*a-s*i),tp(f*d+o*r)]}var a=oA(e),i=pA(e),d=oA(t),r=pA(t);return n.invert=function(e,t){var n=oA(t),l=oA(e)*n,o=pA(e)*n,s=pA(t),f=s*d-o*r;return[lA(o*d+s*r,l*a+f*i),tp(f*a-l*i)]},n}function Yp(e){function t(t){return t=e(t[0]*iA,t[1]*iA),t[0]*=aA,t[1]*=aA,t}return e=Np(e[0]*iA,e[1]*iA,2<e.length?e[2]*iA:0),t.invert=function(t){return t=e.invert(t[0]*iA,t[1]*iA),t[0]*=aA,t[1]*=aA,t},t}// Generates a circle centered at [0, 0], with a given radius and precision.
function Hp(e,n,a,i,d,r){if(a){var l=oA(n),o=pA(n),s=i*a;null==d?(d=n+i*nA,r=n-s/2):(d=Vp(l,d),r=Vp(l,r),(0<i?d<r:d>r)&&(d+=i*nA));for(var f=d,c;0<i?f>r:f<r;f-=s)c=cp([l,-o*oA(f),-o*pA(f)]),e.point(c[0],c[1])}}// Returns the signed angle of a cartesian point relative to [cosRadius, 0, 0].
function Vp(e,t){t=up(t),t[0]-=e,yp(t);var n=ep(-t[1]);return((0>-t[2]?-n:n)+nA-JT)%nA}function Xp(){var e=[],t;return{point:function(e,n){t.push([e,n])},lineStart:function(){e.push(t=[])},lineEnd:np,rejoin:function(){1<e.length&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function Zp(e,t){return dA(e[0]-t[0])<JT&&dA(e[1]-t[1])<JT}function Jp(e,t,n,a){// another intersection
// is an entry?
// visited
this.x=e,this.z=t,this.o=n,this.e=a,this.v=!1,this.n=this.p=null}// A generalized polygon clipping algorithm: given a polygon that has been cut
// into its visible line segments, and rejoins the segments by interpolating
// along the clip edge.
function Qp(e,t,a,d,r){var l=[],o=[],s,f;if(e.forEach(function(e){if(!(0>=(i=e.length-1))){var t=e[0],a=e[i],i,d;// If the first and last points of a segment are coincident, then treat as a
// closed ring. TODO if all rings are closed, then the winding order of the
// exterior ring should be checked.
if(Zp(t,a)){for(r.lineStart(),s=0;s<i;++s)r.point((t=e[s])[0],t[1]);return void r.lineEnd()}l.push(d=new Jp(t,e,null,!0)),o.push(d.o=new Jp(t,null,d,!1)),l.push(d=new Jp(a,e,null,!1)),o.push(d.o=new Jp(a,null,d,!0))}}),!!l.length){for(o.sort(t),Kp(l),Kp(o),(s=0,f=o.length);s<f;++s)o[s].e=a=!a;for(var c=l[0],u,p;;){for(// Find first unvisited intersection.
var g=c,m=!0;g.v;)if((g=g.n)===c)return;u=g.z,r.lineStart();do{if(g.v=g.o.v=!0,g.e){if(m)for(s=0,f=u.length;s<f;++s)r.point((p=u[s])[0],p[1]);else d(g.x,g.n.x,1,r);g=g.n}else{if(m)for(u=g.p.z,s=u.length-1;0<=s;--s)r.point((p=u[s])[0],p[1]);else d(g.x,g.p.x,-1,r);g=g.p}g=g.o,u=g.z,m=!m}while(!g.v);r.lineEnd()}}}function Kp(e){if(r=e.length){for(var t=0,d=e[0],r,l;++t<r;)d.n=l=e[t],l.p=d,d=l;d.n=l=e[0],l.p=d}}function eg(e,t){var a=t[0],d=t[1],r=pA(d),l=[pA(a),-oA(a),0],o=0,s=0;nL.reset(),1===r?d=eA+JT:-1===r&&(d=-eA-JT);for(var f=0,c=e.length;f<c;++f)if(_=(b=e[f]).length)for(var n=b[_-1],u=n[0],p=n[1]/2+tA,g=pA(p),h=oA(p),y=0,b,_;y<_;++y,u=v,g=E,h=S,n=x){var x=b[y],v=x[0],w=x[1]/2+tA,E=pA(w),S=oA(w),C=v-u,z=0<=C?1:-1,D=z*C,R=D>KT,$=g*E;// Are the longitudes either side of the points meridian (lambda),
// and are the latitudes smaller than the parallel (phi)?
if(nL.add(lA($*z*pA(D),h*S+$*oA(D))),o+=R?C+z*nA:C,R^u>=a^v>=a){var k=gp(up(n),up(x));yp(k);var O=gp(l,k);yp(O);var T=(R^0<=C?-1:1)*tp(O[2]);(d>T||d===T&&(k[0]||k[1]))&&(s+=R^0<=C?1:-1)}}// First, determine whether the South pole is inside or outside:
//
// It is inside if:
// * the polygon winds around it in a clockwise direction.
// * the polygon does not (cumulatively) wind around it, but has a negative
//   (counter-clockwise) area.
//
// Second, count the (signed) number of times a segment crosses a lambda
// from the point to the South pole.  If it is zero, then the point is the
// same side as the South pole.
return(o<-JT||o<JT&&nL<-JT)^1&s}function tg(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function ng(e){return function(t,n){return tg(e(t),n)}}function ag(e,t,a){e=+e,t=+t,a=2>(r=arguments.length)?(t=e,e=0,1):3>r?1:+a;for(var d=-1,r=0|fS(0,cS((t-e)/a)),l=Array(r);++d<r;)l[d]=e+d*a;return l}function ig(e){for(var t=e.length,a=-1,d=0,r,l,o;++a<t;)d+=e[a].length;for(l=Array(d);0<=--t;)for(o=e[t],r=o.length;0<=--r;)l[--d]=o[r];return l}function dg(e,t,n,a){return function(d){function r(t,n){e(t,n)&&d.point(t,n)}function l(e,t){p.point(e,t)}function o(){b.point=l,p.lineStart()}function s(){b.point=r,p.lineEnd()}function f(e,t){v.push([e,t]),h.point(e,t)}function c(){h.lineStart(),v=[]}function u(){f(v[0][0],v[0][1]),h.lineEnd();var e=h.clean(),t=g.result(),a=t.length,n,r,l,o;if(v.pop(),_.push(v),v=null,!!a){// No intersections.
if(1&e){if(l=t[0],0<(r=l.length-1)){for(y||(d.polygonStart(),y=!0),d.lineStart(),n=0;n<r;++n)d.point((o=l[n])[0],o[1]);d.lineEnd()}return}// Rejoin connected segments.
// TODO reuse ringBuffer.rejoin()?
1<a&&2&e&&t.push(t.pop().concat(t.shift())),x.push(t.filter(rg))}}var p=t(d),g=Xp(),h=t(g),y=!1,b={point:r,lineStart:o,lineEnd:s,polygonStart:function(){b.point=f,b.lineStart=c,b.lineEnd=u,x=[],_=[]},polygonEnd:function(){b.point=r,b.lineStart=o,b.lineEnd=s,x=ig(x);var e=eg(_,a);x.length?(!y&&(d.polygonStart(),y=!0),Qp(x,lg,e,n,d)):e&&(!y&&(d.polygonStart(),y=!0),d.lineStart(),n(null,null,1,d),d.lineEnd()),y&&(d.polygonEnd(),y=!1),x=_=null},sphere:function(){d.polygonStart(),d.lineStart(),n(null,null,1,d),d.lineEnd(),d.polygonEnd()}},_,x,v;return b}}function rg(e){return 1<e.length}// Intersections are sorted along the clip edge. For both antimeridian cutting
// and circle clipping, the same comparison is used.
function lg(e,t){return(0>(e=e.x)[0]?e[1]-eA-JT:eA-e[1])-(0>(t=t.x)[0]?t[1]-eA-JT:eA-t[1])}// Takes a line and cuts into visible segments. Return values: 0 - there were
// intersections or the line was empty; 1 - no intersections; 2 - there were
// intersections, and the first and last segments should be rejoined.
function og(e,t,n,a){var i=pA(e-n),d,r;return dA(i)>JT?rA((pA(t)*(r=oA(a))*pA(n)-pA(a)*(d=oA(t))*pA(e))/(d*r*i)):(t+a)/2}function sg(e){function n(e,t){return oA(e)*oA(t)>d}// Takes a line and cuts into visible segments. Return values used for polygon
// clipping: 0 - there were intersections or the line was empty; 1 - no
// intersections 2 - there were intersections, and the first and last segments
// should be rejoined.
// TODO optimise for this common case
// Intersects the great circle between a and b with the clip circle.
function a(e,n,a){var i=up(e),r=up(n),l=[1,0,0],// normal
o=gp(i,r),s=pp(o,o),f=o[0],// cartesianDot(n1, n2),
c=s-f*f;// We have two planes, n1.p = d1 and n2.p = d2.
// Find intersection line p(t) = c1 n1 + c2 n2 + t (n1  n2).
// Two polar points.
if(!c)return!a&&e;var p=gp(l,o),g=hp(l,d*s/c),m=hp(o,-d*f/c);mp(g,m);// Solve |p(t)|^2 = 1.
var h=p,u=pp(g,h),y=pp(h,h),b=u*u-y*(pp(g,g)-1);if(!(0>b)){var _=mA(b),t=hp(h,(-u-_)/y);if(mp(t,g),t=cp(t),!a)return t;// Two intersection points.
var x=e[0],v=n[0],k=e[1],w=n[1],E;v<x&&(E=x,x=v,v=E);var S=v-x,C=dA(S-KT)<JT;// Check that the first point is between a and b.
if(!C&&w<k&&(E=k,k=w,w=E),C||S<JT?C?0<k+w^t[1]<(dA(t[0]-x)<JT?k:w):k<=t[1]&&t[1]<=w:S>KT^(x<=t[0]&&t[0]<=v)){var D=hp(h,(-u+_)/y);return mp(D,g),[t,cp(D)]}}}// Generates a 4-bit vector representing the location of a point relative to
// the small circle's bounding box.
function i(t,n){var a=l?e:KT-e,i=0;// above
return t<-a?i|=1:t>a&&(i|=2),n<-a?i|=4:n>a&&(i|=8),i}var d=oA(e),l=0<d,o=dA(d)>JT;return dg(n,function(e){var d,// previous point
r,// code for previous point
s,// visibility of previous point
f,// visibility of first point
u;// no intersections
return{lineStart:function(){f=s=!1,u=1},point:function(p,g){var m=[p,g],h=n(p,g),y=l?h?0:i(p,g):h?i(p+(0>p?KT:-KT),g):0,c;if(!d&&(f=s=h)&&e.lineStart(),h!==s&&(c=a(d,m),(!c||Zp(d,c)||Zp(m,c))&&(m[0]+=JT,m[1]+=JT,h=n(m[0],m[1]))),h!==s)u=0,h?(e.lineStart(),c=a(m,d),e.point(c[0],c[1])):(c=a(d,m),e.point(c[0],c[1]),e.lineEnd()),d=c;else if(o&&d&&l^h){var b;// If the codes for two points are different, or are both zero,
// and there this segment intersects with the small circle.
!(y&r)&&(b=a(m,d,!0))&&(u=0,l?(e.lineStart(),e.point(b[0][0],b[0][1]),e.point(b[1][0],b[1][1]),e.lineEnd()):(e.point(b[1][0],b[1][1]),e.lineEnd(),e.lineStart(),e.point(b[0][0],b[0][1])))}!h||d&&Zp(d,m)||e.point(m[0],m[1]),d=m,s=h,r=y},lineEnd:function(){s&&e.lineEnd(),d=null},// Rejoin first and last segments if there were intersections and the first
// and last points were visible.
clean:function(){return u|(f&&s)<<1}}},function(t,n,a,i){Hp(i,e,6*iA,a,t,n)},l?[0,-e]:[-KT,e-KT])}function fg(e,t,n,a,i,d){var l=e[0],o=e[1],s=t[0],f=t[1],c=0,u=1,p=s-l,g=f-o,m;if(m=n-l,p||!(0<m)){if(m/=p,0>p){if(m<c)return;m<u&&(u=m)}else if(0<p){if(m>u)return;m>c&&(c=m)}if(m=i-l,p||!(0>m)){if(m/=p,0>p){if(m>u)return;m>c&&(c=m)}else if(0<p){if(m<c)return;m<u&&(u=m)}if(m=a-o,g||!(0<m)){if(m/=g,0>g){if(m<c)return;m<u&&(u=m)}else if(0<g){if(m>u)return;m>c&&(c=m)}if(m=d-o,g||!(0>m)){if(m/=g,0>g){if(m>u)return;m>c&&(c=m)}else if(0<g){if(m<c)return;m<u&&(u=m)}return 0<c&&(e[0]=l+c*p,e[1]=o+c*g),1>u&&(t[0]=l+u*p,t[1]=o+u*g),!0}}}}}// TODO Use d3-polygons polygonContains here for the ring check?
// TODO Eliminate duplicate buffering in clipBuffer and polygon.push?
function cg(e,t,n,d){function i(a,i){return e<=a&&a<=n&&t<=i&&i<=d}function r(i,r,o,f){var c=0,u=0;if(null==i||(c=l(i,o))!==(u=l(r,o))||0>s(i,r)^0<o)do f.point(0===c||3===c?e:n,1<c?d:t);while((c=(c+o+4)%4)!==u);else f.point(r[0],r[1])}function l(a,i){return dA(a[0]-e)<JT?0<i?0:3:dA(a[0]-n)<JT?0<i?2:1:dA(a[1]-t)<JT?0<i?1:0:0<i?3:2;// abs(p[1] - y1) < epsilon
}function o(e,t){return s(e.x,t.x)}function s(e,t){var n=l(e,1),a=l(t,1);return n===a?0===n?t[1]-e[1]:1===n?e[0]-t[0]:2===n?e[1]-t[1]:t[0]-e[0]:n-a}return function(a){function l(e,t){i(e,t)&&g.point(e,t)}function s(){for(var t=0,a=0,r=_.length;a<r;++a)for(var n=_[a],l=1,o=n.length,s=n[0],f=s[0],c=s[1],u,p;l<o;++l)u=f,p=c,s=n[l],f=s[0],c=s[1],p<=d?c>d&&(f-u)*(d-p)>(c-p)*(e-u)&&++t:c<=d&&(f-u)*(d-p)<(c-p)*(e-u)&&--t;return t}// Buffer geometry within a polygon and then clip it en masse.
function f(){var e=s(),t=$&&e,n=(y=ig(y)).length;(t||n)&&(a.polygonStart(),t&&(a.lineStart(),r(null,null,1,a),a.lineEnd()),n&&Qp(y,o,e,r,a),a.polygonEnd()),g=a,y=_=k=null}function c(){h.point=p,_&&_.push(k=[]),R=!0,D=!1,C=z=NaN}// TODO rather than special-case polygons, simply handle them separately.
// Ideally, coincident intersection points should be jittered to avoid
// clipping issues.
function u(){y&&(p(w,E),S&&D&&m.rejoin(),y.push(m.result())),h.point=l,D&&g.lineEnd()}function p(r,l){var o=i(r,l);if(_&&k.push([r,l]),R)w=r,E=l,S=o,R=!1,o&&(g.lineStart(),g.point(r,l));else if(o&&D)g.point(r,l);else{var s=[C=fS(-1000000000,iS(1000000000,C)),z=fS(-1000000000,iS(1000000000,z))],a=[r=fS(-1000000000,iS(1000000000,r)),l=fS(-1000000000,iS(1000000000,l))];fg(s,a,e,t,n,d)?(!D&&(g.lineStart(),g.point(s[0],s[1])),g.point(a[0],a[1]),!o&&g.lineEnd(),$=!1):o&&(g.lineStart(),g.point(r,l),$=!1)}C=r,z=l,D=o}var g=a,m=Xp(),h={point:l,lineStart:c,lineEnd:u,polygonStart:function(){g=m,y=[],_=[],$=!0},polygonEnd:f},y,_,k,w,E,S,// first point
C,z,D,// previous point
R,$;return h}}function ug(e,t,n){var a=ag(e,t-JT,n).concat(t);return function(e){return a.map(function(t){return[e,t]})}}function pg(e,t,n){var a=ag(e,t-JT,n).concat(t);return function(e){return a.map(function(t){return[t,e]})}}function gg(){function e(){return{type:'MultiLineString',coordinates:t()}}function t(){return ag(sA(f/i)*i,s,i).map(b).concat(ag(sA(g/d)*d,p,d).map(v)).concat(ag(sA(o/n)*n,l,n).filter(function(e){return dA(e%i)>JT}).map(m)).concat(ag(sA(u/a)*a,c,a).filter(function(e){return dA(e%d)>JT}).map(h))}var n=10,a=n,i=90,d=360,r=2.5,l,o,s,f,c,u,p,g,m,h,b,v;return e.lines=function(){return t().map(function(e){return{type:'LineString',coordinates:e}})},e.outline=function(){return{type:'Polygon',coordinates:[b(f).concat(v(p).slice(1),b(s).reverse().slice(1),v(g).reverse().slice(1))]}},e.extent=function(t){return arguments.length?e.extentMajor(t).extentMinor(t):e.extentMinor()},e.extentMajor=function(t){return arguments.length?(f=+t[0][0],s=+t[1][0],g=+t[0][1],p=+t[1][1],f>s&&(t=f,f=s,s=t),g>p&&(t=g,g=p,p=t),e.precision(r)):[[f,g],[s,p]]},e.extentMinor=function(t){return arguments.length?(o=+t[0][0],l=+t[1][0],u=+t[0][1],c=+t[1][1],o>l&&(t=o,o=l,l=t),u>c&&(t=u,u=c,c=t),e.precision(r)):[[o,u],[l,c]]},e.step=function(t){return arguments.length?e.stepMajor(t).stepMinor(t):e.stepMinor()},e.stepMajor=function(t){return arguments.length?(i=+t[0],d=+t[1],e):[i,d]},e.stepMinor=function(t){return arguments.length?(n=+t[0],a=+t[1],e):[n,a]},e.precision=function(t){return arguments.length?(r=+t,m=ug(u,c,90),h=pg(o,l,r),b=ug(g,p,90),v=pg(f,s,r),e):r},e.extentMajor([[-180,-90+JT],[180,90-JT]]).extentMinor([[-180,-80-JT],[180,80+JT]])}function mg(e){return e}function hg(){oL.point=yg}function yg(e,t){oL.point=bg,EL=CL=e,SL=zL=t}function bg(e,t){lL.add(zL*e-CL*t),CL=e,zL=t}function _g(){bg(EL,SL)}function xg(e,t){e<sL&&(sL=e),e>cL&&(cL=e),t<fL&&(fL=t),t>uL&&(uL=t)}// TODO Enforce positive area for exterior, negative area for interior?
function vg(e,t){gL+=e,mL+=t,++hL}function kg(){wL.point=wg}function wg(e,t){wL.point=Eg,vg($L=e,OL=t)}function Eg(e,t){var n=e-$L,a=t-OL,i=mA(n*n+a*a);yL+=i*($L+e)/2,bL+=i*(OL+t)/2,_L+=i,vg($L=e,OL=t)}function Sg(){wL.point=vg}function Cg(){wL.point=Dg}function zg(){Rg(DL,RL)}function Dg(e,t){wL.point=Rg,vg(DL=$L=e,RL=OL=t)}function Rg(e,t){var n=e-$L,a=t-OL,i=mA(n*n+a*a);yL+=i*($L+e)/2,bL+=i*(OL+t)/2,_L+=i,i=OL*e-$L*t,xL+=i*($L+e),vL+=i*(OL+t),kL+=3*i,vg($L=e,OL=t)}function $g(e){this._context=e}function Og(e,t){AL.point=Tg,PL=UL=e,ML=jL=t}function Tg(e,t){UL-=e,jL-=t,TL.add(mA(UL*UL+jL*jL)),UL=e,jL=t}function Ag(){this._string=[]}function Lg(e){return'm0,'+e+'a'+e+','+e+' 0 1,1 0,'+-2*e+'a'+e+','+e+' 0 1,1 0,'+2*e+'z'}function Pg(e,t){function n(e){return e&&('function'==typeof a&&d.pointRadius(+a.apply(this,arguments)),rp(e,i(d))),d.result()}var a=4.5,i,d;return n.area=function(e){return rp(e,i(oL)),oL.result()},n.measure=function(e){return rp(e,i(AL)),AL.result()},n.bounds=function(e){return rp(e,i(pL)),pL.result()},n.centroid=function(e){return rp(e,i(wL)),wL.result()},n.projection=function(t){return arguments.length?(i=null==t?(e=null,mg):(e=t).stream,n):e},n.context=function(e){return arguments.length?(d=null==e?(t=null,new Ag):new $g(t=e),'function'!=typeof a&&d.pointRadius(a),n):t},n.pointRadius=function(e){return arguments.length?(a='function'==typeof e?e:(d.pointRadius(+e),+e),n):a},n.projection(e).context(t)}function Mg(e){return function(t){var n=new Ug;for(var a in e)n[a]=e[a];return n.stream=t,n}}function Ug(){}function jg(e,t,n){var a=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),null!=a&&e.clipExtent(null),rp(n,e.stream(pL)),t(pL.result()),null!=a&&e.clipExtent(a),e}function qg(e,t,n){return jg(e,function(n){var a=t[1][0]-t[0][0],i=t[1][1]-t[0][1],d=iS(a/(n[1][0]-n[0][0]),i/(n[1][1]-n[0][1])),r=+t[0][0]+(a-d*(n[1][0]+n[0][0]))/2,l=+t[0][1]+(i-d*(n[1][1]+n[0][1]))/2;e.scale(150*d).translate([r,l])},n)}function Fg(e,t,n){return qg(e,[[0,0],t],n)}function Ig(e,t,n){return jg(e,function(n){var a=+t,i=a/(n[1][0]-n[0][0]),d=(a-i*(n[1][0]+n[0][0]))/2,r=-i*n[0][1];e.scale(150*i).translate([d,r])},n)}function Ng(e,t,n){return jg(e,function(n){var a=+t,i=a/(n[1][1]-n[0][1]),d=-i*n[0][0],r=(a-i*(n[1][1]+n[0][1]))/2;e.scale(150*i).translate([d,r])},n)}// cos(minimum angular distance)
function Bg(e,t){return+t?Gg(e,t):Wg(e)}function Wg(e){return Mg({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function Gg(e,t){function n(i,d,r,l,o,s,f,u,g,h,y,_,x,v){var k=f-i,w=u-d,E=k*k+w*w;if(E>4*t&&x--){var S=l+h,C=o+y,z=s+_,D=mA(S*S+C*C+z*z),m=tp(z/=D),R=dA(dA(z)-1)<JT||dA(r-g)<JT?(r+g)/2:lA(C,S),$=e(R,m),p=$[0],O=$[1],T=p-i,A=O-d,L=w*T-k*A;(L*L/E>t// perpendicular projected distance
||.3<dA((k*T+w*A)/E-.5)// midpoint close to an end
||l*h+o*y+s*_<qL)&&(n(i,d,r,l,o,s,p,O,R,S/=D,C/=D,z,x,v),v.point(p,O),n(p,O,R,S,C,z,f,u,g,h,y,_,x,v))}}return function(t){function a(n,a){n=e(n,a),t.point(n[0],n[1])}function i(){b=NaN,f.point=d,t.lineStart()}function d(a,i){var d=up([a,i]),r=e(a,i);n(b,_,y,x,v,k,b=r[0],_=r[1],y=a,x=d[0],v=d[1],k=d[2],16,t),t.point(b,_)}function r(){f.point=a,t.lineEnd()}function l(){i(),f.point=o,f.lineEnd=s}function o(e,t){d(c=e,t),u=b,p=_,g=x,m=v,h=k,f.point=d}function s(){n(b,_,y,x,v,k,u,p,c,g,m,h,16,t),f.lineEnd=r,r()}var f={point:a,lineStart:i,lineEnd:r,polygonStart:function(){t.polygonStart(),f.lineStart=l},polygonEnd:function(){t.polygonEnd(),f.lineStart=i}},c,u,p,g,m,h,// first point
y,b,_,x,v,k;// previous point
return f}}function Yg(e){return Mg({point:function(t,n){var a=e(t,n);return this.stream.point(a[0],a[1])}})}function Hg(e,t,n){function a(a,i){return[t+e*a,n-e*i]}return a.invert=function(a,i){return[(a-t)/e,(n-i)/e]},a}function Vg(e,t,n,i){function d(e,i){return[o*e-a*i+t,n-a*e-o*i]}var r=oA(i),l=pA(i),o=r*e,a=l*e,s=r/e,f=l/e;return d.invert=function(a,i){return[s*a-f*i+(l*n-r*t)/e,(l*t+r*n)/e-f*a-s*i]},d}function Xg(e){return Zg(function(){return e})()}function Zg(e){function t(e){return $(e[0]*iA,e[1]*iA)}function n(e){return e=$.invert(e[0],e[1]),e&&[e[0]*aA,e[1]*aA]}function a(){var e=Vg(d,0,0,p).apply(null,w(o,s)),t=(p?Vg:Hg)(d,r-e[0],l-e[1],p);return E=Np(f,c,u),R=Fp(w,t),$=Fp(E,R),D=Bg(R,v),i()}function i(){return O=T=null,t}var d=150,// scale
r=480,l=250,// translate
o=0,s=0,// center
f=0,c=0,u=0,// pre-rotate
p=0,// post-rotate
g=null,m=iL,// pre-clip angle
h=null,b=mg,// post-clip extent
v=.5,w,E,S,C,z,// precision
D,R,$,O,T;return t.stream=function(e){return O&&T===e?O:O=FL(Yg(E)(m(D(b(T=e)))))},t.preclip=function(e){return arguments.length?(m=e,g=void 0,i()):m},t.postclip=function(e){return arguments.length?(b=e,h=S=C=z=null,i()):b},t.clipAngle=function(e){return arguments.length?(m=+e?sg(g=e*iA):(g=null,iL),i()):g*aA},t.clipExtent=function(e){return arguments.length?(b=null==e?(h=S=C=z=null,mg):cg(h=+e[0][0],S=+e[0][1],C=+e[1][0],z=+e[1][1]),i()):null==h?null:[[h,S],[C,z]]},t.scale=function(e){return arguments.length?(d=+e,a()):d},t.translate=function(e){return arguments.length?(r=+e[0],l=+e[1],a()):[r,l]},t.center=function(e){return arguments.length?(o=e[0]%360*iA,s=e[1]%360*iA,a()):[o*aA,s*aA]},t.rotate=function(e){return arguments.length?(f=e[0]%360*iA,c=e[1]%360*iA,u=2<e.length?e[2]%360*iA:0,a()):[f*aA,c*aA,u*aA]},t.angle=function(e){return arguments.length?(p=e%360*iA,a()):p*aA},t.precision=function(e){return arguments.length?(D=Bg(R,v=e*e),i()):mA(v)},t.fitExtent=function(e,n){return qg(t,e,n)},t.fitSize=function(e,n){return Fg(t,e,n)},t.fitWidth=function(e,n){return Ig(t,e,n)},t.fitHeight=function(e,n){return Ng(t,e,n)},function(){return w=e.apply(this,arguments),t.invert=w.invert&&n,a()}}function Jg(e){var t=0,n=KT/3,a=Zg(e),i=a(t,n);return i.parallels=function(e){return arguments.length?a(t=e[0]*iA,n=e[1]*iA):[t*aA,n*aA]},i}function Qg(e){function t(e,t){return[e*n,pA(t)/n]}var n=oA(e);return t.invert=function(e,t){return[e/n,tp(t*n)]},t}function Kg(e,t){function a(e,t){var a=mA(n-2*d*pA(t))/d;return[a*pA(e*=d),l-a*oA(e)]}var i=pA(e),d=(i+pA(t))/2;// Are the parallels symmetrical around the Equator?
if(dA(d)<JT)return Qg(e);var n=1+i*(2*d-i),l=mA(n)/d;return a.invert=function(e,t){var a=l-t;return[lA(e,dA(a))/d*gA(a),tp((n-(e*e+a*a)*d*d)/(2*d))]},a}function em(){return Jg(Kg).scale(155.424).center([0,33.6442])}function tm(){return em().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}// The projections must have mutually exclusive clip regions on the sphere,
// as this will avoid emitting interleaving lines and polygons.
function nm(e){var t=e.length;return{point:function(n,a){for(var d=-1;++d<t;)e[d].point(n,a)},sphere:function(){for(var n=-1;++n<t;)e[n].sphere()},lineStart:function(){for(var n=-1;++n<t;)e[n].lineStart()},lineEnd:function(){for(var n=-1;++n<t;)e[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<t;)e[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<t;)e[n].polygonEnd()}}}// A composite projection for the United States, configured by default for
// 960500. The projection also works quite well at 960600 if you change the
// scale to 1285 and adjust the translate accordingly. The set of standard
// parallels for each region comes from USGS, which is published here:
// http://egsc.usgs.gov/isb/pubs/MapProjections/projections.html#albers
function am(e){return function(t,n){var a=oA(t),i=oA(n),d=e(a*i);return[d*i*pA(t),d*pA(n)]}}function im(e){return function(t,n){var a=mA(t*t+n*n),i=e(a),d=pA(i),r=oA(i);return[lA(t*d,a*r),tp(a&&n*d/a)]}}function dm(e,t){return[e,cA(hA((eA+t)/2))]}function rm(e){function t(){var a=KT*i(),d=n(Yp(n.rotate()).invert([0,0]));return r(null==l?[[d[0]-a,d[1]-a],[d[0]+a,d[1]+a]]:e===dm?[[fS(d[0]-a,l),o],[iS(d[0]+a,s),f]]:[[l,fS(d[1]-a,o)],[s,iS(d[1]+a,f)]])}var n=Xg(e),a=n.center,i=n.scale,d=n.translate,r=n.clipExtent,l=null,o,s,f;// clip extent
return n.scale=function(e){return arguments.length?(i(e),t()):i()},n.translate=function(e){return arguments.length?(d(e),t()):d()},n.center=function(e){return arguments.length?(a(e),t()):a()},n.clipExtent=function(e){return arguments.length?(null==e?l=o=s=f=null:(l=+e[0][0],o=+e[0][1],s=+e[1][0],f=+e[1][1]),t()):null==l?null:[[l,o],[s,f]]},t()}function lm(e){return hA((eA+e)/2)}function om(e,t){function a(e,t){0<n?t<-eA+JT&&(t=-eA+JT):t>eA-JT&&(t=eA-JT);var a=n/uA(lm(t),d);return[a*pA(d*e),n-a*oA(d*e)]}var i=oA(e),d=e===t?pA(e):cA(i/oA(t))/cA(lm(t)/lm(e)),n=i*uA(lm(e),d)/d;return d?(a.invert=function(e,t){var a=n-t,i=gA(d)*mA(e*e+a*a);return[lA(e,dA(a))/d*gA(a),2*rA(uA(n/i,1/d))-eA]},a):dm}function sm(e,t){return[e,t]}function fm(e,t){function a(e,t){var a=n-t,i=d*e;return[a*pA(i),n-a*oA(i)]}var i=oA(e),d=e===t?pA(e):(i-oA(t))/(t-e),n=i/d+e;return dA(d)<JT?sm:(a.invert=function(e,t){var a=n-t;return[lA(e,dA(a))/d*gA(a),n-gA(d)*mA(e*e+a*a)]},a)}function cm(e,t){var n=oA(t),a=oA(e)*n;return[n*pA(e)/a,pA(t)/a]}function um(e,t,n,a){return 1===e&&1===t&&0===n&&0===a?mg:Mg({point:function(i,d){this.stream.point(i*e+n,d*t+a)}})}function pm(e,t){var n=t*t,a=n*n;return[e*(.8707-.131979*n+a*(-.013791+a*(.003971*n-.001529*a))),t*(1.007226+n*(.015085+a*(-.044475+.028874*n-.005916*a)))]}function gm(e,t){return[oA(t)*pA(e),pA(t)]}function mm(e,t){var n=oA(t),a=1+oA(e)*n;return[n*pA(e)/a,pA(t)/a]}function hm(e,t){return[cA(hA((eA+t)/2)),-e]}/**
   * Augment projections with their type and a copy method.
   */function ym(e,t){return function n(){var a=t();return a.type=e,a.path=Pg().projection(a),a.copy=a.copy||function(){var e=n();return WL.forEach(function(t){a.hasOwnProperty(t)&&e[t](a[t]())}),e.path.pointRadius(a.path.pointRadius()),e},a}}function bm(e,t){if(!e||'string'!=typeof e)throw new Error('Projection type must be a name string.');return e=e.toLowerCase(),1<arguments.length?(GL[e]=ym(e,t),this):GL.hasOwnProperty(e)?GL[e]:null}function _m(e){return e&&e.path||BL}/**
   * Map GeoJSON data to an SVG path string.
   * @constructor
   * @param {object} params - The parameters for this operator.
   * @param {function(number, number): *} params.projection - The cartographic
   *   projection to apply.
   * @param {function(object): *} [params.field] - The field with GeoJSON data,
   *   or null if the tuple itself is a GeoJSON feature.
   * @param {string} [params.as='path'] - The output field in which to store
   *   the generated path data (default 'path').
   */function xm(e){Dn.call(this,null,e)}function vm(e,t){var n=e.pointRadius();return e.context(null),null!=t&&e.pointRadius(t),n}/**
   * Geo-code a longitude/latitude point to an x/y coordinate.
   * @constructor
   * @param {object} params - The parameters for this operator.
   * @param {function(number, number): *} params.projection - The cartographic
   *   projection to apply.
   * @param {Array<function(object): *>} params.fields - A two-element array of
   *   field accessors for the longitude and latitude values.
   * @param {Array<string>} [params.as] - A two-element array of field names
   *   under which to store the result. Defaults to ['x','y'].
   */function km(e){Dn.call(this,null,e)}/**
   * Annotate items with a geopath shape generator.
   * @constructor
   * @param {object} params - The parameters for this operator.
   * @param {function(number, number): *} params.projection - The cartographic
   *   projection to apply.
   * @param {function(object): *} [params.field] - The field with GeoJSON data,
   *   or null if the tuple itself is a GeoJSON feature.
   * @param {string} [params.as='shape'] - The output field in which to store
   *   the generated path data (default 'shape').
   */function wm(e){Dn.call(this,null,e)}function Em(e,t,n){var a=null==n?function(n){return e(t(n))}:function(a){var i=e.pointRadius(),d=e.pointRadius(n)(t(a));return e.pointRadius(i),d};return a.context=function(t){return e.context(t),a},a}/**
   * GeoJSON feature generator for creating graticules.
   * @constructor
   */function Sm(e){Dn.call(this,[],e),this.generator=gg()}/**
   * Maintains a cartographic projection.
   * @constructor
   * @param {object} params - The parameters for this operator.
   */function Cm(e){Dn.call(this,null,e),this.modified(!0)}function zm(e,t){var n=$m(t.fit);t.extent?e.fitExtent(t.extent,n):t.size?e.fitSize(t.size,n):0}function Dm(e){var t=bm((e||'mercator').toLowerCase());return t||u('Unrecognized projection type: '+e),t()}function Rm(e,t,n){M(e[t])&&e[t](n)}function $m(e){return e=P(e),1===e.length?e[0]:{type:'FeatureCollection',features:e.reduce(function(e,t){return t&&'FeatureCollection'===t.type?e.push.apply(e,t.features):hS(t)?e.push.apply(e,t):e.push(t),e},[])}}function Om(e){return function(){return e}}function Tm(){return 1e-6*(Math.random()-.5)}function Am(e,t,n,a){if(isNaN(t)||isNaN(n))return e;// ignore invalid points
var d=e._root,r={data:a},l=e._x0,o=e._y0,s=e._x1,f=e._y1,c,u,p,g,m,h,y,b,_;// If the tree is empty, initialize the root as a leaf.
if(!d)return e._root=r,e;// Find the existing leaf for the new point, or add it.
for(;d.length;)if((h=t>=(u=(l+s)/2))?l=u:s=u,(y=n>=(p=(o+f)/2))?o=p:f=p,(c=d,!(d=d[b=y<<1|h])))return c[b]=r,e;// Is the new point is exactly coincident with the existing point?
if(g=+e._x.call(null,d.data),m=+e._y.call(null,d.data),t===g&&n===m)return r.next=d,c?c[b]=r:e._root=r,e;// Otherwise, split the leaf node until the old and new point are separated.
do c=c?c[b]=[,,,,]:e._root=[,,,,],(h=t>=(u=(l+s)/2))?l=u:s=u,(y=n>=(p=(o+f)/2))?o=p:f=p;while((b=y<<1|h)==(_=(m>=p)<<1|g>=u));return c[_]=d,c[b]=r,e}function Lm(e){var t=e.length,n=Array(t),a=Array(t),r=1/0,l=1/0,o=-Infinity,s=-Infinity,f,c,u,p;// Compute the points and their extent.
for(c=0;c<t;++c)isNaN(u=+this._x.call(null,f=e[c]))||isNaN(p=+this._y.call(null,f))||(n[c]=u,a[c]=p,u<r&&(r=u),u>o&&(o=u),p<l&&(l=p),p>s&&(s=p));// If there were no (valid) points, inherit the existing extent.
// Add the new points.
for(o<r&&(r=this._x0,o=this._x1),s<l&&(l=this._y0,s=this._y1),this.cover(r,l).cover(o,s),c=0;c<t;++c)Am(this,n[c],a[c],e[c]);return this}function Pm(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;// ignore invalid points
var n=this._x0,a=this._y0,d=this._x1,r=this._y1;// If the quadtree has no extent, initialize them.
// Integer extent are necessary so that if we later double the extent,
// the existing quadrant boundaries dont change due to floating point error!
if(isNaN(n))d=(n=sS(e))+1,r=(a=sS(t))+1;// Otherwise, double repeatedly to cover.
else if(n>e||e>d||a>t||t>r){var l=d-n,o=this._root,s,f;switch(f=(t<(a+r)/2)<<1|e<(n+d)/2){case 0:{do s=[,,,,],s[f]=o,o=s;while((l*=2,d=n+l,r=a+l,e>d||t>r));break}case 1:{do s=[,,,,],s[f]=o,o=s;while((l*=2,n=d-l,r=a+l,n>e||t>r));break}case 2:{do s=[,,,,],s[f]=o,o=s;while((l*=2,d=n+l,a=r-l,e>d||a>t));break}case 3:{do s=[,,,,],s[f]=o,o=s;while((l*=2,n=d-l,a=r-l,n>e||a>t));break}}this._root&&this._root.length&&(this._root=o)}// If the quadtree covers the point already, just return.
else return this;return this._x0=n,this._y0=a,this._x1=d,this._y1=r,this}function Mm(e,t,n,a,i){this.node=e,this.x0=t,this.y0=n,this.x1=a,this.y1=i}function Um(e,t,n){var a=this._x0,r=this._y0,l=this._x1,o=this._y1,s=[],f=this._root,c,u,p,g,m,h,y;for(f&&s.push(new Mm(f,a,r,l,o)),null==n?n=1/0:(a=e-n,r=t-n,l=e+n,o=t+n,n*=n);h=s.pop();)// Stop searching if this quadrant cant contain a closer node.
if(!(!(f=h.node)||(u=h.x0)>l||(p=h.y0)>o||(g=h.x1)<a||(m=h.y1)<r))// Bisect the current quadrant.
if(f.length){var b=(u+g)/2,_=(p+m)/2;s.push(new Mm(f[3],b,_,g,m),new Mm(f[2],u,_,b,m),new Mm(f[1],b,p,g,_),new Mm(f[0],u,p,b,_)),(y=(t>=_)<<1|e>=b)&&(h=s[s.length-1],s[s.length-1]=s[s.length-1-y],s[s.length-1-y]=h)}// Visit this point. (Visiting coincident points isnt necessary!)
else{var x=e-+this._x.call(null,f.data),v=t-+this._y.call(null,f.data),k=x*x+v*v;if(k<n){var w=dS(n=k);a=e-w,r=t-w,l=e+w,o=t+w,c=f.data}}return c}function jm(e){if(isNaN(c=+this._x.call(null,e))||isNaN(u=+this._y.call(null,e)))return this;// ignore invalid points
var t=this._root,n=this._x0,a=this._y0,d=this._x1,r=this._y1,l,o,s,f,c,u,p,g,m,h,b,_;// If the tree is empty, initialize the root as a leaf.
if(!t)return this;// Find the leaf node for the point.
// While descending, also retain the deepest parent with a non-removed sibling.
if(t.length)for(;;){if((m=c>=(p=(n+d)/2))?n=p:d=p,(h=u>=(g=(a+r)/2))?a=g:r=g,(l=t,!(t=t[b=h<<1|m])))return this;if(!t.length)break;(l[3&b+1]||l[3&b+2]||l[3&b+3])&&(o=l,_=b)}// Find the point to remove.
for(;t.data!==e;)if(s=t,!(t=t.next))return this;// If there are multiple coincident points, remove just the point.
// Remove this leaf.
return((f=t.next)&&delete t.next,s)?(f?s.next=f:delete s.next,this):l?(f?l[b]=f:delete l[b],(t=l[0]||l[1]||l[2]||l[3])&&t===(l[3]||l[2]||l[1]||l[0])&&!t.length&&(o?o[_]=t:this._root=t),this):(this._root=f,this);// If this is the root point, remove it.
}function qm(e){var t=[],n=this._root,a,i,d,r,l,o;for(n&&t.push(new Mm(n,this._x0,this._y0,this._x1,this._y1));a=t.pop();)if(!e(n=a.node,d=a.x0,r=a.y0,l=a.x1,o=a.y1)&&n.length){var s=(d+l)/2,f=(r+o)/2;(i=n[3])&&t.push(new Mm(i,s,f,l,o)),(i=n[2])&&t.push(new Mm(i,d,f,s,o)),(i=n[1])&&t.push(new Mm(i,s,r,l,f)),(i=n[0])&&t.push(new Mm(i,d,r,s,f))}return this}function Fm(e){var t=[],n=[],a;for(this._root&&t.push(new Mm(this._root,this._x0,this._y0,this._x1,this._y1));a=t.pop();){var i=a.node;if(i.length){var d=a.x0,r=a.y0,l=a.x1,o=a.y1,s=(d+l)/2,f=(r+o)/2,c;(c=i[0])&&t.push(new Mm(c,d,r,s,f)),(c=i[1])&&t.push(new Mm(c,s,r,l,f)),(c=i[2])&&t.push(new Mm(c,d,f,s,o)),(c=i[3])&&t.push(new Mm(c,s,f,l,o))}n.push(a)}for(;a=n.pop();)e(a.node,a.x0,a.y0,a.x1,a.y1);return this}function Im(e){return e[0]}function Nm(e){return e[1]}function Bm(e,t,n){var a=new Wm(null==t?Im:t,null==n?Nm:n,NaN,NaN,NaN,NaN);return null==e?a:a.addAll(e)}function Wm(e,t,n,a,i,d){this._x=e,this._y=t,this._x0=n,this._y0=a,this._x1=i,this._y1=d,this._root=void 0}function Gm(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}function Ym(e){return e.x+e.vx}function Hm(e){return e.y+e.vy}function Vm(e){return e.index}function Xm(e,t){var n=e.get(t);if(!n)throw new Error('missing: '+t);return n}function Zm(){for(var e=0,a=arguments.length,n={},d;e<a;++e){if(!(d=arguments[e]+'')||d in n)throw new Error('illegal type: '+d);n[d]=[]}return new Jm(n)}function Jm(e){this._=e}function Qm(e,n){return e.trim().split(/^|\s+/).map(function(e){var a='',d=e.indexOf('.');if(0<=d&&(a=e.slice(d+1),e=e.slice(0,d)),e&&!n.hasOwnProperty(e))throw new Error('unknown type: '+e);return{type:e,name:a}})}function Km(e,t){for(var a=0,d=e.length,n;a<d;++a)if((n=e[a]).name===t)return n.value}function eh(e,t,a){for(var d=0,r=e.length;d<r;++d)if(e[d].name===t){e[d]=eP,e=e.slice(0,d).concat(e.slice(d+1));break}return null!=a&&e.push({name:t,value:a}),e}function th(){return dP||(oP(nh),dP=lP.now()+rP)}function nh(){dP=0}function ah(){this._call=this._time=this._next=null}function ih(e,n,a){var i=new ah;return i.restart(e,n,a),i}function dh(){th(),++tP;// Pretend weve set an alarm, if we havent already.
for(var n=sP,a;n;)0<=(a=dP-n._time)&&n._call.call(null,a),n=n._next;--tP}function rh(){dP=(iP=lP.now())+rP,tP=nP=0;try{dh()}finally{tP=0,oh(),dP=0}}function lh(){var e=lP.now(),t=e-iP;t>1000&&(rP-=t,iP=e)}function oh(){for(var e=sP,t=1/0,n,a;e;)e._call?(t>e._time&&(t=e._time),n=e,e=e._next):(a=e._next,e._next=null,e=n?n._next=a:sP=a);fP=n,sh(t)}function sh(e){if(!tP){nP&&(nP=clearTimeout(nP));var t=e-dP;// Strictly less than if we recomputed clockNow.
24<t?(e<1/0&&(nP=setTimeout(rh,e-lP.now()-rP)),aP&&(aP=clearInterval(aP))):(!aP&&(iP=lP.now(),aP=setInterval(lh,1000)),tP=1,oP(rh))}// Soonest alarm already set, or will be.
}function fh(e,n,a){var i=new ah,t=n;return null==n?(i.restart(e,n,a),i):(n=+n,a=null==a?th():+a,i.restart(function d(r){r+=t,i.restart(d,t+=n,a),e(r)},n,a),i)}function ch(e){return e.x}function uh(e){return e.y}function ph(e){function t(){n(),u.call('tick',p),d<r&&(c.stop(),u.call('end',p))}function n(){var t=e.length,n,a;for(d+=(o-d)*l,f.each(function(e){e(d)}),n=0;n<t;++n)a=e[n],null==a.fx?a.x+=a.vx*=s:(a.x=a.fx,a.vx=0),null==a.fy?a.y+=a.vy*=s:(a.y=a.fy,a.vy=0)}function a(){for(var t=0,a=e.length,n;t<a;++t){if(n=e[t],n.index=t,isNaN(n.x)||isNaN(n.y)){var d=10*dS(t),r=t*cP;n.x=d*QE(r),n.y=d*KE(r)}(isNaN(n.vx)||isNaN(n.vy))&&(n.vx=n.vy=0)}}function i(t){return t.initialize&&t.initialize(e),t}var d=1,r=.001,l=1-pS(r,1/300),o=0,s=.6,f=Qo(),c=ih(t),u=Zm('tick','end'),p;return null==e&&(e=[]),a(),p={tick:n,restart:function(){return c.restart(t),p},stop:function(){return c.stop(),p},nodes:function(t){return arguments.length?(e=t,a(),f.each(i),p):e},alpha:function(e){return arguments.length?(d=+e,p):d},alphaMin:function(e){return arguments.length?(r=+e,p):r},alphaDecay:function(e){return arguments.length?(l=+e,p):+l},alphaTarget:function(e){return arguments.length?(o=+e,p):o},velocityDecay:function(e){return arguments.length?(s=1-e,p):1-s},force:function(e,t){return 1<arguments.length?(null==t?f.remove(e):f.set(e,i(t)),p):f.get(e)},find:function(t,a,d){var r=0,l=e.length,n,o,s,f,c;for(null==d?d=1/0:d*=d,r=0;r<l;++r)f=e[r],n=t-f.x,o=a-f.y,s=n*n+o*o,s<d&&(c=f,d=s);return c},on:function(e,t){return 1<arguments.length?(u.on(e,t),p):u.on(e)}}}/**
   * Force simulation layout.
   * @constructor
   * @param {object} params - The parameters for this operator.
   * @param {Array<object>} params.forces - The forces to apply.
   */function gh(e){Dn.call(this,null,e)}function mh(e,t){return function(){e.touch(t).run()}}function hh(e,t){var n=ph(e),a=!1,i=n.stop,d=n.restart;return n.stopped=function(){return a},n.restart=function(){return a=!1,d()},n.stop=function(){return a=!0,i()},yh(n,t,!0).on('end',function(){a=!0})}function yh(e,t,a,d){var r=P(t.forces),l,o,s,f;for(l=0,o=pP.length;l<o;++l)s=pP[l],'forces'!==s&&t.modified(s)&&e[s](t[s]);for(l=0,o=r.length;l<o;++l)f='forces'+l,s=a||t.modified('forces',l)?_h(r[l]):d&&bh(r[l],d)?e.force(f):null,s&&e.force(f,s);for(o=e.numForces||0;l<o;++l)e.force('forces'+l,null);// remove
return e.numForces=r.length,e}function bh(e,t){var n,a;for(n in e)if(M(a=e[n])&&t.modified(s(a)))return 1;return 0}function _h(e){var t,n;for(n in uP.hasOwnProperty(e.force)||u('Unrecognized force: '+e.force),t=uP[e.force](),e)M(t[n])&&xh(t[n],e[n],e);return t}function xh(e,t,n){e(M(t)?function(e){return t(e,n)}:t)}// Build lookup table mapping tuple keys to tree node instances
function vh(e,n,a){var i={};return e.each(function(e){var d=e.data;a(d)&&(i[n(d)]=e)}),e.lookup=i,e}function kh(e,t){return e.parent===t.parent?1:2}function wh(e){return e.reduce(Eh,0)/e.length}function Eh(e,t){return e+t.x}function Sh(e){return 1+e.reduce(Ch,0)}function Ch(e,t){return fS(e,t.y)}function zh(e){for(var t;t=e.children;)e=t[0];return e}function Dh(e){for(var t;t=e.children;)e=t[t.length-1];return e}function Rh(){function e(e){var d=0,r;// First walk, computing the initial x & y values.
e.eachAfter(function(e){var n=e.children;n?(e.x=wh(n),e.y=Sh(n)):(e.x=r?d+=t(e,r):0,e.y=0,r=e)});var l=zh(e),o=Dh(e),s=l.x-t(l,o)/2,f=o.x+t(o,l)/2;// Second walk, normalizing x & y to the desired size.
return e.eachAfter(i?function(t){t.x=(t.x-e.x)*n,t.y=(e.y-t.y)*a}:function(t){t.x=(t.x-s)/(f-s)*n,t.y=(1-(e.y?t.y/e.y:1))*a})}var t=kh,n=1,a=1,i=!1;return e.separation=function(n){return arguments.length?(t=n,e):t},e.size=function(t){return arguments.length?(i=!1,n=+t[0],a=+t[1],e):i?null:[n,a]},e.nodeSize=function(t){return arguments.length?(i=!0,n=+t[0],a=+t[1],e):i?[n,a]:null},e}function $h(e){var t=0,n=e.children,a=n&&n.length;if(!a)t=1;else for(;0<=--a;)t+=n[a].value;e.value=t}function Oh(){return this.eachAfter($h)}function Th(e,t){if(e===t)return e;var n=e.ancestors(),i=t.ancestors(),d=null;for(e=n.pop(),t=i.pop();e===t;)d=e,e=n.pop(),t=i.pop();return d}function Ah(e,t){var a=new Uh(e),d=+e.value&&(a.value=e.value),r=[a],l,o,s,f,c;for(null==t&&(t=Lh);l=r.pop();)if(d&&(l.value=+l.data.value),(s=t(l.data))&&(c=s.length))for(l.children=Array(c),f=c-1;0<=f;--f)r.push(o=l.children[f]=new Uh(s[f])),o.parent=l,o.depth=l.depth+1;return a.eachBefore(Mh)}function Lh(e){return e.children}function Ph(e){e.data=e.data.data}function Mh(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function Uh(e){this.data=e,this.depth=this.height=0,this.parent=null}function jh(e){for(var n=e.length,a,d;n;)d=0|Math.random()*n--,a=e[n],e[n]=e[d],e[d]=a;return e}function qh(t){for(var a=0,d=(t=jh(bP.call(t))).length,n=[],r,l;a<d;)r=t[a],l&&Nh(l,r)?++a:(l=Wh(n=Fh(n,r)),a=0);return l}function Fh(e,t){var n,a;if(Bh(t,e))return[t];// If we get here then B must have at least one element.
for(n=0;n<e.length;++n)if(Ih(t,e[n])&&Bh(Yh(e[n],t),e))return[e[n],t];// If we get here then B must have at least two elements.
for(n=0;n<e.length-1;++n)for(a=n+1;a<e.length;++a)if(Ih(Yh(e[n],e[a]),t)&&Ih(Yh(e[n],t),e[a])&&Ih(Yh(e[a],t),e[n])&&Bh(Hh(e[n],e[a],t),e))return[e[n],e[a],t];// If we get here then something is very wrong.
throw new Error}function Ih(e,t){var n=e.r-t.r,a=t.x-e.x,i=t.y-e.y;return 0>n||n*n<a*a+i*i}function Nh(e,t){var n=e.r-t.r+1e-6,a=t.x-e.x,i=t.y-e.y;return 0<n&&n*n>a*a+i*i}function Bh(e,t){for(var n=0;n<t.length;++n)if(!Nh(e,t[n]))return!1;return!0}function Wh(e){switch(e.length){case 1:return Gh(e[0]);case 2:return Yh(e[0],e[1]);case 3:return Hh(e[0],e[1],e[2]);}}function Gh(e){return{x:e.x,y:e.y,r:e.r}}function Yh(e,t){var n=e.x,a=e.y,i=e.r,d=t.x,r=t.y,o=t.r,s=d-n,f=r-a,c=o-i,u=dS(s*s+f*f);return{x:(n+d+s/u*c)/2,y:(a+r+f/u*c)/2,r:(u+i+o)/2}}function Hh(e,t,n){var a=e.x,i=e.y,d=e.r,l=t.x,o=t.y,s=t.r,f=n.x,c=n.y,u=n.r,p=a-l,g=a-f,m=i-o,h=i-c,y=s-d,b=u-d,_=a*a+i*i-d*d,x=_-l*l-o*o+s*s,v=_-f*f-c*c+u*u,k=g*m-p*h,w=(m*v-h*x)/(2*k)-a,E=(h*y-m*b)/k,S=(g*x-p*v)/(2*k)-i,z=(p*b-g*y)/k,D=E*E+z*z-1,R=2*(d+w*E+S*z),$=w*w+S*S-d*d,C=-(D?(R+dS(R*R-4*D*$))/(2*D):$/R);return{x:a+w+E*C,y:i+S+z*C,r:C}}function Vh(e,t,n){var a=e.x-t.x,i=e.y-t.y,d=a*a+i*i,r,l,o,s;d?(l=t.r+n.r,l*=l,s=e.r+n.r,s*=s,l>s?(r=(d+s-l)/(2*d),o=dS(fS(0,s/d-r*r)),n.x=e.x-r*a-o*i,n.y=e.y-r*i+o*a):(r=(d+l-s)/(2*d),o=dS(fS(0,l/d-r*r)),n.x=t.x+r*a-o*i,n.y=t.y+r*i+o*a)):(n.x=t.x+n.r,n.y=t.y)}function Xh(e,t){var n=e.r+t.r-1e-6,a=t.x-e.x,i=t.y-e.y;return 0<n&&n*n>a*a+i*i}function Zh(e){var t=e._,n=e.next._,a=t.r+n.r,i=(t.x*n.r+n.x*t.r)/a,d=(t.y*n.r+n.y*t.r)/a;return i*i+d*d}function Jh(e){this._=e,this.next=null,this.previous=null}function Qh(e){if(!(l=e.length))return 0;var t,d,r,l,o,s,f,u,p,g,m;// Place the first circle.
if(t=e[0],t.x=0,t.y=0,!(1<l))return t.r;// Place the second circle.
if(d=e[1],t.x=-d.r,d.x=t.r,d.y=0,!(2<l))return t.r+d.r;// Place the third circle.
Vh(d,t,r=e[2]),t=new Jh(t),d=new Jh(d),r=new Jh(r),t.next=r.previous=d,d.next=t.previous=r,r.next=d.previous=t;// Attempt to place each remaining circle
pack:for(f=3;f<l;++f){Vh(t._,d._,r=e[f]),r=new Jh(r),u=d.next,p=t.previous,g=d._.r,m=t._.r;do if(g<=m){if(Xh(u._,r._)){d=u,t.next=d,d.previous=t,--f;continue pack}g+=u._.r,u=u.next}else{if(Xh(p._,r._)){t=p,t.next=d,d.previous=t,--f;continue pack}m+=p._.r,p=p.previous}while(u!==p.next);// Success! Insert the new circle c between a and b.
for(r.previous=t,r.next=d,t.next=d.previous=d=r,o=Zh(t);(r=r.next)!==d;)(s=Zh(r))<o&&(t=r,o=s);d=t.next}// Compute the enclosing circle of the front chain.
for(t=[d._],r=d;(r=r.next)!==d;)t.push(r._);// Translate the circles to put the enclosing circle around the origin.
for(r=qh(t),f=0;f<l;++f)t=e[f],t.x-=r.x,t.y-=r.y;return r.r}function Kh(e){return null==e?null:ey(e)}function ey(e){if('function'!=typeof e)throw new Error;return e}function ty(){return 0}function ny(e){return function(){return e}}function ay(e){return dS(e.value)}function iy(e){return function(t){t.children||(t.r=fS(0,+e(t)||0))}}function ry(t,a){return function(d){if(r=d.children){var l=r.length,n=t(d)*a||0,r,o,s;if(n)for(o=0;o<l;++o)r[o].r+=n;if(s=Qh(r),n)for(o=0;o<l;++o)r[o].r-=n;d.r=s+n}}}function ly(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}function oy(e){e.x0=oS(e.x0),e.y0=oS(e.y0),e.x1=oS(e.x1),e.y1=oS(e.y1)}function sy(e,t,a,d,r){for(var l=e.children,o=-1,s=l.length,n=e.value&&(d-t)/e.value,f;++o<s;)f=l[o],f.y0=a,f.y1=r,f.x0=t,f.x1=t+=f.value*n}function fy(e){return e.id}function cy(e){return e.parentId}function uy(){function e(e){var r=e.length,l=Array(r),o={},s,f,c,u,p,g,m;for(f=0;f<r;++f)s=e[f],p=l[f]=new Uh(s),null!=(g=t(s,f,e))&&(g+='')&&(m='$'+(p.id=g),o[m]=m in o?xP:p);for(f=0;f<r;++f)if(p=l[f],g=a(e[f],f,e),null==g||!(g+='')){if(c)throw new Error('multiple roots');c=p}else{if(u=o['$'+g],!u)throw new Error('missing: '+g);if(u===xP)throw new Error('ambiguous: '+g);u.children?u.children.push(p):u.children=[p],p.parent=u}if(!c)throw new Error('no root');if(c.parent=_P,c.eachBefore(function(e){e.depth=e.parent.depth+1,--r}).eachBefore(Mh),c.parent=null,0<r)throw new Error('cycle');return c}var t=fy,a=cy;return e.id=function(n){return arguments.length?(t=ey(n),e):t},e.parentId=function(t){return arguments.length?(a=ey(t),e):a},e}function py(e,t){return e.parent===t.parent?1:2}// function radialSeparation(a, b) {
//   return (a.parent === b.parent ? 1 : 2) / a.depth;
// }
// This function is used to traverse the left contour of a subtree (or
// subforest). It returns the successor of v on this contour. This successor is
// either given by the leftmost child of v or by the thread of v. The function
// returns null if and only if v is on the highest level of its subtree.
function gy(e){var t=e.children;return t?t[0]:e.t}// This function works analogously to nextLeft.
function my(e){var t=e.children;return t?t[t.length-1]:e.t}// Shifts the current subtree rooted at w+. This is done by increasing
// prelim(w+) and mod(w+) by shift.
function hy(e,t,n){var a=n/(t.i-e.i);t.c-=a,t.s+=n,e.c+=a,t.z+=n,t.m+=n}// All other shifts, applied to the smaller subtrees between w- and w+, are
// performed by this function. To prepare the shifts, we have to adjust
// change(w+), shift(w+), and change(w-).
function yy(e){for(var t=0,n=0,a=e.children,d=a.length,r;0<=--d;)r=a[d],r.z+=t,r.m+=t,t+=r.s+(n+=r.c)}// If vi-s ancestor is a sibling of v, returns vi-s ancestor. Otherwise,
// returns the specified (default) ancestor.
function by(e,t,n){return e.a.parent===t.parent?e.a:n}function _y(e,t){// default ancestor
// ancestor
// prelim
// mod
// change
// shift
// thread
this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}function xy(e){for(var t=new _y(e,0),a=[t],d,r,l,o,s;d=a.pop();)if(l=d._.children)for(d.children=Array(s=l.length),o=s-1;0<=o;--o)a.push(r=d.children[o]=new _y(l[o],o)),r.parent=d;return(t.parent=new _y(null,0)).children=[t],t}// Node-link tree diagram using the Reingold-Tilford "tidy" algorithm
function vy(){function e(e){var i=xy(e);// Compute the layout using Buchheim et al.s algorithm.
// If a fixed node size is specified, scale x and y.
if(i.eachAfter(n),i.parent.m=-i.z,i.eachBefore(a),o)e.eachBefore(d);// If a fixed tree size is specified, scale x and y based on the extent.
// Compute the left-most, right-most, and depth-most nodes for extents.
else{var f=e,c=e,u=e;e.eachBefore(function(e){e.x<f.x&&(f=e),e.x>c.x&&(c=e),e.depth>u.depth&&(u=e)});var p=f===c?1:r(f,c)/2,s=p-f.x,g=l/(c.x+p+s),m=t/(u.depth||1);e.eachBefore(function(e){e.x=(e.x+s)*g,e.y=e.depth*m})}return e}// Computes a preliminary x-coordinate for v. Before that, FIRST WALK is
// applied recursively to the children of v, as well as the function
// APPORTION. After spacing out the children by calling EXECUTE SHIFTS, the
// node v is placed to the midpoint of its outermost children.
function n(e){var t=e.children,n=e.parent.children,a=e.i?n[e.i-1]:null;if(t){yy(e);var d=(t[0].z+t[t.length-1].z)/2;a?(e.z=a.z+r(e._,a._),e.m=e.z-d):e.z=d}else a&&(e.z=a.z+r(e._,a._));e.parent.A=i(e,a,e.parent.A||n[0])}// Computes all real x-coordinates by summing up the modifiers recursively.
function a(e){e._.x=e.z+e.parent.m,e.m+=e.parent.m}// The core of the algorithm. Here, a new subtree is combined with the
// previous subtrees. Threads are used to traverse the inside and outside
// contours of the left and right subtree up to the highest common level. The
// vertices used for the traversals are vi+, vi-, vo-, and vo+, where the
// superscript o means outside and i means inside, the subscript - means left
// subtree and + means right subtree. For summing up the modifiers along the
// contour, we use respective variables si+, si-, so-, and so+. Whenever two
// nodes of the inside contours conflict, we compute the left one of the
// greatest uncommon ancestors using the function ANCESTOR and call MOVE
// SUBTREE to shift the subtree and prepare the shifts of smaller subtrees.
// Finally, we add a new thread (if necessary).
function i(e,t,n){if(t){for(var a=e,i=e,d=t,l=a.parent.children[0],o=a.m,s=i.m,f=d.m,c=l.m,u;d=my(d),a=gy(a),d&&a;)l=gy(l),i=my(i),i.a=e,u=d.z+f-a.z-o+r(d._,a._),0<u&&(hy(by(d,e,n),e,u),o+=u,s+=u),f+=d.m,o+=a.m,c+=l.m,s+=i.m;d&&!my(i)&&(i.t=d,i.m+=f-s),a&&!gy(l)&&(l.t=a,l.m+=o-c,n=e)}return n}function d(e){e.x*=l,e.y=e.depth*t}var r=py,l=1,t=1,o=null;return e.separation=function(t){return arguments.length?(r=t,e):r},e.size=function(n){return arguments.length?(o=!1,l=+n[0],t=+n[1],e):o?null:[l,t]},e.nodeSize=function(n){return arguments.length?(o=!0,l=+n[0],t=+n[1],e):o?[l,t]:null},e}function ky(e,t,a,d,r){for(var l=e.children,o=-1,s=l.length,n=e.value&&(r-a)/e.value,f;++o<s;)f=l[o],f.x0=t,f.x1=d,f.y0=a,f.y1=a+=f.value*n}function wy(e,t,a,i,d,r){for(var l=[],o=t.children,s=0,f=0,c=o.length,n=t.value,u,p,g,m,h,y,b,_,x,v,k;s<c;){g=d-a,m=r-i;// Find the next non-empty node.
do h=o[f++].value;while(!h&&f<c);// Keep adding nodes while the aspect ratio maintains or improves.
for(y=b=h,v=fS(m/g,g/m)/(n*e),k=h*h*v,x=fS(b/k,k/y);f<c;++f){if(h+=p=o[f].value,p<y&&(y=p),p>b&&(b=p),k=h*h*v,_=fS(b/k,k/y),_>x){h-=p;break}x=_}// Position and record the row orientation.
l.push(u={value:h,dice:g<m,children:o.slice(s,f)}),u.dice?sy(u,a,i,d,n?i+=m*h/n:r):ky(u,a,i,n?a+=g*h/n:d,r),n-=h,s=f}return l}function Ey(){function e(e){return e.x0=e.y0=0,e.x1=i,e.y1=d,e.eachBefore(t),r=[0],a&&e.eachBefore(oy),e}function t(e){var t=r[e.depth],a=e.x0+t,i=e.y0+t,d=e.x1-t,u=e.y1-t;d<a&&(a=d=(a+d)/2),u<i&&(i=u=(i+u)/2),e.x0=a,e.y0=i,e.x1=d,e.y1=u,e.children&&(t=r[e.depth+1]=l(e)/2,a+=c(e)-t,i+=o(e)-t,d-=s(e)-t,u-=f(e)-t,d<a&&(a=d=(a+d)/2),u<i&&(i=u=(i+u)/2),n(e,a,i,d,u))}var n=kP,a=!1,i=1,d=1,r=[0],l=ty,o=ty,s=ty,f=ty,c=ty;return e.round=function(t){return arguments.length?(a=!!t,e):a},e.size=function(t){return arguments.length?(i=+t[0],d=+t[1],e):[i,d]},e.tile=function(t){return arguments.length?(n=ey(t),e):n},e.padding=function(t){return arguments.length?e.paddingInner(t).paddingOuter(t):e.paddingInner()},e.paddingInner=function(t){return arguments.length?(l='function'==typeof t?t:ny(+t),e):l},e.paddingOuter=function(t){return arguments.length?e.paddingTop(t).paddingRight(t).paddingBottom(t).paddingLeft(t):e.paddingTop()},e.paddingTop=function(t){return arguments.length?(o='function'==typeof t?t:ny(+t),e):o},e.paddingRight=function(t){return arguments.length?(s='function'==typeof t?t:ny(+t),e):s},e.paddingBottom=function(t){return arguments.length?(f='function'==typeof t?t:ny(+t),e):f},e.paddingLeft=function(t){return arguments.length?(c='function'==typeof t?t:ny(+t),e):c},e}function Sy(e,t,a,d,r){function l(e,t,a,i,d,r,s){if(e>=t-1){var f=o[e];return f.x0=i,f.y0=d,f.x1=r,void(f.y1=s)}for(var c=n[e],u=a/2+c,p=e+1,g=t-1;p<g;){var m=p+g>>>1;n[m]<u?p=m+1:g=m}u-n[p-1]<n[p]-u&&e+1<p&&--p;var h=n[p]-c,y=a-h;if(r-i>s-d){var b=(i*y+r*h)/a;l(e,p,h,i,d,b,s),l(p,t,y,b,d,r,s)}else{var _=(d*y+s*h)/a;l(e,p,h,i,d,r,_),l(p,t,y,i,_,r,s)}}var o=e.children,s=o.length,n=Array(s+1),f,c;for(n[0]=c=f=0;f<s;++f)n[f+1]=c+=o[f].value;l(0,s,e.value,t,a,d,r)}function Cy(e,t,n,a,i){(1&e.depth?ky:sy)(e,t,n,a,i)}/**
    * Nest tuples into a tree structure, grouped by key values.
    * @constructor
    * @param {object} params - The parameters for this operator.
    * @param {Array<function(object): *>} params.keys - The key fields to nest by, in order.
    * @param {boolean} [params.generate=false] - A boolean flag indicating if
    *   non-leaf nodes generated by this transform should be included in the
    *   output. The default (false) includes only the input data (leaf nodes)
    *   in the data stream.
    */function zy(e){Dn.call(this,null,e)}function Dy(e){return e.values}/**
   * Abstract class for tree layout.
   * @constructor
   * @param {object} params - The parameters for this operator.
   */function Ry(e){Dn.call(this,null,e)}function $y(e,t,a){for(var d=0,r=t.length,n;d<r;++d)n=t[d],n in a&&e[n](a[n])}function Oy(e,a,d){for(var r=e.data,t=0,l=a.length-1;t<l;++t)r[d[t]]=e[a[t]];r[d[l]]=e.children?e.children.length:0}function Ty(e,t){return e.parent===t.parent?1:2}/**
   * Packed circle tree layout.
   * @constructor
   * @param {object} params - The parameters for this operator.
   * @param {function(object): *} params.field - The value field to size nodes.
   */function Ay(e){Ry.call(this,e)}/**
   * Partition tree layout.
   * @constructor
   * @param {object} params - The parameters for this operator.
   * @param {function(object): *} params.field - The value field to size nodes.
   */function Ly(e){Ry.call(this,e)}/**
    * Stratify a collection of tuples into a tree structure based on
    * id and parent id fields.
    * @constructor
    * @param {object} params - The parameters for this operator.
    * @param {function(object): *} params.key - Unique key field for each tuple.
    * @param {function(object): *} params.parentKey - Field with key for parent tuple.
    */function Py(e){Dn.call(this,null,e)}/**
   * Tree layout. Depending on the method parameter, performs either
   * Reingold-Tilford 'tidy' layout or dendrogram 'cluster' layout.
   * @constructor
   * @param {object} params - The parameters for this operator.
   */function My(e){Ry.call(this,e)}/**
    * Generate tuples representing links between tree nodes.
    * The resulting tuples will contain 'source' and 'target' fields,
    * which point to parent and child node tuples, respectively.
    * @constructor
    * @param {object} params - The parameters for this operator.
    */function Uy(e){Dn.call(this,[],e)}/**
   * Treemap layout.
   * @constructor
   * @param {object} params - The parameters for this operator.
   * @param {function(object): *} params.field - The value field to size nodes.
   */function jy(e){Ry.call(this,e)}function qy(e){return function(){return e}}function Fy(e){return e[0]}function Iy(e){return e[1]}function Ny(){this._=null}function By(e){e.U=// parent node
e.C=// color - true for red, false for black
e.L=// left node
e.R=// right node
e.P=// previous node
e.N=null}function Wy(e,t){var n=t,a=t.R,i=n.U;i?i.L===n?i.L=a:i.R=a:e._=a,a.U=i,n.U=a,n.R=a.L,n.R&&(n.R.U=n),a.L=n}function Gy(e,t){var n=t,a=t.L,i=n.U;i?i.L===n?i.L=a:i.R=a:e._=a,a.U=i,n.U=a,n.L=a.R,n.L&&(n.L.U=n),a.R=n}function Yy(e){for(;e.L;)e=e.L;return e}function Hy(e,t,n,a){var i=[null,null],d=HP.push(i)-1;return i.left=e,i.right=t,n&&Xy(i,e,t,n),a&&Xy(i,t,e,a),GP[e.index].halfedges.push(d),GP[t.index].halfedges.push(d),i}function Vy(e,t,n){var a=[t,n];return a.left=e,a}function Xy(e,t,n,a){e[0]||e[1]?e.left===n?e[1]=a:e[0]=a:(e[0]=a,e.left=t,e.right=n)}// LiangBarsky line clipping.
function Zy(e,t,n,i,d){var l=e[0],a=e[1],o=l[0],s=l[1],f=a[0],c=a[1],u=0,p=1,g=f-o,m=c-s,h;// TODO Better check?
if(h=t-o,g||!(0<h)){if(h/=g,0>g){if(h<u)return;h<p&&(p=h)}else if(0<g){if(h>p)return;h>u&&(u=h)}if(h=i-o,g||!(0>h)){if(h/=g,0>g){if(h>p)return;h>u&&(u=h)}else if(0<g){if(h<u)return;h<p&&(p=h)}if(h=n-s,m||!(0<h)){if(h/=m,0>m){if(h<u)return;h<p&&(p=h)}else if(0<m){if(h>p)return;h>u&&(u=h)}if(h=d-s,m||!(0>h)){if(h/=m,0>m){if(h>p)return;h>u&&(u=h)}else if(0<m){if(h<u)return;h<p&&(p=h)}return!(0<u||1>p)||(0<u&&(e[0]=[o+u*g,s+u*m]),1>p&&(e[1]=[o+p*g,s+p*m]),!0)}}}}}function Jy(e,t,n,a,i){var d=e[1];if(d)return!0;var r=e[0],l=e.left,o=e.right,s=l[0],f=l[1],c=o[0],u=o[1],p=(s+c)/2,g,m;if(u===f){if(p<t||p>=a)return;if(s>c){if(!r)r=[p,n];else if(r[1]>=i)return;d=[p,i]}else{if(!r)r=[p,i];else if(r[1]<n)return;d=[p,n]}}else if(g=(s-c)/(u-f),m=(f+u)/2-g*p,-1>g||1<g){if(s>c){if(!r)r=[(n-m)/g,n];else if(r[1]>=i)return;d=[(i-m)/g,i]}else{if(!r)r=[(i-m)/g,i];else if(r[1]<n)return;d=[(n-m)/g,n]}}else if(f<u){if(!r)r=[t,g*t+m];else if(r[0]>=a)return;d=[a,g*a+m]}else{if(!r)r=[a,g*a+m];else if(r[0]<t)return;d=[t,g*t+m]}return e[0]=r,e[1]=d,!0}function Qy(e,t,n,a){for(var d=HP.length,r;d--;)Jy(r=HP[d],e,t,n,a)&&Zy(r,e,t,n,a)&&(lS(r[0][0]-r[1][0])>IP||lS(r[0][1]-r[1][1])>IP)||delete HP[d]}function Ky(e){return GP[e.index]={site:e,halfedges:[]}}function eb(e,t){var n=e.site,a=t.left,i=t.right;return(n===i&&(i=a,a=n),i)?JE(i[1]-a[1],i[0]-a[0]):(n===a?(a=t[1],i=t[0]):(a=t[0],i=t[1]),JE(a[0]-i[0],i[1]-a[1]))}function tb(e,t){return t[+(t.left!==e.site)]}function nb(e,t){return t[+(t.left===e.site)]}function ab(){for(var e=0,t=GP.length,n,a,d,r;e<t;++e)if((n=GP[e])&&(r=(a=n.halfedges).length)){var l=Array(r),o=Array(r);for(d=0;d<r;++d)l[d]=d,o[d]=eb(n,HP[a[d]]);for(l.sort(function(e,t){return o[t]-o[e]}),d=0;d<r;++d)o[d]=a[l[d]];for(d=0;d<r;++d)a[d]=o[d]}}function ib(e,t,n,a){var i=GP.length,d=!0,r,l,o,s,f,c,u,p,g,m,h,y;for(r=0;r<i;++r)if(l=GP[r]){// Remove any dangling clipped edges.
for(o=l.site,f=l.halfedges,s=f.length;s--;)HP[f[s]]||f.splice(s,1);// Insert any border edges as necessary.
for(s=0,c=f.length;s<c;)m=nb(l,HP[f[s]]),h=m[0],y=m[1],u=tb(l,HP[f[++s%c]]),p=u[0],g=u[1],(lS(h-p)>IP||lS(y-g)>IP)&&(f.splice(s,0,HP.push(Vy(o,m,lS(h-e)<IP&&a-y>IP?[e,lS(p-e)<IP?g:a]:lS(y-a)<IP&&n-h>IP?[lS(g-a)<IP?p:n,a]:lS(h-n)<IP&&y-t>IP?[n,lS(p-n)<IP?g:t]:lS(y-t)<IP&&h-e>IP?[lS(g-t)<IP?p:e,t]:null))-1),++c);c&&(d=!1)}// If there werent any edges, have the closest site cover the extent.
// It doesnt matter which corner of the extent we measure!
if(d){var b=1/0,_,x,v;for(r=0,d=null;r<i;++r)(l=GP[r])&&(o=l.site,_=o[0]-e,x=o[1]-t,v=_*_+x*x,v<b&&(b=v,d=l));if(d){var k=[e,t],w=[e,a],E=[n,a],S=[n,t];d.halfedges.push(HP.push(Vy(o=d.site,k,w))-1,HP.push(Vy(o,w,E))-1,HP.push(Vy(o,E,S))-1,HP.push(Vy(o,S,k))-1)}}// Lastly delete any cells with no edges; these were entirely clipped.
for(r=0;r<i;++r)(l=GP[r])&&(l.halfedges.length||delete GP[r])}function db(){By(this),this.x=this.y=this.arc=this.site=this.cy=null}function rb(e){var t=e.P,n=e.N;if(t&&n){var a=t.site,i=e.site,r=n.site;if(a!==r){var l=i[0],o=i[1],s=a[0]-l,f=a[1]-o,c=r[0]-l,u=r[1]-o,p=2*(s*u-f*c);if(!(p>=-NP)){var d=s*s+f*f,g=c*c+u*u,m=(u*d-f*g)/p,h=(s*g-c*d)/p,y=qP.pop()||new db;y.arc=e,y.site=i,y.x=m+l,y.y=(y.cy=h+o)+dS(m*m+h*h),e.circle=y;for(var b=null,_=YP._;_;)if(y.y<_.y||y.y===_.y&&y.x<=_.x){if(_.L)_=_.L;else{b=_.P;break}}else if(_.R)_=_.R;else{b=_;break}YP.insert(b,y),b||(BP=y)}}}}function lb(e){var t=e.circle;t&&(!t.P&&(BP=t.N),YP.remove(t),qP.push(t),By(t),e.circle=null)}function ob(){By(this),this.edge=this.site=this.circle=null}function sb(e){var t=FP.pop()||new ob;return t.site=e,t}function fb(e){lb(e),WP.remove(e),FP.push(e),By(e)}function cb(e){var t=e.circle,n=t.x,a=t.cy,i=[n,a],d=e.P,r=e.N,l=[e];fb(e);for(var o=d;o.circle&&lS(n-o.circle.x)<IP&&lS(a-o.circle.cy)<IP;)d=o.P,l.unshift(o),fb(o),o=d;l.unshift(o),lb(o);for(var s=r;s.circle&&lS(n-s.circle.x)<IP&&lS(a-s.circle.cy)<IP;)r=s.N,l.push(s),fb(s),s=r;l.push(s),lb(s);var f=l.length,c;for(c=1;c<f;++c)s=l[c],o=l[c-1],Xy(s.edge,o.site,s.site,i);o=l[0],s=l[f-1],s.edge=Hy(o.site,s.site,null,i),rb(o),rb(s)}function ub(e){for(var t=e[0],n=e[1],a=WP._,i,r,l,o;a;)if(l=pb(a,n)-t,l>IP)a=a.L;else if(o=t-gb(a,n),o>IP){if(!a.R){i=a;break}a=a.R}else{l>-IP?(i=a.P,r=a):o>-IP?(i=a,r=a.N):i=r=a;break}Ky(e);var s=sb(e);if(WP.insert(i,s),i||r){if(i===r)return lb(i),r=sb(i.site),WP.insert(s,r),s.edge=r.edge=Hy(i.site,s.site),rb(i),void rb(r);if(!r)return void(s.edge=Hy(i.site,s.site));// else lArc !== rArc
lb(i),lb(r);var f=i.site,c=f[0],u=f[1],p=e[0]-c,g=e[1]-u,m=r.site,h=m[0]-c,y=m[1]-u,b=2*(p*y-g*h),d=p*p+g*g,_=h*h+y*y,x=[(y*d-g*_)/b+c,(p*_-h*d)/b+u];Xy(r.edge,f,m,x),s.edge=Hy(f,e,null,x),r.edge=Hy(e,m,null,x),rb(i),rb(r)}}function pb(e,t){var n=e.site,a=n[0],i=n[1],d=i-t;if(!d)return a;var r=e.P;if(!r)return-Infinity;n=r.site;var l=n[0],o=n[1],s=o-t;if(!s)return l;var f=l-a,c=1/d-1/s,u=f/s;return c?(-u+dS(u*u-2*c*(f*f/(-2*s)-o+s/2+i-d/2)))/c+a:(a+l)/2}function gb(e,t){var n=e.N;if(n)return pb(n,t);var a=e.site;return a[1]===t?a[0]:1/0}function mb(e,t,n){return(e[0]-n[0])*(t[1]-e[1])-(e[0]-t[0])*(n[1]-e[1])}function hb(e,t){return t[1]-e[1]||t[0]-e[0]}function yb(e,t){var n=e.sort(hb).pop(),a,i,d;for(HP=[],GP=Array(e.length),WP=new Ny,YP=new Ny;;)if(d=BP,n&&(!d||n[1]<d.y||n[1]===d.y&&n[0]<d.x))(n[0]!==a||n[1]!==i)&&(ub(n),a=n[0],i=n[1]),n=e.pop();else if(d)cb(d.arc);else break;if(ab(),t){var r=+t[0][0],l=+t[0][1],o=+t[1][0],s=+t[1][1];Qy(r,l,o,s),ib(r,l,o,s)}this.edges=HP,this.cells=GP,WP=YP=HP=GP=null}function bb(){function e(e){return new yb(e.map(function(a,d){var i=[oS(t(a,d,e)/IP)*IP,oS(n(a,d,e)/IP)*IP];return i.index=d,i.data=a,i}),a)}var t=Fy,n=Iy,a=null;return e.polygons=function(t){return e(t).polygons()},e.links=function(t){return e(t).links()},e.triangles=function(t){return e(t).triangles()},e.x=function(n){return arguments.length?(t='function'==typeof n?n:qy(+n),e):t},e.y=function(t){return arguments.length?(n='function'==typeof t?t:qy(+t),e):n},e.extent=function(t){return arguments.length?(a=null==t?null:[[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]],e):a&&[[a[0][0],a[0][1]],[a[1][0],a[1][1]]]},e.size=function(t){return arguments.length?(a=null==t?null:[[0,0],[+t[0],+t[1]]],e):a&&[a[1][0]-a[0][0],a[1][1]-a[0][1]]},e}function _b(e){Dn.call(this,null,e)}function xb(){function e(e){e.width=e.height=1;var t=dS(e.getContext('2d').getImageData(0,0,1,1).data.length>>2);e.width=2048/t,e.height=2048/t;var n=e.getContext('2d');return n.fillStyle=n.strokeStyle='red',n.textAlign='center',{context:n,ratio:t}}function t(e,n,r){for(var o=n.x,f=n.y,c=dS(a[0]*a[0]+a[1]*a[1]),u=d(a),s=.5>l()?1:-1,p=-s,g,m,y;(g=u(p+=s))&&(m=~~g[0],y=~~g[1],!(iS(lS(m),lS(y))>=c));)if(n.x=o+m,n.y=f+y,!(0>n.x+n.x0||0>n.y+n.y0||n.x+n.x1>a[0]||n.y+n.y1>a[1])&&(!r||!kb(n,e,a[0]))&&(!r||Eb(n,r)))// TODO only check for collisions within current bounds.
{for(var b=n.sprite,_=n.width>>5,v=a[0]>>5,k=n.x-(_<<4),w=127&k,E=n.y1-n.y0,h=(n.y+n.y0)*v+(k>>5),S=0,C;S<E;S++){C=0;for(var z=0;z<=_;z++)e[h+z]|=C<<32-w|(z<_?(C=b[S*_+z])>>>w:0);h+=v}return n.sprite=null,!0}return!1}var a=[256,256],d=Sb,r=[],l=Math.random,o={},s,f,c,u,p,g,m;return o.layout=function(){for(var o=e(Ti()),h=Cb((a[0]>>5)*a[1]),y=null,b=r.length,n=-1,_=[],x=r.map(function(e){return{text:s(e),font:f(e),style:u(e),weight:p(e),rotate:g(e),size:~~c(e),padding:m(e),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:e}}).sort(function(e,t){return t.size-e.size}),v;++n<b;)v=x[n],v.x=a[0]*(l()+.5)>>1,v.y=a[1]*(l()+.5)>>1,vb(o,v,x,n),v.hasText&&t(h,v,y)&&(_.push(v),y?wb(y,v):y=[{x:v.x+v.x0,y:v.y+v.y0},{x:v.x+v.x1,y:v.y+v.y1}],v.x-=a[0]>>1,v.y-=a[1]>>1);return _},o.words=function(e){return arguments.length?(r=e,o):r},o.size=function(e){return arguments.length?(a=[+e[0],+e[1]],o):a},o.font=function(e){return arguments.length?(f=zb(e),o):f},o.fontStyle=function(e){return arguments.length?(u=zb(e),o):u},o.fontWeight=function(e){return arguments.length?(p=zb(e),o):p},o.rotate=function(e){return arguments.length?(g=zb(e),o):g},o.text=function(e){return arguments.length?(s=zb(e),o):s},o.spiral=function(e){return arguments.length?(d=QP[e]||e,o):d},o.fontSize=function(e){return arguments.length?(c=zb(e),o):c},o.padding=function(e){return arguments.length?(m=zb(e),o):m},o.random=function(e){return arguments.length?(l=e,o):l},o}// Fetches a monochrome sprite bitmap for the specified text.
// Load in batches for speed.
function vb(e,t,a,r){if(!t.sprite){var l=e.context,o=e.ratio;l.clearRect(0,0,2048/o,2048/o);var s=0,f=0,c=0,u=a.length,n,p,g,b,_;for(--r;++r<u;){if(t=a[r],l.save(),l.font=t.style+' '+t.weight+' '+~~((t.size+1)/o)+'px '+t.font,n=l.measureText(t.text+'m').width*o,g=t.size<<1,t.rotate){var v=KE(t.rotate*JP),E=QE(t.rotate*JP),S=n*E,C=n*v,z=g*E,D=g*v;n=fS(lS(S+D),lS(S-D))+31>>5<<5,g=~~fS(lS(C+z),lS(C-z))}else n=n+31>>5<<5;if(g>c&&(c=g),2048<=s+n&&(s=0,f+=c,c=0),2048<=f+g)break;l.translate((s+(n>>1))/o,(f+(g>>1))/o),t.rotate&&l.rotate(t.rotate*JP),l.fillText(t.text,0,0),t.padding&&(l.lineWidth=2*t.padding,l.strokeText(t.text,0,0)),l.restore(),t.width=n,t.height=g,t.xoff=s,t.yoff=f,t.x1=n>>1,t.y1=g>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,s+=n}for(var R=l.getImageData(0,0,2048/o,2048/o).data,$=[];0<=--r;)if(t=a[r],t.hasText){// Zero the buffer
for(n=t.width,p=n>>5,g=t.y1-t.y0,b=0;b<g*p;b++)$[b]=0;if(s=t.xoff,null==s)return;f=t.yoff;var O=0,T=-1;for(_=0;_<g;_++){for(b=0;b<n;b++){var A=p*_+(b>>5),k=R[2048*(f+_)+(s+b)<<2]?1<<31-b%32:0;$[A]|=k,O|=k}O?T=_:(t.y0++,g--,_--,f++)}t.y1=t.y0+T,t.sprite=$.slice(0,(t.y1-t.y0)*p)}}}// Use mask-based collision detection.
function kb(e,t,n){n>>=5;for(var a=e.sprite,d=e.width>>5,r=e.x-(d<<4),l=127&r,o=e.y1-e.y0,s=(e.y+e.y0)*n+(r>>5),f=0,c;f<o;f++){c=0;for(var u=0;u<=d;u++)if((c<<32-l|(u<d?(c=a[f*d+u])>>>l:0))&t[s+u])return!0;s+=n}return!1}function wb(e,t){var n=e[0],a=e[1];t.x+t.x0<n.x&&(n.x=t.x+t.x0),t.y+t.y0<n.y&&(n.y=t.y+t.y0),t.x+t.x1>a.x&&(a.x=t.x+t.x1),t.y+t.y1>a.y&&(a.y=t.y+t.y1)}function Eb(e,t){return e.x+e.x1>t[0].x&&e.x+e.x0<t[1].x&&e.y+e.y1>t[0].y&&e.y+e.y0<t[1].y}function Sb(t){var n=t[0]/t[1];return function(e){return[n*(e*=.1)*QE(e),e*KE(e)]}}// TODO reuse arrays?
function Cb(e){for(var t=[],n=-1;++n<e;)t[n]=0;return t}function zb(e){return'function'==typeof e?e:function(){return e}}function Db(e){Dn.call(this,xb(),e)}function Rb(e,t){for(var a=+Infinity,d=-Infinity,r=0,l=t.length,n;r<l;++r)n=e(t[r]),n<a&&(a=n),n>d&&(d=n);return[a,d]}function $b(e){return new Uint8Array(e)}function Ob(e){return new Uint16Array(e)}function Tb(e){return new Uint32Array(e)}/**
   * Maintains CrossFilter state.
   */function Ab(){var e=8,a=[],i=Tb(0),d=Pb(0,e),r=Pb(0,e);return{data:function(){return a},seen:function(){return i=Lb(i,a.length)},add:function(e){for(var d=0,r=a.length,l=e.length,n;d<l;++d)n=e[d],n._index=r++,a.push(n)},remove:function(e,l){// map: index -> boolean (true => remove)
var o=a.length,n=Array(o-e),s=a,// reuse old data array for index map
f,c,u;// seek forward to first removal
for(c=0;!l[c]&&c<o;++c)n[c]=a[c],s[c]=c;// condense arrays
for(u=c;c<o;++c)f=a[c],l[c]?s[c]=-1:(s[c]=u,d[u]=d[c],r[u]=r[c],n[u]=f,f._index=u++),d[c]=0;return a=n,s},size:function(){return a.length},curr:function(){return d},prev:function(){return r},reset:function(e){r[e]=d[e]},all:function(){return 257>e?255:65537>e?65535:4294967295},set:function(e,t){d[e]|=t},clear:function(e,t){d[e]&=~t},resize:function(t,n){var a=d.length;(t>a||n>e)&&(e=fS(n,e),d=Pb(t,e,d),r=Pb(t,e))}}}function Lb(e,t,n){return e.length>=t?e:(n=n||new e.constructor(t),n.set(e),n)}function Pb(e,t,n){var a=(257>t?$b:65537>t?Ob:Tb)(e);return n&&a.set(n),a}function Mb(e,t,n){var a=1<<t;return{one:a,zero:~a,range:n.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd:function(e,t){var n=this,d=n.bisect(n.range,e.value),r=e.index,l=d[0],o=d[1],s=r.length,f;for(f=0;f<l;++f)t[r[f]]|=a;for(f=o;f<s;++f)t[r[f]]|=a;return n}}}/**
   * Maintains a list of values, sorted by key.
   */function Ub(){function e(e,t,n){if(!t.length)return[];var a=l,o=t.length,s=Array(o),f=Tb(o),c,u,p;for(p=0;p<o;++p)s[p]=e(t[p]),f[p]=p;if(s=jb(s,f),a)c=r,u=d,r=Array(a+o),d=Tb(a+o),qb(n,c,u,a,s,f,o,r,d);else{if(0<n)for(p=0;p<o;++p)f[p]+=n;r=s,d=f}return l=a+o,{index:f,value:s}}function t(e,t){// map: index -> remove
var a=l,n,o,s;// seek forward to first removal
for(o=0;!t[d[o]]&&o<a;++o);// condense index and value arrays
for(s=o;o<a;++o)t[n=d[o]]||(d[s]=n,r[s]=r[o],++s);l=a-e}function n(e){for(var t=0,a=l;t<a;++t)d[t]=e[d[t]]}function a(e,t){var a;return t?a=t.length:(t=r,a=l),[tz(t,e[0],0,a),ez(t,e[1],0,a)]}var d=Tb(0),r=[],l=0;return{insert:e,remove:t,bisect:a,reindex:n,index:function(){return d},size:function(){return l}}}function jb(e,t){return e.sort.call(t,function(t,n){var a=e[t],i=e[n];return a<i?-1:a>i?1:0}),ra(e,t)}function qb(e,t,n,a,d,r,l,o,s){var f=0,c=0,u;for(u=0;f<a&&c<l;++u)t[f]<d[c]?(o[u]=t[f],s[u]=n[f++]):(o[u]=d[c],s[u]=r[c++]+e);for(;f<a;++f,++u)o[u]=t[f],s[u]=n[f];for(;c<l;++c,++u)o[u]=d[c],s[u]=r[c]+e}/**
   * An indexed multi-dimensional filter.
   * @constructor
   * @param {object} params - The parameters for this operator.
   * @param {Array<function(object): *>} params.fields - An array of dimension accessors to filter.
   * @param {Array} params.query - An array of per-dimension range queries.
   */function Fb(e){Dn.call(this,Ab(),e),this._indices=null,this._dims=null}/**
   * Selectively filters tuples by resolving against a filter bitmap.
   * Useful for processing the output of a cross-filter transform.
   * @constructor
   * @param {object} params - The parameters for this operator.
   * @param {object} params.ignore - A bit mask indicating which filters to ignore.
   * @param {object} params.filter - The per-tuple filter bitmaps. Typically this
   *   parameter value is a reference to a {@link CrossFilter} transform.
   */function Ib(e){Dn.call(this,null,e)}function Nb(e){var t=e._signals.cursor;// add cursor signal to dataflow, if needed
// evaluate cursor on each mousemove event
// when cursor signal updates, set visible cursor
t||(e._signals.cursor=t=e.add({user:'default',item:null})),e.on(e.events('view','mousemove'),t,function(e,n){var a=t.value,i=a?m(a)?a:a.user:'default',d=n.item&&n.item.cursor||null;return a&&i===a.user&&d==a.item?a:{user:i,item:d}}),e.add(null,function(e){var t=e.cursor,n=this.value;return m(t)||(n=t.item,t=t.user),Bb(t&&'default'!==t?t:n||t),n},{cursor:t})}function Bb(e){'undefined'!=typeof document&&document.body&&(document.body.style.cursor=e)}function Wb(e,t){var n=e._runtime.data;return n.hasOwnProperty(t)||u('Unrecognized data set: '+t),n[t]}function Gb(e,t){me(t)||u('Second argument to changes must be a changeset.');var n=Wb(this,e);return n.modified=!0,this.pulse(n.input,t)}function Yb(e){var t=e.padding();return fS(0,e._viewWidth+t.left+t.right)}function Hb(e){var t=e.padding();return fS(0,e._viewHeight+t.top+t.bottom)}function Vb(e){var t=e.padding(),n=e._origin;return[t.left+n[0],t.top+n[1]]}function Xb(e){var t=Vb(e),n=Yb(e),a=Hb(e);e._renderer.background(e._background),e._renderer.resize(n,a,t),e._handler.origin(t),e._resizeListeners.forEach(function(t){try{t(n,a)}catch(t){e.error(t)}})}/**
   * Extend an event with additional view-specific methods.
   * Adds a new property ('vega') to an event that provides a number
   * of methods for querying information about the current interaction.
   * The vega object provides the following methods:
   *   view - Returns the backing View instance.
   *   item - Returns the currently active scenegraph item (if any).
   *   group - Returns the currently active scenegraph group (if any).
   *     This method accepts a single string-typed argument indicating the name
   *     of the desired parent group. The scenegraph will be traversed from
   *     the item up towards the root to search for a matching group. If no
   *     argument is provided the enclosing group for the active item is
   *     returned, unless the item it itself a group, in which case it is
   *     returned directly.
   *   xy - Returns a two-element array containing the x and y coordinates for
   *     mouse or touch events. For touch events, this is based on the first
   *     elements in the changedTouches array. This method accepts a single
   *     argument: either an item instance or mark name that should serve as
   *     the reference coordinate system. If no argument is provided the
   *     top-level view coordinate system is assumed.
   *   x - Returns the current x-coordinate, accepts the same arguments as xy.
   *   y - Returns the current y-coordinate, accepts the same arguments as xy.
   * @param {Event} event - The input event to extend.
   * @param {Item} item - The currently active scenegraph item (if any).
   * @return {Event} - The extended input event.
   */function Zb(t,n,a){var i=t._renderer.canvas(),d,r,l;return i&&(l=Vb(t),r=n.changedTouches?n.changedTouches[0]:n,d=_l(r,i),d[0]-=l[0],d[1]-=l[1]),n.dataflow=t,n.vega=Jb(t,a,d),n.item=a,n}function Jb(e,t,n){function a(e){var n=d,a;if(e)for(a=t;a;a=a.mark.group)if(a.mark.name===e){n=a;break}return n&&n.mark&&n.mark.interactive?n:{}}function i(e){if(!e)return n;m(e)&&(e=a(e));for(var t=n.slice();e;)t[0]-=e.x||0,t[1]-=e.y||0,e=e.mark&&e.mark.group;return t}var d=t?'group'===t.mark.marktype?t:t.mark.group:null;return{view:j(e),item:j(t||{}),group:a,xy:i,x:function(e){return i(e)[0]},y:function(e){return i(e)[1]}}}/**
   * Initialize event handling configuration.
   * @param {object} config - The configuration settings.
   * @return {object}
   */function Qb(e){e=F({},e);var t=e.defaults;return t&&(hS(t.prevent)&&(t.prevent=ae(t.prevent)),hS(t.allow)&&(t.allow=ae(t.allow))),e}function Kb(e,t){var n=e._eventConfig.defaults,a=n&&n.prevent,i=n&&n.allow;return!1!==a&&!0!==i&&(!(!0!==a&&!1!==i)||(a?a[t]:i?!i[t]:e.preventDefault()))}/**
   * Create a new event stream from an event source.
   * @param {object} source - The event source to monitor.
   * @param {string} type - The event type.
   * @param {function(object): boolean} [filter] - Event filter function.
   * @return {EventStream}
   */function e_(e){return e.item}function t_(e){// grab upstream collector feeding the mark operator
var t=e.item.mark.source;return t.source||t}function n_(e){return function(t,n){return n.vega.view().changeset().encode(n.item,e)}}/**
   * Finalize a View instance that is being removed.
   * Cancel any running timers.
   * Remove all external event listeners.
   * Remove any currently displayed tooltip.
   */function a_(e,t,n){var a=document.createElement(e);for(var i in t)a.setAttribute(i,t[i]);return null!=n&&(a.textContent=n),a}/**
   * Bind a signal to an external HTML input element. The resulting two-way
   * binding will propagate input changes to signals, and propagate signal
   * changes to the input element state. If this view instance has no parent
   * element, we assume the view is headless and no bindings are created.
   * @param {Element|string} el - The parent DOM element to which the input
   *   element should be appended as a child. If string-valued, this argument
   *   will be treated as a CSS selector. If null or undefined, the parent
   *   element of this view will be used as the element.
   * @param {object} param - The binding parameters which specify the signal
   *   to bind to, the input element type, and type-specific configuration.
   * @return {View} - This view instance.
   */function i_(e,t,n){if(t){var a=n.param,i=n.state;return i||(i=n.state={elements:null,active:!1,set:null,update:function(t){t!==e.signal(a.signal)&&(i.source=!0,e.signal(a.signal,t).run())}},a.debounce&&(i.update=q(a.debounce,i.update))),d_(i,t,a,e.signal(a.signal)),i.active||(e.on(e._signals[a.signal],null,function(){i.source?i.source=!1:i.set(e.signal(a.signal))}),i.active=!0),i}}/**
   * Generate an HTML input form element and bind it to a signal.
   */function d_(e,t,n,a){var i=a_('div',{class:'vega-bind'});i.appendChild(a_('span',{class:'vega-bind-name'},n.name||n.signal)),t.appendChild(i);var d=r_;switch(n.input){case'checkbox':d=l_;break;case'select':d=o_;break;case'radio':d=s_;break;case'range':d=f_;}d(e,i,n,a)}/**
   * Generates an arbitrary input form element.
   * The input type is controlled via user-provided parameters.
   */function r_(e,t,n,a){var i=a_('input');for(var d in n)'signal'!==d&&'element'!==d&&i.setAttribute('input'===d?'type':d,n[d]);i.setAttribute('name',n.signal),i.value=a,t.appendChild(i),i.addEventListener('input',function(){e.update(i.value)}),e.elements=[i],e.set=function(e){i.value=e}}/**
   * Generates a checkbox input element.
   */function l_(e,t,n,a){var i={type:'checkbox',name:n.signal};a&&(i.checked=!0);var d=a_('input',i);t.appendChild(d),d.addEventListener('change',function(){e.update(d.checked)}),e.elements=[d],e.set=function(e){d.checked=!!e||null}}/**
   * Generates a selection list input element.
   */function o_(e,t,a,i){var d=a_('select',{name:a.signal});a.options.forEach(function(e){var t={value:e};c_(e,i)&&(t.selected=!0),d.appendChild(a_('option',t,e+''))}),t.appendChild(d),d.addEventListener('change',function(){e.update(a.options[d.selectedIndex])}),e.elements=[d],e.set=function(e){for(var t=0,r=a.options.length;t<r;++t)if(c_(a.options[t],e))return void(d.selectedIndex=t)}}/**
   * Generates a radio button group.
   */function s_(e,t,n,a){var i=a_('span',{class:'vega-bind-radio'});t.appendChild(i),e.elements=n.options.map(function(t){var d='vega-option-'+n.signal+'-'+t,r={id:d,type:'radio',name:n.signal,value:t};c_(t,a)&&(r.checked=!0);var l=a_('input',r);return l.addEventListener('change',function(){e.update(t)}),i.appendChild(l),i.appendChild(a_('label',{for:d},t+'')),l}),e.set=function(t){for(var a=e.elements,d=0,r=a.length;d<r;++d)c_(a[d].value,t)&&(a[d].checked=!0)}}/**
   * Generates a slider input element.
   */function f_(e,t,n,a){function i(){s.textContent=o.value,e.update(+o.value)}// subscribe to both input and change
a=a===void 0?(+n.max+ +n.min)/2:a;var d=n.min||iS(0,+a)||0,r=n.max||fS(100,+a)||100,l=n.step||Vn(d,r,100),o=a_('input',{type:'range',name:n.signal,min:d,max:r,step:l});o.value=a;var s=a_('label',{},+a);t.appendChild(o),t.appendChild(s),o.addEventListener('input',i),o.addEventListener('change',i),e.elements=[o],e.set=function(e){o.value=e,s.textContent=e}}function c_(e,t){return e===t||e+''==t+''}function u_(e,t,n,a,i){return t=t||new a(e.loader()),t.initialize(n,Yb(e),Hb(e),Vb(e),i).background(e._background)}function p_(e,t){return t?function(){try{t.apply(this,arguments)}catch(t){e.error(t)}}:null}function g_(e,t,n,a){// instantiate scenegraph handler
var i=new a(e.loader(),p_(e,e.tooltip())).scene(e.scenegraph().root).initialize(n,Vb(e),e);// transfer event handlers
return t&&t.handlers().forEach(function(e){i.on(e.type,e.handler)}),i}function m_(t,n){if('string'==typeof n){if('undefined'==typeof document)return t.error('DOM document instance not found.'),null;if(n=document.querySelector(n),!n)return t.error('Signal bind element not found: '+n),null}if(n)try{n.innerHTML=''}catch(a){n=null,t.error(a)}return n}/**
   * Render the current scene in a headless fashion.
   * This method is asynchronous, returning a Promise instance.
   * @return {Promise} - A Promise that resolves to a renderer.
   */function h_(e,t,n){var a=Zl(t),i=a&&a.headless;return i?e.runAsync().then(function(){return u_(e,null,null,i,n).renderAsync(e._scenegraph.root)}):Promise.reject('Unrecognized renderer type: '+t)}/**
   * Produce an image URL for the visualization. Depending on the type
   * parameter, the generated URL contains data for either a PNG or SVG image.
   * The URL can be used (for example) to download images of the visualization.
   * This method is asynchronous, returning a Promise instance.
   * @param {string} type - The image type. One of 'svg', 'png' or 'canvas'.
   *   The 'canvas' and 'png' types are synonyms for a PNG image.
   * @return {Promise} - A promise that resolves to an image URL.
   */function y_(e,t){var n=new Blob([e],{type:t});return window.URL.createObjectURL(n)}/**
   * Produce a Canvas instance containing a rendered visualization.
   * This method is asynchronous, returning a Promise instance.
   * @return {Promise} - A promise that resolves to a Canvas instance.
   *//**
   * Produce a rendered SVG string of the visualization.
   * This method is asynchronous, returning a Promise instance.
   * @return {Promise} - A promise that resolves to an SVG string.
   */function b_(e,t){return e=e||t.autosize,g(e)?e:(e=e||'pad',{type:e})}function __(e,t){return e=e||t.padding,g(e)?{top:x_(e.top),bottom:x_(e.bottom),left:x_(e.left),right:x_(e.right)}:v_(x_(e))}function x_(e){return+e||0}function v_(e){return{top:e,bottom:e,left:e,right:e}}function k_(e,t){u(e+' for "outer" push: '+h(t))}function w_(e,t){var n=e.name;if(e.push==='outer')// signal push must not use properties reserved for standard definition
t.signals[n]||k_('No prior signal definition',n),rM.forEach(function(t){void 0!==e[t]&&k_('Invalid property ',t)});else{// define a new signal in the current scope
var a=t.addSignal(n,e.value);!1===e.react&&(a.react=!1),e.bind&&t.addBinding(n,e.bind)}}function E_(e){this.type=e}function S_(e){switch(e.type){case'ArrayExpression':return e.elements;case'BinaryExpression':case'LogicalExpression':return[e.left,e.right];case'CallExpression':var t=e.arguments.slice();return t.unshift(e.callee),t;case'ConditionalExpression':return[e.test,e.consequent,e.alternate];case'MemberExpression':return[e.object,e.property];case'ObjectExpression':return e.properties;case'Property':return[e.key,e.value];case'UnaryExpression':return[e.argument];case'Identifier':case'Literal':case'RawCode':default:return[];}}/*
    The following expression parser is based on Esprima (http://esprima.org/).
    Original header comment and license for Esprima is included here:

    Copyright (C) 2013 Ariya Hidayat <ariya.hidayat@gmail.com>
    Copyright (C) 2013 Thaddee Tyl <thaddee.tyl@gmail.com>
    Copyright (C) 2013 Mathias Bynens <mathias@qiwi.be>
    Copyright (C) 2012 Ariya Hidayat <ariya.hidayat@gmail.com>
    Copyright (C) 2012 Mathias Bynens <mathias@qiwi.be>
    Copyright (C) 2012 Joost-Wim Boekesteijn <joost-wim@boekesteijn.nl>
    Copyright (C) 2012 Kris Kowal <kris.kowal@cixar.com>
    Copyright (C) 2012 Yusuke Suzuki <utatane.tea@gmail.com>
    Copyright (C) 2012 Arpad Borsos <arpad.borsos@googlemail.com>
    Copyright (C) 2011 Ariya Hidayat <ariya.hidayat@gmail.com>

    Redistribution and use in source and binary forms, with or without
    modification, are permitted provided that the following conditions are met:

      * Redistributions of source code must retain the above copyright
        notice, this list of conditions and the following disclaimer.
      * Redistributions in binary form must reproduce the above copyright
        notice, this list of conditions and the following disclaimer in the
        documentation and/or other materials provided with the distribution.

    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
    AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
    IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
    ARE DISCLAIMED. IN NO EVENT SHALL <COPYRIGHT HOLDER> BE LIABLE FOR ANY
    DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
    (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
    LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
    ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
    (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
    THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  */// Ensure the condition is true, otherwise throw an error.
// This is only to have a better contract semantic, i.e. another safety net
// to catch a logic error. The condition shall be fulfilled in normal case.
// Do NOT use this to enforce a certain condition on any user input.
function C_(e,t){/* istanbul ignore next */if(!e)throw new Error('ASSERT: '+t)}function z_(e){return 48<=e&&57>=e;// 0..9
}function D_(e){return 0<='0123456789abcdefABCDEF'.indexOf(e)}function R_(e){return 0<='01234567'.indexOf(e)}// 7.2 White Space
function $_(e){return 32===e||9===e||11===e||12===e||160===e||5760<=e&&0<=[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)}// 7.3 Line Terminators
function O_(e){return 10===e||13===e||8232===e||8233===e}// 7.6 Identifier Names and Identifiers
function T_(e){return 36===e||95===e||// $ (dollar) and _ (underscore)
65<=e&&90>=e||// A..Z
97<=e&&122>=e||// a..z
92===e||// \ (backslash)
128<=e&&uM.test(HE(e))}function A_(e){return 36===e||95===e||// $ (dollar) and _ (underscore)
65<=e&&90>=e||// A..Z
97<=e&&122>=e||// a..z
48<=e&&57>=e||// 0..9
92===e||// \ (backslash)
128<=e&&pM.test(HE(e))}// 7.6.1.1 Keywords
function L_(){for(var e;sM<fM&&(e=oM.charCodeAt(sM),$_(e)||O_(e));)++sM}function P_(e){var t=0,n,a,d;for(a='u'===e?4:2,n=0;n<a;++n)sM<fM&&D_(oM[sM])?(d=oM[sM++],t=16*t+'0123456789abcdef'.indexOf(d.toLowerCase())):fx({},'Unexpected token %0','ILLEGAL');return HE(t)}function M_(){var e,t,n,a;for(e=oM[sM],t=0,'}'===e&&fx({},'Unexpected token %0','ILLEGAL');sM<fM&&(e=oM[sM++],!!D_(e));)t=16*t+'0123456789abcdef'.indexOf(e.toLowerCase());// UTF-16 Encoding
return((1114111<t||'}'!==e)&&fx({},'Unexpected token %0','ILLEGAL'),65535>=t)?HE(t):(n=(t-65536>>10)+55296,a=(1023&t-65536)+56320,HE(n,a))}function U_(){var e,t;for(e=oM.charCodeAt(sM++),t=HE(e),92===e&&(117!==oM.charCodeAt(sM)&&fx({},'Unexpected token %0','ILLEGAL'),++sM,e=P_('u'),(!e||'\\'===e||!T_(e.charCodeAt(0)))&&fx({},'Unexpected token %0','ILLEGAL'),t=e);sM<fM&&(e=oM.charCodeAt(sM),!!A_(e));)++sM,t+=HE(e),92===e&&(t=t.substr(0,t.length-1),117!==oM.charCodeAt(sM)&&fx({},'Unexpected token %0','ILLEGAL'),++sM,e=P_('u'),(!e||'\\'===e||!A_(e.charCodeAt(0)))&&fx({},'Unexpected token %0','ILLEGAL'),t+=e);return t}function j_(){var e,t;for(e=sM++;sM<fM;){if(t=oM.charCodeAt(sM),92===t)return sM=e,U_();if(A_(t))++sM;else break}return oM.slice(e,sM)}function q_(){var e,t,n;return e=sM,t=92===oM.charCodeAt(sM)?U_():j_(),n=1===t.length?3:gM.hasOwnProperty(t)?4:'null'===t?5:'true'===t||'false'===t?1:3,{type:n,value:t,start:e,end:sM}}// 7.7 Punctuators
function F_(){var e=sM,t=oM.charCodeAt(sM),n=oM[sM],a,i,d,r;switch(t){// Check for most common single-character punctuators.
case 46:// . dot
case 40:// ( open bracket
case 41:// ) close bracket
case 59:// ; semicolon
case 44:// , comma
case 123:// { open curly brace
case 125:// } close curly brace
case 91:// [
case 93:// ]
case 58:// :
case 63:// ?
case 126:return++sM,{type:7,value:HE(t),start:e,end:sM};default:// '=' (U+003D) marks an assignment or comparison operator.
if(a=oM.charCodeAt(sM+1),61===a)switch(t){case 43:// +
case 45:// -
case 47:// /
case 60:// <
case 62:// >
case 94:// ^
case 124:// |
case 37:// %
case 38:// &
case 42:return sM+=2,{type:7,value:HE(t)+HE(a),start:e,end:sM};case 33:// !
case 61:return sM+=2,61===oM.charCodeAt(sM)&&++sM,{type:7,value:oM.slice(e,sM),start:e,end:sM};}}// 4-character punctuator: >>>=
// Other 2-character punctuators: ++ -- << >> && ||
return(r=oM.substr(sM,4),'>>>='===r)?(sM+=4,{type:7,value:r,start:e,end:sM}):(d=r.substr(0,3),'>>>'===d||'<<='===d||'>>='===d)?(sM+=3,{type:7,value:d,start:e,end:sM}):(i=d.substr(0,2),n===i[1]&&0<='+-<>&|'.indexOf(n)||'=>'===i?(sM+=2,{type:7,value:i,start:e,end:sM}):0<='<>=!+-*%&|^/'.indexOf(n)?(++sM,{type:7,value:n,start:e,end:sM}):void fx({},'Unexpected token %0','ILLEGAL'));// 3-character punctuators: === !== >>> <<= >>=
// 1-character punctuators: < > = ! + - * % & | ^ /
}// 7.8.3 Numeric Literals
function I_(e){for(var t='';sM<fM&&!!D_(oM[sM]);)t+=oM[sM++];return 0===t.length&&fx({},'Unexpected token %0','ILLEGAL'),T_(oM.charCodeAt(sM))&&fx({},'Unexpected token %0','ILLEGAL'),{type:6,value:parseInt('0x'+t,16),start:e,end:sM}}function N_(e){for(var t='0'+oM[sM++];sM<fM&&!!R_(oM[sM]);)t+=oM[sM++];return(T_(oM.charCodeAt(sM))||z_(oM.charCodeAt(sM)))&&fx({},'Unexpected token %0','ILLEGAL'),{type:6,value:parseInt(t,8),octal:!0,start:e,end:sM}}function B_(){var e,t,n;if(n=oM[sM],C_(z_(n.charCodeAt(0))||'.'===n,'Numeric literal must start with a decimal digit or a decimal point'),t=sM,e='','.'!==n){// Hex number starts with '0x'.
// Octal number starts with '0'.
if(e=oM[sM++],n=oM[sM],'0'===e){if('x'===n||'X'===n)return++sM,I_(t);if(R_(n))return N_(t);// decimal number starts with '0' such as '09' is illegal.
n&&z_(n.charCodeAt(0))&&fx({},'Unexpected token %0','ILLEGAL')}for(;z_(oM.charCodeAt(sM));)e+=oM[sM++];n=oM[sM]}if('.'===n){for(e+=oM[sM++];z_(oM.charCodeAt(sM));)e+=oM[sM++];n=oM[sM]}if('e'===n||'E'===n)if(e+=oM[sM++],n=oM[sM],('+'===n||'-'===n)&&(e+=oM[sM++]),z_(oM.charCodeAt(sM)))for(;z_(oM.charCodeAt(sM));)e+=oM[sM++];else fx({},'Unexpected token %0','ILLEGAL');return T_(oM.charCodeAt(sM))&&fx({},'Unexpected token %0','ILLEGAL'),{type:6,value:parseFloat(e),start:t,end:sM}}// 7.8.4 String Literals
function W_(){var e='',t=!1,n,a,i,d;for(n=oM[sM],C_('\''===n||'"'===n,'String literal must starts with a quote'),a=sM,++sM;sM<fM;)if(i=oM[sM++],i===n){n='';break}else if('\\'===i)i=oM[sM++],i&&O_(i.charCodeAt(0))?'\r'===i&&'\n'===oM[sM]&&++sM:'u'===i||'x'===i?'{'===oM[sM]?(++sM,e+=M_()):e+=P_(i):'n'===i?e+='\n':'r'===i?e+='\r':'t'===i?e+='\t':'b'===i?e+='\b':'f'===i?e+='\f':'v'===i?e+='\x0B':R_(i)?(d='01234567'.indexOf(i),0!==d&&(t=!0),sM<fM&&R_(oM[sM])&&(t=!0,d=8*d+'01234567'.indexOf(oM[sM++]),0<='0123'.indexOf(i)&&sM<fM&&R_(oM[sM])&&(d=8*d+'01234567'.indexOf(oM[sM++]))),e+=HE(d)):e+=i;else if(O_(i.charCodeAt(0)))break;else e+=i;return''!==n&&fx({},'Unexpected token %0','ILLEGAL'),{type:8,value:e,octal:t,start:a,end:sM}}function G_(e,t){var n=e;0<=t.indexOf('u')&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,function(e,t){return 1114111>=parseInt(t,16)?'x':void fx({},'Invalid regular expression')}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,'x'));// First, detect invalid regular expressions.
try{}catch(t){fx({},'Invalid regular expression')}// Return a regular expression object for this pattern-flag pair, or
// `null` in case the current environment doesn't support the flags it
// uses.
try{return new RegExp(e,t)}catch(e){return null}}function Y_(){var e,t,n,a,i;for(e=oM[sM],C_('/'===e,'Regular expression literal must start with a slash'),t=oM[sM++],n=!1,a=!1;sM<fM;)if(e=oM[sM++],t+=e,'\\'===e)e=oM[sM++],O_(e.charCodeAt(0))&&fx({},'Invalid regular expression: missing /'),t+=e;else if(O_(e.charCodeAt(0)))fx({},'Invalid regular expression: missing /');else if(n)']'===e&&(n=!1);else if('/'===e){a=!0;break}else'['===e&&(n=!0);return a||fx({},'Invalid regular expression: missing /'),i=t.substr(1,t.length-2),{value:i,literal:t}}function H_(){var e,t,n;for(t='',n='';sM<fM&&(e=oM[sM],!!A_(e.charCodeAt(0)));)++sM,'\\'===e&&sM<fM?fx({},'Unexpected token %0','ILLEGAL'):(n+=e,t+=e);return 0<=n.search(/[^gimuy]/g)&&fx({},'Invalid regular expression',n),{value:n,literal:t}}function V_(){var e,t,n,a;return cM=null,L_(),e=sM,t=Y_(),n=H_(),a=G_(t.value,n.value),{literal:t.literal+n.literal,value:a,regex:{pattern:t.value,flags:n.value},start:e,end:sM}}function X_(e){return e.type===3||e.type===4||e.type===1||e.type===5}function Z_(){var e;// Very common: ( and ) and ;
// Dot (.) U+002E can also start a floating-point number, hence the need
// to check the next character.
return(L_(),sM>=fM)?{type:2,start:sM,end:sM}:(e=oM.charCodeAt(sM),T_(e)?q_():40===e||41===e||59===e?F_():39===e||34===e?W_():46===e?z_(oM.charCodeAt(sM+1))?B_():F_():z_(e)?B_():F_());// String literal starts with single quote (U+0027) or double quote (U+0022).
}function J_(){var e;return e=cM,sM=e.end,cM=Z_(),sM=e.end,e}function Q_(){var e;e=sM,cM=Z_(),sM=e}function K_(e){var t=new E_('ArrayExpression');return t.elements=e,t}function ex(e,t,n){var a=new E_('||'===e||'&&'===e?'LogicalExpression':'BinaryExpression');return a.operator=e,a.left=t,a.right=n,a}function nx(e,t){var n=new E_('CallExpression');return n.callee=e,n.arguments=t,n}function ax(e,t,n){var a=new E_('ConditionalExpression');return a.test=e,a.consequent=t,a.alternate=n,a}function ix(e){var t=new E_('Identifier');return t.name=e,t}function dx(e){var t=new E_('Literal');return t.value=e.value,t.raw=oM.slice(e.start,e.end),e.regex&&('//'===t.raw&&(t.raw='/(?:)/'),t.regex=e.regex),t}function rx(e,t,n){var a=new E_('MemberExpression');return a.computed='['===e,a.object=t,a.property=n,a.computed||(n.member=!0),a}function lx(e){var t=new E_('ObjectExpression');return t.properties=e,t}function ox(e,t,n){var a=new E_('Property');return a.key=t,a.value=n,a.kind=e,a}function sx(e,t){var n=new E_('UnaryExpression');return n.operator=e,n.argument=t,n.prefix=!0,n}// Throw an exception
function fx(e,t){var n=Array.prototype.slice.call(arguments,2),a=t.replace(/%(\d)/g,function(e,t){return C_(t<n.length,'Message reference must be in range'),n[t]}),i;throw i=new Error(a),i.index=sM,i.description=a,i}// Throw an exception because of the token.
function cx(e){// BooleanLiteral, NullLiteral, or Punctuator.
e.type===2&&fx(e,'Unexpected end of input'),e.type===6&&fx(e,'Unexpected number'),e.type===8&&fx(e,'Unexpected string'),e.type===3&&fx(e,'Unexpected identifier'),e.type===4&&fx(e,'Unexpected reserved word'),fx(e,'Unexpected token %0',e.value)}// Expect the next token to match the specified punctuator.
// If not, an exception will be thrown.
function ux(e){var t=J_();(t.type!==7||t.value!==e)&&cx(t)}// Return true if the next token matches the specified punctuator.
function px(e){return cM.type===7&&cM.value===e}// Return true if the next token matches the specified keyword
function gx(e){return cM.type===4&&cM.value===e}// 11.1.4 Array Initialiser
function mx(){var e=[];for(sM=cM.start,ux('[');!px(']');)px(',')?(J_(),e.push(null)):(e.push($x()),px(']')||ux(','));return J_(),K_(e)}// 11.1.5 Object Initialiser
function hx(){var e;// Note: This function is called only from parseObjectProperty(), where
// EOF and Punctuator tokens are already filtered out.
return sM=cM.start,e=J_(),8===e.type||6===e.type?(e.octal&&fx(e,'Octal literals are not allowed in strict mode.'),dx(e)):ix(e.value)}function yx(){var e,t,n,a;return sM=cM.start,e=cM,3===e.type?(n=hx(),ux(':'),a=$x(),ox('init',n,a)):2===e.type||7===e.type?void cx(e):(t=hx(),ux(':'),a=$x(),ox('init',t,a))}function bx(){var e=[],t={},n=String,a,i,d;for(sM=cM.start,ux('{');!px('}');)a=yx(),i='Identifier'===a.key.type?a.key.name:n(a.key.value),d='$'+i,Object.prototype.hasOwnProperty.call(t,d)?fx({},'Duplicate data property in object literal not allowed in strict mode'):t[d]=!0,e.push(a),px('}')||ux(',');return ux('}'),lx(e)}// 11.1.6 The Grouping Operator
function _x(){var e;return ux('('),e=Ox(),ux(')'),e}// 11.1 Primary Expressions
function xx(){var e,t,n;if(px('('))return _x();if(px('['))return mx();if(px('{'))return bx();if(e=cM.type,sM=cM.start,3===e||mM[cM.value])n=ix(J_().value);else if(8===e||6===e)cM.octal&&fx(cM,'Octal literals are not allowed in strict mode.'),n=dx(J_());else if(4===e)throw new Error('Disabled.');else 1===e?(t=J_(),t.value='true'===t.value,n=dx(t)):5===e?(t=J_(),t.value=null,n=dx(t)):px('/')||px('/=')?(n=dx(V_()),Q_()):cx(J_());return n}// 11.2 Left-Hand-Side Expressions
function vx(){var e=[];if(ux('('),!px(')'))for(;sM<fM&&(e.push($x()),!px(')'));)ux(',');return ux(')'),e}function kx(){var e;return sM=cM.start,e=J_(),X_(e)||cx(e),ix(e.value)}function wx(){return ux('.'),kx()}function Ex(){var e;return ux('['),e=Ox(),ux(']'),e}function Sx(){var e,t,n;for(e=xx();;)if(px('.'))n=wx(),e=rx('.',e,n);else if(px('('))t=vx(),e=nx(e,t);else if(px('['))n=Ex(),e=rx('[',e,n);else break;return e}// 11.3 Postfix Expressions
function Cx(){var e=Sx();if(cM.type===7&&(px('++')||px('--')))throw new Error('Disabled.');return e}// 11.4 Unary Operators
function zx(){var e,t;if(cM.type!==7&&cM.type!==4)t=Cx();else if(px('++')||px('--'))throw new Error('Disabled.');else if(px('+')||px('-')||px('~')||px('!'))e=J_(),t=zx(),t=sx(e.value,t);else if(gx('delete')||gx('void')||gx('typeof'))throw new Error('Disabled.');else t=Cx();return t}function Dx(e){var t=0;if(e.type!==7&&e.type!==4)return 0;switch(e.value){case'||':t=1;break;case'&&':t=2;break;case'|':t=3;break;case'^':t=4;break;case'&':t=5;break;case'==':case'!=':case'===':case'!==':t=6;break;case'<':case'>':case'<=':case'>=':case'instanceof':case'in':t=7;break;case'<<':case'>>':case'>>>':t=8;break;case'+':case'-':t=9;break;case'*':case'/':case'%':t=11;break;default:}return t}// 11.5 Multiplicative Operators
// 11.6 Additive Operators
// 11.7 Bitwise Shift Operators
// 11.8 Relational Operators
// 11.9 Equality Operators
// 11.10 Binary Bitwise Operators
// 11.11 Binary Logical Operators
function Rx(){var e,t,n,a,d,r,l,o,s,f;if(e=cM,s=zx(),a=cM,d=Dx(a),0===d)return s;for(a.prec=d,J_(),t=[e,cM],l=zx(),r=[s,a,l];0<(d=Dx(cM));){// Reduce: make a binary expression from the three topmost entries.
for(;2<r.length&&d<=r[r.length-2].prec;)l=r.pop(),o=r.pop().value,s=r.pop(),t.pop(),n=ex(o,s,l),r.push(n);// Shift.
a=J_(),a.prec=d,r.push(a),t.push(cM),n=zx(),r.push(n)}// Final reduce to clean-up the stack.
for(f=r.length-1,n=r[f],t.pop();1<f;)t.pop(),n=ex(r[f-1].value,r[f-2],n),f-=2;return n}// 11.12 Conditional Operator
function $x(){var e,t,n;return e=Rx(),px('?')&&(J_(),t=$x(),ux(':'),n=$x(),e=ax(e,t,n)),e}// 11.14 Comma Operator
function Ox(){var e=$x();if(px(','))throw new Error('Disabled.');// no sequence expressions
return e}function Tx(e){oM=e,sM=0,fM=oM.length,cM=null,Q_();var t=Ox();if(cM.type!==2)throw new Error('Unexpect token after expression.');return t}function Ax(e){function t(t,n,a,i){var d=e(n[0]);return a&&(d=a+'('+d+')',0===a.lastIndexOf('new ',0)&&(d='('+d+')')),d+'.'+t+(0>i?'':0===i?'()':'('+n.slice(1).map(e).join(',')+')')}function n(e,n,a){return function(i){return t(e,i,n,a)}}return{// MATH functions
isNaN:'isNaN',isFinite:'isFinite',abs:'Math.abs',acos:'Math.acos',asin:'Math.asin',atan:'Math.atan',atan2:'Math.atan2',ceil:'Math.ceil',cos:'Math.cos',exp:'Math.exp',floor:'Math.floor',log:'Math.log',max:'Math.max',min:'Math.min',pow:'Math.pow',random:'Math.random',round:'Math.round',sin:'Math.sin',sqrt:'Math.sqrt',tan:'Math.tan',clamp:function(t){3>t.length&&u('Missing arguments to clamp function.'),3<t.length&&u('Too many arguments to clamp function.');var n=t.map(e);return'Math.max('+n[1]+', Math.min('+n[2]+','+n[0]+'))'},// DATE functions
now:'Date.now',utc:'Date.UTC',datetime:'new Date',date:n('getDate','new Date',0),day:n('getDay','new Date',0),year:n('getFullYear','new Date',0),month:n('getMonth','new Date',0),hours:n('getHours','new Date',0),minutes:n('getMinutes','new Date',0),seconds:n('getSeconds','new Date',0),milliseconds:n('getMilliseconds','new Date',0),time:n('getTime','new Date',0),timezoneoffset:n('getTimezoneOffset','new Date',0),utcdate:n('getUTCDate','new Date',0),utcday:n('getUTCDay','new Date',0),utcyear:n('getUTCFullYear','new Date',0),utcmonth:n('getUTCMonth','new Date',0),utchours:n('getUTCHours','new Date',0),utcminutes:n('getUTCMinutes','new Date',0),utcseconds:n('getUTCSeconds','new Date',0),utcmilliseconds:n('getUTCMilliseconds','new Date',0),// shared sequence functions
length:n('length',null,-1),indexof:n('indexOf',null),lastindexof:n('lastIndexOf',null),slice:n('slice',null),// STRING functions
parseFloat:'parseFloat',parseInt:'parseInt',upper:n('toUpperCase','String',0),lower:n('toLowerCase','String',0),substring:n('substring','String'),split:n('split','String'),replace:n('replace','String'),// REGEXP functions
regexp:'RegExp',test:n('test','RegExp'),// Control Flow functions
if:function(t){3>t.length&&u('Missing arguments to if function.'),3<t.length&&u('Too many arguments to if function.');var n=t.map(e);return'('+n[0]+'?'+n[1]+':'+n[2]+')'}}}function Lx(e){function t(e){if(m(e))return e;var t=y[e.type];return null==t&&u('Unsupported type: '+e.type),t(e)}function n(e){var n={code:t(e),globals:Object.keys(f),fields:Object.keys(c)};return f={},c={},n}e=e||{};var a=e.whitelist?ae(e.whitelist):{},i=e.blacklist?ae(e.blacklist):{},d=e.constants||hM,r=(e.functions||Ax)(t),l=e.globalvar,s=e.fieldvar,f={},c={},g=0,h=M(l)?l:function(e){return l+'["'+e+'"]'},y={Literal:function(e){return e.raw},Identifier:function(e){var t=e.name;return 0<g?t:i.hasOwnProperty(t)?u('Illegal identifier: '+t):d.hasOwnProperty(t)?d[t]:a.hasOwnProperty(t)?t:(f[t]=1,h(t))},MemberExpression:function(e){var n=!e.computed,a=t(e.object);n&&(g+=1);var i=t(e.property);return a===s&&(c[i]=1),n&&(g-=1),a+(n?'.'+i:'['+i+']')},CallExpression:function(e){'Identifier'!==e.callee.type&&u('Illegal callee type: '+e.callee.type);var n=e.callee.name,a=e.arguments,i=r.hasOwnProperty(n)&&r[n];return i||u('Unrecognized function: '+n),M(i)?i(a):i+'('+a.map(t).join(',')+')'},ArrayExpression:function(e){return'['+e.elements.map(t).join(',')+']'},BinaryExpression:function(e){return'('+t(e.left)+e.operator+t(e.right)+')'},UnaryExpression:function(e){return'('+e.operator+t(e.argument)+')'},ConditionalExpression:function(e){return'('+t(e.test)+'?'+t(e.consequent)+':'+t(e.alternate)+')'},LogicalExpression:function(e){return'('+t(e.left)+e.operator+t(e.right)+')'},ObjectExpression:function(e){return'{'+e.properties.map(t).join(',')+'}'},Property:function(e){g+=1;var n=t(e.key);return g-=1,n+':'+t(e.value)}};return n.functions=r,n.constants=d,n}function Px(t,n,a){var i=t+':'+a,d=yM[i];return d&&d[0]===n||(yM[i]=d=[n,n(a)]),d[1]}function Mx(e,t){return Px('format',I$,t)(e)}function Ux(e,t){return Px('timeFormat',MC,t)(e)}function jx(e,t){return Px('utcFormat',jC,t)(e)}function qx(e,t){return Px('timeParse',UC,t)(e)}function Fx(e,t){return Px('utcParse',qC,t)(e)}function Ix(e,t,n){return bM.setMonth(e),bM.setDate(t),Ux(bM,n)}/**
   * Return an array with minimum and maximum values, in the
   * form [min, max]. Ignores null, undefined, and NaN values.
   *//**
   * Predicate that returns true if the value lies within the span
   * of the given range. The left and right flags control the use
   * of inclusive (true) or exclusive (false) comparisons.
   */function Nx(e,n,a,i){var d=n[0],r=n[n.length-1],l;return d>r&&(l=d,d=r,r=l),a=void 0===a||a,i=void 0===i||i,(a?d<=e:d<e)&&(i?e<=r:e<r)}/**
   * Span-preserving range clamp. If the span of the input range is less
   * than (max - min) and an endpoint exceeds either the min or max value,
   * the range is translated such that the span is preserved and one
   * endpoint touches the boundary of the min/max range.
   * If the span exceeds (max - min), the range [min, max] is returned.
   *//**
   * Return the numerical span of an array: the difference between
   * the last and first values.
   */function Bx(e,t,n){try{e[t].apply(e,['EXPRESSION'].concat([].slice.call(n)))}catch(t){e.warn(t)}return n[n.length-1]}function Wx(e,t){var n;return M(e)?e:m(e)?(n=t.scales[e])&&n.value:void 0}function Gx(e,t,n){var a='%'+n;if(!t.hasOwnProperty(a))try{t[a]=e.scaleRef(n)}catch(e){// TODO: error handling? warning?
}}function Yx(e,t,n,a){if(t[0].type==='Literal')// add scale dependency
Gx(n,a,t[0].value);else if(t[0].type==='Identifier')// indirect scale lookup; add all scales as parameters
for(e in n.scales)Gx(n,a,e)}function Hx(e,t,n){return Fo(e||0,t||0,n||0)}function Vx(e,t,a,d,r){e=Wx(e,(r||this).context);var l=Si(t,a),o=e.domain(),s=o[0],c=f(o),u=gc(e,s,c);e.ticks&&(o=e.ticks(+d||15),s!==o[0]&&o.unshift(s),c!==f(o)&&o.push(c));for(var p=0,g=o.length;p<g;++p)l.stop(u(o[p]),e(o[p]));return l}function Xx(e,t){return function(n,a,i){if(n){// projection defined, use it
var d=Wx(n,(i||this).context);return d&&d.path[e](a)}// projection undefined, use global method
return t(a)}}function Zx(e){var t=this.context.data[e];return t?t.values.value:[]}function Jx(e,t,n,a){t[0].type!=='Literal'&&u('First argument to data functions must be a string literal.');var i=t[0].value,d=':'+i;a.hasOwnProperty(d)||(a[d]=n.getData(i).tuplesRef())}function Qx(e){return e.data}function Kx(e,t){var n=Zx.call(t,e);return n.root&&n.root.lookup||wM}function ev(e,t){return!(e!==t&&(e===e||t===t))||!!(hS(e)&&hS(t)&&e.length===t.length)&&tv(e,t)}function tv(e,t){for(var a=0,d=e.length;a<d;++a)if(!ev(e[a],t[a]))return!1;return!0}function nv(e){return function(t){for(var n in e)if(!ev(t[n],e[n]))return!1;return!0}}function av(e,t,n,a,i,d){var r=this.context.dataflow,l=this.context.data[e],o=l.input,s=l.changes,f=r.stamp(),c,u;if(!1===r._trigger||!(o.value.length||t||a))// nothing to do!
return 0;if((!s||s.stamp<f)&&(l.changes=s=r.changeset(),s.stamp=f,r.runAfter(function(){l.modified=!0,r.pulse(o,s).run()},!0,1)),n&&(c=!0===n?_S:hS(n)||oe(n)?n:nv(n),s.remove(c)),t&&s.insert(t),a&&(c=nv(a),o.value.some(c)?s.remove(c):s.insert(a)),i)for(u in d)s.modify(i,u,d[u]);return 1}// TODO: revisit date coercion?
function iv(e,a){for(var d=a.fields,r=a.values,l=d.length,n=0,o,s;n<l;++n)if(s=d[n],s.getter=t.getter||t(s.field),o=s.getter(e),Y(o)&&(o=c(o)),Y(r[n])&&(r[n]=c(r[n])),Y(r[n][0])&&(r[n]=r[n].map(c)),'E'===s.type){// Enumerated fields can either specify individual values (single/multi selections)
// or an array of values (interval selections).
if(hS(r[n])?0>r[n].indexOf(o):o!==r[n])return!1;}else if('R'===s.type){if(!Nx(o,r[n]))return!1;}else if('R-RE'===s.type){// Discrete selection of bins test within the range [bin_start, bin_end).
if(!Nx(o,r[n],!0,!1))return!1;}else if('R-E'===s.type){// 'R-E'/'R-LE' included for completeness.
if(!Nx(o,r[n],!1,!1))return!1;}else if('R-LE'===s.type&&!Nx(o,r[n],!1,!0))return!1;return!0}/**
   * Tests if a tuple is contained within an interactive selection.
   * @param {string} name - The name of the data set representing the selection.
   *                 Tuples in the dataset are of the form
   *                 {unit: string, fields: array<fielddef>, values: array<*>}.
   *                 Fielddef is of the form
   *                 {field: string, channel: string, type: 'E' | 'R'} where
   *                 'type' identifies whether tuples in the dataset enumerate
   *                 values for the field, or specify a continuous range.
   * @param {object} datum - The tuple to test for inclusion.
   * @param {string} op - The set operation for combining selections.
   *   One of 'intersect' or 'union' (default).
   * @return {boolean} - True if the datum is in the selection, false otherwise.
   */function dv(e,t,a){for(var d=this.context.data[e],r=d?d.values.value:[],l=d?d['index:unit']&&d['index:unit'].value:void 0,o='intersect'===a,s=r.length,n=0,f,c,u,p,g;n<s;++n)if(f=r[n],l&&o){// if we've already matched this unit, skip.
if(c=c||{},u=c[p=f.unit]||0,-1===u)continue;// if we match and there are no other units return true
// if we've missed against all tuples in this unit return false
if(g=iv(t,f),c[p]=g?-1:++u,g&&1===l.size)return!0;if(!g&&u===l.get(p).count)return!1}else// if we find a miss and we do require intersection return false
// if we find a match and we don't require intersection return true
if(g=iv(t,f),o^g)return g;// if intersecting and we made it here, then we saw no misses
// if not intersecting, then we saw no matches
// if no active selections, return false
return s&&o}function rv(e,t,n,a){t[0].type!=='Literal'&&u('First argument to indata must be a string literal.');var i=t[0].value,d=2<=t.length&&t[t.length-1].value;d!=='intersect'||a.hasOwnProperty('@unit')||(a['@unit']=n.getData(i).indataRef(n,'unit')),Jx(e,t,n,a)}/**
   * Resolves selection for use as a scale domain or reads via the API.
   * @param {string} name - The name of the dataset representing the selection
   * @param {string} [op='union'] - The set operation for combining selections.
   *                 One of 'intersect' or 'union' (default).
   * @returns {object} An object of selected fields and values.
   */function lv(e,t){// First union all entries within the same unit.
for(var a=this.context.data[e],d=a?a.values.value:[],r={},l={},o=d.length,n=0,s,f,c,u,p,g,h,y,b,_,x;n<o;++n)for(s=d[n],u=s.unit,f=s.fields,c=s.values,(_=0,x=f.length);_<x;++_)p=f[_],g=r[p.field]||(r[p.field]={}),h=g[u]||(g[u]=[]),l[p.field]=y=p.type.charAt(0),b=EM[y+'_union'],g[u]=b(h,P(c[_]));// Then resolve fields across units as per the op.
return t=t||'union',Object.keys(r).forEach(function(e){r[e]=Object.keys(r[e]).map(function(t){return r[e][t]}).reduce(function(n,a){return void 0===n?a:EM[l[e]+'_'+t](n,a)})}),r}function ov(e,a){for(var d=a.fields,r=a.values,l=a.getter||(a.getter=[]),o=d.length,n=0,s;n<o;++n)if(l[n]=l[n]||t(d[n]),s=l[n](e),Y(s)&&(s=c(s)),Y(r[n])&&(r[n]=c(r[n])),a['bin_'+d[n]]){if(Y(r[n][0])&&(r[n]=r[n].map(c)),!Nx(s,r[n],!0,!1))return!1;}else if(s!==r[n])return!1;return!0}// TODO: revisit date coercion?
// have selections populate with consistent types upon write?
function sv(e,a){for(var d=a.intervals,r=d.length,n=0,l,o,s;n<r;++n){if(o=d[n].extent,l=d[n].getter||(d[n].getter=t(d[n].field)),s=l(e),!o||o[0]===o[1])return!1;if(Y(s)&&(s=c(s)),Y(o[0])&&(o=d[n].extent=o.map(c)),H(o[0])&&!Nx(s,o))return!1;if(m(o[0])&&0>o.indexOf(s))return!1}return!0}/**
   * Tests if a tuple is contained within an interactive selection.
   * @param {string} name - The name of the data set representing the selection.
   * @param {object} datum - The tuple to test for inclusion.
   * @param {string} op - The set operation for combining selections.
   *   One of 'intersect' or 'union' (default).
   * @param {function(object,object):boolean} test - A boolean-valued test
   *   predicate for determining selection status within a single unit chart.
   * @return {boolean} - True if the datum is in the selection, false otherwise.
   */function fv(e,t,a,d){for(var r=this.context.data[e],l=r?r.values.value:[],o=r?r['index:unit']&&r['index:unit'].value:void 0,s='intersect'===a,f=l.length,n=0,c,u,p,g,m;n<f;++n)if(c=l[n],o&&s){// if we've already matched this unit, skip.
if(u=u||{},p=u[g=c.unit]||0,-1===p)continue;// if we match and there are no other units return true
// if we've missed against all tuples in this unit return false
if(m=d(t,c),u[g]=m?-1:++p,m&&1===o.size)return!0;if(!m&&p===o.get(g).count)return!1}else// if we find a miss and we do require intersection return false
// if we find a match and we don't require intersection return true
if(m=d(t,c),s^m)return m;// if intersecting and we made it here, then we saw no misses
// if not intersecting, then we saw no matches
// if no active selections, return false
return f&&s}// Assumes point selection tuples are of the form:
// {unit: string, encodings: array<string>, fields: array<string>, values: array<*>, bins: object}
function cv(e,t,n){return fv.call(this,e,t,n,ov)}// Assumes interval selection typles are of the form:
// {unit: string, intervals: array<{encoding: string, field:string, extent:array<number>}>}
function uv(e,t,n,a){t[0].type!=='Literal'&&u('First argument to indata must be a string literal.');var i=t[0].value,// vlMulti, vlMultiDomain have different # of params, but op is always last.
d=2<=t.length&&t[t.length-1].value;d!=='intersect'||a.hasOwnProperty('@unit')||(a['@unit']=n.getData(i).indataRef(n,'unit')),Jx(e,t,n,a)}/**
   * Materializes a point selection as a scale domain.
   * @param {string} name - The name of the dataset representing the selection.
   * @param {string} [encoding] - A particular encoding channel to materialize.
   * @param {string} [field] - A particular field to materialize.
   * @param {string} [op='intersect'] - The set operation for combining selections.
   * One of 'intersect' (default) or 'union'.
   * @returns {array} An array of values to serve as a scale domain.
   */function pv(e,t,a,d){var r=this.context.data[e],l=r?r.values.value:[],o=r?r['index:unit']&&r['index:unit'].value:void 0,s=l[0],f=0,c,p,g,m,h;if(s){for(c=t?s.encodings.length:s.fields.length;f<c;++f)if(t&&s.encodings[f]===t||a&&s.fields[f]===a){p=f,m=s['bin_'+s.fields[f]];break}// multi selections union within the same unit and intersect across units.
// if we've got only one unit, enforce union for more efficient materialization.
return o&&1===o.size&&(d='union'),o&&'intersect'===d?(h=l.reduce(function(e,t){var n=e[t.unit]||(e[t.unit]=[]);return n.push({unit:t.unit,value:t.values[p]}),e},{}),g=Object.keys(h).map(function(e){return{unit:e,value:m?hv(h[e],'union'):mv(h[e],'union')}})):g=l.map(function(e){return{unit:e.unit,value:e.values[p]}}),m?hv(g,d):mv(g,d)}}/**
   * Materializes an interval selection as a scale domain.
   * @param {string} name - The name of the dataset representing the selection.
   * @param {string} [encoding] - A particular encoding channel to materialize.
   * @param {string} [field] - A particular field to materialize.
   * @param {string} [op='union'] - The set operation for combining selections.
   * One of 'intersect' or 'union' (default).
   * @returns {array} An array of values to serve as a scale domain.
   */function gv(e,t,a,d){var r=this.context.data[e],l=r?r.values.value:[],o=l[0],s=0,f,c,u,p,g;if(o){for(f=o.intervals.length;s<f;++s)if(c=o.intervals[s],t&&c.encoding===t||a&&c.field===a){if(!c.extent)return;u=s,g=2<c.extent.length;break}return p=l.reduce(function(e,t){var n=t.intervals[u].extent,a=g?n.map(function(e){return{unit:t.unit,value:e}}):{unit:t.unit,value:n};return g?e.push.apply(e,a):e.push(a),e},[]),g?mv(p,d):hv(p,d)}}function mv(e,t){for(var a={},d=0,r={},l=[],o=0,s=e.length,n,f,c,u;o<s;++o)n=e[o],f=n.unit,u=n.value,a[f]||(a[f]=++d),(c=r[u])||(r[u]=c={value:u,units:{},count:0}),c.units[f]||(c.units[f]=++c.count);for(u in r)c=r[u],'intersect'===t&&c.count!==d||l.push(c.value);return l.length?l:void 0}function hv(e,t){for(var a='intersect'===t?bv:yv,d=0,r=e.length,n,l,o,s;d<r;++d)n=e[d].value,Y(n[0])&&(n=n.map(c)),o=n[0],s=n[1],o>s&&(s=n[0],o=n[1]),l=l?a(l,o,s):[o,s];return l&&l.length&&+l[0]!=+l[1]?l:void 0}function yv(e,t,n){return e[0]>t&&(e[0]=t),e[1]<n&&(e[1]=n),e}function bv(e,t,n){return n<e[0]||e[1]<t?[]:(e[0]<t&&(e[0]=t),e[1]>n&&(e[1]=n),e)}// Expression function context object
// AST visitors for dependency analysis
function _v(e,t,n){return 1===arguments.length?SM[e]:(SM[e]=t,n&&(zM[e]=n),RM&&(RM.functions[e]='this.'+e),this);// register with the functionContext
}// register expression functions with ast visitors
// Build expression function registry
// Export code generator and parameters
function xv(e,t,n){var a={},i,d;// parse the expression to an abstract syntax tree (ast)
try{e=m(e)?e:h(e)+'',i=Tx(e)}catch(t){u('Expression parse error: '+e)}// analyze ast function calls for dependencies
// return generated expression code and dependencies
return i.visit(function(e){if('CallExpression'===e.type){var n=e.callee.name,i=DM.visitors[n];i&&i(n,e.arguments,t,a)}}),d=RM(i),d.globals.forEach(function(e){var n='$'+e;!a.hasOwnProperty(n)&&t.getSignal(e)&&(a[n]=t.signalRef(e))}),{$expr:n?n+'return('+d.code+');':d.code,$fields:d.fields,$params:a}}function vv(e,t,n,a){this.id=-1,this.type=e,this.value=t,this.params=n,a&&(this.parent=a)}function kv(e,t,n,a){return new vv(e,t,n,a)}function wv(e,t){return kv('operator',e,t)}// -----
function Ev(e){var t={$ref:e.id};// if operator not yet registered, cache ref to resolve later
return 0>e.id&&(e.refs=e.refs||[]).push(t),t}function Sv(e,t){return t?{$field:e,$name:t}:{$field:e}}function Cv(e,t){return{$compare:e,$order:t}}function zv(e,t){var n={$key:e};return t&&(n.$flat=!0),n}// -----
function Dv(e){return g(e)?(e.order==='descending'?'-':'+')+Rv(e.op,e.field):''}function Rv(e,t){return(e&&e.signal?'$'+e.signal:e||'')+(e&&t?'_':'')+(t&&t.signal?'$'+t.signal:t||'')}// -----
function $v(e){return e&&e.signal}function Ov(e){if($v(e))return!0;if(g(e))for(var t in e)if(Ov(e[t]))return!0;return!1}function Tv(e,t){return null==e?t:e}function Av(e){return e&&e.signal||e}function Lv(e,t){var n=e.merge?Mv:e.stream?Uv:e.type?jv:u('Invalid stream specification: '+h(e));return n(e,t)}function Pv(e){return e==='scope'?'view':e||'view'}function Mv(e,t){var n=e.merge.map(function(e){return Lv(e,t)}),a=qv({merge:n},e,t);return t.addStream(a).id}function Uv(e,t){var n=Lv(e.stream,t),a=qv({stream:n},e,t);return t.addStream(a).id}function jv(e,t){var n,a;return'timer'===e.type?(n=t.event('timer',e.throttle),e={between:e.between,filter:e.filter}):n=t.event(Pv(e.source),e.type),a=qv({stream:n},e,t),1===Object.keys(a).length?n:t.addStream(a).id}function qv(e,t,n){var a=t.between;return a&&(2!==a.length&&u('Stream "between" parameter must have 2 entries: '+h(t)),e.between=[Lv(a[0],n),Lv(a[1],n)]),a=t.filter?P(t.filter):[],(t.marktype||t.markname||t.markrole)&&a.push(Fv(t.marktype,t.markname,t.markrole)),'scope'===t.source&&a.push('inScope(event.item)'),a.length&&(e.filter=xv('('+a.join(')&&(')+')').$expr),null!=(a=t.throttle)&&(e.throttle=+a),null!=(a=t.debounce)&&(e.debounce=+a),t.consume&&(e.consume=!0),e}function Fv(e,t,n){return'event.item'+(e&&'*'!==e?'&&event.item.mark.marktype===\''+e+'\'':'')+(n?'&&event.item.mark.role===\''+n+'\'':'')+(t?'&&event.item.mark.name===\''+t+'\'':'')}/**
   * Parse an event selector string.
   * Returns an array of event stream definitions.
   */function Iv(e,t,n){return xU=t||TM,vU=n||LM,Wv(e.trim()).map(Gv)}function Nv(e){return vU.hasOwnProperty(e)}function Bv(e,t,a,d,r){for(var l=0,o=e.length,n;t<o;++t){if(n=e[t],!l&&n===a)return t;r&&0<=r.indexOf(n)?--l:d&&0<=d.indexOf(n)&&++l}return t}function Wv(e){for(var t=[],a=0,d=e.length,n=0;n<d;)n=Bv(e,n,',','[{',']}'),t.push(e.substring(a,n).trim()),a=++n;if(0===t.length)throw'Empty event selector: '+e;return t}function Gv(e){return'['===e[0]?Yv(e):Hv(e)}function Yv(e){var t=e.length,n=1,a,d;if(n=Bv(e,n,']','[',']'),n===t)throw'Empty between selector: '+e;if(a=Wv(e.substring(1,n)),2!==a.length)throw'Between selector must have two elements: '+e;if(e=e.slice(n+1).trim(),'>'!==e[0])throw'Expected \'>\' after between selector: '+e;return(a=a.map(Gv),d=Gv(e.slice(1).trim()),d.between)?{between:a,stream:d}:(d.between=a,d)}function Hv(e){var t={source:xU},a=[],d=[0,0],r=0,l=0,o=e.length,f=0,c,u;// extract throttle from end
if('}'===e[o-1]){if(f=e.lastIndexOf('{'),0<=f){try{d=Vv(e.substring(f+1,o-1))}catch(t){throw'Invalid throttle specification: '+e}e=e.slice(0,f).trim(),o=e.length}else throw'Unmatched right brace: '+e;f=0}if(!o)throw e;// set name flag based on first char
if('@'===e[0]&&(r=++f),c=Bv(e,f,':'),c<o&&(a.push(e.substring(l,c).trim()),l=f=++c),f=Bv(e,f,'['),f===o)a.push(e.substring(l,o).trim());else if(a.push(e.substring(l,f).trim()),u=[],l=++f,l===o)throw'Unmatched left bracket: '+e;// extract filters
for(;f<o;){if(f=Bv(e,f,']'),f===o)throw'Unmatched left bracket: '+e;if(u.push(e.substring(l,f).trim()),f<o-1&&'['!==e[++f])throw'Expected left bracket: '+e;l=++f}// marshall event stream specification
if(!(o=a.length)||AM.test(a[o-1]))throw'Invalid event selector: '+e;return 1<o?(t.type=a[1],r?t.markname=a[0].slice(1):Nv(a[0])?t.marktype=a[0]:t.source=a[0]):t.type=a[0],'!'===t.type.slice(-1)&&(t.consume=!0,t.type=t.type.slice(0,-1)),null!=u&&(t.filter=u),d[0]&&(t.throttle=d[0]),d[1]&&(t.debounce=d[1]),t}function Vv(e){var t=e.split(',');if(!e.length||2<t.length)throw e;return t.map(function(t){var n=+t;if(n!=n)throw e;return n})}function Xv(e,t,n){var a=e.events,i=e.update,d=e.encode,r=[],l='',o;// separate event streams from signal updates
// resolve update value
a||u('Signal update missing events specification.'),m(a)&&(a=Iv(a,t.isSubscope()?'scope':'view')),a=P(a).filter(function(e){return e.signal||e.scale?(r.push(e),0):1}),a.length&&r.push(1<a.length?{merge:a}:a[0]),null!=d&&(i&&u('Signal encode and update are mutually exclusive.'),i='encode(item(),'+h(d)+')'),l=m(i)?xv(i,t,'var datum=event.item&&event.item.datum;'):null==i.expr?null==i.value?null==i.signal?u('Invalid signal update specification.'):{$expr:'_.value',$params:{value:t.signalRef(i.signal)}}:i.value:xv(i.expr,t,'var datum=event.item&&event.item.datum;'),o={target:n,update:l},e.force&&(o.options={force:!0}),r.forEach(function(e){t.addUpdate(F(Zv(e,t),o))})}function Zv(e,t){return{source:e.signal?t.signalRef(e.signal):e.scale?t.scaleRef(e.scale):Lv(e,t)}}function Jv(e,t){var n=t.getSignal(e.name),a=e.update;e.init&&(a?u('Signals can not include both init and update expressions.'):(a=e.init,n.initonly=!0)),a&&(a=xv(a,t),n.update=a.$expr,n.params=a.$params),e.on&&e.on.forEach(function(e){Xv(e,t,n.id)})}function Qv(e){return function(t,n,a){return kv(e,n,t||void 0,a)}}function Kv(e){return gU.hasOwnProperty(e)}function ek(e){return uU.hasOwnProperty(e)}function tk(e){return pU.hasOwnProperty(e)}function nk(e){return'quantile'===e}function ak(e,t){var n=e.type||'linear';cU.hasOwnProperty(n)||u('Unrecognized scale type: '+h(n)),t.addScale(e.name,{type:n,domain:void 0})}function ik(e,t){var n=t.getScale(e.name).params,a;for(a in n.domain=ok(e.domain,e,t),null!=e.range&&(n.range=_k(e,t,n)),null!=e.interpolate&&bk(e.interpolate,n),null!=e.nice&&yk(e.nice,n),e)n.hasOwnProperty(a)||'name'===a||(n[a]=dk(e[a],t))}function dk(e,t){return g(e)?e.signal?t.signalRef(e.signal):u('Unsupported object: '+h(e)):e}function rk(e,t){return e.signal?t.signalRef(e.signal):e.map(function(e){return dk(e,t)})}function lk(e){u('Can not find data set: '+h(e))}// -- SCALE DOMAIN ----
function ok(e,t,n){return e?e.signal?n.signalRef(e.signal):(hS(e)?sk:e.fields?ck:fk)(e,t,n):void((null!=t.domainMin||null!=t.domainMax)&&u('No scale domain defined for domainMin/domainMax to override.'))}function sk(e,t,n){return e.map(function(e){return dk(e,n)})}function fk(e,t,n){var a=n.getData(e.data);return a||lk(e.data),Kv(t.type)?a.valuesRef(n,e.field,gk(e.sort,!1)):nk(t.type)?a.domainRef(n,e.field):a.extentRef(n,e.field)}function ck(e,t,n){var a=e.data,i=e.fields.reduce(function(e,t){return t=m(t)?{data:a,field:t}:hS(t)||t.signal?uk(t,n):t,e.push(t),e},[]);return(Kv(t.type)?pk:nk(t.type)?mk:hk)(e,n,i)}function uk(e,t){var n='_:vega:_'+sU++,a=jM({});if(hS(e))a.value={$ingest:e};else if(e.signal){var i='setdata('+h(n)+','+e.signal+')';a.params.input=t.signalRef(i)}return t.addDataPipeline(n,[a,dU({})]),{data:n,field:'data'}}function pk(e,t,n){var i,d,r,l;// get value counts for each domain field
return i=n.map(function(e){var n=t.getData(e.data);return n||lk(e.data),n.countsRef(t,e.field)}),d=t.add(PM({groupby:OM,ops:['sum'],fields:[t.fieldRef('count')],as:['count'],pulse:i})),r=t.add(jM({pulse:Ev(d)})),l=t.add(oU({field:OM,sort:t.sortRef(gk(e.sort,!0)),pulse:Ev(r)})),Ev(l)}function gk(e,t){return e&&(e.field||e.op?e.field||'count'===e.op?t&&e.field?u('Multiple domain scales can not sort by field.'):t&&e.op&&'count'!==e.op&&u('Multiple domain scales support op count only.'):u('No field provided for sort aggregate op: '+e.op):g(e)?e.field='key':e={field:'key'}),e}function mk(e,t,n){// get value arrays for each domain field
var a=n.map(function(e){var n=t.getData(e.data);return n||lk(e.data),n.domainRef(t,e.field)});// combine value arrays
return Ev(t.add(ZM({values:a})))}function hk(e,t,n){// get extents for each domain field
var a=n.map(function(e){var n=t.getData(e.data);return n||lk(e.data),n.extentRef(t,e.field)});// combine extents
return Ev(t.add(XM({extents:a})))}// -- SCALE NICE -----
function yk(e,t){t.nice=g(e)?{interval:dk(e.interval),step:dk(e.step)}:dk(e)}// -- SCALE INTERPOLATION -----
function bk(e,t){t.interpolate=dk(e.type||e),null!=e.gamma&&(t.interpolateGamma=dk(e.gamma))}// -- SCALE RANGE -----
function _k(e,t,n){var a=e.range,i=t.config.range;if(a.signal)return t.signalRef(a.signal);if(m(a)){if(i&&i.hasOwnProperty(a))return e=F({},e,{range:i[a]}),_k(e,t,n);'width'===a?a=[0,{signal:'width'}]:'height'===a?a=Kv(e.type)?[0,{signal:'height'}]:[{signal:'height'},0]:u('Unrecognized scale range value: '+h(a))}else{if(a.scheme)return n.scheme=dk(a.scheme,t),a.extent&&(n.schemeExtent=rk(a.extent,t)),void(a.count&&(n.schemeCount=dk(a.count,t)));if(a.step)return void(n.rangeStep=dk(a.step,t));if(Kv(e.type)&&!hS(a))return ok(a,e,t);hS(a)||u('Unsupported range type: '+h(a))}return a.map(function(e){return dk(e,t)})}function xk(e,t){var n={};for(var a in e)'name'!==a&&(n[a]=vk(e[a],a,t));t.addProjection(e.name,n)}function vk(e,t,n){return hS(e)?e.map(function(e){return vk(e,t,n)}):g(e)?e.signal?n.signalRef(e.signal):'fit'===t?e:u('Unsupported parameter object: '+h(e)):e}function kk(e,t){var n='';return yU[t]?n:(e.x2&&(e.x?(bU[t]&&(n+='if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;'),n+='o.width=o.x2-o.x;'):n+='o.x=o.x2-(o.width||0);'),e.xc&&(n+='o.x=o.xc-(o.width||0)/2;'),e.y2&&(e.y?(bU[t]&&(n+='if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;'),n+='o.height=o.y2-o.y;'):n+='o.y=o.y2-(o.height||0);'),e.yc&&(n+='o.y=o.yc-(o.height||0)/2;'),n)}function wk(e,t,n,i){function d(e,d,r,l){var o=Tk(null,d,t,n,i),a=Tk(null,r,t,n,i),s=Tk(null,l,t,n,i);return'this.'+e+'('+[o,a,s].join(',')+').toString()'}return e.c?d('hcl',e.h,e.c,e.l):e.h||e.s?d('hsl',e.h,e.s,e.l):e.l||e.a?d('lab',e.l,e.a,e.b):e.r||e.g||e.b?d('rgb',e.r,e.g,e.b):null}function Ek(e,t,n,a){var i=xv(e,t);return i.$fields.forEach(function(e){a[e]=1}),F(n,i.$params),i.$expr}function Sk(e,t,n,a){return Ck(g(e)?e:{datum:e},t,n,a)}function Ck(e,t,n,a){var i,d,r;if(e.signal)i='datum',r=Ek(e.signal,t,n,a);else if(e.group||e.parent){for(d=fS(1,e.level||1),i='item';0<d--;)i+='.mark.group';e.parent?(r=e.parent,i+='.datum'):r=e.group}else e.datum?(i='datum',r=e.datum):u('Invalid field reference: '+h(e));return e.signal||(m(r)?(a[r]=1,r=p(r).map(h).join('][')):r=Ck(r,t,n,a)),i+'['+r+']'}function zk(e,t,n,a,i){var d=Rk(e.scale,n,a,i),r,l,o;return null==e.range?(void 0!==t&&(t=d+'('+t+')'),e.band&&(o=Dk(e.scale,n))&&(l=d+'.bandwidth',r=+e.band,r=l+'()'+(1==r?'':'*'+r),0>o&&(r='('+l+'?'+r+':0)'),t=(t?t+'+':'')+r,e.extra&&(t='(datum.extra?'+d+'(datum.extra.value):'+t+')')),null==t&&(t='0')):(r=+e.range,l=d+'.range()',t=0===r?l+'[0]':'($='+l+','+(1===r?'$[$.length-1]':'$[0]+'+r+'*($[$.length-1]-$[0])')+')'),t}function Dk(e,t){if(!m(e))return-1;var n=t.scaleType(e);return'band'===n||'point'===n?1:0}function Rk(e,t,n,a){if(m(e))// direct scale lookup; add scale as parameter
i='%'+e,n.hasOwnProperty(i)||(n[i]=t.scaleRef(e)),i=h(i);else{// indirect scale lookup; add all scales as parameters
for(var i in t.scales)n['%'+i]=t.scaleRef(i);i=h('%')+'+'+(e.signal?'('+Ek(e.signal,t,n,a)+')':Sk(e,t,n,a))}return'_['+i+']'}function $k(e,t,n,a){return'this.gradient('+Rk(e.gradient,t,n,a)+','+h(e.start)+','+h(e.stop)+','+h(e.count)+')'}function Ok(e,t,n,a){return g(e)?'('+Tk(null,e,t,n,a)+')':e}function Tk(e,t,n,a,i){if(null!=t.gradient)return $k(t,n,a,i);var d=t.signal?Ek(t.signal,n,a,i):t.color?wk(t.color,n,a,i):null==t.field?void 0===t.value?void 0:h(t.value):Sk(t.field,n,a,i);return null!=t.scale&&(d=zk(t,d,n,a,i)),void 0===d&&(d=null),null!=t.exponent&&(d='Math.pow('+d+','+Ok(t.exponent,n,a,i)+')'),null!=t.mult&&(d+='*'+Ok(t.mult,n,a,i)),null!=t.offset&&(d+='+'+Ok(t.offset,n,a,i)),t.round&&(d='Math.round('+d+')'),d}function Ak(e,t,n){return e+'['+h(t)+']='+n+';'}function Lk(e,t,n,a,i){var d='';return t.forEach(function(t){var r=Tk(e,t,n,a,i);d+=t.test?Ek(t.test,n,a,i)+'?'+r+':':r}),':'===f(d)&&(d+='null'),Ak('o',e,d)}function Pk(e,t,n,a){var i={},d='var o=item,datum=o.datum,$;',r,l,o;for(r in e)l=e[r],hS(l)?d+=Lk(r,l,a,n,i):(o=Tk(r,l,a,n,i),d+=Ak('o',r,o));return d+=kk(e,t),d+='return 1;',{$expr:d,$fields:Object.keys(i),$output:Object.keys(e)}}function Mk(e){return g(e)?F({},e):{value:e}}function Uk(e,t,n,a){return null==n?0:(g(n)&&!hS(n)?e.update[t]=n:e[a||'enter'][t]={value:n},1)}function jk(e,t,n){for(var a in t)n&&n.hasOwnProperty(a)||(e[a]=F(e[a]||{},t[a]));return e}function qk(e,t,n,a,i,d){var r,l;for(l in d=d||{},d.encoders={$encode:r={}},e=Fk(e,t,n,a,i.config),e)r[l]=Pk(e[l],t,d,i);return d}function Fk(e,t,n,a,i){var d={},r,l,o;// ignore legend and axis
for(r in('legend'==n||0===(n+'').indexOf('axis'))&&(n=null),o='frame'===n?i.group:'mark'===n?F({},i.mark,i[t]):null,o)// do not apply defaults if relevant fields are defined
l=Nk(r,e)||('fill'===r||'stroke'===r)&&(Nk('fill',e)||Nk('stroke',e)),l||(d[r]=Ik(o[r]));// resolve styles, apply with increasing precedence
return P(a).forEach(function(t){var n=i.style&&i.style[t];for(var a in n)Nk(a,e)||(d[a]=Ik(n[a]))}),e=F({},e),e.enter=F(d,e.enter),e}function Ik(e){return e&&e.signal?{signal:e.signal}:{value:e}}function Nk(e,t){return t&&(t.enter&&t.enter[e]||t.update&&t.update[e])}function Bk(e,t,n,a,i,d,r){return{type:e,name:r?r.name:void 0,role:t,style:r&&r.style||n,key:a,from:i,interactive:!!(r&&r.interactive),encode:jk(d,r,hU)}}function Wk(e,t,n){return Tv(t[e],n[e])}function Gk(e,t){return Tv(e.direction,t)==='vertical'}function Yk(e,t){return Tv(e.gradientLength,t.gradientLength||t.gradientWidth)}function Hk(e,t){return Tv(e.gradientThickness,t.gradientThickness||t.gradientHeight)}function Vk(e,t){return Tv(e.columns,Tv(t.columns,+Gk(e,t.symbolDirection)))}function Xk(e,t){var n=t&&(t.update&&t.update[e]||t.enter&&t.enter[e]);return n&&n.signal?n:n?n.value:null}function Zk(e,t,n){var a=t.config.style[n];return a&&a[e]}function Jk(e,t,n,a){var i={value:0},d=Gk(e,n.gradientDirection),r=Hk(e,n),l=Yk(e,n),o,s,f,c,u,p;return d?(f=[0,1],c=[0,0],u=r,p=l):(f=[0,0],c=[1,0],u=l,p=r),o={enter:s={opacity:i,x:i,y:i,width:Mk(u),height:Mk(p)},update:F({},s,{opacity:{value:1},fill:{gradient:t,start:f,stop:c}}),exit:{opacity:i}},Uk(o,'stroke',Wk('gradientStrokeColor',e,n)),Uk(o,'strokeWidth',Wk('gradientStrokeWidth',e,n)),Uk(o,'opacity',Wk('gradientOpacity',e,n),'update'),Bk('rect','legend-gradient',null,void 0,void 0,o,a)}function Qk(e,t,n,a,i){var d={value:0},r=Gk(e,n.gradientDirection),l=Hk(e,n),o=Yk(e,n),s='',f,c,p,g,m,h;return r?(p='y',m='y2',g='x',h='width',s='1-'):(p='x',m='x2',g='y',h='height'),c={opacity:d,fill:{scale:t,field:'value'}},c[p]={signal:s+'datum.perc',mult:o},c[g]=d,c[m]={signal:s+'datum.perc2',mult:o},c[h]=Mk(l),f={enter:c,update:F({},c,{opacity:{value:1}}),exit:{opacity:d}},Uk(f,'stroke',Wk('gradientStrokeColor',e,n)),Uk(f,'strokeWidth',Wk('gradientStrokeWidth',e,n)),Uk(f,'opacity',Wk('gradientOpacity',e,n),'update'),Bk('rect','legend-band',null,'value',i,f,a)}function Kk(e,t,n,a){var i={value:0},d=Gk(e,t.gradientDirection),r=Mk(Hk(e,t)),l=Yk(e,t),o=Wk('labelOverlap',e,t),s='',f,c,p,g,m;return f={enter:c={opacity:i},update:p={opacity:{value:1},text:{field:'label'}},exit:{opacity:i}},Uk(f,'fill',Wk('labelColor',e,t)),Uk(f,'font',Wk('labelFont',e,t)),Uk(f,'fontSize',Wk('labelFontSize',e,t)),Uk(f,'fontWeight',Wk('labelFontWeight',e,t)),Uk(f,'fillOpacity',Wk('labelOpacity',e,t)),Uk(f,'limit',Tv(e.labelLimit,t.gradientLabelLimit)),d?(c.align={value:'left'},c.baseline=p.baseline={signal:'datum.perc<=0?"bottom":datum.perc>=1?"top":"middle"'},g='y',m='x',s='1-'):(c.align=p.align={signal:'datum.perc<=0?"left":datum.perc>=1?"right":"center"'},c.baseline={value:'top'},g='x',m='y'),c[g]=p[g]={signal:s+'datum.perc',mult:l},c[m]=p[m]=r,r.offset=Tv(e.labelOffset,t.gradientLabelOffset)||0,e=Bk('text','legend-label','guide-label','value',a,f,n),o&&(e.overlap={method:o,order:'datum.index'}),e}function ew(e,t,n,a,i,d,r,l){return{type:'group',name:n,role:e,style:t,from:a,interactive:i||!1,encode:d,marks:r,layout:l}}// userEncode is top-level, includes entries, symbols, labels
function tw(e,t,n,a,i){var d=n.entries,r=!!(d&&d.interactive),l=d?d.name:void 0,o=Wk('clipHeight',e,t),s=Wk('symbolOffset',e,t),f={data:'value'},c={},u=i+'?datum.offset:datum.size',p=o?Mk(o):{field:'size'},g='max(1,'+i+')',m,h,y,b,_,x,v;return p.mult=.5,c={enter:m={opacity:_U,x:{signal:u,mult:.5,offset:s},y:p},update:h={opacity:{value:1},x:m.x,y:m.y},exit:{opacity:_U}},e.fill||(Uk(c,'fill',t.symbolBaseFillColor),Uk(c,'stroke',t.symbolBaseStrokeColor)),Uk(c,'shape',Wk('symbolType',e,t)),Uk(c,'size',Wk('symbolSize',e,t)),Uk(c,'strokeWidth',Wk('symbolStrokeWidth',e,t)),Uk(c,'fill',Wk('symbolFillColor',e,t)),Uk(c,'stroke',Wk('symbolStrokeColor',e,t)),Uk(c,'opacity',Wk('symbolOpacity',e,t),'update'),mU.forEach(function(t){e[t]&&(h[t]=m[t]={scale:e[t],field:'value'})}),b=Bk('symbol','legend-symbol',null,'value',f,c,n.symbols),o&&(b.clip=!0),y=Mk(s),y.offset=Wk('labelOffset',e,t),c={enter:m={opacity:_U,x:{signal:u,offset:y},y:p},update:h={opacity:{value:1},text:{field:'label'},x:m.x,y:m.y},exit:{opacity:_U}},Uk(c,'align',Wk('labelAlign',e,t)),Uk(c,'baseline',Wk('labelBaseline',e,t)),Uk(c,'fill',Wk('labelColor',e,t)),Uk(c,'font',Wk('labelFont',e,t)),Uk(c,'fontSize',Wk('labelFontSize',e,t)),Uk(c,'fontWeight',Wk('labelFontWeight',e,t)),Uk(c,'limit',Wk('labelLimit',e,t)),Uk(c,'fillOpacity',Wk('labelOpacity',e,t)),_=Bk('text','legend-label','guide-label','value',f,c,n.labels),c={enter:{noBound:{value:!0},// ignore width/height in bounds calc
width:_U,height:o?Mk(o):_U,opacity:_U},exit:{opacity:_U},update:h={opacity:{value:1},row:{signal:null},column:{signal:null}}},Gk(e,t.symbolDirection)?(x='ceil(item.mark.items.length/'+g+')',h.row.signal='datum.index%'+x,h.column.signal='floor(datum.index/'+x+')',v={field:['row','datum.index']}):(h.row.signal='floor(datum.index/'+g+')',h.column.signal='datum.index%'+g,v={field:'datum.index'}),h.column.signal=i+'?'+h.column.signal+':datum.index',a={facet:{data:a,name:'value',groupby:'index'}},e=ew('scope',null,l,a,r,jk(c,d,hU),[b,_]),e.sort=v,e}function nw(e,t){// layout parameters for legend entries
return{align:Wk('gridAlign',e,t),center:{row:!0,column:!1},columns:Vk(e,t),padding:{row:Wk('rowPadding',e,t),column:Wk('columnPadding',e,t)}}}function aw(e,t,n,a){var i={value:0},d,r;return d={enter:r={opacity:i,x:{field:{group:'padding'}},y:{field:{group:'padding'}}},update:{opacity:{value:1},text:Mk(e.title),x:r.x,y:r.y},exit:{opacity:i}},Uk(d,'align',Wk('titleAlign',e,t)),Uk(d,'baseline',Wk('titleBaseline',e,t)),Uk(d,'fill',Wk('titleColor',e,t)),Uk(d,'font',Wk('titleFont',e,t)),Uk(d,'fontSize',Wk('titleFontSize',e,t)),Uk(d,'fontWeight',Wk('titleFontWeight',e,t)),Uk(d,'limit',Wk('titleLimit',e,t)),Uk(d,'fillOpacity',Wk('titleOpacity',e,t)),Bk('text','legend-title','guide-title',null,a,d,n)}function iw(e,t){var n;return g(e)&&(e.signal?n=e.signal:e.path?n='pathShape('+dw(e.path)+')':e.sphere&&(n='geoShape('+dw(e.sphere)+', {type: "Sphere"})')),n?t.signalRef(n):!!e}function dw(e){return g(e)&&e.signal?e.signal:h(e)}function rw(e){var t=e.role||'';return t.indexOf('axis')&&t.indexOf('legend')?e.type==='group'?'scope':t||'mark':t}function lw(e){return{marktype:e.type,name:e.name||void 0,role:e.role||rw(e),zindex:+e.zindex||void 0}}function ow(e,t){return e&&e.signal?t.signalRef(e.signal):!1!==e}/**
   * Parse a data transform specification.
   */function sw(e,n){var a=Rn(e.type);a||u('Unrecognized transform type: '+h(e.type));var i=kv(a.type.toLowerCase(),null,fw(a,e,n));return e.signal&&n.addSignal(e.signal,n.proxy(i)),i.metadata=a.metadata||{},i}/**
   * Parse all parameters of a data transform.
   */function fw(e,t,a){var d={},r,l,o;for(l=0,o=e.params.length;l<o;++l)r=e.params[l],d[r.name]=cw(r,t,a);return d}/**
   * Parse a data transform parameter.
   */function cw(e,t,n){var a=e.type,i=t[e.name];if('index'===a)return pw(e,t,n);return void 0===i?void(e.required&&u('Missing required '+h(t.type)+' parameter: '+h(e.name))):'param'===a?gw(e,t,n):'projection'===a?n.projectionRef(t[e.name]):e.array&&!$v(i)?i.map(function(t){return uw(e,t,n)}):uw(e,i,n)}/**
   * Parse a single parameter value.
   */function uw(e,t,n){var a=e.type;if($v(t))return _w(a)?u('Expression references can not be signals.'):xw(a)?n.fieldRef(t):vw(a)?n.compareRef(t):n.signalRef(t.signal);var i=e.expr||xw(a);return i&&hw(t)?n.exprRef(t.expr,t.as):i&&yw(t)?Sv(t.field,t.as):_w(a)?xv(t,n):bw(a)?Ev(n.getData(t).values):xw(a)?Sv(t):vw(a)?n.compareRef(t):t}/**
   * Parse parameter for accessing an index of another data set.
   */function pw(e,t,n){return m(t.from)||u('Lookup "from" parameter must be a string literal.'),n.getData(t.from).lookupRef(n,t.key)}/**
   * Parse a parameter that contains one or more sub-parameter objects.
   */function gw(e,t,n){var a=t[e.name];return e.array?(hS(a)||u('Expected an array of sub-parameters. Instead: '+h(a)),a.map(function(t){return mw(e,t,n)})):mw(e,a,n)}/**
   * Parse a sub-parameter object.
   */function mw(e,t,a){var d,r,l,o,s;// loop over defs to find matching key
for(o=0,s=e.params.length;o<s;++o){for(l in r=e.params[o],r.key)if(r.key[l]!==t[l]){r=null;break}if(r)break}// raise error if matching key not found
return r||u('Unsupported parameter: '+h(t)),d=F(fw(r,t,a),r.key),Ev(a.add(QM(d)))}// -- Utilities -----
function hw(e){return e&&e.expr}function yw(e){return e&&e.field}function bw(e){return'data'===e}function _w(e){return'expr'===e}function xw(e){return'field'===e}function vw(e){return'compare'===e}function kw(e,t,n){var a,i,d,r,l;// if no source data, generate singleton datum
return e?(a=e.facet)&&(!t&&u('Only group marks can be faceted.'),null==a.field?(e.data?l=Ev(n.getData(e.data).aggregate):(d=sw(F({type:'aggregate',groupby:P(a.groupby)},a.aggregate),n),d.params.key=n.keyRef(a.groupby),d.params.pulse=ww(a,n),r=l=Ev(n.add(d))),i=n.keyRef(a.groupby,!0)):r=l=ww(a,n)):r=Ev(n.add(jM(null,[{}]))),r||(r=ww(e,n)),{key:i,pulse:r,parent:l}}function ww(e,t){return e.$ref?e:e.data&&e.data.$ref?e.data:Ev(t.getData(e.data).output)}function Ew(e,t,n,a,i){// parent scope object
// first operator in pipeline (tuple input)
// last operator in pipeline (tuple output)
// operator for accessing tuples (but not tuple flow)
// last aggregate in transform pipeline
// lookup table of field indices
this.scope=e,this.input=t,this.output=n,this.values=a,this.aggregate=i,this.index={}}function Sw(e){return m(e)?e:null}function Cw(e,t,a){var d=Rv(a.op,a.field),r;if(t.ops){for(var l=0,o=t.as.length;l<o;++l)if(t.as[l]===d)return;}else t.ops=['count'],t.fields=[null],t.as=['count'];a.op&&(t.ops.push((r=a.op.signal)?e.signalRef(r):a.op),t.fields.push(e.fieldRef(a.field)),t.as.push(d))}function zw(e,t,n,a,i,d,r){var l=t[n]||(t[n]={}),o=Dv(d),s=Sw(i),f,c;if(null!=s&&(e=t.scope,s+=o?'|'+o:'',f=l[s]),!f){var u=d?{field:OM,pulse:t.countsRef(e,i,d)}:{field:e.fieldRef(i),pulse:Ev(t.output)};o&&(u.sort=e.sortRef(d)),c=e.add(kv(a,void 0,u)),r&&(t.index[i]=c),f=Ev(c),null!=s&&(l[s]=f)}return f}function Dw(e,t,n){var a=e.from.facet,i=a.name,d=ww(a,t),r,l,o,s;// initialize facet subscope
// parse faceted subflow
a.name||u('Facet must have a name: '+h(a)),a.data||u('Facet must reference a data set: '+h(a)),a.field?s=t.add(KM({field:t.fieldRef(a.field),pulse:d})):a.groupby?s=t.add(BM({key:t.keyRef(a.groupby),group:Ev(t.proxy(n.parent)),pulse:d})):u('Facet must specify groupby or field: '+h(a)),r=t.fork(),l=r.add(jM()),o=r.add(dU({pulse:Ev(l)})),r.addData(i,new Ew(r,l,l,o)),r.addSignal('parent',null),s.params.subflow={$subflow:tE(e,r).toRuntime()}}function Rw(e,t,n){var a=t.add(KM({pulse:n.pulse})),i=t.fork();// parse group mark subflow
i.add(dU()),i.addSignal('parent',null),a.params.subflow={$subflow:tE(e,i).toRuntime()}}function $w(e,t,n){var a=e.remove,i=e.insert,d=e.toggle,r=e.modify,l=e.values,o=t.add(wv()),s,f;s='if('+e.trigger+',modify("'+n+'",'+[i,a,d,r,l].map(function(e){return null==e?'null':e}).join(',')+'),0)',f=xv(s,t),o.update=f.$expr,o.params=f.$params}function Ow(e,t){var n=rw(e),a=e.type==='group',i=e.from&&e.from.facet,d=e.layout||n==='scope'||n==='frame',r=n==='mark'||d||i,l=e.overlap,o,s,f,c,p,g,m,h,y,b,_,x,v;// resolve input data
// data join to map tuples to visual items
// collect visual items
// connect visual items to scenegraph
// add visual encoders
// monitor parent marks to propagate changes
// compute bounding boxes
// render / sieve items
f=kw(e.from,a,t),s=t.add(FM({key:f.key||(e.key?Sv(e.key):void 0),pulse:f.pulse,clean:!a})),y=Ev(s),s=c=t.add(jM({pulse:y})),s=t.add(VM({markdef:lw(e),interactive:ow(e.interactive,t),clip:iw(e.clip,t),context:{$context:!0},groups:t.lookup(),parent:t.signals.parent?t.signalRef('parent'):null,index:t.markpath(),pulse:Ev(s)})),b=Ev(s),s=t.add(IM(qk(e.encode,e.type,n,e.style,t,{pulse:b}))),s.params.parent=t.encode(),e.transform&&e.transform.forEach(function(e){var n=sw(e,t);(n.metadata.generates||n.metadata.changes)&&u('Mark transforms should not generate new data.'),n.params.pulse=Ev(s),t.add(s=n)}),e.sort&&(s=t.add(rU({sort:t.compareRef(e.sort,!0),// stable sort
pulse:Ev(s)}))),_=Ev(s),(i||d)&&(d=t.add(lU({layout:t.objectProperty(e.layout),legendMargin:t.config.legendMargin,mark:b,pulse:_})),x=Ev(d)),p=t.add(UM({mark:b,pulse:x||_})),v=Ev(p),a&&(r&&(o=t.operators,o.pop(),d&&o.pop()),t.pushState(_,x||v,y),i?Dw(e,t,f)// explicit facet
:r?Rw(e,t,f)// standard mark group
:tE(e,t),t.popState(),r&&(d&&o.push(d),o.push(p))),l&&(v=Tw(l,v,t)),g=t.add(aU({pulse:v})),m=t.add(dU({pulse:Ev(g)},void 0,t.parent())),null!=e.name&&(h=e.name,t.addData(h,new Ew(t,c,g,m)),e.on&&e.on.forEach(function(e){(e.insert||e.remove||e.toggle)&&u('Marks only support modify triggers.'),$w(e,t,h)}))}function Tw(e,t,n){var a=e.method,i=e.bound,d={method:$v(a)?n.signalRef(a.signal):a,pulse:t},r;return e.order&&(d.sort=n.compareRef({field:e.order})),i&&(r=i.tolerance,d.boundTolerance=$v(r)?n.signalRef(r.signal):+r,d.boundScale=n.scaleRef(i.scale),d.boundOrient=i.orient),Ev(n.add(JM(d)))}function Aw(e,t){var n=t.config.legend,a=e.encode||{},i=a.legend||{},d=i.name||void 0,r=i.interactive,l=i.style,o=mU.reduce(function(t,n){return t||e[n]},0),s,f,c,p,g,m,h,y,b;// resolve 'canonical' scale name
// parse legend specification
return o||u('Missing valid scale for legend.'),g=Lw(e,t.scaleType(o)),m={orient:Wk('orient',e,n),title:null!=e.title,type:g},h=Ev(t.add(jM(null,[m]))),i=jk(Mw(e,n),i,hU),s={enter:{x:{value:0},y:{value:0}}},y=Ev(t.add(YM(c={type:g,scale:t.scaleRef(o),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),formatSpecifier:t.property(e.format)}))),'gradient'===g?(p=[Jk(e,o,n,a.gradient),Kk(e,n,a.labels,y)],c.count=c.count||t.signalRef('max(2,2*floor(('+Av(Yk(e,n))+')/100))')):'discrete'===g?p=[Qk(e,o,n,a.gradient,y),Kk(e,n,a.labels,y)]:(f=nw(e,n),p=[tw(e,n,a,y,Av(f.columns))],c.size=Uw(e,t,p[0].marks)),p=[ew('legend-entry',null,null,h,r,s,p,f)],m.title&&p.push(aw(e,n,a.title,h)),b=ew('legend',l,d,h,r,i,p),e.zindex&&(b.zindex=e.zindex),Ow(b,t)}function Lw(e,t){var n=e.type||'symbol';return!e.type&&1===Pw(e)&&(e.fill||e.stroke)&&(n=tk(t)?'gradient':ek(t)?'discrete':'symbol'),'gradient'===n?ek(t)?'discrete':'gradient':n}function Pw(e){return mU.reduce(function(t,n){return t+(e[n]?1:0)},0)}function Mw(e,t){var n={enter:{},update:{}};return Uk(n,'offset',Wk('offset',e,t)),Uk(n,'padding',Wk('padding',e,t)),Uk(n,'titlePadding',Wk('titlePadding',e,t)),Uk(n,'fill',Wk('fillColor',e,t)),Uk(n,'stroke',Wk('strokeColor',e,t)),Uk(n,'strokeWidth',Wk('strokeWidth',e,t)),Uk(n,'cornerRadius',Wk('cornerRadius',e,t)),Uk(n,'strokeDash',t.strokeDash),n}function Uw(e,t,n){var a,i,d,r;return d=Xk('strokeWidth',n[0].encode),i=e.size?'scale("'+e.size+'",datum)':Xk('size',n[0].encode,t),a=jw(n[1].encode,t,'guide-label'),r='max(ceil(sqrt('+Av(i)+')+'+Av(d)+'),'+Av(a)+')',xv(r,t)}function jw(e,t,n){return Xk('fontSize',e)||Zk('fontSize',t,n)}function qw(e,t,n){return'item.anchor==="start"?'+e+':item.anchor==="'+'end'+'"?'+t+':'+n}// title text alignment
function Fw(e,t){e=m(e)?{text:e}:e;var n=t.config.title,a=F({},e.encode),i,d,r;// single-element data source for group title
// parse title specification
return i={orient:Wk('orient',e,n)},d=Ev(t.add(jM(null,[i]))),a.name=e.name,a.interactive=e.interactive,r=Iw(e,n,a,d),e.zindex&&(r.zindex=e.zindex),Ow(r,t)}function Iw(e,t,n,a){var i={value:0},d=e.text,r=Wk('orient',e,t),l=Wk('anchor',e,t),o='left'===r||'top'===r?-1:1,s='top'===r||'bottom'===r,f={group:s?'width':'height'},c,u,p,g,m;// title positioning along orientation axis
return g={field:f,mult:{signal:EU}},m=0>o?i:s?{field:{group:'height'}}:{field:{group:'width'}},c={enter:u={opacity:i},update:p={opacity:{value:1},text:Mk(d),anchor:Mk(l),orient:Mk(r),extent:{field:f},align:{signal:wU}},exit:{opacity:i}},s?(p.x=g,p.y=m,u.angle=i,u.baseline={value:'top'===r?'bottom':'top'}):(p.x=m,p.y=g,u.angle={value:90*o},u.baseline={value:'bottom'}),Uk(c,'align',Wk('align',e,t),'update'),Uk(c,'angle',Wk('angle',e,t)),Uk(c,'baseline',Wk('baseline',e,t)),Uk(c,'fill',Wk('color',e,t)),Uk(c,'font',Wk('font',e,t)),Uk(c,'fontSize',Wk('fontSize',e,t)),Uk(c,'fontWeight',Wk('fontWeight',e,t)),Uk(c,'frame',Wk('frame',e,t)),Uk(c,'limit',Wk('limit',e,t)),Uk(c,'offset',Wk('offset',e,t)||0),Bk('text','title',e.style||'group-title',null,a,c,n)}function Nw(e,t){var n=[];e.transform&&e.transform.forEach(function(e){n.push(sw(e,t))}),e.on&&e.on.forEach(function(n){$w(n,t,e.name)}),t.addDataPipeline(e.name,Bw(e,t,n))}/**
   * Analyze a data pipeline, add needed operators.
   */function Bw(e,a,d){// POSSIBLE TODOs:
// - error checking for treesource on tree operators (BUT what if tree is upstream?)
// - this is local analysis, perhaps some tasks better for global analysis...
var r=[],l=null,o=!1,s=!1,f,c,u,p,g;// scan data transforms, add collectors as needed
for(e.values?r.push(l=Ww({$ingest:e.values,$format:e.format})):e.url?(l=Ov(e.url)||Ov(e.format)?{$load:Ev(a.add(Gw(a,e,l)))}:{$request:e.url,$format:e.format},r.push(l=Ww(l))):e.source&&(l=f=P(e.source).map(function(e){return Ev(a.getData(e).output)}),r.push(null)),c=0,u=d.length;c<u;++c)p=d[c],g=p.metadata,l||g.source||r.push(l=Ww()),r.push(p),g.generates&&(s=!0),g.modifies&&!s&&(o=!0),g.source?l=p:g.changes&&(l=null);return f&&(u=f.length-1,r[0]=nU({derive:o,pulse:u?f:f[0]}),(o||u)&&r.splice(1,0,Ww())),l||r.push(Ww()),r.push(dU({})),r}function Ww(e){var t=jM({},e);return t.metadata={source:!0},t}function Gw(e,t){return HM({url:e.property(t.url),format:e.objectProperty(t.format)})}function Yw(e,t){var n=t.config,a=e.orient,i=a==='top'||a==='bottom'?n.axisX:n.axisY,d=n['axis'+a[0].toUpperCase()+a.slice(1)],r='band'===t.scaleType(e.scale)&&n.axisBand;return i||d||r?F({},n.axis,i,d,r):n.axis}function Hw(e,t,n,a){var i=e.orient,d={value:0},r,l,o,s,f,c;return r={enter:l={opacity:d},update:o={opacity:{value:1}},exit:{opacity:d}},Uk(r,'stroke',Wk('domainColor',e,t)),Uk(r,'strokeWidth',Wk('domainWidth',e,t)),Uk(r,'strokeOpacity',Wk('domainOpacity',e,t)),'top'===i||'bottom'===i?(s='x',c='y'):(s='y',c='x'),f=s+'2',l[c]=d,o[s]=l[s]=Vw(e,0),o[f]=l[f]=Vw(e,1),Bk('rule','axis-domain',null,null,a,r,n)}function Vw(e,t){return{scale:e.scale,range:t}}function Xw(e,t,n,a){var i=e.orient,d=e.gridScale,r='left'===i||'top'===i?1:-1,l=r*e.offset||0,o={value:0},f,c,p,g,m,h,y,b,_;return f={enter:c={opacity:o},update:g={opacity:{value:1}},exit:p={opacity:o}},Uk(f,'stroke',Wk('gridColor',e,t)),Uk(f,'strokeDash',Wk('gridDash',e,t)),Uk(f,'strokeOpacity',Wk('gridOpacity',e,t)),Uk(f,'strokeWidth',Wk('gridWidth',e,t)),m={scale:e.scale,field:'value',band:Wk('bandPosition',e,t),round:Wk('tickRound',e,t),extra:Wk('tickExtra',e,t),offset:Wk('tickOffset',e,t)},'top'===i||'bottom'===i?(h='x',y='y',_='height'):(h='y',y='x',_='width'),b=y+'2',g[h]=c[h]=p[h]=m,d?(c[y]={scale:d,range:0,mult:r,offset:l},g[b]=c[b]={scale:d,range:1,mult:r,offset:l}):(c[y]={value:l},g[b]=c[b]={signal:_,mult:r,offset:l}),Bk('rule','axis-grid',null,'value',a,f,n)}function Zw(e,t,n,a,i){var d=e.orient,r='left'===d||'top'===d?-1:1,l={value:0},o,s,f,c,u,p;return o={enter:s={opacity:l},update:c={opacity:{value:1}},exit:f={opacity:l}},Uk(o,'stroke',Wk('tickColor',e,t)),Uk(o,'strokeOpacity',Wk('tickOpacity',e,t)),Uk(o,'strokeWidth',Wk('tickWidth',e,t)),u=Mk(i),u.mult=r,p={scale:e.scale,field:'value',band:Wk('bandPosition',e,t),round:Wk('tickRound',e,t),extra:Wk('tickExtra',e,t),offset:Wk('tickOffset',e,t)},'top'===d||'bottom'===d?(c.y=s.y=l,c.y2=s.y2=u,c.x=s.x=f.x=p):(c.x=s.x=l,c.x2=s.x2=u,c.y=s.y=f.y=p),Bk('rule','axis-tick',null,'value',a,o,n)}function Jw(e,t,n,a,i){return{signal:'flush(range("'+e+'"), scale("'+e+'", datum.value), '+t+','+n+','+a+','+i+')'}}function Qw(e,t,n,a,i){var d=e.orient,r='left'===d||'top'===d?-1:1,l='top'===d||'bottom'===d,o=e.scale,s=Av(Wk('labelFlush',e,t)),f=Av(Wk('labelFlushOffset',e,t)),c=0===s||!!s,u=Wk('labelAlign',e,t),p=Wk('labelBaseline',e,t),g={value:0},m,h,y,b,_,x,v,k,w;return y=Mk(i),y.mult=r,y.offset=Mk(Wk('labelPadding',e,t)||0),y.offset.mult=r,b={scale:o,field:'value',band:.5,offset:Wk('tickOffset',e,t)},l?(_=u||(c?Jw(o,s,'"left"','"right"','"center"'):'center'),x=p||('top'===d?'bottom':'top'),v=!u):(_=u||('right'===d?'left':'right'),x=p||(c?Jw(o,s,'"top"','"bottom"','"middle"'):'middle'),v=!p),v=v&&c&&f?Jw(o,s,'-'+f,f,0):null,m={enter:h={opacity:g,x:l?b:y,y:l?y:b},update:{opacity:{value:1},text:{field:'label'},x:h.x,y:h.y},exit:{opacity:g,x:h.x,y:h.y}},Uk(m,l?'dx':'dy',v),Uk(m,'align',_),Uk(m,'baseline',x),Uk(m,'angle',Wk('labelAngle',e,t)),Uk(m,'fill',Wk('labelColor',e,t)),Uk(m,'font',Wk('labelFont',e,t)),Uk(m,'fontSize',Wk('labelFontSize',e,t)),Uk(m,'fontWeight',Wk('labelFontWeight',e,t)),Uk(m,'limit',Wk('labelLimit',e,t)),Uk(m,'fillOpacity',Wk('labelOpacity',e,t)),k=Wk('labelBound',e,t),w=Wk('labelOverlap',e,t),e=Bk('text','axis-label','guide-label','value',a,m,n),(w||k)&&(e.overlap={method:w,order:'datum.index',bound:k?{scale:o,orient:d,tolerance:k}:null}),e}function Kw(e,t,n,a){var i=e.orient,d='left'===i||'top'===i?-1:1,r='top'===i||'bottom'===i,l={value:0},o,s,f,c;return o={enter:s={opacity:l},update:f={opacity:{value:1},text:Mk(e.title)},exit:{opacity:l}},c={scale:e.scale,range:.5},r?(f.x=c,s.angle={value:0},s.baseline={value:'top'===i?'bottom':'top'}):(f.y=c,s.angle={value:90*d},s.baseline={value:'bottom'}),Uk(o,'align',Wk('titleAlign',e,t)),Uk(o,'angle',Wk('titleAngle',e,t)),Uk(o,'baseline',Wk('titleBaseline',e,t)),Uk(o,'fill',Wk('titleColor',e,t)),Uk(o,'font',Wk('titleFont',e,t)),Uk(o,'fontSize',Wk('titleFontSize',e,t)),Uk(o,'fontWeight',Wk('titleFontWeight',e,t)),Uk(o,'limit',Wk('titleLimit',e,t)),Uk(o,'fillOpacity',Wk('titleOpacity',e,t)),Uk(o,'x',Wk('titleX',e,t),'update')||!r||Nk('x',n)||(o.enter.auto={value:!0}),Uk(o,'y',Wk('titleY',e,t),'update')||r||Nk('y',n)||(o.enter.auto={value:!0}),Bk('text','axis-title','guide-title',null,a,o,n)}function eE(e,t){var n=Yw(e,t),a=e.encode||{},i=a.axis||{},d=i.name||void 0,r=i.interactive,l=i.style,o,s,f,c,u,p;// single-element data source for axis group
// parse axis specification
return o={orient:e.orient,ticks:!!Wk('ticks',e,n),labels:!!Wk('labels',e,n),grid:!!Wk('grid',e,n),domain:!!Wk('domain',e,n),title:!!Tv(e.title,!1)},s=Ev(t.add(jM({},[o]))),i=jk({update:{range:{signal:'abs(span(range("'+e.scale+'")))'},offset:Mk(Tv(e.offset,0)),position:Mk(Tv(e.position,0)),titlePadding:Mk(Wk('titlePadding',e,n)),minExtent:Mk(Wk('minExtent',e,n)),maxExtent:Mk(Wk('maxExtent',e,n))}},a.axis,hU),f=Ev(t.add(MM({scale:t.scaleRef(e.scale),extra:t.property(Wk('tickExtra',e,n)),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),formatSpecifier:t.property(e.format)}))),p=[],o.grid&&p.push(Xw(e,n,a.grid,f)),o.ticks&&(c=Wk('tickSize',e,n),p.push(Zw(e,n,a.ticks,f,c))),o.labels&&(c=o.ticks?c:0,p.push(Qw(e,n,a.labels,f,c))),o.domain&&p.push(Hw(e,n,a.domain,s)),o.title&&p.push(Kw(e,n,a.title,s)),u=ew('axis',l,d,s,r,i,p),e.zindex&&(u.zindex=e.zindex),Ow(u,t)}function tE(e,t,n){var a=P(e.signals),i=P(e.scales);return n||a.forEach(function(e){w_(e,t)}),P(e.projections).forEach(function(e){xk(e,t)}),i.forEach(function(e){ak(e,t)}),P(e.data).forEach(function(e){Nw(e,t)}),i.forEach(function(e){ik(e,t)}),a.forEach(function(e){Jv(e,t)}),P(e.axes).forEach(function(e){eE(e,t)}),P(e.marks).forEach(function(e){Ow(e,t)}),P(e.legends).forEach(function(e){Aw(e,t)}),e.title&&Fw(e.title,t),t.parseLambdas(),t}function nE(e,t){var n=t.config,a,i,d,r,l;return t.background=e.background||n.background,t.eventConfig=n.events,l=Ev(t.root=t.add(wv())),t.addSignal('width',e.width||0),t.addSignal('height',e.height||0),t.addSignal('padding',__(e.padding,n)),t.addSignal('autosize',b_(e.autosize,n)),P(e.signals).forEach(function(e){SU[e.name]||w_(e,t)}),i=t.add(jM()),d=jk({enter:{x:{value:0},y:{value:0}},update:{width:{signal:'width'},height:{signal:'height'}}},e.encode),d=t.add(IM(qk(d,'group','frame',e.style,t,{pulse:Ev(i)}))),r=t.add(lU({layout:t.objectProperty(e.layout),legendMargin:n.legendMargin,autosize:t.signalRef('autosize'),mark:l,pulse:Ev(d)})),t.operators.pop(),t.pushState(Ev(d),Ev(r),null),tE(e,t,!0),t.operators.push(r),a=t.add(UM({mark:l,pulse:Ev(r)})),a=t.add(aU({pulse:Ev(a)})),a=t.add(dU({pulse:Ev(a)})),t.addData('root',new Ew(t,i,i,a)),t}function aE(e){this.config=e,this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.background=null,this.eventConfig=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function iE(e){this.config=e.config,this.field=Object.create(e.field),this.signals=Object.create(e.signals),this.lambdas=Object.create(e.lambdas),this.scales=Object.create(e.scales),this.events=Object.create(e.events),this.data=Object.create(e.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++e._nextsub[0],this._nextsub=e._nextsub,this._parent=e._parent.slice(),this._encode=e._encode.slice(),this._lookup=e._lookup.slice(),this._markpath=e._markpath}function dE(e){return(hS(e)?rE:lE)(e)}function rE(e){for(var t='[',a=0,d=e.length,n;a<d;++a)n=e[a],t+=(0<a?',':'')+(g(n)?n.signal||dE(n):h(n));return t+']'}function lE(e){var t='{',n=0,a,d;for(a in e)d=e[a],t+=(1<++n?',':'')+h(a)+':'+(g(d)?d.signal||dE(d):h(d));return t+'}'}function oE(e){var t=sE();return(e||[]).forEach(function(e){var n,a,i;if(e)for(n in e)if('style'===n)for(n in i=t.style||(t.style={}),e.style)i[n]=F(i[n]||{},e.style[n]);else a=e[n],t[n]=g(a)&&!hS(a)?F(g(t[n])?t[n]:{},a):a}),t}/**
   * Standard configuration defaults for Vega specification parsing.
   * Users can provide their own (sub-)set of these default values
   * by passing in a config object to the top-level parse method.
   */function sE(){return{// default padding around visualization
padding:0,// default for automatic sizing; options: "none", "pad", "fit"
// or provide an object (e.g., {"type": "pad", "resize": true})
autosize:'pad',// default view background color
// covers the entire view component
background:null,// default event handling configuration
// preventDefault for view-sourced event types except 'wheel'
events:{defaults:{allow:['wheel']}},// defaults for top-level group marks
// accepts mark properties (fill, stroke, etc)
// covers the data rectangle within group width/height
group:null,// defaults for basic mark types
// each subset accepts mark properties (fill, stroke, etc)
mark:null,arc:{fill:'#4c78a8'},area:{fill:'#4c78a8'},image:null,line:{stroke:'#4c78a8',strokeWidth:2},path:{stroke:'#4c78a8'},rect:{fill:'#4c78a8'},rule:{stroke:'#000'},shape:{stroke:'#4c78a8'},symbol:{fill:'#4c78a8',size:64},text:{fill:'#000',font:'sans-serif',fontSize:11},// style definitions
style:{// axis & legend labels
"guide-label":{fill:'#000',font:'sans-serif',fontSize:10},// axis & legend titles
"guide-title":{fill:'#000',font:'sans-serif',fontSize:11,fontWeight:'bold'},// headers, including chart title
"group-title":{fill:'#000',font:'sans-serif',fontSize:13,fontWeight:'bold'},// defaults for styled point marks in Vega-Lite
point:{size:30,strokeWidth:2,shape:'circle'},circle:{size:30,strokeWidth:2},square:{size:30,strokeWidth:2,shape:'square'},// defaults for styled group marks in Vega-Lite
cell:{fill:'transparent',stroke:'#ddd'}},// defaults for axes
axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:'#888',grid:!1,gridWidth:1,gridColor:'#ddd',labels:!0,labelAngle:0,labelLimit:180,labelPadding:2,ticks:!0,tickColor:'#888',tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titleAlign:'center',titlePadding:4},// correction for centering bias
axisBand:{tickOffset:-1},// defaults for legends
legend:{orient:'right',offset:18,padding:0,gridAlign:'each',columnPadding:10,rowPadding:2,symbolDirection:'vertical',gradientDirection:'vertical',gradientLength:200,gradientThickness:16,gradientStrokeColor:'#ddd',gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:'left',labelBaseline:'middle',labelLimit:160,labelOffset:4,labelOverlap:!0,symbolType:'circle',symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:'transparent',symbolBaseStrokeColor:'#888',titleAlign:'left',titleBaseline:'top',titleLimit:180,titlePadding:5},// defaults for group title
title:{orient:'top',anchor:'middle',offset:4},// defaults for scale ranges
range:{category:{scheme:'tableau10'},ordinal:{scheme:'blues',extent:[.2,1]},heatmap:{scheme:'viridis'},ramp:{scheme:'blues',extent:[.2,1]},diverging:{scheme:'blueorange'},symbol:['circle','square','triangle-up','cross','diamond','triangle-right','triangle-down','triangle-left']}}}/**
   * Parse an expression given the argument signature and body code.
   */function fE(e,t,n){';'!==t[t.length-1]&&(t='return('+t+');');var a=Function.apply(null,e.concat(t));return n&&n.functions?a.bind(n.functions):a}/**
   * Parse an expression used to update an operator value.
   */function cE(e,t){return fE(['_'],e,t)}/**
   * Parse an expression provided as an operator parameter value.
   */function uE(e,t){return fE(['datum','_'],e,t)}/**
   * Parse an expression applied to an event stream.
   */function pE(e,t){return fE(['event'],e,t)}/**
   * Parse an expression used to handle an event-driven operator update.
   */function gE(e,t){return fE(['_','event'],e,t)}/**
   * Parse an expression that performs visual encoding.
   */function mE(e,t){return fE(['item','_'],e,t)}/**
   * Parse a set of operator parameters.
   */function hE(e,t,n){n=n||{};var a,i;for(a in e)i=e[a],n[a]=hS(i)?i.map(function(e){return yE(e,t,n)}):yE(i,t,n);return n}/**
   * Parse a single parameter.
   */function yE(e,t,a){if(!e||!g(e))return e;for(var d=0,r=zU.length,n;d<r;++d)if(n=zU[d],e.hasOwnProperty(n.key))return n.parse(e,t,a);return e}/** Reference parsers. *//**
   * Resolve an operator reference.
   *//**
   * Resolve an expression reference.
   *//**
   * Resolve a key accessor reference.
   *//**
   * Resolve a field accessor reference.
   *//**
   * Resolve a comparator function reference.
   *//**
   * Resolve an encode operator reference.
   *//**
   * Resolve a context reference.
   *//**
   * Resolve a recursive subflow specification.
   *//**
   * Resolve a tuple id reference.
   */function bE(e){return(e+'').toLowerCase()}function _E(e){return'operator'===bE(e)}function xE(e){return'collect'===bE(e)}/**
   * Parse a dataflow operator.
   */function vE(e,t){_E(e.type)||!e.type?t.operator(e,e.update?cE(e.update,t):null):t.transform(e,e.type)}/**
   * Parse and assign operator parameters.
   */function kE(e,t){if(e.params){var n=t.get(e.id);n||u('Invalid operator id: '+e.id),t.dataflow.connect(n,n.parameters(hE(e.params,t),e.react,e.initonly))}}/**
   * Parse an event stream specification.
   */function wE(e,t){var n=null==e.filter?void 0:pE(e.filter,t),a=null==e.stream?void 0:t.get(e.stream),i;e.source?a=t.events(e.source,e.type,n):e.merge&&(i=e.merge.map(t.get.bind(t)),a=i[0].merge.apply(i[0],i.slice(1))),e.between&&(i=e.between.map(t.get.bind(t)),a=a.between(i[0],i[1])),e.filter&&(a=a.filter(n)),null!=e.throttle&&(a=a.throttle(+e.throttle)),null!=e.debounce&&(a=a.debounce(+e.debounce)),null==a&&u('Invalid stream definition: '+JSON.stringify(e)),e.consume&&a.consume(!0),t.stream(e,a)}/**
   * Parse an event-driven operator update.
   */function EE(e,t){var n=g(n=e.source)?n.$ref:n,a=t.get(n),i=null,d=e.update,r;a||u('Source not defined: '+e.source),i=e.target&&e.target.$expr?pE(e.target.$expr,t):t.get(e.target),d&&d.$expr&&(d.$params&&(r=hE(d.$params,t)),d=gE(d.$expr,t)),t.update(e,a,i,d,r)}/**
   * Parse a serialized dataflow specification.
   */function SE(e,t){var n=e.operators||[];// parse background
return e.background&&(t.background=e.background),e.eventConfig&&(t.eventConfig=e.eventConfig),n.forEach(function(e){vE(e,t)}),n.forEach(function(e){kE(e,t)}),(e.streams||[]).forEach(function(e){wE(e,t)}),(e.updates||[]).forEach(function(e){EE(e,t)}),t.resolve()}/**
   * Context objects store the current parse state.
   * Enables lookup of parsed operators, event streams, accessors, etc.
   * Provides a 'fork' method for creating child contexts for subflows.
   */function CE(e,t,n){return new zE(e,t,n)}function zE(e,t,n){this.dataflow=e,this.transforms=t,this.events=e.events.bind(e),this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function DE(e){this.dataflow=e.dataflow,this.transforms=e.transforms,this.functions=e.functions,this.events=e.events,this.signals=Object.create(e.signals),this.scales=Object.create(e.scales),this.nodes=Object.create(e.nodes),this.data=Object.create(e.data),this.fn=Object.create(e.fn),e.functions&&(this.functions=Object.create(e.functions),this.functions.context=this)}function RE(e,t,n){return SE(t,CE(e,ZC,n||SM))}function $E(e,t){var n=e.autosize(),a=e.padding();return t-(n&&n.contains==='padding'?a.left+a.right:0)}function OE(e,t){var n=e.autosize(),a=e.padding();return t-(n&&n.contains==='padding'?a.top+a.bottom:0)}function TE(e){function t(){e._autosize=e._resize=1}// respond to width signal
var n=e._signals,a=n.width,i=n.height,d=n.padding;e._resizeWidth=e.add(null,function(n){e._width=n.size,e._viewWidth=$E(e,n.size),t()},{size:a}),e._resizeHeight=e.add(null,function(n){e._height=n.size,e._viewHeight=OE(e,n.size),t()},{size:i});// respond to padding signal
var r=e.add(null,t,{pad:d});// set rank to run immediately after source signal
e._resizeWidth.rank=a.rank+1,e._resizeHeight.rank=i.rank+1,r.rank=d.rank+1}/**
   * Get the current view state, consisting of signal values and/or data sets.
   * @param {object} [options] - Options flags indicating which state to export.
   *   If unspecified, all signals and data sets will be exported.
   * @param {function(string, Operator):boolean} [options.signals] - Optional
   *   predicate function for testing if a signal should be included in the
   *   exported state. If unspecified, all signals will be included, except for
   *   those named 'parent' or those which refer to a Transform value.
   * @param {function(string, object):boolean} [options.data] - Optional
   *   predicate function for testing if a data set's input should be included
   *   in the exported state. If unspecified, all data sets that have been
   *   explicitly modified will be included.
   * @param {boolean} [options.recurse=true] - Flag indicating if the exported
   *   state should recursively include state from group mark sub-contexts.
   * @return {object} - An object containing the exported state values.
   */function AE(e,t){return t.modified&&hS(t.input.value)&&e.indexOf('_:vega:_')}function LE(e,t){return!('parent'===e||t instanceof ZC.proxy)}/**
   * Sets the current view state and updates the view by invoking run.
   * @param {object} state - A state object containing signal and/or
   *   data set values, following the format used by the getState method.
   * @return {View} - This view instance.
   */function PE(e,t,n,a){var i=e.element();i&&i.setAttribute('title',ME(a))}function ME(e){return null==e?'':hS(e)?jE(e):g(e)&&!Y(e)?UE(e):e+''}function UE(e){return Object.keys(e).map(function(t){var n=e[t];return t+': '+(hS(n)?jE(n):qE(n))}).join('\n')}function jE(e){return'['+e.map(qE).join(', ')+']'}function qE(e){return hS(e)?'[\u2026]':g(e)&&!Y(e)?'{\u2026}':e}/**
   * Create a new View instance from a Vega dataflow runtime specification.
   * The generated View will not immediately be ready for display. Callers
   * should also invoke the initialize method (e.g., to set the parent
   * DOM element in browser-based deployment) and then invoke the run
   * method to evaluate the dataflow graph. Rendering will automatically
   * be peformed upon dataflow runs.
   * @constructor
   * @param {object} spec - The Vega dataflow runtime specification.
   */function FE(e,t){var n=this;t=t||{},Cn.call(n),n.loader(t.loader||n._loader),n.logLevel(t.logLevel||0),n._el=null,n._renderType=t.renderer||SR.Canvas,n._scenegraph=new ul;var a=n._scenegraph.root;// initialize renderer, handler and event management
n._renderer=null,n._tooltip=t.tooltip||PE,n._redraw=!0,n._handler=new El().scene(a),n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[];// initialize dataflow graph
var i=RE(n,e,t.functions);// initialize background color
// initialize event configuration
// initialize view size
// initialize cursor
n._runtime=i,n._signals=i.signals,n._bind=(e.bindings||[]).map(function(e){return{state:null,param:F({},e)}}),i.root&&i.root.set(a),a.source=i.data.root.input,n.pulse(i.data.root.input,n.changeset().insert(a.items)),n._background=i.background||null,n._eventConfig=Qb(i.eventConfig),n._width=n.width(),n._height=n.height(),n._viewWidth=$E(n,n._width),n._viewHeight=OE(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,TE(n),Nb(n)}function IE(e,t){return e._signals.hasOwnProperty(t)?e._signals[t]:u('Unrecognized signal name: '+h(t))}function NE(e,n){var a=e._targets||[],t=a.filter(function(e){var t=e._update;return t&&t.handler===n});return t.length?t[0]:null}function BE(e,t,n,a){var i=NE(n,a);return i||(i=p_(this,function(){a(t,n.value)}),i.handler=a,e.on(n,null,i)),e}function WE(e,t,n){var a=NE(t,n);return a&&t._targets.remove(a),e}var hS=Array.isArray,yS=[],bS=t('id'),id=r(function(e){return e},yS,'identity'),el=r(function(){return 0},yS,'zero'),dy=r(function(){return 1},yS,'one'),_S=r(function(){return!0},yS,'true'),xS=r(function(){return!1},yS,'false'),vS={},kS=Symbol('vega_id'),wS=1,ES=ye.prototype;/**
   * Set a parameter value. If the parameter value changes, the parameter
   * will be recorded as modified.
   * @param {string} name - The parameter name.
   * @param {number} index - The index into an array-value parameter. Ignored if
   *   the argument is undefined, null or less than zero.
   * @param {*} value - The parameter value to set.
   * @param {boolean} [force=false] - If true, records the parameter as modified
   *   even if the value is unchanged.
   * @return {Parameters} - This parameter object.
   */ES.set=function(e,t,n,a){var i=this,d=i[e],r=i['_:mod:_'];return null!=t&&0<=t?(d[t]!==n||a)&&(d[t]=n,r[t+':'+e]=-1,r[e]=-1):(d!==n||a)&&(i[e]=n,r[e]=hS(n)?1+n.length:-1),i},ES.modified=function(e,t){var n=this['_:mod:_'],a;if(!arguments.length){for(a in n)if(n[a])return!0;return!1}if(hS(e)){for(a=0;a<e.length;++a)if(n[e[a]])return!0;return!1}return null!=t&&0<=t?t+1<n[e]||!!n[t+':'+e]:!!n[e]},ES.clear=function(){return this['_:mod:_']={},this};var SS=0,CS=new ye,zS=be.prototype;// Boolean Flags
/**
   * Returns a list of target operators dependent on this operator.
   * If this list does not exist, it is created and then returned.
   * @return {UniqueList}
   */zS.targets=function(){return this._targets||(this._targets=le(bS))},zS.set=function(e){return this.value===e?0:(this.value=e,1)},zS.skip=_e(1),zS.modified=_e(2),zS.parameters=function(e,t,a){function d(e,n,a){a instanceof be?(a!==r&&(t&&a.targets().add(r),s.push(a)),o.push({op:a,name:e,index:n})):l.set(e,n,a)}t=!1!==t;var r=this,l=r._argval=r._argval||new ye,o=r._argops=r._argops||[],s=[],f,c,p,g;for(f in e)if(c=e[f],'pulse'===f)P(c).forEach(function(e){e instanceof be?e!==r&&(e.targets().add(r),s.push(e)):u('Pulse parameters must be operator instances.')}),r.source=c;else if(hS(c))for(l.set(f,-1,Array(p=c.length)),g=0;g<p;++g)d(f,g,c[g]);else d(f,-1,c);return this.marshall().clear(),a&&(o.initonly=!0),s},zS.marshall=function(e){var t=this._argval||CS,a=this._argops,d,r,l,o,s;if(a){for(r=0,l=a.length;r<l;++r)d=a[r],o=d.op,s=o.modified()&&o.stamp===e,t.set(d.name,d.index,o.value,s);if(a.initonly){for(r=0;r<l;++r)d=a[r],d.op.targets().remove(this);this._argops=null,this._update=null}}return t},zS.evaluate=function(e){var t=this._update;if(t){var n=this.marshall(e.stamp),a=t.call(this,n,e);if(n.clear(),a!==this.value)this.value=a;else if(!this.modified())return e.StopPropagation}},zS.run=function(e){if(e.stamp<=this.stamp)return e.StopPropagation;var t;return this.skip()?(this.skip(!1),t=0):t=this.evaluate(e),this.stamp=e.stamp,this.pulse=t||e};var DS=0,RS=xe.prototype;RS._filter=_S,RS._apply=id,RS.targets=function(){return this._targets||(this._targets=le(bS))},RS.consume=function(e){return arguments.length?(this._consume=!!e,this):!!this._consume},RS.receive=function(e){if(this._filter(e)){for(var t=this.value=this._apply(e),a=this._targets,d=a?a.length:0,n=0;n<d;++n)a[n].receive(t);this._consume&&(e.preventDefault(),e.stopPropagation())}},RS.filter=function(e){var t=ve(e);return this.targets().add(t),t},RS.apply=function(e){var t=ve(null,e);return this.targets().add(t),t},RS.merge=function(){var e=ve();this.targets().add(e);for(var t=0,a=arguments.length;t<a;++t)arguments[t].targets().add(e);return e},RS.throttle=function(e){var n=-1;return this.filter(function(){var t=Date.now();return t-n>e?(n=t,1):0})},RS.debounce=function(e){var t=ve();return this.targets().add(ve(null,null,q(e,function(n){var e=n.dataflow;t.receive(n),e&&e.run&&e.run()}))),t},RS.between=function(e,t){var n=!1;return e.targets().add(ve(null,null,function(){n=!0})),t.targets().add(ve(null,null,function(){n=!1})),this.filter(function(){return n})};var $S=/^([A-Za-z]+:)?\/\//,OS={boolean:K,integer:c,number:c,date:te,string:ne,unknown:id},TS=[function(e){return'true'===e||'false'===e||!0===e||!1===e},function(e){return $e(e)&&(e=+e)==~~e},$e,function(e){return!isNaN(Date.parse(e))}],AS=['boolean','integer','number','date'],LS={},PS={},MS=Le(','),US=Le('\t'),jS={dsv:Me,csv:Pe(','),tsv:Pe('\t'),json:je,topojson:function(e,t){var n,a,i;return e=je(e,t),n=t&&(i=t.feature)?Be:t&&(i=t.mesh)?He:u('Missing TopoJSON feature or mesh parameter.'),a=(a=e.objects[i])?n(e,a):u('Invalid TopoJSON object: '+i),a&&a.features||[a]}},qS=new Date,FS=new Date,IS=Je(function(){// noop
},function(e,t){e.setTime(+e+t)},function(e,t){return t-e});// Special treatment in node.js for the file: protocol
// An optimized implementation for this simple case.
IS.every=function(e){return e=sS(e),isFinite(e)&&0<e?1<e?Je(function(t){t.setTime(sS(t/e)*e)},function(t,n){t.setTime(+t+n*e)},function(t,n){return(n-t)/e}):IS:null};var NS=IS.range,BS=Je(function(e){e.setTime(sS(e/1000)*1000)},function(e,t){e.setTime(+e+t*1000)},function(e,t){return(t-e)/1000},function(e){return e.getUTCSeconds()}),WS=BS.range,GS=Je(function(e){e.setTime(sS(e/60000)*60000)},function(e,t){e.setTime(+e+t*60000)},function(e,t){return(t-e)/60000},function(e){return e.getMinutes()}),YS=GS.range,HS=Je(function(e){var t=e.getTimezoneOffset()*60000%3600000;0>t&&(t+=3600000),e.setTime(sS((+e-t)/3600000)*3600000+t)},function(e,t){e.setTime(+e+t*3600000)},function(e,t){return(t-e)/3600000},function(e){return e.getHours()}),VS=HS.range,XS=Je(function(e){e.setHours(0,0,0,0)},function(e,t){e.setDate(e.getDate()+t)},function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*60000)/86400000},function(e){return e.getDate()-1}),ZS=XS.range,JS=Qe(0),QS=Qe(1),KS=Qe(2),eC=Qe(3),tC=Qe(4),nC=Qe(5),aC=Qe(6),iC=JS.range,dC=QS.range,rC=tC.range,lC=Je(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,t){e.setMonth(e.getMonth()+t)},function(e,t){return t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())},function(e){return e.getMonth()}),oC=lC.range,sC=Je(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});// An optimized implementation for this simple case.
sC.every=function(e){return isFinite(e=sS(e))&&0<e?Je(function(t){t.setFullYear(sS(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,n){t.setFullYear(t.getFullYear()+n*e)}):null};var fC=sC.range,cC=Je(function(e){e.setUTCSeconds(0,0)},function(e,t){e.setTime(+e+t*60000)},function(e,t){return(t-e)/60000},function(e){return e.getUTCMinutes()}),uC=cC.range,pC=Je(function(e){e.setUTCMinutes(0,0,0)},function(e,t){e.setTime(+e+t*3600000)},function(e,t){return(t-e)/3600000},function(e){return e.getUTCHours()}),gC=pC.range,mC=Je(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/86400000},function(e){return e.getUTCDate()-1}),hC=mC.range,yC=Ke(0),bC=Ke(1),_C=Ke(2),xC=Ke(3),vC=Ke(4),kC=Ke(5),wC=Ke(6),EC=yC.range,SC=bC.range,CC=vC.range,zC=Je(function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCMonth(e.getUTCMonth()+t)},function(e,t){return t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())},function(e){return e.getUTCMonth()}),DC=zC.range,RC=Je(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});// An optimized implementation for this simple case.
RC.every=function(e){return isFinite(e=sS(e))&&0<e?Je(function(t){t.setUTCFullYear(sS(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)}):null};var $C=RC.range,OC={"-":'',_:' ',0:'0'},TC=/^\s*\d+/,// note: ignores next directive
AC=/^%/,LC=/[\\^$*+?|[\]().{}]/g,PC,MC,UC,jC,qC;cn({dateTime:'%x, %X',date:'%-m/%-d/%Y',time:'%-I:%M:%S %p',periods:['AM','PM'],days:['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'],shortDays:['Sun','Mon','Tue','Wed','Thu','Fri','Sat'],months:['January','February','March','April','May','June','July','August','September','October','November','December'],shortMonths:['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec']});var FC=Date.prototype.toISOString?function(e){return e.toISOString()}:jC('%Y-%m-%dT%H:%M:%S.%LZ'),IC=+new Date('2000-01-01T00:00:00.000Z')?function(e){var t=new Date(e);return isNaN(t)?null:t}:qC('%Y-%m-%dT%H:%M:%S.%LZ'),NC={skip:!0},BC={},WC=yn.prototype;// Pulse visit type flags
/**
   * Sentinel value indicating pulse propagation should stop.
   */WC.StopPropagation=BC,WC.ADD=1,WC.REM=2,WC.MOD=4,WC.ADD_REM=3,WC.ADD_MOD=5,WC.ALL=7,WC.REFLOW=8,WC.SOURCE=16,WC.NO_SOURCE=32,WC.NO_FIELDS=64,WC.fork=function(e){return new yn(this.dataflow).init(this,e)},WC.clone=function(){var e=this.fork(7);return e.add=e.add.slice(),e.rem=e.rem.slice(),e.mod=e.mod.slice(),e.source&&(e.source=e.source.slice()),e.materialize(23)},WC.addAll=function(){var e=this;return this.source&&this.source.length!==this.add.length?(e=new yn(this.dataflow).init(this),e.add=e.source,e):e},WC.init=function(e,t){var n=this;return n.stamp=e.stamp,n.encode=e.encode,e.fields&&!(64&t)&&(n.fields=e.fields),1&t?(n.addF=e.addF,n.add=e.add):(n.addF=null,n.add=[]),2&t?(n.remF=e.remF,n.rem=e.rem):(n.remF=null,n.rem=[]),4&t?(n.modF=e.modF,n.mod=e.mod):(n.modF=null,n.mod=[]),32&t?(n.srcF=null,n.source=null):(n.srcF=e.srcF,n.source=e.source),n},WC.runAfter=function(e){this.dataflow.runAfter(e)},WC.changed=function(e){var t=e||7;return t&1&&this.add.length||t&2&&this.rem.length||t&4&&this.mod.length},WC.reflow=function(e){if(e)return this.fork(7).reflow();var t=this.add.length,n=this.source&&this.source.length;return n&&n!==t&&(this.mod=this.source,t&&this.filter(4,xn(this,1))),this},WC.modifies=function(e){var t=P(e),n=this.fields||(this.fields={});return t.forEach(function(e){n[e]=!0}),this},WC.modified=function(e){var t=this.fields;return!!(this.mod.length&&t)&&(arguments.length?hS(e)?e.some(function(e){return t[e]}):t[e]:!!t)},WC.filter=function(e,t){var n=this;return 1&e&&(n.addF=bn(n.addF,t)),2&e&&(n.remF=bn(n.remF,t)),4&e&&(n.modF=bn(n.modF,t)),16&e&&(n.srcF=bn(n.srcF,t)),n},WC.materialize=function(e){e=e||7;var t=this;return 1&e&&t.addF&&(t.add=_n(t.add,t.addF),t.addF=null),2&e&&t.remF&&(t.rem=_n(t.rem,t.remF),t.remF=null),4&e&&t.modF&&(t.mod=_n(t.mod,t.modF),t.modF=null),16&e&&t.srcF&&(t.source=t.source.filter(t.srcF),t.srcF=null),t},WC.visit=function(e,t){var n=this,a=t,i,d;if(16&e)return de(n.source,n.srcF,a),n;if(1&e&&de(n.add,n.addF,a),2&e&&de(n.rem,n.remF,a),4&e&&de(n.mod,n.modF,a),8&e&&(i=n.source))if(d=n.add.length+n.mod.length,d===i.length);else d?de(i,xn(n,5),a):// if no add/rem/mod tuples, visit source
de(i,n.srcF,a);return n};var GC=W(vn,yn);/**
   * Creates a new pulse based on the values of this pulse.
   * The dataflow, time stamp and field modification values are copied over.
   * @return {Pulse}
   */GC.fork=function(e){var n=new yn(this.dataflow).init(this,e&this.NO_FIELDS);return void 0!==e&&(e&n.ADD&&this.visit(n.ADD,function(e){return n.add.push(e)}),e&n.REM&&this.visit(n.REM,function(e){return n.rem.push(e)}),e&n.MOD&&this.visit(n.MOD,function(e){return n.mod.push(e)})),n},GC.changed=function(e){return this.changes&e},GC.modified=function(e){var t=this,n=t.fields;return n&&t.changes&t.MOD?hS(e)?e.some(function(e){return n[e]}):n[e]:0},GC.filter=function(){u('MultiPulse does not support filtering.')},GC.materialize=function(){u('MultiPulse does not support materialization.')},GC.visit=function(e,t){var a=this,d=a.pulses,r=d.length,n=0;if(e&a.SOURCE)for(;n<r;++n)d[n].visit(e,t);else for(;n<r;++n)d[n].stamp===a.stamp&&d[n].visit(e,t);return a};var YC={skip:!1,force:!1},HC=wn.prototype;HC.size=function(){return this.nodes.length},HC.clear=function(){return this.nodes=[],this},HC.peek=function(){return this.nodes[0]},HC.push=function(e){var t=this.nodes;return t.push(e),En(t,0,t.length-1,this.cmp)},HC.pop=function(){var e=this.nodes,t=e.pop(),n;return e.length?(n=e[0],e[0]=t,Sn(e,0,this.cmp)):n=t,n},HC.replace=function(e){var t=this.nodes,n=t[0];return t[0]=e,Sn(t,0,this.cmp),n},HC.pushpop=function(e){var t=this.nodes,n=t[0];return t.length&&0>this.cmp(n,e)&&(t[0]=e,e=n,Sn(t,0,this.cmp)),e};var VC=Cn.prototype;/**
   * The current timestamp of this dataflow. This value reflects the
   * timestamp of the previous dataflow run. The dataflow is initialized
   * with a stamp value of 0. The initial run of the dataflow will have
   * a timestap of 1, and so on. This value will match the
   * {@link Pulse.stamp} property.
   * @return {number} - The current timestamp value.
   */VC.stamp=function(){return this._clock},VC.loader=function(e){return arguments.length?(this._loader=e,this):this._loader},VC.cleanThreshold=1e4,VC.add=function(e,t,n,a){var i=1,d;return e instanceof be?d=e:e&&e.prototype instanceof be?d=new e:M(e)?d=new be(null,e):(i=0,d=new be(e,t)),this.rank(d),i&&(a=n,n=t),n&&this.connect(d,d.parameters(n,a)),this.touch(d),d},VC.connect=function(e,t){var a=e.rank,d,r;for(d=0,r=t.length;d<r;++d)if(a<t[d].rank)return void this.rerank(e)},VC.rank=function(e){e.rank=++this._rank},VC.rerank=function(e){for(var t=[e],n,a,d;t.length;)if(this.rank(n=t.pop()),a=n._targets)for(d=a.length;0<=--d;)t.push(n=a[d]),n===e&&u('Cycle detected in dataflow graph.')},VC.pulse=function(e,n,a){this.touch(e,a||YC);var i=new yn(this,this._clock+(this._pulse?0:1)),d=e.pulse&&e.pulse.source||[];return i.target=e,this._pulses[e.id]=n.pulse(i,d),this},VC.touch=function(e,t){return this._pulse?this._enqueue(e):this._touched.add(e),(t||YC).skip&&e.skip(!0),this},VC.update=function(e,t,n){var a=n||YC;return(e.set(t)||a.force)&&this.touch(e,a),this},VC.changeset=he,VC.ingest=function(e,t,n){return this.pulse(e,this.changeset().insert(un(t,n)))},VC.request=function(e,t,n){var a=this,i=0,d=a._pending||gn(a);return d.requests+=1,a.loader().load(t,{context:'dataflow'}).then(function(e){return un(e,n)},function(e){i=-1,a.error('Loading failed',t,e)}).catch(function(e){i=-2,a.error('Data ingestion failed',t,e)}).then(function(t){return a.pulse(e,a.changeset().remove(_S).insert(t||[])),d.done(),i})},VC.events=function(e,t,a,d){var r=this,l=ve(a,d),o=function(t){t.dataflow=r;try{l.receive(t)}catch(e){r.error(e)}finally{r.run()}},s;s='string'==typeof e&&'undefined'!=typeof document?document.querySelectorAll(e):P(e);for(var f=0,c=s.length;f<c;++f)s[f].addEventListener(t,o);return l},VC.on=function(e,t,n,a,i){var d=e instanceof be?hn:mn;return d(this,e,t,n,a,i),this},VC.run=function(e){var t=this,n=0,a=t.logLevel(),i,d,r,l;if(t._pending)return t.info('Awaiting requests, delaying dataflow run.'),0;if(t._pulse)return t.error('Dataflow invoked recursively. Use the runAfter method to queue invocation.'),0;if(!t._touched.length)return t.info('Dataflow invoked, but nothing to do.'),0;t._pulse=new yn(t,++t._clock,e),3<=a&&(r=Date.now(),t.debug('-- START PROPAGATION ('+t._clock+') -----')),t._touched.forEach(function(e){t._enqueue(e,!0)}),t._touched=le(bS);try{for(;0<t._heap.size();){// re-queue if rank changes
if(i=t._heap.pop(),i.rank!==i.qrank){t._enqueue(i,!0);continue}// otherwise, evaluate the operator
d=i.run(t._getPulse(i,e)),4<=a&&t.debug(i.id,d===BC?'STOP':d,i),d!==BC&&(t._pulse=d,i._targets&&i._targets.forEach(function(e){t._enqueue(e)})),++n}}catch(e){l=e}// reset pulse map
if(t._pulses={},t._pulse=null,3<=a&&(r=Date.now()-r,t.info('> Pulse '+t._clock+': '+n+' operators; '+r+'ms')),l&&(t._postrun=[],t.error(l)),t._onrun)try{t._onrun(t,n,l)}catch(e){t.error(e)}// invoke callbacks queued via runAfter
if(t._postrun.length){var o=t._postrun;t._postrun=[],o.sort(function(e,t){return t.priority-e.priority}).forEach(function(e){kn(t,e.callback)})}return this},VC.runAsync=function(){// return this._pending || Promise.resolve(this.run());
return this._pending||this.run()&&this._pending||Promise.resolve(this)},VC.runAfter=function(e,t,n){this._pulse||t?this._postrun.push({priority:n||0,callback:e}):kn(this,e)},VC._enqueue=function(e,t){var n=!this._pulses[e.id];n&&(this._pulses[e.id]=this._pulse),(n||t)&&(e.qrank=e.rank,this._heap.push(e))},VC._getPulse=function(e,t){var n=e.source,a=this._clock,i;return n&&hS(n)?(i=n.map(function(e){return e.pulse}),new vn(this,a,i,t)):(i=this._pulses[e.id],n&&(n=n.pulse,n&&n!==BC?n.stamp===a&&i.target!==e?i=n:i.source=n.source:i.source=[]),i)},VC.error=zn('error'),VC.warn=zn('warn'),VC.info=zn('info'),VC.debug=zn('debug'),VC.logLevel=zn('level');var XC=W(Dn,be);/**
   * Overrides {@link Operator.evaluate} for transform operators.
   * Internally, this method calls {@link evaluate} to perform processing.
   * If {@link evaluate} returns a falsy value, the input pulse is returned.
   * This method should NOT be overridden, instead overrride {@link evaluate}.
   * @param {Pulse} pulse - the current dataflow pulse.
   * @return the output pulse for this operator (or StopPropagation)
   */XC.run=function(e){if(e.stamp<=this.stamp)return e.StopPropagation;var t;return this.skip()?this.skip(!1):t=this.evaluate(e),t=t||e,t!==e.StopPropagation&&(this.pulse=t),this.stamp=e.stamp,t},XC.evaluate=function(e){var t=this.marshall(e.stamp),n=this.transform(t,e);return t.clear(),n},XC.transform=function(){};var ZC={},JC={values:Pn({name:'values',init:'cell.store = true;',set:'cell.data.values()',idx:-1}),count:Pn({name:'count',set:'cell.num'}),__count__:Pn({name:'count',set:'this.missing + this.valid'}),missing:Pn({name:'missing',set:'this.missing'}),valid:Pn({name:'valid',set:'this.valid'}),sum:Pn({name:'sum',init:'this.sum = 0;',add:'this.sum += +v;',rem:'this.sum -= v;',set:'this.sum'}),mean:Pn({name:'mean',init:'this.mean = 0;',add:'var d = v - this.mean; this.mean += d / this.valid;',rem:'var d = v - this.mean; this.mean -= this.valid ? d / this.valid : this.mean;',set:'this.valid ? this.mean : undefined'}),average:Pn({name:'average',set:'this.valid ? this.mean : undefined',req:['mean'],idx:1}),variance:Pn({name:'variance',init:'this.dev = 0;',add:'this.dev += d * (v - this.mean);',rem:'this.dev -= d * (v - this.mean);',set:'this.valid > 1 ? this.dev / (this.valid-1) : undefined',req:['mean'],idx:1}),variancep:Pn({name:'variancep',set:'this.valid > 1 ? this.dev / this.valid : undefined',req:['variance'],idx:2}),stdev:Pn({name:'stdev',set:'this.valid > 1 ? Math.sqrt(this.dev / (this.valid-1)) : undefined',req:['variance'],idx:2}),stdevp:Pn({name:'stdevp',set:'this.valid > 1 ? Math.sqrt(this.dev / this.valid) : undefined',req:['variance'],idx:2}),stderr:Pn({name:'stderr',set:'this.valid > 1 ? Math.sqrt(this.dev / (this.valid * (this.valid-1))) : undefined',req:['variance'],idx:2}),distinct:Pn({name:'distinct',set:'cell.data.distinct(this.get)',req:['values'],idx:3}),ci0:Pn({name:'ci0',set:'cell.data.ci0(this.get)',req:['values'],idx:3}),ci1:Pn({name:'ci1',set:'cell.data.ci1(this.get)',req:['values'],idx:3}),median:Pn({name:'median',set:'cell.data.q2(this.get)',req:['values'],idx:3}),q1:Pn({name:'q1',set:'cell.data.q1(this.get)',req:['values'],idx:3}),q3:Pn({name:'q3',set:'cell.data.q3(this.get)',req:['values'],idx:3}),argmin:Pn({name:'argmin',init:'this.argmin = undefined;',add:'if (v < this.min) this.argmin = t;',rem:'if (v <= this.min) this.argmin = undefined;',set:'this.argmin || cell.data.argmin(this.get)',req:['min'],str:['values'],idx:3}),argmax:Pn({name:'argmax',init:'this.argmax = undefined;',add:'if (v > this.max) this.argmax = t;',rem:'if (v >= this.max) this.argmax = undefined;',set:'this.argmax || cell.data.argmax(this.get)',req:['max'],str:['values'],idx:3}),min:Pn({name:'min',init:'this.min = undefined;',add:'if (v < this.min || this.min === undefined) this.min = v;',rem:'if (v <= this.min) this.min = NaN;',set:'this.min = (isNaN(this.min) ? cell.data.min(this.get) : this.min)',str:['values'],idx:4}),max:Pn({name:'max',init:'this.max = undefined;',add:'if (v > this.max || this.max === undefined) this.max = v;',rem:'if (v >= this.max) this.max = NaN;',set:'this.max = (isNaN(this.max) ? cell.data.max(this.get) : this.max)',str:['values'],idx:4})},QC=Object.keys(JC);e.random=Math.random;var KC=Bn(Nn),ez=KC.right,tz=KC.left,nz=dS(50),az=dS(10),iz=dS(2),dz=ma.prototype;dz.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null},dz.add=function(e){this._add.push(e)},dz.rem=function(e){this._rem.push(e)},dz.values=function(){if(this._get=null,0===this._rem.length)return this._add;var e=this._add,t=this._rem,a=this._key,d=e.length,n=t.length,r=Array(d-n),l={},o,s,f;// use unique key field to clear removed values
for(o=0;o<n;++o)l[a(t[o])]=1;for(o=0,s=0;o<d;++o)l[a(f=e[o])]?l[a(f)]=0:r[s++]=f;return this._rem=[],this._add=r},dz.distinct=function(e){for(var t=this.values(),a=t.length,i={},d=0,r;0<=--a;)r=e(t[a])+'',i.hasOwnProperty(r)||(i[r]=1,++d);return d},dz.extent=function(e){if(this._get!==e||!this._ext){var t=this.values(),n=I(t,e);this._ext=[t[n[0]],t[n[1]]],this._get=e}return this._ext},dz.argmin=function(e){return this.extent(e)[0]||{}},dz.argmax=function(e){return this.extent(e)[1]||{}},dz.min=function(e){var t=this.extent(e)[0];return null==t?void 0:e(t)},dz.max=function(e){var t=this.extent(e)[1];return null==t?void 0:e(t)},dz.quartile=function(e){return this._get===e&&this._q||(this._q=sa(this.values(),e),this._get=e),this._q},dz.q1=function(e){return this.quartile(e)[0]},dz.q2=function(e){return this.quartile(e)[1]},dz.q3=function(e){return this.quartile(e)[2]},dz.ci=function(e){return this._get===e&&this._ci||(this._ci=oa(this.values(),1e3,.05,e),this._get=e),this._ci},dz.ci0=function(e){return this.ci(e)[0]},dz.ci1=function(e){return this.ci(e)[1]},ha.Definition={type:'Aggregate',metadata:{generates:!0,changes:!0},params:[{name:'groupby',type:'field',array:!0},{name:'ops',type:'enum',array:!0,values:QC},{name:'fields',type:'field',null:!0,array:!0},{name:'as',type:'string',null:!0,array:!0},{name:'drop',type:'boolean',default:!0},{name:'cross',type:'boolean',default:!1},{name:'key',type:'field'}]};var rz=W(ha,Dn);rz.transform=function(e,t){var n=this,a=t.fork(t.NO_SOURCE|t.NO_FIELDS),i;return this.stamp=a.stamp,this.value&&((i=e.modified())||t.modified(this._inputs))?(this._prev=this.value,this.value=i?this.init(e):{},t.visit(t.SOURCE,function(e){n.add(e)})):(this.value=this.value||this.init(e),t.visit(t.REM,function(e){n.rem(e)}),t.visit(t.ADD,function(e){n.add(e)})),a.modifies(this._outputs),n._drop=!1!==e.drop,e.cross&&1<n._dims.length&&(n._drop=!1,this.cross()),n.changes(a)},rz.cross=function(){// collect all group-by domain values
function e(e){var n,a,o,s;for(n in e)for(o=e[n].tuple,a=0;a<l;++a)r[a][s=o[d[a]]]=s}// iterate over key cross-product, create cells as needed
function t(e,n,o){var s=d[o],f=r[o++],c,u;for(c in f)n[s]=f[c],u=e?e+'|'+c:c,o<l?t(u,n,o):!i[u]&&a.cell(u,n)}var a=this,i=a.value,d=a._dnames,r=d.map(function(){return{}}),l=d.length;e(a._prev),e(i),t('',{},0)},rz.init=function(e){function t(e){for(var t=P(s(e)),d=0,r=t.length,n;d<r;++d)l[n=t[d]]||(l[n]=1,a.push(n))}// initialize group-by dimensions
// initialize input and output fields
var a=this._inputs=[],r=this._outputs=[],l={};this._dims=P(e.groupby),this._dnames=this._dims.map(function(e){var n=o(e);return t(e),r.push(n),n}),this.cellkey=e.key?e.key:Tn(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];var f=e.fields||[null],c=e.ops||['count'],p=e.as||[],d=f.length,n={},g,h,y,b,_,x;for(d!==c.length&&u('Unmatched number of fields and aggregate ops.'),x=0;x<d;++x){if(g=f[x],h=c[x],null==g&&'count'!==h&&u('Null aggregate field specified.'),b=o(g),_=An(h,b,p[x]),r.push(_),'count'===h){this._counts.push(_);continue}y=n[b],y||(t(g),y=n[b]=[],y.field=g,this._measures.push(y)),'count'!==h&&(this._countOnly=!1),y.push(Ln(h,_))}return this._measures=this._measures.map(function(e){return jn(e,e.field)}),{};// aggregation cells (this.value)
},rz.cellkey=Tn(),rz.cell=function(e,n){var t=this.value[e];return t?0===t.num&&this._drop&&t.stamp<this.stamp?(t.stamp=this.stamp,this._adds[this._alen++]=t):t.stamp<this.stamp&&(t.stamp=this.stamp,this._mods[this._mlen++]=t):(t=this.value[e]=this.newcell(e,n),this._adds[this._alen++]=t),t},rz.newcell=function(e,a){var t={key:e,num:0,agg:null,tuple:this.newtuple(a,this._prev&&this._prev[e]),stamp:this.stamp,store:!1};if(!this._countOnly){var d=this._measures,r=d.length,n;for(t.agg=Array(r),n=0;n<r;++n)t.agg[n]=new d[n](t)}return t.store&&(t.data=new ma),t},rz.newtuple=function(e,t){var a=this._dnames,d=this._dims,r={},l,o;for(l=0,o=d.length;l<o;++l)r[a[l]]=d[l](e);return t?ge(t.tuple,r):ce(r)},rz.add=function(e){var t=this.cellkey(e),a=this.cell(t,e),d,r,l;if(a.num+=1,!this._countOnly)for(a.store&&a.data.add(e),d=a.agg,(r=0,l=d.length);r<l;++r)d[r].add(d[r].get(e),e)},rz.rem=function(e){var t=this.cellkey(e),a=this.cell(t,e),d,r,l;if(a.num-=1,!this._countOnly)for(a.store&&a.data.rem(e),d=a.agg,(r=0,l=d.length);r<l;++r)d[r].rem(d[r].get(e),e)},rz.celltuple=function(e){var t=e.tuple,a=this._counts,d,r,l;// consolidate stored values
// update tuple properties
for(e.store&&e.data.values(),r=0,l=a.length;r<l;++r)t[a[r]]=e.num;if(!this._countOnly)for(d=e.agg,r=0,l=d.length;r<l;++r)d[r].set(t);return t},rz.changes=function(e){var t=this._adds,a=this._mods,d=this._prev,r=this._drop,l=e.add,o=e.rem,s=e.mod,f,c,u,p;if(d)for(c in d)f=d[c],(!r||f.num)&&o.push(f.tuple);for(u=0,p=this._alen;u<p;++u)l.push(this.celltuple(t[u])),t[u]=null;for(u=0,p=this._mlen;u<p;++u)f=a[u],(0===f.num&&r?o:s).push(this.celltuple(f)),a[u]=null;return this._alen=this._mlen=0,this._prev=null,e},ya.Definition={type:'Bin',metadata:{modifies:!0},params:[{name:'field',type:'field',required:!0},{name:'anchor',type:'number'},{name:'maxbins',type:'number',default:20},{name:'base',type:'number',default:10},{name:'divide',type:'number',array:!0,default:[5,2]},{name:'extent',type:'number',array:!0,length:2,required:!0},{name:'step',type:'number'},{name:'steps',type:'number',array:!0},{name:'minstep',type:'number',default:0},{name:'nice',type:'boolean',default:!0},{name:'name',type:'string'},{name:'as',type:'string',array:!0,length:2,default:['bin0','bin1']}]};var lz=W(ya,Dn);lz.transform=function(e,t){var n=this._bins(e),a=n.start,i=n.step,d=e.as||['bin0','bin1'],r=d[0],l=d[1],o;return e.modified()?(t=t.reflow(!0),o=t.SOURCE):o=t.modified(s(e.field))?t.ADD_MOD:t.ADD,t.visit(o,function(e){var t=n(e);// minimum bin value (inclusive)
e[r]=t,e[l]=null==t?null:a+i*(1+(t-a)/i)}),t.modifies(d)},lz._bins=function(e){if(this.value&&!e.modified())return this.value;var n=e.field,i=qn(e),l=i.start,c=i.stop,u=i.step,p,t;null!=(p=e.anchor)&&(t=p-(l+u*sS((p-l)/u)),l+=t,c+=t);var g=function(e){var t=n(e);return null==t?null:(t=fS(l,iS(+t,c-u)),l+u*sS((t-l)/u))};return g.start=l,g.stop=c,g.step=u,this.value=r(g,s(n),e.name||'bin_'+o(n))},_a.Definition={type:'Collect',metadata:{source:!0},params:[{name:'sort',type:'compare'}]};var oz=W(_a,Dn);oz.transform=function(e,t){var n=t.fork(t.ALL),a=ba(se,this.value,n.materialize(n.ADD).add),i=e.sort,d=t.changed()||i&&(e.modified('sort')||t.modified(i.fields));return n.visit(n.REM,a.remove),this.modified(d),this.value=n.source=a.data(i,d),t.source&&t.source.root&&(this.value.root=t.source.root),n},W(xa,be),ka.Definition={type:'CountPattern',metadata:{generates:!0,changes:!0},params:[{name:'field',type:'field',required:!0},{name:'case',type:'enum',values:['upper','lower','mixed'],default:'mixed'},{name:'pattern',type:'string',default:'[\\w"]+'},{name:'stopwords',type:'string',default:''},{name:'as',type:'string',array:!0,length:2,default:['text','count']}]};var sz=W(ka,Dn);sz.transform=function(e,t){function n(a){return function(o){for(var s=wa(l(o),e.case,d)||[],f=0,c=s.length,n;f<c;++f)r.test(n=s[f])||a(n)}}var a=this._parameterCheck(e,t),i=this._counts,d=this._match,r=this._stop,l=e.field,o=e.as||['text','count'],s=n(function(e){i[e]=1+(i[e]||0)}),f=n(function(e){i[e]-=1});return a?t.visit(t.SOURCE,s):(t.visit(t.ADD,s),t.visit(t.REM,f)),this._finish(t,o);// generate output tuples
},sz._parameterCheck=function(e,t){var n=!1;return(e.modified('stopwords')||!this._stop)&&(this._stop=new RegExp('^'+(e.stopwords||'')+'$','i'),n=!0),(e.modified('pattern')||!this._match)&&(this._match=new RegExp(e.pattern||'[\\w\']+','g'),n=!0),(e.modified('field')||t.modified(e.field.fields))&&(n=!0),n&&(this._counts={}),n},sz._finish=function(e,n){var a=this._counts,i=this._tuples||(this._tuples={}),d=n[0],r=n[1],l=e.fork(e.NO_SOURCE|e.NO_FIELDS),o,s,f;for(o in a)s=i[o],f=a[o]||0,!s&&f?(i[o]=s=ce({}),s[d]=o,s[r]=f,l.add.push(s)):0===f?(s&&l.rem.push(s),a[o]=null,i[o]=null):s[r]!==f&&(s[r]=f,l.mod.push(s));return l.modifies(n)},Ea.Definition={type:'Cross',metadata:{generates:!0},params:[{name:'filter',type:'expr'},{name:'as',type:'string',array:!0,length:2,default:['a','b']}]};var fz=W(Ea,Dn);fz.transform=function(e,t){var n=t.fork(t.NO_SOURCE),i=this.value,d=e.as||['a','b'],r=d[0],a=d[1],l=!i||t.changed(t.ADD_REM)||e.modified('as')||e.modified('filter');return l?(i&&(n.rem=i),i=t.materialize(t.SOURCE).source,n.add=this.value=Sa(i,r,a,e.filter||_S)):n.mod=i,n.source=this.value,n.modifies(d)};var cz={kde:ca,mixture:pa,normal:fa,uniform:ga},uz=[{key:{function:'normal'},params:[{name:'mean',type:'number',default:0},{name:'stdev',type:'number',default:1}]},{key:{function:'uniform'},params:[{name:'min',type:'number',default:0},{name:'max',type:'number',default:1}]},{key:{function:'kde'},params:[{name:'field',type:'field',required:!0},{name:'from',type:'data'},{name:'bandwidth',type:'number',default:0}]}];za.Definition={type:'Density',metadata:{generates:!0},params:[{name:'extent',type:'number',array:!0,length:2},{name:'steps',type:'number',default:100},{name:'method',type:'string',default:'pdf',values:['pdf','cdf']},{name:'distribution',type:'param',params:uz.concat({key:{function:'mixture'},params:[{name:'distributions',type:'param',array:!0,params:uz},{name:'weights',type:'number',array:!0}]})},{name:'as',type:'string',array:!0,default:['value','density']}]};var pz=W(za,Dn);pz.transform=function(e,t){var n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){var a=Ca(e.distribution,Da(t)),i=e.method||'pdf';'pdf'!==i&&'cdf'!==i&&u('Invalid density method: '+i),e.extent||a.data||u('Missing density extent parameter.'),i=a[i];var d=e.as||['value','density'],r=e.extent||Yn(a.data()),l=(r[1]-r[0])/(e.steps||100),o=Hn(r[0],r[1]+l/2,l).map(function(e){var t={};return t[d[0]]=e,t[d[1]]=i(e),ce(t)});this.value&&(n.rem=this.value),this.value=n.add=n.source=o}return n},W(Ra,be),Oa.Definition={type:'Extent',metadata:{},params:[{name:'field',type:'field',required:!0}]};var gz=W(Oa,Dn);gz.transform=function(e,t){var n=this.value,a=e.field,i=n[0],d=n[1],r;r=t.changed()||t.modified(a.fields)||e.modified('field'),(r||null==i)&&(i=+Infinity,d=-Infinity),t.visit(r?t.SOURCE:t.ADD,function(e){var t=a(e);null!=t&&(t=+t,t<i&&(i=t),t>d&&(d=t))}),isFinite(i)&&isFinite(d)||(i=d=void 0),this.value=[i,d]};var mz=W(Ta,be);mz.connect=function(e){return this.targets().add(e),e.source=this},mz.add=function(e){this.value.add.push(e)},mz.rem=function(e){this.value.rem.push(e)},mz.mod=function(e){this.value.mod.push(e)},mz.init=function(e){this.value.init(e,e.NO_SOURCE)},mz.evaluate=function(){// assert: this.value.stamp === pulse.stamp
return this.value};var hz=W(Aa,Dn);hz.activate=function(e){this._targets[this._targets.active++]=e},hz.subflow=function(e,t,n,a){var i=this.value,d=i.hasOwnProperty(e)&&i[e],r,l;return d?d.value.stamp<n.stamp&&(d.init(n),this.activate(d)):(l=a||(l=this._group[e])&&l.tuple,r=n.dataflow,d=r.add(new Ta(n.fork(n.NO_SOURCE),this)).connect(t(r,e,l)),i[e]=d,this.activate(d)),d},hz.transform=function(e,t){function n(e){return i.subflow(e,r,t)}var a=t.dataflow,i=this,d=e.key,r=e.subflow,l=this._keys,o=e.modified('key');return this._group=e.group||{},this._targets.active=0,t.visit(t.REM,function(e){var t=se(e),a=l.get(t);void 0!==a&&(l.delete(t),n(a).rem(e))}),t.visit(t.ADD,function(e){var t=d(e);l.set(se(e),t),n(t).add(e)}),o||t.modified(d.fields)?t.visit(t.MOD,function(e){var t=se(e),a=l.get(t),i=d(e);a===i?n(i).mod(e):(l.set(t,i),n(a).rem(e),n(i).add(e))}):t.changed(t.MOD)&&t.visit(t.MOD,function(e){n(l.get(se(e))).mod(e)}),o&&t.visit(t.REFLOW,function(e){var t=se(e),a=l.get(t),i=d(e);a!==i&&(l.set(t,i),n(a).rem(e),n(i).add(e))}),l.empty>a.cleanThreshold&&a.runAfter(l.clean),t},W(La,be),Ma.Definition={type:'Filter',metadata:{changes:!0},params:[{name:'expr',type:'expr',required:!0}]};var yz=W(Ma,Dn);yz.transform=function(e,t){function n(n){var t=se(n),a=f(n,e),d=i.get(t);a&&d?(i.delete(t),r.push(n)):a||d?c&&a&&!d&&o.push(n):(i.set(t,1),l.push(n))}var a=t.dataflow,i=this.value,// cache ids of filtered tuples
d=t.fork(),r=d.add,l=d.rem,o=d.mod,f=e.expr,c=!0;return t.visit(t.REM,function(e){var t=se(e);i.has(t)?i.delete(t):l.push(e)}),t.visit(t.ADD,function(n){f(n,e)?r.push(n):i.set(se(n),1)}),t.visit(t.MOD,n),e.modified()&&(c=!1,t.visit(t.REFLOW,n)),i.empty>a.cleanThreshold&&a.runAfter(i.clean),d},ja.Definition={type:'Flatten',metadata:{generates:!0},params:[{name:'fields',type:'field',array:!0,required:!0},{name:'as',type:'string',array:!0}]};var bz=W(ja,Dn);bz.transform=function(e,t){var n=t.fork(t.NO_SOURCE),a=e.fields,r=Ua(a,e.as||[]),l=r.length;// remove any previous results
return n.rem=this.value,t.visit(t.SOURCE,function(e){for(var t=a.map(function(t){return t(e)}),o=t.reduce(function(e,t){return fS(e,t.length)},0),s=0,f,c,u;s<o;++s){for(c=ue(e),f=0;f<l;++f)c[r[f]]=null==(u=t[f][s])?null:u;n.add.push(c)}}),this.value=n.source=n.add,n.modifies(r)},qa.Definition={type:'Fold',metadata:{generates:!0},params:[{name:'fields',type:'field',array:!0,required:!0},{name:'as',type:'string',array:!0,length:2,default:['key','value']}]};var _z=W(qa,Dn);_z.transform=function(e,t){var a=t.fork(t.NO_SOURCE),r=e.fields,l=r.map(o),s=e.as||['key','value'],f=s[0],c=s[1],u=r.length;return a.rem=this.value,t.visit(t.SOURCE,function(e){for(var t=0,n;t<u;++t)n=ue(e),n[f]=l[t],n[c]=r[t](e),a.add.push(n)}),this.value=a.source=a.add,a.modifies(s)},Fa.Definition={type:'Formula',metadata:{modifies:!0},params:[{name:'expr',type:'expr',required:!0},{name:'as',type:'string',required:!0},{name:'initonly',type:'boolean'}]};var xz=W(Fa,Dn);xz.transform=function(e,t){var n=e.expr,a=e.as,i=e.modified(),d=e.initonly?t.ADD:i?t.SOURCE:t.modified(n.fields)?t.ADD_MOD:t.ADD;return i&&(t=t.materialize().reflow(!0)),e.initonly||t.modifies(a),t.visit(d,function(i){i[a]=n(i,e)})};var vz=W(Ia,Dn);vz.transform=function(e,n){var a=this.value,i=n.fork(n.ALL),d=e.size-a.length,r=e.generator,l,o,s;if(0<d){// need more tuples, generate and add
for(l=[];0<=--d;)l.push(s=ce(r(e))),a.push(s);i.add=i.add.length?i.materialize(i.ADD).add.concat(l):l}else// need fewer tuples, remove
o=a.slice(0,-d),i.rem=i.rem.length?i.materialize(i.REM).rem.concat(o):o,a=a.slice(-d);return i.source=this.value=a,i};var kz={value:'value',median:ia,mean:ea,min:da,max:Kn},wz=[];Na.Definition={type:'Impute',metadata:{changes:!0},params:[{name:'field',type:'field',required:!0},{name:'key',type:'field',required:!0},{name:'keyvals',array:!0},{name:'groupby',type:'field',array:!0},{name:'method',type:'enum',default:'value',values:['value','mean','median','max','min']},{name:'value',default:0}]};var Ez=W(Na,Dn);Ez.transform=function(e,a){var d=a.fork(a.ALL),r=Ba(e),s=Wa(e),f=o(e.field),c=o(e.key),u=(e.groupby||[]).map(o),p=Ga(a.source,e.groupby,e.key,e.keyvals),h=[],y=this.value,b=p.domain.length,m,_,x,v,k,w,E,S,C,z;for(k=0,S=p.length;k<S;++k)// add tuples for missing values
for(m=p[k],x=m.values,_=NaN,E=0;E<b;++E)if(null==m[E]){for(v=p.domain[E],z={_impute:!0},(w=0,C=x.length);w<C;++w)z[u[w]]=x[w];z[c]=v,z[f]=isNaN(_)?_=r(m,s):_,h.push(ce(z))}// update pulse with imputed tuples
return h.length&&(d.add=d.materialize(d.ADD).add.concat(h)),y.length&&(d.rem=d.materialize(d.REM).rem.concat(y)),this.value=h,d},Ya.Definition={type:'JoinAggregate',metadata:{modifies:!0},params:[{name:'groupby',type:'field',array:!0},{name:'fields',type:'field',null:!0,array:!0},{name:'ops',type:'enum',array:!0,values:QC},{name:'as',type:'string',null:!0,array:!0},{name:'key',type:'field'}]};var Sz=W(Ya,ha);Sz.transform=function(e,t){var n=this,a=e.modified(),i;// process all input tuples to calculate aggregates
return n.value&&(a||t.modified(n._inputs))?(i=n.value=a?n.init(e):{},t.visit(t.SOURCE,function(e){n.add(e)})):(i=n.value=n.value||this.init(e),t.visit(t.REM,function(e){n.rem(e)}),t.visit(t.ADD,function(e){n.add(e)})),n.changes(),t.visit(t.SOURCE,function(e){F(e,i[n.cellkey(e)].tuple)}),t.reflow(a).modifies(this._outputs)},Sz.changes=function(){var e=this._adds,t=this._mods,a,d;for(a=0,d=this._alen;a<d;++a)this.celltuple(e[a]),e[a]=null;for(a=0,d=this._mlen;a<d;++a)this.celltuple(t[a]),t[a]=null;this._alen=this._mlen=0},W(Ha,be);var Cz=W(Xa,Dn);Cz.transform=function(e,t){t.dataflow.request(this.target,e.url,e.format)},Za.Definition={type:'Lookup',metadata:{modifies:!0},params:[{name:'index',type:'index',params:[{name:'from',type:'data',required:!0},{name:'key',type:'field',required:!0}]},{name:'values',type:'field',array:!0},{name:'fields',type:'field',array:!0,required:!0},{name:'as',type:'string',array:!0},{name:'default',default:null}]};var zz=W(Za,Dn);zz.transform=function(e,t){var a=t,d=e.as,r=e.fields,l=e.index,s=e.values,f=null==e.default?null:e.default,c=e.modified(),p=c?t.SOURCE:t.ADD,g=r.length,n,i,h;return s?(i=s.length,1<g&&!d&&u('Multi-field lookup requires explicit "as" parameter.'),d&&d.length!==g*i&&u('The "as" parameter has too few output field names.'),d=d||s.map(o),n=function(e){for(var t=0,n=0,a,o;t<g;++t)if(o=l.get(r[t](e)),null==o)for(a=0;a<i;++a,++n)e[d[n]]=f;else for(a=0;a<i;++a,++n)e[d[n]]=s[a](o)}):(!d&&u('Missing output field names.'),n=function(e){for(var t=0,n;t<g;++t)n=l.get(r[t](e)),e[d[t]]=null==n?f:n}),c?a=t.reflow(!0):(h=r.some(function(e){return t.modified(e.fields)}),p|=h?t.MOD:0),t.visit(p,n),a.modifies(d)},W(Ja,be),W(Ka,be),W(ti,Dn),ti.prototype.transform=function(e,t){return this.modified(e.modified()),this.value=e,t.fork(t.NO_SOURCE|t.NO_FIELDS);// do not pass tuples
},ni.Definition={type:'Pivot',metadata:{generates:!0,changes:!0},params:[{name:'groupby',type:'field',array:!0},{name:'field',type:'field',required:!0},{name:'value',type:'field',required:!0},{name:'op',type:'enum',values:QC,default:'sum'},{name:'limit',type:'number',default:0},{name:'key',type:'field'}]};var Dz=W(ni,ha);Dz._transform=Dz.transform,Dz.transform=function(e,t){return this._transform(ai(e,t),t)};var Rz=W(ri,Aa);Rz.transform=function(e,n){var a=this,i=e.subflow,d=e.field;return(e.modified('field')||d&&n.modified(s(d)))&&u('PreFacet does not support field modification.'),this._targets.active=0,n.visit(n.MOD,function(e){var t=a.subflow(se(e),i,n,e);d?d(e).forEach(function(e){t.mod(e)}):t.mod(e)}),n.visit(n.ADD,function(e){var t=a.subflow(se(e),i,n,e);d?d(e).forEach(function(e){t.add(ce(e))}):t.add(e)}),n.visit(n.REM,function(e){var t=a.subflow(se(e),i,n,e);d?d(e).forEach(function(e){t.rem(e)}):t.rem(e)}),n},li.Definition={type:'Project',metadata:{generates:!0,changes:!0},params:[{name:'fields',type:'field',array:!0},{name:'as',type:'string',null:!0,array:!0}]};var $z=W(li,Dn);$z.transform=function(e,t){var n=e.fields,a=Ua(e.fields,e.as||[]),i=n?function(e,i){return oi(e,i,n,a)}:pe,d,r;return this.value?r=this.value:(t=t.addAll(),r=this.value={}),d=t.fork(t.NO_SOURCE),t.visit(t.REM,function(e){var t=se(e);d.rem.push(r[t]),r[t]=null}),t.visit(t.ADD,function(e){var t=i(e,ce({}));r[se(e)]=t,d.add.push(t)}),t.visit(t.MOD,function(e){d.mod.push(i(e,r[se(e)]))}),d};var Oz=W(si,Dn);Oz.transform=function(e,t){return this.value=e.value,e.modified('value')?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation};var Tz=W(fi,Dn);Tz.transform=function(e,t){var n,a;return this.value?a=this.value:(n=t=t.addAll(),a=this.value={}),e.derive&&(n=t.fork(t.NO_SOURCE),t.visit(t.REM,function(e){var t=se(e);n.rem.push(a[t]),a[t]=null}),t.visit(t.ADD,function(e){var t=ue(e);a[se(e)]=t,n.add.push(t)}),t.visit(t.MOD,function(e){n.mod.push(pe(e,a[se(e)]))})),n},ci.Definition={type:'Sample',metadata:{},params:[{name:'size',type:'number',default:1e3}]};var Az=W(ci,Dn);Az.transform=function(t,a){// sample reservoir update function
function d(n){var t,a;s.length<o?s.push(n):(a=~~((f+1)*e.random()),a<s.length&&a>=c&&(t=s[a],u[se(t)]&&r.rem.push(t),s[a]=n)),++f}var r=a.fork(a.NO_SOURCE),l=t.modified('size'),o=t.size,s=this.value,f=this.count,c=0,u=s.reduce(function(e,n){return e[se(n)]=1,e},{});if(a.rem.length&&(a.visit(a.REM,function(e){var t=se(e);u[t]&&(u[t]=-1,r.rem.push(e)),--f}),s=s.filter(function(e){return-1!==u[se(e)]})),(a.rem.length||l)&&s.length<o&&a.source&&(c=f=s.length,a.visit(a.SOURCE,function(e){u[se(e)]||d(e)}),c=-1),l&&s.length>o){for(var p=0,g=s.length-o;p<g;++p)u[se(s[p])]=-1,r.rem.push(s[p]);s=s.slice(g)}return a.mod.length&&a.visit(a.MOD,function(e){u[se(e)]&&r.mod.push(e)}),a.add.length&&a.visit(a.ADD,d),(a.add.length||0>c)&&(r.add=s.filter(function(e){return!u[se(e)]})),this.count=f,this.value=r.source=s,r},ui.Definition={type:'Sequence',metadata:{changes:!0},params:[{name:'start',type:'number',required:!0},{name:'stop',type:'number',required:!0},{name:'step',type:'number',default:1},{name:'as',type:'string',default:'data'}]};var Lz=W(ui,Dn);Lz.transform=function(e,t){if(!this.value||e.modified()){var n=t.materialize().fork(t.MOD),a=e.as||'data';return n.rem=this.value?t.rem.concat(this.value):t.rem,this.value=Hn(e.start,e.stop,e.step||1).map(function(e){var n={};return n[a]=e,ce(n)}),n.add=t.add.concat(this.value),n}};var Pz=W(gi,Dn);Pz.transform=function(e,t){return this.value=t.source,t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation};var Mz=W(mi,Dn);Mz.transform=function(e,t){function n(e){d.set(i(e),e)}var a=t.dataflow,i=e.field,d=this.value,r=!0;return e.modified('field')||t.modified(i.fields)?(d.clear(),t.visit(t.SOURCE,n)):t.changed()?(t.visit(t.REM,function(e){d.delete(i(e))}),t.visit(t.ADD,n)):r=!1,this.modified(r),d.empty>a.cleanThreshold&&a.runAfter(d.clean),t.fork()};var Uz=W(hi,Dn);Uz.transform=function(e,t){var n=!this.value||e.modified('field')||e.modified('sort')||t.changed()||e.sort&&t.modified(e.sort.fields);n&&(this.value=(e.sort?t.source.slice().sort(e.sort):t.source).map(e.field))};var jz={row_number:function(){return{next:function(e){return e.index+1}}},rank:function(){var e;return{init:function(){e=1},next:function(t){var n=t.index,a=t.data;return n&&t.compare(a[n-1],a[n])?e=n+1:e}}},dense_rank:function(){var e;return{init:function(){e=1},next:function(t){var n=t.index,a=t.data;return n&&t.compare(a[n-1],a[n])?++e:e}}},percent_rank:function(){var e=jz.rank(),t=e.next;return{init:e.init,next:function(e){return(t(e)-1)/(e.data.length-1)}}},cume_dist:function(){var e;return{init:function(){e=0},next:function(t){var n=t.index,a=t.data,d=t.compare;if(e<n){for(;n+1<a.length&&!d(a[n],a[n+1]);)++n;e=n}return(1+e)/a.length}}},ntile:function(e,t){t=+t,0<t||u('ntile num must be greater than zero.');var n=jz.cume_dist(),a=n.next;return{init:n.init,next:function(e){return cS(t*a(e))}}},lag:function(e,t){return t=+t||1,{next:function(n){var a=n.index-t;return 0<=a?e(n.data[a]):null}}},lead:function(e,t){return t=+t||1,{next:function(n){var a=n.index+t,i=n.data;return a<i.length?e(i[a]):null}}},first_value:function(e){return{next:function(t){return e(t.data[t.i0])}}},last_value:function(e){return{next:function(t){return e(t.data[t.i1-1])}}},nth_value:function(e,t){return t=+t,0<t||u('nth_value nth must be greater than zero.'),{next:function(n){var a=n.i0+(t-1);return a<n.i1?e(n.data[a]):null}}}},qz=Object.keys(jz),Fz=bi.prototype;Fz.init=function(){this.windows.forEach(function(e){e.init()}),this.cell&&this.cell.init()},Fz.update=function(e,n){var t=this,a=t.cell,i=t.windows,d=e.data,r=i&&i.length,l;if(a){for(l=e.p0;l<e.i0;++l)a.rem(d[l]);for(l=e.p1;l<e.i1;++l)a.add(d[l]);a.set(n)}for(l=0;l<r;++l)i[l].update(e,n)},xi.Definition={type:'Window',metadata:{modifies:!0},params:[{name:'sort',type:'compare'},{name:'groupby',type:'field',array:!0},{name:'ops',type:'enum',array:!0,values:qz.concat(QC)},{name:'params',type:'number',null:!0,array:!0},{name:'fields',type:'field',null:!0,array:!0},{name:'as',type:'string',null:!0,array:!0},{name:'frame',type:'number',null:!0,array:!0,length:2,default:[null,0]},{name:'ignorePeers',type:'boolean',default:!1}]};var Iz=W(xi,Dn);Iz.transform=function(e,t){function a(e){return d.group(f(e))}// partition input tuples
var d=this,r=d.state,l=e.modified(),o,s;this.stamp=t.stamp,(!r||l)&&(r=d.state=new bi(e));// retrieve group for a tuple
var f=Tn(e.groupby);// perform window calculations for each modified partition
for(l||t.modified(r.inputs)?(d.value={},t.visit(t.SOURCE,function(e){a(e).add(e)})):(t.visit(t.REM,function(e){a(e).remove(e)}),t.visit(t.ADD,function(e){a(e).add(e)})),o=0,s=d._mlen;o<s;++o)vi(d._mods[o],r,e);// TODO don't reflow everything?
return d._mlen=0,d._mods=[],t.reflow(l).modifies(r.outputs)},Iz.group=function(e){var t=this,n=t.value[e];return n||(n=t.value[e]=ba(se),n.stamp=-1),n.stamp<t.stamp&&(n.stamp=t.stamp,t._mods[t._mlen++]=n),n};var Nz=/*#__PURE__*/Object.freeze({aggregate:ha,bin:ya,collect:_a,compare:xa,countpattern:ka,cross:Ea,density:za,expression:Ra,extent:Oa,facet:Aa,field:La,filter:Ma,flatten:ja,fold:qa,formula:Fa,generate:Ia,impute:Na,joinaggregate:Ya,key:Ha,load:Xa,lookup:Za,multiextent:Ja,multivalues:Ka,params:ti,pivot:ni,prefacet:ri,project:li,proxy:si,relay:fi,sample:ci,sequence:ui,sieve:gi,subflow:Ta,tupleindex:mi,values:hi,window:xi}),tx=Ei.prototype;tx.clone=function(){return new Ei(this)},tx.clear=function(){return this.x1=+YE,this.y1=+YE,this.x2=-YE,this.y2=-YE,this},tx.empty=function(){return this.x1===+YE&&this.y1===+YE&&this.x2===-YE&&this.y2===-YE},tx.set=function(e,t,n,a){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),a<t?(this.y2=t,this.y1=a):(this.y1=t,this.y2=a),this},tx.add=function(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},tx.expand=function(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},tx.round=function(){return this.x1=sS(this.x1),this.y1=sS(this.y1),this.x2=cS(this.x2),this.y2=cS(this.y2),this},tx.translate=function(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},tx.rotate=function(e,t,n){var a=QE(e),i=KE(e),d=t-t*a+n*i,r=n-t*i-n*a,l=this.x1,o=this.x2,s=this.y1,f=this.y2;return this.clear().add(a*l-i*s+d,i*l+a*s+r).add(a*l-i*f+d,i*l+a*f+r).add(a*o-i*s+d,i*o+a*s+r).add(a*o-i*f+d,i*o+a*f+r)},tx.union=function(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},tx.intersect=function(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},tx.encloses=function(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},tx.alignsWith=function(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},tx.intersects=function(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},tx.contains=function(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},tx.width=function(){return this.x2-this.x1},tx.height=function(){return this.y2-this.y1};var Bz=0;W(zi,Ci);var Wz;['canvas','canvas-prebuilt'].some(function(e){try{Wz=require(e),'function'!=typeof Wz&&(Wz=null)}catch(e){Wz=null}return Wz});var Gz=Li.prototype;Gz.pending=function(){return this._pending},Gz.sanitizeURL=function(e){var t=this;return Pi(t),t._loader.sanitize(e,{context:'href'}).then(function(e){return Mi(t),e}).catch(function(){return Mi(t),null})},Gz.loadImage=function(e){var t=this,n=Ai();return Pi(t),t._loader.sanitize(e,{context:'image'}).then(function(e){var a=e.href;if(!a||!n)throw{url:a};var i=new n;return i.onload=function(){Mi(t),i.loaded=!0},i.onerror=function(){Mi(t),i.loaded=!1},i.src=a,i}).catch(function(n){return Mi(t),{loaded:!1,width:0,height:0,src:n&&n.url||''}})},Gz.ready=function(){var e=this;return new Promise(function(t){function n(a){e.pending()?setTimeout(function(){n(!0)},10):t(a)}n(!1)})};var Yz=aS,pi=2*Yz,Hz=1e-6;Ui.prototype=ji.prototype={constructor:Ui,moveTo:function(e,t){this._+='M'+(this._x0=this._x1=+e)+','+(this._y0=this._y1=+t)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+='Z')},lineTo:function(e,t){this._+='L'+(this._x1=+e)+','+(this._y1=+t)},quadraticCurveTo:function(e,t,n,a){this._+='Q'+ +e+','+ +t+','+(this._x1=+n)+','+(this._y1=+a)},bezierCurveTo:function(e,t,n,a,i,d){this._+='C'+ +e+','+ +t+','+ +n+','+ +a+','+(this._x1=+i)+','+(this._y1=+d)},arcTo:function(e,t,n,a,i){e=+e,t=+t,n=+n,a=+a,i=+i;var d=this._x1,o=this._y1,s=n-e,f=a-t,c=d-e,u=o-t,p=c*c+u*u;// Is the radius negative? Error.
if(0>i)throw new Error('negative radius: '+i);// Is this path empty? Move to (x1,y1).
if(null===this._x1)this._+='M'+(this._x1=e)+','+(this._y1=t);// Or, is (x1,y1) coincident with (x0,y0)? Do nothing.
else if(!(p>Hz));// Or, are (x0,y0), (x1,y1) and (x2,y2) collinear?
// Equivalently, is (x1,y1) coincident with (x2,y2)?
// Or, is the radius zero? Line to (x1,y1).
else if(!(lS(u*s-f*c)>Hz)||!i)this._+='L'+(this._x1=e)+','+(this._y1=t);// Otherwise, draw an arc!
else{var g=n-d,m=a-o,h=s*s+f*f,y=dS(h),b=dS(p),_=i*GE((Yz-tS((h+p-(g*g+m*m))/(2*y*b)))/2),l=_/b,x=_/y;// If the start tangent is not coincident with (x0,y0), line to.
lS(l-1)>Hz&&(this._+='L'+(e+l*c)+','+(t+l*u)),this._+='A'+i+','+i+',0,0,'+ +(u*g>c*m)+','+(this._x1=e+x*s)+','+(this._y1=t+x*f)}},arc:function(e,t,n,a,i,d){e=+e,t=+t,n=+n;var l=n*QE(a),o=n*KE(a),s=e+l,f=t+o,c=1^d,u=d?a-i:i-a;// Is the radius negative? Error.
if(0>n)throw new Error('negative radius: '+n);// Is this path empty? Move to (x0,y0).
null===this._x1?this._+='M'+s+','+f:(lS(this._x1-s)>Hz||lS(this._y1-f)>Hz)&&(this._+='L'+s+','+f);// Is this arc empty? Were done.
n&&(0>u&&(u=u%pi+pi),u>pi-Hz?this._+='A'+n+','+n+',0,1,'+c+','+(e-l)+','+(t-o)+'A'+n+','+n+',0,1,'+c+','+(this._x1=s)+','+(this._y1=f):u>Hz&&(this._+='A'+n+','+n+',0,'+ +(u>=Yz)+','+c+','+(this._x1=e+n*QE(i))+','+(this._y1=t+n*KE(i))));// Does the angle go the wrong way? Flip the direction.
},rect:function(e,t,n,a){this._+='M'+(this._x0=this._x1=+e)+','+(this._y0=this._y1=+t)+'h'+ +n+'v'+ +a+'h'+-n+'Z'},toString:function(){return this._}};var Vz=lS,Xz=JE,Zz=QE,Jz=fS,Qz=iS,Kz=KE,eD=dS,tD=1e-12,nD=aS,aD=nD/2,iD=2*nD;Xi.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;// proceed
default:this._context.lineTo(e,t);}}};var dD={draw:function(e,t){var n=dS(t/nD);e.moveTo(n,0),e.arc(0,0,n,0,iD)}};td.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:ed(this,this._x1,this._y1);// proceed
case 2:this._context.lineTo(this._x1,this._y1);}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);// proceed
default:ed(this,e,t);}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},ad.prototype={areaStart:Ki,areaEnd:Ki,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:ed(this,e,t);}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},rd.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,a=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,a):this._context.moveTo(n,a);break;case 3:this._point=4;// proceed
default:ed(this,e,t);}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},od.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,n=this._y,a=e.length-1;if(0<a)for(var d=e[0],r=n[0],l=e[a]-d,o=n[a]-r,s=-1,f;++s<=a;)f=s/a,this._basis.point(this._beta*e[s]+(1-this._beta)*(d+f*l),this._beta*n[s]+(1-this._beta)*(r+f*o));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};var rD=function e(t){function n(e){return 1===t?new td(e):new od(e,t)}return n.beta=function(t){return e(+t)},n}(.85);fd.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:sd(this,this._x1,this._y1);}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;// proceed
default:sd(this,e,t);}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var lD=function e(t){function n(e){return new fd(e,t)}return n.tension=function(t){return e(+t)},n}(0);cd.prototype={areaStart:Ki,areaEnd:Ki,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:sd(this,e,t);}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var oD=function e(t){function n(e){return new cd(e,t)}return n.tension=function(t){return e(+t)},n}(0);ud.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;// proceed
default:sd(this,e,t);}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var sD=function e(t){function n(e){return new ud(e,t)}return n.tension=function(t){return e(+t)},n}(0);gd.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,a=this._y2-t;this._l23_a=dS(this._l23_2a=pS(n*n+a*a,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;// proceed
default:pd(this,e,t);}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var fD=function e(t){function n(e){return t?new gd(e,t):new fd(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);md.prototype={areaStart:Ki,areaEnd:Ki,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,a=this._y2-t;this._l23_a=dS(this._l23_2a=pS(n*n+a*a,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:pd(this,e,t);}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var cD=function e(t){function n(e){return t?new md(e,t):new cd(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);hd.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,a=this._y2-t;this._l23_a=dS(this._l23_2a=pS(n*n+a*a,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;// proceed
default:pd(this,e,t);}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var uD=function e(t){function n(e){return t?new hd(e,t):new ud(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);yd.prototype={areaStart:Ki,areaEnd:Ki,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}},wd.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:kd(this,this._t0,vd(this,this._t0));}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,e!==this._x1||t!==this._y1){// Ignore coincident points.
switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,kd(this,vd(this,n=xd(this,e,t)),n);break;default:kd(this,this._t0,n=xd(this,e,t));}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}},(Ed.prototype=Object.create(wd.prototype)).point=function(e,t){wd.prototype.point.call(this,t,e)},Sd.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,a,i,d){this._context.bezierCurveTo(t,e,a,n,d,i)}},Dd.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,a=e.length;if(a)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),2===a)this._context.lineTo(e[1],t[1]);else for(var n=Rd(e),i=Rd(t),d=0,r=1;r<a;++d,++r)this._context.bezierCurveTo(n[0][d],i[0][d],n[1][d],i[1][d],e[r],t[r]);(this._line||0!==this._line&&1===a)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}},Od.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&1>this._t&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),0<=this._line&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;// proceed
default:{if(0>=this._t)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};var pD={basis:{curve:nd},"basis-closed":{curve:dd},"basis-open":{curve:ld},bundle:{curve:rD,tension:'beta',value:.85},cardinal:{curve:lD,tension:'tension',value:0},"cardinal-open":{curve:sD,tension:'tension',value:0},"cardinal-closed":{curve:oD,tension:'tension',value:0},"catmull-rom":{curve:fD,tension:'alpha',value:.5},"catmull-rom-closed":{curve:cD,tension:'alpha',value:.5},"catmull-rom-open":{curve:uD,tension:'alpha',value:.5},linear:{curve:Zi},"linear-closed":{curve:bd},monotone:{horizontal:zd,vertical:Cd},natural:{curve:$d},step:{curve:Td},"step-after":{curve:Ld},"step-before":{curve:Ad}},gD={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},mD=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\d)([-+])/g,/\s|,|###/],hD={},yD={},bD=[].join,_D=['l',0,0,0,0,0,0,0],xD=dS(3)/2,vD={circle:{draw:function(e,t){var n=dS(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,2*aS)}},cross:{draw:function(e,t){var n=dS(t)/2,a=n/2.5;e.moveTo(-n,-a),e.lineTo(-n,a),e.lineTo(-a,a),e.lineTo(-a,n),e.lineTo(a,n),e.lineTo(a,a),e.lineTo(n,a),e.lineTo(n,-a),e.lineTo(a,-a),e.lineTo(a,-n),e.lineTo(-a,-n),e.lineTo(-a,-a),e.closePath()}},diamond:{draw:function(e,t){var n=dS(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=dS(t),a=-n/2;e.rect(a,a,n,n)}},"triangle-up":{draw:function(e,t){var n=dS(t)/2,a=xD*n;e.moveTo(0,-a),e.lineTo(-n,a),e.lineTo(n,a),e.closePath()}},"triangle-down":{draw:function(e,t){var n=dS(t)/2,a=xD*n;e.moveTo(0,a),e.lineTo(-n,-a),e.lineTo(n,-a),e.closePath()}},"triangle-right":{draw:function(e,t){var n=dS(t)/2,a=xD*n;e.moveTo(a,0),e.lineTo(-a,-n),e.lineTo(-a,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=dS(t)/2,a=xD*n;e.moveTo(-a,0),e.lineTo(a,-n),e.lineTo(a,n),e.closePath()}}},kD={},wD=aS,SD=function(){function e(){var e=+t.apply(this,arguments),f=+n.apply(this,arguments),c=d.apply(this,arguments)-aD,u=l.apply(this,arguments)-aD,p=Vz(u-c),g=u>c,m,h;// Is it a point?
if(s||(s=m=ji()),f<e&&(h=f,f=e,e=h),!(f>tD))s.moveTo(0,0);// Or is it a circle or annulus?
else if(p>iD-tD)s.moveTo(f*Zz(c),f*Kz(c)),s.arc(0,0,f,c,u,!g),e>tD&&(s.moveTo(e*Zz(u),e*Kz(u)),s.arc(0,0,e,u,c,g));// Or is it a circular or annular sector?
else{var y=c,b=u,_=c,x=u,v=p,k=p,w=o.apply(this,arguments)/2,E=w>tD&&(i?+i.apply(this,arguments):eD(e*e+f*f)),S=Qz(Vz(f-e)/2,+a.apply(this,arguments)),C=S,z=S,D,R;// Apply padding? Note that since r1  r0, da1  da0.
if(E>tD){var $=Ii(E/e*Kz(w)),O=Ii(E/f*Kz(w));(v-=2*$)>tD?($*=g?1:-1,_+=$,x-=$):(v=0,_=x=(c+u)/2),(k-=2*O)>tD?(O*=g?1:-1,y+=O,b-=O):(k=0,y=b=(c+u)/2)}var T=f*Zz(y),A=f*Kz(y),L=e*Zz(x),P=e*Kz(x);// Apply rounded corners?
if(S>tD){var M=f*Zz(b),U=f*Kz(b),j=e*Zz(_),q=e*Kz(_);// Restrict the corner radius according to the sector angle.
if(p<nD){var F=v>tD?Hi(T,A,j,q,M,U,L,P):[L,P],I=T-F[0],N=A-F[1],B=M-F[0],W=U-F[1],G=1/Kz(Fi((I*B+N*W)/(eD(I*I+N*N)*eD(B*B+W*W)))/2),Y=eD(F[0]*F[0]+F[1]*F[1]);C=Qz(S,(e-Y)/(G-1)),z=Qz(S,(f-Y)/(G+1))}}// Is the sector collapsed to a line?
k>tD?z>tD?(D=Vi(j,q,T,A,f,z,g),R=Vi(M,U,L,P,f,z,g),s.moveTo(D.cx+D.x01,D.cy+D.y01),z<S?s.arc(D.cx,D.cy,z,Xz(D.y01,D.x01),Xz(R.y01,R.x01),!g):(s.arc(D.cx,D.cy,z,Xz(D.y01,D.x01),Xz(D.y11,D.x11),!g),s.arc(0,0,f,Xz(D.cy+D.y11,D.cx+D.x11),Xz(R.cy+R.y11,R.cx+R.x11),!g),s.arc(R.cx,R.cy,z,Xz(R.y11,R.x11),Xz(R.y01,R.x01),!g))):(// Or is the outer ring just a circular arc?
s.moveTo(T,A),s.arc(0,0,f,y,b,!g)):s.moveTo(T,A),e>tD&&v>tD?C>tD?(D=Vi(L,P,M,U,e,-C,g),R=Vi(T,A,j,q,e,-C,g),s.lineTo(D.cx+D.x01,D.cy+D.y01),C<S?s.arc(D.cx,D.cy,C,Xz(D.y01,D.x01),Xz(R.y01,R.x01),!g):(s.arc(D.cx,D.cy,C,Xz(D.y01,D.x01),Xz(D.y11,D.x11),!g),s.arc(0,0,e,Xz(D.cy+D.y11,D.cx+D.x11),Xz(R.cy+R.y11,R.cx+R.x11),g),s.arc(R.cx,R.cy,C,Xz(R.y11,R.x11),Xz(R.y01,R.x01),!g))):// Or is the inner ring just a circular arc?
s.arc(0,0,e,x,_,g):s.lineTo(L,P)}return(s.closePath(),m)?(s=null,m+''||null):void 0}var t=Ni,n=Bi,a=qi(0),i=null,d=Wi,l=Gi,o=Yi,s=null;return e.centroid=function(){var e=(+t.apply(this,arguments)+ +n.apply(this,arguments))/2,i=(+d.apply(this,arguments)+ +l.apply(this,arguments))/2-nD/2;return[Zz(i)*e,Kz(i)*e]},e.innerRadius=function(n){return arguments.length?(t='function'==typeof n?n:qi(+n),e):t},e.outerRadius=function(t){return arguments.length?(n='function'==typeof t?t:qi(+t),e):n},e.cornerRadius=function(t){return arguments.length?(a='function'==typeof t?t:qi(+t),e):a},e.padRadius=function(t){return arguments.length?(i=null==t?null:'function'==typeof t?t:qi(+t),e):i},e.startAngle=function(t){return arguments.length?(d='function'==typeof t?t:qi(+t),e):d},e.endAngle=function(t){return arguments.length?(l='function'==typeof t?t:qi(+t),e):l},e.padAngle=function(t){return arguments.length?(o='function'==typeof t?t:qi(+t),e):o},e.context=function(t){return arguments.length?(s=null==t?null:t,e):s},e}().startAngle(function(e){return e.startAngle||0}).endAngle(function(e){return e.endAngle||0}).padAngle(function(e){return e.padAngle||0}).innerRadius(function(e){return e.innerRadius||0}).outerRadius(function(e){return e.outerRadius||0}).cornerRadius(Kd),CD=Qi().x(Jd).y1(Qd).y0(function(e){return(e.y||0)+(e.height||0)}).defined(er),zD=Qi().y(Qd).x1(Jd).x0(function(e){return(e.x||0)+(e.width||0)}).defined(er),DD=y().x(Jd).y(Qd).defined(er),RD=Xd().x(Jd).y(Qd).width(function(e){return e.width||0}).height(function(e){return e.height||0}).cornerRadius(Kd),$D=function(){function e(){var e;if(a||(a=e=ji()),t.apply(this,arguments).draw(a,+n.apply(this,arguments)),e)return a=null,e+''||null}var t=qi(dD),n=qi(64),a=null;return e.type=function(n){return arguments.length?(t='function'==typeof n?n:qi(n),e):t},e.size=function(t){return arguments.length?(n='function'==typeof t?t:qi(+t),e):n},e.context=function(t){return arguments.length?(a=null==t?null:t,e):a},e}().type(nr).size(tr),OD=Zd().x(Jd).y(Qd).defined(er).size(function(e){return e.size||1}),TD=2*aS,AD=TD/4,LD;cr.beginPath=ur,cr.closePath=ur,cr.moveTo=pr,cr.lineTo=pr,cr.rect=function(e,t,n,a){pr(e,t),pr(e+n,t+a)},cr.quadraticCurveTo=function(e,t,n,a){pr(e,t),pr(n,a)},cr.bezierCurveTo=function(e,t,n,a,i,d){pr(e,t),pr(n,a),pr(i,d)},cr.arc=function(e,t,n,a,d,r){function l(e){m=n*QE(e),h=n*KE(e),m<o&&(o=m),m>f&&(f=m),h<c&&(c=h),h>u&&(u=h)}// Sample end points and interior points aligned with 90 degrees
if(lS(d-a)>TD-1e-8)return pr(e-n,t-n),void pr(e+n,t+n);var o=1/0,f=-Infinity,c=1/0,u=-Infinity,p,g,m,h;if(l(a),l(d),d!==a)if(a%=TD,0>a&&(a+=TD),d%=TD,0>d&&(d+=TD),d<a&&(r=!r,p=a,a=d,d=p),r)for(d-=TD,p=a-a%AD,g=0;4>g&&p>d;++g,p-=AD)l(p);else for(p=a-a%AD+AD,g=0;4>g&&p<d;++g,p+=AD)l(p);pr(e+o,t+c),pr(e+f,t+u)};var PD=[],MD=function(){return!0},UD=$r('arc',ar),jD=Or('area',ir,function(e,t){for(var n='horizontal'===e[0].orient?t[1]:t[0],a='horizontal'===e[0].orient?'y':'x',r=e.length,l=+Infinity,o,s;0<=--r;)!1!==e[r].defined&&(s=lS(e[r][a]-n),s<l&&(l=s,o=e[r]));return o}),qD=1,FD=.5,ID=Cr(Lr),ND={type:'image',tag:'image',nested:!1,attr:function(e,t,n){var i=Ur(t,n),d=t.x||0,r=t.y||0,l=(null==t.width?i.width:t.width)||0,o=(null==t.height?i.height:t.height)||0,s=!1===t.aspect?'none':'xMidYMid';d-=jr(t.align,l),r-=qr(t.baseline,o),e('href',i.src||'','http://www.w3.org/1999/xlink','xlink:href'),e('transform',Dr(d,r)),e('width',l),e('height',o),e('preserveAspectRatio',s)},bound:Fr,draw:function(e,t,n){var a=this;xr(t,function(i){if(!n||n.intersects(i.bounds)){// bounds check
var d=Ur(i,a),r=i.x||0,l=i.y||0,o=(null==i.width?d.width:i.width)||0,s=(null==i.height?d.height:i.height)||0,f,c,u,p;r-=jr(i.align,o),l-=qr(i.baseline,s),!1!==i.aspect&&(c=d.width/d.height,u=i.width/i.height,c==c&&u==u&&c!=u&&(u<c?(p=o/c,l+=(s-p)/2,s=p):(p=s*c,r+=(o-p)/2,o=p))),d.loaded&&(e.globalAlpha=null==(f=i.opacity)?1:f,e.drawImage(d,r,l,o,s))}})},pick:Sr(),get:Ur,xOffset:jr,yOffset:qr},BD=Or('line',dr,function(e,n){for(var a=pS(e[0].strokeWidth||1,2),t=e.length,d,r,l;0<=--t;)if(!1!==e[t].defined&&(d=e[t].x-n[0],r=e[t].y-n[1],l=d*d+r*r,l<a))return e[t];return null}),WD={type:'path',tag:'path',nested:!1,attr:function(e,t){e('transform',Rr(t)),e('d',t.path)},bound:Nr,draw:kr(Ir),pick:zr(Ir)},GD={type:'rect',tag:'path',nested:!1,attr:function(e,t){e('d',rr(null,t))},bound:Br,draw:kr(Wr),pick:zr(Wr)},YD={type:'rule',tag:'line',nested:!1,attr:function(e,t){e('transform',Rr(t)),e('x2',null==t.x2?0:t.x2-(t.x||0)),e('y2',null==t.y2?0:t.y2-(t.y||0))},bound:Gr,draw:function(e,t,n){xr(t,function(t){if(!n||n.intersects(t.bounds)){// bounds check
var a=null==t.opacity?1:t.opacity;a&&Yr(e,t,a)&&e.stroke()}})},pick:Sr(Hr)},HD=$r('shape',lr),VD=$r('symbol',or),XD={height:Qr,measureWidth:Zr,estimateWidth:Vr,width:Vr,canvas:Kr},ZD,JD;Kr(!0);var QD={left:'start',center:'middle',right:'end'},KD=new Ei,eR={type:'text',tag:'text',nested:!1,attr:function(e,n){var i=n.dx||0,d=(n.dy||0)+dl(n),l=n.x||0,o=n.y||0,s=n.angle||0,a=n.radius||0,r;a&&(r=(n.theta||0)-aS/2,l+=a*QE(r),o+=a*KE(r)),e('text-anchor',QD[n.align]||'start'),s?(r=Dr(l,o)+' rotate('+s+')',(i||d)&&(r+=' '+Dr(i,d))):r=Dr(l+i,o+d),e('transform',r)},bound:rl,draw:function(e,t,n){xr(t,function(a){var i,d,l,o,s,f;// get text string
(!n||n.intersects(a.bounds))&&// bounds check
(f=tl(a))&&(i=null==a.opacity?1:a.opacity,0===i||(e.font=il(a),e.textAlign=a.align||'left',d=a.x||0,l=a.y||0,(o=a.radius)&&(s=(a.theta||0)-aS/2,d+=o*QE(s),l+=o*KE(s)),a.angle&&(e.save(),e.translate(d,l),e.rotate(a.angle*aS/180),d=l=0),d+=a.dx||0,l+=(a.dy||0)+dl(a),a.fill&&hr(e,a,i)&&e.fillText(f,d,l),a.stroke&&yr(e,a,i)&&e.strokeText(f,d,l),a.angle&&e.restore()))})},pick:Sr(function(e,t,n,i,d,r){if(0>=t.fontSize)return!1;if(!t.angle)return!0;// bounds sufficient if no rotation
// project point into space of unrotated bounds
var l=rl(KD,t,!0),o=-t.angle*aS/180,a=QE(o),s=KE(o),f=t.x,c=t.y;return l.contains(a*d-s*r+(f-f*a+c*s),s*d+a*r+(c-f*s-c*a))})},tR=Or('trail',sr,function(e,t){for(var n=e.length,a,d,r;0<=--n;)if(!1!==e[n].defined&&(a=e[n].x-t[0],d=e[n].y-t[1],r=a*a+d*d,a=e[n].size||1,r<a*a))return e[n];return null}),nR={arc:UD,area:jD,group:{type:'group',tag:'g',nested:!1,attr:function(e,t){e('transform',Rr(t))},bound:Ar,draw:function(e,t,n){var a=this;xr(t,function(t){var i=t.x||0,d=t.y||0,r=t.width||0,l=t.height||0,o;// setup graphics context
// draw group contents
e.save(),e.translate(i,d),(t.stroke||t.fill)&&(o=null==t.opacity?1:t.opacity,0<o&&(Lr(e,t),t.fill&&hr(e,t,o)&&e.fill(),t.stroke&&yr(e,t,o)&&e.stroke())),t.clip&&(e.beginPath(),e.rect(0,0,r,l),e.clip()),n&&n.translate(-i,-d),xr(t,function(t){a.draw(e,t,n)}),n&&n.translate(i,d),e.restore()})},pick:Pr,background:function(e,t){var n=t.stroke?FD:0;e('class','background'),e('d',rr(null,t,n,n))},foreground:function(e,t,n){var a=t.clip?Tr(n,t,t):null;e('clip-path',a)}},image:ND,line:BD,path:WD,rect:GD,rule:YD,shape:HD,symbol:VD,text:eR,trail:tR},aR={mark:null},iR=['marktype','name','role','interactive','clip','items','zindex','x','y','width','height','align','baseline',// layout
'fill','fillOpacity','opacity',// fill
'stroke','strokeOpacity','strokeWidth','strokeCap',// stroke
'strokeDash','strokeDashOffset',// stroke dash
'startAngle','endAngle','innerRadius','outerRadius',// arc
'cornerRadius','padAngle',// arc, rect
'interpolate','tension','orient','defined',// area, line
'url',// image
'path',// path
'x2','y2',// rule
'size','shape',// symbol
'text','angle','theta','radius','dx','dy',// text
'font','fontSize','fontWeight','fontStyle','fontVariant'// font
],dR=ul.prototype;dR.toJSON=function(e){return sl(this.root,e||0)},dR.mark=function(e,t,n){t=t||this.root.items[0];var a=pl(e,t);return t.items[n]=a,a.zindex&&(a.group.zdirty=!0),a};var rR=vl.prototype;/**
   * Initialize a new Handler instance.
   * @param {DOMElement} el - The containing DOM element for the display.
   * @param {Array<number>} origin - The origin of the display, in pixels.
   *   The coordinate system will be translated to this point.
   * @param {object} [obj] - Optional context object that should serve as
   *   the "this" context for event callbacks.
   * @return {Handler} - This handler instance.
   */rR.initialize=function(e,t,n){return this._el=e,this._obj=n||null,this.origin(t)},rR.element=function(){return this._el},rR.canvas=function(){return this._el&&this._el.firstChild},rR.origin=function(e){return arguments.length?(this._origin=e||[0,0],this):this._origin.slice()},rR.scene=function(e){return arguments.length?(this._scene=e,this):this._scene},rR.on=function()/*type, handler*/{},rR.off=function()/*type, handler*/{},rR._handlerIndex=function(e,t,n){for(var a=e?e.length:0;0<=--a;)if(e[a].type===t&&(!n||e[a].handler===n))return a;return-1},rR.handlers=function(e){var t=this._handlers,n=[],a;if(e)n.push.apply(n,t[this.eventName(e)]);else for(a in t)n.push.apply(n,t[a]);return n},rR.eventName=function(e){var t=e.indexOf('.');return 0>t?e:e.slice(0,t)},rR.handleHref=function(t,n,a){this._loader.sanitize(a,{context:'href'}).then(function(n){var i=new MouseEvent(t.type,t),e=gl(null,'a');for(var a in n)e.setAttribute(a,n[a]);e.dispatchEvent(i)}).catch(function(){/* do nothing */})},rR.handleTooltip=function(e,t,n){if(t&&null!=t.tooltip){t=xl(t,e,this.canvas(),this._origin);var a=n&&t&&t.tooltip||null;this._tooltip.call(this._obj,this,e,t,a)}},rR.getItemBoundingClientRect=function(e){if(o=this.canvas()){// translate coordinate for each parent group
for(var t=o.getBoundingClientRect(),n=this._origin,a=e.bounds,i=a.x1+n[0]+t.left,d=a.y1+n[1]+t.top,r=a.width(),l=a.height(),o;e.mark&&(e=e.mark.group);)i+=e.x||0,d+=e.y||0;// return DOMRect-compatible bounding box
return{x:i,y:d,width:r,height:l,left:i,top:d,right:i+r,bottom:d+l}}};var lR=wl.prototype;/**
   * Initialize a new Renderer instance.
   * @param {DOMElement} el - The containing DOM element for the display.
   * @param {number} width - The coordinate width of the display, in pixels.
   * @param {number} height - The coordinate height of the display, in pixels.
   * @param {Array<number>} origin - The origin of the display, in pixels.
   *   The coordinate system will be translated to this point.
   * @param {number} [scaleFactor=1] - Optional scaleFactor by which to multiply
   *   the width and height to determine the final pixel size.
   * @return {Renderer} - This renderer instance.
   */lR.initialize=function(e,t,n,a,i){return this._el=e,this.resize(t,n,a,i)},lR.element=function(){return this._el},lR.canvas=function(){return this._el&&this._el.firstChild},lR.background=function(e){return 0===arguments.length?this._bgcolor:(this._bgcolor=e,this)},lR.resize=function(e,t,n,a){return this._width=e,this._height=t,this._origin=n||[0,0],this._scale=a||1,this},lR.dirty=function()/*item*/{},lR.render=function(e){var t=this;// bind arguments into a render call, and cache it
// this function may be subsequently called for async redraw
return t._call=function(){t._render(e)},t._call(),t._call=null,t},lR._render=function()/*scene*/{// subclasses to override
},lR.renderAsync=function(e){var t=this.render(e);return this._ready?this._ready.then(function(){return t}):Promise.resolve(t)},lR._load=function(e,t){var n=this,a=n._loader[e](t);if(!n._ready){// re-render the scene when loading completes
var i=n._call;n._ready=n._loader.ready().then(function(e){e&&i(),n._ready=null})}return a},lR.sanitizeURL=function(e){return this._load('sanitizeURL',e)},lR.loadImage=function(e){return this._load('loadImage',e)};var oR=W(El,vl);oR.initialize=function(e,t,n){// add event listeners
var a=this._canvas=e&&ml(e,'canvas');if(a){var i=this;this.events.forEach(function(e){a.addEventListener(e,function(t){oR[e]?oR[e].call(i,t):i.fire(e,t)})})}return vl.prototype.initialize.call(this,e,t,n)},oR.canvas=function(){return this._canvas},oR.context=function(){return this._canvas.getContext('2d')},oR.events=['keydown','keypress','keyup','dragenter','dragleave','dragover','mousedown','mouseup','mousemove','mouseout','mouseover','click','dblclick','wheel','mousewheel','touchstart','touchmove','touchend'],oR.DOMMouseScroll=function(e){this.fire('mousewheel',e)},oR.mousemove=Sl('mousemove','mouseover','mouseout'),oR.dragover=Sl('dragover','dragenter','dragleave'),oR.mouseout=Cl('mouseout'),oR.dragleave=Cl('dragleave'),oR.mousedown=function(e){this._down=this._active,this.fire('mousedown',e)},oR.click=function(e){this._down===this._active&&(this.fire('click',e),this._down=null)},oR.touchstart=function(e){this._touch=this.pickEvent(e.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire('touchstart',e,!0)},oR.touchmove=function(e){this.fire('touchmove',e,!0)},oR.touchend=function(e){this.fire('touchend',e,!0),this._touch=null},oR.fire=function(e,t,n){var d=n?this._touch:this._active,a=this._handlers[e],r,l;// set event type relative to scenegraph items
// invoke all registered handlers
if(t.vegaType=e,'click'===e&&d&&d.href?this.handleHref(t,d,d.href):('mousemove'==e||'mouseout'==e)&&this.handleTooltip(t,d,'mouseout'!=e),a)for(r=0,l=a.length;r<l;++r)a[r].handler.call(this._obj,t,d)},oR.on=function(e,t){var n=this.eventName(e),a=this._handlers,d=this._handlerIndex(a[n],e,t);return 0>d&&(a[n]||(a[n]=[])).push({type:e,handler:t}),this},oR.off=function(e,t){var n=this.eventName(e),a=this._handlers[n],d=this._handlerIndex(a,e,t);return 0<=d&&a.splice(d,1),this},oR.pickEvent=function(e){var t=_l(e,this._canvas),n=this._origin;return this.pick(this._scene,t[0],t[1],t[0]-n[0],t[1]-n[1])},oR.pick=function(e,t,n,a,i){var d=this.context(),r=nR[e.marktype];return r.pick.call(this,d,e,t,n,a,i)};var sR=function(){return'undefined'==typeof window?1:window.devicePixelRatio||1}(),fR=W(Rl,wl),cR=wl.prototype,uR=new Ei;fR.initialize=function(e,t,n,a,i){// this method will invoke resize to size the canvas appropriately
return this._canvas=Ti(1,1),e&&(yl(e,0).appendChild(this._canvas),this._canvas.setAttribute('class','marks')),cR.initialize.call(this,e,t,n,a,i)},fR.resize=function(e,t,n,a){return cR.resize.call(this,e,t,n,a),Dl(this._canvas,this._width,this._height,this._origin,this._scale),this._redraw=!0,this},fR.canvas=function(){return this._canvas},fR.context=function(){return this._canvas?this._canvas.getContext('2d'):null},fR.dirty=function(e){var t=Ol(e.bounds,e.mark.group);this._dirty.union(t)},fR._render=function(e){var t=this.context(),n=this._origin,a=this._width,i=this._height,d=this._dirty;// setup
return t.save(),this._redraw||d.empty()?(this._redraw=!1,d=null):d=$l(t,d,n),this.clear(-n[0],-n[1],a,i),this.draw(t,e,d),t.restore(),this._dirty.clear(),this},fR.draw=function(e,t,n){var a=nR[t.marktype];t.clip&&zl(e,t),a.draw.call(this,e,t,n),t.clip&&e.restore()},fR.clear=function(e,t,n,a){var i=this.context();i.clearRect(e,t,n,a),null!=this._bgcolor&&(i.fillStyle=this._bgcolor,i.fillRect(e,t,n,a))};var pR=W(Tl,vl);pR.initialize=function(e,t,n){var a=this._svg;return a&&(a.removeEventListener('click',this._hrefHandler),a.removeEventListener('mousemove',this._tooltipHandler),a.removeEventListener('mouseout',this._tooltipHandler)),this._svg=a=e&&ml(e,'svg'),a&&(a.addEventListener('click',this._hrefHandler),a.addEventListener('mousemove',this._tooltipHandler),a.addEventListener('mouseout',this._tooltipHandler)),vl.prototype.initialize.call(this,e,t,n)},pR.canvas=function(){return this._svg},pR.on=function(e,t){var n=this.eventName(e),a=this._handlers,d=this._handlerIndex(a[n],e,t);if(0>d){var i={type:e,handler:t,listener:Al(this,t)};(a[n]||(a[n]=[])).push(i),this._svg&&this._svg.addEventListener(n,i.listener)}return this},pR.off=function(e,t){var n=this.eventName(e),a=this._handlers[n],d=this._handlerIndex(a,e,t);return 0<=d&&(this._svg&&this._svg.removeEventListener(n,a[d].listener),a.splice(d,1)),this};var gR={version:'1.1',xmlns:'http://www.w3.org/2000/svg',"xmlns:xlink":'http://www.w3.org/1999/xlink'},mR={fill:'fill',fillOpacity:'fill-opacity',stroke:'stroke',strokeOpacity:'stroke-opacity',strokeWidth:'stroke-width',strokeCap:'stroke-linecap',strokeJoin:'stroke-linejoin',strokeDash:'stroke-dasharray',strokeDashOffset:'stroke-dashoffset',strokeMiterLimit:'stroke-miterlimit',opacity:'opacity'},hR=Object.keys(mR),yR=gR.xmlns,ns=W(Ml,wl),bR=wl.prototype;ns.initialize=function(e,t,n,a){return e&&(this._svg=hl(e,0,'svg',yR),this._svg.setAttribute('class','marks'),yl(e,1),this._root=hl(this._svg,0,'g',yR),yl(this._svg,1)),this._defs={gradient:{},clipping:{}},this.background(this._bgcolor),bR.initialize.call(this,e,t,n,a)},ns.background=function(e){return arguments.length&&this._svg&&this._svg.style.setProperty('background-color',e),bR.background.apply(this,arguments)},ns.resize=function(e,t,n,a){return bR.resize.call(this,e,t,n,a),this._svg&&(this._svg.setAttribute('width',this._width*this._scale),this._svg.setAttribute('height',this._height*this._scale),this._svg.setAttribute('viewBox','0 0 '+this._width+' '+this._height),this._root.setAttribute('transform','translate('+this._origin+')')),this._dirty=[],this},ns.canvas=function(){return this._svg},ns.svg=function(){if(!this._svg)return null;var e={class:'marks',width:this._width*this._scale,height:this._height*this._scale,viewBox:'0 0 '+this._width+' '+this._height};for(var t in gR)e[t]=gR[t];var n=this._bgcolor?Ll('rect',{width:this._width,height:this._height,style:'fill: '+this._bgcolor+';'})+Pl('rect'):'';return Ll('svg',e)+n+this._svg.innerHTML+Pl('svg')},ns._render=function(e){return this._dirtyCheck()&&(this._dirtyAll&&this._resetDefs(),this.draw(this._root,e),yl(this._root,1)),this.updateDefs(),this._dirty=[],++this._dirtyID,this},ns.updateDefs=function(){var e=this._svg,t=this._defs,n=t.el,a=0,i;for(i in t.gradient)n||(t.el=n=hl(e,0,'defs',yR)),Ul(n,t.gradient[i],a++);for(i in t.clipping)n||(t.el=n=hl(e,0,'defs',yR)),jl(n,t.clipping[i],a++);// clean-up
n&&(0==a?(e.removeChild(n),t.el=null):yl(n,a))},ns._resetDefs=function(){var e=this._defs;e.gradient={},e.clipping={}},ns.dirty=function(e){e.dirty!==this._dirtyID&&(e.dirty=this._dirtyID,this._dirty.push(e))},ns.isDirty=function(e){return this._dirtyAll||!e._svg||e.dirty===this._dirtyID},ns._dirtyCheck=function(){this._dirtyAll=!0;var e=this._dirty;if(!e.length)return!0;var t=++this._dirtyID,a,d,r,l,s,f,c;for(s=0,f=e.length;s<f;++s)// already visited
if(a=e[s],d=a.mark,d.marktype!==r&&(r=d.marktype,l=nR[r]),d.zdirty&&d.dirty!==t&&(this._dirtyAll=!1,ql(a,t),d.items.forEach(function(e){e.dirty=t})),!d.zdirty){// handle in standard drawing pass
if(a.exit){l.nested&&d.items.length?(c=d.items[0],c._svg&&this._update(l,c._svg,c)):a._svg&&(c=a._svg.parentNode,c&&c.removeChild(a._svg)),a._svg=null;continue}a=l.nested?d.items[0]:a,a._update===t||(a._svg&&a._svg.ownerSVGElement?this._update(l,a._svg,a):(this._dirtyAll=!1,ql(a,t)),a._update=t)}return!this._dirtyAll},ns.draw=function(e,t,n){function a(e){var t=d.isDirty(e),n=Il(e,u,f,l.tag,r);t&&(d._update(l,n,e),s&&Fl(d,n,e)),f=n,++c}if(!this.isDirty(t))return t._svg;var d=this,r=this._svg,l=nR[t.marktype],o=!1===t.interactive?'none':null,s='g'===l.tag,f=null,c=0,u;return u=Il(t,e,n,'g',r),u.setAttribute('class',bl(t)),s||u.style.setProperty('pointer-events',o),t.clip?u.setAttribute('clip-path',Tr(d,t,t.group)):u.removeAttribute('clip-path'),l.nested?t.items.length&&a(t.items[0]):xr(t,a),yl(u,c),u};var _R=null,// temp var for current SVG element
xR=null,vR={group:function(e,t,n){xR=t.__values__,_R=t.childNodes[1],e.foreground(Wl,n,this),_R=t.childNodes[0],e.background(Wl,n,this);var a=!1===n.mark.interactive?'none':null;a!==xR.events&&(_R.style.setProperty('pointer-events',a),xR.events=a)},text:function(e,t,n){var a;a=tl(n),a!==xR.text&&(t.textContent=a,xR.text=a),Bl(t,'font-family',al(n)),Bl(t,'font-size',Qr(n)+'px'),Bl(t,'font-style',n.fontStyle),Bl(t,'font-variant',n.fontVariant),Bl(t,'font-weight',n.fontWeight)}};// temp var for current values hash
// Extra configuration for certain mark types
ns._update=function(e,t,n){_R=t,xR=t.__values__,e.attr(Wl,n,this);// some marks need special treatment
var a=vR[e.type];// apply svg css styles
// note: element may be modified by 'extra' method
a&&a.call(this,e,t,n),this.style(_R,n)},ns.style=function(e,t){if(null!=t){var a,d,r,l,o;for(a=0,d=hR.length;a<d;++a)r=hR[a],o=t[r],'font'===r&&(o=al(t)),o===xR[r]||(l=mR[r],null==o?'fill'===l?e.style.setProperty(l,'none'):e.style.removeProperty(l):(o.id&&(this._defs.gradient[o.id]=o,o='url('+Gl()+'#'+o.id+')'),e.style.setProperty(l,o+'')),xR[r]=o)}};var kR=W(Yl,wl),wR=wl.prototype;kR.resize=function(e,n,a,i){wR.resize.call(this,e,n,a,i);var d=this._origin,r=this._text,t={class:'marks',width:this._width*this._scale,height:this._height*this._scale,viewBox:'0 0 '+this._width+' '+this._height};for(var l in gR)t[l]=gR[l];r.head=Ll('svg',t);var o=this._bgcolor;return('transparent'===o||'none'===o)&&(o=null),r.bg=o?Ll('rect',{width:this._width,height:this._height,style:'fill: '+o+';'})+Pl('rect'):'',r.root=Ll('g',{transform:'translate('+d+')'}),r.foot=Pl('g')+Pl('svg'),this},kR.background=function(){var e=wR.background.apply(this,arguments);return arguments.length&&this._text.head&&this.resize(this._width,this._height,this._origin,this._scale),e},kR.svg=function(){var e=this._text;return e.head+e.bg+e.defs+e.root+e.body+e.foot},kR._render=function(e){return this._text.body=this.mark(e),this._text.defs=this.buildDefs(),this},kR.buildDefs=function(){var e=this._defs,t='',n,a,d,r;for(a in e.gradient){for(d=e.gradient[a],r=d.stops,t+=Ll('linearGradient',{id:a,x1:d.x1,x2:d.x2,y1:d.y1,y2:d.y2}),n=0;n<r.length;++n)t+=Ll('stop',{offset:r[n].offset,"stop-color":r[n].color})+Pl('stop');t+=Pl('linearGradient')}for(a in e.clipping)d=e.clipping[a],t+=Ll('clipPath',{id:a}),t+=d.path?Ll('path',{d:d.path})+Pl('path'):Ll('rect',{x:0,y:0,width:d.width,height:d.height})+Pl('rect'),t+=Pl('clipPath');return 0<t.length?Ll('defs')+t+Pl('defs'):''};var ER;kR.attributes=function(e,t){return ER={},e(Hl,t,this),ER},kR.href=function(e){var t=this,n=e.href,a;if(n){if(a=t._hrefs&&t._hrefs[n])return a;t.sanitizeURL(n).then(function(e){e['xlink:href']=e.href,e.href=null,(t._hrefs||(t._hrefs={}))[n]=e})}return null},kR.mark=function(e){// render contained elements
function t(t){var o=n.href(t);o&&(r+=Ll('a',o)),l='g'===i?null:Vl(t,e,i,d),r+=Ll(i,n.attributes(a.attr,t),l),'text'===i?r+=Xl(tl(t)):'g'===i&&(r+=Ll('path',n.attributes(a.background,t),Vl(t,e,'bgrect',d))+Pl('path'),r+=Ll('g',n.attributes(a.foreground,t))+n.markGroup(t)+Pl('g')),r+=Pl(i),o&&(r+=Pl('a'))}var n=this,a=nR[e.marktype],i=a.tag,d=this._defs,r='',l;// render closing group tag
return'g'!==i&&!1===e.interactive&&(l='style="pointer-events: none;"'),r+=Ll('g',{class:bl(e),"clip-path":e.clip?Tr(n,e,e.group):null},l),a.nested?e.items&&e.items.length&&t(e.items[0]):xr(e,t),r+Pl('g')},kR.markGroup=function(e){var t=this,n='';return xr(e,function(e){n+=t.mark(e)}),n};var SR={Canvas:'canvas',PNG:'png',SVG:'svg',None:'none'},CR={};CR.canvas=CR.png={renderer:Rl,headless:Rl,handler:El},CR.svg={renderer:Ml,headless:Yl,handler:Tl},CR.none={};var zR=new Ei,DR=1e-9,RR=W(to,Dn);RR.transform=function(e,t){var n=t.dataflow,a=e.mark,i=a.marktype,d=nR[i],r=d.bound,l=a.bounds,o;return d.nested?(a.items.length&&n.dirty(a.items[0]),l=no(a,r),a.items.forEach(function(e){e.bounds.clear().union(l)})):'group'===i||e.modified()?(t.visit(t.MOD,function(e){n.dirty(e)}),l.clear(),a.items.forEach(function(e){l.union(no(e,r))}),'legend'===a.role&&t.reflow()):(o=t.changed(t.REM),t.visit(t.ADD,function(e){l.union(no(e,r))}),t.visit(t.MOD,function(e){o=o||l.alignsWith(e.bounds),n.dirty(e),l.union(no(e,r))}),o&&(l.clear(),a.items.forEach(function(e){l.union(e.bounds)}))),Jl(a),t.modifies('bounds')};ao.Definition={type:'Identifier',metadata:{modifies:!0},params:[{name:'as',type:'string',required:!0}]};var $R=W(ao,Dn);$R.transform=function(e,t){var n=io(t.dataflow),a=n.value,i=e.as;return t.visit(t.ADD,function(e){e[i]||(e[i]=++a)}),n.set(this.value=a),t};var OR=W(ro,Dn);OR.transform=function(e,t){var n=this.value;// acquire mark on first invocation, bind context and group
n||(n=t.dataflow.scenegraph().mark(e.markdef,lo(e),e.index),n.group.context=e.context,!e.context.group&&(e.context.group=n.group),n.source=this,n.clip=e.clip,n.interactive=e.interactive,this.value=n);// initialize entering items
var a='group'===n.marktype?zi:Ci;return t.visit(t.ADD,function(e){a.call(e,n)}),(e.modified('clip')||e.modified('interactive'))&&(n.clip=e.clip,n.interactive=!!e.interactive,n.zdirty=!0,t.reflow()),n.items=t.source,t};var TR=W(oo,Dn),AR={parity:function(e){return e.filter(function(e,t){return t%2?e.opacity=0:1})},greedy:function(e){var t;return e.filter(function(e,n){return n&&so(t.bounds,e.bounds)?e.opacity=0:(t=e,1)})}};TR.transform=function(e,t){var n=AR[e.method]||AR.parity,a=t.materialize(t.SOURCE).source,i,d;if(a){if(!e.method)return e.modified('method')&&(po(a),t=go(t,e)),t;if(e.sort&&(a=a.slice().sort(e.sort)),'greedy'===e.method&&(a=a.filter(co)),i=po(a),t=go(t,e),3<=i.length&&fo(i)){do i=n(i);while(3<=i.length&&fo(i));3>i.length&&!f(a).opacity&&(1<i.length&&(f(i).opacity=0),f(a).opacity=1)}return e.boundScale&&0<=e.boundTolerance&&(d=uo(e.boundScale,e.boundOrient,+e.boundTolerance),a.forEach(function(e){d(e)||(e.opacity=0)})),t}};var LR=W(mo,Dn);LR.transform=function(e,t){var n=t.dataflow;// set z-index dirty flag as needed
if(t.visit(t.ALL,function(e){n.dirty(e)}),t.fields&&t.fields.zindex){var a=t.source&&t.source[0];a&&(a.mark.zdirty=!0)}};var PR=.5,MR=new Ei,UR=W(zo,Dn);UR.transform=function(e,t){// TODO incremental update, output?
var n=t.dataflow;return e.mark.items.forEach(function(t){e.layout&&Eo(n,t,e.layout),Do(n,t,e)}),e.modified()&&t.reflow(),t};var jR=/*#__PURE__*/Object.freeze({bound:to,identifier:ao,mark:ro,overlap:oo,render:mo,viewlayout:zo}),qR=Wo(Bo),FR=qR.right,IR=dS(50),NR=dS(10),BR=dS(2);Jo.prototype=Qo.prototype={constructor:Jo,has:function(e){return'$'+e in this},get:function(e){return this['$'+e]},set:function(e,t){return this['$'+e]=t,this},remove:function(e){var t='$'+e;return t in this&&delete this[t]},clear:function(){for(var e in this)'$'===e[0]&&delete this[e]},keys:function(){var e=[];for(var t in this)'$'===t[0]&&e.push(t.slice(1));return e},values:function(){var e=[];for(var t in this)'$'===t[0]&&e.push(this[t]);return e},entries:function(){var e=[];for(var t in this)'$'===t[0]&&e.push({key:t.slice(1),value:this[t]});return e},size:function(){var e=0;for(var t in this)'$'===t[0]&&++e;return e},empty:function(){for(var e in this)if(e[0]==='$')return!1;return!0},each:function(e){for(var t in this)'$'===t[0]&&e(this[t],t.slice(1),this)}};var WR=Qo.prototype;ds.prototype=function(e,t){var a=new ds;// Copy constructor.
if(e instanceof ds)e.each(function(e){a.add(e)});// Otherwise, assume its an array.
else if(e){var d=-1,r=e.length;if(null==t)for(;++d<r;)a.add(e[d]);else for(;++d<r;)a.add(t(e[d],d,e))}return a}.prototype={constructor:ds,has:WR.has,add:function(e){return e+='',this['$'+e]=e,this},remove:WR.remove,clear:WR.clear,values:WR.keys,size:WR.size,empty:WR.empty,each:WR.each};var GR=Array.prototype,YR=GR.map,HR=GR.slice,VR={name:'implicit'},XR=.7,ZR=1/XR,JR=/^#([0-9a-f]{3})$/,QR=/^#([0-9a-f]{6})$/,KR=/^rgb\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*\)$/,e$=/^rgb\(\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*\)$/,t$=/^rgba\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)\s*\)$/,n$=/^rgba\(\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)\s*\)$/,a$=/^hsl\(\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*\)$/,i$=/^hsla\(\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)\s*\)$/,d$={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};ls(ss,fs,{displayable:function(){return this.rgb().displayable()},hex:function(){return this.rgb().hex()},toString:function(){return this.rgb()+''}}),ls(ms,gs,os(ss,{brighter:function(e){return e=null==e?ZR:pS(ZR,e),new ms(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?XR:pS(XR,e),new ms(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return 0<=this.r&&255>=this.r&&0<=this.g&&255>=this.g&&0<=this.b&&255>=this.b&&0<=this.opacity&&1>=this.opacity},hex:function(){return'#'+hs(this.r)+hs(this.g)+hs(this.b)},toString:function(){var e=this.opacity;return e=isNaN(e)?1:fS(0,iS(1,e)),(1===e?'rgb(':'rgba(')+fS(0,iS(255,oS(this.r)||0))+', '+fS(0,iS(255,oS(this.g)||0))+', '+fS(0,iS(255,oS(this.b)||0))+(1===e?')':', '+e+')')}})),ls(xs,_s,os(ss,{brighter:function(e){return e=null==e?ZR:pS(ZR,e),new xs(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?XR:pS(XR,e),new xs(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(0>this.h),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,a=n+(.5>n?n:1-n)*t,i=2*n-a;return new ms(vs(240<=e?e-240:e+120,i,a),vs(e,i,a),vs(120>e?e+240:e-120,i,a),this.opacity)},displayable:function(){return(0<=this.s&&1>=this.s||isNaN(this.s))&&0<=this.l&&1>=this.l&&0<=this.opacity&&1>=this.opacity}}));var r$=aS/180,l$=180/aS,o$=.96422,Xn=.82521,Zn=4/29,s$=6/29,f$=3*s$*s$,c$=s$*s$*s$;// https://beta.observablehq.com/@mbostock/lab-and-rgb
ls(Es,ws,os(ss,{brighter:function(e){return new Es(this.l+18*(null==e?1:e),this.a,this.b,this.opacity)},darker:function(e){return new Es(this.l-18*(null==e?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=o$*Cs(t),e=1*Cs(e),n=Xn*Cs(n),new ms(zs(3.1338561*t-1.6168667*e-.4906146*n),zs(-.9787684*t+1.9161415*e+.033454*n),zs(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}})),ls(Os,$s,os(ss,{brighter:function(e){return new Os(this.h,this.c,this.l+18*(null==e?1:e),this.opacity)},darker:function(e){return new Os(this.h,this.c,this.l-18*(null==e?1:e),this.opacity)},rgb:function(){return ks(this).rgb()}}));var u$=-.14861,A=+1.78277,B=-.29227,C=-.90649,D=+1.97294,E=D*C,ED=D*A,p$=A*B-C*u$;ls(Ls,As,os(ss,{brighter:function(e){return e=null==e?ZR:pS(ZR,e),new Ls(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?XR:pS(XR,e),new Ls(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*r$,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),a=QE(e),i=KE(e);return new ms(255*(t+n*(u$*a+A*i)),255*(t+n*(B*a+C*i)),255*(t+n*(D*a)),this.opacity)}}));var g$=function e(t){function n(e,t){var n=a((e=gs(e)).r,(t=gs(t)).r),i=a(e.g,t.g),d=a(e.b,t.b),r=Bs(e.opacity,t.opacity);return function(a){return e.r=n(a),e.g=i(a),e.b=d(a),e.opacity=r(a),e+''}}var a=Ns(t);return n.gamma=e,n}(1),m$=Ws(Ms),h$=Ws(Us),y$=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,b$=new RegExp(y$.source,'g'),_$=180/aS,x$={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},v$=af(tf,'px, ','px)','deg)'),k$=af(nf,', ',')',')'),w$=nS,E$=1e-12,S$=sf(Is),C$=sf(Bs),z$=ff(Is),D$=ff(Bs),R$=cf(Is),$$=cf(Bs),O$=/*#__PURE__*/Object.freeze({interpolate:Qs,interpolateArray:Gs,interpolateBasis:Ms,interpolateBasisClosed:Us,interpolateDate:Ys,interpolateDiscrete:function(e){var a=e.length;return function(n){return e[fS(0,iS(a-1,sS(n*a)))]}},interpolateHue:function(e,t){var n=Is(+e,+t);return function(e){var t=n(e);return t-360*sS(t/360)}},interpolateNumber:Hs,interpolateObject:Vs,interpolateRound:Ks,interpolateString:Js,interpolateTransformCss:v$,interpolateTransformSvg:k$,interpolateZoom:of,interpolateRgb:g$,interpolateRgbBasis:m$,interpolateRgbBasisClosed:h$,interpolateHsl:S$,interpolateHslLong:C$,interpolateLab:function(e,t){var n=Bs((e=ws(e)).l,(t=ws(t)).l),i=Bs(e.a,t.a),a=Bs(e.b,t.b),d=Bs(e.opacity,t.opacity);return function(r){return e.l=n(r),e.a=i(r),e.b=a(r),e.opacity=d(r),e+''}},interpolateHcl:z$,interpolateHclLong:D$,interpolateCubehelix:R$,interpolateCubehelixLong:$$,piecewise:uf,quantize:function(e,t){for(var n=Array(t),a=0;a<t;++a)n[a]=e(a/(t-1));return n}}),T$=[0,1],A$=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i,re,L$,P$,M$;zf.prototype=Df.prototype,Df.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?'0':'')+(null==this.width?'':fS(1,0|this.width))+(this.comma?',':'')+(null==this.precision?'':'.'+fS(0,0|this.precision))+(this.trim?'~':'')+this.type};var U$={"%":function(e,t){return(100*e).toFixed(t)},b:function(e){return oS(e).toString(2)},c:function(e){return e+''},d:function(e){return oS(e).toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return oS(e).toString(8)},p:function(e,t){return $f(100*e,t)},r:$f,s:function(e,t){var a=wf(e,t);if(!a)return e+'';var d=a[0],r=a[1],l=r-(q$=3*fS(-8,iS(8,sS(r/3))))+1,i=d.length;return l===i?d:l>i?d+Array(l-i+1).join('0'):0<l?d.slice(0,l)+'.'+d.slice(l):'0.'+Array(1-l).join('0')+wf(e,fS(0,t+l-1))[0];// less than 1y!
},X:function(e){return oS(e).toString(16).toUpperCase()},x:function(e){return oS(e).toString(16)}},j$=['y','z','a','f','p','n','\xB5','m','','k','M','G','T','P','E','Z','Y'],q$,F$,I$,N$;Af({decimal:'.',thousands:',',grouping:[3],currency:['$','']});var B$=Array.prototype.map,W$=Array.prototype.slice,G$={// base scale types
identity:Ff,linear:qf,log:Vf,ordinal:rs,pow:Zf,sqrt:function(){return Zf().exponent(.5)},quantile:Jf,quantize:Qf,threshold:Kf,time:ac,utc:ic,// extended scale types
band:dc,point:function(){return rc(dc().paddingInner(1))},sequential:fc,"bin-linear":oc,"bin-ordinal":sc};for(var Y$ in G$)uc(Y$,G$[Y$]);var H$=bc('1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5'),V$=bc('393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6'),X$=bc('3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9'),Z$=bc('4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac'),J$=bc('4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5'),Q$=[,,,].concat('67a9cff7f7f7f1a340','0571b092c5defdb863e66101','0571b092c5def7f7f7fdb863e66101','2166ac67a9cfd1e5f0fee0b6f1a340b35806','2166ac67a9cfd1e5f0f7f7f7fee0b6f1a340b35806','2166ac4393c392c5ded1e5f0fee0b6fdb863e08214b35806','2166ac4393c392c5ded1e5f0f7f7f7fee0b6fdb863e08214b35806','0530612166ac4393c392c5ded1e5f0fee0b6fdb863e08214b358067f3b08','0530612166ac4393c392c5ded1e5f0f7f7f7fee0b6fdb863e08214b358067f3b08').map(bc),K$=_c('1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf'),eO=_c('7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666'),tO=_c('1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666'),nO=_c('a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928'),aO=_c('fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2'),iO=_c('b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc'),dO=_c('e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999'),rO=_c('66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3'),lO=_c('8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f'),oO=[,,,].concat('d8b365f5f5f55ab4ac','a6611adfc27d80cdc1018571','a6611adfc27df5f5f580cdc1018571','8c510ad8b365f6e8c3c7eae55ab4ac01665e','8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e','8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e','8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e','5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30','5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30').map(_c),sO=xc(oO),fO=[,,,].concat('af8dc3f7f7f77fbf7b','7b3294c2a5cfa6dba0008837','7b3294c2a5cff7f7f7a6dba0008837','762a83af8dc3e7d4e8d9f0d37fbf7b1b7837','762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837','762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837','762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837','40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b','40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b').map(_c),cO=xc(fO),uO=[,,,].concat('e9a3c9f7f7f7a1d76a','d01c8bf1b6dab8e1864dac26','d01c8bf1b6daf7f7f7b8e1864dac26','c51b7de9a3c9fde0efe6f5d0a1d76a4d9221','c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221','c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221','c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221','8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419','8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419').map(_c),pO=xc(uO),gO=[,,,].concat('998ec3f7f7f7f1a340','5e3c99b2abd2fdb863e66101','5e3c99b2abd2f7f7f7fdb863e66101','542788998ec3d8daebfee0b6f1a340b35806','542788998ec3d8daebf7f7f7fee0b6f1a340b35806','5427888073acb2abd2d8daebfee0b6fdb863e08214b35806','5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806','2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08','2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08').map(_c),mO=xc(gO),hO=[,,,].concat('ef8a62f7f7f767a9cf','ca0020f4a58292c5de0571b0','ca0020f4a582f7f7f792c5de0571b0','b2182bef8a62fddbc7d1e5f067a9cf2166ac','b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac','b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac','b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac','67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061','67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061').map(_c),yO=xc(hO),bO=[,,,].concat('ef8a62ffffff999999','ca0020f4a582bababa404040','ca0020f4a582ffffffbababa404040','b2182bef8a62fddbc7e0e0e09999994d4d4d','b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d','b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d','b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d','67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a','67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a').map(_c),_O=xc(bO),xO=[,,,].concat('fc8d59ffffbf91bfdb','d7191cfdae61abd9e92c7bb6','d7191cfdae61ffffbfabd9e92c7bb6','d73027fc8d59fee090e0f3f891bfdb4575b4','d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4','d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4','d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4','a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695','a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695').map(_c),vO=xc(xO),kO=[,,,].concat('fc8d59ffffbf91cf60','d7191cfdae61a6d96a1a9641','d7191cfdae61ffffbfa6d96a1a9641','d73027fc8d59fee08bd9ef8b91cf601a9850','d73027fc8d59fee08bffffbfd9ef8b91cf601a9850','d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850','d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850','a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837','a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837').map(_c),wO=xc(kO),EO=[,,,].concat('fc8d59ffffbf99d594','d7191cfdae61abdda42b83ba','d7191cfdae61ffffbfabdda42b83ba','d53e4ffc8d59fee08be6f59899d5943288bd','d53e4ffc8d59fee08bffffbfe6f59899d5943288bd','d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd','d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd','9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2','9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2').map(_c),SO=xc(EO),CO=[,,,].concat('e5f5f999d8c92ca25f','edf8fbb2e2e266c2a4238b45','edf8fbb2e2e266c2a42ca25f006d2c','edf8fbccece699d8c966c2a42ca25f006d2c','edf8fbccece699d8c966c2a441ae76238b45005824','f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824','f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b').map(_c),zO=xc(CO),DO=[,,,].concat('e0ecf49ebcda8856a7','edf8fbb3cde38c96c688419d','edf8fbb3cde38c96c68856a7810f7c','edf8fbbfd3e69ebcda8c96c68856a7810f7c','edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b','f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b','f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b').map(_c),RO=xc(DO),$O=[,,,].concat('e0f3dba8ddb543a2ca','f0f9e8bae4bc7bccc42b8cbe','f0f9e8bae4bc7bccc443a2ca0868ac','f0f9e8ccebc5a8ddb57bccc443a2ca0868ac','f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e','f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e','f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081').map(_c),OO=xc($O),TO=[,,,].concat('fee8c8fdbb84e34a33','fef0d9fdcc8afc8d59d7301f','fef0d9fdcc8afc8d59e34a33b30000','fef0d9fdd49efdbb84fc8d59e34a33b30000','fef0d9fdd49efdbb84fc8d59ef6548d7301f990000','fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000','fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000').map(_c),AO=xc(TO),LO=[,,,].concat('ece2f0a6bddb1c9099','f6eff7bdc9e167a9cf02818a','f6eff7bdc9e167a9cf1c9099016c59','f6eff7d0d1e6a6bddb67a9cf1c9099016c59','f6eff7d0d1e6a6bddb67a9cf3690c002818a016450','fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450','fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636').map(_c),PO=xc(LO),MO=[,,,].concat('ece7f2a6bddb2b8cbe','f1eef6bdc9e174a9cf0570b0','f1eef6bdc9e174a9cf2b8cbe045a8d','f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d','f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b','fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b','fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858').map(_c),UO=xc(MO),jO=[,,,].concat('e7e1efc994c7dd1c77','f1eef6d7b5d8df65b0ce1256','f1eef6d7b5d8df65b0dd1c77980043','f1eef6d4b9dac994c7df65b0dd1c77980043','f1eef6d4b9dac994c7df65b0e7298ace125691003f','f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f','f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f').map(_c),qO=xc(jO),FO=[,,,].concat('fde0ddfa9fb5c51b8a','feebe2fbb4b9f768a1ae017e','feebe2fbb4b9f768a1c51b8a7a0177','feebe2fcc5c0fa9fb5f768a1c51b8a7a0177','feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177','fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177','fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a').map(_c),IO=xc(FO),NO=[,,,].concat('edf8b17fcdbb2c7fb8','ffffcca1dab441b6c4225ea8','ffffcca1dab441b6c42c7fb8253494','ffffccc7e9b47fcdbb41b6c42c7fb8253494','ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84','ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84','ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58').map(_c),BO=xc(NO),WO=[,,,].concat('f7fcb9addd8e31a354','ffffccc2e69978c679238443','ffffccc2e69978c67931a354006837','ffffccd9f0a3addd8e78c67931a354006837','ffffccd9f0a3addd8e78c67941ab5d238443005a32','ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32','ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529').map(_c),GO=xc(WO),YO=[,,,].concat('fff7bcfec44fd95f0e','ffffd4fed98efe9929cc4c02','ffffd4fed98efe9929d95f0e993404','ffffd4fee391fec44ffe9929d95f0e993404','ffffd4fee391fec44ffe9929ec7014cc4c028c2d04','ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04','ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506').map(_c),HO=xc(YO),VO=[,,,].concat('ffeda0feb24cf03b20','ffffb2fecc5cfd8d3ce31a1c','ffffb2fecc5cfd8d3cf03b20bd0026','ffffb2fed976feb24cfd8d3cf03b20bd0026','ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026','ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026','ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026').map(_c),XO=xc(VO),ZO=[,,,].concat('deebf79ecae13182bd','eff3ffbdd7e76baed62171b5','eff3ffbdd7e76baed63182bd08519c','eff3ffc6dbef9ecae16baed63182bd08519c','eff3ffc6dbef9ecae16baed64292c62171b5084594','f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594','f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b').map(_c),JO=xc(ZO),QO=[,,,].concat('e5f5e0a1d99b31a354','edf8e9bae4b374c476238b45','edf8e9bae4b374c47631a354006d2c','edf8e9c7e9c0a1d99b74c47631a354006d2c','edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32','f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32','f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b').map(_c),KO=xc(QO),eT=[,,,].concat('f0f0f0bdbdbd636363','f7f7f7cccccc969696525252','f7f7f7cccccc969696636363252525','f7f7f7d9d9d9bdbdbd969696636363252525','f7f7f7d9d9d9bdbdbd969696737373525252252525','fffffff0f0f0d9d9d9bdbdbd969696737373525252252525','fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000').map(_c),tT=xc(eT),nT=[,,,].concat('efedf5bcbddc756bb1','f2f0f7cbc9e29e9ac86a51a3','f2f0f7cbc9e29e9ac8756bb154278f','f2f0f7dadaebbcbddc9e9ac8756bb154278f','f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486','fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486','fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d').map(_c),aT=xc(nT),iT=[,,,].concat('fee0d2fc9272de2d26','fee5d9fcae91fb6a4acb181d','fee5d9fcae91fb6a4ade2d26a50f15','fee5d9fcbba1fc9272fb6a4ade2d26a50f15','fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d','fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d','fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d').map(_c),dT=xc(iT),rT=[,,,].concat('fee6cefdae6be6550d','feeddefdbe85fd8d3cd94701','feeddefdbe85fd8d3ce6550da63603','feeddefdd0a2fdae6bfd8d3ce6550da63603','feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04','fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04','fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704').map(_c),lT=xc(rT),oT=$$(As(300,.5,0),As(-240,.5,1)),sT=$$(As(-100,.75,.35),As(80,1.5,.8)),fT=$$(As(260,.75,.35),As(80,1.5,.8)),cT=As(),uT=gs(),pT=aS/3,gT=2*aS/3,mT=wc(_c('44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725')),hT=wc(_c('00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf')),yT=wc(_c('00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4')),bT=wc(_c('0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921')),_T=/*#__PURE__*/Object.freeze({schemeCategory10:K$,schemeAccent:eO,schemeDark2:tO,schemePaired:nO,schemePastel1:aO,schemePastel2:iO,schemeSet1:dO,schemeSet2:rO,schemeSet3:lO,interpolateBrBG:sO,schemeBrBG:oO,interpolatePRGn:cO,schemePRGn:fO,interpolatePiYG:pO,schemePiYG:uO,interpolatePuOr:mO,schemePuOr:gO,interpolateRdBu:yO,schemeRdBu:hO,interpolateRdGy:_O,schemeRdGy:bO,interpolateRdYlBu:vO,schemeRdYlBu:xO,interpolateRdYlGn:wO,schemeRdYlGn:kO,interpolateSpectral:SO,schemeSpectral:EO,interpolateBuGn:zO,schemeBuGn:CO,interpolateBuPu:RO,schemeBuPu:DO,interpolateGnBu:OO,schemeGnBu:$O,interpolateOrRd:AO,schemeOrRd:TO,interpolatePuBuGn:PO,schemePuBuGn:LO,interpolatePuBu:UO,schemePuBu:MO,interpolatePuRd:qO,schemePuRd:jO,interpolateRdPu:IO,schemeRdPu:FO,interpolateYlGnBu:BO,schemeYlGnBu:NO,interpolateYlGn:GO,schemeYlGn:WO,interpolateYlOrBr:HO,schemeYlOrBr:YO,interpolateYlOrRd:XO,schemeYlOrRd:VO,interpolateBlues:JO,schemeBlues:ZO,interpolateGreens:KO,schemeGreens:QO,interpolateGreys:tT,schemeGreys:eT,interpolatePurples:aT,schemePurples:nT,interpolateReds:dT,schemeReds:iT,interpolateOranges:lT,schemeOranges:rT,interpolateCubehelixDefault:oT,interpolateRainbow:vc,interpolateWarm:sT,interpolateCool:fT,interpolateSinebow:kc,interpolateViridis:mT,interpolateMagma:hT,interpolateInferno:yT,interpolatePlasma:bT}),_={blueorange:Q$},xT={// d3 categorical palettes
category10:K$,accent:eO,dark2:tO,paired:nO,pastel1:aO,pastel2:iO,set1:dO,set2:rO,set3:lO,// additional categorical palettes
category20:H$,category20b:V$,category20c:X$,tableau10:Z$,tableau20:J$,// sequential multi-hue interpolators
viridis:mT,magma:hT,inferno:yT,plasma:bT,// cyclic interpolators
rainbow:vc,sinebow:kc,// extended interpolators
blueorange:m$(f(Q$))};Ec('blues','Blues'),Ec('greens','Greens'),Ec('greys','Greys'),Ec('purples','Purples'),Ec('reds','Reds'),Ec('oranges','Oranges'),Ec('brownbluegreen','BrBG'),Ec('purplegreen','PRGn'),Ec('pinkyellowgreen','PiYG'),Ec('purpleorange','PuOr'),Ec('redblue','RdBu'),Ec('redgrey','RdGy'),Ec('redyellowblue','RdYlBu'),Ec('redyellowgreen','RdYlGn'),Ec('spectral','Spectral'),Ec('bluegreen','BuGn'),Ec('bluepurple','BuPu'),Ec('greenblue','GnBu'),Ec('orangered','OrRd'),Ec('purplebluegreen','PuBuGn'),Ec('purpleblue','PuBu'),Ec('purplered','PuRd'),Ec('redpurple','RdPu'),Ec('yellowgreenblue','YlGnBu'),Ec('yellowgreen','YlGn'),Ec('yelloworangebrown','YlOrBr'),Ec('yelloworangered','YlOrRd');var vT={millisecond:IS,second:BS,minute:GS,hour:HS,day:XS,week:JS,month:lC,year:sC},kT={millisecond:IS,second:BS,minute:cC,hour:pC,day:mC,week:yC,month:zC,year:RC},wT=W(Mc,Dn);wT.transform=function(e,t){if(this.value&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),a=this.value,i=e.scale,d=null==e.count?e.values?e.values.length:10:Dc(i,e.count),r=e.format||Oc(i,d,e.formatSpecifier),l=e.values?Rc(i,e.values,d):$c(i,d);return a&&(n.rem=a),a=l.map(function(e,t){return ce({index:t/(l.length-1),value:e,label:r(e)})}),e.extra&&a.length&&a.push(ce({index:-1,extra:{value:a[0].value},label:''})),n.source=a,n.add=a,this.value=a,n};var ET=W(Uc,Dn);ET.transform=function(e,t){var n=t.dataflow,a=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.item||jc,d=e.key||se,r=this.value;// prevent transient (e.g., hover) requests from
// cascading across marks derived from marks
return hS(a.encode)&&(a.encode=null),r&&(e.modified('key')||t.modified(d))&&u('DataJoin does not support modified key function or fields.'),r||(t=t.addAll(),this.value=r=N().test(qc),r.lookup=function(e){return r.get(d(e))}),t.visit(t.ADD,function(e){var t=d(e),n=r.get(t);n?n.exit?(r.empty--,a.add.push(n)):a.mod.push(n):(r.set(t,n=i(e)),a.add.push(n)),n.datum=e,n.exit=!1}),t.visit(t.MOD,function(e){var t=d(e),n=r.get(t);n&&(n.datum=e,a.mod.push(n))}),t.visit(t.REM,function(e){var t=d(e),n=r.get(t);e!==n.datum||n.exit||(a.rem.push(n),n.exit=!0,++r.empty)}),t.changed(t.ADD_MOD)&&a.modifies('datum'),e.clean&&r.empty>n.cleanThreshold&&n.runAfter(r.clean),a};var ST=W(Fc,Dn);ST.transform=function(e,t){var n=t.fork(t.ADD_REM),a=e.encoders,i=t.encode;// if an array, the encode directive includes additional sets
// that must be defined in order for the primary set to be invoked
// e.g., only run the update set if the hover set is defined
if(hS(i))if(n.changed()||i.every(function(t){return a[t]}))i=i[0],n.encode=null;else return t.StopPropagation;// marshall encoder functions
var d='enter'===i,r=a.update||xS,l=a.enter||xS,o=a.exit||xS,s=(i&&!d?a[i]:r)||xS;if(t.changed(t.ADD)&&(t.visit(t.ADD,function(n){l(n,e),r(n,e),s!==xS&&s!==r&&s(n,e)}),n.modifies(l.output),n.modifies(r.output),s!==xS&&s!==r&&n.modifies(s.output)),t.changed(t.REM)&&o!==xS&&(t.visit(t.REM,function(n){o(n,e)}),n.modifies(o.output)),d||s!==xS){var f=t.MOD|(e.modified()?t.REFLOW:0);d?(t.visit(f,function(a){var t=l(a,e);(s(a,e)||t)&&n.mod.push(a)}),n.mod.length&&n.modifies(l.output)):t.visit(f,function(a){s(a,e)&&n.mod.push(a)}),n.mod.length&&n.modifies(s.output)}return n.changed()?n:t.StopPropagation};var CT={};CT.quantile=Bc,CT.quantize=Nc,CT.threshold=Wc,CT['bin-linear']=CT['bin-ordinal']=Gc;var zT=W(Qc,Dn);zT.transform=function(e,t){if(null!=this.value&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),a=this.value,i=e.type||'symbol',d=e.scale,r=null==e.count?5:Dc(d,e.count),l=e.format||Oc(d,r,e.formatSpecifier),o=e.values||Ic(d,r,i),s,c,u,p;return l=Yc(d,l,i),a&&(n.rem=a),'symbol'===i?(M(u=e.size)?(!e.values&&0===d(o[0])&&(o=o.slice(1)),p=o.reduce(function(t,n){return fS(t,u(n,e))},0)):u=j(p=u||8),a=o.map(function(t,n){return ce({index:n,label:l(t,n,o),value:t,offset:p,size:u(t,e)})})):'gradient'===i?(s=d.domain(),c=gc(d,s[0],f(s)),3>o.length&&!e.values&&s[0]!==f(s)&&(o=[s[0],f(s)]),a=o.map(function(e,t){return ce({index:t,label:l(e,t,o),value:e,perc:c(e)})})):(u=o.length-1,c=Jc(d),a=o.map(function(e,t){return ce({index:t,label:l(e,t,o),value:e,perc:t?c(e):0,perc2:t===u?1:c(o[t+1])})})),n.source=a,n.add=a,this.value=a,n};var DT=N({line:iu,"line-radial":function(e,t,n,a){return iu(t*QE(e),t*KE(e),a*QE(n),a*KE(n))},arc:du,"arc-radial":function(e,t,n,a){return du(t*QE(e),t*KE(e),a*QE(n),a*KE(n))},curve:ru,"curve-radial":function(e,t,n,a){return ru(t*QE(e),t*KE(e),a*QE(n),a*KE(n))},"orthogonal-horizontal":function(e,t,n,a){return'M'+e+','+t+'V'+a+'H'+n},"orthogonal-vertical":function(e,t,n,a){return'M'+e+','+t+'H'+n+'V'+a},"orthogonal-radial":function(e,t,n,a){var i=QE(e),d=KE(e),r=QE(n),l=KE(n),o=lS(n-e)>aS?n<=e:n>e;return'M'+t*i+','+t*d+'A'+t+','+t+' 0 0,'+(o?1:0)+' '+t*r+','+t*l+'L'+a*r+','+a*l},"diagonal-horizontal":function(e,t,n,a){var i=(e+n)/2;return'M'+e+','+t+'C'+i+','+t+' '+i+','+a+' '+n+','+a},"diagonal-vertical":function(e,t,n,a){var i=(t+a)/2;return'M'+e+','+t+'C'+e+','+i+' '+n+','+i+' '+n+','+a},"diagonal-radial":function(e,t,n,a){var i=QE(e),d=KE(e),r=QE(n),l=KE(n),o=(t+a)/2;return'M'+t*i+','+t*d+'C'+o*i+','+o*d+' '+o*r+','+o*l+' '+a*r+','+a*l}});au.Definition={type:'LinkPath',metadata:{modifies:!0},params:[{name:'sourceX',type:'field',default:'source.x'},{name:'sourceY',type:'field',default:'source.y'},{name:'targetX',type:'field',default:'target.x'},{name:'targetY',type:'field',default:'target.y'},{name:'orient',type:'enum',default:'vertical',values:['horizontal','vertical','radial']},{name:'shape',type:'enum',default:'line',values:['line','arc','curve','diagonal','orthogonal']},{name:'require',type:'signal'},{name:'as',type:'string',default:'path'}]};var RT=W(au,Dn);RT.transform=function(e,t){var n=e.sourceX||Kc,a=e.sourceY||eu,i=e.targetX||tu,d=e.targetY||nu,r=e.as||'path',l=e.orient||'vertical',o=e.shape||'line',s=DT.get(o+'-'+l)||DT.get(o);return s||u('LinkPath unsupported type: '+e.shape+(e.orient?'-'+e.orient:'')),t.visit(t.SOURCE,function(e){e[r]=s(n(e),a(e),i(e),d(e))}),t.reflow(e.modified()).modifies(r)},lu.Definition={type:'Pie',metadata:{modifies:!0},params:[{name:'field',type:'field'},{name:'startAngle',type:'number',default:0},{name:'endAngle',type:'number',default:6.283185307179586},{name:'sort',type:'boolean',default:!1},{name:'as',type:'string',array:!0,length:2,default:['startAngle','endAngle']}]};var $T=W(lu,Dn);$T.transform=function(e,d){var r=e.as||['startAngle','endAngle'],l=r[0],o=r[1],s=e.field||dy,f=e.startAngle||0,c=null==e.endAngle?2*aS:e.endAngle,u=d.source,p=u.map(s),g=p.length,n=f,m=(c-f)/la(p),h=Hn(g),y,b,_;for(e.sort&&h.sort(function(e,t){return p[e]-p[t]}),y=0;y<g;++y)_=p[h[y]],b=u[h[y]],b[l]=n,b[o]=n+=_*m;return this.value=p,d.reflow(e.modified()).modifies(r)};var OT=ae(['linear','pow','sqrt']),TT=ae(['linear','log','pow','sqrt','time','utc']),AT=ae(['set','modified','clear','type','scheme','schemeExtent','schemeCount','domain','domainMin','domainMid','domainMax','domainRaw','domainImplicit','nice','zero','range','rangeStep','round','reverse','interpolate','interpolateGamma']),LT=W(ou,Dn);LT.transform=function(e,t){var n=t.dataflow,a=this.value,i;for(i in(!a||e.modified('type'))&&(this.value=a=uc((e.type||'linear').toLowerCase())()),e)if(!AT[i]){// padding is a scale property for band/point but not others
if('padding'===i&&TT[a.type])continue;// invoke scale property setter, raise warning if not found
M(a[i])?a[i](e[i]):n.warn('Unsupported scale property: '+i)}return pu(a,e,su(a,e,n)),t.fork(t.NO_SOURCE|t.NO_FIELDS)};var PT=W(_u,Dn);PT.transform=function(e,t){var n=e.modified('sort')||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified('datum');return n&&t.source.sort(e.sort),this.modified(n),t};var MT=['y0','y1'];xu.Definition={type:'Stack',metadata:{modifies:!0},params:[{name:'field',type:'field'},{name:'groupby',type:'field',array:!0},{name:'sort',type:'compare'},{name:'offset',type:'enum',default:'zero',values:['zero','center','normalize']},{name:'as',type:'string',array:!0,length:2,default:MT}]};var UT=W(xu,Dn);UT.transform=function(e,t){var a=e.as||MT,d=a[0],r=a[1],l=e.field||dy,o=e.offset==='center'?vu:e.offset==='normalize'?ku:wu,s,f,c,u;// partition, sum, and sort the stack groups
// compute stack layouts per group
for(s=Eu(t.source,e.groupby,e.sort,l),f=0,c=s.length,u=s.max;f<c;++f)o(s[f],u,l,d,r);return t.reflow(e.modified()).modifies(a)};var jT=/*#__PURE__*/Object.freeze({axisticks:Mc,datajoin:Uc,encode:Fc,legendentries:Qc,linkpath:au,pie:lu,scale:ou,sortitems:_u,stack:xu,validTicks:Rc}),qT=function(e){return 1===e.length&&(e=Cu(e)),{left:function(t,n,a,i){for(null==a&&(a=0),null==i&&(i=t.length);a<i;){var d=a+i>>>1;0>e(t[d],n)?a=d+1:i=d}return a},right:function(t,n,a,i){for(null==a&&(a=0),null==i&&(i=t.length);a<i;){var d=a+i>>>1;0<e(t[d],n)?i=d:a=d+1}return a}}}(Su),FT=dS(50),IT=dS(10),NT=dS(2),BT=Array.prototype,WT=BT.slice,GT=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]],YT=['size','smooth'],HT=['x','y','weight','size','cellSize','bandwidth'];Vu.Definition={type:'Contour',metadata:{generates:!0},params:[{name:'size',type:'number',array:!0,length:2,required:!0},{name:'values',type:'number',array:!0},{name:'x',type:'field'},{name:'y',type:'field'},{name:'weight',type:'field'},{name:'cellSize',type:'number'},{name:'bandwidth',type:'number'},{name:'count',type:'number'},{name:'smooth',type:'boolean'},{name:'nice',type:'boolean',default:!1},{name:'thresholds',type:'number',array:!0}]};var VT=W(Vu,Dn);VT.transform=function(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),a=e.count||10,i,d,r;return e.values?(i=Iu(),d=YT,r=e.values):(i=Hu(),d=HT,r=t.materialize(t.SOURCE).source),i.thresholds(e.thresholds||(e.nice?a:Xu(a))),d.forEach(function(t){null!=e[t]&&i[t](e[t])}),this.value&&(n.rem=this.value),r=r&&r.length?i(r).map(ce):[],this.value=n.source=n.add=r,n};Zu.Definition={type:'GeoJSON',metadata:{},params:[{name:'fields',type:'field',array:!0,length:2},{name:'geojson',type:'field'}]};var XT=W(Zu,Dn);XT.transform=function(e,t){var n=this._features,a=this._points,i=e.fields,d=i&&i[0],r=i&&i[1],l=e.geojson,o=t.ADD,f;f=e.modified()||t.changed(t.REM)||t.modified(s(l))||d&&t.modified(s(d))||r&&t.modified(s(r)),(!this.value||f)&&(o=t.SOURCE,this._features=n=[],this._points=a=[]),l&&t.visit(o,function(e){n.push(l(e))}),d&&r&&(t.visit(o,function(e){var t=d(e),n=r(e);null!=t&&null!=n&&(t=+t)===t&&(n=+n)===n&&a.push([t,n])}),n=n.concat({type:'Feature',geometry:{type:'MultiPoint',coordinates:a}})),this.value={type:'FeatureCollection',features:n}},Qu.prototype={constructor:Qu,reset:function(){this.s=// rounded value
this.t=0},add:function(e){Ku(ZT,e,this.t),Ku(this,ZT.s,this.s),this.s?this.t+=ZT.t:this.s=ZT.t},valueOf:function(){return this.s}};var ZT=new Qu,JT=1e-6,QT=1e-12,KT=aS,eA=KT/2,tA=KT/4,nA=2*KT,aA=180/KT,iA=KT/180,dA=lS,rA=ZE,lA=JE,oA=QE,sA=cS,fA=mS,cA=gS,uA=pS,pA=KE,gA=uS||function(e){return 0<e?1:0>e?-1:0},mA=dS,hA=GE,yA={Feature:function(e,t){ap(e.geometry,t)},FeatureCollection:function(e,t){for(var a=e.features,d=-1,r=a.length;++d<r;)ap(a[d].geometry,t)}},bA={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var a=e.coordinates,d=-1,r=a.length;++d<r;)e=a[d],t.point(e[0],e[1],e[2])},LineString:function(e,t){ip(e.coordinates,t,0)},MultiLineString:function(e,t){for(var a=e.coordinates,d=-1,r=a.length;++d<r;)ip(a[d],t,0)},Polygon:function(e,t){dp(e.coordinates,t)},MultiPolygon:function(e,t){for(var a=e.coordinates,d=-1,r=a.length;++d<r;)dp(a[d],t)},GeometryCollection:function(e,t){for(var a=e.geometries,d=-1,r=a.length;++d<r;)ap(a[d],t)}},_A=Ju(),xA=Ju(),vA={point:np,lineStart:np,lineEnd:np,polygonStart:function(){_A.reset(),vA.lineStart=lp,vA.lineEnd=op},polygonEnd:function(){var e=+_A;xA.add(0>e?nA+e:e),this.lineStart=this.lineEnd=this.point=np},sphere:function(){xA.add(nA)}},// previous 3D point
kA=Ju(),wA={point:bp,lineStart:xp,lineEnd:vp,polygonStart:function(){wA.point=kp,wA.lineStart=wp,wA.lineEnd=Ep,kA.reset(),vA.polygonStart()},polygonEnd:function(){vA.polygonEnd(),wA.point=bp,wA.lineStart=xp,wA.lineEnd=vp,0>_A?($A=-(TA=180),OA=-(AA=90)):kA>JT?AA=90:kA<-JT&&(OA=-90),qA[0]=$A,qA[1]=TA}},EA={sphere:np,point:Rp,lineStart:Op,lineEnd:Lp,polygonStart:function(){EA.lineStart=Pp,EA.lineEnd=Mp},polygonEnd:function(){EA.lineStart=Op,EA.lineEnd=Lp}},SA,CA,zA,DA,RA,$A,OA,TA,AA,// bounds
LA,// previous lambda-coordinate
PA,MA,// first point
UA,jA,qA,FA,IA,NA,BA,WA,GA,YA,HA,VA,XA,ZA,JA,QA,// first point
KA,eL,tL;// previous point
Ip.invert=Ip;var nL=Ju(),aL=function(e){return 1===e.length&&(e=ng(e)),{left:function(t,n,a,i){for(null==a&&(a=0),null==i&&(i=t.length);a<i;){var d=a+i>>>1;0>e(t[d],n)?a=d+1:i=d}return a},right:function(t,n,a,i){for(null==a&&(a=0),null==i&&(i=t.length);a<i;){var d=a+i>>>1;0<e(t[d],n)?i=d:a=d+1}return a}}}(tg),iL=dg(function(){return!0},function(e){var t=NaN,n=NaN,a=NaN,i;// no intersections
return{lineStart:function(){e.lineStart(),i=1},point:function(d,r){var l=0<d?KT:-KT,o=dA(d-t);dA(o-KT)<JT?(e.point(t,n=0<(n+r)/2?eA:-eA),e.point(a,n),e.lineEnd(),e.lineStart(),e.point(l,n),e.point(d,n),i=0):a!==l&&o>=KT&&(dA(t-a)<JT&&(t-=a*JT),dA(d-l)<JT&&(d-=l*JT),n=og(t,n,d,r),e.point(a,n),e.lineEnd(),e.lineStart(),e.point(l,n),i=0),e.point(t=d,n=r),a=l},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-i;// if intersections, rejoin first and last segments
}}},function(e,t,n,a){var i;if(null==e)i=n*eA,a.point(-KT,i),a.point(0,i),a.point(KT,i),a.point(KT,0),a.point(KT,-i),a.point(0,-i),a.point(-KT,-i),a.point(-KT,0),a.point(-KT,i);else if(dA(e[0]-t[0])>JT){var d=e[0]<t[0]?KT:-KT;i=n*d/2,a.point(-d,i),a.point(0,i),a.point(d,i)}else a.point(t[0],t[1])},[-KT,-eA]),dL=Ju(),rL=Ju(),lL=Ju(),oL={point:np,lineStart:np,lineEnd:np,polygonStart:function(){oL.lineStart=hg,oL.lineEnd=_g},polygonEnd:function(){oL.lineStart=oL.lineEnd=oL.point=np,rL.add(dA(lL)),lL.reset()},result:function(){return rL.reset(),rL/2}},sL=1/0,fL=sL,cL=-sL,uL=cL,pL={point:xg,lineStart:np,lineEnd:np,polygonStart:np,polygonEnd:np,result:function(){var e=[[sL,fL],[cL,uL]];return cL=uL=-(fL=sL=1/0),e}},gL=0,mL=0,hL=0,yL=0,bL=0,_L=0,xL=0,vL=0,kL=0,wL={point:vg,lineStart:kg,lineEnd:Sg,polygonStart:function(){wL.lineStart=Cg,wL.lineEnd=zg},polygonEnd:function(){wL.point=vg,wL.lineStart=kg,wL.lineEnd=Sg},result:function(){var e=kL?[xL/kL,vL/kL]:_L?[yL/_L,bL/_L]:hL?[gL/hL,mL/hL]:[NaN,NaN];return gL=mL=hL=yL=bL=_L=xL=vL=kL=0,e}},EL,SL,CL,zL,DL,RL,$L,OL;$g.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,nA);break}}},result:np};var TL=Ju(),AL={point:np,lineStart:function(){AL.point=Og},lineEnd:function(){LL&&Tg(PL,ML),AL.point=np},polygonStart:function(){LL=!0},polygonEnd:function(){LL=null},result:function(){return TL.reset(),+TL}},LL,PL,ML,UL,jL;Ag.prototype={_radius:4.5,_circle:Lg(4.5),pointRadius:function(e){return(e=+e)!==this._radius&&(this._radius=e,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push('Z'),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._string.push('M',e,',',t),this._point=1;break}case 1:{this._string.push('L',e,',',t);break}default:{null==this._circle&&(this._circle=Lg(this._radius)),this._string.push('M',e,',',t,this._circle);break}}},result:function(){if(this._string.length){var e=this._string.join('');return this._string=[],e}return null}},Ug.prototype={constructor:Ug,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var// maximum depth of subdivision
qL=oA(30*iA),FL=Mg({point:function(e,t){this.stream.point(e*iA,t*iA)}}),IL=am(function(e){return mA(2/(1+e))});IL.invert=im(function(e){return 2*tp(e/2)});var NL=am(function(e){return(e=ep(e))&&e/pA(e)});NL.invert=im(function(e){return e}),dm.invert=function(e,t){return[e,2*rA(fA(t))-eA]},sm.invert=sm,cm.invert=im(rA),pm.invert=function(e,t){var n=t,a=25,d;do{var r=n*n,l=r*r;n-=d=(n*(1.007226+r*(.015085+l*(-.044475+.028874*r-.005916*l)))-t)/(1.007226+r*(3*.015085+l*(7*-.044475+9*.028874*r-11*.005916*l)))}while(dA(d)>JT&&0<--a);return[e/(.8707+(r=n*n)*(-.131979+r*(-.013791+r*r*r*(.003971-.001529*r)))),n]},gm.invert=im(tp),mm.invert=im(function(e){return 2*rA(e)}),hm.invert=function(e,t){return[-t,2*rA(fA(e))-eA]};var BL=Pg(),WL=[// standard properties in d3-geo
'clipAngle','clipExtent','scale','translate','center','rotate','parallels','precision','reflectX','reflectY',// extended properties in d3-geo-projections
'coefficient','distance','fraction','lobes','parallel','radius','ratio','spacing','tilt'],GL={// base d3-geo projection types
albers:tm,albersusa:function(){function e(e){var t=e[0],n=e[1];return c=null,(o.point(t,n),c)||(s.point(t,n),c)||(f.point(t,n),c)}function t(){return r=l=null,e}var n=tm(),a=em().rotate([154,0]).center([-2,58.5]).parallels([55,65]),// EPSG:3338
i=em().rotate([157,0]).center([-3,19.9]).parallels([8,18]),d={point:function(e,t){c=[e,t]}},r,l,o,s,f,// ESRI:102007
c;return e.invert=function(e){var d=n.scale(),r=n.translate(),t=(e[0]-r[0])/d,l=(e[1]-r[1])/d;return(.12<=l&&.234>l&&-.425<=t&&-.214>t?a:.166<=l&&.234>l&&-.214<=t&&-.115>t?i:n).invert(e)},e.stream=function(e){return r&&l===e?r:r=nm([n.stream(l=e),a.stream(e),i.stream(e)])},e.precision=function(e){return arguments.length?(n.precision(e),a.precision(e),i.precision(e),t()):n.precision()},e.scale=function(t){return arguments.length?(n.scale(t),a.scale(.35*t),i.scale(t),e.translate(n.translate())):n.scale()},e.translate=function(e){if(!arguments.length)return n.translate();var r=n.scale(),l=+e[0],c=+e[1];return o=n.translate(e).clipExtent([[l-.455*r,c-.238*r],[l+.455*r,c+.238*r]]).stream(d),s=a.translate([l-.307*r,c+.201*r]).clipExtent([[l-.425*r+JT,c+.12*r+JT],[l-.214*r-JT,c+.234*r-JT]]).stream(d),f=i.translate([l-.205*r,c+.212*r]).clipExtent([[l-.214*r+JT,c+.166*r+JT],[l-.115*r-JT,c+.234*r-JT]]).stream(d),t()},e.fitExtent=function(t,n){return qg(e,t,n)},e.fitSize=function(t,n){return Fg(e,t,n)},e.fitWidth=function(t,n){return Ig(e,t,n)},e.fitHeight=function(t,n){return Ng(e,t,n)},e.scale(1070)},azimuthalequalarea:function(){return Xg(IL).scale(124.75).clipAngle(180-1e-3)},azimuthalequidistant:function(){return Xg(NL).scale(79.4188).clipAngle(180-1e-3)},conicconformal:function(){return Jg(om).scale(109.5).parallels([30,30])},conicequalarea:em,conicequidistant:function(){return Jg(fm).scale(131.154).center([0,13.9389])},equirectangular:function(){return Xg(sm).scale(152.63)},gnomonic:function(){return Xg(cm).scale(144.049).clipAngle(60)},identity:function(){function e(){return u=p=null,g}var t=1,n=0,a=0,i=1,d=1,r=mg,// scale, translate and reflect
l=null,// clip extent
o=mg,s,f,c,u,p,g;return g={stream:function(e){return u&&p===e?u:u=r(o(p=e))},postclip:function(t){return arguments.length?(o=t,l=s=f=c=null,e()):o},clipExtent:function(t){return arguments.length?(o=null==t?(l=s=f=c=null,mg):cg(l=+t[0][0],s=+t[0][1],f=+t[1][0],c=+t[1][1]),e()):null==l?null:[[l,s],[f,c]]},scale:function(l){return arguments.length?(r=um((t=+l)*i,t*d,n,a),e()):t},translate:function(l){return arguments.length?(r=um(t*i,t*d,n=+l[0],a=+l[1]),e()):[n,a]},reflectX:function(l){return arguments.length?(r=um(t*(i=l?-1:1),t*d,n,a),e()):0>i},reflectY:function(l){return arguments.length?(r=um(t*i,t*(d=l?-1:1),n,a),e()):0>d},fitExtent:function(e,t){return qg(g,e,t)},fitSize:function(e,t){return Fg(g,e,t)},fitWidth:function(e,t){return Ig(g,e,t)},fitHeight:function(e,t){return Ng(g,e,t)}}},mercator:function(){return rm(dm).scale(961/nA)},naturalEarth1:function(){return Xg(pm).scale(175.295)},orthographic:function(){return Xg(gm).scale(249.5).clipAngle(90+JT)},stereographic:function(){return Xg(mm).scale(250).clipAngle(142)},transversemercator:function(){var e=rm(hm),t=e.center,n=e.rotate;return e.center=function(e){return arguments.length?t([-e[1],e[0]]):(e=t(),[e[1],-e[0]])},e.rotate=function(e){return arguments.length?n([e[0],e[1],2<e.length?e[2]+90:90]):(e=n(),[e[0],e[1],e[2]-90])},n([0,0,90]).scale(159.155)}};for(var YL in GL)bm(YL,GL[YL]);xm.Definition={type:'GeoPath',metadata:{modifies:!0},params:[{name:'projection',type:'projection'},{name:'field',type:'field'},{name:'pointRadius',type:'number',expr:!0},{name:'as',type:'string',default:'path'}]};var HL=W(xm,Dn);HL.transform=function(e,t){function n(e){e[r]=i(d(e))}var a=t.fork(t.ALL),i=this.value,d=e.field||id,r=e.as||'path',l=a.SOURCE;!i||e.modified()?(this.value=i=_m(e.projection),a.materialize().reflow()):l=d===id||t.modified(d.fields)?a.ADD_MOD:a.ADD;var o=vm(i,e.pointRadius);return a.visit(l,n),i.pointRadius(o),a.modifies(r)},km.Definition={type:'GeoPoint',metadata:{modifies:!0},params:[{name:'projection',type:'projection',required:!0},{name:'fields',type:'field',array:!0,required:!0,length:2},{name:'as',type:'string',array:!0,length:2,default:['x','y']}]};var VL=W(km,Dn);VL.transform=function(e,t){function n(e){var t=a([i(e),d(e)]);t?(e[l]=t[0],e[o]=t[1]):(e[l]=void 0,e[o]=void 0)}var a=e.projection,i=e.fields[0],d=e.fields[1],r=e.as||['x','y'],l=r[0],o=r[1],s;return e.modified()?t=t.materialize().reflow(!0).visit(t.SOURCE,n):(s=t.modified(i.fields)||t.modified(d.fields),t.visit(s?t.ADD_MOD:t.ADD,n)),t.modifies(r)},wm.Definition={type:'GeoShape',metadata:{modifies:!0},params:[{name:'projection',type:'projection'},{name:'field',type:'field',default:'datum'},{name:'pointRadius',type:'number',expr:!0},{name:'as',type:'string',default:'shape'}]};var XL=W(wm,Dn);XL.transform=function(e,n){var a=n.fork(n.ALL),i=this.value,d=e.field||t('datum'),r=e.as||'shape',l=a.ADD_MOD;return(!i||e.modified())&&(this.value=i=Em(_m(e.projection),d,e.pointRadius),a.materialize().reflow(),l=a.SOURCE),a.visit(l,function(e){e[r]=i}),a.modifies(r)},Sm.Definition={type:'Graticule',metadata:{changes:!0},params:[{name:'extent',type:'array',array:!0,length:2,content:{type:'number',array:!0,length:2}},{name:'extentMajor',type:'array',array:!0,length:2,content:{type:'number',array:!0,length:2}},{name:'extentMinor',type:'array',array:!0,length:2,content:{type:'number',array:!0,length:2}},{name:'step',type:'number',array:!0,length:2},{name:'stepMajor',type:'number',array:!0,length:2,default:[90,360]},{name:'stepMinor',type:'number',array:!0,length:2,default:[10,10]},{name:'precision',type:'number',default:2.5}]};var ZL=W(Sm,Dn);ZL.transform=function(e,n){var a=this.value,i=this.generator,d;if(!a.length||e.modified())for(var r in e)M(i[r])&&i[r](e[r]);return d=i(),a.length?n.mod.push(ge(a[0],d)):n.add.push(ce(d)),a[0]=d,n};var JL=W(Cm,Dn);JL.transform=function(e,t){var n=this.value;return!n||e.modified('type')?(this.value=n=Dm(e.type),WL.forEach(function(t){null!=e[t]&&Rm(n,t,e[t])})):WL.forEach(function(t){e.modified(t)&&Rm(n,t,e[t])}),null!=e.pointRadius&&n.path.pointRadius(e.pointRadius),e.fit&&zm(n,e),t.fork(t.NO_SOURCE|t.NO_FIELDS)};var QL=/*#__PURE__*/Object.freeze({contour:Vu,geojson:Zu,geopath:xm,geopoint:km,geoshape:wm,graticule:Sm,projection:Cm}),KL=Bm.prototype=Wm.prototype;KL.copy=function(){var e=new Wm(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,a;if(!t)return e;if(!t.length)return e._root=Gm(t),e;for(n=[{source:t,target:e._root=[,,,,]}];t=n.pop();)for(var d=0;4>d;++d)(a=t.source[d])&&(a.length?n.push({source:a,target:t.target[d]=[,,,,]}):t.target[d]=Gm(a));return e},KL.add=function(e){var t=+this._x.call(null,e),n=+this._y.call(null,e);return Am(this.cover(t,n),t,n,e)},KL.addAll=Lm,KL.cover=Pm,KL.data=function(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e},KL.extent=function(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},KL.find=Um,KL.remove=jm,KL.removeAll=function(e){for(var t=0,a=e.length;t<a;++t)this.remove(e[t]);return this},KL.root=function(){return this._root},KL.size=function(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e},KL.visit=qm,KL.visitAfter=Fm,KL.x=function(e){return arguments.length?(this._x=e,this):this._x},KL.y=function(e){return arguments.length?(this._y=e,this):this._y};var eP={value:function(){}};Jm.prototype=Zm.prototype={constructor:Jm,on:function(e,a){var d=this._,r=Qm(e+'',d),l=-1,o=r.length,n;// If no callback was specified, return the callback of the given type and name.
if(2>arguments.length){for(;++l<o;)if((n=(e=r[l]).type)&&(n=Km(d[n],e.name)))return n;return}// If a type was specified, set the callback for the given type and name.
// Otherwise, if a null callback was specified, remove callbacks of the given name.
if(null!=a&&'function'!=typeof a)throw new Error('invalid callback: '+a);for(;++l<o;)if(n=(e=r[l]).type)d[n]=eh(d[n],e.name,a);else if(null==a)for(n in d)d[n]=eh(d[n],e.name,null);return this},copy:function(){var e={},n=this._;for(var a in n)e[a]=n[a].slice();return new Jm(e)},call:function(e,a){if(0<(l=arguments.length-2))for(var d=Array(l),r=0,l,o;r<l;++r)d[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error('unknown type: '+e);for(o=this._[e],r=0,l=o.length;r<l;++r)o[r].value.apply(a,d)},apply:function(e,a,d){if(!this._.hasOwnProperty(e))throw new Error('unknown type: '+e);for(var r=this._[e],t=0,l=r.length;t<l;++t)r[t].value.apply(a,d)}};var tP=0,// is an animation frame pending?
nP=0,// is a timeout pending?
aP=0// are any timers active?
,iP=0,dP=0,rP=0,lP='object'==typeof performance&&performance.now?performance:Date,oP='object'==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)},// how frequently we check for clock skew
sP,fP;ah.prototype=ih.prototype={constructor:ah,restart:function(e,t,n){if('function'!=typeof e)throw new TypeError('callback is not a function');n=(null==n?th():+n)+(null==t?0:+t),this._next||fP===this||(fP?fP._next=this:sP=this,fP=this),this._call=e,this._time=n,sh()},stop:function(){this._call&&(this._call=null,this._time=1/0,sh())}};var cP=aS*(3-dS(5)),uP={center:function(e,t){function n(){var d=a.length,n=0,r=0,l,o;for(l=0;l<d;++l)o=a[l],n+=o.x,r+=o.y;for(n=n/d-e,r=r/d-t,l=0;l<d;++l)o=a[l],o.x-=n,o.y-=r}var a;return null==e&&(e=0),null==t&&(t=0),n.initialize=function(e){a=e},n.x=function(t){return arguments.length?(e=+t,n):e},n.y=function(e){return arguments.length?(t=+e,n):t},n},collide:function(e){function t(){function e(e,t,n,a,i){var o=e.data,s=e.r,f=g+s;if(o){if(o.index>c.index){var h=u-o.x-o.vx,b=p-o.y-o.vy,_=h*h+b*b;_<f*f&&(0===h&&(h=Tm(),_+=h*h),0===b&&(b=Tm(),_+=b*b),_=(f-(_=dS(_)))/_*d,c.vx+=(h*=_)*(f=(s*=s)/(m+s)),c.vy+=(b*=_)*f,o.vx-=h*(f=1-f),o.vy-=b*f)}return}return t>u+f||a<u-f||n>p+f||i<p-f}for(var t=l.length,n=0,s,f,c,u,p,g,m;n<r;++n)for(f=Bm(l,Ym,Hm).visitAfter(a),s=0;s<t;++s)c=l[s],g=o[c.index],m=g*g,u=c.x+c.vx,p=c.y+c.vy,f.visit(e)}function a(e){if(e.data)return e.r=o[e.data.index];for(var t=e.r=0;4>t;++t)e[t]&&e[t].r>e.r&&(e.r=e[t].r)}function i(){if(l){var t=l.length,n,a;for(o=Array(t),n=0;n<t;++n)a=l[n],o[a.index]=+e(a,n,l)}}var d=1,r=1,l,o;return'function'!=typeof e&&(e=Om(null==e?1:+e)),t.initialize=function(e){l=e,i()},t.iterations=function(e){return arguments.length?(r=+e,t):r},t.strength=function(e){return arguments.length?(d=+e,t):d},t.radius=function(n){return arguments.length?(e='function'==typeof n?n:Om(+n),i(),t):e},t},nbody:function(){function e(e){var t=c.length,n=Bm(c,ch,uh).visitAfter(a),r;for(p=e,r=0;r<t;++r)u=c[r],n.visit(d)}function t(){if(c){var e=c.length,t,n;for(g=Array(e),t=0;t<e;++t)n=c[t],g[n.index]=+r(n,t,c)}}function a(e){var t=0,n=0,a,d,r,l,o;// For internal nodes, accumulate forces from child quadrants.
if(e.length){for(r=l=o=0;4>o;++o)(a=e[o])&&(d=lS(a.value))&&(t+=a.value,n+=d,r+=d*a.x,l+=d*a.y);e.x=r/n,e.y=l/n}// For leaf nodes, accumulate forces from coincident quadrants.
else{a=e,a.x=a.data.x,a.y=a.data.y;do t+=g[a.data.index];while(a=a.next)}e.value=t}function d(e,t,n,a){if(!e.value)return!0;var i=e.x-u.x,d=e.y-u.y,r=a-t,c=i*i+d*d;// Apply the Barnes-Hut approximation if possible.
// Limit forces for very close nodes; randomize direction if coincident.
if(r*r/f<c)return c<s&&(0===i&&(i=Tm(),c+=i*i),0===d&&(d=Tm(),c+=d*d),c<o&&(c=dS(o*c)),u.vx+=i*e.value*p/c,u.vy+=d*e.value*p/c),!0;// Otherwise, process points directly.
// Limit forces for very close nodes; randomize direction if coincident.
if(!(e.length||c>=s)){(e.data!==u||e.next)&&(0===i&&(i=Tm(),c+=i*i),0===d&&(d=Tm(),c+=d*d),c<o&&(c=dS(o*c)));do e.data!==u&&(r=g[e.data.index]*p/c,u.vx+=i*r,u.vy+=d*r);while(e=e.next)}}var r=Om(-30),o=1,s=1/0,f=.81,c,u,p,g;return e.initialize=function(e){c=e,t()},e.strength=function(n){return arguments.length?(r='function'==typeof n?n:Om(+n),t(),e):r},e.distanceMin=function(t){return arguments.length?(o=t*t,e):dS(o)},e.distanceMax=function(t){return arguments.length?(s=t*t,e):dS(s)},e.theta=function(t){return arguments.length?(f=t*t,e):dS(f)},e},link:function(e){function t(e){return 1/iS(g[e.source.index],g[e.target.index])}function n(t){for(var a=0,d=e.length;a<f;++a)for(var n=0,r,o,s,p,g,m,_;n<d;++n)r=e[n],o=r.source,s=r.target,p=s.x+s.vx-o.x-o.vx||Tm(),g=s.y+s.vy-o.y-o.vy||Tm(),m=dS(p*p+g*g),m=(m-u[n])/m*t*c[n],p*=m,g*=m,s.vx-=p*(_=h[n]),s.vy-=g*_,o.vx+=p*(_=1-_),o.vy+=g*_}function a(){if(p){var t=p.length,n=e.length,a=Qo(p,l),o,s;for(o=0,g=Array(t);o<n;++o)s=e[o],s.index=o,'object'!=typeof s.source&&(s.source=Xm(a,s.source)),'object'!=typeof s.target&&(s.target=Xm(a,s.target)),g[s.source.index]=(g[s.source.index]||0)+1,g[s.target.index]=(g[s.target.index]||0)+1;for(o=0,h=Array(n);o<n;++o)s=e[o],h[o]=g[s.source.index]/(g[s.source.index]+g[s.target.index]);c=Array(n),d(),u=Array(n),r()}}function d(){if(p)for(var t=0,a=e.length;t<a;++t)c[t]=+o(e[t],t,e)}function r(){if(p)for(var t=0,a=e.length;t<a;++t)u[t]=+s(e[t],t,e)}var l=Vm,o=t,s=Om(30),f=1,c,u,p,g,h;return null==e&&(e=[]),n.initialize=function(e){p=e,a()},n.links=function(t){return arguments.length?(e=t,a(),n):e},n.id=function(e){return arguments.length?(l=e,n):l},n.iterations=function(e){return arguments.length?(f=+e,n):f},n.strength=function(e){return arguments.length?(o='function'==typeof e?e:Om(+e),d(),n):o},n.distance=function(e){return arguments.length?(s='function'==typeof e?e:Om(+e),r(),n):s},n},x:function(e){function t(e){for(var t=0,a=d.length,n;t<a;++t)n=d[t],n.vx+=(l[t]-n.x)*r[t]*e}function n(){if(d){var t=d.length,n;for(r=Array(t),l=Array(t),n=0;n<t;++n)r[n]=isNaN(l[n]=+e(d[n],n,d))?0:+a(d[n],n,d)}}var a=Om(.1),d,r,l;return'function'!=typeof e&&(e=Om(null==e?0:+e)),t.initialize=function(e){d=e,n()},t.strength=function(e){return arguments.length?(a='function'==typeof e?e:Om(+e),n(),t):a},t.x=function(a){return arguments.length?(e='function'==typeof a?a:Om(+a),n(),t):e},t},y:function(e){function t(e){for(var t=0,a=d.length,n;t<a;++t)n=d[t],n.vy+=(l[t]-n.y)*r[t]*e}function n(){if(d){var t=d.length,n;for(r=Array(t),l=Array(t),n=0;n<t;++n)r[n]=isNaN(l[n]=+e(d[n],n,d))?0:+a(d[n],n,d)}}var a=Om(.1),d,r,l;return'function'!=typeof e&&(e=Om(null==e?0:+e)),t.initialize=function(e){d=e,n()},t.strength=function(e){return arguments.length?(a='function'==typeof e?e:Om(+e),n(),t):a},t.y=function(a){return arguments.length?(e='function'==typeof a?a:Om(+a),n(),t):e},t}},pP=['alpha','alphaMin','alphaTarget','velocityDecay','forces'],gP=['static','iterations'],mP=['x','y','vx','vy'];gh.Definition={type:'Force',metadata:{modifies:!0},params:[{name:'static',type:'boolean',default:!1},{name:'restart',type:'boolean',default:!1},{name:'iterations',type:'number',default:300},{name:'alpha',type:'number',default:1},{name:'alphaMin',type:'number',default:.001},{name:'alphaTarget',type:'number',default:0},{name:'velocityDecay',type:'number',default:.4},{name:'forces',type:'param',array:!0,params:[{key:{force:'center'},params:[{name:'x',type:'number',default:0},{name:'y',type:'number',default:0}]},{key:{force:'collide'},params:[{name:'radius',type:'number',expr:!0},{name:'strength',type:'number',default:.7},{name:'iterations',type:'number',default:1}]},{key:{force:'nbody'},params:[{name:'strength',type:'number',default:-30},{name:'theta',type:'number',default:.9},{name:'distanceMin',type:'number',default:1},{name:'distanceMax',type:'number'}]},{key:{force:'link'},params:[{name:'links',type:'data'},{name:'id',type:'field'},{name:'distance',type:'number',default:30,expr:!0},{name:'strength',type:'number',expr:!0},{name:'iterations',type:'number',default:1}]},{key:{force:'x'},params:[{name:'strength',type:'number',default:.1},{name:'x',type:'field'}]},{key:{force:'y'},params:[{name:'strength',type:'number',default:.1},{name:'y',type:'field'}]}]},{name:'as',type:'string',array:!0,modify:!1,default:mP}]};var hP=W(gh,Dn);hP.transform=function(e,t){var n=this.value,a=t.changed(t.ADD_REM),i=e.modified(pP),d=e.iterations||300;// configure simulation
// run simulation
if(n?(a&&(t.modifies('index'),n.nodes(t.source)),(i||t.changed(t.MOD))&&yh(n,e,0,t)):(this.value=n=hh(t.source,e),n.on('tick',mh(t.dataflow,this)),!e.static&&(a=!0,n.tick()),t.modifies('index')),i||a||e.modified(gP)||t.changed()&&e.restart)if(n.alpha(fS(n.alpha(),e.alpha||1)).alphaDecay(1-pS(n.alphaMin(),1/d)),e.static)for(n.stop();0<=--d;)n.tick();else if(n.stopped()&&n.restart(),!a)return t.StopPropagation;// defer to sim ticks
return this.finish(e,t)},hP.finish=function(e,t){// inspect dependencies, touch link source data
for(var a=t.dataflow,d=this._argops,r=0,l=d.length,o;r<l;++r)if(o=d[r],'forces'===o.name&&'link'===o.op._argval.force)for(var s=o.op._argops,f=0,c=s.length,n;f<c;++f)if('links'===s[f].name&&(n=s[f].op.source)){a.pulse(n,a.changeset().reflow());break}// reflow all nodes
return t.reflow(e.modified()).modifies(mP)};var yP=/*#__PURE__*/Object.freeze({force:gh});Uh.prototype=Ah.prototype={constructor:Uh,count:Oh,each:function(e){var t=this,a=[t],d,r,l,o;do for(d=a.reverse(),a=[];t=d.pop();)if(e(t),r=t.children,r)for(l=0,o=r.length;l<o;++l)a.push(r[l]);while(a.length);return this},eachAfter:function(e){for(var t=this,a=[t],d=[],r,l,o;t=a.pop();)if(d.push(t),r=t.children,r)for(l=0,o=r.length;l<o;++l)a.push(r[l]);for(;t=d.pop();)e(t);return this},eachBefore:function(e){for(var t=this,n=[t],a,d;t=n.pop();)if(e(t),a=t.children,a)for(d=a.length-1;0<=d;--d)n.push(a[d]);return this},sum:function(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,a=t.children,d=a&&a.length;0<=--d;)n+=a[d].value;t.value=n})},sort:function(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})},path:function(e){for(var t=this,n=Th(t,e),a=[t];t!==n;)t=t.parent,a.push(t);for(var i=a.length;e!==n;)a.splice(i,0,e),e=e.parent;return a},ancestors:function(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t},descendants:function(){var e=[];return this.each(function(t){e.push(t)}),e},leaves:function(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e},links:function(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t},copy:function(){return Ah(this).eachBefore(Ph)}};var bP=Array.prototype.slice,// Protect against keys like __proto__.
_P={depth:-1},xP={};_y.prototype=Object.create(Uh.prototype);var vP=(1+dS(5))/2,kP=function e(t){function n(e,n,a,i,d){wy(t,e,n,a,i,d)}return n.ratio=function(t){return e(1<(t=+t)?t:1)},n}(vP),wP=function e(t){function n(e,a,d,r,l){if((c=e._squarify)&&c.ratio===t)for(var o=-1,s=c.length,f=e.value,c,u,p,g,m;++o<s;){for(u=c[o],p=u.children,(g=u.value=0,m=p.length);g<m;++g)u.value+=p[g].value;u.dice?sy(u,a,d,r,d+=(l-d)*u.value/f):ky(u,a,d,a+=(r-a)*u.value/f,l),f-=u.value}else e._squarify=c=wy(t,e,a,d,r,l),c.ratio=t}return n.ratio=function(t){return e(1<(t=+t)?t:1)},n}(vP);zy.Definition={type:'Nest',metadata:{treesource:!0,changes:!0},params:[{name:'keys',type:'field',array:!0},{name:'generate',type:'boolean'}]};var EP=W(zy,Dn);EP.transform=function(e,t){t.source||u('Nest transform requires an upstream data source.');var n=e.generate,a=e.modified(),i=t.clone(),d=this.value;return(!d||a||t.changed())&&(d&&d.each(function(e){e.children&&oe(e.data)&&i.rem.push(e.data)}),this.value=d=Ah({values:P(e.keys).reduce(function(e,t){return e.key(t),e},Ko()).entries(i.source)},Dy),n&&d.each(function(e){e.children&&(e=ce(e.data),i.add.push(e),i.source.push(e))}),vh(d,se,se)),i.source.root=d,i};var SP=W(Ry,Dn);SP.transform=function(e,t){t.source&&t.source.root||u(this.constructor.name+' transform requires a backing tree data source.');var n=this.layout(e.method),a=this.fields,i=t.source.root,d=e.as||a;e.field&&i.sum(e.field),e.sort&&i.sort(e.sort),$y(n,this.params,e),n.separation&&n.separation(!1===e.separation?dy:Ty);try{this.value=n(i)}catch(e){u(e)}return i.each(function(e){Oy(e,a,d)}),t.reflow(e.modified()).modifies(d).modifies('leaf')};var CP=['x','y','r','depth','children'];Ay.Definition={type:'Pack',metadata:{tree:!0,modifies:!0},params:[{name:'field',type:'field'},{name:'sort',type:'compare'},{name:'padding',type:'number',default:0},{name:'radius',type:'field',default:null},{name:'size',type:'number',array:!0,length:2},{name:'as',type:'string',array:!0,length:CP.length,default:CP}]};var zP=W(Ay,Ry);zP.layout=function(){function e(e){return e.x=n/2,e.y=a/2,t?e.eachBefore(iy(t)).eachAfter(ry(i,.5)).eachBefore(ly(1)):e.eachBefore(iy(ay)).eachAfter(ry(ty,1)).eachAfter(ry(i,e.r/iS(n,a))).eachBefore(ly(iS(n,a)/(2*e.r))),e}var t=null,n=1,a=1,i=ty;return e.radius=function(n){return arguments.length?(t=Kh(n),e):t},e.size=function(t){return arguments.length?(n=+t[0],a=+t[1],e):[n,a]},e.padding=function(t){return arguments.length?(i='function'==typeof t?t:ny(+t),e):i},e},zP.params=['size','padding'],zP.fields=CP;var DP=['x0','y0','x1','y1','depth','children'];Ly.Definition={type:'Partition',metadata:{tree:!0,modifies:!0},params:[{name:'field',type:'field'},{name:'sort',type:'compare'},{name:'padding',type:'number',default:0},{name:'round',type:'boolean',default:!1},{name:'size',type:'number',array:!0,length:2},{name:'as',type:'string',array:!0,length:DP.length,default:DP}]};var RP=W(Ly,Ry);RP.layout=function(){function e(e){var l=e.height+1;return e.x0=e.y0=d,e.x1=a,e.y1=i/l,e.eachBefore(t(i,l)),r&&e.eachBefore(oy),e}function t(e,t){return function(n){n.children&&sy(n,n.x0,e*(n.depth+1)/t,n.x1,e*(n.depth+2)/t);var a=n.x0,i=n.y0,r=n.x1-d,l=n.y1-d;r<a&&(a=r=(a+r)/2),l<i&&(i=l=(i+l)/2),n.x0=a,n.y0=i,n.x1=r,n.y1=l}}var a=1,i=1,d=0,r=!1;return e.round=function(t){return arguments.length?(r=!!t,e):r},e.size=function(t){return arguments.length?(a=+t[0],i=+t[1],e):[a,i]},e.padding=function(t){return arguments.length?(d=+t,e):d},e},RP.params=['size','round','padding'],RP.fields=DP,Py.Definition={type:'Stratify',metadata:{treesource:!0},params:[{name:'key',type:'field',required:!0},{name:'parentKey',type:'field',required:!0}]};var $P=W(Py,Dn);$P.transform=function(e,t){t.source||u('Stratify transform requires an upstream data source.');var n=this.value,a=e.modified(),i=t.fork(t.ALL).materialize(t.SOURCE),d=!this.value||a||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields);// prevent upstream source pollution
return i.source=i.source.slice(),d&&(i.source.length?n=vh(uy().id(e.key).parentId(e.parentKey)(i.source),e.key,_S):n=vh(uy()([{}]),e.key,e.key)),i.source.root=this.value=n,i};var OP={tidy:vy,cluster:Rh},TP=['x','y','depth','children'];My.Definition={type:'Tree',metadata:{tree:!0,modifies:!0},params:[{name:'field',type:'field'},{name:'sort',type:'compare'},{name:'method',type:'enum',default:'tidy',values:['tidy','cluster']},{name:'size',type:'number',array:!0,length:2},{name:'nodeSize',type:'number',array:!0,length:2},{name:'separation',type:'boolean',default:!0},{name:'as',type:'string',array:!0,length:TP.length,default:TP}]};var AP=W(My,Ry);/**
   * Tree layout generator. Supports both 'tidy' and 'cluster' layouts.
   */AP.layout=function(e){var t=e||'tidy';return OP.hasOwnProperty(t)?OP[t]():void u('Unrecognized Tree layout method: '+t)},AP.params=['size','nodeSize'],AP.fields=TP,Uy.Definition={type:'TreeLinks',metadata:{tree:!0,generates:!0,changes:!0},params:[]};var LP=W(Uy,Dn);LP.transform=function(e,t){var n=this.value,a=t.source&&t.source.root,i=t.fork(t.NO_SOURCE),d={};return a||u('TreeLinks transform requires a tree data source.'),t.changed(t.ADD_REM)?(i.rem=n,t.visit(t.SOURCE,function(e){d[se(e)]=1}),a.each(function(e){var n=e.data,t=e.parent&&e.parent.data;t&&d[se(n)]&&d[se(t)]&&i.add.push(ce({source:t,target:n}))}),this.value=i.add):t.changed(t.MOD)&&(t.visit(t.MOD,function(e){d[se(e)]=1}),n.forEach(function(e){(d[se(e.source)]||d[se(e.target)])&&i.mod.push(e)})),i};var PP={binary:Sy,dice:sy,slice:ky,slicedice:Cy,squarify:kP,resquarify:wP},MP=['x0','y0','x1','y1','depth','children'];jy.Definition={type:'Treemap',metadata:{tree:!0,modifies:!0},params:[{name:'field',type:'field'},{name:'sort',type:'compare'},{name:'method',type:'enum',default:'squarify',values:['squarify','resquarify','binary','dice','slice','slicedice']},{name:'padding',type:'number',default:0},{name:'paddingInner',type:'number',default:0},{name:'paddingOuter',type:'number',default:0},{name:'paddingTop',type:'number',default:0},{name:'paddingRight',type:'number',default:0},{name:'paddingBottom',type:'number',default:0},{name:'paddingLeft',type:'number',default:0},{name:'ratio',type:'number',default:1.618033988749895},{name:'round',type:'boolean',default:!1},{name:'size',type:'number',array:!0,length:2},{name:'as',type:'string',array:!0,length:MP.length,default:MP}]};var UP=W(jy,Ry);/**
   * Treemap layout generator. Adds 'method' and 'ratio' parameters
   * to configure the underlying tile method.
   */UP.layout=function(){var e=Ey();return e.ratio=function(n){var a=e.tile();a.ratio&&e.tile(a.ratio(n))},e.method=function(t){PP.hasOwnProperty(t)?e.tile(PP[t]):u('Unrecognized Treemap layout method: '+t)},e},UP.params=['method','ratio','size','round','padding','paddingInner','paddingOuter','paddingTop','paddingRight','paddingBottom','paddingLeft'],UP.fields=MP;var jP=/*#__PURE__*/Object.freeze({nest:zy,pack:Ay,partition:Ly,stratify:Py,tree:My,treelinks:Uy,treemap:jy});Ny.prototype={constructor:Ny,insert:function(e,t){var n,a,i;if(e){if(t.P=e,t.N=e.N,e.N&&(e.N.P=t),e.N=t,e.R){for(e=e.R;e.L;)e=e.L;e.L=t}else e.R=t;n=e}else this._?(e=Yy(this._),t.P=null,t.N=e,e.P=e.L=t,n=e):(t.P=t.N=null,this._=t,n=null);for(t.L=t.R=null,t.U=n,t.C=!0,e=t;n&&n.C;)a=n.U,n===a.L?(i=a.R,i&&i.C?(n.C=i.C=!1,a.C=!0,e=a):(e===n.R&&(Wy(this,n),e=n,n=e.U),n.C=!1,a.C=!0,Gy(this,a))):(i=a.L,i&&i.C?(n.C=i.C=!1,a.C=!0,e=a):(e===n.L&&(Gy(this,n),e=n,n=e.U),n.C=!1,a.C=!0,Wy(this,a))),n=e.U;this._.C=!1},remove:function(e){e.N&&(e.N.P=e.P),e.P&&(e.P.N=e.N),e.N=e.P=null;var t=e.U,n=e.L,a=e.R,i,d,r;if(d=n?a?Yy(a):n:a,t?t.L===e?t.L=d:t.R=d:this._=d,n&&a?(r=d.C,d.C=e.C,d.L=n,n.U=d,d===a?(d.U=t,t=d,e=d.R):(t=d.U,d.U=e.U,e=d.R,t.L=e,d.R=a,a.U=d)):(r=e.C,e=d),e&&(e.U=t),!r){if(e&&e.C)return void(e.C=!1);do{if(e===this._)break;if(e===t.L){if(i=t.R,i.C&&(i.C=!1,t.C=!0,Wy(this,t),i=t.R),i.L&&i.L.C||i.R&&i.R.C){i.R&&i.R.C||(i.L.C=!1,i.C=!0,Gy(this,i),i=t.R),i.C=t.C,t.C=i.R.C=!1,Wy(this,t),e=this._;break}}else if(i=t.L,i.C&&(i.C=!1,t.C=!0,Gy(this,t),i=t.L),i.L&&i.L.C||i.R&&i.R.C){i.L&&i.L.C||(i.R.C=!1,i.C=!0,Wy(this,i),i=t.L),i.C=t.C,t.C=i.L.C=!1,Gy(this,t),e=this._;break}i.C=!0,e=t,t=t.U}while(!e.C);e&&(e.C=!1)}}};var qP=[],FP=[],IP=1e-6,NP=1e-12,BP,WP,GP,YP,HP;yb.prototype={constructor:yb,polygons:function(){var e=this.edges;return this.cells.map(function(t){var n=t.halfedges.map(function(n){return tb(t,e[n])});return n.data=t.site.data,n})},triangles:function(){var e=[],t=this.edges;return this.cells.forEach(function(n,a){if(s=(o=n.halfedges).length)for(var i=n.site,d=-1,r=t[o[s-1]],l=r.left===i?r.right:r.left,o,s,f;++d<s;)f=l,r=t[o[d]],l=r.left===i?r.right:r.left,f&&l&&a<f.index&&a<l.index&&0>mb(i,f,l)&&e.push([i.data,f.data,l.data])}),e},links:function(){return this.edges.filter(function(e){return e.right}).map(function(e){return{source:e.left.data,target:e.right.data}})},find:function(e,t,a){// Use the previously-found cell, or start with an arbitrary one.
for(var i=this,d=i._found||0,r=i.cells.length,n,l;!(l=i.cells[d]);)if(++d>=r)return null;var o=e-l.site[0],s=t-l.site[1],f=o*o+s*s;// Traverse the half-edges to find a closer cell, if any.
do l=i.cells[n=d],d=null,l.halfedges.forEach(function(n){var a=i.edges[n],r=a.left;if(r!==l.site&&r||(r=a.right)){var o=e-r[0],s=t-r[1],c=o*o+s*s;c<f&&(f=c,d=r.index)}});while(null!==d);return i._found=n,null==a||f<=a*a?l.site:null}},_b.Definition={type:'Voronoi',metadata:{modifies:!0},params:[{name:'x',type:'field',required:!0},{name:'y',type:'field',required:!0},{name:'size',type:'number',array:!0,length:2},{name:'extent',type:'array',array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:'number',array:!0,length:2}},{name:'as',type:'string',default:'path'}]};var VP=W(_b,Dn),XP=[[-1e5,-1e5],[1e5,1e5]];VP.transform=function(e,t){var a=e.as||'path',d=t.source,r,l,o,s;// configure and construct voronoi diagram
for(r=bb().x(e.x).y(e.y),e.size?r.size(e.size):r.extent(e.extent||XP),this.value=r=r(d),l=r.polygons(),(o=0,s=d.length);o<s;++o)d[o][a]=l[o]?'M'+l[o].join('L')+'Z':null;return t.reflow(e.modified()).modifies(a)};var ZP=/*#__PURE__*/Object.freeze({voronoi:_b}),JP=aS/180,QP={archimedean:Sb,rectangular:function(e){var n=4*e[0]/e[1],a=0,i=0;return function(e){var t=0>e?-1:1;// See triangular numbers: T_n = n * (n + 1) / 2.
switch(3&dS(1+4*t*e)-t){case 0:a+=n;break;case 1:i+=4;break;case 2:a-=n;break;default:i-=4;}return[a,i]}}},KP=['x','y','font','fontSize','fontStyle','fontWeight','angle'],eM=['text','font','rotate','fontSize','fontStyle','fontWeight'];/*
  Copyright (c) 2013, Jason Davies.
  All rights reserved.

  Redistribution and use in source and binary forms, with or without
  modification, are permitted provided that the following conditions are met:

    * Redistributions of source code must retain the above copyright notice, this
      list of conditions and the following disclaimer.

    * Redistributions in binary form must reproduce the above copyright notice,
      this list of conditions and the following disclaimer in the documentation
      and/or other materials provided with the distribution.

    * The name Jason Davies may not be used to endorse or promote products
      derived from this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
  ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
  WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
  DISCLAIMED. IN NO EVENT SHALL JASON DAVIES BE LIABLE FOR ANY DIRECT, INDIRECT,
  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
  LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE
  OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF
  ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  */// Word cloud layout by Jason Davies, https://www.jasondavies.com/wordcloud/
// Algorithm due to Jonathan Feinberg, http://static.mrfeinberg.com/bv_ch03.pdf
Db.Definition={type:'Wordcloud',metadata:{modifies:!0},params:[{name:'size',type:'number',array:!0,length:2},{name:'font',type:'string',expr:!0,default:'sans-serif'},{name:'fontStyle',type:'string',expr:!0,default:'normal'},{name:'fontWeight',type:'string',expr:!0,default:'normal'},{name:'fontSize',type:'number',expr:!0,default:14},{name:'fontSizeRange',type:'number',array:'nullable',default:[10,50]},{name:'rotate',type:'number',expr:!0,default:0},{name:'text',type:'field'},{name:'spiral',type:'string',values:['archimedean','rectangular']},{name:'padding',type:'number',expr:!0},{name:'as',type:'string',array:!0,length:7,default:KP}]};var tM=W(Db,Dn);tM.transform=function(a,d){var r=a.modified();if(r||d.changed(d.ADD_REM)||eM.some(function(e){var t=a[e];return M(t)&&d.modified(t.fields)})){var l=d.materialize(d.SOURCE).source,o=this.value,s=a.as||KP,f=a.fontSize||14,c;// create font size scaling function as needed
if(M(f)?c=a.fontSizeRange:f=j(f),c){var u=f,p=uc('sqrt')().domain(Rb(u,l)).range(c);f=function(e){return p(u(e))}}l.forEach(function(e){e[s[0]]=NaN,e[s[1]]=NaN,e[s[3]]=0});for(// configure layout
var g=o.words(l).text(a.text).size(a.size||[500,500]).padding(a.padding||1).spiral(a.spiral||'archimedean').rotate(a.rotate||0).font(a.font||'sans-serif').fontStyle(a.fontStyle||'normal').fontWeight(a.fontWeight||'normal').fontSize(f).random(e.random).layout(),m=o.size(),h=m[0]>>1,y=m[1]>>1,b=0,_=g.length,n,x;b<_;++b)n=g[b],x=n.datum,x[s[0]]=n.x+h,x[s[1]]=n.y+y,x[s[2]]=n.font,x[s[3]]=n.size,x[s[4]]=n.style,x[s[5]]=n.weight,x[s[6]]=n.rotate;return d.reflow(r).modifies(s)}};var nM=/*#__PURE__*/Object.freeze({wordcloud:Db});Fb.Definition={type:'CrossFilter',metadata:{},params:[{name:'fields',type:'field',array:!0,required:!0},{name:'query',type:'array',array:!0,required:!0,content:{type:'number',array:!0,length:2}}]};var aM=W(Fb,Dn);aM.transform=function(e,t){if(!this._dims)return this.init(e,t);var n=e.modified('fields')||e.fields.some(function(e){return t.modified(e.fields)});return n?this.reinit(e,t):this.eval(e,t)},aM.init=function(e,t){// instantiate indices and dimensions
for(var n=e.fields,a=e.query,d=this._indices={},r=this._dims=[],l=a.length,o=0,s,f;o<l;++o)s=n[o].fname,f=d[s]||(d[s]=Ub()),r.push(Mb(f,o,a[o]));return this.eval(e,t)},aM.reinit=function(e,t){var a=t.materialize().fork(),d=e.fields,r=e.query,l=this._indices,o=this._dims,s=this.value,c=s.curr(),u=s.prev(),p=s.all(),g=a.rem=a.add,h=a.mod,y=r.length,m={},b,_,x,v,k,w,E,S,C;// set prev to current state
// if pulse has modified tuples, create an index map
if(u.set(c),t.rem.length&&(k=this.remove(e,t,a)),t.add.length&&s.add(t.add),t.mod.length)for(w={},v=t.mod,E=0,S=v.length;E<S;++E)w[v[E]._index]=1;// re-initialize indices as needed, update curr bitmap
for(E=0;E<y;++E)C=d[E],(!o[E]||e.modified('fields',E)||t.modified(C.fields))&&(x=C.fname,!(b=m[x])&&(l[x]=_=Ub(),m[x]=b=_.insert(C,t.source,0)),o[E]=Mb(_,E,r[E]).onAdd(b,c));// visit each tuple
// if filter state changed, push index to add/rem
// else if in mod and passes a filter, push index to mod
for(E=0,S=s.data().length;E<S;++E)if(k[E])// skip if removed tuple
continue;else u[E]===c[E]?w[E]&&c[E]!==p&&// otherwise, pass mods through
h.push(E):// add if state changed
g.push(E);return s.mask=(1<<y)-1,a},aM.eval=function(e,t){var n=t.materialize().fork(),a=this._dims.length,i=0;return t.rem.length&&(this.remove(e,t,n),i|=(1<<a)-1),e.modified('query')&&!e.modified('fields')&&(i|=this.update(e,t,n)),t.add.length&&(this.insert(e,t,n),i|=(1<<a)-1),t.mod.length&&(this.modify(t,n),i|=(1<<a)-1),this.value.mask=i,n},aM.insert=function(e,t,a){var i=t.add,d=this.value,r=this._dims,l=this._indices,o=e.fields,s={},f=a.add,c=d.size(),u=c+i.length,n=r.length,p,g,m;// resize bitmaps and add tuples as needed
d.resize(u,n),d.add(i);var h=d.curr(),y=d.prev(),b=d.all();// add to dimensional indices
for(p=0;p<n;++p)g=o[p].fname,m=s[g]||(s[g]=l[g].insert(o[p],i,c)),r[p].onAdd(m,h);// set previous filters, output if passes at least one filter
for(;c<u;++c)y[c]=b,h[c]!==b&&f.push(c)},aM.modify=function(e,t){var a=t.mod,d=this.value,r=d.curr(),l=d.all(),o=e.mod,s,f,c;for(s=0,f=o.length;s<f;++s)c=o[s]._index,r[c]!==l&&a.push(c)},aM.remove=function(e,t,a){var d=this._indices,r=this.value,l=r.curr(),o=r.prev(),s=r.all(),c={},u=a.rem,p=t.rem,g,m,h,y;// process tuples, output if passes at least one filter
for(g=0,m=p.length;g<m;++g)// build index map
h=p[g]._index,c[h]=1,o[h]=y=l[h],l[h]=s,y!==s&&u.push(h);// remove from dimensional indices
for(h in d)d[h].remove(m,c);return this.reindex(t,m,c),c},aM.reindex=function(e,t,n){var a=this._indices,i=this.value;e.runAfter(function(){var e=i.remove(t,n);for(var d in a)a[d].reindex(e)})},aM.update=function(e,t,n){var a=this._dims,d=e.query,r=t.stamp,l=a.length,o=0,s,f;// survey how many queries have changed
for(n.filters=0,f=0;f<l;++f)e.modified('query',f)&&(s=f,++o);if(1===o)// only one query changed, use more efficient update
o=a[s].one,this.incrementOne(a[s],d[s],n.add,n.rem);else// multiple queries changed, perform full record keeping
for(f=0,o=0;f<l;++f)// duplicate add/rem for downstream resolve
e.modified('query',f)&&(o|=a[f].one,this.incrementAll(a[f],d[f],r,n.add),n.rem=n.add);return o},aM.incrementAll=function(e,t,n,a){var d=this.value,r=d.seen(),l=d.curr(),o=d.prev(),s=e.index(),f=e.bisect(e.range),c=e.bisect(t),u=c[0],p=c[1],g=f[0],m=f[1],h=e.one,y,b,_;// Fast incremental update based on previous lo index.
if(u<g)for(y=u,b=iS(g,p);y<b;++y)_=s[y],r[_]!==n&&(o[_]=l[_],r[_]=n,a.push(_)),l[_]^=h;else if(u>g)for(y=g,b=iS(u,m);y<b;++y)_=s[y],r[_]!==n&&(o[_]=l[_],r[_]=n,a.push(_)),l[_]^=h;// Fast incremental update based on previous hi index.
if(p>m)for(y=fS(u,m),b=p;y<b;++y)_=s[y],r[_]!==n&&(o[_]=l[_],r[_]=n,a.push(_)),l[_]^=h;else if(p<m)for(y=fS(g,p),b=m;y<b;++y)_=s[y],r[_]!==n&&(o[_]=l[_],r[_]=n,a.push(_)),l[_]^=h;e.range=t.slice()},aM.incrementOne=function(e,t,n,a){var d=this.value,r=d.curr(),l=e.index(),o=e.bisect(e.range),s=e.bisect(t),f=s[0],c=s[1],u=o[0],p=o[1],g=e.one,m,h,y;// Fast incremental update based on previous lo index.
if(f<u)for(m=f,h=iS(u,c);m<h;++m)y=l[m],r[y]^=g,n.push(y);else if(f>u)for(m=u,h=iS(f,p);m<h;++m)y=l[m],r[y]^=g,a.push(y);// Fast incremental update based on previous hi index.
if(c>p)for(m=fS(f,p),h=c;m<h;++m)y=l[m],r[y]^=g,n.push(y);else if(c<p)for(m=fS(u,c),h=p;m<h;++m)y=l[m],r[y]^=g,a.push(y);e.range=t.slice()},Ib.Definition={type:'ResolveFilter',metadata:{},params:[{name:'ignore',type:'number',required:!0,description:'A bit mask indicating which filters to ignore.'},{name:'filter',type:'object',required:!0,description:'Per-tuple filter bitmaps from a CrossFilter transform.'}]};var iM=W(Ib,Dn);iM.transform=function(e,t){var n=~(e.ignore||0),// bit mask where zeros -> dims to ignore
a=e.filter,i=a.mask;// exit early if no relevant filter changes
if(0==(i&n))return t.StopPropagation;var d=t.fork(t.ALL),r=a.data(),l=a.curr(),o=a.prev(),s=function(e){return l[e]&n?null:r[e]};// propagate all mod tuples that pass the filter
// add filter to source data in case of reflow...
return d.filter(d.MOD,s),i&i-1?(d.filter(d.ADD,function(e){var t=l[e]&n,a=!t&&t^o[e]&n;return a?r[e]:null}),d.filter(d.REM,function(e){var t=l[e]&n,a=t&&!(t^(t^o[e]&n));return a?r[e]:null})):(d.filter(d.ADD,s),d.filter(d.REM,function(e){return(l[e]&n)===i?r[e]:null})),d.filter(d.SOURCE,function(e){return s(e._index)})};var dM=/*#__PURE__*/Object.freeze({crossfilter:Fb,resolvefilter:Ib}),xf={trap:!1},rM=['value','update','init','react','bind'];E_.prototype.visit=function(e){var t=this,a,d,r;if(e(t))return 1;for(a=S_(t),d=0,r=a.length;d<r;++d)if(a[d].visit(e))return 1};var lM,oM,sM,fM,cM;lM={},lM[1]='Boolean',lM[2]='<end>',lM[3]='Identifier',lM[4]='Keyword',lM[5]='Null',lM[6]='Numeric',lM[7]='Punctuator',lM[8]='String',lM[9]='RegularExpression';var uM=/[--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------]/,pM=/[--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------]/,gM={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1},mM={if:1,this:1},hM={NaN:'NaN',E:'Math.E',LN2:'Math.LN2',LN10:'Math.LN10',LOG2E:'Math.LOG2E',LOG10E:'Math.LOG10E',PI:'Math.PI',SQRT1_2:'Math.SQRT1_2',SQRT2:'Math.SQRT2',MIN_VALUE:'Number.MIN_VALUE',MAX_VALUE:'Number.MAX_VALUE'},yM={},bM=new Date(2e3,0,1),_M='undefined'!=typeof window&&window||null,xM=Xx('area',function(e){return xA.reset(),rp(e,vA),2*xA}),vM=Xx('bounds',Dp),kM=Xx('centroid',qp),wM={},EM={E_union:function(e,t){if(!e.length)return t;for(var a=0,d=t.length;a<d;++a)0>e.indexOf(t[a])&&e.push(t[a]);return e},E_intersect:function(e,t){return e.length?e.filter(function(e){return 0<=t.indexOf(e)}):t},R_union:function(e,t){var n=c(t[0]),a=c(t[1]);return(n>a&&(n=t[1],a=t[0]),!e.length)?[n,a]:(e[0]>n&&(e[0]=n),e[1]<a&&(e[1]=a),e)},R_intersect:function(e,t){var n=c(t[0]),a=c(t[1]);return(n>a&&(n=t[1],a=t[0]),!e.length)?[n,a]:a<e[0]||e[1]<n?[]:(e[0]<n&&(e[0]=n),e[1]>a&&(e[1]=a),e)}},SM={random:function(){return e.random()},// override default
isArray:hS,isBoolean:G,isDate:Y,isNumber:H,isObject:g,isRegExp:V,isString:m,isTuple:oe,toBoolean:K,toDate:te,toNumber:c,toString:ne,pad:Q,peek:f,truncate:ie,rgb:gs,lab:ws,hcl:$s,hsl:_s,sequence:Hn,format:Mx,utcFormat:jx,utcParse:Fx,timeFormat:Ux,timeParse:qx,monthFormat:function(e){return Ix(e,1,'%B')},monthAbbrevFormat:function(e){return Ix(e,1,'%b')},dayFormat:function(e){return Ix(0,2+e,'%A')},dayAbbrevFormat:function(e){return Ix(0,2+e,'%a')},quarter:function(e){return 1+~~(new Date(e).getMonth()/3)},utcquarter:function(e){return 1+~~(new Date(e).getUTCMonth()/3)},warn:function(){return Bx(this.context.dataflow,'warn',arguments)},info:function(){return Bx(this.context.dataflow,'info',arguments)},debug:function(){return Bx(this.context.dataflow,'debug',arguments)},extent:function(e){var t=0,a,d,r,l;if(e&&(a=e.length)){// find first valid value
for(d=e[t];null==d||d!==d;d=e[++t]);// visit all other values
for(r=l=d;t<a;++t)d=e[t],null!=d&&(d<r&&(r=d),d>l&&(l=d))}return[r,l]},inScope:function(e){var t=this.context.group,n=!1;if(t)for(;e;){if(e===t){n=!0;break}e=e.mark.group}return n},clampRange:function(e,t,n){var a=e[0],i=e[1],d;return i<a&&(d=i,i=a,a=d),d=i-a,d>=n-t?[t,n]:[a=iS(fS(a,t),n-d),a+d]},pinchDistance:function(e){var n=e.touches,t=n[0].clientX-n[1].clientX,a=n[0].clientY-n[1].clientY;return dS(t*t+a*a)},pinchAngle:function(e){var n=e.touches;return JE(n[0].clientY-n[1].clientY,n[0].clientX-n[1].clientX)},screen:function(){return _M?_M.screen:{}},containerSize:function(){var e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[void 0,void 0]},windowSize:function(){return _M?[_M.innerWidth,_M.innerHeight]:[void 0,void 0]},span:function(e){return e[e.length-1]-e[0]||0},merge:function(){var e=[].slice.call(arguments);return e.unshift({}),F.apply(null,e)},flush:function(e,n,i,d,o,s){if(!i&&0!==i)return s;var c=e[0],u=f(e),p=+i,t,g;// swap endpoints if range is reversed
// adjust if value within threshold distance of endpoint
return u<c&&(t=c,c=u,u=t),t=lS(n-c),g=lS(u-n),t<g&&t<=p?d:g<=p?o:s},bandspace:Hx,inrange:Nx,setdata:function(e,t){var n=this.context.dataflow,a=this.context.data[e],i=a.input;return n.pulse(i,n.changeset().remove(_S).insert(t)),1},pathShape:function(e){var t=null;return function(n){return n?Fd(n,t=t||Md(e)):e}},panLinear:S,panLog:z,panPow:R,zoomLinear:O,zoomLog:T,zoomPow:L,encode:function(e,t,n){if(e){var a=this.context.dataflow,i=e.mark.source;a.pulse(i,a.changeset().encode(e,t))}return n===void 0?e:n},modify:av},CM=['view','item','group','xy','x','y']// event functions
// event function prefix
,// function context prefix
zM={};// Error messages should be identical to V8.
// See also tools/generate-unicode-regex.py.
_v('bandwidth',function(e,t){var n=Wx(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0},Yx),_v('copy',function(e,t){var n=Wx(e,(t||this).context);return n?n.copy():void 0},Yx),_v('domain',function(e,t){var n=Wx(e,(t||this).context);return n?n.domain():[]},Yx),_v('range',function(e,t){var n=Wx(e,(t||this).context);return n&&n.range?n.range():[]},Yx),_v('invert',function(e,t,n){var a=Wx(e,(n||this).context);return a?hS(t)?(a.invertRange||a.invert)(t):(a.invert||a.invertExtent)(t):void 0},Yx),_v('scale',function(e,t,n){var a=Wx(e,(n||this).context);return a?a(t):void 0},Yx),_v('gradient',Vx,Yx),_v('geoArea',xM,Yx),_v('geoBounds',vM,Yx),_v('geoCentroid',kM,Yx),_v('geoShape',function(e,t,n){var a=Wx(e,(n||this).context);return function(e){return a?a.path.context(e)(t):''}},Yx),_v('indata',function(e,t,n){var a=this.context.data[e]['index:'+t],i=a?a.value.get(n):void 0;return i?i.count:i},function(e,t,n,a){t[0].type!=='Literal'&&u('First argument to indata must be a string literal.'),t[1].type!=='Literal'&&u('Second argument to indata must be a string literal.');var i=t[0].value,d=t[1].value,r='@'+d;a.hasOwnProperty(r)||(a[r]=n.getData(i).indataRef(n,d))}),_v('data',Zx,Jx),_v('treePath',function(e,n,a){var i=Kx(e,this),d=i[n],r=i[a];return d&&r?d.path(r).map(Qx):void 0},Jx),_v('treeAncestors',function(e,t){var a=Kx(e,this)[t];return a?a.ancestors().map(Qx):void 0},Jx),_v('vlSelectionTest',dv,rv),_v('vlSelectionResolve',lv,rv),_v('vlSingle',cv,Jx),_v('vlSingleDomain',pv,Jx),_v('vlMulti',cv,uv),_v('vlMultiDomain',pv,uv),_v('vlInterval',function(e,t,n){return fv.call(this,e,t,n,sv)},Jx),_v('vlIntervalDomain',gv,Jx);var DM={blacklist:['_'],whitelist:['datum','event','item'],fieldvar:'datum',globalvar:function(e){return'_['+h('$'+e)+']'},functions:function(e){var t=Ax(e);for(var n in CM.forEach(function(e){t[e]='event.vega.'+e}),SM)t[n]='this.'+n;return t},constants:hM,visitors:zM},RM=Lx(DM),$M={$tupleid:1,toString:function(){return':_tupleid_:'}},OM=Sv('key'),TM='view',AM=/[[\]{}]/,LM={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},PM=Qv('aggregate'),MM=Qv('axisticks'),UM=Qv('bound'),jM=Qv('collect'),qM=Qv('compare'),FM=Qv('datajoin'),IM=Qv('encode'),NM=Qv('expression'),BM=Qv('facet'),WM=Qv('field'),GM=Qv('key'),YM=Qv('legendentries'),HM=Qv('load'),VM=Qv('mark'),XM=Qv('multiextent'),ZM=Qv('multivalues'),JM=Qv('overlap'),QM=Qv('params'),KM=Qv('prefacet'),eU=Qv('projection'),tU=Qv('proxy'),nU=Qv('relay'),aU=Qv('render'),iU=Qv('scale'),dU=Qv('sieve'),rU=Qv('sortitems'),lU=Qv('viewlayout'),oU=Qv('values'),sU=0,fU=['identity','ordinal','band','point','bin-linear','bin-ordinal','quantize','quantile','threshold','linear','pow','sqrt','log','sequential','time','utc'],cU=ae(fU),uU=ae(fU.slice(4,9)),pU=ae(fU.slice(9)),gU=ae(fU.slice(1,6)),mU=['size','shape','fill','stroke','strokeDash','opacity'],hU={name:1,interactive:1},yU=ae(['rule']),bU=ae(['group','image','rect']),_U={value:0},xU,vU;// Encoding channels supported by legends
// In priority order of 'canonical' scale
Ew.fromEntries=function(e,t){var a=t.length,n=1,d=t[0],r=t[a-1],l=t[a-2],o=null;// add operator entries to this scope, wire up pulse chain
for(e.add(t[0]);n<a;++n)t[n].params.pulse=Ev(t[n-1]),e.add(t[n]),'aggregate'===t[n].type&&(o=t[n]);return new Ew(e,d,l,r,o)};var kU=Ew.prototype;kU.countsRef=function(e,t,n){var i=this,d=i.counts||(i.counts={}),r=Sw(t),l,o,s;return null!=r&&(e=i.scope,l=d[r]),l?n&&n.field&&Cw(e,l.agg.params,n):(s={groupby:e.fieldRef(t,'key'),pulse:Ev(i.output)},n&&n.field&&Cw(e,s,n),o=e.add(PM(s)),l=e.add(jM({pulse:Ev(o)})),l={agg:o,ref:Ev(l)},null!=r&&(d[r]=l)),l.ref},kU.tuplesRef=function(){return Ev(this.values)},kU.extentRef=function(e,t){return zw(e,this,'extent','extent',t,!1)},kU.domainRef=function(e,t){return zw(e,this,'domain','values',t,!1)},kU.valuesRef=function(e,t,n){return zw(e,this,'vals','values',t,n||!0)},kU.lookupRef=function(e,t){return zw(e,this,'lookup','tupleindex',t,!1)},kU.indataRef=function(e,t){return zw(e,this,'indata','tupleindex',t,!0,!0)};var wU=qw(h('left'),h('right'),h('center')),EU=qw('+(item.orient==="right")','+(item.orient!=="left")','0.5'),SU=ae(['width','height','padding','autosize']),CU=aE.prototype=iE.prototype;// multiplication factor for anchor positioning
// ----
CU.fork=function(){return new iE(this)},CU.isSubscope=function(){return 0<this._subid},CU.toRuntime=function(){return this.finish(),{background:this.background,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig}},CU.id=function(){return(this._subid?this._subid+':':0)+this._id++},CU.add=function(e){return this.operators.push(e),e.id=this.id(),e.refs&&(e.refs.forEach(function(t){t.$ref=e.id}),e.refs=null),e},CU.proxy=function(e){var t=e instanceof vv?Ev(e):e;return this.add(tU({value:t}))},CU.addStream=function(e){return this.streams.push(e),e.id=this.id(),e},CU.addUpdate=function(e){return this.updates.push(e),e},CU.finish=function(){// annotate data sets
function e(e,t,n){var a,i;e&&(a=e.data||(e.data={}),i=a[t]||(a[t]=[]),i.push(n))}var t,n;// annotate root
// annotate signals
for(t in this.root&&(this.root.root=!0),this.signals)this.signals[t].signal=t;// annotate scales
for(t in this.scales)this.scales[t].scale=t;for(t in this.data)for(var a in n=this.data[t],e(n.input,t,'input'),e(n.output,t,'output'),e(n.values,t,'values'),n.index)e(n.index[a],t,'index:'+a);return this},CU.pushState=function(e,t,n){this._encode.push(Ev(this.add(dU({pulse:e})))),this._parent.push(t),this._lookup.push(n?Ev(this.proxy(n)):null),this._markpath.push(-1)},CU.popState=function(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},CU.parent=function(){return f(this._parent)},CU.encode=function(){return f(this._encode)},CU.lookup=function(){return f(this._lookup)},CU.markpath=function(){var e=this._markpath;return++e[e.length-1]},CU.fieldRef=function(e,t){if(m(e))return Sv(e,t);e.signal||u('Unsupported field reference: '+h(e));var n=e.signal,a=this.field[n],i;return a||(i={name:this.signalRef(n)},t&&(i.as=t),this.field[n]=a=Ev(this.add(WM(i)))),a},CU.compareRef=function(e,t){function n(e){return $v(e)?(i=!0,a.signalRef(e.signal)):e}var a=this,i=!1,d=P(e.field).map(n),r=P(e.order).map(n);return t&&d.push($M),i?Ev(this.add(qM({fields:d,orders:r}))):Cv(d,r)},CU.keyRef=function(e,t){var n=this.signals,a=!1;return e=P(e).map(function(e){return $v(e)?(a=!0,Ev(n[e.signal])):e}),a?Ev(this.add(GM({fields:e,flat:t}))):zv(e,t)},CU.sortRef=function(e){if(!e)return e;// including id ensures stable sorting
var t=[Rv(e.op,e.field),$M],n=e.order||'ascending';return n.signal?Ev(this.add(qM({fields:t,orders:[n=this.signalRef(n.signal),n]}))):Cv(t,[n,n])},CU.event=function(e,t){var n=e+':'+t;if(!this.events[n]){var a=this.id();this.streams.push({id:a,source:e,type:t}),this.events[n]=a}return this.events[n]},CU.addSignal=function(e,t){this.signals.hasOwnProperty(e)&&u('Duplicate signal name: '+h(e));var n=t instanceof vv?t:this.add(wv(t));return this.signals[e]=n},CU.getSignal=function(e){return this.signals[e]||u('Unrecognized signal name: '+h(e)),this.signals[e]},CU.signalRef=function(e){return this.signals[e]?Ev(this.signals[e]):(this.lambdas.hasOwnProperty(e)||(this.lambdas[e]=this.add(wv(null))),Ev(this.lambdas[e]))},CU.parseLambdas=function(){for(var t=Object.keys(this.lambdas),a=0,d=t.length;a<d;++a){var n=t[a],r=xv(n,this),e=this.lambdas[n];e.params=r.$params,e.update=r.$expr}},CU.property=function(e){return e&&e.signal?this.signalRef(e.signal):e},CU.objectProperty=function(e){return e&&g(e)?this.signalRef(e.signal||dE(e)):e},CU.exprRef=function(e,t){var n={expr:xv(e,this)};return t&&(n.expr.$name=t),Ev(this.add(NM(n)))},CU.addBinding=function(e,t){this.bindings||u('Nested signals do not support binding: '+h(e)),this.bindings.push(F({signal:e},t))},CU.addScaleProj=function(e,t){this.scales.hasOwnProperty(e)&&u('Duplicate scale or projection name: '+h(e)),this.scales[e]=this.add(t)},CU.addScale=function(e,t){this.addScaleProj(e,iU(t))},CU.addProjection=function(e,t){this.addScaleProj(e,eU(t))},CU.getScale=function(e){return this.scales[e]||u('Unrecognized scale name: '+h(e)),this.scales[e]},CU.projectionRef=CU.scaleRef=function(e){return Ev(this.getScale(e))},CU.projectionType=CU.scaleType=function(e){return this.getScale(e).params.type},CU.addData=function(e,t){return this.data.hasOwnProperty(e)&&u('Duplicate data set name: '+h(e)),this.data[e]=t},CU.getData=function(e){return this.data[e]||u('Undefined data set name: '+h(e)),this.data[e]},CU.addDataPipeline=function(e,t){return this.data.hasOwnProperty(e)&&u('Duplicate data set name: '+h(e)),this.addData(e,Ew.fromEntries(this,t))};var zU=[{key:'$ref',parse:function(e,t){return t.get(e.$ref)||u('Operator not defined: '+e.$ref)}},{key:'$key',parse:function(e,t){var n='k:'+e.$key+'_'+!!e.$flat;return t.fn[n]||(t.fn[n]=X(e.$key,e.$flat))}},{key:'$expr',parse:function(e,t,n){e.$params&&hE(e.$params,t,n);var a='e:'+e.$expr+'_'+e.$name;return t.fn[a]||(t.fn[a]=r(uE(e.$expr,t),e.$fields,e.$name))}},{key:'$field',parse:function(e,n){if(!e.$field)return null;var a='f:'+e.$field+'_'+e.$name;return n.fn[a]||(n.fn[a]=t(e.$field,e.$name))}},{key:'$encode',parse:function(e,t){var n=e.$encode,a={},i,d;for(i in n)d=n[i],a[i]=r(mE(d.$expr,t),d.$fields),a[i].output=d.$output;return a}},{key:'$compare',parse:function(e,t){var n='c:'+e.$compare+'_'+e.$order,a=P(e.$compare).map(function(e){return e&&e.$tupleid?se:e});return t.fn[n]||(t.fn[n]=U(a,e.$order))}},{key:'$context',parse:function(e,t){return t}},{key:'$subflow',parse:function(e,t){var n=e.$subflow;return function(e,a,i){var d=SE(n,t.fork()),r=d.get(n.operators[0].id),l=d.signals.parent;return l&&l.set(i),r}}},{key:'$tupleid',parse:function(){return se}}],DU={skip:!0};zE.prototype=DE.prototype={fork:function(){var e=new DE(this);return(this.subcontext||(this.subcontext=[])).push(e),e},get:function(e){return this.nodes[e]},set:function(e,t){return this.nodes[e]=t},add:function(e,t){var n=this,a=n.dataflow,i;if(n.set(e.id,t),xE(e.type)&&(i=e.value)&&(i.$ingest?a.ingest(t,i.$ingest,i.$format):i.$load?n.get(i.$load.$ref).target=t:i.$request?a.request(t,i.$request,i.$format):a.pulse(t,a.changeset().insert(i))),e.root&&(n.root=t),e.parent){var d=n.get(e.parent.$ref);d?(a.connect(d,[t]),t.targets().add(d)):(n.unresolved=n.unresolved||[]).push(function(){d=n.get(e.parent.$ref),a.connect(d,[t]),t.targets().add(d)})}if(e.signal&&(n.signals[e.signal]=t),e.scale&&(n.scales[e.scale]=t),e.data)for(var r in e.data)i=n.data[r]||(n.data[r]={}),e.data[r].forEach(function(e){i[e]=t})},resolve:function(){return(this.unresolved||[]).forEach(function(e){e()}),delete this.unresolved,this},operator:function(e,t){this.add(e,this.dataflow.add(e.value,t))},transform:function(e,t){this.add(e,this.dataflow.add(this.transforms[bE(t)]))},stream:function(e,t){this.set(e.id,t)},update:function(e,t,n,a,i){this.dataflow.on(t,n,a,i,e.options)},getState:function(e){var t=this,n={};if(e.signals){var a=n.signals={};Object.keys(t.signals).forEach(function(n){var i=t.signals[n];e.signals(n,i)&&(a[n]=i.value)})}if(e.data){var i=n.data={};Object.keys(t.data).forEach(function(n){var a=t.data[n];e.data(n,a)&&(i[n]=a.input.value)})}return t.subcontext&&!1!==e.recurse&&(n.subcontext=t.subcontext.map(function(t){return t.getState(e)})),n},setState:function(e){var t=this,n=t.dataflow,a=e.data,i=e.signals;Object.keys(i||{}).forEach(function(e){n.update(t.signals[e],i[e],DU)}),Object.keys(a||{}).forEach(function(e){n.pulse(t.data[e].input,n.changeset().remove(_S).insert(a[e]))}),(e.subcontext||[]).forEach(function(e,n){var a=t.subcontext[n];a&&a.setState(e)})}};var RU={skip:!0},$U=W(FE,Cn);// -- DATAFLOW / RENDERING ----
// -- GET / SET ----
// -- SIZING ----
// -- EVENT HANDLING ----
// -- DATA ----
// -- SCALES --
// -- INITIALIZATION ----
// -- HEADLESS RENDERING ----
// -- SAVE / RESTORE STATE ----
// -- Transforms -----
$U.run=function(e){if(Cn.prototype.run.call(this,e),this._pending)this.resize();else if(this._redraw||this._resize)// render as needed
try{this.render()}catch(t){this.error(t)}return this},$U.render=function(){return this._renderer&&(this._resize&&(this._resize=0,Xb(this)),this._renderer.render(this._scenegraph.root)),this._redraw=!1,this},$U.dirty=function(e){this._redraw=!0,this._renderer&&this._renderer.dirty(e)},$U.container=function(){return this._el},$U.scenegraph=function(){return this._scenegraph},$U.origin=function(){return this._origin.slice()},$U.signal=function(e,t,n){var a=IE(this,e);return 1===arguments.length?a.value:this.update(a,t,n)},$U.background=function(e){return arguments.length?(this._background=e,this._resize=1,this):this._background},$U.width=function(e){return arguments.length?this.signal('width',e):this.signal('width')},$U.height=function(e){return arguments.length?this.signal('height',e):this.signal('height')},$U.padding=function(e){return arguments.length?this.signal('padding',e):this.signal('padding')},$U.autosize=function(e){return arguments.length?this.signal('autosize',e):this.signal('autosize')},$U.renderer=function(e){return arguments.length?(Zl(e)||u('Unrecognized renderer type: '+e),e!==this._renderType&&(this._renderType=e,this._resetRenderer()),this):this._renderType},$U.tooltip=function(e){return arguments.length?(e!==this._tooltip&&(this._tooltip=e,this._resetRenderer()),this):this._tooltip},$U.loader=function(e){return arguments.length?(e!==this._loader&&(Cn.prototype.loader.call(this,e),this._resetRenderer()),this):this._loader},$U.resize=function(){// touch autosize signal to ensure top-level ViewLayout runs
return this._autosize=1,this.touch(IE(this,'autosize'))},$U._resetRenderer=function(){this._renderer&&(this._renderer=null,this.initialize(this._el))},$U._resizeView=function(e,t,n,a,i,d){this.runAfter(function(r){var l=0;// reset autosize flag
r._autosize=0,r.width()!==n&&(l=1,r.signal('width',n,RU),r._resizeWidth.skip(!0)),r.height()!==a&&(l=1,r.signal('height',a,RU),r._resizeHeight.skip(!0)),r._viewWidth!==e&&(r._resize=1,r._viewWidth=e),r._viewHeight!==t&&(r._resize=1,r._viewHeight=t),(r._origin[0]!==i[0]||r._origin[1]!==i[1])&&(r._resize=1,r._origin=i),l&&r.run('enter'),d&&r.runAfter(function(){r.resize()})},!1,1)},$U.addEventListener=function(e,t,n){var a=t;return n&&!1===n.trap||(a=p_(this,t),a.raw=t),this._handler.on(e,a),this},$U.removeEventListener=function(e,n){// search registered handlers, remove if match found
for(var a=this._handler.handlers(e),d=a.length,r,l;0<=--d;)if(l=a[d].type,r=a[d].handler,e===l&&(n===r||n===r.raw)){this._handler.off(l,r);break}return this},$U.addResizeListener=function(e){var t=this._resizeListeners;return 0>t.indexOf(e)&&t.push(e),this},$U.removeResizeListener=function(e){var t=this._resizeListeners,n=t.indexOf(e);return 0<=n&&t.splice(n,1),this},$U.addSignalListener=function(e,t){return BE(this,e,IE(this,e),t)},$U.removeSignalListener=function(e,t){return WE(this,IE(this,e),t)},$U.addDataListener=function(e,t){return BE(this,e,Wb(this,e).values,t)},$U.removeDataListener=function(e,t){return WE(this,Wb(this,e).values,t)},$U.preventDefault=function(e){return arguments.length?(this._preventDefault=e,this):this._preventDefault},$U.timer=function(e,t){this._timers.push(fh(function(t){e({timestamp:Date.now(),elapsed:t})},t))},$U.events=function(t,a,d){var r=this,l=new xe(d),e=function(n,e){t==='view'&&Kb(r,a)&&n.preventDefault();try{l.receive(Zb(r,n,e))}catch(e){r.error(e)}finally{r.run()}},o;if(t==='timer')r.timer(e,a);else if('view'===t)// send traps errors, so use {trap: false} option
r.addEventListener(a,e,xf);else if('window'===t?'undefined'!=typeof window&&(o=[window]):'undefined'!=typeof document&&(o=document.querySelectorAll(t)),!o)r.warn('Can not resolve event source: '+t);else{for(var s=0,f=o.length;s<f;++s)o[s].addEventListener(a,e);r._eventListeners.push({type:a,sources:o,handler:e})}return l},$U.finalize=function(){var t=this._tooltip,a=this._timers,i=this._eventListeners,d,r,l;for(d=a.length;0<=--d;)a[d].stop();for(d=i.length;0<=--d;)for(l=i[d],r=l.sources.length;0<=--r;)l.sources[r].removeEventListener(l.type,l.handler);return t&&t.call(this,this._handler,null,null,null),this},$U.hover=function(e,t){return e=[e||'hover'],t=[t||'update',e[0]],this.on(this.events('view','mouseover',e_),t_,n_(e)),this.on(this.events('view','mouseout',e_),t_,n_(t)),this},$U.data=function(e){return Wb(this,e).values.value},$U.change=Gb,$U.insert=function(e,t){return Gb.call(this,e,he().insert(t))},$U.remove=function(e,t){return Gb.call(this,e,he().remove(t))},$U.scale=function(e){var t=this._runtime.scales;return t.hasOwnProperty(e)||u('Unrecognized scale or projection: '+e),t[e].value},$U.initialize=function(e,t){var n=this,a=n._renderType,i=Zl(a),d,r;// containing dom element
return e=n._el=e?m_(n,e):null,i||n.error('Unrecognized renderer type: '+a),d=i.handler||El,r=e?i.renderer:i.headless,n._renderer=r?u_(n,n._renderer,e,r):null,n._handler=g_(n,n._handler,e,d),n._redraw=!0,e&&(t=t?m_(n,t):e.appendChild(a_('div',{class:'vega-bindings'})),n._bind.forEach(function(e){e.param.element&&(e.element=m_(n,e.param.element))}),n._bind.forEach(function(e){i_(n,e.element||t,e)})),n},$U.toImageURL=function(e,t){return e!==SR.Canvas&&e!==SR.SVG&&e!==SR.PNG?Promise.reject('Unrecognized image type: '+e):h_(this,e,t).then(function(t){return e===SR.SVG?y_(t.svg(),'image/svg+xml'):t.canvas().toDataURL('image/png')})},$U.toCanvas=function(e){return h_(this,SR.Canvas,e).then(function(e){return e.canvas()})},$U.toSVG=function(e){return h_(this,SR.SVG,e).then(function(e){return e.svg()})},$U.getState=function(e){return this._runtime.getState(e||{data:AE,signals:LE,recurse:!0})},$U.setState=function(e){var t=this;return t.runAfter(function(){t._trigger=!1,t._runtime.setState(e),t.run().runAfter(function(){t._trigger=!0})}),this},F(ZC,Nz,jR,jT,QL,yP,jP,ZP,nM,dM),e.version='4.4.0',e.Dataflow=Cn,e.EventStream=xe,e.Parameters=ye,e.Pulse=yn,e.MultiPulse=vn,e.Operator=be,e.Transform=Dn,e.changeset=he,e.ingest=ce,e.isTuple=oe,e.definition=Rn,e.transform=$n,e.transforms=ZC,e.tupleid=se,e.scale=uc,e.scheme=Sc,e.schemeDiscretized=function(e,t,n){return 1<arguments.length?(_[e]=t,xT[e]=n||m$(f(t)),this):_.hasOwnProperty(e)?_[e]:void 0},e.interpolate=hc,e.interpolateRange=pc,e.timeInterval=Cc,e.utcInterval=zc,e.projection=bm,e.View=FE,e.parse=function(e,t){return g(e)||u('Input Vega specification must be an object.'),nE(e,new aE(oE([t,e.config]))).toRuntime()},e.expressionFunction=_v,e.formatLocale=Af,e.timeFormatLocale=cn,e.runtime=SE,e.runtimeContext=CE,e.bin=qn,e.bootstrapCI=oa,e.quartiles=sa,e.setRandom=function(t){e.random=t},e.randomInteger=function(t,n){null==n&&(n=t,t=0);var i={},r,l,o;return i.min=function(e){return arguments.length?(r=e||0,o=l-r,i):r},i.max=function(e){return arguments.length?(l=e||0,o=l-r,i):l},i.sample=function(){return r+sS(o*e.random())},i.pdf=function(e){return e===sS(e)&&e>=r&&e<l?1/o:0},i.cdf=function(e){var t=sS(e);return t<r?0:t>=l?1:(t-r+1)/o},i.icdf=function(e){return 0<=e&&1>=e?r-1+sS(e*o):NaN},i.min(t).max(n)},e.randomKDE=ca,e.randomMixture=pa,e.randomNormal=fa,e.randomUniform=ga,e.accessor=r,e.accessorName=o,e.accessorFields=s,e.id=bS,e.identity=id,e.zero=el,e.one=dy,e.truthy=_S,e.falsy=xS,e.logger=a,e.None=0,e.Error=1,e.Warn=2,e.Info=3,e.Debug=4,e.panLinear=S,e.panLog=z,e.panPow=R,e.zoomLinear=O,e.zoomLog=T,e.zoomPow=L,e.array=P,e.compare=U,e.constant=j,e.debounce=q,e.error=u,e.extend=F,e.extentIndex=I,e.fastmap=N,e.field=t,e.inherits=W,e.isArray=hS,e.isBoolean=G,e.isDate=Y,e.isFunction=M,e.isNumber=H,e.isObject=g,e.isRegExp=V,e.isString=m,e.key=X,e.merge=Z,e.pad=Q,e.peek=f,e.repeat=J,e.splitAccessPath=p,e.stringValue=h,e.toBoolean=K,e.toDate=te,e.toNumber=c,e.toString=ne,e.toSet=ae,e.truncate=ie,e.visitArray=de,e.loader=ke,e.read=un,e.inferType=d,e.inferTypes=l,e.typeParsers=OS,e.format=jS,e.formats=Ze,e.Bounds=Ei,e.Gradient=Si,e.GroupItem=zi,e.ResourceLoader=Li,e.Item=Ci,e.Scenegraph=ul,e.Handler=vl,e.Renderer=wl,e.CanvasHandler=El,e.CanvasRenderer=Rl,e.SVGHandler=Tl,e.SVGRenderer=Ml,e.SVGStringRenderer=Yl,e.RenderType=SR,e.renderModule=Zl,e.Marks=nR,e.boundClip=Jl,e.boundContext=cr,e.boundStroke=fr,e.boundItem=ll,e.boundMark=ol,e.pathCurves=Pd,e.pathSymbols=Nd,e.pathRectangle=Xd,e.pathTrail=Zd,e.pathParse=Md,e.pathRender=Fd,e.point=_l,e.domCreate=gl,e.domFind=ml,e.domChild=hl,e.domClear=yl,e.openTag=Ll,e.closeTag=Pl,e.font=il,e.fontFamily=al,e.fontSize=Qr,e.textMetrics=XD,e.resetSVGClipId=function(){qD=1},e.sceneEqual=Ql,e.pathEqual=Kl,e.sceneToJSON=sl,e.sceneFromJSON=fl,e.sceneZOrder=_r,e.sceneVisit=xr,e.scenePickVisit=vr,Object.defineProperty(e,'__esModule',{value:!0})});
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.vl={})}(this,function(e){"use strict";function t(e,t,n){return e.fields=t||[],e.fname=n,e}function l(e){throw Error(e)}function o(e){var t,n,r,i=[],a=null,o=0,u=e.length,c="";function s(){i.push(c+e.substring(t,n)),c="",t=n+1}for(e+="",t=n=0;n<u;++n)if("\\"===(r=e[n]))c+=e.substring(t,n),t=++n;else if(r===a)s(),a=null,o=-1;else{if(a)continue;t===o&&'"'===r?(t=n+1,a=r):t===o&&"'"===r?(t=n+1,a=r):"."!==r||o?"["===r?(t<n&&s(),o=t=n+1):"]"===r&&(o||l("Access path missing open bracket: "+e),0<o&&s(),o=0,t=n+1):t<n?s():t=n+1}return o&&l("Access path missing closing bracket: "+e),a&&l("Access path missing closing quote: "+e),t<n&&(n++,s()),i}var v=Array.isArray;function S(e){return e===Object(e)}function y(e){return"string"==typeof e}function k(e){return v(e)?"["+e.map(k)+"]":S(e)||y(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}var n,r,i,a,u=[];i=o(n="id"),a="return _["+i.map(k).join("][")+"];",t(Function("_",a),[n=1===i.length?i[0]:n],r||n),t(function(e){return e},u,"identity"),t(function(){return 0},u,"zero"),t(function(){return 1},u,"one"),t(function(){return!0},u,"true"),t(function(){return!1},u,"false");function c(e,t,n){var r=[t].concat([].slice.call(n));console[e].apply(console,r)}var s=0,f=1,d=2,p=3,h=4;function m(e){return"boolean"==typeof e}function x(e){return"number"==typeof e}function g(e){for(var t={},n=0,r=e.length;n<r;++n)t[e[n]]=!0;return t}var b,E,w,N,O={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},_=function(e){throw{name:"SyntaxError",message:e,at:b,text:w}},T=function(e){return e&&e!==E&&_("Expected '"+e+"' instead of '"+E+"'"),E=w.charAt(b),b+=1,E},C=function(){var e,t="";for("-"===E&&T(t="-");"0"<=E&&E<="9";)t+=E,T();if("."===E)for(t+=".";T()&&"0"<=E&&E<="9";)t+=E;if("e"===E||"E"===E)for(t+=E,T(),"-"!==E&&"+"!==E||(t+=E,T());"0"<=E&&E<="9";)t+=E,T();if(e=+t,isFinite(e))return e;_("Bad number")},A=function(){var e,t,n,r="";if('"'===E)for(;T();){if('"'===E)return T(),r;if("\\"===E)if(T(),"u"===E){for(t=n=0;t<4&&(e=parseInt(T(),16),isFinite(e));t+=1)n=16*n+e;r+=String.fromCharCode(n)}else{if("string"!=typeof O[E])break;r+=O[E]}else r+=E}_("Bad string")},D=function(){for(;E&&E<=" ";)T()};N=function(){switch(D(),E){case"{":return function(){var e,t={};if("{"===E){if(T("{"),D(),"}"===E)return T("}"),t;for(;E;){if(e=A(),D(),T(":"),Object.hasOwnProperty.call(t,e)&&_('Duplicate key "'+e+'"'),t[e]=N(),D(),"}"===E)return T("}"),t;T(","),D()}}_("Bad object")}();case"[":return function(){var e=[];if("["===E){if(T("["),D(),"]"===E)return T("]"),e;for(;E;){if(e.push(N()),D(),"]"===E)return T("]"),e;T(","),D()}}_("Bad array")}();case'"':return A();case"-":return C();default:return"0"<=E&&E<="9"?C():function(){switch(E){case"t":return T("t"),T("r"),T("u"),T("e"),!0;case"f":return T("f"),T("a"),T("l"),T("s"),T("e"),!1;case"n":return T("n"),T("u"),T("l"),T("l"),null}_("Unexpected '"+E+"'")}()}};var z,I,R,L=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,F={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function j(e){return L.lastIndex=0,L.test(e)?'"'+e.replace(L,function(e){var t=F[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}var U="undefined"!=typeof JSON?JSON:{parse:function(e,o){var t;return w=e,b=0,E=" ",t=N(),D(),E&&_("Syntax error"),"function"==typeof o?function e(t,n){var r,i,a=t[n];if(a&&"object"==typeof a)for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(void 0!==(i=e(a,r))?a[r]=i:delete a[r]);return o.call(t,n,a)}({"":t},""):t},stringify:function(e,t,n){var r;if(I=z="","number"==typeof n)for(r=0;r<n;r+=1)I+=" ";else"string"==typeof n&&(I=n);if((R=t)&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return function e(t,n){var r,i,a,o,u,c=z,s=n[t];switch(s&&"object"==typeof s&&"function"==typeof s.toJSON&&(s=s.toJSON(t)),"function"==typeof R&&(s=R.call(n,t,s)),typeof s){case"string":return j(s);case"number":return isFinite(s)?String(s):"null";case"boolean":case"null":return String(s);case"object":if(!s)return"null";if(z+=I,u=[],"[object Array]"===Object.prototype.toString.apply(s)){for(o=s.length,r=0;r<o;r+=1)u[r]=e(r,s)||"null";return a=0===u.length?"[]":z?"[\n"+z+u.join(",\n"+z)+"\n"+c+"]":"["+u.join(",")+"]",z=c,a}if(R&&"object"==typeof R)for(o=R.length,r=0;r<o;r+=1)"string"==typeof(i=R[r])&&(a=e(i,s))&&u.push(j(i)+(z?": ":":")+a);else for(i in s)Object.prototype.hasOwnProperty.call(s,i)&&(a=e(i,s))&&u.push(j(i)+(z?": ":":")+a);return a=0===u.length?"{}":z?"{\n"+z+u.join(",\n"+z)+"\n"+c+"}":"{"+u.join(",")+"}",z=c,a}}("",{"":e})}},M=function(e,t){t||(t={}),"function"==typeof t&&(t={cmp:t});var p=t.space||"";"number"==typeof p&&(p=Array(p+1).join(" "));var a,h="boolean"==typeof t.cycles&&t.cycles,m=t.replacer||function(e,t){return t},g=t.cmp&&(a=t.cmp,function(i){return function(e,t){var n={key:e,value:i[e]},r={key:t,value:i[t]};return a(n,r)}}),v=[];return function e(t,n,r,i){var a=p?"\n"+new Array(i+1).join(p):"",o=p?": ":":";if(r&&r.toJSON&&"function"==typeof r.toJSON&&(r=r.toJSON()),void 0!==(r=m.call(t,n,r))){if("object"!=typeof r||null===r)return U.stringify(r);if(P(r)){for(var u=[],c=0;c<r.length;c++){var s=e(r,c,r[c],i+1)||U.stringify(null);u.push(a+p+s)}return"["+u.join(",")+a+"]"}if(-1!==v.indexOf(r)){if(h)return U.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}v.push(r);var l=H(r).sort(g&&g(r));for(u=[],c=0;c<l.length;c++){var f=e(r,n=l[c],r[n],i+1);if(f){var d=U.stringify(n)+o+f;u.push(a+p+d)}}return v.splice(v.indexOf(r),1),"{"+u.join(",")+a+"}"}}({"":e},"",e,0)},P=Array.isArray||function(e){return"[object Array]"==={}.toString.call(e)},H=Object.keys||function(e){var t=Object.prototype.hasOwnProperty||function(){return!0},n=[];for(var r in e)t.call(e,r)&&n.push(r);return n};function q(e){return!!e.or}function W(e){return!!e.and}function G(e){return!!e.not}var B=M;var Y=B;function V(e){if(x(e))return e;var t=y(e)?e:B(e);if(t.length<100)return t;for(var n=0,r=0;r<t.length;r++){n=(n<<5)-n+t.charCodeAt(r),n&=n}return n}function X(e,t){return-1<e.indexOf(t)}function Q(e,t){return e.filter(function(e){return!X(t,e)})}function K(e,t){for(var n=0,r=0;r<e.length;r++)if(t(e[r],r,n++))return!0;return!1}function J(e,t){for(var n=0,r=0;r<e.length;r++)if(!t(e[r],r,n++))return!1;return!0}function Z(e){return[].concat.apply([],e)}function $(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0,i=t;r<i.length;r++){e=ee(e,i[r])}return e}function ee(e,t){if("object"!=typeof t||null===t)return e;for(var n in t)t.hasOwnProperty(n)&&void 0!==t[n]&&("object"!=typeof t[n]||v(t[n])||null===t[n]?e[n]=t[n]:"object"!=typeof e[n]||null===e[n]?e[n]=$(v(t[n].constructor)?[]:{},t[n]):$(e[n],t[n]));return e}function te(e,t){for(var n,r=[],i={},a=0,o=e;a<o.length;a++){var u=o[a];(n=t(u))in i||(i[n]=1,r.push(u))}return r}function ne(e,t){for(var n in e)if(e.hasOwnProperty(n)&&t[n]&&e[n]&&t[n]!==e[n])return!0;return!1}function re(e,t){for(var n in e)if(n in t)return!0;return!1}var ie=Object.keys;function ae(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(e[n]);return t}function oe(e){return ie(e)}function ue(e){return JSON.parse(JSON.stringify(e))}function ce(e){return!0===e||!1===e}function se(e){var t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t}function le(e,t){return G(e)?"!("+le(e.not,t)+")":W(e)?"("+e.and.map(function(e){return le(e,t)}).join(") && (")+")":q(e)?"("+e.or.map(function(e){return le(e,t)}).join(") || (")+")":t(e)}function fe(e,t){if(0===t.length)return!0;var n=t.shift();return fe(e[n],t)&&delete e[n],0===Object.keys(e).length}function de(e){return e.charAt(0).toUpperCase()+e.substr(1)}function pe(e,t){void 0===t&&(t="datum");for(var n=o(e),r=[],i=1;i<=n.length;i++){var a="["+n.slice(0,i).map(k).join("][")+"]";r.push(""+t+a)}return r.join(" && ")}function he(e,t){return void 0===t&&(t="datum"),t+"["+k(o(e).join("."))+"]"}function me(e){return""+o(e).map(function(e){return e.replace(".","\\.")}).join("\\.")}function ge(e){return""+o(e).join(".")}function ve(e){return o(e).length}var ye=Object.freeze({pick:function(e,t){for(var n={},r=0,i=t;r<i.length;r++){var a=i[r];e.hasOwnProperty(a)&&(n[a]=e[a])}return n},omit:function(e,t){for(var n=ue(e),r=0,i=t;r<i.length;r++)delete n[i[r]];return n},stringify:Y,hash:V,contains:X,without:Q,union:function(e,t){return e.concat(Q(t,e))},some:K,every:J,flatten:Z,mergeDeep:$,unique:te,differ:ne,hasIntersection:re,isNumeric:function(e){return!isNaN(e)},differArray:function(e,t){if(e.length!==t.length)return!0;e.sort(),t.sort();for(var n=0;n<e.length;n++)if(t[n]!==e[n])return!0;return!1},keys:ie,vals:ae,flagKeys:oe,duplicate:ue,isBoolean:ce,varName:se,logicalExpr:le,deleteNestedProperty:fe,titlecase:de,accessPathWithDatum:pe,flatAccessWithDatum:he,replacePathInField:me,removePathFromField:ge,accessPathDepth:ve}),be={argmax:1,argmin:1,average:1,count:1,distinct:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},xe=oe(be);function Se(e){return!!be[e]}var Ee=["count","valid","missing","distinct"];function we(e){return e&&X(Ee,e)}var Ne=["count","sum","distinct","valid","missing"],ke=["mean","average","median","q1","q3","min","max"],Oe=g(ke),_e=Object.freeze({AGGREGATE_OPS:xe,isAggregateOp:Se,COUNTING_OPS:Ee,isCountingAggregateOp:we,SUM_OPS:Ne,SHARED_DOMAIN_OPS:ke,SHARED_DOMAIN_OP_INDEX:Oe}),Te=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};function Ce(e,t){function n(){this.constructor=e}Te(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var Ae=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e};function De(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&(n[r[i]]=e[r[i]])}return n}var ze=["domain","grid","labels","ticks","title"],Ie={grid:"grid",gridScale:"grid",domain:"main",labels:"main",labelFlush:"main",labelOverlap:"main",minExtent:"main",maxExtent:"main",offset:"main",ticks:"main",title:"main",values:"both",scale:"both",zindex:"both"},Re={orient:1,domain:1,format:1,grid:1,labelBound:1,labelFlush:1,labelPadding:1,labels:1,labelOverlap:1,maxExtent:1,minExtent:1,offset:1,position:1,tickCount:1,ticks:1,tickSize:1,title:1,titlePadding:1,values:1,zindex:1},Le=Ae({},Re,{encoding:1,labelAngle:1,titleMaxLength:1});function Fe(e){return!!Le[e]}var je,Ue,Me=oe(Ae({scale:1},Re,{gridScale:1,encode:1})),Pe=oe(Le),He=Object.freeze({AXIS_PARTS:ze,AXIS_PROPERTY_TYPE:Ie,isAxisProperty:Fe,VG_AXIS_PROPERTIES:Me,AXIS_PROPERTIES:Pe});(Ue=je||(je={})).ROW="row",Ue.COLUMN="column",Ue.X="x",Ue.Y="y",Ue.X2="x2",Ue.Y2="y2",Ue.LATITUDE="latitude",Ue.LONGITUDE="longitude",Ue.LATITUDE2="latitude2",Ue.LONGITUDE2="longitude2",Ue.COLOR="color",Ue.FILL="fill",Ue.STROKE="stroke",Ue.SHAPE="shape",Ue.SIZE="size",Ue.OPACITY="opacity",Ue.TEXT="text",Ue.ORDER="order",Ue.DETAIL="detail",Ue.KEY="key",Ue.TOOLTIP="tooltip",Ue.HREF="href";var qe=je.X,We=je.Y,Ge=je.X2,Be=je.Y2,Ye=je.LATITUDE,Ve=je.LATITUDE2,Xe=je.LONGITUDE,Qe=je.LONGITUDE2,Ke=je.ROW,Je=je.COLUMN,Ze=je.SHAPE,$e=je.SIZE,et=je.COLOR,tt=je.FILL,nt=je.STROKE,rt=je.TEXT,it=je.DETAIL,at=je.KEY,ot=je.ORDER,ut=je.OPACITY,ct=je.TOOLTIP,st=je.HREF,lt={longitude:1,longitude2:1,latitude:1,latitude2:1},ft=oe(lt),dt=Ae({x:1,y:1,x2:1,y2:1},lt,{color:1,fill:1,stroke:1,opacity:1,size:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1});function pt(e){return"color"===e||"fill"===e||"stroke"===e}var ht=Ae({},dt,{row:1,column:1}),mt=oe(ht),gt=(ht.order,ht.detail,oe(De(ht,["order","detail"])));function vt(e){return!!ht[e]}var yt=oe(dt),bt=(dt.x,dt.y,dt.x2,dt.y2,dt.latitude,dt.longitude,dt.latitude2,dt.longitude2,De(dt,["x","y","x2","y2","latitude","longitude","latitude2","longitude2"])),xt=oe(bt),St={x:1,y:1},Et=oe(St),wt=De(bt,["text","tooltip","href","detail","key","order"]),Nt=oe(wt),kt=Ae({},St,wt),Ot=oe(kt);function _t(e){return!!kt[e]}function Tt(e,t){return t in Ct(e)}function Ct(e){switch(e){case et:case tt:case nt:case it:case at:case ct:case st:case ot:case ut:case Ke:case Je:return{point:!0,tick:!0,rule:!0,circle:!0,square:!0,bar:!0,rect:!0,line:!0,trail:!0,area:!0,text:!0,geoshape:!0};case qe:case We:case Ye:case Xe:return{point:!0,tick:!0,rule:!0,circle:!0,square:!0,bar:!0,rect:!0,line:!0,trail:!0,area:!0,text:!0};case Ge:case Be:case Ve:case Qe:return{rule:!0,bar:!0,rect:!0,area:!0};case $e:return{point:!0,tick:!0,rule:!0,circle:!0,square:!0,bar:!0,text:!0,line:!0,trail:!0};case Ze:return{point:!0,geoshape:!0};case rt:return{text:!0}}}function At(e){switch(e){case qe:case We:case $e:case ut:case Ge:case Be:return"continuous";case Ke:case Je:case Ze:case rt:case ct:case st:return"discrete";case et:case tt:case nt:return"flexible";case Ye:case Xe:case Ve:case Qe:case it:case at:case ot:return}throw new Error("rangeType not implemented for "+e)}var Dt=Object.freeze({get Channel(){return je},X:qe,Y:We,X2:Ge,Y2:Be,LATITUDE:Ye,LATITUDE2:Ve,LONGITUDE:Xe,LONGITUDE2:Qe,ROW:Ke,COLUMN:Je,SHAPE:Ze,SIZE:$e,COLOR:et,FILL:tt,STROKE:nt,TEXT:rt,DETAIL:it,KEY:at,ORDER:ot,OPACITY:ut,TOOLTIP:ct,HREF:st,GEOPOSITION_CHANNEL_INDEX:lt,GEOPOSITION_CHANNELS:ft,isColorChannel:pt,CHANNELS:mt,SINGLE_DEF_CHANNELS:gt,isChannel:vt,UNIT_CHANNELS:yt,NONPOSITION_CHANNELS:xt,POSITION_SCALE_CHANNELS:Et,NONPOSITION_SCALE_CHANNELS:Nt,SCALE_CHANNELS:Ot,isScaleChannel:_t,supportMark:Tt,getSupportedMark:Ct,rangeType:At});function zt(t){return m(t)?"bin":"bin"+ie(t).map(function(e){return se("_"+e+"_"+t[e])}).join("")}function It(e){return e&&!m(e)}function Rt(e){switch(e){case Ke:case Je:case $e:case et:case tt:case nt:case ut:case Ze:return 6;default:return 10}}var Lt,Ft,jt=Object.freeze({binToString:zt,isBinParams:It,autoMaxBins:Rt});(Ft=Lt||(Lt={})).AREA="area",Ft.BAR="bar",Ft.LINE="line",Ft.POINT="point",Ft.RECT="rect",Ft.RULE="rule",Ft.TEXT="text",Ft.TICK="tick",Ft.TRAIL="trail",Ft.CIRCLE="circle",Ft.SQUARE="square",Ft.GEOSHAPE="geoshape";var Ut=Lt.AREA,Mt=Lt.BAR,Pt=Lt.LINE,Ht=Lt.POINT,qt=Lt.TEXT,Wt=Lt.TICK,Gt=Lt.TRAIL,Bt=Lt.RECT,Yt=Lt.RULE,Vt=Lt.GEOSHAPE,Xt=Lt.CIRCLE,Qt=Lt.SQUARE,Kt={area:1,bar:1,line:1,point:1,text:1,tick:1,trail:1,rect:1,geoshape:1,rule:1,circle:1,square:1};function Jt(e){return X(["line","area","trail"],e)}var Zt=oe(Kt);function $t(e){return e.type}var en=g(Zt);function tn(e){return($t(e)?e.type:e)in en}var nn,rn,an,on=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity"],un=["fill","fillOpacity"],cn=[].concat(on,un),sn=["filled","color"],ln={area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize"],line:["point"],text:["shortTimeLabels"],tick:["bandSize","thickness"]},fn={color:"#4c78a8"},dn={binSpacing:1,continuousBandSize:5},pn={thickness:1},hn=Object.freeze({get Mark(){return Lt},AREA:Ut,BAR:Mt,LINE:Pt,POINT:Ht,TEXT:qt,TICK:Wt,TRAIL:Gt,RECT:Bt,RULE:Yt,GEOSHAPE:Vt,CIRCLE:Xt,SQUARE:Qt,isMark:function(e){return!!Kt[e]},isPathMark:Jt,PRIMITIVE_MARKS:Zt,isMarkDef:$t,isPrimitiveMark:tn,STROKE_CONFIG:on,FILL_CONFIG:un,FILL_STROKE_CONFIG:cn,VL_ONLY_MARK_CONFIG_PROPERTIES:sn,VL_ONLY_MARK_SPECIFIC_CONFIG_PROPERTY_INDEX:ln,defaultMarkConfig:fn,defaultBarConfig:dn,defaultTickConfig:pn}),mn=(nn=d||s,{level:function(e){return arguments.length?(nn=+e,this):nn},error:function(){return f<=nn&&c("error","ERROR",arguments),this},warn:function(){return d<=nn&&c("warn","WARN",arguments),this},info:function(){return p<=nn&&c("log","INFO",arguments),this},debug:function(){return h<=nn&&c("log","DEBUG",arguments),this}}),gn=mn;function vn(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];gn.warn.apply(gn,arguments)}(an=rn||(rn={})).INVALID_SPEC="Invalid spec",an.FIT_NON_SINGLE='Autosize "fit" only works for single views and layered views.',an.CANNOT_FIX_RANGE_STEP_WITH_FIT='Cannot use a fixed value of "rangeStep" when "autosize" is "fit".',an.cannotProjectOnChannelWithoutField=function(e){return'Cannot project a selection on encoding channel "'+e+'", which has no field.'},an.nearestNotSupportForContinuous=function(e){return'The "nearest" transform is not supported for '+e+" marks."},an.selectionNotFound=function(e){return'Cannot find a selection named "'+e+'"'},an.SCALE_BINDINGS_CONTINUOUS="Scale bindings are currently only supported for scales with unbinned, continuous domains.",an.noSuchRepeatedValue=function(e){return'Unknown repeated value "'+e+'".'},an.CONCAT_CANNOT_SHARE_AXIS="Axes cannot be shared in concatenated views.",an.REPEAT_CANNOT_SHARE_AXIS="Axes cannot be shared in repeated views.",an.cannotSetTitleAnchor=function(e){return'Cannot set title "anchor" for a '+e+" spec"},an.unrecognizedParse=function(e){return'Unrecognized parse "'+e+'".'},an.differentParse=function(e,t,n){return'An ancestor parsed field "'+e+'" as '+n+" but a child wants to parse the field as "+t+"."},an.invalidTransformIgnored=function(e){return"Ignoring an invalid transform: "+Y(e)+"."},an.NO_FIELDS_NEEDS_AS='If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.',an.encodingOverridden=function(e){return"Layer's shared "+e.join(",")+" channel "+(1===e.length?"is":"are")+" overriden"},an.projectionOverridden=function(e){var t=e.parentProjection,n=e.projection;return"Layer's shared projection "+Y(t)+" is overridden by a child projection "+Y(n)+"."},an.primitiveChannelDef=function(e,t,n){return"Channel "+e+" is a "+t+". Converted to {value: "+Y(n)+"}."},an.invalidFieldType=function(e){return'Invalid field type "'+e+'"'},an.nonZeroScaleUsedWithLengthMark=function(e,t,n){return"A "+(n.scaleType?n.scaleType+" scale":n.zeroFalse?"scale with zero=false":"scale with custom domain that excludes zero")+" is used with "+e+" mark. This can be misleading as the "+("x"===t?"width":"height")+" of the "+e+" can be arbitrary based on the scale domain. You may want to use point mark instead."},an.invalidFieldTypeForCountAggregate=function(e,t){return'Invalid field type "'+e+'" for aggregate: "'+t+'", using "quantitative" instead.'},an.invalidAggregate=function(e){return'Invalid aggregation operator "'+e+'"'},an.emptyOrInvalidFieldType=function(e,t,n){return'Invalid field type "'+e+'" for channel "'+t+'", using "'+n+'" instead.'},an.droppingColor=function(e,t){var n=t.fill,r=t.stroke;return"Dropping color "+e+" as the plot also has "+(n&&r?"fill and stroke":n?"fill":"stroke")},an.emptyFieldDef=function(e,t){return"Dropping "+Y(e)+' from channel "'+t+'" since it does not contain data field or value.'},an.latLongDeprecated=function(e,t,n){return e+"-encoding with type "+t+" is deprecated. Replacing with "+n+"-encoding."},an.LINE_WITH_VARYING_SIZE="Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.",an.incompatibleChannel=function(e,t,n){return e+' dropped as it is incompatible with "'+t+'"'+(n?" when "+n:"")+"."},an.invalidEncodingChannel=function(e){return e+"-encoding is dropped as "+e+" is not a valid encoding channel."},an.facetChannelShouldBeDiscrete=function(e){return e+" encoding should be discrete (ordinal / nominal / binned)."},an.discreteChannelCannotEncode=function(e,t){return'Using discrete channel "'+e+'" to encode "'+t+'" field can be misleading as it does not encode '+("ordinal"===t?"order":"magnitude")+"."},an.BAR_WITH_POINT_SCALE_AND_RANGESTEP_NULL="Bar mark should not be used with point scale when rangeStep is null. Please use band scale instead.",an.lineWithRange=function(e,t){return"Line mark is for continuous lines and thus cannot be used with "+(e&&t?"x2 and y2":e?"x2":"y2")+". We will use the rule mark (line segments) instead."},an.unclearOrientContinuous=function(e){return'Cannot clearly determine orientation for "'+e+'" since both x and y channel encode continuous fields. In this case, we use vertical by default'},an.unclearOrientDiscreteOrEmpty=function(e){return'Cannot clearly determine orientation for "'+e+'" since both x and y channel encode discrete or empty fields.'},an.orientOverridden=function(e,t){return'Specified orient "'+e+'" overridden with "'+t+'"'},an.CANNOT_UNION_CUSTOM_DOMAIN_WITH_FIELD_DOMAIN="custom domain scale cannot be unioned with default field-based domain",an.cannotUseScalePropertyWithNonColor=function(e){return'Cannot use the scale property "'+e+'" with non-color channel.'},an.unaggregateDomainHasNoEffectForRawField=function(e){return"Using unaggregated domain with raw field has no effect ("+Y(e)+")."},an.unaggregateDomainWithNonSharedDomainOp=function(e){return'Unaggregated domain not applicable for "'+e+'" since it produces values outside the origin domain of the source data.'},an.unaggregatedDomainWithLogScale=function(e){return"Unaggregated domain is currently unsupported for log scale ("+Y(e)+")."},an.cannotUseSizeFieldWithBandSize=function(e){return"Using size field when "+e+"-channel has a band scale is not supported."},an.cannotApplySizeToNonOrientedMark=function(e){return'Cannot apply size to non-oriented mark "'+e+'".'},an.rangeStepDropped=function(e){return'rangeStep for "'+e+'" is dropped as top-level '+("x"===e?"width":"height")+" is provided."},an.scaleTypeNotWorkWithChannel=function(e,t,n){return'Channel "'+e+'" does not work with "'+t+'" scale. We are using "'+n+'" scale instead.'},an.scaleTypeNotWorkWithFieldDef=function(e,t){return'FieldDef does not work with "'+e+'" scale. We are using "'+t+'" scale instead.'},an.scalePropertyNotWorkWithScaleType=function(e,t,n){return n+"-scale's \""+t+'" is dropped as it does not work with '+e+" scale."},an.scaleTypeNotWorkWithMark=function(e,t){return'Scale type "'+t+'" does not work with mark "'+e+'".'},an.mergeConflictingProperty=function(e,t,n,r){return"Conflicting "+t+' property "'+e+'" ('+Y(n)+" and "+Y(r)+").  Using "+Y(n)+"."},an.independentScaleMeansIndependentGuide=function(e){return'Setting the scale to be independent for "'+e+'" means we also have to set the guide (axis or legend) to be independent.'},an.domainSortDropped=function(e){return"Dropping sort property "+Y(e)+" as unioned domains only support boolean or op 'count'."},an.UNABLE_TO_MERGE_DOMAINS="Unable to merge domains",an.MORE_THAN_ONE_SORT="Domains that should be unioned has conflicting sort properties. Sort will be set to true.",an.INVALID_CHANNEL_FOR_AXIS="Invalid channel for axis.",an.cannotStackRangedMark=function(e){return'Cannot stack "'+e+'" if there is already "'+e+'2"'},an.cannotStackNonLinearScale=function(e){return"Cannot stack non-linear scale ("+e+")"},an.stackNonSummativeAggregate=function(e){return'Stacking is applied even though the aggregate function is non-summative ("'+e+'")'},an.invalidTimeUnit=function(e,t){return"Invalid "+e+": "+Y(t)},an.dayReplacedWithDate=function(e){return'Time unit "'+e+'" is not supported. We are replacing it with '+e.replace("day","date")+"."},an.droppedDay=function(e){return"Dropping day from datetime "+Y(e)+" as day cannot be combined with other units."};var yn=2006;function bn(e){return!!(e&&(e.year||e.quarter||e.month||e.date||e.day||e.hours||e.minutes||e.seconds||e.milliseconds))}var xn=["january","february","march","april","may","june","july","august","september","october","november","december"],Sn=xn.map(function(e){return e.substr(0,3)}),En=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],wn=En.map(function(e){return e.substr(0,3)});function Nn(e,t){void 0===t&&(t=!1);var n=[];if(t&&void 0!==e.day&&1<ie(e).length&&(vn(rn.droppedDay(e)),delete(e=ue(e)).day),void 0!==e.year?n.push(e.year):void 0!==e.day?n.push(yn):n.push(0),void 0!==e.month){var r=t?function(e){if(x(e))return e-1+"";var t=e.toLowerCase(),n=xn.indexOf(t);if(-1!==n)return n+"";var r=t.substr(0,3),i=Sn.indexOf(r);if(-1!==i)return i+"";throw new Error(rn.invalidTimeUnit("month",e))}(e.month):e.month;n.push(r)}else if(void 0!==e.quarter){var i=t?function(e){if(x(e))return 4<e&&vn(rn.invalidTimeUnit("quarter",e)),e-1+"";throw new Error(rn.invalidTimeUnit("quarter",e))}(e.quarter):e.quarter;n.push(i+"*3")}else n.push(0);if(void 0!==e.date)n.push(e.date);else if(void 0!==e.day){var a=t?function(e){if(x(e))return e%7+"";var t=e.toLowerCase(),n=En.indexOf(t);if(-1!==n)return n+"";var r=t.substr(0,3),i=wn.indexOf(r);if(-1!==i)return i+"";throw new Error(rn.invalidTimeUnit("day",e))}(e.day):e.day;n.push(a+"+1")}else n.push(1);for(var o=0,u=["hours","minutes","seconds","milliseconds"];o<u.length;o++){var c=u[o];void 0!==e[c]?n.push(e[c]):n.push(0)}return e.utc?"utc("+n.join(", ")+")":"datetime("+n.join(", ")+")"}var kn,On,_n=Object.freeze({isDateTime:bn,MONTHS:xn,SHORT_MONTHS:Sn,DAYS:En,SHORT_DAYS:wn,dateTimeExpr:Nn});(On=kn||(kn={})).YEAR="year",On.MONTH="month",On.DAY="day",On.DATE="date",On.HOURS="hours",On.MINUTES="minutes",On.SECONDS="seconds",On.MILLISECONDS="milliseconds",On.YEARMONTH="yearmonth",On.YEARMONTHDATE="yearmonthdate",On.YEARMONTHDATEHOURS="yearmonthdatehours",On.YEARMONTHDATEHOURSMINUTES="yearmonthdatehoursminutes",On.YEARMONTHDATEHOURSMINUTESSECONDS="yearmonthdatehoursminutesseconds",On.MONTHDATE="monthdate",On.HOURSMINUTES="hoursminutes",On.HOURSMINUTESSECONDS="hoursminutesseconds",On.MINUTESSECONDS="minutesseconds",On.SECONDSMILLISECONDS="secondsmilliseconds",On.QUARTER="quarter",On.YEARQUARTER="yearquarter",On.QUARTERMONTH="quartermonth",On.YEARQUARTERMONTH="yearquartermonth",On.UTCYEAR="utcyear",On.UTCMONTH="utcmonth",On.UTCDAY="utcday",On.UTCDATE="utcdate",On.UTCHOURS="utchours",On.UTCMINUTES="utcminutes",On.UTCSECONDS="utcseconds",On.UTCMILLISECONDS="utcmilliseconds",On.UTCYEARMONTH="utcyearmonth",On.UTCYEARMONTHDATE="utcyearmonthdate",On.UTCYEARMONTHDATEHOURS="utcyearmonthdatehours",On.UTCYEARMONTHDATEHOURSMINUTES="utcyearmonthdatehoursminutes",On.UTCYEARMONTHDATEHOURSMINUTESSECONDS="utcyearmonthdatehoursminutesseconds",On.UTCMONTHDATE="utcmonthdate",On.UTCHOURSMINUTES="utchoursminutes",On.UTCHOURSMINUTESSECONDS="utchoursminutesseconds",On.UTCMINUTESSECONDS="utcminutesseconds",On.UTCSECONDSMILLISECONDS="utcsecondsmilliseconds",On.UTCQUARTER="utcquarter",On.UTCYEARQUARTER="utcyearquarter",On.UTCQUARTERMONTH="utcquartermonth",On.UTCYEARQUARTERMONTH="utcyearquartermonth";var Tn={year:1,quarter:1,month:1,day:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},Cn=oe(Tn);function An(e){return!!Tn[e]}var Dn={utcyear:1,utcquarter:1,utcmonth:1,utcday:1,utcdate:1,utchours:1,utcminutes:1,utcseconds:1,utcmilliseconds:1};function zn(e){return!!Dn[e]}var In={utcyearquarter:1,utcyearquartermonth:1,utcyearmonth:1,utcyearmonthdate:1,utcyearmonthdatehours:1,utcyearmonthdatehoursminutes:1,utcyearmonthdatehoursminutesseconds:1,utcquartermonth:1,utcmonthdate:1,utchoursminutes:1,utchoursminutesseconds:1,utcminutesseconds:1,utcsecondsmilliseconds:1},Rn=Ae({},Dn,In);function Ln(e){return!!Rn[e]}function Fn(e){return e.substr(3)}var jn=Ae({},Tn,Dn,{yearquarter:1,yearquartermonth:1,yearmonth:1,yearmonthdate:1,yearmonthdatehours:1,yearmonthdatehoursminutes:1,yearmonthdatehoursminutesseconds:1,quartermonth:1,monthdate:1,hoursminutes:1,hoursminutesseconds:1,minutesseconds:1,secondsmilliseconds:1},In),Un=oe(jn);var Mn={year:"setFullYear",month:"setMonth",date:"setDate",hours:"setHours",minutes:"setMinutes",seconds:"setSeconds",milliseconds:"setMilliseconds",quarter:null,day:null};function Pn(e,t){var n=Mn[e];return{setDateMethod:t?"setUTC"+n.substr(3):n,getDateMethod:"get"+(t?"UTC":"")+n.substr(3)}}function Hn(n){return Cn.reduce(function(e,t){return qn(n,t)?e.concat(t):e},[])}function qn(e,t){var n=e.indexOf(t);return-1<n&&(t!==kn.SECONDS||0===n||"i"!==e.charAt(n-1))}function Wn(r,e){var i=pe(e),a=Ln(r)?"utc":"";return Nn(Cn.reduce(function(e,t){var n;return qn(r,t)&&(e[t]=(n=t)===kn.QUARTER?"("+a+"quarter("+i+")-1)":""+a+n+"("+i+")"),e},{}))}function Gn(e,t,n,r){if(e){var i=[],a="",o=qn(e,kn.YEAR);qn(e,kn.QUARTER)&&(a="'Q' + quarter("+t+")"),qn(e,kn.MONTH)&&i.push(!1!==n?"%b":"%B"),qn(e,kn.DAY)?i.push(n?"%a":"%A"):qn(e,kn.DATE)&&i.push("%d"+(o?",":"")),o&&i.push(n?"%y":"%Y");var u=[];qn(e,kn.HOURS)&&u.push("%H"),qn(e,kn.MINUTES)&&u.push("%M"),qn(e,kn.SECONDS)&&u.push("%S"),qn(e,kn.MILLISECONDS)&&u.push("%L");var c=[];return 0<i.length&&c.push(i.join(" ")),0<u.length&&c.push(u.join(":")),0<c.length&&(a&&(a+=" + ' ' + "),a+=r?"utcFormat("+t+", '"+c.join(" ")+"')":"timeFormat("+t+", '"+c.join(" ")+"')"),a||void 0}}function Bn(e){return"day"!==e&&0<=e.indexOf("day")?(vn(rn.dayReplacedWithDate(e)),e.replace("day","date")):e}var Yn,Vn,Xn=Object.freeze({get TimeUnit(){return kn},TIMEUNIT_PARTS:Cn,isLocalSingleTimeUnit:An,isUtcSingleTimeUnit:zn,isUTCTimeUnit:Ln,getLocalTimeUnit:Fn,TIMEUNITS:Un,isTimeUnit:function(e){return!!jn[e]},convert:function(e,t){for(var n=Ln(e),r=n?new Date(Date.UTC(0,0,1,0,0,0,0)):new Date(0,0,1,0,0,0,0),i=0,a=Cn;i<a.length;i++){var o=a[i];if(qn(e,o))switch(o){case kn.DAY:throw new Error("Cannot convert to TimeUnits containing 'day'");case kn.QUARTER:var u=Pn("month",n),c=u.getDateMethod;r[u.setDateMethod](3*Math.floor(t[c]()/3));break;default:var s=Pn(o,n),l=s.getDateMethod;r[s.setDateMethod](t[l]())}}return r},getTimeUnitParts:Hn,containsTimeUnit:qn,fieldExpr:Wn,formatExpression:Gn,normalizeTimeUnit:Bn});(Vn=Yn||(Yn={})).QUANTITATIVE="quantitative",Vn.ORDINAL="ordinal",Vn.TEMPORAL="temporal",Vn.NOMINAL="nominal",Vn.LATITUDE="latitude",Vn.LONGITUDE="longitude",Vn.GEOJSON="geojson";var Qn={quantitative:1,ordinal:1,temporal:1,nominal:1,latitude:1,longitude:1,geojson:1};var Kn=Yn.QUANTITATIVE,Jn=Yn.ORDINAL,Zn=Yn.TEMPORAL,$n=Yn.NOMINAL,er=Yn.GEOJSON;function tr(e){if(e)switch(e=e.toLowerCase()){case"q":case Kn:return"quantitative";case"t":case Zn:return"temporal";case"o":case Jn:return"ordinal";case"n":case $n:return"nominal";case Yn.LATITUDE:return"latitude";case Yn.LONGITUDE:return"longitude";case er:return"geojson"}}var nr=Object.freeze({get Type(){return Yn},isType:function(e){return!!Qn[e]},QUANTITATIVE:Kn,ORDINAL:Jn,TEMPORAL:Zn,NOMINAL:$n,GEOJSON:er,getFullName:tr});function rr(e){return e.selection}function ir(e){return e&&!y(e)&&"repeat"in e}function ar(e){var t=e.field,n=e.timeUnit,r=e.bin,i=e.aggregate;return Ae({},n?{timeUnit:n}:{},r?{bin:r}:{},i?{aggregate:i}:{},{field:t})}function or(e){return!!e&&!!e.condition}function ur(e){return!!e&&!!e.condition&&!v(e.condition)&&sr(e.condition)}function cr(e){return!!e&&!!e.condition&&(v(e.condition)||fr(e.condition))}function sr(e){return!(!e||!e.field&&"count"!==e.aggregate)}function lr(e){return sr(e)&&y(e.field)}function fr(e){return e&&"value"in e&&void 0!==e.value}function dr(e){return!(!e||!e.scale&&!e.sort)}function pr(e,t){void 0===t&&(t={});var n=e.field,r=t.prefix,i=t.suffix;if(gr(e))n="count_*";else{var a=void 0;t.nofn||(e.bin?(a=zt(e.bin),i=t.binSuffix||""):e.aggregate?a=String(t.aggregate||e.aggregate):e.timeUnit&&(a=String(e.timeUnit))),a&&(n=a+"_"+n)}return i&&(n=n+"_"+i),r&&(n=r+"_"+n),t.expr?he(n,t.expr):me(n)}function hr(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return!!e.bin;case"latitude":case"longitude":case"temporal":return!1}throw new Error(rn.invalidFieldType(e.type))}function mr(e){return!hr(e)}function gr(e){return"count"===e.aggregate}function vr(e,t){var n=e.field,r=e.bin,i=e.timeUnit,a=e.aggregate;return"count"===a?t.countTitle:r?n+" (binned)":i?n+" ("+Hn(i).join("-")+")":a?de(a)+" of "+n:n}function yr(e,t){var n=e.aggregate||e.timeUnit||e.bin&&"bin";return n?n.toUpperCase()+"("+e.field+")":e.field}var br=function(e,t){switch(t.fieldTitle){case"plain":return e.field;case"functional":return yr(e);default:return vr(e,t)}},xr=br;function Sr(e){xr=e}function Er(){Sr(br)}function wr(e,t){return xr(e,t)}function Nr(e,t){if(e.timeUnit)return"temporal";if(e.bin)return"quantitative";switch(At(t)){case"continuous":return"quantitative";case"discrete":case"flexible":return"nominal";default:return"quantitative"}}function kr(e){return sr(e)?e:ur(e)?e.condition:void 0}function Or(e,t){if(y(e)||x(e)||m(e)){var n=y(e)?"string":x(e)?"number":"boolean";return vn(rn.primitiveChannelDef(t,n,e)),{value:e}}return sr(e)?_r(e,t):ur(e)?Ae({},e,{condition:_r(e.condition,t)}):e}function _r(e,t){if(e.aggregate&&!Se(e.aggregate)){e.aggregate;var n=De(e,["aggregate"]);vn(rn.invalidAggregate(e.aggregate)),e=n}if(e.timeUnit&&(e=Ae({},e,{timeUnit:Bn(e.timeUnit)})),e.bin&&(e=Ae({},e,{bin:Tr(e.bin,t)})),e.type){var r=tr(e.type);e.type!==r&&(e=Ae({},e,{type:r})),"quantitative"!==e.type&&we(e.aggregate)&&(vn(rn.invalidFieldTypeForCountAggregate(e.type,e.aggregate)),e=Ae({},e,{type:"quantitative"}))}else{var i=Nr(e,t);vn(rn.emptyOrInvalidFieldType(e.type,t,i)),e=Ae({},e,{type:i})}var a=Ar(e,t),o=a.compatible,u=a.warning;return o||vn(u),e}function Tr(e,t){return m(e)?{maxbins:Rt(t)}:e.maxbins||e.step?e:Ae({},e,{maxbins:Rt(t)})}var Cr={compatible:!0};function Ar(e,t){switch(t){case"row":case"column":return mr(e)&&!e.timeUnit?{compatible:!1,warning:rn.facetChannelShouldBeDiscrete(t)}:Cr;case"x":case"y":case"color":case"fill":case"stroke":case"text":case"detail":case"key":case"tooltip":case"href":return Cr;case"longitude":case"longitude2":case"latitude":case"latitude2":return e.type!==Kn?{compatible:!1,warning:"Channel "+t+" should not be used with "+e.type+" field."}:Cr;case"opacity":case"size":case"x2":case"y2":return hr(e)&&!e.bin?{compatible:!1,warning:"Channel "+t+" should not be used with discrete field."}:Cr;case"shape":return"nominal"!==e.type&&"geojson"!==e.type?{compatible:!1,warning:"Shape channel should be used with nominal data or geojson only"}:Cr;case"order":return"nominal"===e.type?{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}:Cr}throw new Error("channelCompatability not implemented for channel "+t)}function Dr(e){return"quantitative"===e.type||!!e.bin}function zr(e){return"temporal"===e.type||!!e.timeUnit}var Ir=Object.freeze({isConditionalSelection:rr,isRepeatRef:ir,toFieldDefBase:ar,isConditionalDef:or,hasConditionalFieldDef:ur,hasConditionalValueDef:cr,isFieldDef:sr,isStringFieldDef:lr,isValueDef:fr,isScaleFieldDef:dr,vgField:pr,isDiscrete:hr,isContinuous:mr,isCount:gr,verbalTitleFormatter:vr,functionalTitleFormatter:yr,defaultTitleFormatter:br,setTitleFormatter:Sr,resetTitleFormatter:Er,title:wr,defaultType:Nr,getFieldDef:kr,normalize:Or,normalizeFieldDef:_r,normalizeBin:Tr,channelCompatibility:Ar,isNumberFieldDef:Dr,isTimeFieldDef:zr});function Rr(e,t){var n=e&&e[t];return!!n&&(v(n)?K(n,function(e){return!!e.field}):sr(n)||ur(n))}function Lr(r){return K(mt,function(e){if(Rr(r,e)){var t=r[e];if(v(t))return K(t,function(e){return!!e.aggregate});var n=kr(t);return n&&!!n.aggregate}return!1})}function Fr(c,s){return ie(c).reduce(function(e,n){if(!vt(n))return vn(rn.invalidEncodingChannel(n)),e;if(!Tt(n,s))return vn(rn.incompatibleChannel(n,s)),e;if("size"===n&&"line"===s&&((i=kr(c[n]))&&i.aggregate))return vn(rn.LINE_WITH_VARYING_SIZE),e;if("color"===n&&("fill"in c||"stroke"in c))return vn(rn.droppingColor("encoding",{fill:"fill"in c,stroke:"stroke"in c})),e;var t,r=c[n];if("detail"===n||"order"===n&&!v(r)&&!fr(r)||"tooltip"===n&&v(r))r&&(e[n]=(v(r)?r:[r]).reduce(function(e,t){return sr(t)?e.push(_r(t,n)):vn(rn.emptyFieldDef(t,n)),e},[]));else{var i;if((i=kr(c[n]))&&X([Yn.LATITUDE,Yn.LONGITUDE],i.type)){var a=n,o=(e[a],De(e,["symbol"==typeof a?a:a+""])),u="x"===n?"longitude":"y"===n?"latitude":"x2"===n?"longitude2":"y2"===n?"latitude2":void 0;return vn(rn.latLongDeprecated(n,i.type,u)),Ae({},o,((t={})[u]=Ae({},Or(i,n),{type:"quantitative"}),t))}if(!sr(r)&&!fr(r)&&!or(r))return vn(rn.emptyFieldDef(r,n)),e;e[n]=Or(r,n)}return e},{})}function jr(e){return e&&(!!e.x&&!!e.x2||!!e.y&&!!e.y2)}function Ur(n){var r=[];return mt.forEach(function(e){if(Rr(n,e)){var t=n[e];(v(t)?t:[t]).forEach(function(e){sr(e)?r.push(e):ur(e)&&r.push(e.condition)})}}),r}function Mr(e,n,r){if(e)for(var t=function(t){v(e[t])?e[t].forEach(function(e){n.call(r,e,t)}):n.call(r,e[t],t)},i=0,a=ie(e);i<a.length;i++){t(a[i])}}function Pr(r,i,e,a){return r?ie(r).reduce(function(e,n){var t=r[n];return v(t)?t.reduce(function(e,t){return i.call(a,e,t,n)},e):i.call(a,e,t,n)},e):e}var Hr=Object.freeze({channelHasField:Rr,isAggregate:Lr,normalizeEncoding:Fr,isRanged:jr,fieldDefs:Ur,forEach:Mr,reduce:Pr});function qr(e,t){var n,r=e[t];return void 0!==r?((n={})[t]={value:r},n):{}}var Wr="box-plot";function Gr(e){return!!e.type}var Br=["x","y","color","detail","opacity","size"];var Yr={};function Vr(e,t){Yr[e]=t}var Xr=["boxWhisker","box","boxMid"],Qr=Ae({},{box:["size","color","extent"],boxWhisker:["color"],boxMid:["color"]});function Kr(e,t){var n=$t(e.mark)?e.mark.type:e.mark,r=Yr[n];if(r)return r(e,t);throw new Error('Invalid mark type "'+n+'"')}Vr(Wr,function(e,t){var n,r=(e=Ae({},n=e,{encoding:Pr(n.encoding,function(e,t,n){return-1<Br.indexOf(n)?e[n]=t:vn(rn.incompatibleChannel(n,Wr)),e},{})})).mark,i=(e.encoding,e.selection),a=(e.projection,De(e,["mark","encoding","selection","projection"])),o=void 0;x(t.box.extent)&&(o=t.box.extent),Gr(r)&&r.extent&&"min-max"===r.extent&&(o=void 0);var u,c,s,l,f=function(e,t,n){var r=function(e,t){e.mark;var n,r,i=e.encoding;if(e.projection,De(e,["mark","encoding","projection"]),"vertical"===t?(r="y",n=i.y):(r="x",n=i.x),n&&n.aggregate){var a=n.aggregate,o=De(n,["aggregate"]);a!==Wr&&vn("Continuous axis should not have customized aggregation function "+a),n=o}return{continuousAxisChannelDef:n,continuousAxis:r}}(e,t),i=r.continuousAxisChannelDef,o=r.continuousAxis,u=e.encoding,a=void 0===n,c=[{op:"q1",field:i.field,as:"lower_box_"+i.field},{op:"q3",field:i.field,as:"upper_box_"+i.field},{op:"median",field:i.field,as:"mid_box_"+i.field}],s=[];c.push({op:"min",field:i.field,as:(a?"lower_whisker_":"min_")+i.field}),c.push({op:"max",field:i.field,as:(a?"upper_whisker_":"max_")+i.field}),a||(s=[{calculate:"datum.upper_box_"+i.field+" - datum.lower_box_"+i.field,as:"iqr_"+i.field},{calculate:"min(datum.upper_box_"+i.field+" + datum.iqr_"+i.field+" * "+n+", datum.max_"+i.field+")",as:"upper_whisker_"+i.field},{calculate:"max(datum.lower_box_"+i.field+" - datum.iqr_"+i.field+" * "+n+", datum.min_"+i.field+")",as:"lower_whisker_"+i.field}]);var l=[],f=[],d=[],p={};return Mr(u,function(e,t){if(t!==o)if(sr(e)){if(e.aggregate&&e.aggregate!==Wr)c.push({op:e.aggregate,field:e.field,as:pr(e)});else if(void 0===e.aggregate){var n=pr(e),r=e.bin;if(r){var i=e.field;f.push({bin:r,field:i,as:n})}else if(e.timeUnit){var a=e.timeUnit;i=e.field,d.push({timeUnit:a,field:i,as:n})}l.push(n)}p[t]={field:pr(e),type:e.type}}else p[t]=u[t]}),{transform:[].concat(f,d,[{aggregate:c,groupby:l}],s),continuousAxisChannelDef:i,continuousAxis:o,encodingWithoutContinuousAxis:p}}(e,function(e){var t=e.mark,n=e.encoding;if(e.projection,De(e,["mark","encoding","projection"]),sr(n.x)&&mr(n.x)){if(sr(n.y)&&mr(n.y)){if(void 0===n.x.aggregate&&n.y.aggregate===Wr)return"vertical";if(void 0===n.y.aggregate&&n.x.aggregate===Wr)return"horizontal";if(n.x.aggregate===Wr&&n.y.aggregate===Wr)throw new Error("Both x and y cannot have aggregate");return Gr(t)&&t.orient?t.orient:"vertical"}return"horizontal"}if(sr(n.y)&&mr(n.y))return"vertical";throw new Error("Need a valid continuous axis for boxplots")}(e),o),d=f.transform,p=f.continuousAxisChannelDef,h=f.continuousAxis,m=f.encodingWithoutContinuousAxis,g=m.size,v=De(m,["color","size"]),y=g?{size:g}:qr(t.box,"size"),b={};return p.scale&&(b.scale=p.scale),p.axis&&(b.axis=p.axis),Ae({},a,{transform:d,layer:[{mark:{type:"rule",style:"boxWhisker"},encoding:Ae((u={},u[h]=Ae({field:"lower_whisker_"+p.field,type:p.type},b),u[h+"2"]={field:"lower_box_"+p.field,type:p.type},u),v,qr(t.boxWhisker,"color"))},{mark:{type:"rule",style:"boxWhisker"},encoding:Ae((c={},c[h]={field:"upper_box_"+p.field,type:p.type},c[h+"2"]={field:"upper_whisker_"+p.field,type:p.type},c),v,qr(t.boxWhisker,"color"))},Ae({},i?{selection:i}:{},{mark:{type:"bar",style:"box"},encoding:Ae((s={},s[h]={field:"lower_box_"+p.field,type:p.type},s[h+"2"]={field:"upper_box_"+p.field,type:p.type},s),m,m.color?{}:qr(t.box,"color"),y)}),{mark:{type:"tick",style:"boxMid"},encoding:Ae((l={},l[h]={field:"mid_box_"+p.field,type:p.type},l),v,qr(t.boxMid,"color"),y)}]})}),Vr("error-bar",function(e){e.mark,e.selection,e.projection;var t=e.encoding,n=De(e,["mark","selection","projection","encoding"]),r=(t.size,De(t,["size"])),i=(t.x2,t.y2,De(t,["x2","y2"])),a=De(i,["x","y"]);if(!t.x2&&!t.y2)throw new Error("Neither x2 or y2 provided");return Ae({},n,{layer:[{mark:"rule",encoding:r},{mark:"tick",encoding:i},{mark:"tick",encoding:t.x2?Ae({x:t.x2,y:t.y},a):Ae({x:t.x,y:t.y2},a)}]})});var Jr,Zr,$r=Object.freeze({add:Vr,remove:function(e){delete Yr[e]},COMPOSITE_MARK_STYLES:Xr,VL_ONLY_COMPOSITE_MARK_SPECIFIC_CONFIG_PROPERTY_INDEX:Qr,normalize:Kr}),ei=["shortTimeLabels"],ti={},ni={entryPadding:1,format:1,offset:1,orient:1,padding:1,tickCount:1,title:1,type:1,values:1,zindex:1},ri=Ae({},ni,{opacity:1,shape:1,stroke:1,fill:1,size:1,encode:1}),ii=oe(ni),ai=oe(ri),oi=Object.freeze({defaultLegendConfig:ti,LEGEND_PROPERTIES:ii,VG_LEGEND_PROPERTIES:ai});(Zr=Jr||(Jr={})).LINEAR="linear",Zr.BIN_LINEAR="bin-linear",Zr.LOG="log",Zr.POW="pow",Zr.SQRT="sqrt",Zr.TIME="time",Zr.UTC="utc",Zr.SEQUENTIAL="sequential",Zr.QUANTILE="quantile",Zr.QUANTIZE="quantize",Zr.THRESHOLD="threshold",Zr.ORDINAL="ordinal",Zr.BIN_ORDINAL="bin-ordinal",Zr.POINT="point",Zr.BAND="band";var ui={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric","bin-linear":"bin-linear",time:"time",utc:"time",sequential:"sequential",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position"},ci=ie(ui);function si(e,t){var n=ui[e],r=ui[t];return n===r||"ordinal-position"===n&&"time"===r||"ordinal-position"===r&&"time"===n}var li={linear:0,log:1,pow:1,sqrt:1,time:0,utc:0,point:10,band:11,"bin-linear":0,sequential:0,ordinal:0,"bin-ordinal":0};function fi(e){return li[e]}var di=["linear","bin-linear","log","pow","sqrt","time","utc"],pi=g(di),hi=di.concat(["sequential"]),mi=g(hi),gi=["ordinal","bin-ordinal","point","band"],vi=g(gi),yi=g(["bin-linear","bin-ordinal"]);function bi(e){return e in vi}function xi(e){return e in yi}function Si(e){return e in mi}function Ei(e){return e in pi}var wi={textXRangeStep:90,rangeStep:21,pointPadding:.5,bandPaddingInner:.1,facetSpacing:16,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4};function Ni(e){return e&&!!e.name}function ki(e){return e&&e.selection}var Oi={type:1,domain:1,range:1,rangeStep:1,scheme:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},_i=oe(Oi),Ti=oe(De(Oi,["type","domain","range","rangeStep","scheme"]));function Ci(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":return X(["sequential","ordinal","bin-ordinal","quantile","quantize"],e);case"interpolate":return X(["linear","bin-linear","pow","log","sqrt","utc","time"],e);case"round":return Ei(e)||"band"===e||"point"===e;case"padding":return Ei(e)||X(["point","band"],e);case"paddingOuter":case"rangeStep":return X(["point","band"],e);case"paddingInner":return"band"===e;case"clamp":return Ei(e)||"sequential"===e;case"nice":return Ei(e)||"sequential"===e||"quantize"===e;case"exponent":return"pow"===e;case"base":return"log"===e;case"zero":return Si(e)&&!X(["log","time","utc","bin-linear","threshold","quantile"],e)}throw new Error("Invalid scale property "+t+".")}function Ai(e,t){switch(t){case"interpolate":case"scheme":return pt(e)?void 0:rn.cannotUseScalePropertyWithNonColor(e);case"type":case"domain":case"range":case"base":case"exponent":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"rangeStep":case"reverse":case"round":case"clamp":case"zero":return}throw new Error('Invalid scale property "'+t+'".')}function Di(e,t){switch(e){case je.X:case je.Y:case je.SIZE:case je.OPACITY:return Ei(t)||X(["band","point"],t);case je.COLOR:case je.FILL:case je.STROKE:return"band"!==t;case je.SHAPE:return"ordinal"===t}return!1}var zi=Object.freeze({get ScaleType(){return Jr},SCALE_TYPES:ci,scaleCompatible:si,scaleTypePrecedence:fi,CONTINUOUS_TO_CONTINUOUS_SCALES:di,CONTINUOUS_DOMAIN_SCALES:hi,DISCRETE_DOMAIN_SCALES:gi,TIME_SCALE_TYPES:["time","utc"],hasDiscreteDomain:bi,isBinScale:xi,hasContinuousDomain:Si,isContinuousToContinuous:Ei,defaultScaleConfig:wi,isExtendedScheme:Ni,isSelectionDomain:ki,SCALE_PROPERTIES:_i,NON_TYPE_DOMAIN_RANGE_VEGA_SCALE_PROPERTIES:Ti,scaleTypeSupportProperty:Ci,channelScalePropertyIncompatability:Ai,channelSupportScaleType:Di}),Ii="_vgsid_";function Ri(e){var t=e.anchor,n=e.offset,r=e.orient,i=e.color,a=De(e,["anchor","offset","orient","color"]);return{mark:Ae({},a,i?{fill:i}:{}),nonMark:Ae({},t?{anchor:t}:{},n?{offset:n}:{},r?{orient:r}:{})}}var Li={width:200,height:200},Fi={padding:5,timeFormat:"%b %d, %Y",countTitle:"Number of Records",invalidValues:"filter",view:Li,mark:fn,area:{},bar:dn,circle:{},geoshape:{},line:{},point:{},rect:{},rule:{color:"black"},square:{},text:{color:"black"},tick:pn,trail:{},box:{size:14,extent:1.5},boxWhisker:{},boxMid:{color:"white"},scale:wi,projection:{},axis:{},axisX:{},axisY:{minExtent:30},axisLeft:{},axisRight:{},axisTop:{},axisBottom:{},axisBand:{},legend:ti,selection:{single:{on:"click",fields:[Ii],resolve:"global",empty:"all"},multi:{on:"click",fields:[Ii],toggle:"event.shiftKey",resolve:"global",empty:"all"},interval:{on:"[mousedown, window:mouseup] > window:mousemove!",encodings:["x","y"],translate:"[mousedown, window:mouseup] > window:mousemove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global"}},style:{},title:{}};function ji(e){return $(ue(Fi),e)}var Ui=["view"].concat(Zt,Xr),Mi=["padding","numberFormat","timeFormat","countTitle","stack","scale","selection","invalidValues","overlay"],Pi=Ae({view:["width","height"]},ln,Qr);function Hi(e){e=ue(e);for(var t=0,n=Mi;t<n.length;t++){delete e[a=n[t]]}if(e.axis)for(var r=0,i=ei;r<i.length;r++){var a=i[r];delete e.axis[a]}if(e.legend)for(var o=0,u=ei;o<u.length;o++){a=u[o];delete e.legend[a]}if(e.mark)for(var c=0,s=sn;c<s.length;c++){a=s[c];delete e.mark[a]}for(var l=0,f=Ui;l<f.length;l++){for(var d=f[l],p=0,h=sn;p<h.length;p++){a=h[p];delete e[d][a]}var m=Pi[d];if(m)for(var g=0,v=m;g<v.length;g++){a=v[g];delete e[d][a]}qi(e,d)}for(var a in qi(e,"title","group-title"),e)S(e[a])&&0===ie(e[a]).length&&delete e[a];return 0<ie(e).length?e:void 0}function qi(e,t,n){var r="title"===t?Ri(e.title).mark:e[t];"view"===t&&(n="cell");var i=Ae({},r,e.style[t]);0<ie(i).length&&(e.style[n||t]=i),delete e[t]}var Wi=Object.freeze({defaultViewConfig:Li,defaultConfig:Fi,initConfig:ji,stripAndRedirectConfig:Hi}),Gi={zero:1,center:1,normalize:1};function Bi(e){return!!Gi[e]}var Yi=[Mt,Ut,Yt,Ht,Xt,Qt,Pt,qt,Wt],Vi=[Mt,Ut];function Xi(e,t,n){var r=$t(e)?e.type:e;if(!X(Yi,r))return null;var i=function(e){var t=e.x,n=e.y;if(sr(t)&&sr(n))if("quantitative"===t.type&&"quantitative"===n.type){if(t.stack)return"x";if(n.stack)return"y";if(!!t.aggregate!=!!n.aggregate)return t.aggregate?"x":"y"}else{if("quantitative"===t.type)return"x";if("quantitative"===n.type)return"y"}else{if(sr(t)&&"quantitative"===t.type)return"x";if(sr(n)&&"quantitative"===n.type)return"y"}}(t);if(!i)return null;var a=t[i],o=lr(a)?pr(a,{}):void 0,u="x"===i?"y":"x",c=t[u],s=lr(c)?pr(c,{}):void 0,l=xt.reduce(function(r,i){if(Rr(t,i)){var e=t[i];(v(e)?e:[e]).forEach(function(e){var t=kr(e);if(!t.aggregate){var n=lr(t)?pr(t,{}):void 0;(!n||n!==s&&n!==o)&&r.push({channel:i,fieldDef:t})}})}return r},[]);if(0===l.length)return null;var f=void 0;return(f=void 0!==a.stack?a.stack:X(Vi,r)&&void 0===n?"zero":n)&&Bi(f)?(a.scale&&a.scale.type&&a.scale.type!==Jr.LINEAR&&vn(rn.cannotStackNonLinearScale(a.scale.type)),Rr(t,i===qe?Ge:Be)?(vn(rn.cannotStackRangedMark(i)),null):(a.aggregate&&!X(Ne,a.aggregate)&&vn(rn.stackNonSummativeAggregate(a.aggregate)),{groupbyChannel:c?u:void 0,fieldChannel:i,impute:Jt(r),stackBy:l,offset:f})):null}var Qi=Object.freeze({isStackOffset:Bi,STACKABLE_MARKS:Yi,STACK_BY_DEFAULT_MARKS:Vi,stack:Xi});function Ki(e){return void 0!==e.facet}function Ji(e){return!!e.mark}function Zi(e){return void 0!==e.layer}function $i(e){return void 0!==e.repeat}function ea(e){return ta(e)||na(e)}function ta(e){return void 0!==e.vconcat}function na(e){return void 0!==e.hconcat}function ra(e,t){if(Ki(e))return r=t,i=(n=e).spec,a=De(n,["spec"]),Ae({},a,{spec:ra(i,r)});var n,r,i,a,o,u,c,s,l,f,d,p,h,m,g,v,y,b,x,S,E,w,N,k,O,_,T,C;if(Zi(e))return function t(e,n,r,i){var a=e.layer,o=e.encoding,u=e.projection,c=De(e,["layer","encoding","projection"]);var s=ia({parentEncoding:r,encoding:o});var l=aa({parentProjection:i,projection:u});return Ae({},c,{layer:a.map(function(e){return Zi(e)?t(e,n,s,l):oa(e,n,s,l)})})}(e,t);if($i(e))return u=t,c=(o=e).spec,s=De(o,["spec"]),Ae({},s,{spec:ra(c,u)});if(ta(e))return f=t,d=(l=e).vconcat,p=De(l,["vconcat"]),Ae({},p,{vconcat:d.map(function(e){return ra(e,f)})});if(na(e))return m=t,g=(h=e).hconcat,v=De(h,["hconcat"]),Ae({},v,{hconcat:g.map(function(e){return ra(e,m)})});if(Ji(e)){var A=Rr(e.encoding,Ke),D=Rr(e.encoding,Je);return A||D?(b=t,x=(y=e).encoding,S=x.row,E=x.column,w=De(x,["row","column"]),N=y.mark,k=y.width,O=y.projection,_=y.height,T=y.selection,y.encoding,C=De(y,["mark","width","projection","height","selection","encoding"]),Ae({},C,{facet:Ae({},S?{row:S}:{},E?{column:E}:{}),spec:oa(Ae({},O?{projection:O}:{},{mark:N},k?{width:k}:{},_?{height:_}:{},{encoding:w},T?{selection:T}:{}),b)})):oa(e,t)}throw new Error(rn.INVALID_SPEC)}function ia(e){var t=e.parentEncoding,n=e.encoding;if(t&&n){var r=ie(t).reduce(function(e,t){return n[t]&&e.push(t),e},[]);0<r.length&&vn(rn.encodingOverridden(r))}var i=Ae({},t||{},n||{});return 0<ie(i).length?i:void 0}function aa(e){var t=e.parentProjection,n=e.projection;return t&&n&&vn(rn.projectionOverridden({parentProjection:t,projection:n})),n||t}function oa(e,t,n,r){var i=e.encoding,a=e.projection,o=$t(e.mark)?e.mark.type:e.mark;if(n||r){var u=aa({parentProjection:r,projection:a}),c=ia({parentEncoding:n,encoding:i});return oa(Ae({},e,u?{projection:u}:{},c?{encoding:c}:{}),t)}return tn(e.mark)?jr(i)?function(e){var t=Rr(e.encoding,qe),n=Rr(e.encoding,We),r=Rr(e.encoding,Ge),i=Rr(e.encoding,Be);if(r&&!t||i&&!n){var a=ue(e);return r&&!t&&(a.encoding.x=a.encoding.x2,delete a.encoding.x2),i&&!n&&(a.encoding.y=a.encoding.y2,delete a.encoding.y2),a}return e}(e):"line"===o&&(i.x2||i.y2)?(vn(rn.lineWithRange(!!i.x2,!!i.y2)),oa(Ae({mark:"rule"},e),t,n,r)):Jt(o)?function(e,t){void 0===t&&(t={});var n=e.selection,r=e.projection,i=e.encoding,a=e.mark,o=De(e,["selection","projection","encoding","mark"]),u=$t(a)?a:{type:a},c=(d=u,p=t[u.type],h=i,"transparent"===d.point?{opacity:0}:d.point?S(d.point)?d.point:{}:void 0!==d.point?null:p.point||h.shape?S(p.point)?p.point:{}:null),s="area"===u.type&&(l=u,f=t[u.type],l.line?!0===l.line?{}:l.line:void 0!==l.line?null:f.line?!0===f.line?{}:f.line:null);var l,f;var d,p,h;if(!c&&!s)return Ae({},e,{mark:ua(u)});var m,g=[{mark:ua(Ae({},u,"area"===u.type?{opacity:.7}:{})),encoding:i}],v=Xi(u,i,t?t.stack:void 0),y=i;if(v){var b=v.fieldChannel,x=v.offset;y=Ae({},i,((m={})[b]=Ae({},i[b],x?{stack:x}:{}),m))}s&&g.push(Ae({},r?{projection:r}:{},{mark:Ae({type:"line"},s)},n?{selection:n}:{},{encoding:y}));c&&g.push(Ae({},r?{projection:r}:{},{mark:Ae({type:"point",opacity:1,filled:!0},c)},n?{selection:n}:{},{encoding:y}));return Ae({},o,{layer:g})}(e,t):e:Kr(e,t)}function ua(e){e.point,e.line;var t=De(e,["point","line"]);return 1<ie(t).length?t:t.type}function ca(t,e){return e.forEach(function(n){var e=V(["field","type","value","timeUnit","bin","aggregate"].reduce(function(e,t){return void 0!==n[t]&&(e[t]=n[t]),e},{}));t[e]=t[e]||n}),t}var sa=Object.freeze({isFacetSpec:Ki,isUnitSpec:Ji,isLayerSpec:Zi,isRepeatSpec:$i,isConcatSpec:ea,isVConcatSpec:ta,isHConcatSpec:na,normalize:ra,fieldDefs:function(e){return ae(function t(e,n){return void 0===n&&(n={}),Zi(e)?e.layer.forEach(function(e){Ji(e)?ca(n,Ur(e.encoding)):t(e,n)}):Ki(e)?(ca(n,Ur(e.facet)),t(e.spec,n)):$i(e)?t(e.spec,n):ea(e)?(ta(e)?e.vconcat:e.hconcat).forEach(function(e){return t(e,n)}):ca(n,Ur(e.encoding)),n}(e))},isStacked:function(e,t){return t=t||e.config,!!tn(e.mark)&&null!==Xi(e.mark,e.encoding,t?t.stack:void 0)}});function la(e){return y(e)?{type:e}:e||{}}var fa=["background","padding","datasets"];function da(n){return fa.reduce(function(e,t){return n&&void 0!==n[t]&&(e[t]=n[t]),e},{})}function pa(e){return!!e.url}function ha(e){return!!e.values}function ma(e){return!!e.name}var ga="main",va="raw",ya=Object.freeze({isUrlData:pa,isInlineData:ha,isNamedData:ma,MAIN:ga,RAW:va});function ba(e,t,n){return xa=t||Ea,Sa=n||za,Ra(e.trim()).map(La)}var xa,Sa,Ea="view",wa="[",Na="]",ka="{",Oa="}",_a=":",Ta=",",Ca="@",Aa=">",Da=/[[\]{}]/,za={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};function Ia(e,t,n,r,i){for(var a,o=0,u=e.length;t<u;++t){if(a=e[t],!o&&a===n)return t;i&&0<=i.indexOf(a)?--o:r&&0<=r.indexOf(a)&&++o}return t}function Ra(e){for(var t=[],n=0,r=e.length,i=0;i<r;)i=Ia(e,i,Ta,wa+ka,Na+Oa),t.push(e.substring(n,i).trim()),n=++i;if(0===t.length)throw"Empty event selector: "+e;return t}function La(e){return"["===e[0]?function(e){var t,n,r=e.length,i=1;if((i=Ia(e,i,Na,wa,Na))===r)throw"Empty between selector: "+e;if(2!==(t=Ra(e.substring(1,i))).length)throw"Between selector must have two elements: "+e;if((e=e.slice(i+1).trim())[0]!==Aa)throw"Expected '>' after between selector: "+e;{if(t=t.map(La),(n=La(e.slice(1).trim())).between)return{between:t,stream:n};n.between=t}return n}(e):function(t){var e,n,r={source:xa},i=[],a=[0,0],o=0,u=0,c=t.length,s=0;if(t[c-1]===Oa){if(!(0<=(s=t.lastIndexOf(ka))))throw"Unmatched right brace: "+t;try{a=function(n){var e=n.split(Ta);if(!n.length||2<e.length)throw n;return e.map(function(e){var t=+e;if(t!=t)throw n;return t})}(t.substring(s+1,c-1))}catch(e){throw"Invalid throttle specification: "+t}t=t.slice(0,s).trim(),c=t.length,s=0}if(!c)throw t;t[0]===Ca&&(o=++s);(e=Ia(t,s,_a))<c&&(i.push(t.substring(u,e).trim()),u=s=++e);if((s=Ia(t,s,wa))===c)i.push(t.substring(u,c).trim());else if(i.push(t.substring(u,s).trim()),n=[],(u=++s)===c)throw"Unmatched left bracket: "+t;for(;s<c;){if((s=Ia(t,s,Na))===c)throw"Unmatched left bracket: "+t;if(n.push(t.substring(u,s).trim()),s<c-1&&t[++s]!==wa)throw"Expected left bracket: "+t;u=++s}if(!(c=i.length)||Da.test(i[c-1]))throw"Invalid event selector: "+t;1<c?(r.type=i[1],o?r.markname=i[0].slice(1):(l=i[0],Sa.hasOwnProperty(l)?r.marktype=i[0]:r.source=i[0])):r.type=i[0];var l;"!"===r.type.slice(-1)&&(r.consume=!0,r.type=r.type.slice(0,-1));null!=n&&(r.filter=n);a[0]&&(r.throttle=a[0]);a[1]&&(r.debounce=a[1]);return r}(e)}function Fa(e){return void 0!==e.filter}function ja(e){return void 0!==e.lookup}function Ua(e){return void 0!==e.window}function Ma(e){return void 0!==e.calculate}function Pa(e){return!!e.bin}function Ha(e){return void 0!==e.timeUnit}function qa(e){return void 0!==e.aggregate}function Wa(e){return e.map(function(e){return Fa(e)?{filter:function t(e,n){return G(e)?{not:t(e.not,n)}:W(e)?{and:e.and.map(function(e){return t(e,n)})}:q(e)?{or:e.or.map(function(e){return t(e,n)})}:n(e)}(e.filter,jc)}:e})}var Ga=Object.freeze({isFilter:Fa,isLookup:ja,isWindow:Ua,isCalculate:Ma,isBin:Pa,isTimeUnit:Ha,isAggregate:qa,normalizeTransform:Wa});function Ba(e){return!!e.signal}function Ya(e){return!!e.step}function Va(e){return!v(e)&&("field"in e&&"data"in e)}var Xa=oe({opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,limit:1,dx:1,dy:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,cursor:1,href:1});function Qa(e,n,t,r){void 0===r&&(r={header:!1});var i=e.combine(),a=i.orient,o=i.scale,u=i.title,c=i.zindex,s=De(i,["orient","scale","title","zindex"]);if(ie(s).forEach(function(e){var t=Ie[e];t&&t!==n&&"both"!==t&&delete s[e]}),"grid"===n){if(!s.grid)return;if(s.encode){var l=s.encode.grid;s.encode=Ae({},l?{grid:l}:{}),0===ie(s.encode).length&&delete s.encode}return Ae({scale:o,orient:a},s,{domain:!1,labels:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:void 0!==c?c:0})}if(r.header||!e.mainExtracted){if(s.encode){for(var f=0,d=ze;f<d.length;f++){var p=d[f];e.hasAxisPart(p)||delete s.encode[p]}0===ie(s.encode).length&&delete s.encode}var h,m,g=(m=t,v(h=u)?h.map(function(e){return wr(e,m)}).join(", "):h);return Ae({scale:o,orient:a},g?{title:g}:{},s,{zindex:void 0!==c?c:1})}}function Ka(e){return[].concat(e.type,e.style||[])}function Ja(e,t,n){var r=n.mark[e],i=n[t.type];void 0!==i[e]&&(r=i[e]);for(var a=0,o=Ka(t);a<o.length;a++){var u=o[a],c=n.style[u],s=e;c&&void 0!==c[s]&&(r=c[s])}return r}function Za(e,t,n,r){var i=eo(e,t,r);if(e.bin)return{signal:ro(pr(e,{expr:n}),pr(e,{expr:n,binSuffix:"end"}),i,r)};if("quantitative"===e.type)return{signal:""+to(pr(e,{expr:n,binSuffix:"range"}),i)};if(zr(e)){var a=dr(e)&&e.scale&&e.scale.type===Jr.UTC;return{signal:io(pr(e,{expr:n}),e.timeUnit,t,r.text.shortTimeLabels,r.timeFormat,a)}}return{signal:"''+"+pr(e,{expr:n})}}function $a(e,t){return void 0!==e?e:t}function eo(e,t,n){if(e.type===Kn)return t||n.numberFormat}function to(e,t){return"format("+e+', "'+(t||"")+'")'}function no(e,t,n){return to(e,t||n.numberFormat)}function ro(e,t,n,r){return e+" === null || isNaN("+e+') ? "null" : '+no(e,n,r)+' + " - " + '+no(t,n,r)}function io(e,t,n,r,i,a){if(!t||n){var o=n||i;return a?"utcFormat("+e+", '"+o+"')":"timeFormat("+e+", '"+o+"')"}return Gn(t,e,r,a)}function ao(e,n){return(v(e)?e:[e]).reduce(function(e,t){return e.field.push(pr(t,n)),e.order.push(t.sort||"ascending"),e},{field:[],order:[]})}function oo(e,t){var i=e.slice();return t.forEach(function(e){for(var t=0,n=i;t<n.length;t++){var r=n[t];if(Y(r)===Y(e))return}i.push(e)}),i}function uo(e,t){if(v(e.value)&&v(t.value))return{explicit:e.explicit,value:oo(e.value,t.value)};if(!v(e.value)&&!v(t.value))return{explicit:e.explicit,value:e.value===t.value?e.value:e.value+", "+t.value};throw new Error("It should never reach here")}function co(e,t){return e.bin?_t(t)&&X(["ordinal","nominal"],e.type):(console.warn("Only use this method with binned field defs"),!1)}var so=["row","column"],lo=["header","footer"];function fo(e,t){for(var n=e.component.layoutHeaders[t],r=[],i=0,a=lo;i<a.length;i++){var o=a[i];if(n[o])for(var u=0,c=n[o];u<c.length;u++){var s=c[u];r.push(po(e,t,o,n,s))}}return r}function po(e,t,n,r,i){if(i){var a=null,o=r.facetFieldDef;if(o&&i.labels){var u=o.header,c=void 0===u?{}:u,s=c.format,l=c.labelAngle,f=Ae({},void 0!==l?{angle:{value:l}}:{},(90+(g=((g=l)%360+360)%360))%180==0?{}:g<90||270<g?{align:{value:"right"}}:135<=g&&g<225?{align:{value:"left"}}:{},45<=(m=((m=l)%360+360)%360)&&m<=135?{baseline:{value:"top"}}:{});a=Ae({text:Za(o,s,"parent",e.config),offset:10,orient:"row"===t?"left":"top",style:"guide-label"},0<ie(f).length?{encode:{update:f}}:{})}var d=i.axes,p=d&&0<d.length;if(a||p){var h="row"===t?"height":"width";return Ae({name:e.getName(t+"_"+n),type:"group",role:t+"-"+n},r.facetFieldDef?{from:{data:e.getName(t+"_domain")},sort:{field:pr(o,{expr:"datum"}),order:o.sort||"ascending"}}:{},a?{title:a}:{},i.sizeSignal?{encode:{update:(v={},v[h]=i.sizeSignal,v)}}:{},p?{axes:d}:{})}}var m,g,v;return null}function ho(e){return[].concat(mo(e,"width"),mo(e,"height"))}function mo(e,t){var n="width"===t?"x":"y",r=e.component.layoutSize.get(t);if(!r||"merged"===r)return[];var i=e.getSizeSignalRef(t).signal;if("range-step"===r){var a=e.getScaleComponent(n);if(a){var o=a.get("type"),u=a.get("range");if(bi(o)&&Ya(u)){var c=e.scaleName(n);if(Gu(e.parent))if("independent"===e.parent.component.resolve.scale[n])return[go(c,u)];return[go(c,u),{name:i,update:vo(c,a,"domain('"+c+"').length")}]}}throw new Error("layout size is range step although there is no rangeStep.")}return[{name:i,value:r}]}function go(e,t){return{name:e+"_step",value:t.step}}function vo(e,t,n){var r=t.get("type"),i=t.get("padding"),a=t.get("paddingOuter");a=void 0!==a?a:i;var o=t.get("paddingInner");return"bandspace("+n+", "+(o="band"===r?void 0!==o?o:i:1)+", "+a+") * "+e+"_step"}function yo(e,t){var n=e.scale[t],r=X(Et,t)?"axis":"legend";return"independent"===n?("shared"===e[r][t]&&vn(rn.independentScaleMeansIndependentGuide(t)),"independent"):e[r][t]||"shared"}var bo=function(){function e(e,t){void 0===e&&(e={}),void 0===t&&(t={}),this.explicit=e,this.implicit=t}return e.prototype.clone=function(){return new e(ue(this.explicit),ue(this.implicit))},e.prototype.combine=function(){return Ae({},this.explicit,this.implicit)},e.prototype.get=function(e){return void 0!==this.explicit[e]?this.explicit[e]:this.implicit[e]},e.prototype.getWithExplicit=function(e){return void 0!==this.explicit[e]?{explicit:!0,value:this.explicit[e]}:void 0!==this.implicit[e]?{explicit:!1,value:this.implicit[e]}:{explicit:!1,value:void 0}},e.prototype.setWithExplicit=function(e,t){void 0!==t.value&&this.set(e,t.value,t.explicit)},e.prototype.set=function(e,t,n){return delete this[n?"implicit":"explicit"][e],this[n?"explicit":"implicit"][e]=t,this},e.prototype.copyKeyFromSplit=function(e,t){void 0!==t.explicit[e]?this.set(e,t.explicit[e],!0):void 0!==t.implicit[e]&&this.set(e,t.implicit[e],!1)},e.prototype.copyKeyFromObject=function(e,t){void 0!==t[e]&&this.set(e,t[e],!0)},e}();function xo(e){return{explicit:!0,value:e}}function So(e){return{explicit:!1,value:e}}function Eo(a){return function(e,t,n,r){var i=a(e.value,t.value);return 0<i?e:i<0?t:wo(e,t,n,r)}}function wo(e,t,n,r){return e.explicit&&t.explicit&&vn(rn.mergeConflictingProperty(n,r,e.value,t.value)),e}function No(e,t,n,r,i){return void 0===i&&(i=wo),void 0===e||void 0===e.value?t:e.explicit&&!t.explicit?e:t.explicit&&!e.explicit?t:Y(e.value)===Y(t.value)?e:i(e,t,n,r)}var ko=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ce(t,e),t}(bo);function Oo(e,t,n,r){return _o(e,t,{binSuffix:"start"===n?void 0:"end"},r?{offset:r}:{})}function _o(e,t,n,r){var i=Ae({},t?{scale:t}:{},{field:pr(e,n)});return r?Ae({},i,r):i}function To(e,t){return void 0===t&&(t=!0),{scale:e,band:t}}function Co(e,t,n,r,i,a){if(t){if(sr(t)){if(t.bin)return X([qe,We],e)&&t.type===Kn?i&&i.impute?_o(t,n,{binSuffix:"mid"}):{signal:'(scale("'+(c=n)+'", '+pr(u=t,{expr:"datum"})+') + scale("'+c+'", '+pr(u,{binSuffix:"end",expr:"datum"})+"))/2"}:_o(t,n,co(t,e)?{binSuffix:"range"}:{});if(r){var o=r.get("type");if(bi(o))return"band"===o?_o(t,n,{binSuffix:"range"},{band:.5}):_o(t,n,{binSuffix:"range"})}return _o(t,n,{})}if(fr(t))return{value:t.value}}var u,c;return a}function Ao(e,t){if(e){if(sr(e))return Za(e,e.format,"datum",t);if(fr(e))return{value:e.value}}}function Do(e){return Ae({},e,{mult:.5})}function zo(e,t,n,r,i){if(y(e)){if(n){var a=r.get("type");if(X([Jr.LOG,Jr.TIME,Jr.UTC],a))"bar"!==i&&"area"!==i||vn(rn.nonZeroScaleUsedWithLengthMark(i,t,{scaleType:a}));else{if(function(e){if(!1!==e.get("zero"))return!0;var t=e.domains;return!!v(t)&&K(t,function(e){return v(e)&&2===e.length&&e[0]<=0&&0<=e[1]})}(r))return{scale:n,value:0};"bar"!==i&&"area"!==i||vn(rn.nonZeroScaleUsedWithLengthMark(i,t,{zeroFalse:!1===r.explicit.zero}))}}return"zeroOrMin"===e?"x"===t?{value:0}:{field:{group:"height"}}:"x"===t?{field:{group:"width"}}:{value:0}}return e}function Io(e,t){void 0===t&&(t={valueOnly:!1});var n,r,i=e.markDef,a=e.encoding,o=e.config,u=i.filled,c=i.type,s={fill:Ja("fill",i,o),stroke:Ja("stroke",i,o),color:Ja("color",i,o)},l=X(["bar","point","circle","square","geoshape"],c)?"transparent":void 0,f={fill:i.fill||s.fill||l,stroke:i.stroke||s.stroke},d=u?"fill":"stroke",p=Ae({},f.fill?{fill:{value:f.fill}}:{},f.stroke?{stroke:{value:f.stroke}}:{});return a.fill||a.stroke?(i.color&&vn(rn.droppingColor("property",{fill:"fill"in a,stroke:"stroke"in a})),Ae({},jo("fill",e,{defaultValue:f.fill||l}),jo("stroke",e,{defaultValue:f.stroke}))):a.color?Ae({},p,jo("color",e,{vgChannel:d,defaultValue:i[d]||i.color||s[d]||s.color||(u?l:void 0)})):i.fill||i.stroke?(i.color&&vn(rn.droppingColor("property",{fill:"fill"in i,stroke:"stroke"in i})),p):i.color?Ae({},p,((n={})[d]={value:i.color},n)):s.fill||s.stroke?p:s.color?Ae({},l?{fill:{value:"transparent"}}:{},((r={})[d]={value:s.color},r)):{}}function Ro(e,t){return Ae({},(n=e.markDef,r=t,Xa.reduce(function(e,t){return void 0!==n[t]&&"ignore"!==r[t]&&(e[t]={value:n[t]}),e},{})),Io(e),jo("opacity",e),function(r){var e="tooltip",t=r.encoding[e];{if(v(t)){var n=t.map(function(e){var t=void 0!==e.title?e.title:pr(e,{binSuffix:"range"}),n=Ao(e,r.config).signal;return'"'+t+'": '+n});return{tooltip:{signal:"{"+n.join(", ")+"}"}}}return Po(r,e,t)}}(e),Mo(e,"href"));var n,r}function Lo(e){return e+" !== null && !isNaN("+e+")"}function Fo(n){if("filter"===n.config.invalidValues){var e=["x","y"].map(function(e){var t=n.getScaleComponent(e);if(t&&Si(t.get("type")))return n.vgField(e,{expr:"datum"})}).filter(function(e){return!!e}).map(Lo);if(0<e.length)return{defined:{signal:e.join(" && ")}}}return{}}function jo(t,n,e){void 0===e&&(e={});var r=e.defaultValue,i=e.vgChannel,a=e.defaultRef||(void 0!==r?{value:r}:void 0),o=n.encoding[t];return Uo(n,o,i||t,function(e){return Co(t,e,n.scaleName(t),n.getScaleComponent(t),null,a)})}function Uo(r,e,t,i){var n,a,o=e&&e.condition,u=i(e);if(o){var c=(v(o)?o:[o]).map(function(e){var t=i(e),n=rr(e)?wc(r,e.selection):Lc(r,e.test);return Ae({test:n},t)});return(n={})[t]=c.concat(void 0!==u?[u]:[]),n}return void 0!==u?((a={})[t]=u,a):{}}function Mo(e,t){return void 0===t&&(t="text"),Po(e,t,e.encoding[t])}function Po(t,e,n){return Uo(t,n,e,function(e){return Ao(e,t.config)})}function Ho(e,t,n){var r,i,a,o=n.scaleName(t),u="x"===t?"width":"height";if(n.encoding.size||void 0!==n.markDef.size)if(n.markDef.orient){var c=((r={})[t+"c"]=_o(e,o,{},{band:.5}),r);if(kr(n.encoding.size))vn(rn.cannotUseSizeFieldWithBandSize(t));else{if(fr(n.encoding.size))return Ae({},c,jo("size",n,{vgChannel:u}));if(void 0!==n.markDef.size)return Ae({},c,((i={})[u]={value:n.markDef.size},i))}}else vn(rn.cannotApplySizeToNonOrientedMark(n.markDef.type));return(a={})[t]=_o(e,o,{binSuffix:"range"}),a[u]=To(o),a}function qo(e,t,n,r){var i="x"===e?"width":"height";return Ae({},Go(e,t,n,"x"===e?"xc":"yc"),jo("size",t,{defaultRef:r,vgChannel:i}))}function Wo(e,t,n,r,i){return"x"===t?{x2:Oo(e,n,"start",i?0:r),x:Oo(e,n,"end",i?r:0)}:{y2:Oo(e,n,"start",i?r:0),y:Oo(e,n,"end",i?0:r)}}function Go(e,t,n,r){var i,a,o,u,c,s,l,f=t.encoding,d=t.mark,p=t.stack,h=f[e],m=t.scaleName(e),g=t.getScaleComponent(e),v=h||!f.latitude&&!f.longitude?(a=f[i=e],c=p,s=zo(n,e,o=m,u=g,d),sr(a)&&c&&i===c.fieldChannel?_o(a,o,{suffix:"end"}):Co(i,a,o,u,c,s)):{field:t.getName(e)};return(l={})[r||e]=v,l}function Bo(e,t,n){var r,i,a,o,u,c,s,l,f=e.encoding,d=e.mark,p=e.markDef,h=e.stack,m="x2"===(n=n||("horizontal"===p.orient?"x2":"y2"))?"x":"y",g=f[m],v=e.scaleName(m),y=e.getScaleComponent(m),b=g||!f.latitude&&!f.longitude?(i=g,a=f[r=n],c=h,s=zo(t,m,o=v,u=y,d),sr(i)&&c&&r.charAt(0)===c.fieldChannel.charAt(0)?_o(i,o,{suffix:"start"}):Co(r,a,o,u,c,s)):{field:e.getName(n)};return(l={})[n]=b,l}function Yo(e){return Xo(e,function(e,t){return Math.max(e,t.value)})}function Vo(e){return Xo(e,function(e,t){return void 0!==e?e:t.value})}function Xo(e,t){return cr(e)?(v(e.condition)?e.condition:[e.condition]).reduce(t,e.value):fr(e)?e.value:void 0}var Qo=Object.freeze({symbols:function(e,t,n,r,i){if("gradient"!==i){var a=Ae({},function(e,t,n){for(var r=0,i=n;r<i.length;r++){var a=i[r],o=Ja(a,t.markDef,t.config);void 0!==o&&(e[a]={value:o})}return e}({},n,cn),Io(n));switch(n.mark){case Mt:case Wt:case qt:a.shape={value:"square"};break;case Xt:case Qt:a.shape={value:n.mark}}var o=n.markDef,u=n.encoding,c=o.filled;if(a.fill)if("fill"===r||c&&r===et)delete a.fill;else if(a.fill.field)delete a.fill;else if(v(a.fill)){var s=Vo(u.fill||u.color)||o.fill||c&&o.color;s&&(a.fill={value:s})}if(a.stroke)if("stroke"===r||!c&&r===et)delete a.stroke;else if(a.stroke.field)delete a.stroke;else if(v(a.stroke)){var l=Vo(u.stroke||u.color)||o.stroke||!c&&o.color;l&&(a.stroke={value:l})}if(a.fill&&"transparent"!==a.fill.value&&!a.stroke&&(a.stroke={value:"transparent"}),r!==Ze){var f=Vo(u.shape)||o.shape;f&&(a.shape={value:f})}if(r!==ut){var d=Yo(u.opacity)||o.opacity;d&&(a.opacity={value:d})}return a=Ae({},a,t),0<ie(a).length?a:void 0}},gradient:function(e,t,n,r,i){var a={};if("gradient"===i){var o=Yo(n.encoding.opacity)||n.markDef.opacity;o&&(a.opacity={value:o})}return a=Ae({},a,t),0<ie(a).length?a:void 0},labels:function(e,t,n,r,i){var a=n.legend(r),o=n.config,u={};if(zr(e)){var c=n.getScaleComponent(r).get("type")===Jr.UTC;t=Ae({text:{signal:io("datum.value",e.timeUnit,a.format,o.legend.shortTimeLabels,o.timeFormat,c)}},t)}return u=Ae({},u,t),0<ie(u).length?u:void 0}});function Ko(e){var r,i;Wu(e)?e.component.legends=(i=(r=e).encoding,[et,tt,nt,$e,Ze,ut].reduce(function(e,t){var n=i[t];return!r.legend(t)||!r.getScaleComponent(t)||sr(n)&&t===Ze&&n.type===er||(e[t]=function(r,i){var a=r.fieldDef(i),o=r.legend(i),u=new ko({},function(e,t){switch(t){case et:var n=e.scaleName(et);return e.markDef.filled?{fill:n}:{stroke:n};case tt:case nt:case $e:case Ze:case ut:return(r={})[t]=e.scaleName(t),r}var r}(r,i));ii.forEach(function(e){var t=function(e,t,n,r){var i,a=r.fieldDef(n);switch(e){case"format":return eo(a,t.format,r.config);case"title":var o=void 0!==a.title?a.title:t.title||(void 0===t.title?void 0:null);return $a(o,wr(a,r.config))||void 0;case"values":return(i=t.values)&&bn(i[0])?i.map(function(e){return{signal:Nn(e,!0)}}):i;case"type":return $a(t.type,function(e,t,n){if(pt(t)&&("quantitative"===e&&!xi(n)||"temporal"===e&&X(["time","utc"],n)))return"gradient"}(a.type,n,r.getScaleComponent(n).get("type")))}return t[e]}(e,o,i,r);if(void 0!==t){var n="values"===e?!!o.values:t===o[e];(n||void 0===r.config.legend[e])&&u.set(e,t,n)}});var c=o.encoding||{},e=["labels","legend","title","symbols","gradient"].reduce(function(e,t){var n=Qo[t]?Qo[t](a,c[t],r,i,u.get("type")):c[t];return void 0!==n&&0<ie(n).length&&(e[t]={update:n}),e},{});return 0<ie(e).length&&u.set("encode",e,!!o.encoding),u}(r,t)),e},{})):e.component.legends=function(i){for(var e=i.component,n=e.legends,a=e.resolve,t=function(t){Ko(t),ie(t.component.legends).forEach(function(e){a.legend[e]=yo(i.component.resolve,e),"shared"===a.legend[e]&&(n[e]=Jo(n[e],t.component.legends[e]),n[e]||(a.legend[e]="independent",delete n[e]))})},r=0,o=i.children;r<o.length;r++){var u=o[r];t(u)}return ie(n).forEach(function(e){for(var t=0,n=i.children;t<n.length;t++){var r=n[t];r.component.legends[e]&&"shared"===a.legend[e]&&delete r.component.legends[e]}}),n}(e)}function Jo(t,r){if(!t)return r.clone();var e=t.getWithExplicit("orient"),n=r.getWithExplicit("orient");if(!e.explicit||!n.explicit||e.value===n.value){for(var i=!1,a=function(n){var e=No(t.getWithExplicit(n),r.getWithExplicit(n),n,"legend",function(e,t){switch(n){case"title":return uo(e,t);case"type":return i=!0,So("symbol")}return wo(e,t,n,"legend")});t.setWithExplicit(n,e)},o=0,u=ai;o<u.length;o++){a(u[o])}return i&&(((t.implicit||{}).encode||{}).gradient&&fe(t.implicit,["encode","gradient"]),((t.explicit||{}).encode||{}).gradient&&fe(t.explicit,["encode","gradient"])),t}}function Zo(e){for(var t=e.component.legends,n={},r=0,i=ie(t);r<i.length;r++){var a=i[r],o=e.getScaleComponent(a),u=Y(o.domains);if(n[u])for(var c=0,s=n[u];c<s.length;c++){Jo(s[c],t[a])||n[u].push(t[a])}else n[u]=[t[a].clone()]}return Z(ae(n)).map(function(e){return e.combine()})}function $o(e){return Vu(e)||Yu(e)||Bu(e)?(t=e).children.reduce(function(e,t){return e.concat(t.assembleProjections())},eu(t)):eu(e);var t}function eu(r){var e=r.component.projection;if(!e||e.merged)return[];var t=e.combine(),n=t.name,i=De(t,["name"]),a={signal:"["+e.size.map(function(e){return e.signal}).join(", ")+"]"},o=e.data.reduce(function(e,t){var n=Ba(t)?t.signal:"data('"+r.lookupDataSource(t)+"')";return X(e,n)||e.push(n),e},[]);if(o.length<=0)throw new Error("Projection's fit didn't find any data sources");return[Ae({name:n,size:a,fit:{signal:1<o.length?"["+o.join(", ")+"]":o[0]}},i)]}var tu=["type","clipAngle","clipExtent","center","rotate","precision","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"],nu=function(a){function e(e,t,n,r){var i=a.call(this,Ae({},t),{name:e})||this;return i.specifiedProjection=t,i.size=n,i.data=r,i.merged=!1,i}return Ce(e,a),e}(bo);function ru(e){Wu(e)?e.component.projection=function(t){var e=t.specifiedProjection,n=t.markDef,r=t.config,i=t.encoding,a=n&&n.type===Vt,o=i&&ft.some(function(e){return sr(i[e])});if(a||o){var u=[];return[[Xe,Ye],[Qe,Ve]].forEach(function(e){(t.channelHasField(e[0])||t.channelHasField(e[1]))&&u.push({signal:t.getName("geojson_"+u.length)})}),t.channelHasField(Ze)&&t.fieldDef(Ze).type===er&&u.push({signal:t.getName("geojson_"+u.length)}),0===u.length&&u.push(t.requestDataName(ga)),new nu(t.projectionName(!0),Ae({},r.projection||{},e||{}),[t.getSizeSignalRef("width"),t.getSizeSignalRef("height")],u)}return}(e):e.component.projection=function(e){if(0===e.children.length)return;var r,t=J(e.children,function(e){ru(e);var t=e.component.projection;if(t){if(r){var n=function(t,n){var e=J(tu,function(e){return!t.explicit.hasOwnProperty(e)&&!n.explicit.hasOwnProperty(e)||!(!t.explicit.hasOwnProperty(e)||!n.explicit.hasOwnProperty(e)||Y(t.get(e))!==Y(n.get(e)))});if(Y(t.size)===Y(n.size)){if(e)return t;if(Y(t.explicit)===Y({}))return n;if(Y(n.explicit)===Y({}))return t}return null}(r,t);return n&&(r=n),!!n}return r=t,!0}return!0});if(r&&t){var n=e.projectionName(!0),i=new nu(n,r.specifiedProjection,r.size,ue(r.data));return e.children.forEach(function(e){e.component.projection&&(i.data=i.data.concat(e.component.projection.data),e.renameProjection(e.component.projection.get("name"),n),e.component.projection.merged=!0)}),i}return}(e)}function iu(e){return!(!e||"count"!==e.op&&!e.field||!e.op)}function au(e){return!!e&&v(e)&&e.every(function(e){return y(e)})}var ou=Object.freeze({isSortField:iu,isSortArray:au}),uu=function(){function e(e,t){this.debugName=t,this._children=[],this._parent=null,e&&(this.parent=e)}return e.prototype.clone=function(){throw new Error("Cannot clone node")},e.prototype.producedFields=function(){return{}},e.prototype.dependentFields=function(){return{}},Object.defineProperty(e.prototype,"parent",{get:function(){return this._parent},set:function(e){(this._parent=e).addChild(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"children",{get:function(){return this._children},enumerable:!0,configurable:!0}),e.prototype.numChildren=function(){return this._children.length},e.prototype.addChild=function(e){this._children.push(e)},e.prototype.removeChild=function(e){this._children.splice(this._children.indexOf(e),1)},e.prototype.remove=function(){for(var e=0,t=this._children;e<t.length;e++){t[e].parent=this._parent}this._parent.removeChild(this)},e.prototype.insertAsParentOf=function(e){var t=e.parent;t.removeChild(this),this.parent=t,e.parent=this},e.prototype.swapWithParent=function(){for(var e=this._parent,t=e.parent,n=0,r=this._children;n<r.length;n++){r[n].parent=e}this._children=[],e.removeChild(this),e.parent.removeChild(e),this.parent=t,e.parent=this},e}(),cu=function(a){function e(e,t,n,r){var i=a.call(this,e,t)||this;return i.type=n,i.refCounts=r,i._source=i._name=t,!i.refCounts||i._name in i.refCounts||(i.refCounts[i._name]=0),i}return Ce(e,a),e.prototype.clone=function(){var e=new this.constructor;return e.debugName="clone_"+this.debugName,e._source=this._source,e._name="clone_"+this._name,e.type=this.type,e.refCounts=this.refCounts,e.refCounts[e._name]=0,e},e.prototype.getSource=function(){return this.refCounts[this._name]++,this._source},e.prototype.isRequired=function(){return!!this.refCounts[this._name]},e.prototype.setSource=function(e){this._source=e},e}(uu),su=function(r){function a(e,t){var n=r.call(this,e)||this;return n.transform=t,n}return Ce(a,r),a.prototype.clone=function(){return new a(null,ue(this.transform))},a.parseAllForSortIndex=function(r,i){return i.forEachFieldDef(function(e,t){if(dr(e)&&au(e.sort)){var n={calculate:a.calculateExpressionFromSortField(e.field,e.sort),as:lu(i,t)};r=new a(r,n)}}),r},a.calculateExpressionFromSortField=function(e,t){var n,r="";for(n=0;n<t.length;n++)r+="datum."+e+" === '"+t[n]+"' ? "+n+" : ";return r+=n},a.prototype.producedFields=function(){var e={};return e[this.transform.as]=!0,e},a.prototype.assemble=function(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}},a}(uu);function lu(e,t){return t+"_"+pr(e.fieldDef(t))+"_sort_index"}var fu=function(i){function s(e,t,n){var r=i.call(this,e)||this;return r.dimensions=t,r.measures=n,r}return Ce(s,i),s.prototype.clone=function(){return new s(null,Ae({},this.dimensions),ue(this.measures))},s.makeFromEncoding=function(e,a){var t=!1;a.forEachFieldDef(function(e){e.aggregate&&(t=!0)});var o={},u={};return t?(a.forEachFieldDef(function(e,t){var n,r,i;e.aggregate?"count"===e.aggregate?(o["*"]=o["*"]||{},o["*"].count=pr(e,{aggregate:"count"})):(o[e.field]=o[e.field]||{},o[e.field][e.aggregate]=pr(e),_t(t)&&"unaggregated"===a.scaleDomain(t)&&(o[e.field].min=pr(e,{aggregate:"min"}),o[e.field].max=pr(e,{aggregate:"max"}))):(n=u,r=t,(i=e).bin?(n[pr(i,{})]=!0,n[pr(i,{binSuffix:"end"})]=!0,co(i,r)&&(n[pr(i,{binSuffix:"range"})]=!0)):n[pr(i)]=!0)}),ie(u).length+ie(o).length===0?null:new s(e,u,o)):null},s.makeFromTransform=function(e,t){for(var n={},r={},i=0,a=t.aggregate;i<a.length;i++){(c=a[i]).op&&("count"===c.op?(r["*"]=r["*"]||{},r["*"].count=c.as||pr(c)):(r[c.field]=r[c.field]||{},r[c.field][c.op]=c.as||pr(c)))}for(var o=0,u=t.groupby||[];o<u.length;o++){var c;n[c=u[o]]=!0}return ie(n).length+ie(r).length===0?null:new s(e,n,r)},s.prototype.merge=function(e){ne(this.dimensions,e.dimensions)?function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];gn.debug.apply(gn,arguments)}("different dimensions, cannot merge"):(!function(e,t){for(var n in t)if(t.hasOwnProperty(n)){var r=t[n];for(var i in r)r.hasOwnProperty(i)&&(n in e?e[n][i]=r[i]:e[n]={op:r[i]})}}(this.measures,e.measures),e.remove())},s.prototype.addDimensions=function(e){var t=this;e.forEach(function(e){return t.dimensions[e]=!0})},s.prototype.dependentFields=function(){var t={};return ie(this.dimensions).forEach(function(e){return t[e]=!0}),ie(this.measures).forEach(function(e){return t[e]=!0}),t},s.prototype.producedFields=function(){var e=this,n={};return ie(this.measures).forEach(function(t){ie(e.measures[t]).forEach(function(e){n[e+"_"+t]=!0})}),n},s.prototype.assemble=function(){for(var e=[],t=[],n=[],r=0,i=ie(this.measures);r<i.length;r++)for(var a=i[r],o=0,u=ie(this.measures[a]);o<u.length;o++){var c=u[o];n.push(this.measures[a][c]),e.push(c),t.push(a)}return{type:"aggregate",groupby:ie(this.dimensions),ops:e,fields:t,as:n}},s}(uu),du=function(a){function e(e,t,n,r){var i=a.call(this,e)||this;return i.model=t,i.name=n,i.data=r,t.facet.column&&(i.columnFields=[t.vgField(Je)],i.columnName=t.getName("column_domain"),t.fieldDef(Je).bin&&i.columnFields.push(t.vgField(Je,{binSuffix:"end"}))),t.facet.row&&(i.rowFields=[t.vgField(Ke)],i.rowName=t.getName("row_domain"),t.fieldDef(Ke).bin&&i.rowFields.push(t.vgField(Ke,{binSuffix:"end"}))),i.childModel=t.child,i}return Ce(e,a),Object.defineProperty(e.prototype,"fields",{get:function(){var e=[];return this.columnFields&&(e=e.concat(this.columnFields)),this.rowFields&&(e=e.concat(this.rowFields)),e},enumerable:!0,configurable:!0}),e.prototype.getSource=function(){return this.name},e.prototype.getChildIndependentFieldsWithStep=function(){for(var e={},t=0,n=["x","y"];t<n.length;t++){var r=n[t],i=this.childModel.component.scales[r];if(i&&!i.merged){var a=i.get("type"),o=i.get("range");if(bi(a)&&Ya(o)){var u=Cu(Au(this.childModel,r));u?e[r]=u:vn("Unknown field for ${channel}.  Cannot calculate view size.")}}}return e},e.prototype.assembleRowColumnData=function(e,t,n){var r={},i="row"===e?"y":"x";return n[i]&&(r=t?{fields:["distinct_"+n[i]],ops:["max"],as:["distinct_"+n[i]]}:{fields:[n[i]],ops:["distinct"]}),{name:"row"===e?this.rowName:this.columnName,source:t||this.data,transform:[Ae({type:"aggregate",groupby:"row"===e?this.rowFields:this.columnFields},r)]}},e.prototype.assemble=function(){var e=[],t=null,n=this.getChildIndependentFieldsWithStep();if(this.columnName&&this.rowName&&(n.x||n.y)){t="cross_"+this.columnName+"_"+this.rowName;var r=[].concat(n.x?[n.x]:[],n.y?[n.y]:[]),i=r.map(function(){return"distinct"});e.push({name:t,source:this.data,transform:[{type:"aggregate",groupby:this.columnFields.concat(this.rowFields),fields:r,ops:i}]})}return this.columnName&&e.push(this.assembleRowColumnData("column",t,n)),this.rowName&&e.push(this.assembleRowColumnData("row",t,n)),e},e}(uu),pu=function(r){function o(e,t){var n=r.call(this,e)||this;return n.fieldDefs=t,n}return Ce(o,r),o.prototype.clone=function(){return new o(null,Ae({},this.fieldDefs))},o.make=function(e,i){var t=i.config,a=i.mark;if("filter"!==t.invalidValues)return null;var n=i.reduceFieldDef(function(e,t,n){var r=_t(n)&&i.getScaleComponent(n);r&&(!Si(r.get("type"))||t.aggregate||Jt(a)||(e[t.field]=t));return e},{});return ie(n).length?new o(e,n):null},Object.defineProperty(o.prototype,"filter",{get:function(){return this.fieldDefs},enumerable:!0,configurable:!0}),o.prototype.assemble=function(){var i=this,e=ie(this.filter).reduce(function(e,t){var n=i.fieldDefs[t],r=pr(n,{expr:"datum"});return null!==n&&(e.push(r+" !== null"),e.push("!isNaN("+r+")")),e},[]);return 0<e.length?{type:"filter",expr:e.join(" && ")}:null},o}(uu);var hu=function(r){function u(e,t){var n=r.call(this,e)||this;return n._parse={},n._parse=t,n}return Ce(u,r),u.prototype.clone=function(){return new u(null,ue(this.parse))},u.make=function(e,t){var n={},r={};(t.transforms||[]).forEach(function(e){Ma(e)?r[e.as]=!0:Fa(e)&&function e(t,n){if(G(t))e(t.not,n);else if(W(t))for(var r=0,i=t.and;r<i.length;r++)e(i[r],n);else if(q(t))for(var a=0,o=t.or;a<o.length;a++)e(o[a],n);else n(t)}(e.filter,function(e){Rc(e)&&e.timeUnit&&(n[e.field]="date")})},{}),(Wu(t)||Gu(t))&&t.forEachFieldDef(function(e){if(zr(e))n[e.field]="date";else if(Dr(e)){if(r[e.field]||we(e.aggregate))return;n[e.field]="number"}else 1<ve(e.field)&&(n[e.field]="flatten")});var i=t.data;if(i&&i.format&&i.format.parse){var a=i.format.parse;ie(a).forEach(function(e){n[e]=a[e]})}var o=t.component.data.ancestorParse;return ie(o).forEach(function(e){n[e]!==o[e]?vn(rn.differentParse(e,n[e],o[e])):delete n[e]}),0===ie(n).length?null:new u(e,n)},Object.defineProperty(u.prototype,"parse",{get:function(){return this._parse},enumerable:!0,configurable:!0}),u.prototype.merge=function(e){this._parse=Ae({},this._parse,e.parse),e.remove()},u.prototype.assembleFormatParse=function(){for(var e={},t=0,n=ie(this._parse);t<n.length;t++){var r=n[t];1===ve(r)&&(e[r]=this._parse[r])}return e},u.prototype.producedFields=function(){return g(ie(this.parse))},u.prototype.dependentFields=function(){return g(ie(this.parse))},u.prototype.assembleTransforms=function(t){var a=this;return void 0===t&&(t=!1),ie(this._parse).filter(function(e){return!t||1<ve(e)}).map(function(e){var t,n,r,i=(t=e,n=a._parse[e],r=pe(t),"number"===n?"toNumber("+r+")":"boolean"===n?"toBoolean("+r+")":"string"===n?"toString("+r+")":"date"===n?"toDate("+r+")":"flatten"===n?r:0===n.indexOf("date:")?"timeParse("+r+","+n.slice(5,n.length)+")":0===n.indexOf("utc:")?"utcParse("+r+","+n.slice(4,n.length)+")":(vn(rn.unrecognizedParse(n)),null));return i?{type:"formula",expr:i,as:ge(e)}:null}).filter(function(e){return null!==e})},u}(uu),mu=function(a){function e(e){var t=a.call(this,null)||this;if(ha(e=e||{name:"source"}))t._data={values:e.values};else if(pa(e)){if(t._data={url:e.url},e.format||(e.format={}),!e.format||!e.format.type){var n=/(?:\.([^.]+))?$/.exec(e.url)[1];X(["json","csv","tsv","topojson"],n)||(n="json"),e.format.type=n}}else ma(e)&&(t._name=e.name,t._data={});if(!ma(e)&&e.format){var r=e.format,i=(r.parse,De(r,["parse"]));t._data.format=i}return t}return Ce(e,a),Object.defineProperty(e.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),e.prototype.hasName=function(){return!!this._name},Object.defineProperty(e.prototype,"dataName",{get:function(){return this._name},set:function(e){this._name=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{set:function(e){throw new Error("Source nodes have to be roots.")},enumerable:!0,configurable:!0}),e.prototype.remove=function(){throw new Error("Source nodes are roots and cannot be removed.")},e.prototype.hash=function(){return ha(this._data)?(this._hash||(this._hash=V(this._data)),this._hash):pa(this._data)?V([this._data.url,this._data.format]):this._name},e.prototype.assemble=function(){return Ae({name:this._name},this._data,{transform:[]})},e}(uu),gu=function(r){function i(e,t){var n=r.call(this,e)||this;return n.formula=t,n}return Ce(i,r),i.prototype.clone=function(){return new i(null,ue(this.formula))},i.makeFromEncoding=function(e,t){var n=t.reduceFieldDef(function(e,t){if(t.timeUnit){var n=pr(t);e[n]={as:n,timeUnit:t.timeUnit,field:t.field}}return e},{});return 0===ie(n).length?null:new i(e,n)},i.makeFromTransform=function(e,t){return new i(e,((n={})[t.field]={as:t.as,timeUnit:t.timeUnit,field:t.field},n));var n},i.prototype.merge=function(e){this.formula=Ae({},this.formula,e.formula),e.remove()},i.prototype.producedFields=function(){var t={};return ae(this.formula).forEach(function(e){t[e.as]=!0}),t},i.prototype.dependentFields=function(){var t={};return ae(this.formula).forEach(function(e){t[e.field]=!0}),t},i.prototype.assemble=function(){return ae(this.formula).map(function(e){return{type:"formula",as:e.as,expr:Wn(e.timeUnit,e.field)}})},i}(uu);function vu(r){return function e(t){if(!(t instanceof mu)){var n=t.parent;r(t)&&e(n)}}}function yu(e){var t=e.parent;if(e instanceof hu){if(t instanceof mu)return!1;if(1<t.numChildren())return!0;if(t instanceof hu)t.merge(e);else{if(re(t.producedFields(),e.dependentFields()))return!0;e.swapWithParent()}}return!0}function bu(e){return!(e instanceof cu||0<e.numChildren()||e instanceof du)&&(e.remove(),!0)}function xu(e){var n={};return vu(function(e){if(e instanceof gu){var t=e.producedFields();ie(t).every(function(e){return!!n[e]})?e.remove():n=Ae({},n,t)}return!0})(e)}var Su=function(r){function u(e,t){var n=r.call(this,e)||this;return n._stack=t,n}return Ce(u,r),u.prototype.clone=function(){return new u(null,ue(this._stack))},u.make=function(e,t){var n,r=t.stack;if(!r)return null;r.groupbyChannel&&(n=t.fieldDef(r.groupbyChannel));var i,a=t.stack.stackBy.reduce(function(e,t){var n=pr(t.fieldDef);return n&&e.push(n),e},[]),o=t.encoding.order;return i=v(o)||sr(o)?ao(o):a.reduce(function(e,t){return e.field.push(t),e.order.push("descending"),e},{field:[],order:[]}),new u(e,{dimensionFieldDef:n,field:t.vgField(r.fieldChannel),facetby:[],stackby:a,sort:i,offset:r.offset,impute:r.impute})},Object.defineProperty(u.prototype,"stack",{get:function(){return this._stack},enumerable:!0,configurable:!0}),u.prototype.addDimensions=function(e){this._stack.facetby=this._stack.facetby.concat(e)},u.prototype.dependentFields=function(){var t={};t[this._stack.field]=!0,this.getGroupbyFields().forEach(function(e){return t[e]=!0}),this._stack.facetby.forEach(function(e){return t[e]=!0});var e=this._stack.sort.field;return v(e)?e.forEach(function(e){return t[e]=!0}):t[e]=!0,t},u.prototype.producedFields=function(){var e={};return e[this._stack.field+"_start"]=!0,e[this._stack.field+"_end"]=!0,e},u.prototype.getGroupbyFields=function(){var e=this._stack,t=e.dimensionFieldDef,n=e.impute;return t?t.bin?n?[pr(t,{binSuffix:"mid"})]:[pr(t,{}),pr(t,{binSuffix:"end"})]:[pr(t)]:[]},u.prototype.assemble=function(){var e=[],t=this._stack,n=t.facetby,r=t.field,i=t.dimensionFieldDef,a=t.impute,o=t.offset,u=t.sort,c=t.stackby;if(a&&i){var s=i?pr(i,{binSuffix:"mid"}):void 0;i.bin&&e.push({type:"formula",expr:"("+pr(i,{expr:"datum"})+"+"+pr(i,{expr:"datum",binSuffix:"end"})+")/2",as:s}),e.push({type:"impute",field:r,groupby:c,key:s,method:"value",value:0})}return e.push({type:"stack",groupby:this.getGroupbyFields().concat(n),field:r,sort:u,as:[r+"_start",r+"_end"],offset:o}),e},u}(uu),Eu="scale_";function wu(t){if(t instanceof du)if(1!==t.numChildren()||t.children[0]instanceof cu){!function e(t){if(t instanceof cu&&t.type===ga&&1===t.numChildren()){var n=t.children[0];n instanceof du||(n.swapWithParent(),e(t))}}(t.model.component.data.main),Z(t.children.map((i=t,function e(t){if(!(t instanceof du)){var n=t.clone();if(n instanceof cu){var r=Eu+n.getSource();n.setSource(r),i.model.component.data.outputNodes[r]=n}else(n instanceof fu||n instanceof Su)&&n.addDimensions(i.fields);return Z(t.children.map(e)).forEach(function(e){return e.parent=n}),[n]}return Z(t.children.map(e))}))).forEach(function(e){return e.parent=t.model.component.data.main})}else{var e=t.children[0];(e instanceof fu||e instanceof Su)&&e.addDimensions(t.fields),e.swapWithParent(),wu(t)}else t.children.forEach(wu);var i}function Nu(e){e instanceof pu&&J(ae(e.filter),function(e){return null===e})&&e.remove(),e instanceof cu&&!e.isRequired()&&e.remove(),e.children.forEach(Nu)}function ku(e){var n=[];return e.forEach(function e(t){0===t.numChildren()?n.push(t):t.children.forEach(e)}),n}function Ou(e){var h,m,g;Wu(e)?(m=(h=e).specifiedScales,g=h.component.scales,ie(g).forEach(function(e){var t,n,r,i,a=m[e],o=a?a.domain:void 0,u=(n=e,r=(t=h).getScaleComponent(n).get("type"),(i=function(e,t,n,r){if("unaggregated"===e){var i=Tu(t,n),a=i.valid,o=i.reason;if(!a)return void vn(o)}else if(void 0===e&&r.useUnaggregatedDomain){var a=Tu(t,n).valid;if(a)return"unaggregated"}return e}(t.scaleDomain(n),t.fieldDef(n),r,t.config.scale))!==t.scaleDomain(n)&&(t.specifiedScales[n]=Ae({},t.specifiedScales[n],{domain:i})),"x"===n&&t.channelHasField("x2")?t.channelHasField("x")?_u(r,i,t,"x").concat(_u(r,i,t,"x2")):_u(r,i,t,"x2"):"y"===n&&t.channelHasField("y2")?t.channelHasField("y")?_u(r,i,t,"y").concat(_u(r,i,t,"y2")):_u(r,i,t,"y2"):_u(r,i,t,n)),c=g[e];if(c.domains=u,ki(o)&&c.set("domainRaw",{signal:Sc+V(o)},!0),h.component.data.isFaceted){for(var s=h;!Gu(s)&&s.parent;)s=s.parent;var l=s.component.resolve.scale[e];if("shared"===l)for(var f=0,d=u;f<d.length;f++){var p=d[f];Va(p)&&(p.data=Eu+p.data.replace(Eu,""))}}})):function(c){for(var e=0,t=c.children;e<t.length;e++){var n=t[e];Ou(n)}var s=c.component.scales;ie(s).forEach(function(e){for(var t,n=null,r=0,i=c.children;r<i.length;r++){var a=i[r],o=a.component.scales[e];if(o){t=void 0===t?o.domains:t.concat(o.domains);var u=o.get("domainRaw");n&&u&&n.signal!==u.signal&&vn("The same selection must be used to override scale domains in a layered view."),n=u}}s[e].domains=t,n&&s[e].set("domainRaw",n,!0)})}(e)}function _u(e,t,n,r){var i=n.fieldDef(r);if(t&&"unaggregated"!==t&&!ki(t))return bn(t[0])?t.map(function(e){return{signal:"{data: "+Nn(e,!0)+"}"}}):[t];var a=n.stack;if(a&&r===a.fieldChannel)return"normalize"===a.offset?[[0,1]]:[{data:o=n.requestDataName(ga),field:n.vgField(r,{suffix:"start"})},{data:o,field:n.vgField(r,{suffix:"end"})}];var o,u=_t(r)?function(e,t,n){if(!bi(n))return;var r=e.sort(t);if(au(r))return{op:"min",field:lu(e,t),order:"ascending"};if(iu(r))return r;if("descending"===r)return{op:"min",field:e.vgField(t),order:"descending"};if(X(["ascending",void 0],r))return!0;return}(n,r,e):void 0;if("unaggregated"===t)return[{data:o=n.requestDataName(ga),field:n.vgField(r,{aggregate:"min"})},{data:o,field:n.vgField(r,{aggregate:"max"})}];if(!i.bin)return u?[{data:ce(u)?n.requestDataName(ga):n.requestDataName(va),field:n.vgField(r),sort:u}]:[{data:n.requestDataName(ga),field:n.vgField(r)}];if(xi(e)){var c=n.getName(zt(i.bin)+"_"+i.field+"_bins");return[{signal:"sequence("+c+".start, "+c+".stop + "+c+".step, "+c+".step)"}]}return bi(e)?[{data:ce(u)?n.requestDataName(ga):n.requestDataName(va),field:n.vgField(r,co(i,r)?{binSuffix:"range"}:{}),sort:!0!==u&&iu(u)?u:{field:n.vgField(r,{}),op:"min"}}]:"x"!==r&&"y"!==r?[{data:n.requestDataName(ga),field:n.vgField(r,{})}]:It(i.bin)&&i.bin.extent?[i.bin.extent]:[{data:o=n.requestDataName(ga),field:n.vgField(r,{})},{data:o,field:n.vgField(r,{binSuffix:"end"})}]}function Tu(e,t){return e.aggregate?Oe[e.aggregate]?"quantitative"===e.type&&"log"===t?{valid:!1,reason:rn.unaggregatedDomainWithLogScale(e)}:{valid:!0}:{valid:!1,reason:rn.unaggregateDomainWithNonSharedDomainOp(e.aggregate)}:{valid:!1,reason:rn.unaggregateDomainHasNoEffectForRawField(e)}}function Cu(e){if(Va(e)&&y(e.field))return e.field;if(!v(o=e)&&"fields"in o&&!("data"in o)){for(var t=void 0,n=0,r=e.fields;n<r.length;n++){var i=r[n];if(Va(i)&&y(i.field))if(t){if(t!==i.field)return vn("Detected faceted independent scales that union domain of multiple fields from different data sources.  We will use the first field.  The result view size may be incorrect."),t}else t=i.field}return vn("Detected faceted independent scales that union domain of identical fields from different source detected.  We will assume that this is the same field from a different fork of the same data source.  However, if this is not case, the result view size maybe incorrect."),t}var a,o;return!v(a=e)&&"fields"in a&&"data"in a?(vn("Detected faceted independent scales that union domain of multiple fields from the same data source.  We will use the first field.  The result view size may be incorrect."),y(t=e.fields[0])?t:void 0):void 0}function Au(t,e){return function(e){var t=te(e.map(function(e){return Va(e)?(e.sort,De(e,["sort"])):e}),V),n=te(e.map(function(e){if(Va(e)){var t=e.sort;return void 0===t||ce(t)||("count"===t.op&&delete t.field,"ascending"===t.order&&delete t.order),t}}).filter(function(e){return void 0!==e}),V);if(1===t.length){if(Va(o=e[0])&&0<n.length){var r=n[0];return 1<n.length&&(vn(rn.MORE_THAN_ONE_SORT),r=!0),Ae({},o,{sort:r})}return o}var i=te(n.map(function(e){return!0===e?e:"count"===e.op?e:(vn(rn.domainSortDropped(e)),!0)}),V),a=void 0;1===i.length?a=i[0]:1<i.length&&(vn(rn.MORE_THAN_ONE_SORT),a=!0);var o,u=te(e.map(function(e){return Va(e)?e.data:null}),function(e){return e});return 1===u.length&&null!==u[0]?o=Ae({data:u[0],fields:t.map(function(e){return e.field})},a?{sort:a}:{}):Ae({fields:t},a?{sort:a}:{})}(t.component.scales[e].domains.map(function(e){return Va(e)&&(e.data=t.lookupDataSource(e.data)),e}))}function Du(s){return ie(s.component.scales).reduce(function(e,t){var n=s.component.scales[t];if(n.merged)return e;var r=n.combine(),i=r.domainRaw,a=r.range,o=r.name,u=r.type,c=(r.domainRaw,r.range,De(r,["name","type","domainRaw","range"]));return a=function(e,t,n,r){if("x"===r||"y"===r){if(Ya(e))return{step:{signal:t+"_step"}};if(v(e)&&2===e.length){var i=e[0],a=e[1];if(0===i&&Ba(a))return[0,{signal:n.getSizeName(a.signal)}];if(Ba(i)&&0===a)return[{signal:n.getSizeName(i.signal)},0]}}return e}(a,o,s,t),i&&0<=i.signal.indexOf(Sc)&&(i=function(e,t){var n=JSON.parse(t.signal.replace(Sc,"")),r=se(n.selection),i=e.component.selection&&e.component.selection[r];{if(!i)return i=e.getSelectionComponent(r,n.selection),n.encoding||n.field||(n.field=i.project[0].field,1<i.project.length&&vn('A "field" or "encoding" must be specified when using a selection as a scale domain. Using "field": '+k(n.field)+".")),{signal:kc(i.type).scaleDomain+"("+k(r+yc)+", "+k(n.encoding||null)+", "+k(n.field||null)+("global"===i.resolve?")":", "+k(i.resolve)+")")};vn('Use "bind": "scales" to setup a binding for scales and selections within the same view.')}return{signal:"null"}}(s,i)),e.push(Ae({name:o,type:u,domain:Au(s,t)},i?{domainRaw:i}:{},{range:a},c)),e},[])}var zu=function(r){function e(e,t){var n=r.call(this,{},{name:e})||this;return n.merged=!1,n.domains=[],n.setWithExplicit("type",t),n}return Ce(e,r),e}(bo),Iu=["range","rangeStep","scheme"];function Ru(e){var f,d;Wu(e)?(d=(f=e).component.scales,Ot.forEach(function(e){var t=d[e];if(t){var n=f.getScaleComponent(e),r=f.specifiedScales[e],i=f.fieldDef(e),a="x"===e?"width":"y"===e?"height":void 0,o=a?!!f.component.layoutSize.get(a):void 0,u=n.get("type"),c=X(["point","band"],u)||!!r.rangeStep;a&&f.fit&&!o&&c&&(vn(rn.CANNOT_FIX_RANGE_STEP_WITH_FIT),o=!0);var s=function(e){var t=[],n=e.getScaleComponent("x"),r=n&&n.get("range");r&&Ya(r)&&x(r.step)&&t.push(r.step);var i=e.getScaleComponent("y"),a=i&&i.get("range");return a&&Ya(a)&&x(a.step)&&t.push(a.step),t}(f),l=function(e,t,n,r,i,a,o,u,c,s){for(var l=u||null===r.rangeStep,f=0,d=Iu;f<d.length;f++){var p=d[f];if(void 0!==r[p]){var h=Ci(t,p),m=Ai(e,p);if(h)if(m)vn(m);else switch(p){case"range":return xo(r[p]);case"scheme":return xo(Lu(r[p]));case"rangeStep":var g=r[p];if(null!==g){if(!u)return xo({step:g});vn(rn.rangeStepDropped(e))}}else vn(rn.scalePropertyNotWorkWithScaleType(t,p,e))}}return So(function(e,t,n,r,i,a,o,u,c){switch(e){case qe:case We:if(X(["point","band"],t)&&!c)if(e===qe&&"text"===a){if(r.scale.textXRangeStep)return{step:r.scale.textXRangeStep}}else if(r.scale.rangeStep)return{step:r.scale.rangeStep};return e===We&&Si(t)?[{signal:o},0]:[0,{signal:o}];case $e:var s=function(e,t,n){if(t)return 0;switch(e){case"bar":case"tick":return n.scale.minBandSize;case"line":case"trail":case"rule":return n.scale.minStrokeWidth;case"text":return n.scale.minFontSize;case"point":case"square":case"circle":return n.scale.minSize}throw new Error(rn.incompatibleChannel("size",e))}(a,i,r),l=function(e,t,n){var r=n.scale;switch(e){case"bar":case"tick":return void 0!==n.scale.maxBandSize?n.scale.maxBandSize:Fu(t,n.scale)-1;case"line":case"trail":case"rule":return n.scale.maxStrokeWidth;case"text":return n.scale.maxFontSize;case"point":case"square":case"circle":if(n.scale.maxSize)return n.scale.maxSize;var i=Fu(t,r);return(i-2)*(i-2)}throw new Error(rn.incompatibleChannel("size",e))}(a,u,r);return[s,l];case Ze:return"symbol";case et:case tt:case nt:return"ordinal"===t?"nominal"===n?"category":"ordinal":"rect"===a||"geoshape"===a?"heatmap":"ramp";case ut:return[r.scale.minOpacity,r.scale.maxOpacity]}throw new Error("Scale range undefined for channel "+e)}(e,t,n,i,a,o,c,s,l))}(e,u,i.type,r,f.config,t.get("zero"),f.mark,o,f.getName(a),s);t.setWithExplicit("range",l)}})):Uu(e,"range")}function Lu(e){if(Ni(e)){var t={scheme:e.name};return e.count&&(t.count=e.count),e.extent&&(t.extent=e.extent),t}return{scheme:e}}function Fu(e,t){return 0<e.length?Math.min.apply(null,e):t.rangeStep?t.rangeStep:21}function ju(e,t){var d,p,h;Wu(e)?(p=t,h=(d=e).component.scales,ie(h).forEach(function(e){var t=d.specifiedScales[e],n=h[e],r=d.getScaleComponent(e),i=d.fieldDef(e),a=d.sort(e),o=d.config,u=t[p],c=r.get("type"),s=Ci(c,p),l=Ai(e,p);if(void 0!==u&&(s?l&&vn(l):vn(rn.scalePropertyNotWorkWithScaleType(c,p,e))),s&&void 0===l)if(void 0!==u)n.copyKeyFromObject(p,t);else{var f=function(e,t,n,r,i,a,o,u,c,s){var l=s.scale;switch(e){case"nice":return function(e,t,n){if(!n.bin&&!X([Jr.TIME,Jr.UTC],e))return X([qe,We],t)}(i,t,n);case"padding":return function(e,t,n,r,i,a){if(X([qe,We],e)){if(Ei(t)){if(void 0!==n.continuousPadding)return n.continuousPadding;var o=i.type,u=i.orient;if("bar"===o&&!r.bin&&("vertical"===u&&"x"===e||"horizontal"===u&&"y"===e))return a.continuousBandSize}if(t===Jr.POINT)return n.pointPadding}}(t,i,l,n,c,s.bar);case"paddingInner":return function(e,t,n){if(void 0===e)return X([qe,We],t)?n.bandPaddingInner:void 0}(a,t,l);case"paddingOuter":return function(e,t,n,r,i){if(void 0===e)return X([qe,We],t)&&n===Jr.BAND?void 0!==i.bandPaddingOuter?i.bandPaddingOuter:r/2:void 0}(a,t,i,o,l);case"reverse":return function(e,t){if(Si(e)&&"descending"===t)return!0}(i,r);case"zero":return function(e,t,n,r){if(n&&"unaggregated"!==n)return!1;if("size"===e&&"quantitative"===t.type)return!0;if(!t.bin&&X([qe,We],e)){var i=r.orient,a=r.type;return!X(["bar","area","line","trail"],a)||!("horizontal"===i&&"y"===e||"vertical"===i&&"x"===e)}return!1}(t,n,u,c)}return l[e]}(p,e,i,a,r.get("type"),r.get("padding"),r.get("paddingInner"),t.domain,d.markDef,o);void 0!==f&&n.set(p,f,!1)}})):Uu(e,t)}function Uu(a,o){for(var u=a.component.scales,e=0,t=a.children;e<t.length;e++){var n=t[e];"range"===o?Ru(n):ju(n,o)}ie(u).forEach(function(e){for(var t,n=0,r=a.children;n<r.length;n++){var i=r[n].component.scales[e];if(i)t=No(t,i.getWithExplicit(o),o,"scale",Eo(function(e,t){switch(o){case"range":return e.step&&t.step?e.step-t.step:0}return 0}))}u[e].setWithExplicit(o,t)})}function Mu(e,t,n,r,i){var a=function(e,t,n,r){switch(t.type){case"nominal":case"ordinal":if(pt(e)||"discrete"===At(e))return"shape"===e&&"ordinal"===t.type&&vn(rn.discreteChannelCannotEncode(e,"ordinal")),"ordinal";if(X(["x","y"],e)){if(X(["rect","bar","rule"],n))return"band";if("bar"===n)return"band"}return"point";case"temporal":return pt(e)?"sequential":"discrete"===At(e)?(vn(rn.discreteChannelCannotEncode(e,"temporal")),"ordinal"):"time";case"quantitative":return pt(e)?t.bin?"bin-ordinal":"sequential":"discrete"===At(e)?(vn(rn.discreteChannelCannotEncode(e,"quantitative")),"ordinal"):t.bin&&"x"!==e&&"y"!==e?"bin-linear":"linear";case"latitude":case"longitude":case"geojson":return}throw new Error(rn.invalidFieldType(t.type))}(t,n,r);return _t(t)?void 0!==e?Di(t,e)?function(e,t){var n=t.type;{if(X([Yn.ORDINAL,Yn.NOMINAL],n))return void 0===e||bi(e);if(n===Yn.TEMPORAL)return X([Jr.TIME,Jr.UTC,Jr.SEQUENTIAL,void 0],e);if(n===Yn.QUANTITATIVE)return t.bin?X([Jr.BIN_LINEAR,Jr.BIN_ORDINAL,Jr.LINEAR],e):X([Jr.LOG,Jr.POW,Jr.SQRT,Jr.QUANTILE,Jr.QUANTIZE,Jr.LINEAR,Jr.SEQUENTIAL,void 0],e)}return!0}(e,n)?e:(vn(rn.scaleTypeNotWorkWithFieldDef(e,a)),a):(vn(rn.scaleTypeNotWorkWithChannel(t,e,a)),a):a:null}function Pu(e){var u,c,s,l;Wu(e)?e.component.scales=(c=(u=e).encoding,s=u.config,l=u.mark,Ot.reduce(function(e,t){var n,r=void 0,i=c[t];if(sr(i)&&l===Vt&&t===Ze&&i.type===er)return e;if(sr(i)?r=(n=i).scale:ur(i)?(n=i.condition,r=i.condition.scale):t===qe?n=kr(c.x2):t===We&&(n=kr(c.y2)),n&&null!==r&&!1!==r){var a=(r=r||{}).type,o=Mu(r.type,t,n,l,s.scale);e[t]=new zu(u.scaleName(t+"",!0),{value:o,explicit:a===o})}return e},{})):e.component.scales=function(u){for(var c=u.component.scales={},s={},i=u.component.resolve,e=function(r){Pu(r),ie(r.component.scales).forEach(function(e){if(i.scale[e]=i.scale[e]||function(e,t){if(Vu(t)||Gu(t))return"shared";if(Yu(t)||Bu(t))return X(Et,e)?"independent":"shared";throw new Error("invalid model type for resolve")}(e,u),"shared"===i.scale[e]){var t=s[e],n=r.component.scales[e].getWithExplicit("type");t?si(t.value,n.value)?s[e]=No(t,n,"type","scale",Hu):(i.scale[e]="independent",delete s[e]):s[e]=n}})},t=0,n=u.children;t<n.length;t++){var r=n[t];e(r)}return ie(s).forEach(function(e){var t=u.scaleName(e,!0),n=s[e];c[e]=new zu(t,n);for(var r=0,i=u.children;r<i.length;r++){var a=i[r],o=a.component.scales[e];o&&(a.renameScale(o.get("name"),t),o.merged=!0)}}),c}(e)}var Hu=Eo(function(e,t){return fi(e)-fi(t)});var qu=function(){function e(){this.nameMap={}}return e.prototype.rename=function(e,t){this.nameMap[e]=t},e.prototype.has=function(e){return void 0!==this.nameMap[e]},e.prototype.get=function(e){for(;this.nameMap[e]&&e!==this.nameMap[e];)e=this.nameMap[e];return e},e}();function Wu(e){return e&&"unit"===e.type}function Gu(e){return e&&"facet"===e.type}function Bu(e){return e&&"repeat"===e.type}function Yu(e){return e&&"concat"===e.type}function Vu(e){return e&&"layer"===e.type}var Xu=function(){function e(e,t,n,r,i,a){var o=this;this.children=[],this.correctDataNames=function(e){return e.from&&e.from.data&&(e.from.data=o.lookupDataSource(e.from.data)),e.from&&e.from.facet&&e.from.facet.data&&(e.from.facet.data=o.lookupDataSource(e.from.facet.data)),e},this.parent=t,this.config=r,this.repeater=i,this.name=e.name||n,this.title=y(e.title)?{text:e.title}:e.title,this.scaleNameMap=t?t.scaleNameMap:new qu,this.projectionNameMap=t?t.projectionNameMap:new qu,this.layoutSizeNameMap=t?t.layoutSizeNameMap:new qu,this.data=e.data,this.description=e.description,this.transforms=Wa(e.transform||[]),this.component={data:{sources:t?t.component.data.sources:{},outputNodes:t?t.component.data.outputNodes:{},outputNodeRefCounts:t?t.component.data.outputNodeRefCounts:{},ancestorParse:t?Ae({},t.component.data.ancestorParse):{},isFaceted:Ki(e)||t&&t.component.data.isFaceted&&!e.data},layoutSize:new bo,layoutHeaders:{row:{},column:{}},mark:null,resolve:Ae({scale:{},axis:{},legend:{}},a||{}),selection:null,scales:null,projection:null,axes:{},legends:{}}}return Object.defineProperty(e.prototype,"width",{get:function(){return this.getSizeSignalRef("width")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.getSizeSignalRef("height")},enumerable:!0,configurable:!0}),e.prototype.initSize=function(e){var t=e.width,n=e.height;t&&this.component.layoutSize.set("width",t,!0),n&&this.component.layoutSize.set("height",n,!0)},e.prototype.parse=function(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSize(),this.parseSelection(),this.parseProjection(),this.parseData(),this.parseAxisAndHeader(),this.parseLegend(),this.parseMarkGroup()},e.prototype.parseScale=function(){!function(e){Pu(e),Ou(e);for(var t=0,n=Ti;t<n.length;t++)ju(e,n[t]);Ru(e)}(this)},e.prototype.parseProjection=function(){ru(this)},e.prototype.renameTopLevelLayoutSize=function(){"width"!==this.getName("width")&&this.renameLayoutSize(this.getName("width"),"width"),"height"!==this.getName("height")&&this.renameLayoutSize(this.getName("height"),"height")},e.prototype.parseLegend=function(){Ko(this)},e.prototype.assembleGroupStyle=function(){if("unit"===this.type||"layer"===this.type)return"cell"},e.prototype.assembleLayoutSize=function(){if("unit"===this.type||"layer"===this.type)return{width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height")}},e.prototype.assembleHeaderMarks=function(){for(var e,t,n,r,i=this.component.layoutHeaders,a=[],o=0,u=so;o<u.length;o++){i[l=u[o]].title&&a.push((t=l,void 0,n=(e=this).component.layoutHeaders[t].title,r=Ae({align:{value:"center"},text:{value:n}},"vertical"===("row"===t?"vertical":void 0)?{angle:{value:270}}:{}),{name:e.getName(t+"_title"),role:t+"-title",type:"group",marks:[Ae({type:"text",role:t+"-title-text",style:"guide-title"},0<ie(r).length?{encode:{update:r}}:{})]}))}for(var c=0,s=so;c<s.length;c++){var l=s[c];a=a.concat(fo(this,l))}return a},e.prototype.assembleAxes=function(){return e=this.component.axes,t=this.config,n=e.x,r=void 0===n?[]:n,i=e.y,a=void 0===i?[]:i,r.map(function(e){return Qa(e,"main",t)}).concat(r.map(function(e){return Qa(e,"grid",t)}),a.map(function(e){return Qa(e,"main",t)}),a.map(function(e){return Qa(e,"grid",t)})).filter(function(e){return e});var e,t,n,r,i,a},e.prototype.assembleLegends=function(){return Zo(this)},e.prototype.assembleProjections=function(){return $o(this)},e.prototype.assembleTitle=function(){var e=Ae({},Ri(this.config.title).nonMark,this.title);if(e.text)return X(["unit","layer"],this.type)||(e.anchor&&"start"!==e.anchor&&vn(rn.cannotSetTitleAnchor(this.type)),e.anchor="start"),0<ie(e).length?e:void 0},e.prototype.assembleGroup=function(e){void 0===e&&(e=[]);var t={};0<(e=e.concat(this.assembleSelectionSignals())).length&&(t.signals=e);var n=this.assembleLayout();n&&(t.layout=n),t.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());var r=!this.parent||Gu(this.parent)?function n(e){return Vu(e)||Yu(e)||Bu(e)?e.children.reduce(function(e,t){return e.concat(n(t))},Du(e)):Du(e)}(this):[];0<r.length&&(t.scales=r);var i=this.assembleAxes();0<i.length&&(t.axes=i);var a=this.assembleLegends();return 0<a.length&&(t.legends=a),t},e.prototype.hasDescendantWithFieldOnChannel=function(e){for(var t=0,n=this.children;t<n.length;t++){var r=n[t];if(Wu(r)){if(r.channelHasField(e))return!0}else if(r.hasDescendantWithFieldOnChannel(e))return!0}return!1},e.prototype.getName=function(e){return se((this.name?this.name+"_":"")+e)},e.prototype.requestDataName=function(e){var t=this.getName(e),n=this.component.data.outputNodeRefCounts;return n[t]=(n[t]||0)+1,t},e.prototype.getSizeSignalRef=function(e){if(Gu(this.parent)){var t="width"===e?"x":"y",n=this.component.scales[t];if(n&&!n.merged){var r=n.get("type"),i=n.get("range");if(bi(r)&&Ya(i)){var a=n.get("name"),o=Cu(Au(this,t));return o?{signal:vo(a,n,pr({aggregate:"distinct",field:o},{expr:"datum"}))}:(vn("Unknown field for ${channel}.  Cannot calculate view size."),null)}}}return{signal:this.layoutSizeNameMap.get(this.getName(e))}},e.prototype.lookupDataSource=function(e){var t=this.component.data.outputNodes[e];return t?t.getSource():e},e.prototype.getSizeName=function(e){return this.layoutSizeNameMap.get(e)},e.prototype.renameLayoutSize=function(e,t){this.layoutSizeNameMap.rename(e,t)},e.prototype.renameScale=function(e,t){this.scaleNameMap.rename(e,t)},e.prototype.renameProjection=function(e,t){this.projectionNameMap.rename(e,t)},e.prototype.scaleName=function(e,t){return t?this.getName(e):vt(e)&&_t(e)&&this.component.scales[e]||this.scaleNameMap.has(this.getName(e))?this.scaleNameMap.get(this.getName(e)):void 0},e.prototype.projectionName=function(e){return e?this.getName("projection"):this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection"))?this.projectionNameMap.get(this.getName("projection")):void 0},e.prototype.getScaleComponent=function(e){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale().  Make sure you have called parseScale or use parseUnitModelWithScale().");var t=this.component.scales[e];return t&&!t.merged?t:this.parent?this.parent.getScaleComponent(e):void 0},e.prototype.getSelectionComponent=function(e,t){var n=this.component.selection[e];if(!n&&this.parent&&(n=this.parent.getSelectionComponent(e,t)),!n)throw new Error(rn.selectionNotFound(t));return n},e}(),Qu=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ce(t,e),t.prototype.vgField=function(e,t){void 0===t&&(t={});var n=this.fieldDef(e);if(n)return pr(n,t)},t.prototype.reduceFieldDef=function(i,e,t){return Pr(this.getMapping(),function(e,t,n){var r=kr(t);return r?i(e,r,n):e},e,t)},t.prototype.forEachFieldDef=function(r,e){Mr(this.getMapping(),function(e,t){var n=kr(e);n&&r(n,t)},e)},t}(Xu),Ku={has:function(e){return"interval"===e.type&&"global"===e.resolve&&e.bind&&"scales"===e.bind},parse:function(i,e,a){var o=a.scales=[];a.project.forEach(function(e){var t=e.channel,n=i.getScaleComponent(t),r=n?n.get("type"):void 0;n&&Si(r)&&!xi(r)?(n.set("domainRaw",{signal:Cc(a,t,"data")},!0),o.push(t),i.repeater&&i.repeater.row===i.repeater.column&&i.getScaleComponent(t===qe?We:qe).set("domainRaw",{signal:Cc(a,t,"data")},!0)):vn(rn.SCALE_BINDINGS_CONTINUOUS)})},topLevelSignals:function(e,n,r){if(!e.parent)return r;var t=n.scales.filter(function(t){return!r.filter(function(e){return e.name===Cc(n,t,"data")}).length});return r.concat(t.map(function(e){return{name:Cc(n,e,"data")}}))},signals:function(e,n,r){return e.parent&&n.scales.forEach(function(t){var e=r.filter(function(e){return e.name===Cc(n,t,"data")})[0];e.push="outer",delete e.value,delete e.update}),r}};function Ju(e,t){return"domain("+k(e.scaleName(t))+")"}var Zu="_brush",$u="_scale_trigger",ec={predicate:"vlInterval",scaleDomain:"vlIntervalDomain",signals:function(b,x){var e=x.name,t=Ku.has(x),S=[],E=[],w=[],N=[];if(x.translate&&!t){var r="!event.item || event.item.mark.name !== "+k(e+Zu);tc(x,function(e,t){var n=t.between[0].filter||(t.between[0].filter=[]);n.indexOf(r)<0&&n.push(r)})}return x.project.forEach(function(e){var t=e.channel;if(t===qe||t===We){var n,r,i,a,o,u,c,s,l,f,d,p,h=(n=b,a=Cc(r=x,i=t,"visual"),o=Cc(r,i,"data"),u=Ku.has(r),c=k(n.scaleName(i)),s=n.getScaleComponent(i),l=s?s.get("type"):void 0,f=n.getSizeSignalRef(i===qe?"width":"height").signal,d=i+"(unit)",(p=tc(r,function(e,t){return e.concat({events:t.between[0],update:"["+d+", "+d+"]"},{events:t,update:"["+a+"[0], clamp("+d+", 0, "+f+")]"})})).push({events:{signal:r.name+$u},update:Si(l)&&!xi(l)?"[scale("+c+", "+o+"[0]), scale("+c+", "+o+"[1])]":"[0, 0]"}),u?[{name:o,on:[]}]:[{name:a,value:[],on:p},{name:o,on:[{events:{signal:a},update:a+"[0] === "+a+"[1] ? null : invert("+c+", "+a+")"}]}]),m=Cc(x,t,"data"),g=Cc(x,t,"visual"),v=k(b.scaleName(t)),y=Si(b.getScaleComponent(t).get("type"))?"+":"";S.push.apply(S,h),w.push(m),E.push("{encoding: "+k(t)+", field: "+k(e.field)+", extent: "+m+"}"),N.push({scaleName:b.scaleName(t),expr:"(!isArray("+m+") || ("+y+"invert("+v+", "+g+")[0] === "+y+m+"[0] && "+y+"invert("+v+", "+g+")[1] === "+y+m+"[1]))"})}else vn("Interval selections only support x and y encoding channels.")}),t||S.push({name:e+$u,update:N.map(function(e){return e.expr}).join(" && ")+" ? "+(e+$u)+" : {}"}),S.concat({name:e+bc,on:[{events:w.map(function(e){return{signal:e}}),update:w.join(" && ")+" ? {unit: "+_c(b)+", intervals: ["+E.join(", ")+"]} : null"}]})},modifyExpr:function(e,t){return t.name+bc+", "+("global"===t.resolve?"true":"{unit: "+_c(e)+"}")},marks:function(e,t,n){var r=t.name,i=Ac(t),a=i.xi,o=i.yi,u="data("+k(t.name+yc)+")";if(Ku.has(t))return n;var c={x:null!==a?{signal:r+"_x[0]"}:{value:0},y:null!==o?{signal:r+"_y[0]"}:{value:0},x2:null!==a?{signal:r+"_x[1]"}:{field:{group:"width"}},y2:null!==o?{signal:r+"_y[1]"}:{field:{group:"height"}}};if("global"===t.resolve)for(var s=0,l=ie(c);s<l.length;s++){var f=l[s];c[f]=[Ae({test:u+".length && "+u+"[0].unit === "+_c(e)},c[f]),{value:0}]}var d=t.mark,p=d.fill,h=d.fillOpacity,m=De(d,["fill","fillOpacity"]),g=ie(m).reduce(function(e,t){return e[t]=[{test:[null!==a&&r+"_x[0] !== "+r+"_x[1]",null!=o&&r+"_y[0] !== "+r+"_y[1]"].filter(function(e){return e}).join(" && "),value:m[t]},{value:null}],e},{});return[{name:r+Zu+"_bg",type:"rect",clip:!0,encode:{enter:{fill:{value:p},fillOpacity:{value:h}},update:c}}].concat(n,{name:r+Zu,type:"rect",clip:!0,encode:{enter:{fill:{value:"transparent"}},update:Ae({},c,g)}})}};function tc(e,n){return e.events.reduce(function(e,t){return t.between?n(e,t):(vn(t+" is not an ordered event stream for interval selections"),e)},[])}var nc="voronoi",rc={has:function(e){return"interval"!==e.type&&e.nearest},marks:function(r,e,t){var n=Ac(e),i=n.x,a=n.y,o=r.mark;if(Jt(o))return vn(rn.nearestNotSupportForContinuous(o)),t;var u={name:r.getName(nc),type:"path",from:{data:r.getName("marks")},encode:{enter:{fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0}}},transform:[{type:"voronoi",x:{expr:i||!i&&!a?"datum.datum.x || 0":"0"},y:{expr:a||!i&&!a?"datum.datum.y || 0":"0"},size:[r.getSizeSignalRef("width"),r.getSizeSignalRef("height")]}]},c=0,s=!1;return t.forEach(function(e,t){var n=e.name||"";n===r.component.mark[0].name?c=t:0<=n.indexOf(nc)&&(s=!0)}),s||t.splice(c+1,0,u),t}};function ic(r,e){var t=e.project,i=rc.has(e)?"(item().isVoronoi ? datum.datum : datum)":"datum",a=[],n=t.map(function(e){return k(e.channel)}).filter(function(e){return e}).join(", "),o=t.map(function(e){return k(e.field)}).join(", "),u=t.map(function(e){var t=e.channel,n=r.fieldDef(t);return n&&n.bin?(a.push(e.field),"["+pe(r.vgField(t,{}),i)+", "+pe(r.vgField(t,{binSuffix:"end"}),i)+"]"):""+pe(e.field,i)}).join(", ");return[{name:e.name+bc,value:{},on:[{events:e.events,update:"datum && item().mark.marktype !== 'group' ? {unit: "+_c(r)+", encodings: ["+n+"], fields: ["+o+"], values: ["+u+"]"+(a.length?", "+a.map(function(e){return k("bin_"+e)+": 1"}).join(", "):"")+"} : null",force:!0}]}]}var ac={predicate:"vlMulti",scaleDomain:"vlMultiDomain",signals:ic,modifyExpr:function(e,t){return t.name+bc+", "+("global"===t.resolve?"null":"{unit: "+_c(e)+"}")}},oc={predicate:"vlSingle",scaleDomain:"vlSingleDomain",signals:ic,topLevelSignals:function(e,t,n){var r=n.filter(function(e){return e.name===t.name}),i="data("+k(t.name+yc)+")",a=i+"[0].values";return r.length?n:n.concat({name:t.name,update:i+".length && {"+t.project.map(function(e,t){return e.field+": "+a+"["+t+"]"}).join(", ")+"}"})},modifyExpr:function(e,t){return t.name+bc+", "+("global"===t.resolve?"true":"{unit: "+_c(e)+"}")}},uc="_toggle",cc="_translate_anchor",sc="_translate_delta",lc={has:function(e){return"interval"===e.type&&e.translate},signals:function(e,t,n){var r=t.name,i=Ku.has(t),a=r+cc,o=Ac(t),u=o.x,c=o.y,s=ba(t.translate,"scope");return i||(s=s.map(function(e){return e.between[0].markname=r+Zu,e})),n.push({name:a,value:{},on:[{events:s.map(function(e){return e.between[0]}),update:"{x: x(unit), y: y(unit)"+(null!==u?", extent_x: "+(i?Ju(e,qe):"slice("+Cc(t,"x","visual")+")"):"")+(null!==c?", extent_y: "+(i?Ju(e,We):"slice("+Cc(t,"y","visual")+")"):"")+"}"}]},{name:r+sc,value:{},on:[{events:s,update:"{x: "+a+".x - x(unit), y: "+a+".y - y(unit)}"}]}),null!==u&&fc(e,t,qe,"width",n),null!==c&&fc(e,t,We,"height",n),n}};function fc(e,t,n,r,i){var a=t.name,o=Ku.has(t),u=i.filter(function(e){return e.name===Cc(t,n,o?"data":"visual")})[0],c=a+cc,s=a+sc,l=e.getSizeSignalRef(r).signal,f=e.getScaleComponent(n),d=f.get("type"),p=c+".extent_"+n,h=(o?"log"===d?"panLog":"pow"===d?"panPow":"panLinear":"panLinear")+"("+p+", "+(""+(o&&n===qe?"-":"")+s+"."+n+" / "+(o?""+l:"span("+p+")"))+(o&&"pow"===d?", "+(f.get("exponent")||1):"")+")";u.on.push({events:{signal:s},update:o?h:"clampRange("+h+", 0, "+l+")"})}var dc="_zoom_anchor",pc="_zoom_delta",hc={has:function(e){return"interval"===e.type&&e.zoom},signals:function(e,t,n){var r=t.name,i=Ku.has(t),a=r+pc,o=Ac(t),u=o.x,c=o.y,s=k(e.scaleName(qe)),l=k(e.scaleName(We)),f=ba(t.zoom,"scope");return i||(f=f.map(function(e){return e.markname=r+Zu,e})),n.push({name:r+dc,on:[{events:f,update:i?"{"+[s?"x: invert("+s+", x(unit))":"",l?"y: invert("+l+", y(unit))":""].filter(function(e){return!!e}).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:a,on:[{events:f,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),null!==u&&mc(e,t,"x","width",n),null!==c&&mc(e,t,"y","height",n),n}};function mc(e,t,n,r,i){var a=t.name,o=Ku.has(t),u=i.filter(function(e){return e.name===Cc(t,n,o?"data":"visual")})[0],c=e.getSizeSignalRef(r).signal,s=e.getScaleComponent(n),l=s.get("type"),f=o?Ju(e,n):u.name,d=a+pc,p=(o?"log"===l?"zoomLog":"pow"===l?"zoomPow":"zoomLinear":"zoomLinear")+"("+f+", "+(""+a+dc+"."+n)+", "+d+(o&&"pow"===l?", "+(s.get("exponent")||1):"")+")";u.on.push({events:{signal:d},update:o?p:"clampRange("+p+", 0, "+c+")"})}var gc={project:{has:function(e){var t=e;return void 0!==t.fields||void 0!==t.encodings},parse:function(r,e,t){var i={},a={};(e.fields||[]).forEach(function(e){return i[e]=null}),(e.encodings||[]).forEach(function(e){var t=r.fieldDef(e);if(t)if(t.timeUnit){var n=r.vgField(e);i[n]=e,a[n]={as:n,field:t.field,timeUnit:t.timeUnit}}else i[t.field]=e;else vn(rn.cannotProjectOnChannelWithoutField(e))});var n=t.project||(t.project=[]);for(var o in i)i.hasOwnProperty(o)&&n.push({field:o,channel:i[o]});var u=t.fields||(t.fields={});n.filter(function(e){return e.channel}).forEach(function(e){return u[e.channel]=e.field}),ie(a).length&&(t.timeUnit=new gu(null,a))}},toggle:{has:function(e){return"multi"===e.type&&e.toggle},signals:function(e,t,n){return n.concat({name:t.name+uc,value:!1,on:[{events:t.events,update:t.toggle}]})},modifyExpr:function(e,t,n){var r=t.name+bc,i=t.name+uc;return i+" ? null : "+r+", "+("global"===t.resolve?i+" ? null : true, ":i+" ? null : {unit: "+_c(e)+"}, ")+i+" ? "+r+" : null"}},scales:Ku,translate:lc,zoom:hc,inputs:{has:function(e){return"single"===e.type&&"global"===e.resolve&&e.bind&&"scales"!==e.bind},topLevelSignals:function(e,n,r){var i=n.name,t=n.project,a=n.bind,o=rc.has(n)?"(item().isVoronoi ? datum.datum : datum)":"datum";return t.forEach(function(e){var t=se(i+"_"+e.field);r.filter(function(e){return e.name===t}).length||r.unshift({name:t,value:"",on:[{events:n.events,update:"datum && item().mark.marktype !== 'group' ? "+pe(e.field,o)+" : null"}],bind:a[e.field]||a[e.channel]||a})}),r},signals:function(e,t,n){var r=t.name,i=t.project,a=n.filter(function(e){return e.name===r+bc})[0],o=i.map(function(e){return k(e.field)}).join(", "),u=i.map(function(e){return se(r+"_"+e.field)});return u.length&&(a.update=u.join(" && ")+" ? {fields: ["+o+"], values: ["+u.join(", ")+"]} : null"),delete a.value,delete a.on,n}},nearest:rc};function vc(e,t){for(var n in gc)gc[n].has(e)&&t(gc[n])}var yc="_store",bc="_tuple",xc="_modify",Sc="_selection_domain_";function Ec(n,r){return Nc(n,function(t,e){r=e.marks?e.marks(n,t,r):r,vc(t,function(e){e.marks&&(r=e.marks(n,t,r))})}),r}function wc(o,e,u){var c=[];var t=le(e,function(e){var t=se(e),n=o.getSelectionComponent(t,e),r=k(t+yc);if(n.timeUnit){var i=u||o.component.data.raw,a=n.timeUnit.clone();i.parent?a.insertAsParentOf(i):i.parent=a}return"none"!==n.empty&&c.push(r),kc(n.type).predicate+"("+r+", datum"+("global"===n.resolve?")":", "+k(n.resolve)+")")});return(c.length?"!("+c.map(function(e){return"length(data("+e+"))"}).join(" || ")+") || ":"")+"("+t+")"}function Nc(e,t){var n=e.component.selection;for(var r in n)if(n.hasOwnProperty(r)){var i=n[r];t(i,kc(i.type))}}function kc(e){switch(e){case"single":return oc;case"multi":return ac;case"interval":return ec}return null}function Oc(e){for(var t=e.parent;t&&!Gu(t);)t=t.parent;return t}function _c(e){var t=k(e.name),n=Oc(e);return n&&(t+=(n.facet.row?" + '_' + ("+pe(n.vgField("row"),"facet")+")":"")+(n.facet.column?" + '_' + ("+pe(n.vgField("column"),"facet")+")":"")),t}function Tc(e){var t=!1;return Nc(e,function(e){t=t||e.project.some(function(e){return e.field===Ii})}),t}function Cc(e,t,n){var r=e._signalNames||(e._signalNames={});if(r[t]&&r[t][n])return r[t][n];r[t]=r[t]||{};for(var i=se(e.name+"_"+("visual"===n?t:e.fields[t])),a=i,o=1;r[a];)a=i+"_"+o++;return r[a]=r[t][n]=a}function Ac(e){var n=null,r=null,i=null,a=null;return e.project.forEach(function(e,t){e.channel===qe?(n=e,r=t):e.channel===We&&(i=e,a=t)}),{x:n,xi:r,y:i,yi:a}}function Dc(e){return e&&!!e.field&&void 0!==e.equal}function zc(e){return!!(e&&e.field&&v(e.range)&&2===e.range.length)}function Ic(e){return e&&!!e.field&&(v(e.oneOf)||v(e.in))}function Rc(e){return Ic(e)||Dc(e)||zc(e)}function Lc(n,e,r){return le(e,function(e){return y(e)?e:(t=e)&&t.selection?wc(n,e.selection,r):function(t,e){void 0===e&&(e=!0);var n=t.timeUnit?"time("+Wn(t.timeUnit,t.field)+")":pr(t,{expr:"datum"});{if(Dc(t))return n+"==="+Fc(t.equal,t.timeUnit);if(Ic(t)){var r=t.oneOf||t.in;return"indexof(["+r.map(function(e){return Fc(e,t.timeUnit)}).join(",")+"], "+n+") !== -1"}if(zc(t)){var i=t.range[0],a=t.range[1];if(null!==i&&null!==a&&e)return"inrange("+n+", ["+Fc(i,t.timeUnit)+", "+Fc(a,t.timeUnit)+"])";var o=[];return null!==i&&o.push(n+" >= "+Fc(i,t.timeUnit)),null!==a&&o.push(n+" <= "+Fc(a,t.timeUnit)),0<o.length?o.join(" && "):"true"}}throw new Error("Invalid field predicate: "+JSON.stringify(t))}(e);var t})}function Fc(e,t){if(bn(e))return"time("+Nn(e,!0)+")";if(An(t)){var n={};return n[t]=e,"time("+Nn(n,!0)+")"}return zn(t)?Fc(e,Fn(t)):JSON.stringify(e)}function jc(e){return Rc(e)&&e.timeUnit?Ae({},e,{timeUnit:Bn(e.timeUnit)}):e}function Uc(e,t){var n;n="as"in e?[e.as,e.as+"_end"]:[pr(e,{}),pr(e,{binSuffix:"end"})];var r,i,a,o,u=Tr(e.bin,void 0)||{},c=(r=u,i=e.field,zt(r)+"_"+i),s=(o=c,{signal:(a=t).getName(o+"_bins"),extentSignal:a.getName(o+"_extent")}),l=s.signal,f=s.extentSignal;return{key:c,binComponent:Ae({bin:u,field:e.field,as:n},l?{signal:l}:{},f?{extentSignal:f}:{})}}var Mc=function(r){function u(e,t){var n=r.call(this,e)||this;return n.bins=t,n}return Ce(u,r),u.prototype.clone=function(){return new u(null,ue(this.bins))},u.makeFromEncoding=function(e,o){var t=o.reduceFieldDef(function(e,t,n){if(t.bin){var r=Uc(t,o),i=r.key,a=r.binComponent;e[i]=Ae({},a,e[i],function(e,t,n,r){if(co(t,n)){var i=Wu(e)&&(e.axis(n)||e.legend(n))||{},a=pr(t,{expr:"datum"}),o=pr(t,{expr:"datum",binSuffix:"end"});return{formulaAs:pr(t,{binSuffix:"range"}),formula:ro(a,o,i.format,r)}}return{}}(o,t,n,o.config))}return e},{});return 0===ie(t).length?null:new u(e,t)},u.makeFromTransform=function(e,t,n){var r,i=Uc(t,n),a=i.key,o=i.binComponent;return new u(e,((r={})[a]=o,r))},u.prototype.merge=function(e){this.bins=Ae({},this.bins,e.bins),e.remove()},u.prototype.producedFields=function(){var t={};return ae(this.bins).forEach(function(e){e.as.forEach(function(e){return t[e]=!0})}),t},u.prototype.dependentFields=function(){var t={};return ae(this.bins).forEach(function(e){t[e.field]=!0}),t},u.prototype.assemble=function(){return Z(ae(this.bins).map(function(e){var t=[],n=Ae({type:"bin",field:e.field,as:e.as,signal:e.signal},e.bin);return!e.bin.extent&&e.extentSignal&&(t.push({type:"extent",field:e.field,signal:e.extentSignal}),n.extent={signal:e.extentSignal}),t.push(n),e.formula&&t.push({type:"formula",expr:e.formula,as:e.formulaAs}),t}))},u}(uu),Pc=function(i){function e(e,t,n){var r=i.call(this,e)||this;return r.model=t,r.filter=n,r.expr=Lc(r.model,r.filter,r),r}return Ce(e,i),e.prototype.clone=function(){return new e(null,this.model,ue(this.filter))},e.prototype.assemble=function(){return{type:"filter",expr:this.expr}},e}(uu),Hc=function(a){function o(e,t,n,r){var i=a.call(this,e)||this;return i.fields=t,i.geojson=n,i.signal=r,i}return Ce(o,a),o.prototype.clone=function(){return new o(null,ue(this.fields),this.geojson,this.signal)},o.parseAll=function(n,r){var i=0;if([[Xe,Ye],[Qe,Ve]].forEach(function(e){var t=e.map(function(e){return r.channelHasField(e)?r.fieldDef(e).field:void 0});(t[0]||t[1])&&(n=new o(n,t,null,r.getName("geojson_"+i++)))}),r.channelHasField(Ze)){var e=r.fieldDef(Ze);e.type===er&&(n=new o(n,null,e.field,r.getName("geojson_"+i++)))}return n},o.prototype.assemble=function(){return Ae({type:"geojson"},this.fields?{fields:this.fields}:{},this.geojson?{geojson:this.geojson}:{},{signal:this.signal})},o}(uu),qc=function(a){function o(e,t,n,r){var i=a.call(this,e)||this;return i.projection=t,i.fields=n,i.as=r,i}return Ce(o,a),o.prototype.clone=function(){return new o(null,this.projection,ue(this.fields),ue(this.as))},o.parseAll=function(r,i){return i.projectionName()&&[[Xe,Ye],[Qe,Ve]].forEach(function(e){var t=e.map(function(e){return i.channelHasField(e)?i.fieldDef(e).field:void 0}),n=e[0]===Qe?"2":"";(t[0]||t[1])&&(r=new o(r,i.projectionName(),t,[i.getName("x"+n),i.getName("y"+n)]))}),r},o.prototype.assemble=function(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}},o}(uu),Wc=function(t){function e(e){return t.call(this,e)||this}return Ce(e,t),e.prototype.clone=function(){return new e(null)},e.prototype.producedFields=function(){return(e={})[Ii]=!0,e;var e},e.prototype.assemble=function(){return{type:"identifier",as:Ii}},e}(uu),Gc=function(i){function s(e,t,n){var r=i.call(this,e)||this;return r.transform=t,r.secondary=n,r}return Ce(s,i),s.make=function(e,t,n,r){var i=t.component.data.sources,a=new mu(n.from.data),o=i[a.hash()];o||(o=i[a.hash()]=a);var u=t.getName("lookup_"+r),c=new cu(o,u,"lookup",t.component.data.outputNodeRefCounts);return new s(e,n,(t.component.data.outputNodes[u]=c).getSource())},s.prototype.producedFields=function(){return g(this.transform.from.fields||(this.transform.as instanceof Array?this.transform.as:[this.transform.as]))},s.prototype.assemble=function(){var e;if(this.transform.from.fields)e=Ae({values:this.transform.from.fields},this.transform.as?{as:this.transform.as instanceof Array?this.transform.as:[this.transform.as]}:{});else{var t=this.transform.as;y(t)||(vn(rn.NO_FIELDS_NEEDS_AS),t="_lookup"),e={as:[t]}}return Ae({type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup]},e,this.transform.default?{default:this.transform.default}:{})},s}(uu),Bc=function(r){function e(e,t){var n=r.call(this,e)||this;return n.transform=t,n}return Ce(e,r),e.prototype.clone=function(){return new e(this.parent,ue(this.transform))},e.prototype.producedFields=function(){var t=this,n={};return this.transform.window.forEach(function(e){n[t.getDefaultName(e)]=!0}),n},e.prototype.getDefaultName=function(e){return void 0===e.as?String(e.op)+"_field":e.as},e.prototype.assemble=function(){for(var e=[],t=[],n=[],r=[],i=0,a=this.transform.window;i<a.length;i++){var o=a[i];t.push(o.op),n.push(this.getDefaultName(o)),r.push(void 0===o.param?null:o.param),e.push(void 0===o.field?null:o.field)}var u=this.transform.frame,c=this.transform.groupby,s=[],l=[];if(void 0!==this.transform.sort)for(var f=0,d=this.transform.sort;f<d.length;f++){var p=d[f];s.push(p.field),l.push(void 0===p.order?null:p.order)}var h={field:s,order:l},m=this.transform.ignorePeers,g={type:"window",params:r,as:n,ops:t,fields:e,sort:h};return void 0!==m&&(g.ignorePeers=m),void 0!==c&&(g.groupby=c),void 0!==u&&(g.frame=u),g},e}(uu);function Yc(e){var t=function(e,t){if(e.data||!e.parent){var n=new mu(e.data),r=n.hash();return r in t?t[r]:t[r]=n}return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main}(e,e.component.data.sources),n=e.component.data.outputNodes,r=e.component.data.outputNodeRefCounts;Tc(e)&&(Wu(e)||Vu(e))&&(t=new Wc(t));var i,a,o,u=e.parent&&Vu(e.parent);(Wu(e)||Gu(e))&&u&&(t=Mc.makeFromEncoding(t,e)||t),0<e.transforms.length&&(i=t,o=0,(a=e).transforms.forEach(function(e){if(Ma(e))i=new su(i,e);else if(Fa(e)){var t={},n=e.filter,r=null;Dc(n)?r=n.equal:zc(n)?r=n.range[0]:Ic(n)&&(r=(n.oneOf||n.in)[0]),r&&(bn(r)?t[n.field]="date":x(r)?t[n.field]="number":y(r)&&(t[n.field]="string")),0<ie(t).length&&(i=new hu(i,t)),i=new Pc(i,a,e.filter)}else if(Pa(e))i=Mc.makeFromTransform(i,e,a);else if(Ha(e))i=gu.makeFromTransform(i,e);else if(qa(e))i=fu.makeFromTransform(i,e),Tc(a)&&(i=new Wc(i));else if(ja(e))i=Gc.make(i,a,e,o++);else{if(!Ua(e))return void vn(rn.invalidTransformIgnored(e));i=new Bc(i,e)}}),t=i);var c=hu.make(t,e);c&&(t=c),Wu(e)&&(t=Hc.parseAll(t,e),t=qc.parseAll(t,e)),(Wu(e)||Gu(e))&&(u||(t=Mc.makeFromEncoding(t,e)||t),t=gu.makeFromEncoding(t,e)||t,t=su.parseAllForSortIndex(t,e));var s=e.getName(va),l=new cu(t,s,va,r);if(t=n[s]=l,Wu(e)){var f=fu.makeFromEncoding(t,e);f&&(t=f,Tc(e)&&(t=new Wc(t))),t=Su.make(t,e)||t}Wu(e)&&(t=pu.make(t,e)||t);var d=e.getName(ga),p=new cu(t,d,ga,r);t=n[d]=p;var h=null;if(Gu(e)){var m=e.getName("facet");h=new du(t,e,m,p.getSource()),t=n[m]=h}var g=Ae({},e.component.data.ancestorParse,c?c.parse:{});return Ae({},e.component.data,{outputNodes:n,outputNodeRefCounts:r,raw:l,main:p,facetRoot:h,ancestorParse:g})}var Vc=function(o){function e(e,t,n,r,i,a){return o.call(this,e,t,n,r,i,a)||this}return Ce(e,o),e.prototype.parseData=function(){this.component.data=Yc(this),this.children.forEach(function(e){e.parseData()})},e.prototype.parseSelection=function(){var n=this;this.component.selection={};for(var e=function(t){t.parseSelection(),ie(t.component.selection).forEach(function(e){n.component.selection[e]=t.component.selection[e]})},t=0,r=this.children;t<r.length;t++){e(r[t])}},e.prototype.parseMarkGroup=function(){for(var e=0,t=this.children;e<t.length;e++){t[e].parseMarkGroup()}},e.prototype.parseAxisAndHeader=function(){for(var e=0,t=this.children;e<t.length;e++){t[e].parseAxisAndHeader()}},e.prototype.assembleSelectionTopLevelSignals=function(e){return this.children.reduce(function(e,t){return t.assembleSelectionTopLevelSignals(e)},e)},e.prototype.assembleSelectionSignals=function(){return this.children.forEach(function(e){return e.assembleSelectionSignals()}),[]},e.prototype.assembleLayoutSignals=function(){return this.children.reduce(function(e,t){return e.concat(t.assembleLayoutSignals())},ho(this))},e.prototype.assembleSelectionData=function(e){return this.children.reduce(function(e,t){return t.assembleSelectionData(e)},e)},e.prototype.assembleMarks=function(){return this.children.map(function(e){var t=e.assembleTitle(),n=e.assembleGroupStyle(),r=e.assembleLayoutSize();return Ae({type:"group",name:e.getName("group")},t?{title:t}:{},n?{style:n}:{},r?{encode:{update:r}}:{},e.assembleGroup())})},e}(Xu);function Xc(e){Kc(e);var t=e.component.layoutSize;t.setWithExplicit("width",Jc(e,"width")),t.setWithExplicit("height",Jc(e,"height"))}var Qc=Xc;function Kc(e){for(var t=0,n=e.children;t<n.length;t++){n[t].parseLayoutSize()}}function Jc(e,t){for(var n,r="width"===t?"x":"y",i=e.component.resolve,a=0,o=e.children;a<o.length;a++){var u=(f=o[a]).component.layoutSize.getWithExplicit(t),c=i.scale[r];if("independent"===c&&"range-step"===u.value){n=void 0;break}if(n){if("independent"===c&&n.value!==u.value){n=void 0;break}n=No(n,u,t,"")}else n=u}if(n){for(var s=0,l=e.children;s<l.length;s++){var f=l[s];e.renameLayoutSize(f.getName(t),e.getName(t)),f.component.layoutSize.set(t,"merged",!1)}return n}return{explicit:!1,value:void 0}}function Zc(e,t){var n="width"===t?"x":"y",r=e.config,i=e.getScaleComponent(n);if(i){var a=i.get("type"),o=i.get("range");return bi(a)&&Ya(o)?"range-step":r.view[t]}return"width"===t&&"text"===e.mark?r.scale.textXRangeStep:r.scale.rangeStep||wi.rangeStep}var $c=function(o){function e(e,t,n,r,i){var a=o.call(this,e,t,n,i,r,e.resolve)||this;return a.type="concat",e.resolve&&e.resolve.axis&&("shared"===e.resolve.axis.x||"shared"===e.resolve.axis.y)&&vn(rn.CONCAT_CANNOT_SHARE_AXIS),a.isVConcat=ta(e),a.children=(ta(e)?e.vconcat:e.hconcat).map(function(e,t){return ws(e,a,a.getName("concat_"+t),void 0,r,i,!1)}),a}return Ce(e,o),e.prototype.parseLayoutSize=function(){!function(e){Kc(e);var t=e.component.layoutSize,n=e.isVConcat?"width":"height";t.setWithExplicit(n,Jc(e,n))}(this)},e.prototype.parseAxisGroup=function(){return null},e.prototype.assembleLayout=function(){return Ae({padding:{row:10,column:10},offset:10},this.isVConcat?{columns:1}:{},{bounds:"full",align:"each"})},e}(Vc);function es(i){var a=0;return function t(e,n){e instanceof mu&&(pa(e.data)||(i.push(n),n={name:null,source:n.name,transform:[]}));if(e instanceof hu&&(e.parent instanceof mu&&!n.source?(n.format=Ae({},n.format||{},{parse:e.assembleFormatParse()}),n.transform=n.transform.concat(e.assembleTransforms(!0))):n.transform=n.transform.concat(e.assembleTransforms())),e instanceof du)return n.name||(n.name="data_"+a++),!n.source||0<n.transform.length?(i.push(n),e.data=n.name):e.data=n.source,void e.assemble().forEach(function(e){return i.push(e)});(e instanceof Pc||e instanceof su||e instanceof qc||e instanceof Hc||e instanceof fu||e instanceof Gc||e instanceof Bc||e instanceof Wc)&&n.transform.push(e.assemble()),(e instanceof pu||e instanceof Mc||e instanceof gu||e instanceof Su)&&(n.transform=n.transform.concat(e.assemble())),e instanceof fu&&(n.name||(n.name="data_"+a++)),e instanceof cu&&(n.source&&0===n.transform.length?e.setSource(n.source):e.parent instanceof cu?e.setSource(n.name):(n.name||(n.name="data_"+a++),e.setSource(n.name),1===e.numChildren()&&(i.push(n),n={name:null,source:n.name,transform:[]})));switch(e.numChildren()){case 0:e instanceof cu&&(!n.source||0<n.transform.length)&&i.push(n);break;case 1:t(e.children[0],n);break;default:n.name||(n.name="data_"+a++);var r=n.name;!n.source||0<n.transform.length?i.push(n):r=n.source,e.children.forEach(function(e){t(e,{name:null,source:r,transform:[]})})}}}function ts(e,t){return ir(e.field)?e.field.repeat in t?Ae({},e,{field:t[e.field.repeat]}):void vn(rn.noSuchRepeatedValue(e.field.repeat)):e}function ns(e,t){if(void 0!==(e=ts(e,t))){if(e.sort&&iu(e.sort)){var n=ts(e.sort,t);e=Ae({},e,n?{sort:n}:{})}return e}}function rs(e,t){if(!sr(e)){if(ur(e)){if(n=ns(e.condition,t))return Ae({},e,{condition:n});e.condition;return De(e,["condition"])}return e}var n;return(n=ns(e,t))?n:or(e)?{condition:e.condition}:void 0}function is(e,t){var n={};for(var r in e)if(e.hasOwnProperty(r)){var i=e[r];if(v(i))n[r]=i.map(function(e){return rs(e,t)}).filter(function(e){return e});else{var a=rs(i,t);a&&(n[r]=a)}}return n}var as=function(u){function s(e,t,n,r,i){var a=u.call(this,e,t,n,i,r,e.resolve)||this;a.type="facet",a.child=ws(e.spec,a,a.getName("child"),void 0,r,i,!1),a.children=[a.child];var o=is(e.facet,r);return a.facet=a.initFacet(o),a}return Ce(s,u),s.prototype.initFacet=function(e){return Pr(e,function(e,t,n){return X([Ke,Je],n)?void 0===t.field?vn(rn.emptyFieldDef(t,n)):e[n]=Or(t,n):vn(rn.incompatibleChannel(n,"facet")),e},{})},s.prototype.channelHasField=function(e){return!!this.facet[e]},s.prototype.fieldDef=function(e){return this.facet[e]},s.prototype.parseData=function(){this.component.data=Yc(this),this.child.parseData()},s.prototype.parseLayoutSize=function(){Kc(this)},s.prototype.parseSelection=function(){this.child.parseSelection(),this.component.selection=this.child.component.selection},s.prototype.parseMarkGroup=function(){this.child.parseMarkGroup()},s.prototype.parseAxisAndHeader=function(){this.child.parseAxisAndHeader(),this.parseHeader("column"),this.parseHeader("row"),this.mergeChildAxis("x"),this.mergeChildAxis("y")},s.prototype.parseHeader=function(e){if(this.channelHasField(e)){var t=this.facet[e],n=t.header||{},r=void 0!==t.title?t.title:void 0!==n.title?n.title:wr(t,this.config);this.child.component.layoutHeaders[e].title&&(r+=" / "+this.child.component.layoutHeaders[e].title,this.child.component.layoutHeaders[e].title=null),this.component.layoutHeaders[e]={title:r,facetFieldDef:t,header:[this.makeHeaderComponent(e,!0)]}}},s.prototype.makeHeaderComponent=function(e,t){var n="row"===e?"height":"width";return{labels:t,sizeSignal:this.child.component.layoutSize.get(n)?this.child.getSizeSignalRef(n):void 0,axes:[]}},s.prototype.mergeChildAxis=function(e){var t,n=this.child;if(n.component.axes[e]){var r=this.component,i=r.layoutHeaders,a=r.resolve;if(a.axis[e]=yo(a,e),"shared"===a.axis[e])for(var o="x"===e?"column":"row",u=i[o],c=0,s=n.component.axes[e];c<s.length;c++){var l=s[c],f="top"===(t=l.get("orient"))||"left"===t?"header":"footer";u[f]=u[f]||[this.makeHeaderComponent(o,!1)];var d=Qa(l,"main",this.config,{header:!0});u[f][0].axes.push(d),l.mainExtracted=!0}}},s.prototype.assembleSelectionTopLevelSignals=function(e){return this.child.assembleSelectionTopLevelSignals(e)},s.prototype.assembleSelectionSignals=function(){return this.child.assembleSelectionSignals(),[]},s.prototype.assembleSelectionData=function(e){return this.child.assembleSelectionData(e)},s.prototype.getLayoutBandMixins=function(e){for(var t={},n="header"===e?"headerBand":"footerBand",r=0,i=["row","column"];r<i.length;r++){var a=i[r],o=this.component.layoutHeaders[a][e];if(o&&o[0]){var u="row"===a?"height":"width";this.child.component.layoutSize.get(u)||(t[n]=t[n]||{},t[n][a]=.5)}}return t},s.prototype.assembleLayout=function(){var e=this.channelHasField("column")?this.columnDistinctSignal():1;return Ae({padding:{row:10,column:10}},this.getLayoutBandMixins("header"),this.getLayoutBandMixins("footer"),{offset:10,columns:e,bounds:"full",align:"all"})},s.prototype.assembleLayoutSignals=function(){return this.child.assembleLayoutSignals()},s.prototype.columnDistinctSignal=function(){if(!(this.parent&&this.parent instanceof s))return{signal:"length(data('"+this.getName("column_domain")+"'))"}},s.prototype.assembleGroup=function(e){return this.parent&&this.parent instanceof s?Ae({},this.channelHasField("column")?{encode:{update:{columns:{field:pr(this.facet.column,{prefix:"distinct"})}}}}:{},u.prototype.assembleGroup.call(this,e)):u.prototype.assembleGroup.call(this,e)},s.prototype.getCardinalityAggregateForChild=function(){var e=[],t=[];if(this.child instanceof s)this.child.channelHasField("column")&&(e.push(pr(this.child.facet.column)),t.push("distinct"));else for(var n=0,r=["x","y"];n<r.length;n++){var i=r[n],a=this.child.component.scales[i];if(a&&!a.merged){var o=a.get("type"),u=a.get("range");if(bi(o)&&Ya(u)){var c=Cu(Au(this.child,i));c?(e.push(c),t.push("distinct")):vn("Unknown field for ${channel}.  Cannot calculate view size.")}}}return e.length?{fields:e,ops:t}:void 0},s.prototype.assembleMarks=function(){var t,e,n,r=this.child,i=this.facet,a=this.component.data.facetRoot,o=(t=a,n=es(e=[]),t.children.forEach(function(e){return n(e,{source:t.name,name:null,transform:[]})}),e),u=this.channelHasField(Ke),c=this.channelHasField(Je),s=r.assembleLayoutSize(),l={};u&&c&&(l.aggregate={cross:!0});var f=this.getCardinalityAggregateForChild();f&&(l.aggregate=Ae({},l.aggregate,f));var d=r.assembleTitle(),p=r.assembleGroupStyle();return[Ae({name:this.getName("cell"),type:"group"},d?{title:d}:{},p?{style:p}:{},{from:{facet:Ae({name:a.name,data:a.data,groupby:[].concat(u?[this.vgField(Ke)]:[],c?[this.vgField(Je)]:[])},l)},sort:{field:[].concat(u?[this.vgField(Ke,{expr:"datum"})]:[],c?[this.vgField(Je,{expr:"datum"})]:[]),order:[].concat(u?[i.row.sort||"ascending"]:[],c?[i.column.sort||"ascending"]:[])}},0<o.length?{data:o}:{},s?{encode:{update:s}}:{},r.assembleGroup())]},s.prototype.getMapping=function(){return this.facet},s}(Qu);var os=function(i){function e(e,t,n){void 0===e&&(e={}),void 0===t&&(t={}),void 0===n&&(n=!1);var r=i.call(this)||this;return r.explicit=e,r.implicit=t,r.mainExtracted=n,r}return Ce(e,i),e.prototype.clone=function(){return new e(ue(this.explicit),ue(this.implicit),this.mainExtracted)},e.prototype.hasAxisPart=function(e){return"axis"===e||("grid"===e||"title"===e?!!this.get(e):!(!1===(t=this.get(e))||null===t));var t},e}(bo);function us(e,t,n,r,i){void 0===r&&(r="");for(var a=0,o=("band"===i?["axisBand"]:[]).concat(["x"===n?"axisX":"axisY","axis"+r.substr(0,1).toUpperCase()+r.substr(1),"axis"]);a<o.length;a++){var u=o[a];if(t[u]&&void 0!==t[u][e])return t[u][e]}}function cs(e,t,n,r){var i=e.fieldDef(t)||("x"===t?e.fieldDef("x2"):"y"===t?e.fieldDef("y2"):void 0),a=e.axis(t),o=e.config,u={};if(zr(i)){var c=e.getScaleComponent(t).get("type")===Jr.UTC;u.text={signal:io("datum.value",i.timeUnit,a.format,o.axis.shortTimeLabels,o.timeFormat,c)}}var s,l,f,d,p=us("labelAngle",e.config,t,r,e.getScaleComponent(t).get("type"));if(void 0===p&&(p=function(e,t,n){{if(void 0!==e.labelAngle)return(e.labelAngle%360+360)%360;if(t===qe&&X([$n,Jn],n.type))return 270}return}(a,t,i))&&(u.angle={value:p}),void 0!==p){var h=(f=((f=p)%360+360)%360,"top"===(d=r)||"bottom"===d?f%180==0?"center":0<f&&f<180?"top"===d?"right":"left":"top"===d?"left":"right":(f+90)%180==0?"center":90<=f&&f<270?"left"===d?"left":"right":"left"===d?"right":"left");h&&(u.align={value:h}),u.baseline=(s=p,"top"===(l=r)||"bottom"===l?s<=45||315<=s?{value:"top"===l?"bottom":"top"}:135<=s&&s<=225?{value:"top"===l?"top":"bottom"}:{value:"middle"}:s<=45||315<=s||135<=s&&s<=225?{value:"middle"}:45<=s&&s<=135?{value:"left"===l?"top":"bottom"}:{value:"left"===l?"bottom":"top"})}return u=Ae({},u,n),0===ie(u).length?void 0:u}function ss(n){return Et.reduce(function(e,t){return n.component.scales[t]&&n.axis(t)&&(e[t]=[function(i,a){var o=a.axis(i),u=new os;Me.forEach(function(e){var t=function(e,t,n,r){var i=r.fieldDef(n);switch(e){case"scale":return r.scaleName(n);case"gridScale":return function(e,t){var n="x"===t?"y":"x";if(e.getScaleComponent(n))return e.scaleName(n)}(r,n);case"format":return eo(i,t.format,r.config);case"grid":var a=r.getScaleComponent(n).get("type");return $a(t.grid,(v=i,!bi(a)&&!v.bin));case"labelFlush":return h=i,m=n,void 0!==(g=t).labelFlush?g.labelFlush:!("x"!==m||!X(["quantitative","temporal"],h.type))||void 0;case"labelOverlap":var a=r.getScaleComponent(n).get("type");return f=i,p=a,void 0!==(d=t).labelOverlap?d.labelOverlap:"nominal"!==f.type?"log"!==p||"greedy":void 0;case"orient":return $a(t.orient,function(e){switch(e){case qe:return"bottom";case We:return"left"}throw new Error(rn.INVALID_CHANNEL_FOR_AXIS)}(n));case"tickCount":var a=r.getScaleComponent(n).get("type"),o="x"===n?"width":"y"===n?"height":void 0,u=o?r.getSizeSignalRef(o):void 0;return $a(t.tickCount,function(e,t,n,r){if(!bi(n)&&"log"!==n&&!X(["month","hours","day","quarter"],t.timeUnit))return t.bin?{signal:"ceil("+r.signal+"/20)"}:{signal:"ceil("+r.signal+"/40)"}}(0,i,a,u));case"title":var c="x"===n?"x2":"y2",s=r.fieldDef(c),l=void 0!==i.title?i.title:void 0===t.title?void 0:t.title;return $a(l,oo([ar(i)],s?[ar(s)]:[]));case"values":return function(e,t,n,r){var i=e.values;if(e.values&&bn(i[0]))return i.map(function(e){return{signal:Nn(e,!0)}});if(!i&&n.bin&&n.type===Kn){var a=t.scaleDomain(r);if(a&&"unaggregated"!==a&&!ki(a))return i;var o=t.getName(zt(n.bin)+"_"+n.field+"_bins");return{signal:"sequence("+o+".start, "+o+".stop + "+o+".step, "+o+".step)"}}return i}(t,r,i,n)}var f,d,p;var h,m,g;var v;return Fe(e)?t[e]:void 0}(e,o,i,a);if(void 0!==t){var n="values"===e?!!o.values:"encode"===e?!!o.encoding||!!o.labelAngle:t===o[e],r=us(e,a.config,i,u.get("orient"),a.getScaleComponent(i).get("type"));(n||void 0===r)&&u.set(e,t,n)}});var r=o.encoding||{},e=ze.reduce(function(e,t){if(!u.hasAxisPart(t))return e;var n="labels"===t?cs(a,i,r.labels||{},u.get("orient")):r[t]||{};return void 0!==n&&0<ie(n).length&&(e[t]={update:n}),e},{});0<ie(e).length&&u.set("encode",e,!!o.encoding||void 0!==o.labelAngle);return u}(t,n)]),e},{})}var ls={bottom:"top",top:"bottom",left:"right",right:"left"};function fs(e,t){if(!e)return t.map(function(e){return e.clone()});if(e.length===t.length){for(var n=e.length,r=0;r<n;r++){var i=e[r],a=t[r];if(!!i!=!!a)return;if(i&&a){var o=i.getWithExplicit("orient"),u=a.getWithExplicit("orient");if(o.explicit&&u.explicit&&o.value!==u.value)return;e[r]=ds(i,a)}}return e}}function ds(t,r){for(var e=function(n){var e=No(t.getWithExplicit(n),r.getWithExplicit(n),n,"axis",function(e,t){switch(n){case"title":return uo(e,t);case"gridScale":return{explicit:e.explicit,value:e.value||t.value}}return wo(e,t,n,"axis")});t.setWithExplicit(n,e)},n=0,i=Me;n<i.length;n++){e(i[n])}return t}function ps(e,t,n){var r,i,a,o=$t(e)?Ae({},e):{type:e},u=o.orient||Ja("orient",o,n);return o.orient=function(e,t,n){switch(e){case Ht:case Xt:case Qt:case qt:case Bt:return}var r=t.y2,i=t.x2;switch(e){case Yt:if(i&&r)return;case Mt:case Ut:if(r)return"vertical";if(i)return"horizontal";if(e===Yt){if(t.x&&!t.y)return"vertical";if(t.y&&!t.x)return"horizontal"}case Pt:case Wt:var a=sr(t.x)&&mr(t.x),o=sr(t.y)&&mr(t.y);if(a&&!o)return"tick"!==e?"horizontal":"vertical";if(!a&&o)return"tick"!==e?"vertical":"horizontal";if(a&&o){var u=t.x,c=t.y,s=u.type===Zn,l=c.type===Zn;return s&&!l?"tick"!==e?"vertical":"horizontal":!s&&l?"tick"!==e?"horizontal":"vertical":!u.aggregate&&c.aggregate?"tick"!==e?"vertical":"horizontal":u.aggregate&&!c.aggregate?"tick"!==e?"horizontal":"vertical":n||(e===Pt&&t.order||vn(rn.unclearOrientContinuous(e)),"vertical")}return void vn(rn.unclearOrientDiscreteOrEmpty(e))}return"vertical"}(o.type,t,u),void 0!==u&&u!==o.orient&&vn(rn.orientOverridden(o.orient,u)),void 0===(void 0!==o.opacity?o.opacity:Ja("opacity",o,n))&&(o.opacity=function(e,t){if(X([Ht,Wt,Xt,Qt],e)&&!Lr(t))return.7;return}(o.type,t)),void 0===o.filled&&(o.filled=(i=Ja("filled",r=o,n),a=r.type,void 0!==i?i:a!==Ht&&a!==Pt&&a!==Yt)),o}function hs(e,t,n,r){if(void 0!==e.size)return{value:e.size};if(r.bar.discreteBandSize)return{value:r.bar.discreteBandSize};if(n){var i=n.get("type");if(i!==Jr.POINT)return i===Jr.BAND?To(t):{value:r.bar.continuousBandSize};var a=n.get("range");if(Ya(a)&&x(a.step))return{value:a.step-1};vn(rn.BAR_WITH_POINT_SCALE_AND_RANGESTEP_NULL)}else if(r.scale.rangeStep&&null!==r.scale.rangeStep)return{value:r.scale.rangeStep-1};return{value:20}}function ms(e,t){var n=e.config,r=e.width,i=e.height;return Ae({},Ro(e,{size:"include",orient:"ignore"}),Go("x",e,Do(r)),Go("y",e,Do(i)),jo("size",e),function(e,t,n){if(n)return{shape:{value:n}};return jo("shape",e,{defaultValue:Ja("shape",e.markDef,t)})}(e,n,t))}var gs={area:{vgMark:"area",encodeEntry:function(e){return Ae({},Ro(e,{size:"ignore",orient:"include"}),Go("x",e,"zeroOrMin"),Go("y",e,"zeroOrMin"),Bo(e,"zeroOrMin"),Fo(e))}},bar:{vgMark:"rect",encodeEntry:function(e){return Ae({},Ro(e,{size:"ignore",orient:"ignore"}),function(e){var t=e.config,n=e.encoding,r=e.markDef,i=e.width,a=r.orient,o=n.size,u=n.x,c=e.scaleName(qe),s=e.getScaleComponent(qe);{if("horizontal"===a)return Ae({},Go("x",e,"zeroOrMin"),Bo(e,"zeroOrMin"));if(sr(u)){var l=s.get("type");if(u.bin&&!o&&!bi(l))return Wo(u,"x",e.scaleName("x"),void 0===r.binSpacing?t.bar.binSpacing:r.binSpacing,s.get("reverse"));if(l===Jr.BAND)return Ho(u,"x",e)}return qo("x",e,Ae({},Do(i)),hs(r,c,s,t))}}(e),function(e){var t=e.config,n=e.encoding,r=e.height,i=e.markDef,a=i.orient,o=n.size,u=n.y,c=e.scaleName(We),s=e.getScaleComponent(We);{if("vertical"===a)return Ae({},Go("y",e,"zeroOrMin"),Bo(e,"zeroOrMin"));if(sr(u)){var l=s.get("type");if(u.bin&&!o&&!bi(l))return Wo(u,"y",e.scaleName("y"),void 0===i.binSpacing?t.bar.binSpacing:i.binSpacing,s.get("reverse"));if(l===Jr.BAND)return Ho(u,"y",e)}return qo("y",e,Do(r),hs(i,c,s,t))}}(e))}},circle:{vgMark:"symbol",encodeEntry:function(e){return ms(e,"circle")}},geoshape:{vgMark:"shape",encodeEntry:function(e){return Ae({},Ro(e,{size:"ignore",orient:"ignore"}))},postEncodingTransform:function(e){var t=e.encoding.shape;return[Ae({type:"geoshape",projection:e.projectionName()},t&&sr(t)&&t.type===er?{field:pr(t,{expr:"datum"})}:{})]}},line:{vgMark:"line",encodeEntry:function(e){var t=e.width,n=e.height;return Ae({},Ro(e,{size:"ignore",orient:"ignore"}),Go("x",e,Do(t)),Go("y",e,Do(n)),jo("size",e,{vgChannel:"strokeWidth"}),Fo(e))}},point:{vgMark:"symbol",encodeEntry:function(e){return ms(e)}},rect:{vgMark:"rect",encodeEntry:function(e){return Ae({},Ro(e,{size:"ignore",orient:"ignore"}),function(e){var t=e.encoding.x,n=e.encoding.x2,r=e.getScaleComponent(qe),i=r?r.get("type"):void 0;{if(sr(t)&&t.bin&&!n)return Wo(t,"x",e.scaleName("x"),0,r.get("reverse"));if(sr(t)&&r&&bi(i)){if(i===Jr.BAND)return Ho(t,"x",e);throw new Error(rn.scaleTypeNotWorkWithMark(Bt,i))}return Ae({},Go("x",e,"zeroOrMax"),Bo(e,"zeroOrMin","x2"))}}(e),function(e){var t=e.encoding.y,n=e.encoding.y2,r=e.getScaleComponent(We),i=r?r.get("type"):void 0;{if(sr(t)&&t.bin&&!n)return Wo(t,"y",e.scaleName("y"),0,r.get("reverse"));if(sr(t)&&r&&bi(i)){if(i===Jr.BAND)return Ho(t,"y",e);throw new Error(rn.scaleTypeNotWorkWithMark(Bt,i))}return Ae({},Go("y",e,"zeroOrMax"),Bo(e,"zeroOrMin","y2"))}}(e))}},rule:{vgMark:"rule",encodeEntry:function(e){e.config;var t=e.markDef,n=e.width,r=e.height,i=t.orient;return e.encoding.x||e.encoding.y||e.encoding.latitude||e.encoding.longitude?Ae({},Ro(e,{size:"ignore",orient:"ignore"}),Go("x",e,"horizontal"===i?"zeroOrMin":Do(n)),Go("y",e,"vertical"===i?"zeroOrMin":Do(r)),"vertical"!==i?Bo(e,"zeroOrMax","x2"):{},"horizontal"!==i?Bo(e,"zeroOrMax","y2"):{},jo("size",e,{vgChannel:"strokeWidth",defaultValue:t.size})):{}}},square:{vgMark:"symbol",encodeEntry:function(e){return ms(e,"square")}},text:{vgMark:"text",encodeEntry:function(e){var t=e.config,n=e.encoding,r=e.height,i=e.markDef,a=n.text;return Ae({},Ro(e,{size:"ignore",orient:"ignore"}),Go("x",e,function(e,t){if(sr(t)&&t.type===Kn)return{field:{group:"width"},offset:-5};return{value:e.scale.textXRangeStep/2}}(t,a)),Go("y",e,Do(r)),Mo(e),jo("size",e,Ae({},i.size?{defaultValue:i.size}:{},{vgChannel:"fontSize"})),function(e,t){if(void 0!==t)return(n={})[e]={value:t},n;var n}("align",function(e,t,n){if(void 0===(e.align||Ja("align",e,n)))return Rr(t,qe)||Rr(t,Xe)?"center":"right";return}(e.markDef,n,t)))}},tick:{vgMark:"rect",encodeEntry:function(e){var t,n=e.config,r=e.markDef,i=e.width,a=e.height,o=r.orient,u="horizontal"===o?"width":"height",c="horizontal"===o?"height":"width";return Ae({},Ro(e,{size:"ignore",orient:"ignore"}),Go("x",e,Do(i),"xc"),Go("y",e,Do(a),"yc"),jo("size",e,{defaultValue:function(e){var t=e.config,n=e.markDef,r=n.orient,i=e.getScaleComponent("horizontal"===r?"x":"y");{if(void 0!==n.size)return n.size;if(void 0!==t.tick.bandSize)return t.tick.bandSize;var a=i?i.get("range"):void 0,o=a&&Ya(a)?a.step:t.scale.rangeStep;if("number"!=typeof o)throw new Error("Function does not handle non-numeric rangeStep");return o/1.5}}(e),vgChannel:u}),((t={})[c]={value:n.tick.thickness},t))}},trail:{vgMark:"trail",encodeEntry:function(e){var t=e.width,n=e.height;return Ae({},Ro(e,{size:"include",orient:"ignore"}),Go("x",e,Do(t)),Go("y",e,Do(n)),jo("size",e),Fo(e))}}};function vs(e){return X([Pt,Ut,Gt],e.mark)?(i=(t=e).mark,a=t.encoding,n=ie(a).reduce(function(t,e){switch(e){case"x":case"y":case"order":case"tooltip":case"href":case"x2":case"y2":case"latitude":case"longitude":case"latitude2":case"longitude2":case"text":case"shape":return t;case"detail":case"key":var n=a[e];return n&&(v(n)?n:[n]).forEach(function(e){e.aggregate||t.push(pr(e,{}))}),t;case"size":if("trail"===i)return t;case"color":case"fill":case"stroke":case"opacity":var r=kr(a[e]);return r&&!r.aggregate&&t.push(pr(r,{})),t;default:throw new Error("Bug: Channel "+e+" unimplemented for line mark")}},[]),r=bs(t,{fromPrefix:0<n.length?ys:""}),0<n.length?[{name:t.getName("pathgroup"),type:"group",from:{facet:{name:ys+t.requestDataName(ga),data:t.requestDataName(ga),groupby:n}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:r}]:r):bs(e);var t,n,r,i,a}var ys="faceted_path_";function bs(e,t){void 0===t&&(t={fromPrefix:""});var n,r,i,a=e.mark,o=void 0!==e.markDef.clip?!!e.markDef.clip:(r=(n=e).getScaleComponent("x"),i=n.getScaleComponent("y"),!!(r&&r.get("domainRaw")||i&&i.get("domainRaw"))),u=Ka(e.markDef),c=e.encoding.key,s=function(e){var t=e.encoding.order;if(v(t)||!fr(t)){if((v(t)||sr(t))&&!e.stack)return ao(t,{expr:"datum"});if(Jt(e.mark)){var n="horizontal"===e.markDef.orient?"y":"x",r=e.sort(n),i=iu(r)?pr({aggregate:Lr(e.encoding)?r.op:void 0,field:r.field},{expr:"datum"}):e.vgField(n,{binSuffix:e.stack&&e.stack.impute?"mid":void 0,expr:"datum"});return i?{field:i,order:"descending"}:void 0}}}(e),l=gs[a].postEncodingTransform?gs[a].postEncodingTransform(e):null;return[Ae({name:e.getName("marks"),type:gs[a].vgMark},o?{clip:!0}:{},u?{style:u}:{},c?{key:{field:c.field}}:{},s?{sort:s}:{},{from:{data:t.fromPrefix+e.requestDataName(ga)},encode:{update:gs[a].encodeEntry(e)}},l?{transform:l}:{})]}var xs=function(l){function e(e,t,n,r,i,a,o){void 0===r&&(r={});var u=l.call(this,e,t,n,a,i,void 0)||this;u.fit=o,u.type="unit",u.specifiedScales={},u.specifiedAxes={},u.specifiedLegends={},u.specifiedProjection={},u.selection={},u.children=[],u.initSize(Ae({},r,e.width?{width:e.width}:{},e.height?{height:e.height}:{}));var c=$t(e.mark)?e.mark.type:e.mark,s=u.encoding=Fr(is(e.encoding||{},i),c);return u.markDef=ps(e.mark,s,a),u.stack=Xi(c,s,u.config.stack),u.specifiedScales=u.initScales(c,s),u.specifiedAxes=u.initAxes(s),u.specifiedLegends=u.initLegend(s),u.specifiedProjection=e.projection,u.selection=e.selection,u}return Ce(e,l),e.prototype.scaleDomain=function(e){var t=this.specifiedScales[e];return t?t.domain:void 0},e.prototype.sort=function(e){return(this.getMapping()[e]||{}).sort},e.prototype.axis=function(e){return this.specifiedAxes[e]},e.prototype.legend=function(e){return this.specifiedLegends[e]},e.prototype.initScales=function(e,a){return Ot.reduce(function(e,t){var n,r,i=a[t];return sr(i)?r=(n=i).scale:ur(i)?(n=i.condition,r=i.condition.scale):"x"===t?n=kr(a.x2):"y"===t&&(n=kr(a.y2)),n&&(e[t]=r||{}),e},{})},e.prototype.initAxes=function(i){return[qe,We].reduce(function(e,t){var n=i[t];if(sr(n)||t===qe&&sr(i.x2)||t===We&&sr(i.y2)){var r=sr(n)?n.axis:null;null!==r&&!1!==r&&(e[t]=Ae({},r))}return e},{})},e.prototype.initLegend=function(i){return Nt.reduce(function(e,t){var n=i[t];if(n){var r=sr(n)?n.legend:ur(n)?n.condition.legend:null;null!==r&&!1!==r&&(e[t]=Ae({},r))}return e},{})},e.prototype.parseData=function(){this.component.data=Yc(this)},e.prototype.parseLayoutSize=function(){!function(e){var t=e.component.layoutSize;if(!t.explicit.width){var n=Zc(e,"width");t.set("width",n,!1)}if(!t.explicit.height){var r=Zc(e,"height");t.set("height",r,!1)}}(this)},e.prototype.parseSelection=function(){this.component.selection=function(a,o){var u={},c=a.config.selection,e=function(e){if(!o.hasOwnProperty(e))return"continue";var t=o[e],n=c[t.type];for(var r in n)"encodings"===r&&t.fields||"fields"===r&&t.encodings||("mark"===r&&(t[r]=Ae({},n[r],t[r])),void 0!==t[r]&&!0!==t[r]||(t[r]=n[r]||t[r]));e=se(e);var i=u[e]=Ae({},t,{name:e,events:y(t.on)?ba(t.on,"scope"):t.on});vc(i,function(e){e.parse&&e.parse(a,t,i)})};for(var t in o)e(t);return u}(this,this.selection)},e.prototype.parseMarkGroup=function(){this.component.mark=vs(this)},e.prototype.parseAxisAndHeader=function(){this.component.axes=ss(this)},e.prototype.assembleSelectionTopLevelSignals=function(e){return r=e,i=!1,Nc(n=this,function(t,e){e.topLevelSignals&&(r=e.topLevelSignals(n,t,r)),vc(t,function(e){e.topLevelSignals&&(r=e.topLevelSignals(n,t,r))}),i=!0}),i&&(r.filter(function(e){return"unit"===e.name}).length||r.unshift({name:"unit",value:{},on:[{events:"mousemove",update:"isTuple(group()) ? group() : unit"}]})),r;var n,r,i},e.prototype.assembleSelectionSignals=function(){return function(i,a){Nc(i,function(t,e){var n=t.name,r=e.modifyExpr(i,t);a.push.apply(a,e.signals(i,t)),vc(t,function(e){e.signals&&(a=e.signals(i,t,a)),e.modifyExpr&&(r=e.modifyExpr(i,t,r))}),a.push({name:n+xc,on:[{events:{signal:n+bc},update:"modify("+k(t.name+yc)+", "+r+")"}]})});var e=Oc(i);if(a.length&&e){var t=k(e.getName("cell"));a.unshift({name:"facet",value:{},on:[{events:ba("mousemove","scope"),update:"isTuple(facet) ? facet : group("+t+").datum"}]})}return a}(this,[])},e.prototype.assembleSelectionData=function(e){return n=e,Nc(this,function(t){n.filter(function(e){return e.name===t.name+yc}).length||n.push({name:t.name+yc})}),n;var n},e.prototype.assembleLayout=function(){return null},e.prototype.assembleLayoutSignals=function(){return ho(this)},e.prototype.assembleMarks=function(){var e=this.component.mark||[];return this.parent&&Vu(this.parent)||(e=Ec(this,e)),e.map(this.correctDataNames)},e.prototype.assembleLayoutSize=function(){return{width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height")}},e.prototype.getMapping=function(){return this.encoding},e.prototype.toSpec=function(e,t){var n,r=ue(this.encoding);return n={mark:this.markDef,encoding:r},e||(n.config=ue(this.config)),t||(n.data=ue(this.data)),n},Object.defineProperty(e.prototype,"mark",{get:function(){return this.markDef.type},enumerable:!0,configurable:!0}),e.prototype.channelHasField=function(e){return Rr(this.encoding,e)},e.prototype.fieldDef=function(e){return kr(this.encoding[e])},e}(Qu),Ss=function(s){function l(e,t,n,r,i,a,o){var u=s.call(this,e,t,n,a,i,e.resolve)||this;u.type="layer";var c=Ae({},r,e.width?{width:e.width}:{},e.height?{height:e.height}:{});return u.initSize(c),u.children=e.layer.map(function(e,t){if(Zi(e))return new l(e,u,u.getName("layer_"+t),c,i,a,o);if(Ji(e))return new xs(e,u,u.getName("layer_"+t),c,i,a,o);throw new Error(rn.INVALID_SPEC)}),u}return Ce(l,s),l.prototype.parseData=function(){this.component.data=Yc(this);for(var e=0,t=this.children;e<t.length;e++){t[e].parseData()}},l.prototype.parseLayoutSize=function(){Xc(this)},l.prototype.parseSelection=function(){var n=this;this.component.selection={};for(var e=function(t){t.parseSelection(),ie(t.component.selection).forEach(function(e){n.component.selection[e]=t.component.selection[e]})},t=0,r=this.children;t<r.length;t++){e(r[t])}},l.prototype.parseMarkGroup=function(){for(var e=0,t=this.children;e<t.length;e++){t[e].parseMarkGroup()}},l.prototype.parseAxisAndHeader=function(){!function(e){for(var t=e.component,n=t.axes,r=t.resolve,i={top:0,bottom:0,right:0,left:0},a=0,o=e.children;a<o.length;a++){(h=o[a]).parseAxisAndHeader();for(var u=0,c=ie(h.component.axes);u<c.length;u++){var s=c[u];r.axis[s]=yo(e.component.resolve,s),"shared"===r.axis[s]&&(n[s]=fs(n[s],h.component.axes[s]),n[s]||(r.axis[s]="independent",delete n[s]))}}for(var l=0,f=[qe,We];l<f.length;l++){s=f[l];for(var d=0,p=e.children;d<p.length;d++){var h;if((h=p[d]).component.axes[s]){if("independent"===r.axis[s]){n[s]=(n[s]||[]).concat(h.component.axes[s]);for(var m=0,g=h.component.axes[s];m<g.length;m++){var v=g[m],y=v.getWithExplicit("orient"),b=y.value,x=y.explicit;if(0<i[b]&&!x){var S=ls[b];i[b]>i[S]&&v.set("orient",S,!1)}i[b]++}}delete h.component.axes[s]}}}}(this)},l.prototype.assembleSelectionTopLevelSignals=function(e){return this.children.reduce(function(e,t){return t.assembleSelectionTopLevelSignals(e)},e)},l.prototype.assembleSelectionSignals=function(){return this.children.reduce(function(e,t){return e.concat(t.assembleSelectionSignals())},[])},l.prototype.assembleLayoutSignals=function(){return this.children.reduce(function(e,t){return e.concat(t.assembleLayoutSignals())},ho(this))},l.prototype.assembleSelectionData=function(e){return this.children.reduce(function(e,t){return t.assembleSelectionData(e)},e)},l.prototype.assembleTitle=function(){var e=s.prototype.assembleTitle.call(this);if(e)return e;for(var t=0,n=this.children;t<n.length;t++){if(e=n[t].assembleTitle())return e}},l.prototype.assembleLayout=function(){return null},l.prototype.assembleMarks=function(){return t=Z((e=this).children.map(function(e){return e.assembleMarks()})),e.children.forEach(function(e){Wu(e)&&(t=Ec(e,t))}),t;var e,t},l.prototype.assembleLegends=function(){return this.children.reduce(function(e,t){return e.concat(t.assembleLegends())},Zo(this))},l}(Xu),Es=function(o){function e(e,t,n,r,i){var a=o.call(this,e,t,n,i,r,e.resolve)||this;return a.type="repeat",e.resolve&&e.resolve.axis&&("shared"===e.resolve.axis.x||"shared"===e.resolve.axis.y)&&vn(rn.REPEAT_CANNOT_SHARE_AXIS),a.repeat=e.repeat,a.children=a._initChildren(e,a.repeat,r,i),a}return Ce(e,o),e.prototype._initChildren=function(e,t,n,r){for(var i=[],a=t.row||[n?n.row:null],o=t.column||[n?n.column:null],u=0,c=a;u<c.length;u++)for(var s=c[u],l=0,f=o;l<f.length;l++){var d=f[l],p=(s?"_"+s:"")+(d?"_"+d:""),h={row:s,column:d};i.push(ws(e.spec,this,this.getName("child"+p),void 0,h,r,!1))}return i},e.prototype.parseLayoutSize=function(){Qc(this)},e.prototype.assembleLayout=function(){return{padding:{row:10,column:10},offset:10,columns:this.repeat&&this.repeat.column?this.repeat.column.length:1,bounds:"full",align:"all"}},e}(Vc);function ws(e,t,n,r,i,a,o){if(Ki(e))return new as(e,t,n,i,a);if(Zi(e))return new Ss(e,t,n,r,i,a,o);if(Ji(e))return new xs(e,t,n,r,i,a,o);if($i(e))return new Es(e,t,n,i,a);if(ea(e))return new $c(e,t,n,i,a);throw new Error(rn.INVALID_SPEC)}var Ns=Object.freeze({}),ks={text:["text"],line:["x","y"],trail:["x","y"],area:["x","y"]},Os={bar:g(["row","column","x","y","size","color","fill","stroke","detail"]),line:g(["row","column","x","y","color","fill","stroke","color","detail"]),trail:g(["row","column","x","y","color","fill","stroke","color","detail","size"]),area:g(["row","column","x","y","color","fill","stroke","detail"]),tick:g(["row","column","x","y","color","fill","stroke","detail"]),circle:g(["row","column","x","y","color","fill","stroke","size","detail"]),square:g(["row","column","x","y","color","fill","stroke","size","detail"]),point:g(["row","column","x","y","color","fill","stroke","size","detail","shape"]),geoshape:g(["row","column","color","fill","stroke","detail","shape"]),text:g(["row","column","size","color","fill","stroke","text"])};var _s=Object.freeze({DEFAULT_REQUIRED_CHANNEL_MAP:ks,DEFAULT_SUPPORTED_CHANNEL_TYPE:Os,getEncodingMappingError:function(e,t,n){void 0===t&&(t=ks),void 0===n&&(n=Os);var r=$t(e.mark)?e.mark.type:e.mark,i=e.encoding,a=t[r],o=n[r];for(var u in a)if(!(a[u]in i))return'Missing encoding channel "'+a[u]+'" for mark "'+r+'"';for(var c in i)if(!o[c])return'Encoding channel "'+c+'" is not supported by mark type "'+r+'"';return r!==Mt||i.x||i.y?null:"Missing both x and y for bar"}});e.aggregate=_e,e.axis=He,e.bin=jt,e.channel=Dt,e.compositeMark=$r,e.config=Wi,e.data=ya,e.datetime=_n,e.encoding=Hr,e.facet=Ns,e.fieldDef=Ir,e.legend=oi,e.mark=hn,e.scale=zi,e.sort=ou,e.spec=sa,e.stack=Qi,e.timeUnit=Xn,e.transform=Ga,e.type=nr,e.util=ye,e.validate=_s,e.compile=function(e,t){var n,r,i,a,o,u;void 0===t&&(t={}),t.logger&&(n=t.logger,gn=n),t.fieldTitle&&Sr(t.fieldTitle);try{var c=ji($({},t.config,e.config)),s=ra(e,c),l=function(e,t,n){void 0===n&&(n=!0);var r=Ae({type:"pad"},la(t),la(e));return"fit"===r.type&&(n||(vn(rn.FIT_NON_SINGLE),r.type="pad")),r}(e.autosize,c.autosize,Zi(s)||Ji(s)),f=ws(s,null,"",void 0,void 0,c,"fit"===l.type);return f.parse(),o=f.component.data,(u=ae(o.sources)).forEach(Nu),ku(u=u.filter(function(e){return 0<e.numChildren()})).forEach(vu(bu)),ku(u=u.filter(function(e){return 0<e.numChildren()})).forEach(vu(yu)),ku(u).forEach(xu),u.forEach(wu),ie(o.sources).forEach(function(e){0===o.sources[e].numChildren()&&delete o.sources[e]}),function(e,t){var n=e.config?Hi(e.config):void 0,r=[].concat(e.assembleSelectionData([]),function(e,t){var n=ae(e.sources),r=[],i=es(r),a=0;n.forEach(function(e){e.hasName()||(e.dataName="source_"+a++);var t=e.assemble();i(e,t)}),r.forEach(function(e){0===e.transform.length&&delete e.transform});for(var o=0,u=0;u<r.length;u++)0!==((m=r[u]).transform||[]).length||m.source||r.splice(o++,0,r.splice(u,1)[0]);for(var c=0,s=r;c<s.length;c++)for(var l=0,f=(m=s[c]).transform||[];l<f.length;l++){var d=f[l];"lookup"===d.type&&(d.from=e.outputNodes[d.from].getSource())}for(var p=0,h=r;p<h.length;p++){var m;(m=h[p]).name in t&&(m.values=t[m.name])}return r}(e.component.data,t.datasets||{}));delete t.datasets;var i=e.assembleProjections(),a=e.assembleTitle(),o=e.assembleGroupStyle(),u=e.assembleLayoutSignals();return u=u.filter(function(e){return"width"!==e.name&&"height"!==e.name||void 0===e.value||(t[e.name]=+e.value,!1)}),{spec:Ae({$schema:"https://vega.github.io/schema/vega/v3.0.json"},e.description?{description:e.description}:{},t,a?{title:a}:{},o?{style:o}:{},{data:r},0<i.length?{projections:i}:{},e.assembleGroup(u.concat(e.assembleSelectionTopLevelSignals([]))),n?{config:n}:{})}}(f,(r=e,i=c,Ae({autosize:1===ie(a=l).length&&a.type?a.type:a},da(i),da(r))))}finally{t.logger&&(gn=mn),t.fieldTitle&&Er()}},e.version="2.4.3",Object.defineProperty(e,"__esModule",{value:!0})});
/*
chroma.js - JavaScript library for color conversions

Copyright (c) 2011-2017, Gregor Aisch
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:

1. Redistributions of source code must retain the above copyright notice, this
   list of conditions and the following disclaimer.

2. Redistributions in binary form must reproduce the above copyright notice,
   this list of conditions and the following disclaimer in the documentation
   and/or other materials provided with the distribution.

3. The name Gregor Aisch may not be used to endorse or promote products
   derived from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED. IN NO EVENT SHALL GREGOR AISCH OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

*/
(function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca=[].slice;xa=function(){var a,b,c,d,e;for(a={},e="Boolean Number String Function Array Date RegExp Undefined Null".split(" "),d=0,b=e.length;d<b;d++)c=e[d],a["[object "+c+"]"]=c.toLowerCase();return function(b){var c;return c=Object.prototype.toString.call(b),a[c]||"object"}}(),U=function(a,b,c){return null==b&&(b=0),null==c&&(c=1),a<b&&(a=b),a>c&&(a=c),a},ya=function(a){return a.length>=3?[].slice.call(a):a[0]},u=function(a){var b,c;for(a._clipped=!1,a._unclipped=a.slice(0),b=c=0;c<3;b=++c)b<3?((a[b]<0||a[b]>255)&&(a._clipped=!0),a[b]<0&&(a[b]=0),a[b]>255&&(a[b]=255)):3===b&&(a[b]<0&&(a[b]=0),a[b]>1&&(a[b]=1));return a._clipped||delete a._unclipped,a},d=Math.PI,sa=Math.round,w=Math.cos,B=Math.floor,ba=Math.pow,V=Math.log,ua=Math.sin,va=Math.sqrt,n=Math.atan2,Y=Math.max,m=Math.abs,g=2*d,e=d/3,b=d/180,f=180/d,t=function(){return arguments[0]instanceof a?arguments[0]:function(a,b,c){c.prototype=a.prototype;var d=new c,e=a.apply(d,b);return Object(e)===e?e:d}(a,arguments,function(){})},t.default=t,l=[],"undefined"!=typeof module&&null!==module&&null!=module.exports&&(module.exports=t),"function"==typeof define&&define.amd?define([],function(){return t}):(ra="undefined"!=typeof exports&&null!==exports?exports:this,ra.chroma=t),t.version="1.3.4",k={},i=[],j=!1,a=function(){function a(){var a,b,c,d,e,f,g,h,l;for(f=this,b=[],h=0,d=arguments.length;h<d;h++)null!=(a=arguments[h])&&b.push(a);if(b.length>1&&(g=b[b.length-1]),null!=k[g])f._rgb=u(k[g](ya(b.slice(0,-1))));else{for(j||(i=i.sort(function(a,b){return b.p-a.p}),j=!0),l=0,e=i.length;l<e&&(c=i[l],!(g=c.test.apply(c,b)));l++);g&&(f._rgb=u(k[g].apply(k,b)))}null==f._rgb&&console.warn("unknown format: "+b),null==f._rgb&&(f._rgb=[0,0,0]),3===f._rgb.length&&f._rgb.push(1)}return a.prototype.toString=function(){return this.hex()},a.prototype.clone=function(){return t(me._rgb)},a}(),t._input=k,t.brewer=r={OrRd:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"],PuBu:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"],BuPu:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"],Oranges:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"],BuGn:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"],YlOrBr:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"],YlGn:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"],Reds:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"],RdPu:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"],Greens:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"],YlGnBu:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"],Purples:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"],GnBu:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"],Greys:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"],YlOrRd:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"],PuRd:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"],Blues:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"],PuBuGn:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"],Viridis:["#440154","#482777","#3f4a8a","#31678e","#26838f","#1f9d8a","#6cce5a","#b6de2b","#fee825"],Spectral:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],RdYlGn:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],RdBu:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],PiYG:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],PRGn:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],RdYlBu:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],BrBG:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],RdGy:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],PuOr:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],Set2:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],Accent:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"],Set1:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"],Set3:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"],Dark2:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"],Paired:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"],Pastel2:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"],Pastel1:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]},function(){var a,b;b=[];for(a in r)b.push(r[a.toLowerCase()]=r[a])}(),za={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflower:"#6495ed",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",laserlemon:"#ffff54",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrod:"#fafad2",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",maroon2:"#7f0000",maroon3:"#b03060",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",purple2:"#7f007f",purple3:"#a020f0",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},t.colors=za,P=function(){var a,b,d,e,f,g,h,i,j;return b=ya(arguments),f=b[0],a=b[1],d=b[2],i=(f+16)/116,h=isNaN(a)?i:i+a/500,j=isNaN(d)?i:i-d/200,i=c.Yn*Q(i),h=c.Xn*Q(h),j=c.Zn*Q(j),g=Ba(3.2404542*h-1.5371385*i-.4985314*j),e=Ba(-.969266*h+1.8760108*i+.041556*j),d=Ba(.0556434*h-.2040259*i+1.0572252*j),[g,e,d,b.length>3?b[3]:1]},Ba=function(a){return 255*(a<=.00304?12.92*a:1.055*ba(a,1/2.4)-.055)},Q=function(a){return a>c.t1?a*a*a:c.t2*(a-c.t0)},c={Kn:18,Xn:.95047,Yn:1,Zn:1.08883,t0:.137931034,t1:.206896552,t2:.12841855,t3:.008856452},ja=function(){var a,b,c,d,e,f,g,h;return d=ya(arguments),c=d[0],b=d[1],a=d[2],e=oa(c,b,a),f=e[0],g=e[1],h=e[2],[116*g-16,500*(f-g),200*(g-h)]},pa=function(a){return(a/=255)<=.04045?a/12.92:ba((a+.055)/1.055,2.4)},Aa=function(a){return a>c.t3?ba(a,1/3):a/c.t2+c.t0},oa=function(){var a,b,d,e,f,g,h;return e=ya(arguments),d=e[0],b=e[1],a=e[2],d=pa(d),b=pa(b),a=pa(a),f=Aa((.4124564*d+.3575761*b+.1804375*a)/c.Xn),g=Aa((.2126729*d+.7151522*b+.072175*a)/c.Yn),h=Aa((.0193339*d+.119192*b+.9503041*a)/c.Zn),[f,g,h]},t.lab=function(){return function(a,b,c){c.prototype=a.prototype;var d=new c,e=a.apply(d,b);return Object(e)===e?e:d}(a,Ca.call(arguments).concat(["lab"]),function(){})},k.lab=P,a.prototype.lab=function(){return ja(this._rgb)},o=function(a){var b,c,d,e,f,g,h,i,j,k,l;return a=function(){var b,c,d;for(d=[],c=0,b=a.length;c<b;c++)e=a[c],d.push(t(e));return d}(),2===a.length?(j=function(){var b,c,d;for(d=[],c=0,b=a.length;c<b;c++)e=a[c],d.push(e.lab());return d}(),f=j[0],g=j[1],b=function(a){var b,c;return c=function(){var c,d;for(d=[],b=c=0;c<=2;b=++c)d.push(f[b]+a*(g[b]-f[b]));return d}(),t.lab.apply(t,c)}):3===a.length?(k=function(){var b,c,d;for(d=[],c=0,b=a.length;c<b;c++)e=a[c],d.push(e.lab());return d}(),f=k[0],g=k[1],h=k[2],b=function(a){var b,c;return c=function(){var c,d;for(d=[],b=c=0;c<=2;b=++c)d.push((1-a)*(1-a)*f[b]+2*(1-a)*a*g[b]+a*a*h[b]);return d}(),t.lab.apply(t,c)}):4===a.length?(l=function(){var b,c,d;for(d=[],c=0,b=a.length;c<b;c++)e=a[c],d.push(e.lab());return d}(),f=l[0],g=l[1],h=l[2],i=l[3],b=function(a){var b,c;return c=function(){var c,d;for(d=[],b=c=0;c<=2;b=++c)d.push((1-a)*(1-a)*(1-a)*f[b]+3*(1-a)*(1-a)*a*g[b]+3*(1-a)*a*a*h[b]+a*a*a*i[b]);return d}(),t.lab.apply(t,c)}):5===a.length&&(c=o(a.slice(0,3)),d=o(a.slice(2,5)),b=function(a){return a<.5?c(2*a):d(2*(a-.5))}),b},t.bezier=function(a){var b;return b=o(a),b.scale=function(){return t.scale(b)},b},t.cubehelix=function(a,b,c,d,e){var f,h,i;return null==a&&(a=300),null==b&&(b=-1.5),null==c&&(c=1),null==d&&(d=1),null==e&&(e=[0,1]),f=0,"array"===xa(e)?h=e[1]-e[0]:(h=0,e=[e,e]),i=function(i){var j,k,l,m,n,o,p,q,r;return j=g*((a+120)/360+b*i),p=ba(e[0]+h*i,d),o=0!==f?c[0]+i*f:c,k=o*p*(1-p)/2,m=w(j),r=ua(j),q=p+k*(-.14861*m+1.78277*r),n=p+k*(-.29227*m-.90649*r),l=p+k*(1.97294*m),t(u([255*q,255*n,255*l]))},i.start=function(b){return null==b?a:(a=b,i)},i.rotations=function(a){return null==a?b:(b=a,i)},i.gamma=function(a){return null==a?d:(d=a,i)},i.hue=function(a){return null==a?c:(c=a,"array"===xa(c)?0===(f=c[1]-c[0])&&(c=c[1]):f=0,i)},i.lightness=function(a){return null==a?e:("array"===xa(a)?(e=a,h=a[1]-a[0]):(e=[a,a],h=0),i)},i.scale=function(){return t.scale(i)},i.hue(c),i},t.random=function(){var b,c,d;for(c="0123456789abcdef",b="#",d=0;d<6;++d)b+=c.charAt(B(16*Math.random()));return new a(b)},l=[],I=function(a,b,c,d){var e,f,g,h;for(null==c&&(c=.5),null==d&&(d="rgb"),"object"!==xa(a)&&(a=t(a)),"object"!==xa(b)&&(b=t(b)),g=0,f=l.length;g<f;g++)if(e=l[g],d===e[0]){h=e[1](a,b,c,d);break}if(null==h)throw"color mode "+d+" is not supported";return h.alpha(a.alpha()+c*(b.alpha()-a.alpha()))},t.interpolate=I,a.prototype.interpolate=function(a,b,c){return I(this,a,b,c)},t.mix=I,a.prototype.mix=a.prototype.interpolate,k.rgb=function(){var a,b,c,d;b=ya(arguments),c=[];for(a in b)d=b[a],c.push(d);return c},t.rgb=function(){return function(a,b,c){c.prototype=a.prototype;var d=new c,e=a.apply(d,b);return Object(e)===e?e:d}(a,Ca.call(arguments).concat(["rgb"]),function(){})},a.prototype.rgb=function(a){return null==a&&(a=!0),a?this._rgb.map(Math.round).slice(0,3):this._rgb.slice(0,3)},a.prototype.rgba=function(a){return null==a&&(a=!0),a?[Math.round(this._rgb[0]),Math.round(this._rgb[1]),Math.round(this._rgb[2]),this._rgb[3]]:this._rgb.slice(0)},i.push({p:3,test:function(a){var b;return b=ya(arguments),"array"===xa(b)&&3===b.length?"rgb":4===b.length&&"number"===xa(b[3])&&b[3]>=0&&b[3]<=1?"rgb":void 0}}),k.lrgb=k.rgb,L=function(b,c,d,e){var f,g;return f=b._rgb,g=c._rgb,new a(va(ba(f[0],2)*(1-d)+ba(g[0],2)*d),va(ba(f[1],2)*(1-d)+ba(g[1],2)*d),va(ba(f[2],2)*(1-d)+ba(g[2],2)*d),e)},h=function(b){var c,d,e,f,g,h;for(d=1/b.length,h=[0,0,0,0],f=0,e=b.length;f<e;f++)c=b[f],g=c._rgb,h[0]+=ba(g[0],2)*d,h[1]+=ba(g[1],2)*d,h[2]+=ba(g[2],2)*d,h[3]+=g[3]*d;return h[0]=va(h[0]),h[1]=va(h[1]),h[2]=va(h[2]),new a(h)},l.push(["lrgb",L]),t.average=function(a,b){var c,e,f,g,i,j,k,l,m,o,p,q,r;if(null==b&&(b="rgb"),m=a.length,a=a.map(function(a){return t(a)}),k=a.splice(0,1)[0],"lrgb"===b)return h(a);q=k.get(b),g=[],i=0,j=0;for(l in q)q[l]=q[l]||0,g.push(isNaN(q[l])?0:1),"h"!==b.charAt(l)||isNaN(q[l])||(c=q[l]/180*d,i+=w(c),j+=ua(c));for(e=k.alpha(),p=0,o=a.length;p<o;p++){f=a[p],r=f.get(b),e+=f.alpha();for(l in q)isNaN(r[l])||(q[l]+=r[l],g[l]+=1,"h"===b.charAt(l)&&(c=q[l]/180*d,i+=w(c),j+=ua(c)))}for(l in q)if(q[l]=q[l]/g[l],"h"===b.charAt(l)){for(c=n(j/g[l],i/g[l])/d*180;c<0;)c+=360;for(;c>=360;)c-=360;q[l]=c}return t(q,b).alpha(e/m)},D=function(a){var b,c,d,e,f,g;if(a.match(/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/))return 4!==a.length&&7!==a.length||(a=a.substr(1)),3===a.length&&(a=a.split(""),a=a[0]+a[0]+a[1]+a[1]+a[2]+a[2]),g=parseInt(a,16),e=g>>16,d=g>>8&255,c=255&g,[e,d,c,1];if(a.match(/^#?([A-Fa-f0-9]{8})$/))return 9===a.length&&(a=a.substr(1)),g=parseInt(a,16),e=g>>24&255,d=g>>16&255,c=g>>8&255,b=sa((255&g)/255*100)/100,[e,d,c,b];if(null!=k.css&&(f=k.css(a)))return f;throw"unknown color: "+a},fa=function(a,b){var c,d,e,f,g,h,i;return null==b&&(b="rgb"),g=a[0],e=a[1],d=a[2],c=a[3],g=Math.round(g),e=Math.round(e),d=Math.round(d),i=g<<16|e<<8|d,h="000000"+i.toString(16),h=h.substr(h.length-6),f="0"+sa(255*c).toString(16),f=f.substr(f.length-2),"#"+function(){switch(b.toLowerCase()){case"rgba":return h+f;case"argb":return f+h;default:return h}}()},k.hex=function(a){return D(a)},t.hex=function(){return function(a,b,c){c.prototype=a.prototype;var d=new c,e=a.apply(d,b);return Object(e)===e?e:d}(a,Ca.call(arguments).concat(["hex"]),function(){})},a.prototype.hex=function(a){return null==a&&(a="rgb"),fa(this._rgb,a)},i.push({p:4,test:function(a){if(1===arguments.length&&"string"===xa(a))return"hex"}}),G=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n;if(a=ya(arguments),e=a[0],k=a[1],g=a[2],0===k)i=d=b=255*g;else{for(n=[0,0,0],c=[0,0,0],m=g<.5?g*(1+k):g+k-g*k,l=2*g-m,e/=360,n[0]=e+1/3,n[1]=e,n[2]=e-1/3,f=h=0;h<=2;f=++h)n[f]<0&&(n[f]+=1),n[f]>1&&(n[f]-=1),6*n[f]<1?c[f]=l+6*(m-l)*n[f]:2*n[f]<1?c[f]=m:3*n[f]<2?c[f]=l+(m-l)*(2/3-n[f])*6:c[f]=l;j=[sa(255*c[0]),sa(255*c[1]),sa(255*c[2])],i=j[0],d=j[1],b=j[2]}return a.length>3?[i,d,b,a[3]]:[i,d,b]},ha=function(a,b,c){var d,e,f,g,h;return void 0!==a&&a.length>=3&&(g=a,a=g[0],b=g[1],c=g[2]),a/=255,b/=255,c/=255,f=Math.min(a,b,c),Y=Math.max(a,b,c),e=(Y+f)/2,Y===f?(h=0,d=Number.NaN):h=e<.5?(Y-f)/(Y+f):(Y-f)/(2-Y-f),a===Y?d=(b-c)/(Y-f):b===Y?d=2+(c-a)/(Y-f):c===Y&&(d=4+(a-b)/(Y-f)),d*=60,d<0&&(d+=360),[d,h,e]},t.hsl=function(){return function(a,b,c){c.prototype=a.prototype;var d=new c,e=a.apply(d,b);return Object(e)===e?e:d}(a,Ca.call(arguments).concat(["hsl"]),function(){})},k.hsl=G,a.prototype.hsl=function(){return ha(this._rgb)},H=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r;if(a=ya(arguments),e=a[0],p=a[1],r=a[2],r*=255,0===p)i=d=b=r;else switch(360===e&&(e=0),e>360&&(e-=360),e<0&&(e+=360),e/=60,f=B(e),c=e-f,g=r*(1-p),h=r*(1-p*c),q=r*(1-p*(1-c)),f){case 0:j=[r,q,g],i=j[0],d=j[1],b=j[2];break;case 1:k=[h,r,g],i=k[0],d=k[1],b=k[2];break;case 2:l=[g,r,q],i=l[0],d=l[1],b=l[2];break;case 3:m=[g,h,r],i=m[0],d=m[1],b=m[2];break;case 4:n=[q,g,r],i=n[0],d=n[1],b=n[2];break;case 5:o=[r,g,h],i=o[0],d=o[1],b=o[2]}return[i,d,b,a.length>3?a[3]:1]},ia=function(){var a,b,c,d,e,f,g,h,i;return g=ya(arguments),f=g[0],c=g[1],a=g[2],e=Math.min(f,c,a),Y=Math.max(f,c,a),b=Y-e,i=Y/255,0===Y?(d=Number.NaN,h=0):(h=b/Y,f===Y&&(d=(c-a)/b),c===Y&&(d=2+(a-f)/b),a===Y&&(d=4+(f-c)/b),(d*=60)<0&&(d+=360)),[d,h,i]},t.hsv=function(){return function(a,b,c){c.prototype=a.prototype;var d=new c,e=a.apply(d,b);return Object(e)===e?e:d}(a,Ca.call(arguments).concat(["hsv"]),function(){})},k.hsv=H,a.prototype.hsv=function(){return ia(this._rgb)},_=function(a){var b,c,d;return"number"===xa(a)&&a>=0&&a<=16777215?(d=a>>16,c=a>>8&255,b=255&a,[d,c,b,1]):(console.warn("unknown num color: "+a),[0,0,0,1])},ma=function(){var a,b,c,d;return d=ya(arguments),c=d[0],b=d[1],a=d[2],(c<<16)+(b<<8)+a},t.num=function(b){return new a(b,"num")},a.prototype.num=function(a){return null==a&&(a="rgb"),ma(this._rgb,a)},k.num=_,i.push({p:1,test:function(a){if(1===arguments.length&&"number"===xa(a)&&a>=0&&a<=16777215)return"num"}}),C=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t;if(c=ya(arguments),h=c[0],e=c[1],b=c[2],e/=100,g=g/100*255,a=255*e,0===e)l=g=d=b;else switch(360===h&&(h=0),h>360&&(h-=360),h<0&&(h+=360),h/=60,i=B(h),f=h-i,j=b*(1-e),k=j+a*(1-f),s=j+a*f,t=j+a,i){case 0:m=[t,s,j],l=m[0],g=m[1],d=m[2];break;case 1:n=[k,t,j],l=n[0],g=n[1],d=n[2];break;case 2:o=[j,t,s],l=o[0],g=o[1],d=o[2];break;case 3:p=[j,k,t],l=p[0],g=p[1],d=p[2];break;case 4:q=[s,j,t],l=q[0],g=q[1],d=q[2];break;case 5:r=[t,j,k],l=r[0],g=r[1],d=r[2]}return[l,g,d,c.length>3?c[3]:1]},ea=function(){var a,b,c,d,e,f,g,h,i;return i=ya(arguments),h=i[0],e=i[1],b=i[2],g=Math.min(h,e,b),Y=Math.max(h,e,b),d=Y-g,c=100*d/255,a=g/(255-d)*100,0===d?f=Number.NaN:(h===Y&&(f=(e-b)/d),e===Y&&(f=2+(b-h)/d),b===Y&&(f=4+(h-e)/d),(f*=60)<0&&(f+=360)),[f,c,a]},t.hcg=function(){return function(a,b,c){c.prototype=a.prototype;var d=new c,e=a.apply(d,b);return Object(e)===e?e:d}(a,Ca.call(arguments).concat(["hcg"]),function(){})},k.hcg=C,a.prototype.hcg=function(){return ea(this._rgb)},x=function(a){var b,c,d,e,f,g,h,i;if(a=a.toLowerCase(),null!=t.colors&&t.colors[a])return D(t.colors[a]);if(f=a.match(/rgb\(\s*(\-?\d+),\s*(\-?\d+)\s*,\s*(\-?\d+)\s*\)/)){for(h=f.slice(1,4),e=g=0;g<=2;e=++g)h[e]=+h[e];h[3]=1}else if(f=a.match(/rgba\(\s*(\-?\d+),\s*(\-?\d+)\s*,\s*(\-?\d+)\s*,\s*([01]|[01]?\.\d+)\)/))for(h=f.slice(1,5),e=i=0;i<=3;e=++i)h[e]=+h[e];else if(f=a.match(/rgb\(\s*(\-?\d+(?:\.\d+)?)%,\s*(\-?\d+(?:\.\d+)?)%\s*,\s*(\-?\d+(?:\.\d+)?)%\s*\)/)){for(h=f.slice(1,4),e=b=0;b<=2;e=++b)h[e]=sa(2.55*h[e]);h[3]=1}else if(f=a.match(/rgba\(\s*(\-?\d+(?:\.\d+)?)%,\s*(\-?\d+(?:\.\d+)?)%\s*,\s*(\-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)/)){for(h=f.slice(1,5),e=c=0;c<=2;e=++c)h[e]=sa(2.55*h[e]);h[3]=+h[3]}else(f=a.match(/hsl\(\s*(\-?\d+(?:\.\d+)?),\s*(\-?\d+(?:\.\d+)?)%\s*,\s*(\-?\d+(?:\.\d+)?)%\s*\)/))?(d=f.slice(1,4),d[1]*=.01,d[2]*=.01,h=G(d),h[3]=1):(f=a.match(/hsla\(\s*(\-?\d+(?:\.\d+)?),\s*(\-?\d+(?:\.\d+)?)%\s*,\s*(\-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)/))&&(d=f.slice(1,4),d[1]*=.01,d[2]*=.01,h=G(d),h[3]=+f[4]);return h},da=function(a){var b;return b=a[3]<1?"rgba":"rgb","rgb"===b?b+"("+a.slice(0,3).map(sa).join(",")+")":"rgba"===b?b+"("+a.slice(0,3).map(sa).join(",")+","+a[3]+")":void 0},qa=function(a){return sa(100*a)/100},F=function(a,b){var c;return c=b<1?"hsla":"hsl",a[0]=qa(a[0]||0),a[1]=qa(100*a[1])+"%",a[2]=qa(100*a[2])+"%","hsla"===c&&(a[3]=b),c+"("+a.join(",")+")"},k.css=function(a){return x(a)},t.css=function(){return function(a,b,c){c.prototype=a.prototype;var d=new c,e=a.apply(d,b);return Object(e)===e?e:d}(a,Ca.call(arguments).concat(["css"]),function(){})},a.prototype.css=function(a){return null==a&&(a="rgb"),"rgb"===a.slice(0,3)?da(this._rgb):"hsl"===a.slice(0,3)?F(this.hsl(),this.alpha()):void 0},k.named=function(a){return D(za[a])},i.push({p:5,test:function(a){if(1===arguments.length&&null!=za[a])return"named"}}),a.prototype.name=function(a){var b,c;arguments.length&&(za[a]&&(this._rgb=D(za[a])),this._rgb[3]=1),b=this.hex();for(c in za)if(b===za[c])return c;return b},R=function(){var a,c,d,e;return e=ya(arguments),d=e[0],a=e[1],c=e[2],c*=b,[d,w(c)*a,ua(c)*a]},S=function(){var a,b,c,d,e,f,g,h,i,j,k;return c=ya(arguments),h=c[0],e=c[1],g=c[2],j=R(h,e,g),a=j[0],b=j[1],d=j[2],k=P(a,b,d),i=k[0],f=k[1],d=k[2],[i,f,d,c.length>3?c[3]:1]},O=function(){var a,b,c,d,e,g;return g=ya(arguments),e=g[0],a=g[1],b=g[2],c=va(a*a+b*b),d=(n(b,a)*f+360)%360,0===sa(1e4*c)&&(d=Number.NaN),[e,c,d]},ka=function(){var a,b,c,d,e,f,g;return f=ya(arguments),e=f[0],c=f[1],b=f[2],g=ja(e,c,b),d=g[0],a=g[1],b=g[2],O(d,a,b)},t.lch=function(){var b;return b=ya(arguments),new a(b,"lch")},t.hcl=function(){var b;return b=ya(arguments),new a(b,"hcl")},k.lch=S,k.hcl=function(){var a,b,c,d;return d=ya(arguments),b=d[0],a=d[1],c=d[2],S([c,a,b])},a.prototype.lch=function(){return ka(this._rgb)},a.prototype.hcl=function(){return ka(this._rgb).reverse()},ca=function(a){var b,c,d,e,f,g,h,i,j;return null==a&&(a="rgb"),i=ya(arguments),h=i[0],e=i[1],b=i[2],h/=255,e/=255,b/=255,f=1-Math.max(h,Math.max(e,b)),d=f<1?1/(1-f):0,c=(1-h-f)*d,g=(1-e-f)*d,j=(1-b-f)*d,[c,g,j,f]},v=function(){var a,b,c,d,e,f,g,h,i;return b=ya(arguments),d=b[0],g=b[1],i=b[2],f=b[3],a=b.length>4?b[4]:1,1===f?[0,0,0,a]:(h=d>=1?0:255*(1-d)*(1-f),e=g>=1?0:255*(1-g)*(1-f),c=i>=1?0:255*(1-i)*(1-f),[h,e,c,a])},k.cmyk=function(){return v(ya(arguments))},t.cmyk=function(){return function(a,b,c){c.prototype=a.prototype;var d=new c,e=a.apply(d,b);return Object(e)===e?e:d}(a,Ca.call(arguments).concat(["cmyk"]),function(){})},a.prototype.cmyk=function(){return ca(this._rgb)},k.gl=function(){var a,b,c,d,e;for(d=function(){var a,c;a=ya(arguments),c=[];for(b in a)e=a[b],c.push(e);return c}.apply(this,arguments),a=c=0;c<=2;a=++c)d[a]*=255;return d},t.gl=function(){return function(a,b,c){c.prototype=a.prototype;var d=new c,e=a.apply(d,b);return Object(e)===e?e:d}(a,Ca.call(arguments).concat(["gl"]),function(){})},a.prototype.gl=function(){var a;return a=this._rgb,[a[0]/255,a[1]/255,a[2]/255,a[3]]},la=function(a,b,c){var d;return d=ya(arguments),a=d[0],b=d[1],c=d[2],a=W(a),b=W(b),c=W(c),.2126*a+.7152*b+.0722*c},W=function(a){return a/=255,a<=.03928?a/12.92:ba((a+.055)/1.055,2.4)},N=function(b,c,d,e){var f,g;return f=b._rgb,g=c._rgb,new a(f[0]+d*(g[0]-f[0]),f[1]+d*(g[1]-f[1]),f[2]+d*(g[2]-f[2]),e)},l.push(["rgb",N]),a.prototype.luminance=function(a,b){var c,d,e,f;return null==b&&(b="rgb"),arguments.length?(0===a?this._rgb=[0,0,0,this._rgb[3]]:1===a?this._rgb=[255,255,255,this._rgb[3]]:(d=1e-7,e=20,f=function(c,g){var h,i;return i=c.interpolate(g,.5,b),h=i.luminance(),Math.abs(a-h)<d||!e--?i:h>a?f(c,i):f(i,g)},c=la(this._rgb),this._rgb=(c>a?f(t("black"),this):f(this,t("white"))).rgba()),this):la(this._rgb)},wa=function(a){var b,c,d,e;return e=a/100,e<66?(d=255,c=-155.25485562709179-.44596950469579133*(c=e-2)+104.49216199393888*V(c),b=e<20?0:.8274096064007395*(b=e-10)-254.76935184120902+115.67994401066147*V(b)):(d=351.97690566805693+.114206453784165*(d=e-55)-40.25366309332127*V(d),c=325.4494125711974+.07943456536662342*(c=e-50)-28.0852963507957*V(c),b=255),[d,c,b]},na=function(){var a,b,c,d,e,f,g,h;for(f=ya(arguments),e=f[0],f[1],a=f[2],d=1e3,c=4e4,b=.4;c-d>b;)h=.5*(c+d),g=wa(h),g[2]/g[0]>=a/e?c=h:d=h;return sa(h)},t.temperature=t.kelvin=function(){return function(a,b,c){c.prototype=a.prototype;var d=new c,e=a.apply(d,b);return Object(e)===e?e:d}(a,Ca.call(arguments).concat(["temperature"]),function(){})},k.temperature=k.kelvin=k.K=wa,a.prototype.temperature=function(){return na(this._rgb)},a.prototype.kelvin=a.prototype.temperature,t.contrast=function(b,c){var d,e,f,g;return"string"!==(f=xa(b))&&"number"!==f||(b=new a(b)),"string"!==(g=xa(c))&&"number"!==g||(c=new a(c)),d=b.luminance(),e=c.luminance(),d>e?(d+.05)/(e+.05):(e+.05)/(d+.05)},t.distance=function(b,c,d){var e,f,g,h,i,j,k;null==d&&(d="lab"),"string"!==(i=xa(b))&&"number"!==i||(b=new a(b)),"string"!==(j=xa(c))&&"number"!==j||(c=new a(c)),g=b.get(d),h=c.get(d),k=0;for(f in g)e=(g[f]||0)-(h[f]||0),k+=e*e;return Math.sqrt(k)},t.deltaE=function(b,c,e,f){var g,h,i,j,k,l,o,p,q,r,s,t,u,v,x,y,z,A,B,C,D,E,F,G,H,I,J;for(null==e&&(e=1),null==f&&(f=1),"string"!==(z=xa(b))&&"number"!==z||(b=new a(b)),"string"!==(A=xa(c))&&"number"!==A||(c=new a(c)),B=b.lab(),g=B[0],i=B[1],k=B[2],C=c.lab(),h=C[0],j=C[1],l=C[2],o=va(i*i+k*k),p=va(j*j+l*l),F=g<16?.511:.040975*g/(1+.01765*g),D=.0638*o/(1+.0131*o)+.638,y=o<1e-6?0:180*n(k,i)/d;y<0;)y+=360;for(;y>=360;)y-=360;return G=y>=164&&y<=345?.56+m(.2*w(d*(y+168)/180)):.36+m(.4*w(d*(y+35)/180)),q=o*o*o*o,x=va(q/(q+1900)),E=D*(x*G+1-x),v=g-h,u=o-p,s=i-j,t=k-l,r=s*s+t*t-u*u,H=v/(e*F),I=u/(f*D),J=E,va(H*H+I*I+r/(J*J))},a.prototype.get=function(a){var b,c,d,e,f,g;return d=this,f=a.split("."),e=f[0],b=f[1],g=d[e](),b?(c=e.indexOf(b),c>-1?g[c]:console.warn("unknown channel "+b+" in mode "+e)):g},a.prototype.set=function(a,b){var c,d,e,f,g,h;if(e=this,g=a.split("."),f=g[0],c=g[1],c)if(h=e[f](),(d=f.indexOf(c))>-1)if("string"===xa(b))switch(b.charAt(0)){case"+":case"-":h[d]+=+b;break;case"*":h[d]*=+b.substr(1);break;case"/":h[d]/=+b.substr(1);break;default:h[d]=+b}else h[d]=b;else console.warn("unknown channel "+c+" in mode "+f);else h=b;return t(h,f).alpha(e.alpha())},a.prototype.clipped=function(){return this._rgb._clipped||!1},a.prototype.alpha=function(a){return arguments.length?t.rgb([this._rgb[0],this._rgb[1],this._rgb[2],a]):this._rgb[3]},a.prototype.darken=function(a){var b,d;return null==a&&(a=1),d=this,b=d.lab(),b[0]-=c.Kn*a,t.lab(b).alpha(d.alpha())},a.prototype.brighten=function(a){return null==a&&(a=1),this.darken(-a)},a.prototype.darker=a.prototype.darken,a.prototype.brighter=a.prototype.brighten,a.prototype.saturate=function(a){var b,d;return null==a&&(a=1),d=this,b=d.lch(),b[1]+=a*c.Kn,b[1]<0&&(b[1]=0),t.lch(b).alpha(d.alpha())},a.prototype.desaturate=function(a){return null==a&&(a=1),this.saturate(-a)},a.prototype.premultiply=function(){var a,b;return b=this.rgb(),a=this.alpha(),t(b[0]*a,b[1]*a,b[2]*a,a)},p=function(a,b,c){if(!p[c])throw"unknown blend mode "+c;return p[c](a,b)},q=function(a){return function(b,c){var d,e;return d=t(c).rgb(),e=t(b).rgb(),t(a(d,e),"rgb")}},A=function(a){return function(b,c){var d,e,f;for(f=[],d=e=0;e<=3;d=++e)f[d]=a(b[d],c[d]);return f}},$=function(a,b){return a},Z=function(a,b){return a*b/255},y=function(a,b){return a>b?b:a},T=function(a,b){return a>b?a:b},ta=function(a,b){return 255*(1-(1-a/255)*(1-b/255))},aa=function(a,b){return b<128?2*a*b/255:255*(1-2*(1-a/255)*(1-b/255))},s=function(a,b){return 255*(1-(1-b/255)/(a/255))},z=function(a,b){return 255===a?255:(a=b/255*255/(1-a/255),a>255?255:a)},p.normal=q(A($)),p.multiply=q(A(Z)),p.screen=q(A(ta)),p.overlay=q(A(aa)),p.darken=q(A(y)),p.lighten=q(A(T)),p.dodge=q(A(z)),p.burn=q(A(s)),t.blend=p,t.analyze=function(a){var b,c,d,e;for(d={min:Number.MAX_VALUE,max:-1*Number.MAX_VALUE,sum:0,values:[],count:0},c=0,b=a.length;c<b;c++)null==(e=a[c])||isNaN(e)||(d.values.push(e),d.sum+=e,e<d.min&&(d.min=e),e>d.max&&(d.max=e),d.count+=1);return d.domain=[d.min,d.max],d.limits=function(a,b){return t.limits(d,a,b)},d},t.scale=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,u,v,w;return j="rgb",k=t("#ccc"),o=0,!1,g=[0,1],n=[],m=[0,0],c=!1,e=[],l=!1,i=0,h=1,f=!1,d={},p=!0,v=function(a){var b,c,d,f,g,h;if(null==a&&(a=["#fff","#000"]),null!=a&&"string"===xa(a)&&null!=t.brewer&&(a=t.brewer[a]||t.brewer[a.toLowerCase()]||a),"array"===xa(a)){for(a=a.slice(0),b=d=0,f=a.length-1;0<=f?d<=f:d>=f;b=0<=f?++d:--d)c=a[b],"string"===xa(c)&&(a[b]=t(c));for(n.length=0,b=h=0,g=a.length-1;0<=g?h<=g:h>=g;b=0<=g?++h:--h)n.push(b/(a.length-1))}return u(),e=a},r=function(a){var b,d;if(null!=c){for(d=c.length-1,b=0;b<d&&a>=c[b];)b++;return b-1}return 0},w=function(a){return a},function(a){var b,d,e,f,g;return g=a,c.length>2&&(f=c.length-1,b=r(a),e=c[0]+(c[1]-c[0])*(0+.5*o),d=c[f-1]+(c[f]-c[f-1])*(1-.5*o),g=i+(c[b]+.5*(c[b+1]-c[b])-e)/(d-e)*(h-i)),g},s=function(a,b){var f,g,l,o,q,s,u,v;if(null==b&&(b=!1),isNaN(a))return k;if(b?v=a:c&&c.length>2?(f=r(a),v=f/(c.length-2),v=m[0]+v*(1-m[0]-m[1])):h!==i?(v=(a-i)/(h-i),v=m[0]+v*(1-m[0]-m[1]),v=Math.min(1,Math.max(0,v))):v=1,b||(v=w(v)),o=Math.floor(1e4*v),p&&d[o])g=d[o];else{if("array"===xa(e))for(l=q=0,u=n.length-1;0<=u?q<=u:q>=u;l=0<=u?++q:--q){if(s=n[l],v<=s){g=e[l];break}if(v>=s&&l===n.length-1){g=e[l];break}if(v>s&&v<n[l+1]){v=(v-s)/(n[l+1]-s),g=t.interpolate(e[l],e[l+1],v,j);break}}else"function"===xa(e)&&(g=e(v));p&&(d[o]=g)}return g},u=function(){return d={}},v(a),q=function(a){var b;return b=t(s(a)),l&&b[l]?b[l]():b},q.classes=function(a){var b;return null!=a?("array"===xa(a)?(c=a,g=[a[0],a[a.length-1]]):(b=t.analyze(g),c=0===a?[b.min,b.max]:t.limits(b,"e",a)),q):c},q.domain=function(a){var b,c,d,f,j,k,l;if(!arguments.length)return g;if(i=a[0],h=a[a.length-1],n=[],d=e.length,a.length===d&&i!==h)for(j=0,f=a.length;j<f;j++)c=a[j],n.push((c-i)/(h-i));else for(b=l=0,k=d-1;0<=k?l<=k:l>=k;b=0<=k?++l:--l)n.push(b/(d-1));return g=[i,h],q},q.mode=function(a){return arguments.length?(j=a,u(),q):j},q.range=function(a,b){return v(a,b),q},q.out=function(a){return l=a,q},q.spread=function(a){return arguments.length?(o=a,q):o},q.correctLightness=function(a){return null==a&&(a=!0),f=a,u(),w=f?function(a){var b,c,d,e,f,g,h,i,j;for(b=s(0,!0).lab()[0],c=s(1,!0).lab()[0],h=b>c,d=s(a,!0).lab()[0],f=b+(c-b)*a,e=d-f,i=0,j=1,g=20;Math.abs(e)>.01&&g-- >0;)!function(){h&&(e*=-1),e<0?(i=a,a+=.5*(j-a)):(j=a,a+=.5*(i-a)),d=s(a,!0).lab()[0],e=d-f}();return a}:function(a){return a},q},q.padding=function(a){return null!=a?("number"===xa(a)&&(a=[a,a]),m=a,q):m},q.colors=function(b,d){var f,h,i,j,k,l,m,n;if(arguments.length<2&&(d="hex"),k=[],0===arguments.length)k=e.slice(0);else if(1===b)k=[q(.5)];else if(b>1)h=g[0],f=g[1]-h,k=function(){l=[];for(var a=0;0<=b?a<b:a>b;0<=b?a++:a--)l.push(a);return l}.apply(this).map(function(a){return q(h+a/(b-1)*f)});else{if(a=[],m=[],c&&c.length>2)for(i=n=1,j=c.length;1<=j?n<j:n>j;i=1<=j?++n:--n)m.push(.5*(c[i-1]+c[i]));else m=g;k=m.map(function(a){return q(a)})}return t[d]&&(k=k.map(function(a){return a[d]()})),k},q.cache=function(a){return null!=a?p=a:p},q},null==t.scales&&(t.scales={}),t.scales.cool=function(){return t.scale([t.hsl(180,1,.9),t.hsl(250,.7,.4)])},t.scales.hot=function(){return t.scale(["#000","#f00","#ff0","#fff"],[0,.25,.75,1]).mode("rgb")},t.analyze=function(a,b,c){var d,e,f,g,h,i,j;if(h={min:Number.MAX_VALUE,max:-1*Number.MAX_VALUE,sum:0,values:[],count:0},null==c&&(c=function(){return!0}),d=function(a){null==a||isNaN(a)||(h.values.push(a),h.sum+=a,a<h.min&&(h.min=a),a>h.max&&(h.max=a),h.count+=1)},j=function(a,e){if(c(a,e))return d(null!=b&&"function"===xa(b)?b(a):null!=b&&"string"===xa(b)||"number"===xa(b)?a[b]:a)},"array"===xa(a))for(g=0,f=a.length;g<f;g++)i=a[g],j(i);else for(e in a)i=a[e],j(i,e);return h.domain=[h.min,h.max],
h.limits=function(a,b){return t.limits(h,a,b)},h},t.limits=function(a,b,c){var d,e,f,g,h,i,j,k,l,n,o,p,q,r,s,u,v,w,x,y,z,A,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,W,X,Z,$,_,aa,ca,da,ea,fa,ga,ha,ia,ja;if(null==b&&(b="equal"),null==c&&(c=7),"array"===xa(a)&&(a=t.analyze(a)),E=a.min,Y=a.max,a.sum,ia=a.values.sort(function(a,b){return a-b}),1===c)return[E,Y];if(C=[],"c"===b.substr(0,1)&&(C.push(E),C.push(Y)),"e"===b.substr(0,1)){for(C.push(E),y=K=1,O=c-1;1<=O?K<=O:K>=O;y=1<=O?++K:--K)C.push(E+y/c*(Y-E));C.push(Y)}else if("l"===b.substr(0,1)){if(E<=0)throw"Logarithmic scales are only possible for values > 0";for(F=Math.LOG10E*V(E),D=Math.LOG10E*V(Y),C.push(E),y=ja=1,P=c-1;1<=P?ja<=P:ja>=P;y=1<=P?++ja:--ja)C.push(ba(10,F+y/c*(D-F)));C.push(Y)}else if("q"===b.substr(0,1)){for(C.push(E),y=d=1,W=c-1;1<=W?d<=W:d>=W;y=1<=W?++d:--d)L=(ia.length-1)*y/c,M=B(L),M===L?C.push(ia[M]):(N=L-M,C.push(ia[M]*(1-N)+ia[M+1]*N));C.push(Y)}else if("k"===b.substr(0,1)){for(H=ia.length,r=new Array(H),w=new Array(c),ea=!0,I=0,u=null,u=[],u.push(E),y=e=1,X=c-1;1<=X?e<=X:e>=X;y=1<=X?++e:--e)u.push(E+y/c*(Y-E));for(u.push(Y);ea;){for(z=f=0,Z=c-1;0<=Z?f<=Z:f>=Z;z=0<=Z?++f:--f)w[z]=0;for(y=g=0,$=H-1;0<=$?g<=$:g>=$;y=0<=$?++g:--g){for(ha=ia[y],G=Number.MAX_VALUE,z=h=0,_=c-1;0<=_?h<=_:h>=_;z=0<=_?++h:--h)(x=m(u[z]-ha))<G&&(G=x,s=z);w[s]++,r[y]=s}for(J=new Array(c),z=i=0,aa=c-1;0<=aa?i<=aa:i>=aa;z=0<=aa?++i:--i)J[z]=null;for(y=j=0,ca=H-1;0<=ca?j<=ca:j>=ca;y=0<=ca?++j:--j)v=r[y],null===J[v]?J[v]=ia[y]:J[v]+=ia[y];for(z=k=0,da=c-1;0<=da?k<=da:k>=da;z=0<=da?++k:--k)J[z]*=1/w[z];for(ea=!1,z=l=0,Q=c-1;0<=Q?l<=Q:l>=Q;z=0<=Q?++l:--l)if(J[z]!==u[y]){ea=!0;break}u=J,I++,I>200&&(ea=!1)}for(A={},z=n=0,R=c-1;0<=R?n<=R:n>=R;z=0<=R?++n:--n)A[z]=[];for(y=o=0,S=H-1;0<=S?o<=S:o>=S;y=0<=S?++o:--o)v=r[y],A[v].push(ia[y]);for(fa=[],z=p=0,T=c-1;0<=T?p<=T:p>=T;z=0<=T?++p:--p)fa.push(A[z][0]),fa.push(A[z][A[z].length-1]);for(fa=fa.sort(function(a,b){return a-b}),C.push(fa[0]),y=q=1,U=fa.length-1;q<=U;y=q+=2)ga=fa[y],isNaN(ga)||-1!==C.indexOf(ga)||C.push(ga)}return C},E=function(a,b,c){var d,f,h,i;return d=ya(arguments),a=d[0],b=d[1],c=d[2],isNaN(a)&&(a=0),a/=360,a<1/3?(f=(1-b)/3,i=(1+b*w(g*a)/w(e-g*a))/3,h=1-(f+i)):a<2/3?(a-=1/3,i=(1-b)/3,h=(1+b*w(g*a)/w(e-g*a))/3,f=1-(i+h)):(a-=2/3,h=(1-b)/3,f=(1+b*w(g*a)/w(e-g*a))/3,i=1-(h+f)),i=U(c*i*3),h=U(c*h*3),f=U(c*f*3),[255*i,255*h,255*f,d.length>3?d[3]:1]},ga=function(){var a,b,c,d,e,f,h,i;return h=ya(arguments),f=h[0],b=h[1],a=h[2],g=2*Math.PI,f/=255,b/=255,a/=255,e=Math.min(f,b,a),d=(f+b+a)/3,i=1-e/d,0===i?c=0:(c=(f-b+(f-a))/2,c/=Math.sqrt((f-b)*(f-b)+(f-a)*(b-a)),c=Math.acos(c),a>b&&(c=g-c),c/=g),[360*c,i,d]},t.hsi=function(){return function(a,b,c){c.prototype=a.prototype;var d=new c,e=a.apply(d,b);return Object(e)===e?e:d}(a,Ca.call(arguments).concat(["hsi"]),function(){})},k.hsi=E,a.prototype.hsi=function(){return ga(this._rgb)},J=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p;return"hsl"===d?(o=a.hsl(),p=b.hsl()):"hsv"===d?(o=a.hsv(),p=b.hsv()):"hcg"===d?(o=a.hcg(),p=b.hcg()):"hsi"===d?(o=a.hsi(),p=b.hsi()):"lch"!==d&&"hcl"!==d||(d="hcl",o=a.hcl(),p=b.hcl()),"h"===d.substr(0,1)&&(g=o[0],m=o[1],j=o[2],h=p[0],n=p[1],k=p[2]),isNaN(g)||isNaN(h)?isNaN(g)?isNaN(h)?f=Number.NaN:(f=h,1!==j&&0!==j||"hsv"===d||(l=n)):(f=g,1!==k&&0!==k||"hsv"===d||(l=m)):(e=h>g&&h-g>180?h-(g+360):h<g&&g-h>180?h+360-g:h-g,f=g+c*e),null==l&&(l=m+c*(n-m)),i=j+c*(k-j),t[d](f,l,i)},l=l.concat(function(){var a,b,c,d;for(c=["hsv","hsl","hsi","hcl","lch","hcg"],d=[],b=0,a=c.length;b<a;b++)X=c[b],d.push([X,J]);return d}()),M=function(a,b,c,d){var e,f;return e=a.num(),f=b.num(),t.num(e+(f-e)*c,"num")},l.push(["num",M]),K=function(b,c,d,e){var f,g;return f=b.lab(),g=c.lab(),new a(f[0]+d*(g[0]-f[0]),f[1]+d*(g[1]-f[1]),f[2]+d*(g[2]-f[2]),e)},l.push(["lab",K])}).call(this);
(function(){for(var a=0,b=['ms','moz','webkit','o'],c=0;c<b.length&&!window.requestAnimationFrame;++c)window.requestAnimationFrame=window[b[c]+'RequestAnimationFrame'],window.cancelAnimationFrame=window[b[c]+'CancelAnimationFrame']||window[b[c]+'CancelRequestAnimationFrame'];window.requestAnimationFrame||(window.requestAnimationFrame=function(b){var c=Math.max,d=new Date().getTime(),e=c(0,16-(d-a)),f=window.setTimeout(function(){b(d+e)},e);return a=d+e,f}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)})})();// ----------------------------------------------------------------------------------------
// Testa se storage API est disponvel
function storageAvailable(a){try{var b=window[a];return b.setItem('__storage_test__','__storage_test__'),b.removeItem('__storage_test__'),!0}catch(a){return!1}}// ----------------------------------------------------------------------------------------
// extrai parmetros da URL
function gup(a){a=a.replace(/[\[]/,'\\[').replace(/[\]]/,'\\]');var b='[\\?&]'+a+'=([^&#]*)',c=new RegExp(b),d=c.exec(window.location.href);return null===d?'':d[1]}// ----------------------------------------------------------------------------------------
// retorna data na forma "YYYY-MM-DD"
function dateToYMDString(a){return printf('%04d-%02d-%02d',a.getFullYear(),a.getMonth()+1,a.getDate())}// ----------------------------------------------------------------------------------------
function LoadFavicon(a){// Define o favicon da aplicao
var b=document.createElement('link');b.type='image/x-icon',b.rel='shortcut icon',b.href=a,document.getElementsByTagName('head')[0].appendChild(b)}// ----------------------------------------------------------------------------------------
function MostraEsconde(a){a.style.display='none'===a.style.display?'':'none'}// ----------------------------------------------------------------------------------------
// copy to clipboard (only works in IE)
function CpyClip(theField){//  var tempval=eval("document."+theField);
var tempval=eval(theField);if(tempval.style.display='',tempval.focus(),tempval.select(),document.all){var therange=tempval.createTextRange();therange.execCommand('Copy'),window.status='Dados copiados para a \uFFFDrea de transfer\uFFFDncia!',setTimeout('window.status=\'\'',2400)}tempval.style.display='none'}// ----------------------------------------------------------------------------------------
function SelHoje(a){var b=new Date,c=b.getYear();500>c&&(c=c-100+2e3),a.value=b.getDate()+'/'+(b.getMonth()+1)+'/'+c}// ----------------------------------------------------------------------------------------
function ObtemPonto(a){window.objeto=a,window.open('../comum/obtem_nponto.php','_blank','toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=no,copyhistory=no,top=20,left=20,screenY=500,screenX=680,width=600,height=350')}// ----------------------------------------------------------------------------------------
function ObtemPontoAnaParaMVA(a){window.objeto=a,window.open('../comum/obtem_nponto.php?tpPto=A&Tipos=6,7','_blank','toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=no,copyhistory=no,top=20,left=20,screenY=500,screenX=680,width=600,height=350')}// ----------------------------------------------------------------------------------------
function ObtemPontoAna(a){window.objeto=a,window.open('../comum/obtem_nponto.php?tpPto=A','_blank','toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=no,copyhistory=no,top=20,left=20,screenY=500,screenX=680,width=600,height=350')}// ----------------------------------------------------------------------------------------
function ObtemPontoDig(a){window.objeto=a,window.open('../comum/obtem_nponto.php?tpPto=D','_blank','toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=no,copyhistory=no,top=20,left=20,screenY=500,screenX=680,width=600,height=350')}// ----------------------------------------------------------------------------------------
function ToggleTreeNode(a){'none'===a.nextSibling.style.display?(0<a.childNodes.length&&'IMG'===a.childNodes.item(0).nodeName&&(a.childNodes.item(0).src='../comum/minus.gif'),a.nextSibling.style.display='block'):(0<a.childNodes.length&&'IMG'===a.childNodes.item(0).nodeName&&(a.childNodes.item(0).src='../comum/plus.gif'),a.nextSibling.style.display='none')}// ----------------------------------------------------------------------------------------
function leftTrim(a){if(a==null)return'';for(;' '==a.charAt(0)||10==a.charCodeAt(0);)a=a.substring(1,a.length);return a}// from http://www.somacon.com/p355.php
String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,'')},String.prototype.ltrim=function(){return this.replace(/^\s+/,'')},String.prototype.rtrim=function(){return this.replace(/\s+$/,'')};// ----------------------------------------------------------------------------------------
function isInt(a){var b=parseInt(a);return!isNaN(b)&&(b=b.toString(),b==a)}// ----------------------------------------------------------------------------------------
/* Function printf(format_string,arguments...)
 * Javascript emulation of the C printf function (modifiers and argument types 
 *    "p" and "n" are not supported due to language restrictions)
 *
 * Copyright 2003 K&L Productions. All rights reserved
 * http://www.klproductions.com 
 *
 * Terms of use: This function can be used free of charge IF this header is not
 *               modified and remains with the function code.
 * 
 * Legal: Use this code at your own risk. K&L Productions assumes NO resposibility
 *        for anything.
 ********************************************************************************/function printf(a){var b=Math.round,c=Math.abs,d=function(a,b,d){for(var e='',f=0;f<c(d);f++)e+=b;return 0<d?a+e:e+a},e=function(a,b,c,e){var f=function(a,b,c){return 0<=b?0<=a.indexOf(' ')?c=' '+c:0<=a.indexOf('+')&&(c='+'+c):c='-'+c,c},g=parseInt(b,10);if('0'==b.charAt(0)){var h=0;return(0<=a.indexOf(' ')||0<=a.indexOf('+'))&&h++,c.length<g-h&&(c=d(c,'0',c.length-(g-h))),f(a,e,c)}return c=f(a,e,c),c.length<g&&(0>a.indexOf('-')?c=d(c,' ',c.length-g):c=d(c,' ',g-c.length)),c},f=[];f.c=function(a,b,c,d){var e=String.fromCharCode;return'number'==typeof d?e(d):'string'==typeof d?d.charAt(0):''},f.d=function(a,b,c,d){return f.i(a,b,c,d)},f.u=function(a,b,d,e){return f.i(a,b,d,c(e))},f.i=function(a,b,f,g){var h=parseInt(f),i=c(g).toString().split('.')[0];return i.length<h&&(i=d(i,' ',h-i.length)),e(a,b,i,g)},f.E=function(a,b,c,d){return f.e(a,b,c,d).toUpperCase()},f.e=function(a,b,d,f){return iPrecision=parseInt(d),isNaN(iPrecision)&&(iPrecision=6),rs=c(f).toExponential(iPrecision),0>rs.indexOf('.')&&0<=a.indexOf('#')&&(rs=rs.replace(/^(.*)(e.*)$/,'$1.$2')),e(a,b,rs,f)},f.f=function(a,b,d,f){return iPrecision=parseInt(d),isNaN(iPrecision)&&(iPrecision=6),rs=c(f).toFixed(iPrecision),0>rs.indexOf('.')&&0<=a.indexOf('#')&&(rs+='.'),e(a,b,rs,f)},f.G=function(a,b,c,d){return f.g(a,b,c,d).toUpperCase()},f.g=function(a,b,d,f){return iPrecision=parseInt(d),absArg=c(f),rse=absArg.toExponential(),rsf=absArg.toFixed(6),isNaN(iPrecision)||(rsep=absArg.toExponential(iPrecision),rse=rsep.length<rse.length?rsep:rse,rsfp=absArg.toFixed(iPrecision),rsf=rsfp.length<rsf.length?rsfp:rsf),0>rse.indexOf('.')&&0<=a.indexOf('#')&&(rse=rse.replace(/^(.*)(e.*)$/,'$1.$2')),0>rsf.indexOf('.')&&0<=a.indexOf('#')&&(rsf+='.'),rs=rse.length<rsf.length?rse:rsf,e(a,b,rs,f)},f.o=function(a,f,g,h){var i=parseInt(g),j=b(c(h)).toString(8);return j.length<i&&(j=d(j,' ',i-j.length)),0<=a.indexOf('#')&&(j='0'+j),e(a,f,j,h)},f.X=function(a,b,c,d){return f.x(a,b,c,d).toUpperCase()},f.x=function(a,f,g,h){var i=parseInt(g);h=c(h);var j=b(h).toString(16);return j.length<i&&(j=d(j,' ',i-j.length)),0<=a.indexOf('#')&&(j='0x'+j),e(a,f,j,h)},f.s=function(a,b,c,d){var f=parseInt(c),g=d;return g.length>f&&(g=g.substring(0,f)),e(a,b,g,0)},farr=a.split('%'),retstr=farr[0],fpRE=/^([-+ #]*)(\d*)\.?(\d*)([cdieEfFgGosuxX])(.*)$/;for(var g=1;g<farr.length;g++)fps=fpRE.exec(farr[g]),fps&&(null!=arguments[g]&&(retstr+=f[fps[4]](fps[1],fps[2],fps[3],arguments[g])),retstr+=fps[5]);return retstr}// Function printf() END 
// ----------------------------------------------------------------------------------------
// Funes auxiliares para gerenciar cookies
// http://www.quirksmode.org/js/cookies.html
function createCookie(a,b,c){if(c){var d=new Date;d.setTime(d.getTime()+1e3*(60*(60*(24*c))));var e='; expires='+d.toGMTString()}else var e='';document.cookie=a+'='+b+e+'; path=/'}function readCookie(a){for(var b,d=a+'=',e=document.cookie.split(';'),f=0;f<e.length;f++){for(b=e[f];' '==b.charAt(0);)b=b.substring(1,b.length);if(0==b.indexOf(d))return b.substring(d.length,b.length)}return null}function eraseCookie(a){createCookie(a,'',-1)}// ----------------------------------------------------------------------------------------
// http://www.quirksmode.org/js/detect.html
var BrowserDetect={init:function(){this.browser=this.searchString(this.dataBrowser)||'An unknown browser',this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||'an unknown version',this.OS=this.searchString(this.dataOS)||'an unknown OS'},searchString:function(a){for(var b=0;b<a.length;b++){var c=a[b].string,d=a[b].prop;if(this.versionSearchString=a[b].versionSearch||a[b].identity,c){if(-1!=c.indexOf(a[b].subString))return a[b].identity;}else if(d)return a[b].identity}},searchVersion:function(a){var b=a.indexOf(this.versionSearchString);return-1==b?void 0:parseFloat(a.substring(b+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:'Chrome',identity:'Chrome'},{string:navigator.userAgent,subString:'OmniWeb',versionSearch:'OmniWeb/',identity:'OmniWeb'},{string:navigator.vendor,subString:'Apple',identity:'Safari',versionSearch:'Version'},{prop:window.opera,identity:'Opera'},{string:navigator.vendor,subString:'iCab',identity:'iCab'},{string:navigator.vendor,subString:'KDE',identity:'Konqueror'},{string:navigator.userAgent,subString:'Firefox',identity:'Firefox'},{string:navigator.vendor,subString:'Camino',identity:'Camino'},{// for newer Netscapes (6+)
string:navigator.userAgent,subString:'Netscape',identity:'Netscape'},{string:navigator.userAgent,subString:'MSIE',identity:'Explorer',versionSearch:'MSIE'},{string:navigator.userAgent,subString:'Gecko',identity:'Mozilla',versionSearch:'rv'},{// for older Netscapes (4-)
string:navigator.userAgent,subString:'Mozilla',identity:'Netscape',versionSearch:'Mozilla'}],dataOS:[{string:navigator.platform,subString:'Win',identity:'Windows'},{string:navigator.platform,subString:'Mac',identity:'Mac'},{string:navigator.userAgent,subString:'iPhone',identity:'iPhone/iPod'},{string:navigator.userAgent,subString:'iPad',identity:'iPad'},{string:navigator.platform,subString:'Linux',identity:'Linux'}]};BrowserDetect.init();
var RadarChart={defaultConfig:{containerClass:"radar-chart",w:600,h:600,factor:.95,factorLegend:1,levels:3,levelTick:!1,TickLength:10,maxValue:0,minValue:0,radians:2*Math.PI,color:d3.scale.category10(),axisLine:!0,axisText:!0,circles:!0,radius:5,open:!1,backgroundTooltipColor:"#555",backgroundTooltipOpacity:"0.7",tooltipColor:"white",axisJoin:function(a,b){return a.className||b},tooltipFormatValue:function(a){return a},tooltipFormatClass:function(a){return a},transitionDuration:300},chart:function(){function a(a,b){if(!1===b||null==b)a.classed("visible",0),a.select("rect").classed("visible",0);else{a.classed("visible",1);var d=a.node().parentNode,e=d3.mouse(d);a.select("text").classed("visible",1).style("fill",c.tooltipColor);var f=a.select("text").text(b).node().getBBox();a.select("rect").classed("visible",1).attr("x",0).attr("x",f.x-5).attr("y",f.y-5).attr("width",f.width+10).attr("height",f.height+10).attr("rx","5").attr("ry","5").style("fill",c.backgroundTooltipColor).style("opacity",c.backgroundTooltipOpacity),a.attr("transform","translate("+(e[0]+10)+","+(e[1]-10)+")")}}function b(b){b.each(function(b){var g=Math.sin,h=Math.cos,i=Math.min,j=Math.max;function d(a,b,d,e){return d="undefined"==typeof d?1:d,b*(1-d*e(a*c.radians/p))}function e(a,b,c){return d(a,b,c,Math.sin)}function f(a,b,c){return d(a,b,c,Math.cos)}// levels && axises
var k=d3.select(this),l=k.selectAll("g.tooltip").data([b[0]]),m=l.enter().append("g").classed("tooltip",!0);m.append("rect").classed("tooltip",!0),m.append("text").classed("tooltip",!0),b=b.map(function(a){return a instanceof Array&&(a={axes:a}),a});var n=j(c.maxValue,d3.max(b,function(a){return d3.max(a.axes,function(a){return a.value})}));n-=c.minValue;var o=b[0].axes.map(function(a){return{name:a.axis,xOffset:a.xOffset?a.xOffset:0,yOffset:a.yOffset?a.yOffset:0}}),p=o.length,q=c.factor*i(c.w/2,c.h/2),r=i(c.w/2,c.h/2);k.classed(c.containerClass,1);var s=d3.range(0,c.levels).map(function(a){return q*((a+1)/c.levels)}),t=k.selectAll("g.level-group").data(s);t.enter().append("g"),t.exit().remove(),t.attr("class",function(a,b){return"level-group level-group-"+b});var u=t.selectAll(".level").data(function(a){return d3.range(0,p).map(function(){return a})});if(u.enter().append("line"),u.exit().remove(),c.levelTick?u.attr("class","level").attr("x1",function(a,b){return q==a?e(b,a):e(b,a)+c.TickLength/2*h(b*c.radians/p)}).attr("y1",function(a,b){return q==a?f(b,a):f(b,a)-c.TickLength/2*g(b*c.radians/p)}).attr("x2",function(a,b){return q==a?e(b+1,a):e(b,a)-c.TickLength/2*h(b*c.radians/p)}).attr("y2",function(a,b){return q==a?f(b+1,a):f(b,a)+c.TickLength/2*g(b*c.radians/p)}).attr("transform",function(a){return"translate("+(c.w/2-a)+", "+(c.h/2-a)+")"}):u.attr("class","level").attr("x1",function(a,b){return e(b,a)}).attr("y1",function(a,b){return f(b,a)}).attr("x2",function(a,b){return e(b+1,a)}).attr("y2",function(a,b){return f(b+1,a)}).attr("transform",function(a){return"translate("+(c.w/2-a)+", "+(c.h/2-a)+")"}),c.axisLine||c.axisText){var v=k.selectAll(".axis").data(o),w=v.enter().append("g");c.axisLine&&w.append("line"),c.axisText&&w.append("text"),v.exit().remove(),v.attr("class","axis"),c.axisLine&&v.select("line").attr("x1",c.w/2).attr("y1",c.h/2).attr("x2",function(a,b){return c.w/2-r+e(b,r,c.factor)}).attr("y2",function(a,b){return c.h/2-r+f(b,r,c.factor)}),c.axisText&&v.select("text").attr("class",function(a,b){var c=e(b,.5);return"legend "+(.4>c?"left":.6<c?"right":"middle")}).attr("dy",function(a,b){var c=f(b,.5);return .1>c?"1em":.9<c?"0":"0.5em"}).text(function(a){return a.name}).attr("x",function(a,b){return a.xOffset+(c.w/2-r)+e(b,r,c.factorLegend)}).attr("y",function(a,b){return a.yOffset+(c.h/2-r)+f(b,r,c.factorLegend)})}// content
b.forEach(function(a){a.axes.forEach(function(a,b){a.x=c.w/2-r+e(b,r,parseFloat(j(a.value-c.minValue,0))/n*c.factor),a.y=c.h/2-r+f(b,r,parseFloat(j(a.value-c.minValue,0))/n*c.factor)})});var x=k.selectAll(".area").data(b,c.axisJoin),y="polygon";if(c.open&&(y="polyline"),x.enter().append(y).classed({area:1,"d3-enter":1}).on("mouseover",function(b){d3.event.stopPropagation(),k.classed("focus",1),d3.select(this).classed("focused",1),a(l,c.tooltipFormatClass(b.className))}).on("mouseout",function(){d3.event.stopPropagation(),k.classed("focus",0),d3.select(this).classed("focused",0),a(l,!1)}),x.exit().classed("d3-exit",1)// trigger css transition
.transition().duration(c.transitionDuration).remove(),x.each(function(a,b){var c={"d3-exit":0};// if exiting element is being reused
c["radar-chart-serie"+b]=1,a.className&&(c[a.className]=1),d3.select(this).classed(c)})// styles should only be transitioned with css
.style("stroke",function(a,b){return c.color(b)}).style("fill",function(a,b){return c.color(b)}).transition().duration(c.transitionDuration)// svg attrs with js
.attr("points",function(a){return a.axes.map(function(a){return[a.x,a.y].join(",")}).join(" ")}).each("start",function(){d3.select(this).classed("d3-enter",0)}// trigger css transition
),c.circles&&c.radius){var z=k.selectAll("g.circle-group").data(b,c.axisJoin);z.enter().append("g").classed({"circle-group":1,"d3-enter":1}),z.exit().classed("d3-exit",1)// trigger css transition
.transition().duration(c.transitionDuration).remove(),z.each(function(a){var b={"d3-exit":0};// if exiting element is being reused
a.className&&(b[a.className]=1),d3.select(this).classed(b)}).transition().duration(c.transitionDuration).each("start",function(){d3.select(this).classed("d3-enter",0)}// trigger css transition
);var A=z.selectAll(".circle").data(function(a,b){return a.axes.map(function(a){return[a,b]})});A.enter().append("circle").classed({circle:1,"d3-enter":1}).on("mouseover",function(b){d3.event.stopPropagation(),a(l,c.tooltipFormatValue(b[0].value))}//container.classed('focus', 1);
//container.select('.area.radar-chart-serie'+dd[1]).classed('focused', 1);
).on("mouseout",function(){d3.event.stopPropagation(),a(l,!1),k.classed("focus",0)}//container.select('.area.radar-chart-serie'+dd[1]).classed('focused', 0);
//No idea why previous line breaks tooltip hovering area after hoverin point.
),A.exit().classed("d3-exit",1)// trigger css transition
.transition().duration(c.transitionDuration).remove(),A.each(function(a){var b={"d3-exit":0};// if exit element reused
b["radar-chart-serie"+a[1]]=1,d3.select(this).classed(b)})// styles should only be transitioned with css
.style("fill",function(a){return c.color(a[1])}).transition().duration(c.transitionDuration)// svg attrs with js
.attr("r",c.radius).attr("cx",function(a){return a[0].x}).attr("cy",function(a){return a[0].y}).each("start",function(){d3.select(this).classed("d3-enter",0)}// trigger css transition
);//Make sure layer order is correct
var B=x.node();B.parentNode.appendChild(B);var C=z.node();C.parentNode.appendChild(C);// ensure tooltip is upmost layer
var D=l.node();D.parentNode.appendChild(D)}})}// default config
var c=Object.create(RadarChart.defaultConfig);return b.config=function(a){return arguments.length?(1<arguments.length?c[arguments[0]]=arguments[1]:d3.entries(a||{}).forEach(function(a){c[a.key]=a.value}),b):c},b},draw:function(a,b,c){var d=RadarChart.chart().config(c),e=d.config();d3.select(a).select("svg").remove(),d3.select(a).append("svg").attr("width",e.w).attr("height",e.h).datum(b).call(d)}};
/*
The MIT License

Copyright (c) 2007 SitePoint Pty. Ltd. http://www.sitepoint.com/

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.
*/var Core={};// W3C DOM 2 Events model
document.addEventListener?(Core.addEventListener=function(a,b,c){a.addEventListener(b,c,!1)},Core.removeEventListener=function(a,b,c){a.removeEventListener(b,c,!1)},Core.preventDefault=function(a){a.preventDefault()},Core.stopPropagation=function(a){a.stopPropagation()}):document.attachEvent&&(Core.addEventListener=function(a,b,c){// prevent adding the same listener twice, since DOM 2 Events ignores
// duplicates like this
if(-1==Core._findListener(a,b,c)){// listener2 calls listener as a method of target in one of two ways,
// depending on what this version of IE supports, and passes it the global
// event object as an argument
var d=function(){var b=window.event;Function.prototype.call?c.call(a,b):(a._currentListener=c,a._currentListener(b),a._currentListener=null)};// add listener2 using IE's attachEvent method
a.attachEvent("on"+b,d);// create an object describing this listener so we can clean it up later
var e=a.document||a,f=e.parentWindow,g="l"+Core._listenerCounter++;// get a reference to the window object containing target
// create a unique ID for this listener
// store a record of this listener in the window object
f._allListeners||(f._allListeners={}),f._allListeners[g]={target:a,type:b,listener:c,listener2:d},a._listeners||(a._listeners=[]),a._listeners[a._listeners.length]=g,f._unloadListenerAdded||(f._unloadListenerAdded=!0,f.attachEvent("onunload",Core._removeAllListeners))}},Core.removeEventListener=function(a,b,c){// find out if the listener was actually added to target
var d=Core._findListener(a,b,c);if(-1!=d){// get a reference to the window object containing target
var e=a.document||a,f=e.parentWindow,g=a._listeners[d],h=f._allListeners[g];// obtain the record of the listener from the window object
// remove the listener, and remove its ID from target
a.detachEvent("on"+b,h.listener2),a._listeners.splice(d,1),delete f._allListeners[g]}},Core.preventDefault=function(a){a.returnValue=!1},Core.stopPropagation=function(a){a.cancelBubble=!0},Core._findListener=function(a,b,c){// get the array of listener IDs added to target
var d=a._listeners;if(!d)return-1;// get a reference to the window object containing target
// searching backward (to speed up onunload processing), find the listener
for(var e=a.document||a,f=e.parentWindow,g=d.length-1;0<=g;g--){// get the listener's ID from target
var h=d[g],j=f._allListeners[h];// get the record of the listener from the window object
// compare type and listener with the retrieved record
if(j.type==b&&j.listener==c)return g}return-1},Core._removeAllListeners=function(){var a=this;for(id in a._allListeners){var b=a._allListeners[id];b.target.detachEvent("on"+b.type,b.listener2),delete a._allListeners[id]}},Core._listenerCounter=0),Core.addClass=function(a,b){Core.hasClass(a,b)||(""==a.className?a.className=b:a.className+=" "+b)},Core.getElementsByClass=function(a){var b=[];b="undefined"==typeof document.all?document.getElementsByTagName("*"):document.all;for(var c=[],d=new RegExp("(^| )"+a+"( |$)"),e=0;e<b.length;e++)d.test(b[e].className)&&(c[c.length]=b[e]);return c},Core.hasClass=function(a,b){var c=new RegExp("(^| )"+b+"( |$)");return!!c.test(a.className)},Core.removeClass=function(a,b){var c=new RegExp("(^| )"+b+"( |$)");a.className=a.className.replace(c,"$1"),a.className=a.className.replace(/ $/,"")},Core.getComputedStyle=function(a,b){var c=null;return c="undefined"==typeof a.currentStyle?document.defaultView.getComputedStyle(a,null):a.currentStyle,c[b]},Core.start=function(a){Core.addEventListener(window,"load",a.init)};
var _0x46ca=['!EVAL','var\x20thisobj=document.getElementById(\x22','\x22);\x20','log','valorTagueado','%1.1f','search','list','tag','parent','noTrace','temPaiGrupo','param','children','getBoundingClientRect','lastXlate','groupDistribType','vertical','top','\x20translate(0\x20','groupDistribSpacing','\x200)','bottom','groupDistrib','label','g_idprefixes','parse','acrescentaPontoLista','pontoPopup','tooltipRelac','cursor','pointer','#radar','tagName','g_hasRadar','dta','med','pnts','splice','prompt','cht','#exec_once','#exec','#set_filter','inkscape:label','http://www.inkscape.org/namespaces/inkscape','setAttribute','#set_group_distribution','horizontal','setGroupDistrib','SetIniExtended','popup','preview:','setPreview','onclick','blockPopup','get','txtOFFON','firstElementChild','formatoC','initfill','initstroke','cscript','cstroke','cattrib','attrib:\x20','cattribval','script:\x20','cfill','TraduzCor','bar','initheight','opac','istag',',width=',',toolbar=no,directories=no,status=no,menubar=no,scrollbars=no,resizable=no,modal=yes\x27\x20);','grafico','fill:none;\x20stroke:white;\x20stroke-width:\x202','strokeWidth','dataini','$.getScript(\x20WebSAGE.g_timePntServer\x20+\x20\x22?P=','&U=','&I=','&F=S','&B=histdata(','\x27);histdata','\x20);','getTimezoneOffset','g_timeshift','tooltips','createTextNode','use','rangex','zoom',';window.WebSAGE.g_zpY\x20=\x20',';window.WebSAGE.g_zpW\x20=\x20',';window.WebSAGE.zoomPan(10);evt.currentTarget.style.display=\x27none\x27;','evt','mousedown','mousemove','keydown','thisobj=evt.currentTarget;','exec_once','\x20[8]','SP_STATUS','stack','vega','vega-lite','vega4','vega-json','vega4-json','clone','le_inkscapeSAGETags','ellipse','path','image','rncdcurnrkj3uegbg','div','innerHTML','dvg1223gkhkk11','sandbox-host','insertBefore','g_timeoutFalhaID','drawSVG','g_sha1ant_ana','Pass','g_data_ant','svgdiv','xdone','script','set','#exec_on_update','SetExeExtended','toFixed','datafim','interpretaFormatoC','lastVal','mix','hsl','temAnimacao','blinkSeAlarmado','allowblink','rotate','inkscape:transform-center-x','transform-center-x','inkscape:transform-center-y','transform-center-y','\x20rotate(','tooltipText','!END','tooltipTitle','slider','rangey','firstChild','tspan','#SP_STATUS','message','createEvent','dispatchEvent','MouseEvents','initMouseEvent','mouseup','g_win_cmd','window','closed','escondeDestaqPonto','#HORA_ATU','g_blinkcnt','SILENCIA_ID','g_remoteServer','?Z=1','timemachinecontrols','0px','bardiv','#bardiv','40px','-35px','#svgdiv','#almbox','-40px','g_zpW','g_zpH','g_zpX','g_zpY','g_seltela','selectedIndex','fmTELA','submit','PLAY','#TIMEMACHINE_ID','css','#PLAY_ID','#PAUSE_ID','g_timeoutSlideID','setHours','setMinutes','reload','PTELA','ZPX','ZPY','ZPW','ZPH','g_hidetoolbar','HIDETB','IDPREFIX','g_pass','base','pagecolor','background-color:\x20','g_isInkscape','RectFundo','body','bgColor','DESTAQ','anim','g_destaqList','g_indSelPonto','mostraDestaqPonto','WebSAGE.escondeDestaqPonto(','-cor-','-clr-','-pbi-','-pbi-background','-pbi-foreground','-pbi-minimum','-pbi-selected','-pbi-negative','-clr-background','-clr-bgd','-cor-bgd','-clr-almini','-cor-almini','-cor-medfal','crosshair','drgDragging','drgX','drgY','bind','drgMouseOffsetY','drgObject','move','createSVGPoint','clientX','getScreenCTM','drgMouseOffsetX','clientY','MOUSEX','MOUSEY','inverse','oncontextmenu','html\x20>\x20head','hidden','overflowY','onselectstart','preprocessaTela','TranslateColor','g_vega_num','TranslateColorsVega','vgTableName','table','spec','vgId','vega_','#vega_','update','vgFormat','_defs','format','attributes','inkscape:current-layer','html','\x20.vega','\x20scale(','_width','_height','values','vgInitData','stringify','_model','_data','source','\x27><div>','initialize','run','toSVG','then','layer1','#vg_','vg_','_runtime','#arc','_d3arc_max','_d3arc_innerRadius','_d3arc_duration','arc','innerRadius','outerRadius','startAngle','_d3arc','cssText','#vega-lite','compile','#vega','baseVal','timespan','#vega-json','update_period','insert','url','#vega3','#vega4','#vega3-json','#vega4-json','changeset','change','runAfter','_d3arc_tag','interpolate','oldAngle','endAngle','attrTween','end','histCalls',');histdata','PNT#','FLG#','FLR#','LMI#','getInfLim','getSupLim','BAY#','getBay','SUB#','getSubstation','TAG#','LMS#','DCR#','alternate','idalt1','WebSAGE','flipOut','setInterval','ida','idb','flipIn','SVGDoc','translate(\x20',',0)\x20','\x20scale(1,\x201)','&RAND=','getJSONData_onSuccess','application/json','tags','bool','quality','parameters','Value','HighAlarmLimit','LowAlarmLimit','TagClientItem','LocationLevel1','TimeStamp','BlockingAnnotation','float','DigitalAlarmTextAppendTrue','DigitalAlarmTextAppendFalse','Alarmed','showValsSVG','valueRanges','majorDimension','ROWS','boolean','TRUE','FALSE','zoomLevel','viewBox','moveBy','enableTools','ZOOMIN_ID','zoomEnabled','MOVE_ID','panEnabled','drgBlock','enableKeyboard','hideWatermark','WATERMARK','setLtVk','resetData','callServer','falhaTudo','g_timeOutFalha','getJSONData','g_toutStatusID','g_timeOutRefresh','g_toutID','Safari','SafariRenderBugRedraw','#333333','#E81123','#3bb44a','#01B8AA','enableValueChangeAnimation','\x20scrolling=\x22no\x22\x20','container','apikey','iframeparams','frameborder=\x220\x22\x20height=\x22250\x22\x20width=\x22250\x22','svgurl','iframe','readyfordata','rtdata','npts','vals','qualifs','descriptions','npt','svgobj','zoomobj','moveobj','enablekeyboardobj','resetobj','tagsList','onready','ltvkobj','zoomlevel','loadingSVG','createElementFromHTML','guidGenerator','scrolling','text/javascript','onload','readyState','complete','loadScript','<div\x20id=\x22svgdiv\x22\x20style=\x22visibility:hidden\x22></div>','insertAdjacentHTML','afterend','<div\x20id=\x27VEGACHARTS\x27\x20style=\x27display:none\x27></div>','onmouseclick','click','currentTarget','ctrlKey','metaKey','http://scadavis.io/synoptic/synoptic.html','2018-1019\x20Ricardo\x20Olsen\x20/\x20DSC\x20Systems.\x20All\x20rights\x20reserved.','1.0','postMessage','svgid','ready','1.0.1','slice','2018-2019\x20Ricardo\x20Olsen\x20/\x20DSC\x20Systems.\x20All\x20rights\x20reserved.','Ricardo\x20Olsen','status','componentloaded','responseText','domain','onreadystatechange','SCADAvis.io\x20API:\x20error\x20loading\x20SVG\x20URL.\x20','updateValues','keys','setValue','storeValue','getApiKey','getVersion','getIframe','getComponentState','getComponentVersion','zoomTo','zoomToOriginal','enabletoolsobj','enableMouse','enablemouseobj','hidewatermarkobj','loaded','loadURL','null','moz','webkit','requestAnimationFrame','RequestAnimationFrame','cancelAnimationFrame','CancelRequestAnimationFrame','getTime','max','__storage_test__','setItem','removeItem','replace','[\x5c?&]','=([^&#]*)','exec','location','href','%04d-%02d-%02d','getFullYear','getMonth','getDate','createElement','link','type','getElementsByTagName','appendChild','style','display','none','focus','createTextRange','execCommand','Copy','Dados\x20copiados\x20para\x20a\x20rea\x20de\x20transferncia!','window.status=\x27\x27','getYear','value','_blank','objeto','open','toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=no,copyhistory=no,top=20,left=20,screenY=500,screenX=680,width=600,height=350','../comum/obtem_nponto.php?tpPto=A&Tipos=6,7','../comum/obtem_nponto.php?tpPto=D','nextSibling','length','childNodes','nodeName','IMG','item','../comum/minus.gif','block','src','../comum/plus.gif','charAt','charCodeAt','prototype','trim','ltrim','rtrim','toString','abs','indexOf','number','fromCharCode','split','toUpperCase','toExponential','$1.$2','round','substring','toGMTString','cookie',';\x20path=/','browser','searchString','version','searchVersion','userAgent','appVersion','an\x20unknown\x20version','dataOS','an\x20unknown\x20OS','string','prop','versionSearchString','versionSearch','identity','subString','Chrome','OmniWeb','vendor','Apple','opera','Opera','iCab','Konqueror','Firefox','Camino','Netscape','MSIE','Gecko','Mozilla','platform','Win','Windows','Mac','iPhone','iPad','Linux','push','toLowerCase','addEventListener','removeEventListener','preventDefault','stopPropagation','attachEvent','_findListener','event','call','_currentListener','document','parentWindow','_listenerCounter','_allListeners','_listeners','_unloadListenerAdded','onunload','_removeAllListeners','listener2','returnValue','target','detachEvent','addClass','hasClass','getElementsByClass','all','(^|\x20)','(\x20|$)','test','className','removeClass','getComputedStyle','currentStyle','undefined','init','stroke:rgb(0%,85%,0%);stroke-width:2;stroke-opacity:1;','fill-opacity:0.1;','stroke:red;','fill:red;','stroke:rgb(80%,80%,80%);stroke-width:2;stroke-opacity:1;','fill-opacity:0.5;','stroke:rgb(60%,0%,71%);stroke-width:2;stroke-opacity:1;','fill:rgb(60%,0%,71%);','stroke-width:4;stroke:rgb(0%,85%,0%);','stroke-width:4;stroke:rgb(80%,80%,80%);','stroke-width:4;stroke:rgb(60%,0%,71%);','rgb(80%,80%,80%)','radar-chart','scale','category10','#555','0.7','white','create','defaultConfig','classed','visible','node','parentNode','mouse','select','text','fill','tooltipColor','getBBox','rect','attr','width','height','backgroundTooltipColor','opacity','backgroundTooltipOpacity','transform','translate(','each','selectAll','g.tooltip','data','enter','append','tooltip','map','maxValue','axis','xOffset','yOffset','factor','min','containerClass','sin','cos','range','levels','g.level-group','exit','remove','class','.level','line','level','radians','TickLength','axisLine','axisText','.axis','left','right','middle','1em','0.5em','name','factorLegend','forEach','axes','minValue','.area','axisJoin','polygon','polyline','mouseover','tooltipFormatClass','mouseout','focused','d3-exit','transition','radar-chart-serie','stroke','color','duration','transitionDuration','points','join','start','d3-enter','g.circle-group','.circle','circle','radius','config','entries','key','chart','svg','datum','red','yellow','goldenrod','plum','silver','cadetblue','brown','green','magenta','orange','darkcyan','deepskyblue','indigo','lightseagreen','#BBBBBB','Source\x20Sans\x20Pro,calibri,consolas,arial,helvetica','#F0F0F0','blue','#B0B0B0','#ECECEE','484848','gray','khaki','darkblue','#DCDCEE','steelblue','cornsilk','#777777','lightgray','black','#D7D7D7','#999999','fucsia','#505050','tan','#888888','lightsteelblue','crimson','#CCCCCC','OPERADO',':estado','use\x20strict','CancelAnimationFrame','now','setAttributeNS','animate','animateTransform','animateMotion','removeChild','http://www.w3.org/2000/svg','hasOwnProperty','beginElement','endElement','getElementById','object','inittransform','getAttributeNS','\x20translate(','InkSage','valores','datas','valor','unxtime','{\x20var\x20pt=parseInt(\x27PONTO\x27);\x20if\x20(isNaN(pt))\x20pt=window.NPTS[\x27PONTO\x27];\x20window.onmouseclick(evt,\x20pt);\x20}','getValue','ajax','onSuccess','hasTooltip','createElementNS','textContent','Tag:\x20','Descr:\x20','!ALM','!TMP','!ALR','!DCR','substr','!STOFF','!STVAL','lstpnt','visibility','collapse','????','processInvalidTagInElement','autoTooltip','title','Value:\x20','inherit','g_retnok','getFlags','!SLIM','!ILIM','!TAG','!STON'];(function(_0x13ec97,_0x4df081){var _0x47efbe=function(_0x2e5391){while(--_0x2e5391){_0x13ec97['push'](_0x13ec97['shift']());}};_0x47efbe(++_0x4df081);}(_0x46ca,0x1dd));var _0x3a71=function(_0x2fbeca,_0x302170){_0x2fbeca=_0x2fbeca-0x0;var _0x1ae02f=_0x46ca[_0x2fbeca];return _0x1ae02f;};(function(){var _0x251b85=0x0;var _0x4a3876=['ms',_0x3a71('0x0'),_0x3a71('0x1'),'o'];for(var _0x638a48=0x0;_0x638a48<_0x4a3876['length']&&!window[_0x3a71('0x2')];++_0x638a48){window[_0x3a71('0x2')]=window[_0x4a3876[_0x638a48]+_0x3a71('0x3')];window[_0x3a71('0x4')]=window[_0x4a3876[_0x638a48]+'CancelAnimationFrame']||window[_0x4a3876[_0x638a48]+_0x3a71('0x5')];}if(!window[_0x3a71('0x2')])window[_0x3a71('0x2')]=function(_0x71619,_0x18fa41){var _0xfc0ff3=new Date()[_0x3a71('0x6')]();var _0x3e6879=Math[_0x3a71('0x7')](0x0,0x10-(_0xfc0ff3-_0x251b85));var _0x3dc4f6=window['setTimeout'](function(){_0x71619(_0xfc0ff3+_0x3e6879);},_0x3e6879);_0x251b85=_0xfc0ff3+_0x3e6879;return _0x3dc4f6;};if(!window[_0x3a71('0x4')])window[_0x3a71('0x4')]=function(_0x40a1f3){clearTimeout(_0x40a1f3);};}());function storageAvailable(_0x2cb38d){try{var _0x182370=window[_0x2cb38d],_0x5770da=_0x3a71('0x8');_0x182370[_0x3a71('0x9')](_0x5770da,_0x5770da);_0x182370[_0x3a71('0xa')](_0x5770da);return!![];}catch(_0x55dd72){return![];}}function gup(_0x2ce80e){_0x2ce80e=_0x2ce80e[_0x3a71('0xb')](/[\[]/,'\x5c[')[_0x3a71('0xb')](/[\]]/,'\x5c]');var _0x25f9cb=_0x3a71('0xc')+_0x2ce80e+_0x3a71('0xd');var _0x3ede87=new RegExp(_0x25f9cb);var _0x126553=_0x3ede87[_0x3a71('0xe')](window[_0x3a71('0xf')][_0x3a71('0x10')]);if(_0x126553===null){return'';}return _0x126553[0x1];}function dateToYMDString(_0x499cbb){return printf(_0x3a71('0x11'),_0x499cbb[_0x3a71('0x12')](),_0x499cbb[_0x3a71('0x13')]()+0x1,_0x499cbb[_0x3a71('0x14')]());}function LoadFavicon(_0x5b08e6){var _0x2261c3=document[_0x3a71('0x15')](_0x3a71('0x16'));_0x2261c3[_0x3a71('0x17')]='image/x-icon';_0x2261c3['rel']='shortcut\x20icon';_0x2261c3['href']=_0x5b08e6;document[_0x3a71('0x18')]('head')[0x0][_0x3a71('0x19')](_0x2261c3);}function MostraEsconde(_0x3571bf){if(_0x3571bf[_0x3a71('0x1a')][_0x3a71('0x1b')]==='none'){_0x3571bf['style'][_0x3a71('0x1b')]='';}else{_0x3571bf[_0x3a71('0x1a')]['display']=_0x3a71('0x1c');}}function CpyClip(_0x5402fa){var _0x5a7f70=eval(_0x5402fa);_0x5a7f70['style'][_0x3a71('0x1b')]='';_0x5a7f70[_0x3a71('0x1d')]();_0x5a7f70['select']();if(document['all']){var _0x1e604d=_0x5a7f70[_0x3a71('0x1e')]();_0x1e604d[_0x3a71('0x1f')](_0x3a71('0x20'));window['status']=_0x3a71('0x21');setTimeout(_0x3a71('0x22'),0x960);}_0x5a7f70['style'][_0x3a71('0x1b')]='none';}function SelHoje(_0x5c09c3){var _0x389ad8=new Date();var _0x1dfb7a=_0x389ad8[_0x3a71('0x23')]();if(_0x1dfb7a<0x1f4){_0x1dfb7a=_0x1dfb7a-0x64+0x7d0;}_0x5c09c3[_0x3a71('0x24')]=_0x389ad8[_0x3a71('0x14')]()+'/'+(_0x389ad8[_0x3a71('0x13')]()+0x1)+'/'+_0x1dfb7a;}function ObtemPonto(_0x3ea26f){var _0xe09007='../comum/obtem_nponto.php';var _0x58c4fe=_0x3a71('0x25');window[_0x3a71('0x26')]=_0x3ea26f;window[_0x3a71('0x27')](_0xe09007,_0x58c4fe,_0x3a71('0x28'));}function ObtemPontoAnaParaMVA(_0x4fe641){var _0x249c47=_0x3a71('0x29');var _0xcc9ed0=_0x3a71('0x25');window[_0x3a71('0x26')]=_0x4fe641;window[_0x3a71('0x27')](_0x249c47,_0xcc9ed0,_0x3a71('0x28'));}function ObtemPontoAna(_0x57d1d5){var _0x2ec7ed='../comum/obtem_nponto.php?tpPto=A';var _0x27b482=_0x3a71('0x25');window['objeto']=_0x57d1d5;window[_0x3a71('0x27')](_0x2ec7ed,_0x27b482,'toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=no,copyhistory=no,top=20,left=20,screenY=500,screenX=680,width=600,height=350');}function ObtemPontoDig(_0x539447){var _0x1e98b1='';var _0x41370e=_0x3a71('0x2a');var _0x5976e0=_0x3a71('0x25');window[_0x3a71('0x26')]=_0x539447;window['open'](_0x41370e,_0x5976e0,'toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=no,copyhistory=no,top=20,left=20,screenY=500,screenX=680,width=600,height=350');}function ToggleTreeNode(_0x35e780){if(_0x35e780[_0x3a71('0x2b')][_0x3a71('0x1a')][_0x3a71('0x1b')]===_0x3a71('0x1c')){if(_0x35e780['childNodes'][_0x3a71('0x2c')]>0x0){if(_0x35e780[_0x3a71('0x2d')]['item'](0x0)[_0x3a71('0x2e')]===_0x3a71('0x2f')){_0x35e780[_0x3a71('0x2d')][_0x3a71('0x30')](0x0)['src']=_0x3a71('0x31');}}_0x35e780[_0x3a71('0x2b')][_0x3a71('0x1a')][_0x3a71('0x1b')]=_0x3a71('0x32');}else{if(_0x35e780[_0x3a71('0x2d')][_0x3a71('0x2c')]>0x0){if(_0x35e780[_0x3a71('0x2d')]['item'](0x0)[_0x3a71('0x2e')]==='IMG'){_0x35e780[_0x3a71('0x2d')]['item'](0x0)[_0x3a71('0x33')]=_0x3a71('0x34');}}_0x35e780['nextSibling'][_0x3a71('0x1a')][_0x3a71('0x1b')]=_0x3a71('0x1c');}}function leftTrim(_0x436826){if(_0x436826==undefined){return'';}while(_0x436826[_0x3a71('0x35')](0x0)=='\x20'||_0x436826[_0x3a71('0x36')](0x0)==0xa){_0x436826=_0x436826['substring'](0x1,_0x436826[_0x3a71('0x2c')]);}return _0x436826;}String[_0x3a71('0x37')][_0x3a71('0x38')]=function(){return this['replace'](/^\s+|\s+$/g,'');};String[_0x3a71('0x37')][_0x3a71('0x39')]=function(){return this[_0x3a71('0xb')](/^\s+/,'');};String['prototype'][_0x3a71('0x3a')]=function(){return this[_0x3a71('0xb')](/\s+$/,'');};function isInt(_0x19e091){var _0x2a367c=parseInt(_0x19e091);if(isNaN(_0x2a367c)){return![];}_0x2a367c=_0x2a367c[_0x3a71('0x3b')]();if(_0x2a367c!=_0x19e091){return![];}return!![];}function printf(_0x1e4af1){var _0x39a4dc=function(_0x2d83b6,_0xa6ca9e,_0x3d91d3){var _0x4c5d14='';for(var _0x134e00=0x0;_0x134e00<Math[_0x3a71('0x3c')](_0x3d91d3);_0x134e00++)_0x4c5d14+=_0xa6ca9e;return _0x3d91d3>0x0?_0x2d83b6+_0x4c5d14:_0x4c5d14+_0x2d83b6;};var _0xaba8f5=function(_0x302a4a,_0x43603f,_0x416f12,_0x2ed4a1){var _0x41c01b=function(_0x302a4a,_0x2ed4a1,_0x416f12){if(_0x2ed4a1>=0x0){if(_0x302a4a[_0x3a71('0x3d')]('\x20')>=0x0)_0x416f12='\x20'+_0x416f12;else if(_0x302a4a['indexOf']('+')>=0x0)_0x416f12='+'+_0x416f12;}else _0x416f12='-'+_0x416f12;return _0x416f12;};var _0x5ab0f5=parseInt(_0x43603f,0xa);if(_0x43603f[_0x3a71('0x35')](0x0)=='0'){var _0x52d569=0x0;if(_0x302a4a[_0x3a71('0x3d')]('\x20')>=0x0||_0x302a4a[_0x3a71('0x3d')]('+')>=0x0)_0x52d569++;if(_0x416f12['length']<_0x5ab0f5-_0x52d569)_0x416f12=_0x39a4dc(_0x416f12,'0',_0x416f12[_0x3a71('0x2c')]-(_0x5ab0f5-_0x52d569));return _0x41c01b(_0x302a4a,_0x2ed4a1,_0x416f12);}_0x416f12=_0x41c01b(_0x302a4a,_0x2ed4a1,_0x416f12);if(_0x416f12[_0x3a71('0x2c')]<_0x5ab0f5){if(_0x302a4a[_0x3a71('0x3d')]('-')<0x0)_0x416f12=_0x39a4dc(_0x416f12,'\x20',_0x416f12['length']-_0x5ab0f5);else _0x416f12=_0x39a4dc(_0x416f12,'\x20',_0x5ab0f5-_0x416f12[_0x3a71('0x2c')]);}return _0x416f12;};var _0xae8275=new Array();_0xae8275['c']=function(_0x45b411,_0x3a7ff1,_0x17e871,_0x165029){if(typeof _0x165029==_0x3a71('0x3e'))return String[_0x3a71('0x3f')](_0x165029);if(typeof _0x165029=='string')return _0x165029[_0x3a71('0x35')](0x0);return'';};_0xae8275['d']=function(_0x52a035,_0x3f1257,_0x23cf34,_0x581e31){return _0xae8275['i'](_0x52a035,_0x3f1257,_0x23cf34,_0x581e31);};_0xae8275['u']=function(_0x160bf9,_0x4f3bf3,_0x890298,_0x4ec96d){return _0xae8275['i'](_0x160bf9,_0x4f3bf3,_0x890298,Math[_0x3a71('0x3c')](_0x4ec96d));};_0xae8275['i']=function(_0x1780a9,_0x2feeb9,_0x2a168c,_0x2599a4){var _0x4a1a29=parseInt(_0x2a168c);var _0xb162d9=Math['abs'](_0x2599a4)[_0x3a71('0x3b')]()[_0x3a71('0x40')]('.')[0x0];if(_0xb162d9['length']<_0x4a1a29)_0xb162d9=_0x39a4dc(_0xb162d9,'\x20',_0x4a1a29-_0xb162d9[_0x3a71('0x2c')]);return _0xaba8f5(_0x1780a9,_0x2feeb9,_0xb162d9,_0x2599a4);};_0xae8275['E']=function(_0x3fc905,_0x31c9fc,_0x3ee2d9,_0x51c8ec){return _0xae8275['e'](_0x3fc905,_0x31c9fc,_0x3ee2d9,_0x51c8ec)[_0x3a71('0x41')]();};_0xae8275['e']=function(_0x53c4de,_0x104ad9,_0x3acde3,_0x4d7299){iPrecision=parseInt(_0x3acde3);if(isNaN(iPrecision))iPrecision=0x6;rs=Math[_0x3a71('0x3c')](_0x4d7299)[_0x3a71('0x42')](iPrecision);if(rs[_0x3a71('0x3d')]('.')<0x0&&_0x53c4de[_0x3a71('0x3d')]('#')>=0x0)rs=rs[_0x3a71('0xb')](/^(.*)(e.*)$/,_0x3a71('0x43'));return _0xaba8f5(_0x53c4de,_0x104ad9,rs,_0x4d7299);};_0xae8275['f']=function(_0x3bdbc7,_0x2cf404,_0x5d0e6f,_0x78aed7){iPrecision=parseInt(_0x5d0e6f);if(isNaN(iPrecision))iPrecision=0x6;rs=Math['abs'](_0x78aed7)['toFixed'](iPrecision);if(rs[_0x3a71('0x3d')]('.')<0x0&&_0x3bdbc7[_0x3a71('0x3d')]('#')>=0x0)rs=rs+'.';return _0xaba8f5(_0x3bdbc7,_0x2cf404,rs,_0x78aed7);};_0xae8275['G']=function(_0x40d91c,_0x100cd6,_0x201892,_0x59139d){return _0xae8275['g'](_0x40d91c,_0x100cd6,_0x201892,_0x59139d)[_0x3a71('0x41')]();};_0xae8275['g']=function(_0x2fc775,_0x2543b8,_0x488fff,_0x4d931c){iPrecision=parseInt(_0x488fff);absArg=Math[_0x3a71('0x3c')](_0x4d931c);rse=absArg[_0x3a71('0x42')]();rsf=absArg['toFixed'](0x6);if(!isNaN(iPrecision)){rsep=absArg[_0x3a71('0x42')](iPrecision);rse=rsep[_0x3a71('0x2c')]<rse[_0x3a71('0x2c')]?rsep:rse;rsfp=absArg['toFixed'](iPrecision);rsf=rsfp[_0x3a71('0x2c')]<rsf['length']?rsfp:rsf;}if(rse[_0x3a71('0x3d')]('.')<0x0&&_0x2fc775[_0x3a71('0x3d')]('#')>=0x0)rse=rse[_0x3a71('0xb')](/^(.*)(e.*)$/,'$1.$2');if(rsf[_0x3a71('0x3d')]('.')<0x0&&_0x2fc775[_0x3a71('0x3d')]('#')>=0x0)rsf=rsf+'.';rs=rse['length']<rsf[_0x3a71('0x2c')]?rse:rsf;return _0xaba8f5(_0x2fc775,_0x2543b8,rs,_0x4d931c);};_0xae8275['o']=function(_0x4a7d40,_0x109dc9,_0x4a42b6,_0x39fa37){var _0x2fee18=parseInt(_0x4a42b6);var _0x283b10=Math['round'](Math[_0x3a71('0x3c')](_0x39fa37))[_0x3a71('0x3b')](0x8);if(_0x283b10[_0x3a71('0x2c')]<_0x2fee18)_0x283b10=_0x39a4dc(_0x283b10,'\x20',_0x2fee18-_0x283b10[_0x3a71('0x2c')]);if(_0x4a7d40[_0x3a71('0x3d')]('#')>=0x0)_0x283b10='0'+_0x283b10;return _0xaba8f5(_0x4a7d40,_0x109dc9,_0x283b10,_0x39fa37);};_0xae8275['X']=function(_0x3f2e4c,_0x50e0f4,_0x595fff,_0x4c4511){return _0xae8275['x'](_0x3f2e4c,_0x50e0f4,_0x595fff,_0x4c4511)[_0x3a71('0x41')]();};_0xae8275['x']=function(_0x47524d,_0x53531c,_0x306a3d,_0x5bbf29){var _0x5dc16e=parseInt(_0x306a3d);_0x5bbf29=Math[_0x3a71('0x3c')](_0x5bbf29);var _0x4a06e7=Math[_0x3a71('0x44')](_0x5bbf29)[_0x3a71('0x3b')](0x10);if(_0x4a06e7['length']<_0x5dc16e)_0x4a06e7=_0x39a4dc(_0x4a06e7,'\x20',_0x5dc16e-_0x4a06e7[_0x3a71('0x2c')]);if(_0x47524d[_0x3a71('0x3d')]('#')>=0x0)_0x4a06e7='0x'+_0x4a06e7;return _0xaba8f5(_0x47524d,_0x53531c,_0x4a06e7,_0x5bbf29);};_0xae8275['s']=function(_0x3e260f,_0xbfb6fc,_0x585026,_0x2dbb25){var _0x3a9a1a=parseInt(_0x585026);var _0x2d9ba8=_0x2dbb25;if(_0x2d9ba8['length']>_0x3a9a1a)_0x2d9ba8=_0x2d9ba8[_0x3a71('0x45')](0x0,_0x3a9a1a);return _0xaba8f5(_0x3e260f,_0xbfb6fc,_0x2d9ba8,0x0);};farr=_0x1e4af1['split']('%');retstr=farr[0x0];fpRE=/^([-+ #]*)(\d*)\.?(\d*)([cdieEfFgGosuxX])(.*)$/;for(var _0x461162=0x1;_0x461162<farr['length'];_0x461162++){fps=fpRE[_0x3a71('0xe')](farr[_0x461162]);if(!fps)continue;if(arguments[_0x461162]!=null)retstr+=_0xae8275[fps[0x4]](fps[0x1],fps[0x2],fps[0x3],arguments[_0x461162]);retstr+=fps[0x5];}return retstr;}function createCookie(_0x53e397,_0x35ee68,_0xef1fa4){if(_0xef1fa4){var _0x106064=new Date();_0x106064['setTime'](_0x106064[_0x3a71('0x6')]()+_0xef1fa4*0x18*0x3c*0x3c*0x3e8);var _0x5cee9f=';\x20expires='+_0x106064[_0x3a71('0x46')]();}else var _0x5cee9f='';document[_0x3a71('0x47')]=_0x53e397+'='+_0x35ee68+_0x5cee9f+_0x3a71('0x48');}function readCookie(_0x2ca5e5){var _0x4d8620=_0x2ca5e5+'=';var _0x5f40ba=document[_0x3a71('0x47')][_0x3a71('0x40')](';');for(var _0x4b89cc=0x0;_0x4b89cc<_0x5f40ba[_0x3a71('0x2c')];_0x4b89cc++){var _0x1be869=_0x5f40ba[_0x4b89cc];while(_0x1be869[_0x3a71('0x35')](0x0)=='\x20')_0x1be869=_0x1be869[_0x3a71('0x45')](0x1,_0x1be869['length']);if(_0x1be869[_0x3a71('0x3d')](_0x4d8620)==0x0)return _0x1be869[_0x3a71('0x45')](_0x4d8620[_0x3a71('0x2c')],_0x1be869[_0x3a71('0x2c')]);}return null;}function eraseCookie(_0xe339c3){createCookie(_0xe339c3,'',-0x1);}var BrowserDetect={'init':function(){this[_0x3a71('0x49')]=this[_0x3a71('0x4a')](this['dataBrowser'])||'An\x20unknown\x20browser';this[_0x3a71('0x4b')]=this[_0x3a71('0x4c')](navigator[_0x3a71('0x4d')])||this[_0x3a71('0x4c')](navigator[_0x3a71('0x4e')])||_0x3a71('0x4f');this['OS']=this['searchString'](this[_0x3a71('0x50')])||_0x3a71('0x51');},'searchString':function(_0x28f604){for(var _0x36784f=0x0;_0x36784f<_0x28f604['length'];_0x36784f++){var _0x1114c9=_0x28f604[_0x36784f][_0x3a71('0x52')];var _0xd5c5e7=_0x28f604[_0x36784f][_0x3a71('0x53')];this[_0x3a71('0x54')]=_0x28f604[_0x36784f][_0x3a71('0x55')]||_0x28f604[_0x36784f][_0x3a71('0x56')];if(_0x1114c9){if(_0x1114c9[_0x3a71('0x3d')](_0x28f604[_0x36784f][_0x3a71('0x57')])!=-0x1)return _0x28f604[_0x36784f][_0x3a71('0x56')];}else if(_0xd5c5e7)return _0x28f604[_0x36784f][_0x3a71('0x56')];}},'searchVersion':function(_0x18ef7d){var _0x1cef9a=_0x18ef7d[_0x3a71('0x3d')](this[_0x3a71('0x54')]);if(_0x1cef9a==-0x1)return;return parseFloat(_0x18ef7d[_0x3a71('0x45')](_0x1cef9a+this[_0x3a71('0x54')][_0x3a71('0x2c')]+0x1));},'dataBrowser':[{'string':navigator[_0x3a71('0x4d')],'subString':_0x3a71('0x58'),'identity':_0x3a71('0x58')},{'string':navigator[_0x3a71('0x4d')],'subString':_0x3a71('0x59'),'versionSearch':'OmniWeb/','identity':'OmniWeb'},{'string':navigator[_0x3a71('0x5a')],'subString':_0x3a71('0x5b'),'identity':'Safari','versionSearch':'Version'},{'prop':window[_0x3a71('0x5c')],'identity':_0x3a71('0x5d')},{'string':navigator[_0x3a71('0x5a')],'subString':_0x3a71('0x5e'),'identity':_0x3a71('0x5e')},{'string':navigator[_0x3a71('0x5a')],'subString':'KDE','identity':_0x3a71('0x5f')},{'string':navigator[_0x3a71('0x4d')],'subString':_0x3a71('0x60'),'identity':_0x3a71('0x60')},{'string':navigator[_0x3a71('0x5a')],'subString':_0x3a71('0x61'),'identity':_0x3a71('0x61')},{'string':navigator[_0x3a71('0x4d')],'subString':_0x3a71('0x62'),'identity':_0x3a71('0x62')},{'string':navigator[_0x3a71('0x4d')],'subString':_0x3a71('0x63'),'identity':'Explorer','versionSearch':_0x3a71('0x63')},{'string':navigator[_0x3a71('0x4d')],'subString':_0x3a71('0x64'),'identity':_0x3a71('0x65'),'versionSearch':'rv'},{'string':navigator[_0x3a71('0x4d')],'subString':_0x3a71('0x65'),'identity':_0x3a71('0x62'),'versionSearch':_0x3a71('0x65')}],'dataOS':[{'string':navigator[_0x3a71('0x66')],'subString':_0x3a71('0x67'),'identity':_0x3a71('0x68')},{'string':navigator[_0x3a71('0x66')],'subString':_0x3a71('0x69'),'identity':_0x3a71('0x69')},{'string':navigator[_0x3a71('0x4d')],'subString':_0x3a71('0x6a'),'identity':'iPhone/iPod'},{'string':navigator[_0x3a71('0x4d')],'subString':_0x3a71('0x6b'),'identity':'iPad'},{'string':navigator[_0x3a71('0x66')],'subString':'Linux','identity':_0x3a71('0x6c')}]};BrowserDetect['init']();function _$TSA(_0x22aeec){function _0x3f7f6c(_0x55f328,_0xd4ca82){var _0x1d0dc2=_0x55f328<<_0xd4ca82|_0x55f328>>>0x20-_0xd4ca82;return _0x1d0dc2;};function _0x704df(_0x4f0b2e){var _0x7f661b='';var _0x32220c;var _0x2727b9;var _0x5a41bc;for(_0x32220c=0x0;_0x32220c<=0x6;_0x32220c+=0x2){_0x2727b9=_0x4f0b2e>>>_0x32220c*0x4+0x4&0xf;_0x5a41bc=_0x4f0b2e>>>_0x32220c*0x4&0xf;_0x7f661b+=_0x2727b9[_0x3a71('0x3b')](0x10)+_0x5a41bc[_0x3a71('0x3b')](0x10);}return _0x7f661b;};function _0x299d38(_0x82cfdf){var _0x14bcda='';var _0x3a1d1f;var _0x1221ad;for(_0x3a1d1f=0x7;_0x3a1d1f>=0x0;_0x3a1d1f--){_0x1221ad=_0x82cfdf>>>_0x3a1d1f*0x4&0xf;_0x14bcda+=_0x1221ad[_0x3a71('0x3b')](0x10);}return _0x14bcda;};function _0x57ca1d(_0x5b03f5){_0x5b03f5=_0x5b03f5[_0x3a71('0xb')](/\r\n/g,'\x0a');var _0x4b90d0='';for(var _0x59ed6e=0x0;_0x59ed6e<_0x5b03f5[_0x3a71('0x2c')];_0x59ed6e++){var _0x3c683b=_0x5b03f5['charCodeAt'](_0x59ed6e);if(_0x3c683b<0x80){_0x4b90d0+=String['fromCharCode'](_0x3c683b);}else if(_0x3c683b>0x7f&&_0x3c683b<0x800){_0x4b90d0+=String[_0x3a71('0x3f')](_0x3c683b>>0x6|0xc0);_0x4b90d0+=String['fromCharCode'](_0x3c683b&0x3f|0x80);}else{_0x4b90d0+=String[_0x3a71('0x3f')](_0x3c683b>>0xc|0xe0);_0x4b90d0+=String[_0x3a71('0x3f')](_0x3c683b>>0x6&0x3f|0x80);_0x4b90d0+=String[_0x3a71('0x3f')](_0x3c683b&0x3f|0x80);}}return _0x4b90d0;};var _0x212276;var _0x6eb16e,_0x412ec0;var _0x3a0f4c=new Array(0x50);var _0x397570=0x67452301;var _0x4427ce=0xefcdab89;var _0x582033=0x98badcfe;var _0x3becbd=0x10325476;var _0x46ab6a=0xc3d2e1f0;var _0x37b7ec,_0x160235,_0x123fef,_0xe3c472,_0x5d8057;var _0x3054d5;_0x22aeec=_0x57ca1d(_0x22aeec);var _0x38e3e2=_0x22aeec['length'];var _0x35af95=new Array();for(_0x6eb16e=0x0;_0x6eb16e<_0x38e3e2-0x3;_0x6eb16e+=0x4){_0x412ec0=_0x22aeec[_0x3a71('0x36')](_0x6eb16e)<<0x18|_0x22aeec['charCodeAt'](_0x6eb16e+0x1)<<0x10|_0x22aeec['charCodeAt'](_0x6eb16e+0x2)<<0x8|_0x22aeec[_0x3a71('0x36')](_0x6eb16e+0x3);_0x35af95[_0x3a71('0x6d')](_0x412ec0);}switch(_0x38e3e2%0x4){case 0x0:_0x6eb16e=0x80000000;break;case 0x1:_0x6eb16e=_0x22aeec[_0x3a71('0x36')](_0x38e3e2-0x1)<<0x18|0x800000;break;case 0x2:_0x6eb16e=_0x22aeec[_0x3a71('0x36')](_0x38e3e2-0x2)<<0x18|_0x22aeec[_0x3a71('0x36')](_0x38e3e2-0x1)<<0x10|0x8000;break;case 0x3:_0x6eb16e=_0x22aeec['charCodeAt'](_0x38e3e2-0x3)<<0x18|_0x22aeec[_0x3a71('0x36')](_0x38e3e2-0x2)<<0x10|_0x22aeec[_0x3a71('0x36')](_0x38e3e2-0x1)<<0x8|0x80;break;}_0x35af95[_0x3a71('0x6d')](_0x6eb16e);while(_0x35af95[_0x3a71('0x2c')]%0x10!=0xe)_0x35af95['push'](0x0);_0x35af95[_0x3a71('0x6d')](_0x38e3e2>>>0x1d);_0x35af95[_0x3a71('0x6d')](_0x38e3e2<<0x3&0xffffffff);for(_0x212276=0x0;_0x212276<_0x35af95[_0x3a71('0x2c')];_0x212276+=0x10){for(_0x6eb16e=0x0;_0x6eb16e<0x10;_0x6eb16e++)_0x3a0f4c[_0x6eb16e]=_0x35af95[_0x212276+_0x6eb16e];for(_0x6eb16e=0x10;_0x6eb16e<=0x4f;_0x6eb16e++)_0x3a0f4c[_0x6eb16e]=_0x3f7f6c(_0x3a0f4c[_0x6eb16e-0x3]^_0x3a0f4c[_0x6eb16e-0x8]^_0x3a0f4c[_0x6eb16e-0xe]^_0x3a0f4c[_0x6eb16e-0x10],0x1);_0x37b7ec=_0x397570;_0x160235=_0x4427ce;_0x123fef=_0x582033;_0xe3c472=_0x3becbd;_0x5d8057=_0x46ab6a;for(_0x6eb16e=0x0;_0x6eb16e<=0x13;_0x6eb16e++){_0x3054d5=_0x3f7f6c(_0x37b7ec,0x5)+(_0x160235&_0x123fef|~_0x160235&_0xe3c472)+_0x5d8057+_0x3a0f4c[_0x6eb16e]+0x5a827999&0xffffffff;_0x5d8057=_0xe3c472;_0xe3c472=_0x123fef;_0x123fef=_0x3f7f6c(_0x160235,0x1e);_0x160235=_0x37b7ec;_0x37b7ec=_0x3054d5;}for(_0x6eb16e=0x14;_0x6eb16e<=0x27;_0x6eb16e++){_0x3054d5=_0x3f7f6c(_0x37b7ec,0x5)+(_0x160235^_0x123fef^_0xe3c472)+_0x5d8057+_0x3a0f4c[_0x6eb16e]+0x6ed9eba1&0xffffffff;_0x5d8057=_0xe3c472;_0xe3c472=_0x123fef;_0x123fef=_0x3f7f6c(_0x160235,0x1e);_0x160235=_0x37b7ec;_0x37b7ec=_0x3054d5;}for(_0x6eb16e=0x28;_0x6eb16e<=0x3b;_0x6eb16e++){_0x3054d5=_0x3f7f6c(_0x37b7ec,0x5)+(_0x160235&_0x123fef|_0x160235&_0xe3c472|_0x123fef&_0xe3c472)+_0x5d8057+_0x3a0f4c[_0x6eb16e]+0x8f1bbcdc&0xffffffff;_0x5d8057=_0xe3c472;_0xe3c472=_0x123fef;_0x123fef=_0x3f7f6c(_0x160235,0x1e);_0x160235=_0x37b7ec;_0x37b7ec=_0x3054d5;}for(_0x6eb16e=0x3c;_0x6eb16e<=0x4f;_0x6eb16e++){_0x3054d5=_0x3f7f6c(_0x37b7ec,0x5)+(_0x160235^_0x123fef^_0xe3c472)+_0x5d8057+_0x3a0f4c[_0x6eb16e]+0xca62c1d6&0xffffffff;_0x5d8057=_0xe3c472;_0xe3c472=_0x123fef;_0x123fef=_0x3f7f6c(_0x160235,0x1e);_0x160235=_0x37b7ec;_0x37b7ec=_0x3054d5;}_0x397570=_0x397570+_0x37b7ec&0xffffffff;_0x4427ce=_0x4427ce+_0x160235&0xffffffff;_0x582033=_0x582033+_0x123fef&0xffffffff;_0x3becbd=_0x3becbd+_0xe3c472&0xffffffff;_0x46ab6a=_0x46ab6a+_0x5d8057&0xffffffff;}var _0x3054d5=_0x299d38(_0x397570)+_0x299d38(_0x4427ce)+_0x299d38(_0x582033)+_0x299d38(_0x3becbd)+_0x299d38(_0x46ab6a);return _0x3054d5[_0x3a71('0x6e')]();}var Core={};if(document[_0x3a71('0x6f')]){Core[_0x3a71('0x6f')]=function(_0x33dce1,_0x37862c,_0x3a813e){_0x33dce1[_0x3a71('0x6f')](_0x37862c,_0x3a813e,![]);};Core[_0x3a71('0x70')]=function(_0x114ebe,_0x1568d5,_0x4c7f4b){_0x114ebe[_0x3a71('0x70')](_0x1568d5,_0x4c7f4b,![]);};Core[_0x3a71('0x71')]=function(_0x2f3db0){_0x2f3db0[_0x3a71('0x71')]();};Core[_0x3a71('0x72')]=function(_0x12ac43){_0x12ac43[_0x3a71('0x72')]();};}else if(document[_0x3a71('0x73')]){Core[_0x3a71('0x6f')]=function(_0x3f8c13,_0x227d33,_0x740c81){if(Core[_0x3a71('0x74')](_0x3f8c13,_0x227d33,_0x740c81)!=-0x1)return;var _0x2ee17e=function(){var _0x54bdef=window[_0x3a71('0x75')];if(Function[_0x3a71('0x37')][_0x3a71('0x76')]){_0x740c81[_0x3a71('0x76')](_0x3f8c13,_0x54bdef);}else{_0x3f8c13[_0x3a71('0x77')]=_0x740c81;_0x3f8c13['_currentListener'](_0x54bdef);_0x3f8c13[_0x3a71('0x77')]=null;}};_0x3f8c13[_0x3a71('0x73')]('on'+_0x227d33,_0x2ee17e);var _0x546b75={'target':_0x3f8c13,'type':_0x227d33,'listener':_0x740c81,'listener2':_0x2ee17e};var _0x3141f9=_0x3f8c13[_0x3a71('0x78')]||_0x3f8c13;var _0x554e25=_0x3141f9[_0x3a71('0x79')];var _0x3d066b='l'+Core[_0x3a71('0x7a')]++;if(!_0x554e25[_0x3a71('0x7b')])_0x554e25[_0x3a71('0x7b')]={};_0x554e25[_0x3a71('0x7b')][_0x3d066b]=_0x546b75;if(!_0x3f8c13[_0x3a71('0x7c')])_0x3f8c13['_listeners']=[];_0x3f8c13[_0x3a71('0x7c')][_0x3f8c13[_0x3a71('0x7c')]['length']]=_0x3d066b;if(!_0x554e25['_unloadListenerAdded']){_0x554e25[_0x3a71('0x7d')]=!![];_0x554e25['attachEvent'](_0x3a71('0x7e'),Core[_0x3a71('0x7f')]);}};Core[_0x3a71('0x70')]=function(_0x401db3,_0x35e07f,_0xcb731f){var _0x5d9e94=Core[_0x3a71('0x74')](_0x401db3,_0x35e07f,_0xcb731f);if(_0x5d9e94==-0x1)return;var _0x39eee4=_0x401db3[_0x3a71('0x78')]||_0x401db3;var _0x2e29f5=_0x39eee4['parentWindow'];var _0x22e1e7=_0x401db3[_0x3a71('0x7c')][_0x5d9e94];var _0x236168=_0x2e29f5[_0x3a71('0x7b')][_0x22e1e7];_0x401db3['detachEvent']('on'+_0x35e07f,_0x236168[_0x3a71('0x80')]);_0x401db3[_0x3a71('0x7c')]['splice'](_0x5d9e94,0x1);delete _0x2e29f5['_allListeners'][_0x22e1e7];};Core[_0x3a71('0x71')]=function(_0x4affac){_0x4affac[_0x3a71('0x81')]=![];};Core[_0x3a71('0x72')]=function(_0x18a1b4){_0x18a1b4['cancelBubble']=!![];};Core[_0x3a71('0x74')]=function(_0x16335f,_0x3da971,_0x22b505){var _0x28bff8=_0x16335f['_listeners'];if(!_0x28bff8)return-0x1;var _0x1f8ffb=_0x16335f[_0x3a71('0x78')]||_0x16335f;var _0x227f3c=_0x1f8ffb['parentWindow'];for(var _0x56b14d=_0x28bff8[_0x3a71('0x2c')]-0x1;_0x56b14d>=0x0;_0x56b14d--){var _0x5c89eb=_0x28bff8[_0x56b14d];var _0x4a32fc=_0x227f3c[_0x3a71('0x7b')][_0x5c89eb];if(_0x4a32fc[_0x3a71('0x17')]==_0x3da971&&_0x4a32fc['listener']==_0x22b505){return _0x56b14d;}}return-0x1;};Core[_0x3a71('0x7f')]=function(){var _0xfcb991=this;for(id in _0xfcb991[_0x3a71('0x7b')]){var _0xc57660=_0xfcb991[_0x3a71('0x7b')][id];_0xc57660[_0x3a71('0x82')][_0x3a71('0x83')]('on'+_0xc57660[_0x3a71('0x17')],_0xc57660[_0x3a71('0x80')]);delete _0xfcb991[_0x3a71('0x7b')][id];}};Core['_listenerCounter']=0x0;}Core[_0x3a71('0x84')]=function(_0x3ad2ca,_0x1562ba){if(!Core[_0x3a71('0x85')](_0x3ad2ca,_0x1562ba)){if(_0x3ad2ca['className']==''){_0x3ad2ca['className']=_0x1562ba;}else{_0x3ad2ca['className']+='\x20'+_0x1562ba;}}};Core[_0x3a71('0x86')]=function(_0x5aae98){var _0x1a4bb3=[];if(typeof document[_0x3a71('0x87')]!='undefined'){_0x1a4bb3=document['all'];}else{_0x1a4bb3=document[_0x3a71('0x18')]('*');}var _0x1e875d=[];var _0x2c1102=new RegExp(_0x3a71('0x88')+_0x5aae98+_0x3a71('0x89'));for(var _0x43b0de=0x0;_0x43b0de<_0x1a4bb3[_0x3a71('0x2c')];_0x43b0de++){if(_0x2c1102[_0x3a71('0x8a')](_0x1a4bb3[_0x43b0de][_0x3a71('0x8b')])){_0x1e875d[_0x1e875d[_0x3a71('0x2c')]]=_0x1a4bb3[_0x43b0de];}}return _0x1e875d;};Core[_0x3a71('0x85')]=function(_0x244ab6,_0x5e56b1){var _0x2d32d3=new RegExp(_0x3a71('0x88')+_0x5e56b1+_0x3a71('0x89'));if(_0x2d32d3[_0x3a71('0x8a')](_0x244ab6['className'])){return!![];}return![];};Core[_0x3a71('0x8c')]=function(_0x542220,_0x1f7878){var _0x1223b6=new RegExp(_0x3a71('0x88')+_0x1f7878+_0x3a71('0x89'));_0x542220[_0x3a71('0x8b')]=_0x542220[_0x3a71('0x8b')]['replace'](_0x1223b6,'$1');_0x542220[_0x3a71('0x8b')]=_0x542220['className'][_0x3a71('0xb')](/ $/,'');};Core[_0x3a71('0x8d')]=function(_0x8a19bc,_0x3a3761){var _0x5c8102=null;if(typeof _0x8a19bc[_0x3a71('0x8e')]!=_0x3a71('0x8f')){_0x5c8102=_0x8a19bc[_0x3a71('0x8e')];}else{_0x5c8102=document['defaultView'][_0x3a71('0x8d')](_0x8a19bc,null);}return _0x5c8102[_0x3a3761];};Core['start']=function(_0x3fe8f8){Core[_0x3a71('0x6f')](window,'load',_0x3fe8f8[_0x3a71('0x90')]);};var VisorTelas_DJ_Normal_Aberto_Borda=_0x3a71('0x91');var VisorTelas_DJ_Normal_Aberto_Preen=_0x3a71('0x92');var VisorTelas_DJ_Normal_Fechado_Borda=_0x3a71('0x93');var VisorTelas_DJ_Normal_Fechado_Preen=_0x3a71('0x94');var VisorTelas_DJ_Falha_Aberto_Borda=_0x3a71('0x95');var VisorTelas_DJ_Falha_Aberto_Preen=_0x3a71('0x96');var VisorTelas_DJ_Falha_Fechado_Borda='';var VisorTelas_DJ_Falha_Fechado_Preen='fill:rgb(80%,80%,80%);';var VisorTelas_DJ_Manual_Aberto_Borda=_0x3a71('0x97');var VisorTelas_DJ_Manual_Aberto_Preen=_0x3a71('0x96');var VisorTelas_DJ_Manual_Fechado_Borda='';var VisorTelas_DJ_Manual_Fechado_Preen=_0x3a71('0x98');var VisorTelas_SC_Aberta=_0x3a71('0x99');var VisorTelas_SC_Fechada='stroke-width:4;stroke:red;';var VisorTelas_SC_Falha=_0x3a71('0x9a');var VisorTelas_SC_Manual=_0x3a71('0x9b');var VisorTelas_Medidas_Cor_Falha=_0x3a71('0x9c');var VisorTelas_CorAlarmeInibido='yellow';var VisorTelas_BackgroundSVG='black';var RadarChart={'defaultConfig':{'containerClass':_0x3a71('0x9d'),'w':0x258,'h':0x258,'factor':0.95,'factorLegend':0x1,'levels':0x3,'levelTick':![],'TickLength':0xa,'maxValue':0x0,'minValue':0x0,'radians':0x2*Math['PI'],'color':d3[_0x3a71('0x9e')][_0x3a71('0x9f')](),'axisLine':!![],'axisText':!![],'circles':!![],'radius':0x5,'open':![],'backgroundTooltipColor':_0x3a71('0xa0'),'backgroundTooltipOpacity':_0x3a71('0xa1'),'tooltipColor':_0x3a71('0xa2'),'axisJoin':function(_0x5778ad,_0x1268df){return _0x5778ad[_0x3a71('0x8b')]||_0x1268df;},'tooltipFormatValue':function(_0x366a2d){return _0x366a2d;},'tooltipFormatClass':function(_0x9959ac){return _0x9959ac;},'transitionDuration':0x12c},'chart':function(){var _0x4a42a2=Object[_0x3a71('0xa3')](RadarChart[_0x3a71('0xa4')]);function _0x3eccf3(_0x2c9d43,_0xbce62f){if(_0xbce62f===![]||_0xbce62f==undefined){_0x2c9d43[_0x3a71('0xa5')](_0x3a71('0xa6'),0x0);_0x2c9d43['select']('rect')['classed'](_0x3a71('0xa6'),0x0);}else{_0x2c9d43['classed'](_0x3a71('0xa6'),0x1);var _0x26d2dc=_0x2c9d43[_0x3a71('0xa7')]()[_0x3a71('0xa8')];var _0x3d3c79=d3[_0x3a71('0xa9')](_0x26d2dc);_0x2c9d43[_0x3a71('0xaa')](_0x3a71('0xab'))[_0x3a71('0xa5')](_0x3a71('0xa6'),0x1)['style'](_0x3a71('0xac'),_0x4a42a2[_0x3a71('0xad')]);var _0x52524a=0x5;var _0x30a0b3=_0x2c9d43['select'](_0x3a71('0xab'))[_0x3a71('0xab')](_0xbce62f)[_0x3a71('0xa7')]()[_0x3a71('0xae')]();_0x2c9d43[_0x3a71('0xaa')](_0x3a71('0xaf'))['classed']('visible',0x1)[_0x3a71('0xb0')]('x',0x0)[_0x3a71('0xb0')]('x',_0x30a0b3['x']-_0x52524a)['attr']('y',_0x30a0b3['y']-_0x52524a)['attr'](_0x3a71('0xb1'),_0x30a0b3['width']+_0x52524a*0x2)[_0x3a71('0xb0')](_0x3a71('0xb2'),_0x30a0b3['height']+_0x52524a*0x2)['attr']('rx','5')[_0x3a71('0xb0')]('ry','5')[_0x3a71('0x1a')](_0x3a71('0xac'),_0x4a42a2[_0x3a71('0xb3')])[_0x3a71('0x1a')](_0x3a71('0xb4'),_0x4a42a2[_0x3a71('0xb5')]);_0x2c9d43['attr'](_0x3a71('0xb6'),_0x3a71('0xb7')+(_0x3d3c79[0x0]+0xa)+','+(_0x3d3c79[0x1]-0xa)+')');}}function _0x3fd1b4(_0x4b4c16){_0x4b4c16[_0x3a71('0xb8')](function(_0x4ad489){var _0x32c7c3=d3[_0x3a71('0xaa')](this);var _0x39aaaa=_0x32c7c3[_0x3a71('0xb9')](_0x3a71('0xba'))[_0x3a71('0xbb')]([_0x4ad489[0x0]]);var _0x47ce70=_0x39aaaa[_0x3a71('0xbc')]()[_0x3a71('0xbd')]('g')[_0x3a71('0xa5')](_0x3a71('0xbe'),!![]);_0x47ce70[_0x3a71('0xbd')]('rect')['classed'](_0x3a71('0xbe'),!![]);_0x47ce70['append'](_0x3a71('0xab'))[_0x3a71('0xa5')](_0x3a71('0xbe'),!![]);_0x4ad489=_0x4ad489[_0x3a71('0xbf')](function(_0x425b82){if(_0x425b82 instanceof Array){_0x425b82={'axes':_0x425b82};}return _0x425b82;});var _0xc773a5=Math[_0x3a71('0x7')](_0x4a42a2[_0x3a71('0xc0')],d3['max'](_0x4ad489,function(_0x529523){return d3[_0x3a71('0x7')](_0x529523['axes'],function(_0x399396){return _0x399396[_0x3a71('0x24')];});}));_0xc773a5-=_0x4a42a2['minValue'];var _0x298af5=_0x4ad489[0x0]['axes'][_0x3a71('0xbf')](function(_0x3ce35b,_0x221b54){return{'name':_0x3ce35b[_0x3a71('0xc1')],'xOffset':_0x3ce35b[_0x3a71('0xc2')]?_0x3ce35b[_0x3a71('0xc2')]:0x0,'yOffset':_0x3ce35b[_0x3a71('0xc3')]?_0x3ce35b[_0x3a71('0xc3')]:0x0};});var _0x102a18=_0x298af5['length'];var _0x1e53ae=_0x4a42a2[_0x3a71('0xc4')]*Math['min'](_0x4a42a2['w']/0x2,_0x4a42a2['h']/0x2);var _0x1a70b4=Math[_0x3a71('0xc5')](_0x4a42a2['w']/0x2,_0x4a42a2['h']/0x2);_0x32c7c3[_0x3a71('0xa5')](_0x4a42a2[_0x3a71('0xc6')],0x1);function _0x48a6da(_0x435542,_0x22dfc3,_0x5cd80d,_0x3f6bf0){_0x5cd80d=typeof _0x5cd80d!==_0x3a71('0x8f')?_0x5cd80d:0x1;return _0x22dfc3*(0x1-_0x5cd80d*_0x3f6bf0(_0x435542*_0x4a42a2['radians']/_0x102a18));}function _0x100b72(_0x5a6da7,_0x52cb5e,_0x5d1349){return _0x48a6da(_0x5a6da7,_0x52cb5e,_0x5d1349,Math[_0x3a71('0xc7')]);}function _0x5c8343(_0x468cd9,_0x43ab7c,_0x2b6bdc){return _0x48a6da(_0x468cd9,_0x43ab7c,_0x2b6bdc,Math[_0x3a71('0xc8')]);}var _0x4a8d5e=d3[_0x3a71('0xc9')](0x0,_0x4a42a2[_0x3a71('0xca')])[_0x3a71('0xbf')](function(_0x120f42){return _0x1e53ae*((_0x120f42+0x1)/_0x4a42a2['levels']);});var _0x26098a=_0x32c7c3['selectAll'](_0x3a71('0xcb'))['data'](_0x4a8d5e);_0x26098a[_0x3a71('0xbc')]()[_0x3a71('0xbd')]('g');_0x26098a[_0x3a71('0xcc')]()[_0x3a71('0xcd')]();_0x26098a['attr'](_0x3a71('0xce'),function(_0x633a48,_0x10a06b){return'level-group\x20level-group-'+_0x10a06b;});var _0x324d08=_0x26098a[_0x3a71('0xb9')](_0x3a71('0xcf'))[_0x3a71('0xbb')](function(_0x67a5dc){return d3['range'](0x0,_0x102a18)[_0x3a71('0xbf')](function(){return _0x67a5dc;});});_0x324d08[_0x3a71('0xbc')]()[_0x3a71('0xbd')](_0x3a71('0xd0'));_0x324d08['exit']()['remove']();if(_0x4a42a2['levelTick']){_0x324d08[_0x3a71('0xb0')](_0x3a71('0xce'),_0x3a71('0xd1'))['attr']('x1',function(_0x8079f9,_0x3083e2){if(_0x1e53ae==_0x8079f9){return _0x100b72(_0x3083e2,_0x8079f9);}else{return _0x100b72(_0x3083e2,_0x8079f9)+_0x4a42a2['TickLength']/0x2*Math['cos'](_0x3083e2*_0x4a42a2[_0x3a71('0xd2')]/_0x102a18);}})['attr']('y1',function(_0x158b1b,_0xb2655){if(_0x1e53ae==_0x158b1b){return _0x5c8343(_0xb2655,_0x158b1b);}else{return _0x5c8343(_0xb2655,_0x158b1b)-_0x4a42a2[_0x3a71('0xd3')]/0x2*Math[_0x3a71('0xc7')](_0xb2655*_0x4a42a2['radians']/_0x102a18);}})[_0x3a71('0xb0')]('x2',function(_0x5dc658,_0x20c663){if(_0x1e53ae==_0x5dc658){return _0x100b72(_0x20c663+0x1,_0x5dc658);}else{return _0x100b72(_0x20c663,_0x5dc658)-_0x4a42a2['TickLength']/0x2*Math[_0x3a71('0xc8')](_0x20c663*_0x4a42a2[_0x3a71('0xd2')]/_0x102a18);}})[_0x3a71('0xb0')]('y2',function(_0x59d03b,_0x213fbe){if(_0x1e53ae==_0x59d03b){return _0x5c8343(_0x213fbe+0x1,_0x59d03b);}else{return _0x5c8343(_0x213fbe,_0x59d03b)+_0x4a42a2[_0x3a71('0xd3')]/0x2*Math[_0x3a71('0xc7')](_0x213fbe*_0x4a42a2[_0x3a71('0xd2')]/_0x102a18);}})[_0x3a71('0xb0')](_0x3a71('0xb6'),function(_0x33ea49){return'translate('+(_0x4a42a2['w']/0x2-_0x33ea49)+',\x20'+(_0x4a42a2['h']/0x2-_0x33ea49)+')';});}else{_0x324d08['attr'](_0x3a71('0xce'),_0x3a71('0xd1'))['attr']('x1',function(_0x23cd6b,_0x249c6b){return _0x100b72(_0x249c6b,_0x23cd6b);})['attr']('y1',function(_0xa9c844,_0x19a993){return _0x5c8343(_0x19a993,_0xa9c844);})[_0x3a71('0xb0')]('x2',function(_0x518755,_0x2b696a){return _0x100b72(_0x2b696a+0x1,_0x518755);})['attr']('y2',function(_0x5dcef4,_0x5a898a){return _0x5c8343(_0x5a898a+0x1,_0x5dcef4);})[_0x3a71('0xb0')](_0x3a71('0xb6'),function(_0x4ec520){return _0x3a71('0xb7')+(_0x4a42a2['w']/0x2-_0x4ec520)+',\x20'+(_0x4a42a2['h']/0x2-_0x4ec520)+')';});}if(_0x4a42a2[_0x3a71('0xd4')]||_0x4a42a2[_0x3a71('0xd5')]){var _0x22217b=_0x32c7c3[_0x3a71('0xb9')](_0x3a71('0xd6'))[_0x3a71('0xbb')](_0x298af5);var _0x3b66dc=_0x22217b[_0x3a71('0xbc')]()['append']('g');if(_0x4a42a2['axisLine']){_0x3b66dc[_0x3a71('0xbd')](_0x3a71('0xd0'));}if(_0x4a42a2['axisText']){_0x3b66dc['append']('text');}_0x22217b[_0x3a71('0xcc')]()[_0x3a71('0xcd')]();_0x22217b['attr'](_0x3a71('0xce'),_0x3a71('0xc1'));if(_0x4a42a2['axisLine']){_0x22217b['select'](_0x3a71('0xd0'))['attr']('x1',_0x4a42a2['w']/0x2)[_0x3a71('0xb0')]('y1',_0x4a42a2['h']/0x2)['attr']('x2',function(_0x14cfe8,_0x106b19){return _0x4a42a2['w']/0x2-_0x1a70b4+_0x100b72(_0x106b19,_0x1a70b4,_0x4a42a2[_0x3a71('0xc4')]);})[_0x3a71('0xb0')]('y2',function(_0x23cb2c,_0x526b67){return _0x4a42a2['h']/0x2-_0x1a70b4+_0x5c8343(_0x526b67,_0x1a70b4,_0x4a42a2[_0x3a71('0xc4')]);});}if(_0x4a42a2['axisText']){_0x22217b[_0x3a71('0xaa')](_0x3a71('0xab'))[_0x3a71('0xb0')]('class',function(_0x480a52,_0x2686f8){var _0xf73e37=_0x100b72(_0x2686f8,0.5);return'legend\x20'+(_0xf73e37<0.4?_0x3a71('0xd7'):_0xf73e37>0.6?_0x3a71('0xd8'):_0x3a71('0xd9'));})[_0x3a71('0xb0')]('dy',function(_0x8fff90,_0x30fa3c){var _0x300a99=_0x5c8343(_0x30fa3c,0.5);return _0x300a99<0.1?_0x3a71('0xda'):_0x300a99>0.9?'0':_0x3a71('0xdb');})[_0x3a71('0xab')](function(_0x1cafd4){return _0x1cafd4[_0x3a71('0xdc')];})[_0x3a71('0xb0')]('x',function(_0x7f9e04,_0x75180e){return _0x7f9e04[_0x3a71('0xc2')]+(_0x4a42a2['w']/0x2-_0x1a70b4)+_0x100b72(_0x75180e,_0x1a70b4,_0x4a42a2[_0x3a71('0xdd')]);})[_0x3a71('0xb0')]('y',function(_0x5093d3,_0x5d8307){return _0x5093d3[_0x3a71('0xc3')]+(_0x4a42a2['h']/0x2-_0x1a70b4)+_0x5c8343(_0x5d8307,_0x1a70b4,_0x4a42a2[_0x3a71('0xdd')]);});}}_0x4ad489[_0x3a71('0xde')](function(_0x1971da){_0x1971da[_0x3a71('0xdf')][_0x3a71('0xde')](function(_0x22217b,_0x2a0141){_0x22217b['x']=_0x4a42a2['w']/0x2-_0x1a70b4+_0x100b72(_0x2a0141,_0x1a70b4,parseFloat(Math[_0x3a71('0x7')](_0x22217b[_0x3a71('0x24')]-_0x4a42a2['minValue'],0x0))/_0xc773a5*_0x4a42a2['factor']);_0x22217b['y']=_0x4a42a2['h']/0x2-_0x1a70b4+_0x5c8343(_0x2a0141,_0x1a70b4,parseFloat(Math[_0x3a71('0x7')](_0x22217b[_0x3a71('0x24')]-_0x4a42a2[_0x3a71('0xe0')],0x0))/_0xc773a5*_0x4a42a2[_0x3a71('0xc4')]);});});var _0x3ddbbd=_0x32c7c3['selectAll'](_0x3a71('0xe1'))[_0x3a71('0xbb')](_0x4ad489,_0x4a42a2[_0x3a71('0xe2')]);var _0x52acdd=_0x3a71('0xe3');if(_0x4a42a2[_0x3a71('0x27')]){_0x52acdd=_0x3a71('0xe4');}_0x3ddbbd[_0x3a71('0xbc')]()[_0x3a71('0xbd')](_0x52acdd)['classed']({'area':0x1,'d3-enter':0x1})['on'](_0x3a71('0xe5'),function(_0x14a0a4){d3['event'][_0x3a71('0x72')]();_0x32c7c3[_0x3a71('0xa5')](_0x3a71('0x1d'),0x1);d3['select'](this)[_0x3a71('0xa5')]('focused',0x1);_0x3eccf3(_0x39aaaa,_0x4a42a2[_0x3a71('0xe6')](_0x14a0a4[_0x3a71('0x8b')]));})['on'](_0x3a71('0xe7'),function(){d3[_0x3a71('0x75')][_0x3a71('0x72')]();_0x32c7c3[_0x3a71('0xa5')]('focus',0x0);d3['select'](this)[_0x3a71('0xa5')](_0x3a71('0xe8'),0x0);_0x3eccf3(_0x39aaaa,![]);});_0x3ddbbd[_0x3a71('0xcc')]()[_0x3a71('0xa5')](_0x3a71('0xe9'),0x1)[_0x3a71('0xea')]()['duration'](_0x4a42a2['transitionDuration'])['remove']();_0x3ddbbd[_0x3a71('0xb8')](function(_0xbb5bc,_0x4f3638){var _0x2eca36={'d3-exit':0x0};_0x2eca36[_0x3a71('0xeb')+_0x4f3638]=0x1;if(_0xbb5bc['className']){_0x2eca36[_0xbb5bc[_0x3a71('0x8b')]]=0x1;}d3['select'](this)['classed'](_0x2eca36);})[_0x3a71('0x1a')](_0x3a71('0xec'),function(_0x1c103d,_0x6fa63a){return _0x4a42a2['color'](_0x6fa63a);})[_0x3a71('0x1a')](_0x3a71('0xac'),function(_0x28d642,_0xcec169){return _0x4a42a2[_0x3a71('0xed')](_0xcec169);})[_0x3a71('0xea')]()[_0x3a71('0xee')](_0x4a42a2[_0x3a71('0xef')])['attr'](_0x3a71('0xf0'),function(_0x4aa3b8){return _0x4aa3b8[_0x3a71('0xdf')][_0x3a71('0xbf')](function(_0x66e49b){return[_0x66e49b['x'],_0x66e49b['y']][_0x3a71('0xf1')](',');})[_0x3a71('0xf1')]('\x20');})[_0x3a71('0xb8')](_0x3a71('0xf2'),function(){d3[_0x3a71('0xaa')](this)[_0x3a71('0xa5')](_0x3a71('0xf3'),0x0);});if(_0x4a42a2['circles']&&_0x4a42a2['radius']){var _0xe1491e=_0x32c7c3[_0x3a71('0xb9')](_0x3a71('0xf4'))['data'](_0x4ad489,_0x4a42a2[_0x3a71('0xe2')]);_0xe1491e['enter']()[_0x3a71('0xbd')]('g')[_0x3a71('0xa5')]({'circle-group':0x1,'d3-enter':0x1});_0xe1491e['exit']()[_0x3a71('0xa5')]('d3-exit',0x1)[_0x3a71('0xea')]()[_0x3a71('0xee')](_0x4a42a2[_0x3a71('0xef')])[_0x3a71('0xcd')]();_0xe1491e['each'](function(_0x10fba6){var _0x8df5ef={'d3-exit':0x0};if(_0x10fba6[_0x3a71('0x8b')]){_0x8df5ef[_0x10fba6[_0x3a71('0x8b')]]=0x1;}d3['select'](this)[_0x3a71('0xa5')](_0x8df5ef);})[_0x3a71('0xea')]()['duration'](_0x4a42a2[_0x3a71('0xef')])['each'](_0x3a71('0xf2'),function(){d3['select'](this)[_0x3a71('0xa5')](_0x3a71('0xf3'),0x0);});var _0x21753e=_0xe1491e[_0x3a71('0xb9')](_0x3a71('0xf5'))[_0x3a71('0xbb')](function(_0x1c3ba8,_0x2dd4b0){return _0x1c3ba8[_0x3a71('0xdf')]['map'](function(_0x114966){return[_0x114966,_0x2dd4b0];});});_0x21753e[_0x3a71('0xbc')]()[_0x3a71('0xbd')](_0x3a71('0xf6'))['classed']({'circle':0x1,'d3-enter':0x1})['on'](_0x3a71('0xe5'),function(_0x172a99){d3[_0x3a71('0x75')][_0x3a71('0x72')]();_0x3eccf3(_0x39aaaa,_0x4a42a2['tooltipFormatValue'](_0x172a99[0x0][_0x3a71('0x24')]));})['on']('mouseout',function(_0x1dd0ba){d3[_0x3a71('0x75')]['stopPropagation']();_0x3eccf3(_0x39aaaa,![]);_0x32c7c3[_0x3a71('0xa5')](_0x3a71('0x1d'),0x0);});_0x21753e['exit']()[_0x3a71('0xa5')](_0x3a71('0xe9'),0x1)['transition']()[_0x3a71('0xee')](_0x4a42a2[_0x3a71('0xef')])[_0x3a71('0xcd')]();_0x21753e['each'](function(_0x43fc05){var _0x2613be={'d3-exit':0x0};_0x2613be[_0x3a71('0xeb')+_0x43fc05[0x1]]=0x1;d3['select'](this)[_0x3a71('0xa5')](_0x2613be);})[_0x3a71('0x1a')](_0x3a71('0xac'),function(_0x21dbee){return _0x4a42a2[_0x3a71('0xed')](_0x21dbee[0x1]);})[_0x3a71('0xea')]()['duration'](_0x4a42a2[_0x3a71('0xef')])[_0x3a71('0xb0')]('r',_0x4a42a2[_0x3a71('0xf7')])[_0x3a71('0xb0')]('cx',function(_0x48b633){return _0x48b633[0x0]['x'];})['attr']('cy',function(_0x6bc3ad){return _0x6bc3ad[0x0]['y'];})[_0x3a71('0xb8')](_0x3a71('0xf2'),function(){d3['select'](this)[_0x3a71('0xa5')]('d3-enter',0x0);});var _0x5cda88=_0x3ddbbd[_0x3a71('0xa7')]();_0x5cda88[_0x3a71('0xa8')][_0x3a71('0x19')](_0x5cda88);var _0xeb3426=_0xe1491e[_0x3a71('0xa7')]();_0xeb3426[_0x3a71('0xa8')][_0x3a71('0x19')](_0xeb3426);var _0x250030=_0x39aaaa[_0x3a71('0xa7')]();_0x250030['parentNode'][_0x3a71('0x19')](_0x250030);}});}_0x3fd1b4[_0x3a71('0xf8')]=function(_0x38450a){if(!arguments[_0x3a71('0x2c')]){return _0x4a42a2;}if(arguments[_0x3a71('0x2c')]>0x1){_0x4a42a2[arguments[0x0]]=arguments[0x1];}else{d3[_0x3a71('0xf9')](_0x38450a||{})[_0x3a71('0xde')](function(_0x287877){_0x4a42a2[_0x287877[_0x3a71('0xfa')]]=_0x287877[_0x3a71('0x24')];});}return _0x3fd1b4;};return _0x3fd1b4;},'draw':function(_0x108fcb,_0x3cb1e3,_0x3d0c40){var _0x502af5=RadarChart[_0x3a71('0xfb')]()[_0x3a71('0xf8')](_0x3d0c40);var _0x4e51e0=_0x502af5[_0x3a71('0xf8')]();d3[_0x3a71('0xaa')](_0x108fcb)[_0x3a71('0xaa')](_0x3a71('0xfc'))[_0x3a71('0xcd')]();d3['select'](_0x108fcb)[_0x3a71('0xbd')](_0x3a71('0xfc'))['attr']('width',_0x4e51e0['w'])[_0x3a71('0xb0')](_0x3a71('0xb2'),_0x4e51e0['h'])[_0x3a71('0xfd')](_0x3cb1e3)['call'](_0x502af5);}};var ColorOfPriority=[_0x3a71('0xfe'),_0x3a71('0xff'),_0x3a71('0x100'),_0x3a71('0x101'),_0x3a71('0x102'),_0x3a71('0x102'),_0x3a71('0x102'),'silver',_0x3a71('0x102'),_0x3a71('0x102'),'silver'];var ColorOfSubstation=[_0x3a71('0x103'),_0x3a71('0x104'),_0x3a71('0x105'),_0x3a71('0x106'),_0x3a71('0x107'),_0x3a71('0x108'),_0x3a71('0x100'),_0x3a71('0x109'),_0x3a71('0x10a'),_0x3a71('0x10b')];var EventsViewer_ToolbarColor=_0x3a71('0x10c');var EventsViewer_Font=_0x3a71('0x10d');var EventsViewer_TableColor='#E0E0E0';var EventsViewer_GridColor=_0x3a71('0x10e');var EventsViewer_AlmTxtColor=_0x3a71('0x10f');var EventsViewer_FailTxtColor=_0x3a71('0xa2');var EventsViewer_AckTxtColor='#484848';var EventsViewer_ElimTxtColor=_0x3a71('0x110');var EventsViewer_LineColor='#E0E0E0';var EventsViewer_LineColorHighight1='gray';var EventsViewer_LineColorHighight2='black';var EventsViewer_RefreshTime=0xf;var EventsViewer_TimeGPSorLocal=0x2;var EventsViewer_AllowFilter=0x1;var EventsViewer_Notific=0x1;function EventsViewer_NotificationClick(_0x1960d4,_0x657e3f,_0x5119ed){window[_0x3a71('0x27')]('screen.html?SELTELA=../svg/'+_0x5119ed+'.svg','screen','dependent=no,height=1000,width=800,toolbar=no,directories=no,status=no,menubar=no,scrollbars=no,resizable=no,modal=no');}var TabularViewer_ToolbarColor='#AA9E97';var TabularViewer_Font=_0x3a71('0x10d');var TabularViewer_TableColor='#DCDCEE';var TabularViewer_GridColor=_0x3a71('0x111');var TabularViewer_AlmTxtColor=_0x3a71('0x10f');var TabularViewer_FailTxtColor=_0x3a71('0xa2');var TabularViewer_AckTxtColor=_0x3a71('0x112');var TabularViewer_LineColor='#DCDCEE';var TabularViewer_LineColorDestaq1=_0x3a71('0x113');var TabularViewer_LineColorDestaq2='black';var TabularViewer_RefreshTime=0x7;var ScreenViewer_RefreshTime=0x8;var ScreenViewer_SVGMaxWidth=0x960;var ScreenViewer_SVGMaxHeight=0x5dc;var ScreenViewer_Background='#DDDDDD';var ScreenViewer_ToolbarColor=_0x3a71('0x1c');var ScreenViewer_RelationColor=_0x3a71('0xfe');var ScreenViewer_TagFillColor=_0x3a71('0xff');var ScreenViewer_TagStrokeColor=_0x3a71('0xfe');var ScreenViewer_TagInhAlmFillColor=_0x3a71('0x114');var ScreenViewer_TagInhAlmStrokeColor=_0x3a71('0x115');var ScreenViewer_DateColor=_0x3a71('0xa2');var ScreenViewer_TimeMachineDateColor='black';var ScreenViewer_TimeMachineBgColor='green';var ScreenViewer_AlmBoxTableColor=_0x3a71('0x116');var ScreenViewer_AlmBoxGridColor='whitesmoke';var ScreenViewer_BarBreakerSwColor=_0x3a71('0x117');var ScreenViewer_ShowScreenNameTB=0x1;var ScreenViewer_ColorTable=new Array();ScreenViewer_ColorTable[0x0]=_0x3a71('0xa2');ScreenViewer_ColorTable[0x1]=_0x3a71('0xa2');ScreenViewer_ColorTable[0x2]=_0x3a71('0xa2');ScreenViewer_ColorTable[0x3]=ScreenViewer_Background;ScreenViewer_ColorTable[0x4]=ScreenViewer_BarBreakerSwColor;ScreenViewer_ColorTable[0x5]=ScreenViewer_BarBreakerSwColor;ScreenViewer_ColorTable[0x6]=_0x3a71('0x118');ScreenViewer_ColorTable[0x7]=_0x3a71('0x118');ScreenViewer_ColorTable[0x8]=ScreenViewer_BarBreakerSwColor;ScreenViewer_ColorTable[0x9]='#AAAAAA';ScreenViewer_ColorTable[0xa]=_0x3a71('0x103');ScreenViewer_ColorTable[0xb]=_0x3a71('0xfe');ScreenViewer_ColorTable[0xc]='white';ScreenViewer_ColorTable[0xd]=ScreenViewer_BarBreakerSwColor;ScreenViewer_ColorTable[0xe]=ScreenViewer_BarBreakerSwColor;ScreenViewer_ColorTable[0xf]=_0x3a71('0x119');ScreenViewer_ColorTable[0x10]=ScreenViewer_BarBreakerSwColor;ScreenViewer_ColorTable[0x11]=ScreenViewer_BarBreakerSwColor;ScreenViewer_ColorTable[0x12]=ScreenViewer_BarBreakerSwColor;ScreenViewer_ColorTable[0x13]=ScreenViewer_BarBreakerSwColor;ScreenViewer_ColorTable[0x14]=_0x3a71('0x103');ScreenViewer_ColorTable[0x15]=_0x3a71('0x103');ScreenViewer_ColorTable[0x16]='cadetblue';ScreenViewer_ColorTable[0x17]=_0x3a71('0x103');ScreenViewer_ColorTable[0x18]=_0x3a71('0x103');ScreenViewer_ColorTable[0x19]=ScreenViewer_BarBreakerSwColor;ScreenViewer_ColorTable[0x1a]=_0x3a71('0x113');ScreenViewer_ColorTable[0x1b]='gray';ScreenViewer_ColorTable[0x1c]='darkgreen';ScreenViewer_ColorTable[0x1d]='darkred';ScreenViewer_ColorTable[0x1e]='red';ScreenViewer_ColorTable[0x1f]=_0x3a71('0x11a');ScreenViewer_ColorTable[0x20]=_0x3a71('0x11b');ScreenViewer_ColorTable[0x21]=_0x3a71('0x11c');ScreenViewer_ColorTable[0x22]=_0x3a71('0x113');ScreenViewer_ColorTable[0x23]=ScreenViewer_BarBreakerSwColor;ScreenViewer_ColorTable[0x24]='mediumvioletred';ScreenViewer_ColorTable[0x25]='red';ScreenViewer_ColorTable[0x26]=_0x3a71('0x11d');ScreenViewer_ColorTable[0x27]='#DDE8DD';ScreenViewer_ColorTable[0x28]='yellow';ScreenViewer_ColorTable[0x29]=_0x3a71('0x109');ScreenViewer_ColorTable[0x2a]=_0x3a71('0xfe');ScreenViewer_ColorTable[0x2b]=_0x3a71('0x103');ScreenViewer_ColorTable[0x2c]='red';ScreenViewer_ColorTable[0x2d]='yellow';ScreenViewer_ColorTable[0x2e]=_0x3a71('0x107');ScreenViewer_ColorTable[0x2f]=_0x3a71('0x11e');ScreenViewer_ColorTable[0x30]='#CCCCCC';ScreenViewer_ColorTable[0x31]='#CCCCCC';ScreenViewer_ColorTable[0x32]=_0x3a71('0x11f');ScreenViewer_ColorTable[0x33]='lightsteelblue';ScreenViewer_ColorTable[0x34]=_0x3a71('0x120');ScreenViewer_ColorTable[0x35]=_0x3a71('0x121');ScreenViewer_ColorTable[0x36]='red';ScreenViewer_ColorTable[0x37]=_0x3a71('0x122');ScreenViewer_ColorTable[0x38]=_0x3a71('0x119');ScreenViewer_ColorTable[0x39]=ScreenViewer_BarBreakerSwColor;ScreenViewer_ColorTable[0x3a]=_0x3a71('0x123');ScreenViewer_ColorTable[0x3b]=_0x3a71('0x124');var ScreenViewer_SlideShowInterval=0xa;var ScreenViewer_EnableTimeMachine=0x1;var CommandDialog_Background='wheat';var Viewers_AlmTxtHighlight1=_0x3a71('0x125');var Viewers_IDTxtHighlight2='XCBR';var Viewers_DescrTxtHighlight2=_0x3a71('0x126');var PNTServer='';var TimePNTServer='';var DocAnnotationServer='';_0x3a71('0x127');var L=[];var V=[];var F=[];var T=[];var TAGS=[];var NPTS=[];var SUBS=[];var BAYS=[];var DCRS=[];var ANOTS=[];var STONS=[];var STOFS=[];var Data='';var NUM_VAR=0x0;var HA_ALARMES=0x0;var Sha1Ana='';var Sha1Dig='';var LIMSUPS=[];var LIMINFS=[];var INVTAGS={};var LT='';var VK='';var HA_ALARMES_ANT=0x0;var NUM_VAR_ANT=0x0;var SVGDoc=null;var NPTO=0x0,ID,ESTACAO,MODULO,DESC,ST_ON,ST_OFF,CNPTO,CID,CDESC,CST_ON,CST_OFF;var LIMS,LIMI,HISTER,ALRIN,ANOT,VLNOR,ESTALM,UNIDADE,SIMULACAO=0x0;var ComandoAck='';var ANIMA=0x1;var CLICK_POSX=0x0;var CLICK_POSY=0x0;var ComandoEnviado='';if(!window[_0x3a71('0x2')])(function(){'use strict';function _0x51d5cf(_0x48ed6e){var _0x182091=_0x233bcc(),_0x43fc17=Math['max'](0x0,0x10-(_0x182091-_0x4a111f));_0x4a111f=_0x182091;return setTimeout(function(){_0x4a111f=_0x233bcc();_0x48ed6e(_0x4a111f-_0x20cca0);},_0x43fc17);}function _0x516cb9(_0x3af991){clearTimeout(_0x3af991);}var _0x5b8ddc=_0x3a71('0x3'),_0x22fd5b=_0x3a71('0x128'),_0x4786e8=_0x3a71('0x1'),_0x4b60c6=_0x3a71('0x0'),_0x233bcc=Date[_0x3a71('0x129')]||function(){return new Date()[_0x3a71('0x6')]();},_0x20cca0=_0x233bcc(),_0x4a111f=_0x20cca0;window['requestAnimationFrame']=window[_0x4b60c6+_0x5b8ddc]||window[_0x4786e8+_0x5b8ddc]||_0x51d5cf;window[_0x3a71('0x4')]=window[_0x4b60c6+_0x22fd5b]||window[_0x4786e8+_0x22fd5b]||window[_0x4786e8+_0x3a71('0x5')]||_0x516cb9;}());function LoadImage(_0x7aa37,_0x3c5730){_0x7aa37[_0x3a71('0x12a')]('http://www.w3.org/1999/xlink',_0x3a71('0x10'),_0x3c5730);}function RemoveAnimate(_0x22326a){var _0x27cc2f;if(_0x22326a===null){return;}_0x27cc2f=0x0;while(_0x27cc2f<_0x22326a['childNodes'][_0x3a71('0x2c')]){if(_0x22326a[_0x3a71('0x2d')][_0x27cc2f]['nodeName']==_0x3a71('0x12b')||_0x22326a[_0x3a71('0x2d')][_0x3a71('0x2e')]==_0x3a71('0x12c')||_0x22326a[_0x3a71('0x2d')]['nodeName']==_0x3a71('0x12d')){_0x22326a[_0x3a71('0x12e')](_0x22326a[_0x3a71('0x2d')][_0x27cc2f]);_0x27cc2f=0x0;}else{_0x27cc2f++;}}}function Animate(_0x3b5023,_0xd2ef5d,_0x3c89dc){var _0x1260b4,_0x38a3d7;_0x38a3d7=document['createElementNS'](_0x3a71('0x12f'),_0xd2ef5d);for(_0x1260b4 in _0x3c89dc){if(_0x3c89dc[_0x3a71('0x130')](_0x1260b4)){_0x38a3d7['setAttributeNS'](null,_0x1260b4,_0x3c89dc[_0x1260b4]);}}_0x3b5023[_0x3a71('0x19')](_0x38a3d7);if(typeof _0x38a3d7[_0x3a71('0x131')]!=_0x3a71('0x8f')){_0x38a3d7[_0x3a71('0x132')]();_0x38a3d7[_0x3a71('0x131')]();}}function ShowHideTranslate(_0x42190e,_0x13c0e7,_0x2cef9b){var _0x2251bb,_0x3e6648;_0x13c0e7=_0x13c0e7||0x0;_0x2cef9b=_0x2cef9b||0x0;_0x3e6648=document[_0x3a71('0x133')]('svgdiv')['children'][0x0];if(_0x3e6648===null){return;}if(typeof _0x42190e===_0x3a71('0x134'))_0x2251bb=_0x42190e;else _0x2251bb=_0x3e6648[_0x3a71('0x133')](_0x42190e);if(_0x2251bb===null){return;}if(_0x2251bb[_0x3a71('0x1a')]['display']==='none'){_0x2251bb['style']['display']='block';}else{_0x2251bb['style']['display']='none';}if(typeof _0x2251bb['inittransform']===_0x3a71('0x8f')){_0x2251bb[_0x3a71('0x135')]=_0x2251bb[_0x3a71('0x136')](null,_0x3a71('0xb6'));}if(_0x2251bb[_0x3a71('0x135')]===null){_0x2251bb[_0x3a71('0x135')]='';}if(_0x13c0e7!=0x0||_0x2cef9b!=0x0)_0x2251bb['setAttributeNS'](null,'transform',_0x2251bb[_0x3a71('0x135')]+_0x3a71('0x137')+parseFloat(_0x13c0e7)+'\x20'+parseFloat(_0x2cef9b)+')');}function histdata(_0x62a96b,_0x203136){var _0x512d08,_0x4a04e3;_0x4a04e3=new Date();if(typeof _0x62a96b===_0x3a71('0x8f')){return;}if(!WebSAGE[_0x3a71('0x138')][_0x62a96b][_0x3a71('0x130')](_0x3a71('0x139'))){WebSAGE[_0x3a71('0x138')][_0x62a96b][_0x3a71('0x139')]=[];WebSAGE['InkSage'][_0x62a96b][_0x3a71('0x13a')]=[];}WebSAGE[_0x3a71('0x138')][_0x62a96b]['valores'][_0x203136]=[];WebSAGE[_0x3a71('0x138')][_0x62a96b][_0x3a71('0x13a')][_0x203136]=[];WebSAGE[_0x3a71('0x138')][_0x62a96b][_0x3a71('0x139')][_0x203136]['length']=0x0;WebSAGE[_0x3a71('0x138')][_0x62a96b]['datas'][_0x203136]['length']=0x0;for(_0x512d08 in hvalues){if(hvalues[_0x3a71('0x130')](_0x512d08)){WebSAGE['InkSage'][_0x62a96b][_0x3a71('0x139')][_0x203136][_0x3a71('0x6d')](hvalues[_0x512d08][_0x3a71('0x13b')]);WebSAGE[_0x3a71('0x138')][_0x62a96b][_0x3a71('0x13a')][_0x203136][_0x3a71('0x6d')](hvalues[_0x512d08][_0x3a71('0x13c')]);}}}var WebSAGE={'RemoveAnimate':RemoveAnimate,'Animate':Animate,'ShowHideTranslate':ShowHideTranslate,'LoadImage':LoadImage,'g_remoteServer':PNTServer,'g_timePntServer':TimePNTServer,'g_docAnnotationServer':DocAnnotationServer,'g_isInkscape':![],'g_DirTelas':'./','g_nponto_sup':0x0,'g_win_cmd':{},'g_win_1stdraw':0x0,'g_wait_win':0x0,'g_timerID':0x0,'g_timeoutFalhaID':0x0,'g_timeoutSlideID':0x0,'g_data_ant':'','g_timeOutRefresh':0x3e8*ScreenViewer_RefreshTime,'g_timeOutFalha':0x7530,'g_toutID':0x0,'g_toutStatusID':0x0,'g_blinktimerID':0x0,'g_blinkperiod':0x3e8,'g_blinkcnt':0x0,'g_blinkList':[],'g_blinkListAna':[],'g_blinkListOld':[],'g_blinkListAnaOld':[],'C':[],'T':[],'Pass':0x0,'g_showValsInterval':0x0,'RectFundo':0x0,'g_seltela':0x0,'g_inicio':0x1,'g_MostraQualAna':0x0,'g_Evento':{},'g_travaInfo':0x0,'g_tminfoID':0x0,'g_cntTentativaInfo':0x0,'g_sha1ant_ana':'','g_sha1ant_dig':'','g_hidetoolbar':0x0,'g_timeOutPreview':0x5dc,'g_timerPreviewID':0x0,'g_hasRadar':![],'g_zpX':0x0,'g_zpY':0x0,'g_zpW':0x0,'g_zpH':0x0,'g_obj_onclick':_0x3a71('0x13d'),'g_titulo_janela':'','g_indSelPonto':-0x1,'g_destaqList':[],'g_loadtime':0x0,'g_timeshift':0x0,'g_idprefixes':[],'lstpnt':'','InkSage':[],'SetIniExtended':function(){},'SetExeExtended':function(){},'doNothing':function(){},'getValue':function(_0x23a2e5){return V[_0x23a2e5]||V[NPTS[_0x23a2e5]]||0x0;},'getFlags':function(_0x4cc43d){var _0x3fcb8e=F[_0x4cc43d]||F[NPTS[_0x4cc43d]];if(isNaN(_0x3fcb8e))return 0xa0|(WebSAGE[_0x3a71('0x13e')](_0x4cc43d)==0x0?0x2:0x1);else return _0x3fcb8e;},'getInfLim':function(_0x115406){return LIMINFS[_0x115406]||LIMINFS[NPTS[_0x115406]]||0x0;},'getSupLim':function(_0x59c6b8){return LIMSUPS[_0x59c6b8]||LIMSUPS[NPTS[_0x59c6b8]]||0x0;},'getSubstation':function(_0xfb6464){return SUBS[_0xfb6464]||SUBS[NPTS[_0xfb6464]]||'';},'getBay':function(_0x6656a9){return BAYS[_0x6656a9]||BAYS[NPTS[_0x6656a9]]||'';},'getDescription':function(_0x574569){return DCRS[_0x574569]||DCRS[NPTS[_0x574569]]||'';},'getTime':function(_0x371f6c){return T[_0x371f6c]||T[NPTS[_0x371f6c]]||0x0;},'init_svg':function(_0x486e95){},'lista_telas':function(_0x590b2a,_0x4cb119){},'getScript':function(_0x10b839,_0x435f3e,_0x24e441){_0x435f3e=_0x435f3e||'';_0x24e441=_0x24e441||null;if(_0x435f3e!='')$[_0x3a71('0x13f')]({'url':_0x10b839,'dataType':_0x3a71('0xab'),'data':_0x435f3e,'type':'POST','success':WebSAGE[_0x3a71('0x140')],'timeout':_0x24e441});else $[_0x3a71('0x13f')]({'url':_0x10b839,'dataType':_0x3a71('0xab'),'success':WebSAGE[_0x3a71('0x140')],'timeout':_0x24e441});},'onSuccess':function(_0x460631){eval(_0x460631);_0x460631=null;},'tooltipRelac':function(_0x9ec3d5,_0x29fd7c){if(_0x29fd7c==0x0||_0x29fd7c==0x1869f||_0x29fd7c==0x18695||_0x9ec3d5[_0x3a71('0x141')])return;setTimeout(function(){if(_0x9ec3d5[_0x3a71('0x141')]||_0x9ec3d5[_0x3a71('0xa8')][_0x3a71('0x141')])return;var _0x180c26=_0x29fd7c;if(isNaN(parseInt(_0x29fd7c)))_0x180c26=NPTS[_0x29fd7c];var _0x3ad098=document[_0x3a71('0x142')](_0x3a71('0x12f'),'title');_0x3ad098[_0x3a71('0x143')]=_0x3a71('0x144')+TAGS[_0x180c26]+'\x0a'+_0x3a71('0x145')+DCRS[_0x180c26]+'\x0a'+'Value:\x20'+V[_0x180c26];_0x9ec3d5[_0x3a71('0x19')](_0x3ad098);_0x9ec3d5[_0x3a71('0x141')]=0x1;_0x9ec3d5['autoTooltip']=0x1;},0x1388);},'atalhosTela':function(){},'cmdWriteById':function(_0x40e25f,_0x5e93a4,_0xfd2ca4){_0x40e25f['$']('#'+_0x5e93a4)['text'](_0xfd2ca4);},'acrescentaPontoLista':function(_0x48c157){_0x48c157=_0x48c157[_0x3a71('0x38')]();if(_0x48c157[_0x3a71('0x3d')](_0x3a71('0x146'))===0x0||_0x48c157[_0x3a71('0x3d')](_0x3a71('0x147'))===0x0||_0x48c157[_0x3a71('0x3d')](_0x3a71('0x148'))===0x0||_0x48c157[_0x3a71('0x3d')](_0x3a71('0x148'))===0x0||_0x48c157[_0x3a71('0x3d')]('!TAG')===0x0||_0x48c157[_0x3a71('0x3d')](_0x3a71('0x149'))===0x0){_0x48c157=_0x48c157[_0x3a71('0x14a')](0x4)[_0x3a71('0x38')]();}else if(_0x48c157['indexOf']('!SLIM')===0x0||_0x48c157[_0x3a71('0x3d')]('!ILIM')===0x0||_0x48c157[_0x3a71('0x3d')]('!STON')===0x0){_0x48c157=_0x48c157[_0x3a71('0x14a')](0x5)[_0x3a71('0x38')]();}else if(_0x48c157[_0x3a71('0x3d')](_0x3a71('0x14b'))===0x0||_0x48c157[_0x3a71('0x3d')](_0x3a71('0x14c'))===0x0){_0x48c157=_0x48c157['substr'](0x6)[_0x3a71('0x38')]();}if(isNaN(parseInt(_0x48c157))){if(typeof NPTS[_0x48c157]!==_0x3a71('0x8f')){_0x48c157=NPTS[_0x48c157];}else{if(_0x48c157[_0x3a71('0x3d')]('!')===0x0||_0x48c157[_0x3a71('0x3d')]('#')===0x0)return 0x0;}}if(WebSAGE['lstpnt'][_0x3a71('0x3d')](','+_0x48c157+',')<0x0&&!(WebSAGE[_0x3a71('0x14d')][_0x3a71('0x3d')](_0x48c157+',')===0x0)){WebSAGE[_0x3a71('0x14d')]=WebSAGE[_0x3a71('0x14d')]+_0x48c157+',';}return _0x48c157;},'janelaInfo':function(_0x519e5f){},'showValsInfo0':function(){},'showValsInfo1':function(){},'showValsInfo2':function(_0x54e6a8){},'prejanelaComando':function(_0x36c793){},'janelaComando':function(_0x27f702){},'showValsCmd1':function(){},'showValsCmd2':function(){},'directCommandExec':function(_0x2d7186,_0x5b6154){},'executaComando':function(_0x5a5d1d){},'ackComando':function(){},'writeParams':function(){},'writeAnnotDoc':function(){},'tendencias':function(){},'vis_trend':function(_0x288f54){},'curvas':function(){},'tabular':function(){},'writeValor':function(){},'timerBlink':function(){},'timerBlinkDraw':function(){},'processInvalidTagInElement'(_0x5bd6fb,_0x1816a4){if(!INVTAGS['hasOwnProperty'](_0x5bd6fb)){INVTAGS[_0x5bd6fb]=0x0;}if(_0x1816a4&&_0x1816a4[_0x3a71('0x1a')][_0x3a71('0x14e')]!==_0x3a71('0x14f'))_0x1816a4[_0x3a71('0x1a')][_0x3a71('0x14e')]='collapse';},'valorTagueado':function(_0x2b8860,_0x4cc385){var _0x2eed3=_0x3a71('0x150');var _0x26aa76,_0x1c6a11;if(_0x2b8860==''||typeof _0x2b8860===_0x3a71('0x8f')){return _0x2eed3;}_0x26aa76=parseInt(_0x2b8860);if(!isNaN(_0x26aa76)){if(typeof V[_0x26aa76]===_0x3a71('0x8f')){WebSAGE[_0x3a71('0x151')](_0x2b8860,_0x4cc385);return _0x2eed3;}else{if(typeof _0x4cc385[_0x3a71('0x152')]!==_0x3a71('0x8f')){var _0x3de096=_0x4cc385[_0x3a71('0x18')](_0x3a71('0x153'));if(_0x3de096[_0x3a71('0x2c')]>0x0)_0x3de096[0x0][_0x3a71('0x143')]=_0x3a71('0x144')+TAGS[_0x26aa76]+'\x0a'+_0x3a71('0x145')+DCRS[_0x26aa76]+'\x0a'+_0x3a71('0x154')+V[_0x26aa76];}return V[_0x26aa76];}}_0x2b8860=_0x2b8860[_0x3a71('0x38')]();if(typeof NPTS[_0x2b8860]!=='undefined'){if(_0x4cc385&&_0x4cc385[_0x3a71('0x1a')]['visibility']==='collapse')_0x4cc385['style']['visibility']=_0x3a71('0x155');if(typeof _0x4cc385['autoTooltip']!==_0x3a71('0x8f')){var _0x3de096=_0x4cc385[_0x3a71('0x18')](_0x3a71('0x153'));if(_0x3de096[_0x3a71('0x2c')]>0x0)_0x3de096[0x0][_0x3a71('0x143')]=_0x3a71('0x144')+_0x2b8860+'\x0a'+_0x3a71('0x145')+DCRS[NPTS[_0x2b8860]]+'\x0a'+_0x3a71('0x154')+V[NPTS[_0x2b8860]];}return V[NPTS[_0x2b8860]];}if(_0x4cc385&&_0x4cc385['style'][_0x3a71('0x14e')]==='collapse')_0x4cc385[_0x3a71('0x1a')][_0x3a71('0x14e')]='inherit';if(typeof V[_0x2b8860]!==_0x3a71('0x8f')){return V[_0x2b8860];}if(_0x2b8860[_0x3a71('0x3d')]('#')==0x0||_0x2b8860[_0x3a71('0x3d')]('%')==0x0)return WebSAGE[_0x3a71('0x156')];_0x1c6a11=WebSAGE[_0x3a71('0x157')](_0x26aa76);if(_0x2b8860[_0x3a71('0x3d')](_0x3a71('0x158'))===0x0){_0x26aa76=_0x2b8860[_0x3a71('0x14a')](0x5)[_0x3a71('0x38')]();if(isNaN(parseInt(_0x26aa76)))_0x26aa76=NPTS[_0x26aa76];if(typeof LIMSUPS[_0x26aa76]==='undefined'){return 0xf423f;}return LIMSUPS[_0x26aa76];}if(_0x2b8860[_0x3a71('0x3d')](_0x3a71('0x159'))===0x0){_0x26aa76=_0x2b8860[_0x3a71('0x14a')](0x5)[_0x3a71('0x38')]();if(isNaN(parseInt(_0x26aa76)))_0x26aa76=NPTS[_0x26aa76];if(typeof LIMINFS[_0x26aa76]===_0x3a71('0x8f')){return-0xf423f;}return LIMINFS[_0x26aa76];}if(_0x2b8860['indexOf'](_0x3a71('0x15a'))===0x0){_0x26aa76=_0x2b8860[_0x3a71('0x14a')](0x4)[_0x3a71('0x38')]();if(isNaN(parseInt(_0x26aa76)))_0x26aa76=NPTS[_0x26aa76];if(typeof TAGS[_0x26aa76]==='undefined'){return'';}return TAGS[_0x26aa76];}if(_0x2b8860[_0x3a71('0x3d')]('!DCR')===0x0){_0x26aa76=_0x2b8860[_0x3a71('0x14a')](0x4)[_0x3a71('0x38')]();if(isNaN(parseInt(_0x26aa76)))_0x26aa76=NPTS[_0x26aa76];if(typeof DCRS[_0x26aa76]==='undefined'){return'';}return DCRS[_0x26aa76];}if(_0x2b8860[_0x3a71('0x3d')](_0x3a71('0x15b'))===0x0){_0x26aa76=_0x2b8860['substr'](0x5)['trim']();if(isNaN(parseInt(_0x26aa76)))_0x26aa76=NPTS[_0x26aa76];if(typeof STONS[_0x26aa76]===_0x3a71('0x8f')){return'';}return STONS[_0x26aa76];}if(_0x2b8860['indexOf'](_0x3a71('0x14b'))===0x0){_0x26aa76=_0x2b8860[_0x3a71('0x14a')](0x6)[_0x3a71('0x38')]();if(isNaN(parseInt(_0x26aa76)))_0x26aa76=NPTS[_0x26aa76];if(typeof STOFS[_0x26aa76]==='undefined'){return'';}return STOFS[_0x26aa76];}if(_0x2b8860[_0x3a71('0x3d')](_0x3a71('0x14c'))===0x0){_0x26aa76=_0x2b8860[_0x3a71('0x14a')](0x6)[_0x3a71('0x38')]();if(isNaN(parseInt(_0x26aa76)))_0x26aa76=NPTS[_0x26aa76];if((_0x1c6a11&0x3)===0x2){return STONS[_0x26aa76];}if((_0x1c6a11&0x3)===0x1){return STOFS[_0x26aa76];}if((_0x1c6a11&0x3)===0x0){return'';}if((_0x1c6a11&0x3)===0x3){return'';}}if(_0x2b8860[_0x3a71('0x3d')]('!ALR')===0x0){_0x26aa76=_0x2b8860[_0x3a71('0x14a')](0x4)[_0x3a71('0x38')]();if(isNaN(parseInt(_0x26aa76)))_0x26aa76=NPTS[_0x26aa76];if(typeof _0x1c6a11===_0x3a71('0x8f')){return 0x0;}if(_0x1c6a11&0x100){return 0x1;}else{return 0x0;}}if(_0x2b8860[_0x3a71('0x3d')](_0x3a71('0x146'))===0x0){_0x26aa76=_0x2b8860[_0x3a71('0x14a')](0x3)[_0x3a71('0x38')]();if(isNaN(parseInt(_0x26aa76)))_0x26aa76=NPTS[_0x26aa76];if(typeof _0x1c6a11===_0x3a71('0x8f')){return 0x0;}if(_0x1c6a11&0x800||_0x1c6a11&0x100){return 0x1;}else{return 0x0;}}if(_0x2b8860[_0x3a71('0x3d')](_0x3a71('0x147'))===0x0){_0x26aa76=_0x2b8860[_0x3a71('0x14a')](0x3)['trim']();if(isNaN(parseInt(_0x26aa76)))_0x26aa76=NPTS[_0x26aa76];return getTime(_0x26aa76);}if(_0x2b8860[_0x3a71('0x3d')](_0x3a71('0x15c'))===0x0){_0x26aa76=_0x2b8860['substr'](0x5)[_0x3a71('0x38')]();try{return eval(_0x3a71('0x15d')+_0x4cc385['id']+_0x3a71('0x15e')+_0x26aa76);}catch(_0x6eca6c){WebSAGE[_0x3a71('0x151')](_0x2b8860,_0x4cc385);console[_0x3a71('0x15f')](_0x6eca6c);return _0x2eed3;}}WebSAGE[_0x3a71('0x151')](_0x2b8860,_0x4cc385);return _0x2eed3;},'interpretaFormatoC':function(_0x266134,_0x4f2a81,_0x108596){var _0x47c1a9;_0x47c1a9=WebSAGE[_0x3a71('0x160')](_0x4f2a81,_0x108596);if(_0x47c1a9===_0x3a71('0x150')){return _0x47c1a9;}if(typeof _0x266134=='undefined'){if(isNaN(parseFloat(_0x47c1a9))){_0x266134='%s';}else{_0x266134=_0x3a71('0x161');}}var _0x2662d0=WebSAGE[_0x3a71('0x157')](_0x4f2a81);if(typeof _0x2662d0!='undefined')if(_0x2662d0&0x20){if(_0x266134[_0x3a71('0x162')](/[udrla]\^/)>=0x0){_0x266134=_0x266134[_0x3a71('0xb')]('u^',String[_0x3a71('0x3f')](_0x47c1a9>=0x0?0x2191:0x2193));_0x266134=_0x266134[_0x3a71('0xb')]('d^',String[_0x3a71('0x3f')](_0x47c1a9>=0x0?0x2193:0x2191));_0x266134=_0x266134[_0x3a71('0xb')]('r^',String[_0x3a71('0x3f')](_0x47c1a9>=0x0?0x21a3:0x21a2));_0x266134=_0x266134[_0x3a71('0xb')]('l^',String[_0x3a71('0x3f')](_0x47c1a9>=0x0?0x21a2:0x21a3));_0x266134=_0x266134[_0x3a71('0xb')]('a^','');_0x47c1a9=Math[_0x3a71('0x3c')](_0x47c1a9);}}if(_0x266134[_0x3a71('0x3d')]('%')<0x0){var _0xf673e=_0x266134['split']('`');_0xf673e[0x0]=_0xf673e[0x0][_0x3a71('0xb')]('~','%');return d3['format'](_0xf673e[0x0])(_0x47c1a9)+(_0xf673e[_0x3a71('0x2c')]>0x1?_0xf673e[0x1]:'');}return printf(_0x266134,_0x47c1a9);},'pegaTagClone':function(_0x690b6c,_0x41feee){var _0x29d0af;var _0x8dddd7;var _0x17b5de;var _0x25c5a5;var _0x110df0;if(typeof _0x41feee[_0x3a71('0x163')]!=='undefined'){for(var _0x2ed1ca=0x0;_0x2ed1ca<_0x41feee[_0x3a71('0x163')][_0x3a71('0x2c')];_0x2ed1ca++){if(typeof _0x41feee['list'][_0x2ed1ca]['tag']!=='undefined')if(_0x41feee[_0x3a71('0x163')][_0x2ed1ca][_0x3a71('0x164')]['indexOf']('%')!==-0x1)if(_0x690b6c[_0x3a71('0xa8')][_0x3a71('0x2e')]==='g'){for(_0x29d0af=0x0;_0x29d0af<WebSAGE[_0x3a71('0x138')]['length'];_0x29d0af++){if(WebSAGE[_0x3a71('0x138')][_0x29d0af][_0x3a71('0x165')]['id']===_0x690b6c[_0x3a71('0xa8')]['id']){if(typeof _0x690b6c[_0x3a71('0xa8')][_0x3a71('0x166')]!==_0x3a71('0x8f')){_0x690b6c['noTrace']=_0x690b6c[_0x3a71('0xa8')]['noTrace'];}for(_0x8dddd7=0x0;_0x8dddd7<WebSAGE[_0x3a71('0x138')][_0x29d0af][_0x3a71('0xbf')][_0x3a71('0x2c')];_0x8dddd7++){_0x17b5de=WebSAGE[_0x3a71('0x138')][_0x29d0af][_0x3a71('0xbf')][_0x8dddd7][_0x3a71('0x3d')]('=');_0x25c5a5=WebSAGE[_0x3a71('0x138')][_0x29d0af]['map'][_0x8dddd7]['substring'](0x0,_0x17b5de);_0x110df0=_0x41feee[_0x3a71('0x163')][_0x2ed1ca][_0x3a71('0x164')][_0x3a71('0x3d')]('%');if(_0x25c5a5===_0x41feee[_0x3a71('0x163')][_0x2ed1ca][_0x3a71('0x164')]['substring'](_0x110df0)){_0x41feee['tag']=_0x41feee['list'][_0x2ed1ca]['tag'];_0x41feee[_0x3a71('0x163')][_0x2ed1ca][_0x3a71('0x164')]=_0x41feee[_0x3a71('0x163')][_0x2ed1ca][_0x3a71('0x164')]['substring'](0x0,_0x110df0)+WebSAGE['InkSage'][_0x29d0af]['map'][_0x8dddd7][_0x3a71('0x45')](_0x17b5de+0x1);WebSAGE[_0x3a71('0x138')][_0x29d0af][_0x3a71('0x164')]=_0x41feee['list'][_0x2ed1ca][_0x3a71('0x164')];break;}}break;}}}}}else{if(typeof _0x41feee[_0x3a71('0x164')]!==_0x3a71('0x8f'))if(_0x41feee['tag'][_0x3a71('0x3d')]('%')!==-0x1)if(_0x690b6c[_0x3a71('0xa8')]['nodeName']==='g'){if(typeof _0x690b6c[_0x3a71('0xa8')]['noTrace']!==_0x3a71('0x8f')){_0x690b6c[_0x3a71('0x166')]=_0x690b6c['parentNode']['noTrace'];}for(_0x29d0af=0x0;_0x29d0af<WebSAGE[_0x3a71('0x138')][_0x3a71('0x2c')];_0x29d0af++){if(WebSAGE['InkSage'][_0x29d0af][_0x3a71('0x165')]['id']===_0x690b6c['parentNode']['id']){for(_0x8dddd7=0x0;_0x8dddd7<WebSAGE[_0x3a71('0x138')][_0x29d0af][_0x3a71('0xbf')][_0x3a71('0x2c')];_0x8dddd7++){_0x17b5de=WebSAGE['InkSage'][_0x29d0af][_0x3a71('0xbf')][_0x8dddd7]['indexOf']('=');_0x25c5a5=WebSAGE[_0x3a71('0x138')][_0x29d0af][_0x3a71('0xbf')][_0x8dddd7][_0x3a71('0x45')](0x0,_0x17b5de);_0x110df0=_0x41feee[_0x3a71('0x164')][_0x3a71('0x3d')]('%');if(_0x25c5a5===_0x41feee['tag']['substring'](_0x110df0)){_0x41feee[_0x3a71('0x164')]=_0x41feee[_0x3a71('0x164')][_0x3a71('0x45')](0x0,_0x110df0)+WebSAGE[_0x3a71('0x138')][_0x29d0af][_0x3a71('0xbf')][_0x8dddd7][_0x3a71('0x45')](_0x17b5de+0x1);_0x690b6c[_0x3a71('0x167')]=0x1;break;}}break;}}}if(typeof _0x41feee['src']!==_0x3a71('0x8f'))if(_0x41feee['src']['indexOf']('%')!==-0x1)if(_0x690b6c[_0x3a71('0xa8')][_0x3a71('0x2e')]==='g'){if(typeof _0x690b6c[_0x3a71('0xa8')][_0x3a71('0x166')]!=='undefined'){_0x690b6c['noTrace']=_0x690b6c[_0x3a71('0xa8')][_0x3a71('0x166')];}for(_0x29d0af=0x0;_0x29d0af<WebSAGE[_0x3a71('0x138')][_0x3a71('0x2c')];_0x29d0af++){if(WebSAGE[_0x3a71('0x138')][_0x29d0af][_0x3a71('0x165')]['id']===_0x690b6c[_0x3a71('0xa8')]['id']){for(_0x8dddd7=0x0;_0x8dddd7<WebSAGE[_0x3a71('0x138')][_0x29d0af][_0x3a71('0xbf')][_0x3a71('0x2c')];_0x8dddd7++){_0x17b5de=WebSAGE[_0x3a71('0x138')][_0x29d0af][_0x3a71('0xbf')][_0x8dddd7][_0x3a71('0x3d')]('=');_0x25c5a5=WebSAGE['InkSage'][_0x29d0af][_0x3a71('0xbf')][_0x8dddd7][_0x3a71('0x45')](0x0,_0x17b5de);_0x110df0=_0x41feee[_0x3a71('0x33')][_0x3a71('0x3d')]('%');if(_0x25c5a5===_0x41feee[_0x3a71('0x33')]['substring'](_0x110df0)){_0x41feee[_0x3a71('0x164')]=_0x41feee['src']['substring'](0x0,_0x110df0)+WebSAGE[_0x3a71('0x138')][_0x29d0af][_0x3a71('0xbf')][_0x8dddd7][_0x3a71('0x45')](_0x17b5de+0x1);_0x41feee['src']=_0x41feee['tag'];_0x690b6c[_0x3a71('0x167')]=0x1;break;}}break;}}}if(_0x41feee[_0x3a71('0xb0')]==='tooltips'){for(_0x2ed1ca=0x0;_0x2ed1ca<_0x41feee[_0x3a71('0x168')][_0x3a71('0x2c')];_0x2ed1ca++){if(_0x41feee[_0x3a71('0x168')][_0x2ed1ca]['indexOf'](_0x3a71('0x15c'))!==-0x1)if(_0x41feee[_0x3a71('0x168')][_0x2ed1ca][_0x3a71('0x3d')]('%')!==-0x1)if(_0x690b6c[_0x3a71('0xa8')][_0x3a71('0x2e')]==='g'){if(typeof _0x690b6c[_0x3a71('0xa8')]['noTrace']!==_0x3a71('0x8f')){_0x690b6c[_0x3a71('0x166')]=_0x690b6c['parentNode']['noTrace'];}for(_0x29d0af=0x0;_0x29d0af<WebSAGE['InkSage'][_0x3a71('0x2c')];_0x29d0af++){if(WebSAGE['InkSage'][_0x29d0af][_0x3a71('0x165')]['id']===_0x690b6c[_0x3a71('0xa8')]['id']){for(_0x8dddd7=0x0;_0x8dddd7<WebSAGE['InkSage'][_0x29d0af][_0x3a71('0xbf')]['length'];_0x8dddd7++){_0x17b5de=WebSAGE[_0x3a71('0x138')][_0x29d0af][_0x3a71('0xbf')][_0x8dddd7][_0x3a71('0x3d')]('=');_0x25c5a5=WebSAGE[_0x3a71('0x138')][_0x29d0af][_0x3a71('0xbf')][_0x8dddd7][_0x3a71('0x45')](0x0,_0x17b5de);_0x110df0=_0x41feee[_0x3a71('0x168')][_0x2ed1ca][_0x3a71('0x3d')]('%');if(_0x25c5a5===_0x41feee[_0x3a71('0x168')][_0x2ed1ca][_0x3a71('0x45')](_0x110df0,_0x110df0+_0x25c5a5[_0x3a71('0x2c')])){_0x41feee[_0x3a71('0x168')][_0x2ed1ca]=_0x41feee['param'][_0x2ed1ca][_0x3a71('0x45')](0x0,_0x110df0)+WebSAGE['InkSage'][_0x29d0af][_0x3a71('0xbf')][_0x8dddd7]['substring'](_0x17b5de+0x1)+_0x41feee[_0x3a71('0x168')][_0x2ed1ca][_0x3a71('0x45')](_0x110df0+_0x25c5a5['length']);_0x690b6c[_0x3a71('0x167')]=0x1;break;}}break;}}}}}}},'setGroupDistrib':function(_0x28bd47){var _0x350bac,_0x4c1cc7,_0x1a848d,_0x2b6819,_0x3906ac,_0x270633;for(_0x350bac=0x0;_0x350bac<_0x28bd47[_0x3a71('0x169')][_0x3a71('0x2c')];_0x350bac++){if(_0x350bac>0x0){if(typeof _0x28bd47[_0x3a71('0x169')][_0x350bac][_0x3a71('0x135')]===_0x3a71('0x8f')){_0x28bd47['children'][_0x350bac][_0x3a71('0x135')]=_0x28bd47['children'][_0x350bac][_0x3a71('0x136')](null,_0x3a71('0xb6'));}_0x1a848d=_0x28bd47[_0x3a71('0x169')][_0x350bac][_0x3a71('0x16a')]();if(typeof _0x28bd47[_0x3a71('0x169')][_0x350bac]['lastXlate']===_0x3a71('0x8f')){_0x28bd47['children'][_0x350bac][_0x3a71('0x16b')]=0x0;}if(_0x28bd47[_0x3a71('0x16c')]===_0x3a71('0x16d')){_0x3906ac=parseFloat(_0x2b6819-_0x1a848d[_0x3a71('0x16e')]+_0x28bd47['groupDistribSpacing'])+_0x28bd47[_0x3a71('0x169')][_0x350bac]['lastXlate'];_0x270633=_0x3a71('0x16f')+_0x3906ac+')';}else{_0x3906ac=parseFloat(_0x4c1cc7-_0x1a848d[_0x3a71('0xd7')]+_0x28bd47[_0x3a71('0x170')])+_0x28bd47[_0x3a71('0x169')][_0x350bac][_0x3a71('0x16b')];_0x270633='\x20translate('+_0x3906ac+_0x3a71('0x171');}_0x28bd47[_0x3a71('0x169')][_0x350bac][_0x3a71('0x12a')](null,'transform',_0x28bd47[_0x3a71('0x169')][_0x350bac][_0x3a71('0x135')]+_0x270633);_0x28bd47['children'][_0x350bac][_0x3a71('0x16b')]=_0x3906ac;}_0x1a848d=_0x28bd47[_0x3a71('0x169')][_0x350bac]['getBoundingClientRect']();_0x4c1cc7=_0x1a848d[_0x3a71('0xd8')];_0x2b6819=_0x1a848d[_0x3a71('0x172')];_0x28bd47['children'][_0x350bac][_0x3a71('0x173')]=0x1;}},'setPreview':function(_0x49da4e,_0x57000e,_0x499912,_0x29deaa){},'le_inkscapeSAGETags':function(_0x3795cd){var _0x1ff402=_0x3795cd[_0x3a71('0x136')](null,'inkscape:label')||_0x3795cd[_0x3a71('0x136')]('http://www.inkscape.org/namespaces/inkscape',_0x3a71('0x174'));var _0x9d67b0,_0x4ea54e,_0x288334,_0x5934b9,_0x29d01f,_0x4735ee;var _0x16b919,_0x31df80,_0x14e2ba,_0x3d9c67,_0x145d43;var _0xf25559,_0x4f39d9,_0x345047,_0x27716f,_0x10da99,_0x14b5eb,_0x5b5567,_0x1f6269,_0x32865f;var _0x65cb1c;var _0x2a9819=[];var _0x57f99d;var _0x5c0966,_0xadcb17;if(_0x1ff402===null){return;}if(_0x1ff402==''){return;}if(typeof _0x1ff402!=_0x3a71('0x8f')){try{while((_0x5c0966=_0x1ff402[_0x3a71('0x3d')]('$$#'))>=0x0){_0xadcb17=_0x1ff402[_0x3a71('0x14a')](_0x5c0966);_0x1ff402=_0x1ff402[_0x3a71('0x14a')](0x0,_0x5c0966)+WebSAGE[_0x3a71('0x175')][parseInt(_0x1ff402[_0x3a71('0x14a')](_0x5c0966+0x3))-0x1]+_0xadcb17[_0x3a71('0x14a')](_0xadcb17['indexOf']('_')+0x1);}_0x288334=JSON[_0x3a71('0x176')]('['+_0x1ff402+']');}catch(_0x308909){return;}for(_0x9d67b0=0x0;_0x9d67b0<_0x288334[_0x3a71('0x2c')];_0x9d67b0++){_0x288334[_0x9d67b0]['parent']=_0x3795cd;WebSAGE['pegaTagClone'](_0x3795cd,_0x288334[_0x9d67b0]);if(typeof _0x288334[_0x9d67b0][_0x3a71('0x164')]!=_0x3a71('0x8f')){_0x4ea54e=WebSAGE[_0x3a71('0x177')](_0x288334[_0x9d67b0]['tag']);if(_0x4ea54e!==0x1869f&&_0x4ea54e!==0x0)if(typeof _0x3795cd['blockPopup']==_0x3a71('0x8f'))if(_0x3795cd[_0x3a71('0x178')]==undefined){WebSAGE[_0x3a71('0x179')](_0x3795cd,_0x4ea54e);if(_0x3795cd['style']!==null){_0x3795cd['style'][_0x3a71('0x17a')]=_0x3a71('0x17b');}}}switch(_0x288334[_0x9d67b0][_0x3a71('0xb0')]){case'set':switch(_0x288334[_0x9d67b0][_0x3a71('0x164')]){case _0x3a71('0x17c'):if(_0x3795cd[_0x3a71('0x17d')]!=='rect')break;if(!WebSAGE[_0x3a71('0x17e')]){WebSAGE[_0x3a71('0x17e')]=!![];}_0x3795cd['style'][_0x3a71('0x1b')]=_0x3a71('0x1c');_0x3795cd[_0x3a71('0x17f')]=[{'className':'radar','axes':[{'axis':_0x3a71('0x180'),'value':0x1},{'axis':_0x3a71('0x180'),'value':0x1},{'axis':'med','value':0x1},{'axis':_0x3a71('0x180'),'value':0x1},{'axis':_0x3a71('0x180'),'value':0x1},{'axis':_0x3a71('0x180'),'value':0x1},{'axis':_0x3a71('0x180'),'value':0x1},{'axis':_0x3a71('0x180'),'value':0x1},{'axis':_0x3a71('0x180'),'value':0x1},{'axis':_0x3a71('0x180'),'value':0x1},{'axis':_0x3a71('0x180'),'value':0x1},{'axis':_0x3a71('0x180'),'value':0x1},{'axis':_0x3a71('0x180'),'value':0x1},{'axis':_0x3a71('0x180'),'value':0x1},{'axis':'med','value':0x1},{'axis':_0x3a71('0x180'),'value':0x1},{'axis':_0x3a71('0x180'),'value':0x1},{'axis':_0x3a71('0x180'),'value':0x1},{'axis':_0x3a71('0x180'),'value':0x1},{'axis':_0x3a71('0x180'),'value':0x1},{'axis':_0x3a71('0x180'),'value':0x1}]}];_0x3795cd[_0x3a71('0x181')]=_0x288334[_0x9d67b0][_0x3a71('0x33')][_0x3a71('0x40')](',');for(_0x5934b9=0x0;_0x5934b9<_0x3795cd[_0x3a71('0x181')][_0x3a71('0x2c')];_0x5934b9++){WebSAGE[_0x3a71('0x177')](_0x3795cd['pnts'][_0x5934b9]);}_0x3795cd['dta'][0x0]['axes'][_0x3a71('0x182')](0x0,_0x3795cd[_0x3a71('0x17f')][0x0][_0x3a71('0xdf')][_0x3a71('0x2c')]-_0x3795cd[_0x3a71('0x181')][_0x3a71('0x2c')]);_0x3795cd[_0x3a71('0xfb')]=RadarChart['chart']();var _0x10b4bd={};if(_0x288334[_0x9d67b0]['prompt']!==''){_0x10b4bd=JSON[_0x3a71('0x176')](_0x288334[_0x9d67b0][_0x3a71('0x183')]);}_0x10b4bd['w']=_0x3795cd['getAttributeNS'](null,_0x3a71('0xb1'));_0x10b4bd['h']=_0x3795cd[_0x3a71('0x136')](null,_0x3a71('0xb2'));_0x10b4bd[_0x3a71('0xed')]=d3[_0x3a71('0x9e')]['ordinal']()[_0x3a71('0xc9')]([_0x3795cd[_0x3a71('0x1a')]['fill']]);_0x3795cd['chart']['config'](_0x10b4bd);var _0x29ea5a=d3['select'](SVGDoc);_0x3795cd[_0x3a71('0x184')]=_0x29ea5a[_0x3a71('0xaa')]('#'+SVGDoc[_0x3a71('0x133')](_0x3795cd['id'])[_0x3a71('0xa8')]['id'])[_0x3a71('0xbd')]('g')[_0x3a71('0xfd')](_0x3795cd[_0x3a71('0x17f')])['call'](_0x3795cd[_0x3a71('0xfb')]);_0x3795cd['cht'][0x0][0x0][_0x3a71('0x12a')](null,_0x3a71('0xb6'),(_0x3795cd['getAttributeNS'](null,_0x3a71('0xb6'))||'')+_0x3a71('0x137')+_0x3795cd[_0x3a71('0x136')](null,'x')+'\x20'+_0x3795cd[_0x3a71('0x136')](null,'y')+')\x20');break;case _0x3a71('0x185'):case _0x3a71('0x186'):try{function _0x2fd48f(_0x31df80){var _0x9d67b0=null;return eval(_0x31df80);}_0x2fd48f(_0x3a71('0x15d')+_0x3795cd['id']+_0x3a71('0x15e')+_0x288334[_0x9d67b0][_0x3a71('0x33')]);}catch(_0x1e1926){}break;case _0x3a71('0x187'):break;case'#copy_xsac_from':if(_0x288334[_0x9d67b0][_0x3a71('0x33')]!=''){_0x31df80=_0x288334[_0x9d67b0][_0x3a71('0x33')][_0x3a71('0x40')](',');for(_0x5934b9=0x0;_0x5934b9<_0x31df80[_0x3a71('0x2c')];_0x5934b9++){_0x57f99d=SVGDoc['getElementById'](_0x31df80[_0x5934b9]);if(_0x57f99d!==null){_0x14e2ba=_0x57f99d[_0x3a71('0x136')](null,_0x3a71('0x188'))||_0x57f99d[_0x3a71('0x136')](_0x3a71('0x189'),_0x3a71('0x174'));if(_0x14e2ba!=''){_0x3795cd[_0x3a71('0x18a')](_0x3a71('0x188'),_0x14e2ba);WebSAGE['le_inkscapeSAGETags'](_0x3795cd);}}else{}}}break;case _0x3a71('0x18b'):{_0x32865f=parseFloat(_0x288334[_0x9d67b0][_0x3a71('0x33')]);if(isNaN(_0x32865f)){_0x3795cd[_0x3a71('0x170')]=0x0;}else{_0x3795cd[_0x3a71('0x170')]=_0x32865f;}if(_0x288334[_0x9d67b0][_0x3a71('0x183')]===_0x3a71('0x16d')){_0x3795cd[_0x3a71('0x16c')]=_0x3a71('0x16d');}else{_0x3795cd[_0x3a71('0x16c')]=_0x3a71('0x18c');}WebSAGE[_0x3a71('0x18d')](_0x3795cd);}break;default:WebSAGE[_0x3a71('0x18e')](_0x288334,_0x9d67b0,_0x3795cd);break;}break;case _0x3a71('0x18f'):if(_0x288334[_0x9d67b0]['src']['indexOf'](_0x3a71('0x190'))===0x0){WebSAGE[_0x3a71('0x191')](_0x3795cd,_0x288334[_0x9d67b0]['src'][_0x3a71('0x14a')](0x8),_0x288334[_0x9d67b0][_0x3a71('0xb1')],_0x288334[_0x9d67b0][_0x3a71('0xb2')]);}else if(_0x288334[_0x9d67b0][_0x3a71('0x33')]===_0x3a71('0x32')){_0x3795cd['setAttributeNS'](null,_0x3a71('0x192'),null);if(_0x3795cd['style']!=null){_0x3795cd[_0x3a71('0x1a')][_0x3a71('0x17a')]='';}_0x3795cd[_0x3a71('0x193')]=0x1;_0x3795cd[_0x3a71('0x166')]=0x1;}else if(_0x288334[_0x9d67b0][_0x3a71('0x33')]==='notrace'){_0x3795cd[_0x3a71('0x166')]=0x1;}else{_0x4ea54e=WebSAGE[_0x3a71('0x177')](_0x288334[_0x9d67b0][_0x3a71('0x33')]);WebSAGE['tooltipRelac'](_0x3795cd,_0x4ea54e);if(_0x3795cd[_0x3a71('0x1a')]!==null||typeof _0x3795cd[_0x3a71('0x1a')]==='undefined'){_0x3795cd['style'][_0x3a71('0x17a')]='pointer';}_0x3795cd[_0x3a71('0x178')]=_0x4ea54e;}break;case _0x3a71('0x194'):if(_0x288334[_0x9d67b0][_0x3a71('0x165')]['firstElementChild'][_0x3a71('0x143')][_0x3a71('0x3d')]('|')>=0x0){_0x288334[_0x9d67b0][_0x3a71('0x195')]=_0x288334[_0x9d67b0][_0x3a71('0x165')][_0x3a71('0x196')][_0x3a71('0x143')][_0x3a71('0x40')]('|');}else{_0x288334[_0x9d67b0][_0x3a71('0x197')]=_0x288334[_0x9d67b0][_0x3a71('0x165')][_0x3a71('0x196')]['textContent'];_0x4ea54e=_0x288334[_0x9d67b0][_0x3a71('0x164')];}break;case'color':if(_0x3795cd[_0x3a71('0x1a')]!==null){_0x288334[_0x9d67b0][_0x3a71('0x198')]=_0x3795cd['style'][_0x3a71('0xac')];_0x288334[_0x9d67b0][_0x3a71('0x199')]=_0x3795cd[_0x3a71('0x1a')][_0x3a71('0xec')];}else{_0x288334[_0x9d67b0][_0x3a71('0x198')]='';_0x288334[_0x9d67b0]['initstroke']='';}for(_0x5934b9=0x0;_0x5934b9<_0x288334[_0x9d67b0][_0x3a71('0x163')][_0x3a71('0x2c')];_0x5934b9++){_0x4ea54e=WebSAGE[_0x3a71('0x177')](_0x288334[_0x9d67b0][_0x3a71('0x163')][_0x5934b9]['tag']);_0x288334[_0x9d67b0]['list'][_0x5934b9][_0x3a71('0x19a')]='';_0x288334[_0x9d67b0][_0x3a71('0x163')][_0x5934b9]['cfill']='';_0x288334[_0x9d67b0][_0x3a71('0x163')][_0x5934b9][_0x3a71('0x19b')]='';_0x288334[_0x9d67b0]['list'][_0x5934b9][_0x3a71('0x19c')]='';_0x288334[_0x9d67b0][_0x3a71('0x163')][_0x5934b9]['cattribval']='';if(_0x288334[_0x9d67b0][_0x3a71('0x163')][_0x5934b9][_0x3a71('0x168')]['indexOf'](_0x3a71('0x19d'))===0x0){_0x2a9819=_0x288334[_0x9d67b0]['list'][_0x5934b9][_0x3a71('0x168')][_0x3a71('0x14a')](0x8)[_0x3a71('0x40')]('=');if(_0x2a9819[_0x3a71('0x2c')]>0x1){_0x288334[_0x9d67b0][_0x3a71('0x163')][_0x5934b9][_0x3a71('0x19c')]=_0x2a9819[0x0];_0x288334[_0x9d67b0][_0x3a71('0x163')][_0x5934b9][_0x3a71('0x19e')]=_0x2a9819[0x1];}}else if(_0x288334[_0x9d67b0][_0x3a71('0x163')][_0x5934b9][_0x3a71('0x168')]['indexOf'](_0x3a71('0x19f'))===0x0){_0x288334[_0x9d67b0][_0x3a71('0x163')][_0x5934b9][_0x3a71('0x19a')]=_0x288334[_0x9d67b0][_0x3a71('0x163')][_0x5934b9][_0x3a71('0x168')][_0x3a71('0x14a')](0x8);}else{_0x3d9c67=[];_0x3d9c67=_0x288334[_0x9d67b0][_0x3a71('0x163')][_0x5934b9][_0x3a71('0x168')][_0x3a71('0x40')]('|');_0x288334[_0x9d67b0][_0x3a71('0x163')][_0x5934b9][_0x3a71('0x1a0')]=WebSAGE[_0x3a71('0x1a1')](_0x3d9c67[0x0]);if(_0x3d9c67['length']>0x1){_0x288334[_0x9d67b0][_0x3a71('0x163')][_0x5934b9][_0x3a71('0x19b')]=WebSAGE[_0x3a71('0x1a1')](_0x3d9c67[0x1]);}else{_0x288334[_0x9d67b0][_0x3a71('0x163')][_0x5934b9][_0x3a71('0x19b')]=_0x288334[_0x9d67b0][_0x3a71('0x163')][_0x5934b9][_0x3a71('0x1a0')];}}if(_0x4ea54e!=0x1869f)if(typeof _0x3795cd[_0x3a71('0x193')]==_0x3a71('0x8f'))if(_0x3795cd[_0x3a71('0x178')]===undefined)if(_0x5934b9===0x0){WebSAGE['tooltipRelac'](_0x3795cd,_0x4ea54e);if(_0x3795cd[_0x3a71('0x1a')]!==null){_0x3795cd['style'][_0x3a71('0x17a')]=_0x3a71('0x17b');}}}break;case _0x3a71('0x1a2'):_0x288334[_0x9d67b0][_0x3a71('0x1a3')]=_0x3795cd[_0x3a71('0x136')](null,'height');break;case _0x3a71('0x1a4'):break;case _0x3a71('0x27'):if(_0x288334[_0x9d67b0][_0x3a71('0x1a5')]==0x0){if(_0x288334[_0x9d67b0][_0x3a71('0x33')][_0x3a71('0x3d')]('new:')===0x0){_0x3795cd['style'][_0x3a71('0x17a')]='pointer';_0x3795cd[_0x3a71('0x12a')](null,_0x3a71('0x192'),'window.open(\x20\x27'+_0x288334[_0x9d67b0][_0x3a71('0x33')][_0x3a71('0x14a')](0x4)+'\x27,\x27\x27,\x27dependent=yes,height='+_0x288334[_0x9d67b0]['height']+_0x3a71('0x1a6')+_0x288334[_0x9d67b0]['width']+_0x3a71('0x1a7'));}else if(_0x288334[_0x9d67b0]['src'][_0x3a71('0x3d')](_0x3a71('0x190'))===0x0){WebSAGE['setPreview'](_0x3795cd,_0x288334[_0x9d67b0][_0x3a71('0x33')][_0x3a71('0x14a')](0x8),_0x288334[_0x9d67b0][_0x3a71('0xb1')],_0x288334[_0x9d67b0][_0x3a71('0xb2')]);}else{}}else{if(_0x3795cd[_0x3a71('0x17d')]===_0x3a71('0xaf')){_0x288334[_0x9d67b0][_0x3a71('0x1a8')]=document['createElementNS']('http://www.w3.org/2000/svg',_0x3a71('0xe4'));_0x3795cd[_0x3a71('0xa8')][_0x3a71('0x19')](_0x288334[_0x9d67b0]['grafico']);_0x288334[_0x9d67b0][_0x3a71('0x1a8')]['setAttributeNS'](null,_0x3a71('0x1a'),_0x3a71('0x1a9'));_0x65cb1c=_0x3795cd['getAttributeNS'](null,'transform');if(_0x65cb1c!=null){_0x288334[_0x9d67b0][_0x3a71('0x1a8')][_0x3a71('0x12a')](null,'transform',_0x65cb1c);}if(_0x3795cd[_0x3a71('0x1a')]!=undefined){if(_0x3795cd[_0x3a71('0x1a')][_0x3a71('0x1aa')]!=''){_0x288334[_0x9d67b0]['grafico'][_0x3a71('0x1a')][_0x3a71('0x1aa')]=_0x3795cd[_0x3a71('0x1a')]['strokeWidth'];}if(_0x3795cd[_0x3a71('0x1a')][_0x3a71('0xec')]!=''){_0x288334[_0x9d67b0]['grafico'][_0x3a71('0x1a')][_0x3a71('0xec')]=_0x3795cd[_0x3a71('0x1a')][_0x3a71('0xec')];}}_0x16b919=_0x288334[_0x9d67b0][_0x3a71('0x33')][_0x3a71('0x40')]('|');_0x288334[_0x9d67b0]['tag']=_0x16b919[0x0];if(typeof _0x16b919[0x1]!=_0x3a71('0x8f')){if(_0x16b919[0x1][_0x3a71('0x38')]()!=''){_0x288334[_0x9d67b0][_0x3a71('0x1a8')][_0x3a71('0x12a')](null,'style',_0x16b919[0x1]);}}_0x288334[_0x9d67b0][_0x3a71('0x139')]=[];_0x288334[_0x9d67b0]['datas']=[];_0x288334[_0x9d67b0]['bb']=_0x3795cd[_0x3a71('0xae')]();_0x288334[_0x9d67b0]['bb']['left']=_0x288334[_0x9d67b0]['bb']['x'];_0x288334[_0x9d67b0]['bb'][_0x3a71('0xd8')]=_0x288334[_0x9d67b0]['bb']['x']+_0x288334[_0x9d67b0]['bb'][_0x3a71('0xb1')];_0x288334[_0x9d67b0]['bb'][_0x3a71('0x16e')]=_0x288334[_0x9d67b0]['bb']['y'];_0x288334[_0x9d67b0]['bb'][_0x3a71('0x172')]=_0x288334[_0x9d67b0]['bb']['y']+_0x288334[_0x9d67b0]['bb']['height'];_0x4ea54e=WebSAGE[_0x3a71('0x177')](_0x288334[_0x9d67b0][_0x3a71('0x164')]);if(typeof _0x3795cd['blockPopup']==_0x3a71('0x8f'))if(_0x3795cd[_0x3a71('0x178')]==undefined){WebSAGE[_0x3a71('0x179')](_0x3795cd,_0x4ea54e);if(_0x3795cd[_0x3a71('0x1a')]!=null){_0x3795cd[_0x3a71('0x1a')][_0x3a71('0x17a')]=_0x3a71('0x17b');}}if(_0x288334[_0x9d67b0][_0x3a71('0xb1')]>0x0){_0x288334[_0x9d67b0][_0x3a71('0x1ab')]=new Date()['getTime']()-Math[_0x3a71('0x3c')](_0x288334[_0x9d67b0][_0x3a71('0xb1')])*0x3e8;_0xf25559=_0x3a71('0x1ac')+_0x288334[_0x9d67b0][_0x3a71('0x164')]+_0x3a71('0x1ad')+_0x288334[_0x9d67b0]['dataini']/0x3e8+_0x3a71('0x1ae')+_0x288334[_0x9d67b0]['x']+_0x3a71('0x1af')+_0x3a71('0x1b0')+WebSAGE['InkSage'][_0x3a71('0x2c')]+',\x27'+_0x288334[_0x9d67b0]['tag']+_0x3a71('0x1b1')+'\x22'+_0x3a71('0x1b2');}else{var _0x2fe372=new Date();_0x288334[_0x9d67b0][_0x3a71('0x1ab')]=_0x2fe372[_0x3a71('0x6')]()-_0x2fe372['getTime']()%(Math[_0x3a71('0x3c')](_0x288334[_0x9d67b0][_0x3a71('0xb1')])*0x3e8)+_0x2fe372[_0x3a71('0x1b3')]()*0x3c*0x3e8%(Math['abs'](_0x288334[_0x9d67b0][_0x3a71('0xb1')])*0x3e8);_0x288334[_0x9d67b0]['datafim']=_0x288334[_0x9d67b0][_0x3a71('0x1ab')]+Math[_0x3a71('0x3c')](_0x288334[_0x9d67b0][_0x3a71('0xb1')]*0x3e8);_0xf25559=_0x3a71('0x1ac')+_0x288334[_0x9d67b0][_0x3a71('0x164')]+_0x3a71('0x1ad')+_0x288334[_0x9d67b0]['dataini']/0x3e8+_0x3a71('0x1ae')+_0x288334[_0x9d67b0]['x']+_0x3a71('0x1af')+_0x3a71('0x1b0')+WebSAGE[_0x3a71('0x138')][_0x3a71('0x2c')]+',\x27'+_0x288334[_0x9d67b0][_0x3a71('0x164')]+_0x3a71('0x1b1')+'\x22'+_0x3a71('0x1b2');}WebSAGE[_0x3a71('0x1b4')]=WebSAGE['g_timeshift']+0x7d0;}}break;case'rotate':if(_0x3795cd['getAttributeNS'](null,_0x3a71('0xb6'))===null){_0x288334[_0x9d67b0][_0x3a71('0x135')]='';}else{_0x288334[_0x9d67b0]['inittransform']=_0x3795cd[_0x3a71('0x136')](null,_0x3a71('0xb6'));}break;case _0x3a71('0x1b5'):_0x345047='';for(_0x5934b9=0x0;_0x5934b9<_0x288334[_0x9d67b0][_0x3a71('0x168')][_0x3a71('0x2c')];_0x5934b9++){if(_0x5934b9>0x0){_0x345047=_0x345047+'\x0a';}_0x345047=_0x345047+_0x288334[_0x9d67b0][_0x3a71('0x168')][_0x5934b9];}_0x4f39d9=document[_0x3a71('0x142')](_0x3a71('0x12f'),_0x3a71('0x153'));_0x27716f=document[_0x3a71('0x1b6')](_0x345047);_0x4f39d9[_0x3a71('0x19')](_0x27716f);_0x3795cd[_0x3a71('0x19')](_0x4f39d9);_0x3795cd[_0x3a71('0x141')]=0x1;if(_0x345047[_0x3a71('0x3d')](_0x3a71('0x15c'))!==-0x1){_0x288334[_0x9d67b0]['hasActiveTooltip']=0x1;_0x288334[_0x9d67b0]['tooltipTitle']=_0x4f39d9;_0x288334[_0x9d67b0]['tooltipText']=_0x345047;}break;case'slider':if(_0x3795cd['getAttributeNS'](null,_0x3a71('0xb6'))===null){_0x288334[_0x9d67b0][_0x3a71('0x135')]='';}else{_0x288334[_0x9d67b0]['inittransform']=_0x3795cd[_0x3a71('0x136')](null,'transform');}_0x288334[_0x9d67b0][_0x3a71('0xc5')]=parseFloat(_0x288334[_0x9d67b0][_0x3a71('0xc5')]);_0x288334[_0x9d67b0][_0x3a71('0x7')]=parseFloat(_0x288334[_0x9d67b0][_0x3a71('0x7')]);_0x10da99=undefined;_0x14b5eb=SVGDoc['getElementsByTagName'](_0x3a71('0x1b7'));for(_0x29d01f=0x0;_0x29d01f<_0x14b5eb['length'];_0x29d01f++){if(_0x14b5eb['item'](_0x29d01f)[_0x3a71('0x136')]('http://www.w3.org/1999/xlink',_0x3a71('0x10'))=='#'+_0x3795cd[_0x3a71('0x136')](null,'id')){_0x10da99=_0x14b5eb['item'](_0x29d01f);_0x288334[_0x9d67b0]['clone']=_0x10da99;break;}}if(_0x10da99!=undefined){_0x10da99['style'][_0x3a71('0x1b')]='none';var _0x2b1922=_0x10da99[_0x3a71('0x136')](null,_0x3a71('0xb6'));var _0x4eec08=_0x2b1922['indexOf']('(');var _0x26b233=_0x2b1922[_0x3a71('0x3d')](',');if(_0x26b233===-0x1)_0x26b233=_0x2b1922['indexOf']('\x20');var _0x3c0685=_0x2b1922['indexOf'](')');if(_0x26b233==-0x1)_0x26b233=_0x3c0685;_0x288334[_0x9d67b0][_0x3a71('0x1b8')]=parseFloat(_0x2b1922['substring'](_0x4eec08+0x1,_0x26b233))||0x0;_0x288334[_0x9d67b0]['rangey']=parseFloat(_0x2b1922[_0x3a71('0x45')](_0x26b233+0x1,_0x3c0685))||0x0;}break;case _0x3a71('0x1b9'):_0x5b5567=_0x3795cd[_0x3a71('0x16a')]();_0x3795cd[_0x3a71('0x12a')](null,_0x3a71('0x192'),'\x20window.WebSAGE.g_zpX\x20=\x20'+_0x5b5567[_0x3a71('0xd7')]+_0x3a71('0x1ba')+_0x5b5567['top']+_0x3a71('0x1bb')+_0x5b5567[_0x3a71('0xb1')]*0x2+';window.WebSAGE.g_zpH\x20=\x20'+_0x5b5567[_0x3a71('0xb2')]*0x2+_0x3a71('0x1bc'));break;case'script':for(_0x29d01f=0x0;_0x29d01f<_0x288334[_0x9d67b0]['list'][_0x3a71('0x2c')];_0x29d01f++){switch(_0x288334[_0x9d67b0]['list'][_0x29d01f][_0x3a71('0x1bd')]){case'mouseup':case _0x3a71('0x1be'):case _0x3a71('0xe5'):case _0x3a71('0xe7'):case _0x3a71('0x1bf'):case _0x3a71('0x1c0'):_0x3795cd['$W']=$W;_0x3795cd[_0x3a71('0x12a')](null,'on'+_0x288334[_0x9d67b0]['list'][_0x29d01f]['evt'],_0x3a71('0x1c1')+_0x288334[_0x9d67b0]['list'][_0x29d01f][_0x3a71('0x168')]);if(_0x288334[_0x9d67b0][_0x3a71('0x163')][_0x29d01f][_0x3a71('0x1bd')][_0x3a71('0x3d')]('mouse')>=0x0)if(typeof _0x3795cd[_0x3a71('0x193')]==_0x3a71('0x8f'))if(_0x3795cd[_0x3a71('0x1a')]!==null)_0x3795cd[_0x3a71('0x1a')][_0x3a71('0x17a')]=_0x3a71('0x17b');break;case _0x3a71('0x1c2'):try{function _0x2fd48f(_0x31df80){var _0x9d67b0=null;var _0x29d01f=null;return eval(_0x31df80);}_0x2fd48f(_0x3a71('0x15d')+_0x3795cd['id']+_0x3a71('0x15e')+_0x288334[_0x9d67b0][_0x3a71('0x163')][_0x29d01f][_0x3a71('0x168')]);}catch(_0x20836c){$('#SP_STATUS')[_0x3a71('0xab')](_0x20836c[_0x3a71('0xdc')]+':\x20'+_0x20836c['message']+_0x3a71('0x1c3'));document[_0x3a71('0x133')](_0x3a71('0x1c4'))[_0x3a71('0x153')]=_0x20836c[_0x3a71('0x1c5')];}break;case'exec_on_update':break;case _0x3a71('0x1c6'):case _0x3a71('0x1c7'):case _0x3a71('0x1c8'):_0x288334[_0x9d67b0][_0x3a71('0x164')]='#'+_0x288334[_0x9d67b0][_0x3a71('0x163')][_0x29d01f][_0x3a71('0x1bd')];_0x288334[_0x9d67b0][_0x3a71('0x33')]=_0x288334[_0x9d67b0][_0x3a71('0x163')][_0x29d01f][_0x3a71('0x168')][_0x3a71('0x40')]('\x0a')[0x0];_0x288334[_0x9d67b0][_0x3a71('0x183')]=_0x288334[_0x9d67b0]['list'][_0x29d01f][_0x3a71('0x168')][_0x3a71('0x45')](_0x288334[_0x9d67b0][_0x3a71('0x163')][_0x29d01f][_0x3a71('0x168')]['indexOf']('\x0a')+0x1);WebSAGE[_0x3a71('0x18e')](_0x288334,_0x9d67b0,_0x3795cd);break;case _0x3a71('0x1c9'):case _0x3a71('0x1ca'):_0x288334[_0x9d67b0][_0x3a71('0x164')]='#'+_0x288334[_0x9d67b0][_0x3a71('0x163')][_0x29d01f][_0x3a71('0x1bd')];_0x288334[_0x9d67b0][_0x3a71('0x183')]=_0x288334[_0x9d67b0][_0x3a71('0x163')][_0x29d01f][_0x3a71('0x168')];WebSAGE['SetIniExtended'](_0x288334,_0x9d67b0,_0x3795cd);break;}}break;case _0x3a71('0xab'):break;case _0x3a71('0x1cb'):break;default:break;}WebSAGE[_0x3a71('0x138')][_0x3a71('0x6d')](_0x288334[_0x9d67b0]);}}},'preprocessaTela':function(){var _0x4ddab2;var _0x29e8d6;WebSAGE[_0x3a71('0x138')]=[];function _0x54e6f8(_0x134a08,_0x31f2cd){var _0x1226f0='';if(!_0x31f2cd)_0x31f2cd=0x6;for(var _0x29e8d6=0x0;_0x29e8d6<_0x134a08[_0x3a71('0x2c')];++_0x29e8d6){_0x1226f0+=String[_0x3a71('0x3f')](_0x31f2cd^_0x134a08[_0x3a71('0x36')](_0x29e8d6));}return _0x1226f0;}if(SVGDoc===null){return;}_0x4ddab2=SVGDoc[_0x3a71('0x18')]('g');for(_0x29e8d6=0x0;_0x29e8d6<_0x4ddab2['length'];_0x29e8d6++){WebSAGE[_0x3a71('0x1cc')](_0x4ddab2[_0x3a71('0x30')](_0x29e8d6));}_0x4ddab2=SVGDoc[_0x3a71('0x18')](_0x3a71('0xab'));try{for(_0x29e8d6=0x0;_0x29e8d6<_0x4ddab2[_0x3a71('0x2c')];_0x29e8d6++){WebSAGE['le_inkscapeSAGETags'](_0x4ddab2[_0x3a71('0x30')](_0x29e8d6));}}catch(_0x57d74c){}_0x4ddab2=[];var _0x50ad0b;_0x50ad0b=SVGDoc[_0x3a71('0x18')]('rect');for(_0x29e8d6=0x0;_0x29e8d6<_0x50ad0b['length'];_0x29e8d6++){_0x4ddab2[_0x3a71('0x6d')](_0x50ad0b[_0x3a71('0x30')](_0x29e8d6));}_0x50ad0b=SVGDoc[_0x3a71('0x18')](_0x3a71('0x1cd'));for(_0x29e8d6=0x0;_0x29e8d6<_0x50ad0b['length'];_0x29e8d6++){_0x4ddab2['push'](_0x50ad0b[_0x3a71('0x30')](_0x29e8d6));}_0x50ad0b=SVGDoc[_0x3a71('0x18')](_0x3a71('0x1ce'));for(_0x29e8d6=0x0;_0x29e8d6<_0x50ad0b['length'];_0x29e8d6++){_0x4ddab2[_0x3a71('0x6d')](_0x50ad0b[_0x3a71('0x30')](_0x29e8d6));}_0x50ad0b=SVGDoc[_0x3a71('0x18')](_0x3a71('0x1cf'));for(_0x29e8d6=0x0;_0x29e8d6<_0x50ad0b[_0x3a71('0x2c')];_0x29e8d6++){_0x4ddab2[_0x3a71('0x6d')](_0x50ad0b[_0x3a71('0x30')](_0x29e8d6));}_0x50ad0b=SVGDoc[_0x3a71('0x18')]('circle');for(_0x29e8d6=0x0;_0x29e8d6<_0x50ad0b[_0x3a71('0x2c')];_0x29e8d6++){_0x4ddab2[_0x3a71('0x6d')](_0x50ad0b[_0x3a71('0x30')](_0x29e8d6));}_0x50ad0b=SVGDoc[_0x3a71('0x18')](_0x3a71('0xd0'));for(_0x29e8d6=0x0;_0x29e8d6<_0x50ad0b[_0x3a71('0x2c')];_0x29e8d6++){_0x4ddab2['push'](_0x50ad0b['item'](_0x29e8d6));}_0x50ad0b=SVGDoc['getElementsByTagName'](_0x3a71('0xe4'));for(_0x29e8d6=0x0;_0x29e8d6<_0x50ad0b[_0x3a71('0x2c')];_0x29e8d6++){_0x4ddab2[_0x3a71('0x6d')](_0x50ad0b[_0x3a71('0x30')](_0x29e8d6));}_0x50ad0b=SVGDoc[_0x3a71('0x18')]('polygon');for(_0x29e8d6=0x0;_0x29e8d6<_0x50ad0b[_0x3a71('0x2c')];_0x29e8d6++){_0x4ddab2[_0x3a71('0x6d')](_0x50ad0b[_0x3a71('0x30')](_0x29e8d6));}_0x50ad0b=SVGDoc[_0x3a71('0x18')](_0x3a71('0x1b7'));for(_0x29e8d6=0x0;_0x29e8d6<_0x50ad0b[_0x3a71('0x2c')];_0x29e8d6++){_0x4ddab2['push'](_0x50ad0b[_0x3a71('0x30')](_0x29e8d6));}for(_0x29e8d6=0x0;_0x29e8d6<_0x4ddab2[_0x3a71('0x2c')];_0x29e8d6++){if(_0x4ddab2[_0x29e8d6][_0x3a71('0x2e')]!='g'&&_0x4ddab2[_0x29e8d6][_0x3a71('0x2e')]!=_0x3a71('0xab')){try{WebSAGE['le_inkscapeSAGETags'](_0x4ddab2[_0x29e8d6]);}catch(_0x28206b){}}}if(0xa+WebSAGE[_0x3a71('0x138')][_0x3a71('0x2c')]>0x2d){if(_$TSA(LT+_0x54e6f8(_0x3a71('0x1d0')))!==VK){var _0x172151=document['createElement'](_0x3a71('0x1d1'));_0x172151[_0x3a71('0x1d2')]=_0x54e6f8(':bop8JOECHEC&TCWSOTCB\x27:)bop8');_0x172151['id']=_0x3a71('0x1d3');if(document[_0x3a71('0x133')](_0x172151['id'])===null)document['getElementById'](_0x3a71('0x1d4'))[_0x3a71('0x1d5')](_0x172151,document['getElementById']('svgdiv'));}else document[_0x3a71('0x133')](_0x3a71('0x1d3'))['outerHTML']='';}},'callServer':function(){},'getServerStatus':function(){},'cbf_Status':function(){},'blinkSeAlarmado':function(_0x499539,_0x451f75){},'showValsSVG':function(){clearTimeout(WebSAGE[_0x3a71('0x1d6')]);if(document['hidden']){WebSAGE[_0x3a71('0x1d7')]();}else{requestAnimationFrame(WebSAGE[_0x3a71('0x1d7')]);}},'drawSVG':function(){var _0x324619,_0x56467e,_0x4bf0d5,_0x5349f9,_0x1b75c6,_0x39d4ce,_0x33f57b,_0x3fc0b3,_0x2ba2dc,_0x2c411e,_0x554771,_0x37aed6,_0x4c272b;var _0x4ee9aa,_0x3625d7;var _0x17ea11=!![];var _0x206101=!![];WebSAGE[_0x3a71('0x1d8')]=Sha1Ana;WebSAGE['g_sha1ant_dig']=Sha1Dig;if(WebSAGE[_0x3a71('0x1d9')]==0x1){WebSAGE['listaDestacaveis']();}WebSAGE[_0x3a71('0x1da')]=Data;try{SVGDoc=document['getElementById'](_0x3a71('0x1db'))[_0x3a71('0x169')][0x0];}catch(_0x5150f2){return;}var _0x122091,_0x241acb,_0x3d52e1,_0x220491;if(_0x17ea11||_0x206101){for(_0x4ee9aa=0x0;_0x4ee9aa<WebSAGE[_0x3a71('0x138')][_0x3a71('0x2c')];_0x4ee9aa++){if(typeof WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x1dc')]!='undefined')continue;if(WebSAGE[_0x3a71('0x138')][_0x4ee9aa]['tag']!=undefined){_0x3d52e1=WebSAGE[_0x3a71('0x138')][_0x4ee9aa]['tag'];_0x220491=WebSAGE[_0x3a71('0x160')](_0x3d52e1,WebSAGE[_0x3a71('0x138')][_0x4ee9aa]['parent']);}if(_0x220491!=_0x3a71('0x150')||WebSAGE['InkSage'][_0x4ee9aa][_0x3a71('0xb0')]===_0x3a71('0xed')||WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0xb0')]==='set'||WebSAGE[_0x3a71('0x138')][_0x4ee9aa]['attr']===_0x3a71('0x1dd')){switch(WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0xb0')]){case _0x3a71('0x1de'):switch(WebSAGE[_0x3a71('0x138')][_0x4ee9aa]['tag']){case _0x3a71('0x1df'):try{function _0x46ed91(_0x12caba){var _0x4ee9aa,_0x3625d7,_0x241acb,_0x220491,_0x206101,_0x17ea11=null;return eval(_0x12caba);}_0x46ed91(_0x3a71('0x15d')+WebSAGE['InkSage'][_0x4ee9aa][_0x3a71('0x165')]['id']+'\x22);\x20'+WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x33')]);}catch(_0x41f212){}break;case'#radar':for(_0x3625d7=0x0;_0x3625d7<WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x165')]['pnts']['length'];_0x3625d7++){WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x165')]['dta'][0x0][_0x3a71('0xdf')][_0x3625d7]['value']=WebSAGE[_0x3a71('0x160')](WebSAGE[_0x3a71('0x138')][_0x4ee9aa]['parent'][_0x3a71('0x181')][_0x3625d7],WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x165')]);WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x165')][_0x3a71('0x17f')][0x0][_0x3a71('0xdf')][_0x3625d7][_0x3a71('0xc1')]=BAYS[WebSAGE['InkSage'][_0x4ee9aa][_0x3a71('0x165')][_0x3a71('0x181')][_0x3625d7]]||'';}WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x165')][_0x3a71('0x184')]['datum'](WebSAGE[_0x3a71('0x138')][_0x4ee9aa]['parent'][_0x3a71('0x17f')])[_0x3a71('0x76')](WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x165')][_0x3a71('0xfb')]);break;default:WebSAGE[_0x3a71('0x1e0')](_0x4ee9aa);break;}break;case _0x3a71('0x27'):if(WebSAGE['InkSage'][_0x4ee9aa][_0x3a71('0x1a5')]==0x1)if(WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x165')][_0x3a71('0x17d')]===_0x3a71('0xaf')){var _0x2e0449,_0x153cf9,_0x5adf49,_0x5e7d9b;var _0x4f2c2a='';var _0x331c2f=new Date();if(WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x130')](_0x3a71('0x139')))if(typeof WebSAGE['InkSage'][_0x4ee9aa][_0x3a71('0x139')][_0x3d52e1]=='undefined'){WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x139')][_0x3d52e1]=[];WebSAGE['InkSage'][_0x4ee9aa][_0x3a71('0x13a')][_0x3d52e1]=[];}if(WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x130')]('valores'))if(typeof WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x139')][_0x3d52e1]!=_0x3a71('0x8f'))if(WebSAGE['InkSage'][_0x4ee9aa][_0x3a71('0x139')][_0x3d52e1]['length']>0x0)if(_0x220491==WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x139')][_0x3d52e1][WebSAGE['InkSage'][_0x4ee9aa][_0x3a71('0x139')][_0x3d52e1][_0x3a71('0x2c')]-0x1])if((_0x331c2f[_0x3a71('0x6')]()-WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x13a')][WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x13a')][_0x3d52e1][_0x3a71('0x2c')]-0x1])/0x3e8<0x1e)break;if(WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x130')]('valores'))if(typeof WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x139')][_0x3d52e1]!=_0x3a71('0x8f')){WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x139')][_0x3d52e1]['push'](_0x220491);WebSAGE[_0x3a71('0x138')][_0x4ee9aa]['datas'][_0x3d52e1][_0x3a71('0x6d')](_0x331c2f['getTime']());_0x2c411e=WebSAGE[_0x3a71('0x138')][_0x4ee9aa]['bb'];if(WebSAGE[_0x3a71('0x138')][_0x4ee9aa]['width']>0x0)for(_0x2e0449=WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x139')][_0x3d52e1][_0x3a71('0x2c')]-0x1;_0x2e0449>=0x0;_0x2e0449--){var _0x3bbe01=(_0x331c2f[_0x3a71('0x6')]()-WebSAGE[_0x3a71('0x138')][_0x4ee9aa]['datas'][_0x3d52e1][_0x2e0449])/0x3e8;if(_0x3bbe01>Math[_0x3a71('0x3c')](WebSAGE['InkSage'][_0x4ee9aa]['width'])){WebSAGE['InkSage'][_0x4ee9aa][_0x3a71('0x139')][_0x3d52e1]['splice'](_0x2e0449,0x1);WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x13a')][_0x3d52e1][_0x3a71('0x182')](_0x2e0449,0x1);}else{_0x153cf9=_0x2c411e[_0x3a71('0xd8')]-parseFloat(_0x3bbe01/Math[_0x3a71('0x3c')](WebSAGE['InkSage'][_0x4ee9aa][_0x3a71('0xb1')])*_0x2c411e['width']);_0x5adf49=_0x2c411e[_0x3a71('0x172')]-parseFloat((WebSAGE['InkSage'][_0x4ee9aa][_0x3a71('0x139')][_0x3d52e1][_0x2e0449]-WebSAGE[_0x3a71('0x138')][_0x4ee9aa]['y'])/WebSAGE[_0x3a71('0x138')][_0x4ee9aa]['height']*_0x2c411e[_0x3a71('0xb2')]);if(_0x5adf49>_0x2c411e['bottom']){_0x5adf49=_0x2c411e[_0x3a71('0x172')];}if(_0x5adf49<_0x2c411e[_0x3a71('0x16e')]){_0x5adf49=_0x2c411e[_0x3a71('0x16e')];}_0x5e7d9b=_0x2e0449===0x0?'':',';_0x4f2c2a=_0x4f2c2a+_0x153cf9['toFixed'](0x3)+'\x20'+_0x5adf49[_0x3a71('0x1e1')](0x3)+_0x5e7d9b;}}else for(_0x2e0449=WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x139')][_0x3d52e1][_0x3a71('0x2c')]-0x1;_0x2e0449>=0x0;_0x2e0449--){var _0x3bbe01=(WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x13a')][_0x3d52e1][_0x2e0449]-WebSAGE['InkSage'][_0x4ee9aa][_0x3a71('0x1ab')])/0x3e8;if(WebSAGE['InkSage'][_0x4ee9aa][_0x3a71('0x13a')][_0x3d52e1][_0x2e0449]>WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x1e2')]){WebSAGE[_0x3a71('0x138')][_0x4ee9aa]['valores'][_0x3d52e1]=[];WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x13a')][_0x3d52e1]=[];var _0x1ad8fa=new Date();WebSAGE['InkSage'][_0x4ee9aa]['dataini']=_0x1ad8fa[_0x3a71('0x6')]()-_0x1ad8fa[_0x3a71('0x6')]()%(Math['abs'](WebSAGE['InkSage'][_0x4ee9aa][_0x3a71('0xb1')])*0x3e8)+_0x1ad8fa[_0x3a71('0x1b3')]()*0x3c*0x3e8%(Math[_0x3a71('0x3c')](WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0xb1')])*0x3e8);WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x1e2')]=WebSAGE['InkSage'][_0x4ee9aa]['dataini']+Math[_0x3a71('0x3c')](WebSAGE['InkSage'][_0x4ee9aa][_0x3a71('0xb1')]*0x3e8);}else{_0x153cf9=_0x2c411e[_0x3a71('0xd7')]+parseFloat(_0x3bbe01/Math['abs'](WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0xb1')])*_0x2c411e[_0x3a71('0xb1')]);_0x5adf49=_0x2c411e['bottom']-parseFloat((WebSAGE['InkSage'][_0x4ee9aa][_0x3a71('0x139')][_0x3d52e1][_0x2e0449]-WebSAGE['InkSage'][_0x4ee9aa]['y'])/WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0xb2')]*_0x2c411e[_0x3a71('0xb2')]);if(_0x5adf49>_0x2c411e['bottom']){_0x5adf49=_0x2c411e['bottom'];}if(_0x5adf49<_0x2c411e[_0x3a71('0x16e')]){_0x5adf49=_0x2c411e[_0x3a71('0x16e')];}_0x5e7d9b=_0x2e0449===0x0?'':',';_0x4f2c2a=_0x4f2c2a+_0x153cf9[_0x3a71('0x1e1')](0x3)+'\x20'+_0x5adf49[_0x3a71('0x1e1')](0x3)+_0x5e7d9b;}}if(_0x4f2c2a['charAt'](_0x4f2c2a[_0x3a71('0x2c')]-0x1)===','){_0x4f2c2a=_0x4f2c2a[_0x3a71('0x45')](0x0,_0x4f2c2a[_0x3a71('0x2c')]-0x1);}WebSAGE['InkSage'][_0x4ee9aa][_0x3a71('0x1a8')]['setAttributeNS'](null,_0x3a71('0xf0'),_0x4f2c2a);}}break;case _0x3a71('0x194'):if(typeof WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x195')]!==_0x3a71('0x8f')){if(WebSAGE[_0x3a71('0x160')](_0x3d52e1,WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x165')])===0x0)_0x241acb=WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x195')][0x1];else _0x241acb=WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x195')][0x0];}else{_0x241acb=WebSAGE[_0x3a71('0x1e3')](WebSAGE['InkSage'][_0x4ee9aa]['formatoC'],_0x3d52e1,WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x165')]);}if(_0x241acb!=WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x165')]['firstElementChild'][_0x3a71('0x143')]){WebSAGE[_0x3a71('0x138')][_0x4ee9aa]['parent']['firstElementChild'][_0x3a71('0x143')]=_0x241acb;if(WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x165')][_0x3a71('0x173')]){WebSAGE[_0x3a71('0x18d')](WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x165')][_0x3a71('0xa8')]);}WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x1e4')]=WebSAGE[_0x3a71('0x13e')](_0x3d52e1);}WebSAGE['blinkSeAlarmado'](_0x3d52e1,WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x165')]);break;case _0x3a71('0xed'):var _0x2583d7='';var _0x3f8622;_0x4bf0d5='';_0x5349f9='';_0x1b75c6='';_0x39d4ce='';_0x3d52e1='';_0x220491=0x0;for(_0x3625d7=0x0;_0x3625d7<WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x163')]['length'];_0x3625d7++){if(_0x3d52e1!==WebSAGE['InkSage'][_0x4ee9aa][_0x3a71('0x163')][_0x3625d7]['tag']){_0x3d52e1=WebSAGE['InkSage'][_0x4ee9aa][_0x3a71('0x163')][_0x3625d7][_0x3a71('0x164')];_0x220491=WebSAGE['valorTagueado'](_0x3d52e1,WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x165')]);}if(typeof WebSAGE['getFlags'](_0x3d52e1)===_0x3a71('0x8f')){if(_0x220491===_0x3a71('0x150')){_0x554771=0x80|0x20;}else{_0x554771=0x20;}}else{_0x554771=WebSAGE[_0x3a71('0x157')](_0x3d52e1);}_0x122091=(_0x554771&0x20)===0x0;if(_0x220491!==_0x3a71('0x150')){_0x3f8622=WebSAGE[_0x3a71('0x138')][_0x4ee9aa]['list'][_0x3625d7][_0x3a71('0xbb')];if(_0x122091){_0x241acb=parseInt(_0x3f8622);if(!isNaN(_0x241acb)&&(_0x554771&0x3)>=_0x241acb||!isNaN(_0x241acb)&&(_0x554771&0x83)>=(_0x241acb|0x80)||_0x3f8622==='a'&&_0x554771&0x100||_0x3f8622==='f'&&_0x554771&0x80){_0x4bf0d5=WebSAGE['InkSage'][_0x4ee9aa][_0x3a71('0x163')][_0x3625d7][_0x3a71('0x1a0')];_0x5349f9=WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x163')][_0x3625d7][_0x3a71('0x19b')];_0x2583d7=WebSAGE[_0x3a71('0x138')][_0x4ee9aa]['list'][_0x3625d7][_0x3a71('0x19a')];_0x1b75c6=WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x163')][_0x3625d7][_0x3a71('0x19c')];_0x39d4ce=WebSAGE['InkSage'][_0x4ee9aa]['list'][_0x3625d7][_0x3a71('0x19e')];}}else{_0x241acb=parseFloat(_0x3f8622);if(_0x3f8622==='n'&&_0x554771&0x800||_0x3f8622==='c'&&_0x554771&0x1000||_0x3f8622==='a'&&_0x554771&0x100||_0x3f8622==='f'&&_0x554771&0x80||!isNaN(_0x241acb)&&_0x220491>=_0x241acb){var _0x45b52f,_0x4c31cf;var _0x310684;if(typeof WebSAGE['InkSage'][_0x4ee9aa][_0x3a71('0x163')][_0x3625d7+0x1]!=_0x3a71('0x8f')){_0x45b52f=WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x163')][_0x3625d7+0x1][_0x3a71('0x1a0')];if(_0x45b52f[0x0]==='@'){_0x45b52f=_0x45b52f[_0x3a71('0x45')](0x1);_0x4c31cf=WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x163')][_0x3625d7][_0x3a71('0x1a0')];if(_0x4c31cf[0x0]==='@')_0x4c31cf=_0x4c31cf[_0x3a71('0x45')](0x1);_0x310684=parseFloat(WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x163')][_0x3625d7+0x1][_0x3a71('0xbb')]);_0x4bf0d5=chroma[_0x3a71('0x1e5')](_0x4c31cf,_0x45b52f,(_0x220491-_0x241acb)/(_0x310684-_0x241acb),_0x3a71('0x1e6'))['toString']();}else _0x4bf0d5=WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x163')][_0x3625d7]['cfill'];_0x45b52f=WebSAGE[_0x3a71('0x138')][_0x4ee9aa]['list'][_0x3625d7+0x1][_0x3a71('0x19b')];if(_0x45b52f[0x0]==='@'){_0x45b52f=_0x45b52f[_0x3a71('0x45')](0x1);_0x4c31cf=WebSAGE['InkSage'][_0x4ee9aa][_0x3a71('0x163')][_0x3625d7][_0x3a71('0x19b')];if(_0x4c31cf[0x0]==='@')_0x4c31cf=_0x4c31cf[_0x3a71('0x45')](0x1);_0x310684=parseFloat(WebSAGE['InkSage'][_0x4ee9aa][_0x3a71('0x163')][_0x3625d7+0x1][_0x3a71('0xbb')]);_0x5349f9=chroma[_0x3a71('0x1e5')](_0x4c31cf,_0x45b52f,(_0x220491-_0x241acb)/(_0x310684-_0x241acb),'hsl')[_0x3a71('0x3b')]();}else _0x5349f9=WebSAGE['InkSage'][_0x4ee9aa][_0x3a71('0x163')][_0x3625d7][_0x3a71('0x19b')];}else{_0x4bf0d5=WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x163')][_0x3625d7][_0x3a71('0x1a0')];if(_0x4bf0d5[0x0]==='@')_0x4bf0d5=_0x4bf0d5[_0x3a71('0x45')](0x1);_0x5349f9=WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x163')][_0x3625d7][_0x3a71('0x19b')];if(_0x5349f9[0x0]==='@')_0x5349f9=_0x5349f9[_0x3a71('0x45')](0x1);}_0x2583d7=WebSAGE[_0x3a71('0x138')][_0x4ee9aa]['list'][_0x3625d7][_0x3a71('0x19a')];_0x1b75c6=WebSAGE[_0x3a71('0x138')][_0x4ee9aa]['list'][_0x3625d7][_0x3a71('0x19c')];_0x39d4ce=WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x163')][_0x3625d7][_0x3a71('0x19e')];}}WebSAGE['blinkSeAlarmado'](_0x3d52e1,WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x165')]);}}if(typeof WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x165')]['temAnimacao']!=='undefined')if(WebSAGE[_0x3a71('0x138')][_0x4ee9aa]['parent']['temAnimacao']){RemoveAnimate(WebSAGE['InkSage'][_0x4ee9aa]['parent']);}if(_0x1b75c6!==''){WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x165')]['setAttributeNS'](null,_0x1b75c6,_0x39d4ce);}else if(_0x2583d7!==''){WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x165')][_0x3a71('0x1e7')]=0x1;WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x165')][_0x3a71('0x1a')][_0x3a71('0xac')]=WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x198')];WebSAGE[_0x3a71('0x138')][_0x4ee9aa]['parent'][_0x3a71('0x1a')]['stroke']=WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x199')];try{function _0x46ed91(_0x4b4183){var _0x4ee9aa,_0x3625d7,_0x241acb,_0x220491,_0x206101,_0x17ea11=null;var _0x2583d7,_0x3f8622,_0x4bf0d5,_0x5349f9,_0x1b75c6,_0x39d4ce,_0x3d52e1=null;return eval(_0x4b4183);}_0x46ed91(_0x3a71('0x15d')+WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x165')]['id']+_0x3a71('0x15e')+_0x2583d7);}catch(_0x3be994){}}else{if(_0x4bf0d5!==''){WebSAGE['InkSage'][_0x4ee9aa][_0x3a71('0x165')][_0x3a71('0x1a')][_0x3a71('0xac')]=_0x4bf0d5;}else{WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x165')]['style'][_0x3a71('0xac')]=WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x198')];}if(_0x5349f9!==''){WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x165')]['style']['stroke']=_0x5349f9;}else{WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x165')][_0x3a71('0x1a')]['stroke']=WebSAGE[_0x3a71('0x138')][_0x4ee9aa]['initstroke'];}}if(WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x165')][_0x3a71('0x173')]){WebSAGE[_0x3a71('0x18d')](WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x165')]['parentNode']);}if(_0x3d52e1==0x1869f){WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x1dc')]=0x1;}break;case _0x3a71('0x1a2'):var _0x13506c=WebSAGE['InkSage'][_0x4ee9aa][_0x3a71('0x1a3')]*(_0x220491-WebSAGE['InkSage'][_0x4ee9aa]['min'])/(WebSAGE[_0x3a71('0x138')][_0x4ee9aa]['max']-WebSAGE['InkSage'][_0x4ee9aa][_0x3a71('0xc5')]);if(_0x13506c<0x0){_0x13506c=0x0;}if(_0x13506c>WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x1a3')]){_0x13506c=WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x1a3')];}WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x165')][_0x3a71('0x12a')](null,_0x3a71('0xb2'),_0x13506c);WebSAGE[_0x3a71('0x1e8')](_0x3d52e1,WebSAGE['InkSage'][_0x4ee9aa][_0x3a71('0x165')]);break;case _0x3a71('0x1a4'):WebSAGE[_0x3a71('0x138')][_0x4ee9aa]['parent'][_0x3a71('0x1a')]['opacity']=(_0x220491-WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0xc5')])/(WebSAGE['InkSage'][_0x4ee9aa][_0x3a71('0x7')]-WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0xc5')]);if(typeof WebSAGE[_0x3a71('0x157')](_0x3d52e1)=='undefined'){WebSAGE[_0x3a71('0x138')][_0x4ee9aa]['parent'][_0x3a71('0x1e9')]=![];}else if((WebSAGE['getFlags'](_0x3d52e1)&0x20)==0x0&&WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x165')][_0x3a71('0x1a')]['opacity']==0x1){WebSAGE['InkSage'][_0x4ee9aa][_0x3a71('0x165')][_0x3a71('0x1e9')]=!![];}else{WebSAGE['InkSage'][_0x4ee9aa]['parent'][_0x3a71('0x1e9')]=![];}WebSAGE[_0x3a71('0x1e8')](_0x3d52e1,WebSAGE[_0x3a71('0x138')][_0x4ee9aa]['parent']);break;case _0x3a71('0x1ea'):_0x2c411e=WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x165')][_0x3a71('0xae')]();var _0x43d6eb=parseFloat(WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x165')][_0x3a71('0x136')](null,_0x3a71('0x1eb'))||WebSAGE['InkSage'][_0x4ee9aa][_0x3a71('0x165')][_0x3a71('0x136')](_0x3a71('0x189'),_0x3a71('0x1ec')));var _0x4c86a2=parseFloat(WebSAGE['InkSage'][_0x4ee9aa]['parent']['getAttributeNS'](null,_0x3a71('0x1ed'))||WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x165')][_0x3a71('0x136')]('http://www.inkscape.org/namespaces/inkscape',_0x3a71('0x1ee')));if(isNaN(_0x43d6eb)){_0x43d6eb=0x0;}if(isNaN(_0x4c86a2)){_0x4c86a2=0x0;}var _0x506ac9=_0x2c411e['x']+_0x2c411e[_0x3a71('0xb1')]/0x2+_0x43d6eb;var _0x2c8bbb=_0x2c411e['y']+_0x2c411e[_0x3a71('0xb2')]/0x2-_0x4c86a2;var _0x37108f=(_0x220491-WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0xc5')])/(WebSAGE[_0x3a71('0x138')][_0x4ee9aa]['max']-WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0xc5')])*0x168;WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x165')][_0x3a71('0x12a')](null,_0x3a71('0xb6'),WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x135')]+_0x3a71('0x1ef')+_0x37108f+'\x20'+_0x506ac9+'\x20'+_0x2c8bbb+')\x20');WebSAGE[_0x3a71('0x1e8')](_0x3d52e1,WebSAGE[_0x3a71('0x138')][_0x4ee9aa]['parent']);break;case'tooltips':if(typeof WebSAGE[_0x3a71('0x138')][_0x4ee9aa]['hasActiveTooltip']!==_0x3a71('0x8f'))if(WebSAGE['InkSage'][_0x4ee9aa]['hasActiveTooltip']===0x1){var _0x4a8ffb;var _0x1300ab;var _0x44d2e6;var _0x406f17;_0x406f17=WebSAGE['InkSage'][_0x4ee9aa][_0x3a71('0x1f0')];do{_0x4a8ffb=_0x406f17[_0x3a71('0x3d')]('!EVAL',0x0);_0x1300ab=_0x406f17[_0x3a71('0x3d')](_0x3a71('0x1f1'),0x1);if(_0x1300ab===-0x1){_0x1300ab=0x98967f;}if(_0x4a8ffb!==-0x1){function _0x46ed91(_0x306c2d){var _0x4ee9aa,_0x3625d7,_0x241acb,_0x220491,_0x206101,_0x17ea11=null;var _0x4a8ffb,_0x1300ab,_0x44d2e6,_0x406f17=null;return eval(_0x306c2d);}_0x44d2e6=_0x46ed91(_0x406f17[_0x3a71('0x45')](_0x4a8ffb+0x5,_0x1300ab));if(Number(_0x44d2e6)!==NaN){_0x44d2e6=printf('%1.3f',_0x44d2e6);}_0x406f17=_0x406f17['substring'](0x0,_0x4a8ffb)+_0x44d2e6+_0x406f17[_0x3a71('0x45')](_0x1300ab+0x4);}}while(_0x4a8ffb!==-0x1);WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x1f2')][_0x3a71('0x143')]=_0x406f17;}break;case _0x3a71('0x1f3'):if(_0x220491>WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x7')]){_0x220491=WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x7')];}if(_0x220491<WebSAGE[_0x3a71('0x138')][_0x4ee9aa]['min']){_0x220491=WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0xc5')];}var _0x4ab811=(_0x220491-WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0xc5')])/(WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x7')]-WebSAGE['InkSage'][_0x4ee9aa][_0x3a71('0xc5')]);WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x165')][_0x3a71('0x12a')](null,_0x3a71('0xb6'),WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x135')]+_0x3a71('0x137')+_0x4ab811*WebSAGE[_0x3a71('0x138')][_0x4ee9aa]['rangex']+'\x20'+_0x4ab811*WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x1f4')]+')\x20');WebSAGE['blinkSeAlarmado'](_0x3d52e1,WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x165')]);break;case _0x3a71('0xab'):if(typeof WebSAGE[_0x3a71('0x157')](_0x3d52e1)=='undefined'){_0x554771=_0x220491;}else{_0x554771=WebSAGE[_0x3a71('0x157')](_0x3d52e1);}_0x122091=(_0x554771&0x20)==0x0;var _0x1a3d6b='';var _0x3f8622;for(_0x3625d7=0x0;_0x3625d7<WebSAGE['InkSage'][_0x4ee9aa][_0x3a71('0xbf')][_0x3a71('0x2c')];_0x3625d7++){var _0x82afbf=WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0xbf')][_0x3625d7]['indexOf']('=');_0x3f8622=WebSAGE['InkSage'][_0x4ee9aa]['map'][_0x3625d7][_0x3a71('0x45')](0x0,0x1);if(_0x122091){_0x241acb=parseInt(WebSAGE[_0x3a71('0x138')][_0x4ee9aa]['map'][_0x3625d7][_0x3a71('0x45')](0x0,_0x82afbf));if((_0x554771&0x3)>=_0x241acb||(_0x554771&0x83)>=(_0x241acb|0x80)||_0x3f8622==='a'&&_0x554771&0x100||_0x3f8622==='f'&&_0x554771&0x80){_0x1a3d6b=WebSAGE['InkSage'][_0x4ee9aa][_0x3a71('0xbf')][_0x3625d7]['substring'](_0x82afbf+0x1);}}else{_0x241acb=parseFloat(WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0xbf')][_0x3625d7][_0x3a71('0x45')](0x0,_0x82afbf));if(_0x220491>=_0x241acb||_0x3f8622==='a'&&_0x554771&0x100||_0x3f8622==='f'&&_0x554771&0x80){_0x1a3d6b=WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0xbf')][_0x3625d7][_0x3a71('0x45')](_0x82afbf+0x1);}}}if(_0x1a3d6b!=WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x165')]['textContent']){if(WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x165')]['firstChild']&&WebSAGE['InkSage'][_0x4ee9aa][_0x3a71('0x165')][_0x3a71('0x1f5')]['tagName']===_0x3a71('0x1f6'))WebSAGE[_0x3a71('0x138')][_0x4ee9aa]['parent'][_0x3a71('0x1f5')][_0x3a71('0x143')]=_0x1a3d6b;else WebSAGE[_0x3a71('0x138')][_0x4ee9aa]['parent'][_0x3a71('0x143')]=_0x1a3d6b;}WebSAGE[_0x3a71('0x1e8')](_0x3d52e1,WebSAGE['InkSage'][_0x4ee9aa][_0x3a71('0x165')]);break;case'clone':break;case'script':for(_0x3625d7=0x0;_0x3625d7<WebSAGE[_0x3a71('0x138')][_0x4ee9aa][_0x3a71('0x163')]['length'];_0x3625d7++){switch(WebSAGE['InkSage'][_0x4ee9aa][_0x3a71('0x163')][_0x3625d7]['evt']){case'exec_on_update':try{function _0x46ed91(_0x23cdc5){var _0x4ee9aa,_0x3625d7,_0x241acb,_0x220491,_0x206101,_0x17ea11=null;return eval(_0x23cdc5);}}catch(_0x234c9e){$(_0x3a71('0x1f7'))[_0x3a71('0xab')](_0x234c9e[_0x3a71('0xdc')]+':\x20'+_0x234c9e[_0x3a71('0x1f8')]+'\x20[8]');document['getElementById']('SP_STATUS')['title']=_0x234c9e[_0x3a71('0x1c5')];}break;case'vega':case _0x3a71('0x1c7'):case _0x3a71('0x1c9'):case _0x3a71('0x1c8'):case _0x3a71('0x1ca'):WebSAGE[_0x3a71('0x1e0')](_0x4ee9aa);break;default:break;}}break;default:break;}}}if(typeof xPlain!=_0x3a71('0x8f'))if(BrowserDetect[_0x3a71('0x49')]==='Chrome'){setTimeout(function(){var _0x1218b7=document[_0x3a71('0x1f9')]('MouseEvents');_0x1218b7['initMouseEvent'](_0x3a71('0x1be'),!![],!![],window,0x0,0x0,0x0,0x50,0x14,![],![],![],![],0x0,SVGDoc);if(SVGDoc!==undefined)SVGDoc[_0x3a71('0x1fa')](_0x1218b7);},0x64);setTimeout(function(){var _0x350906=document['createEvent'](_0x3a71('0x1fb'));_0x350906[_0x3a71('0x1fc')](_0x3a71('0x1fd'),!![],!![],window,0x0,0x0,0x0,0x50,0x14,![],![],![],![],0x0,null);if(SVGDoc!==undefined)SVGDoc[_0x3a71('0x1fa')](_0x350906);},0x6e);}}try{if(WebSAGE[_0x3a71('0x1fe')]!==NPTO)if(NPTO!=0x0)if(!WebSAGE[_0x3a71('0x1fe')]||typeof WebSAGE[_0x3a71('0x1fe')][_0x3a71('0x1ff')]!=_0x3a71('0x134')||WebSAGE[_0x3a71('0x1fe')][_0x3a71('0x1ff')]===null||WebSAGE[_0x3a71('0x1fe')][_0x3a71('0x1ff')][_0x3a71('0x200')]){WebSAGE[_0x3a71('0x201')](NPTO);NPTO=0x0;}}catch(_0x324288){WebSAGE[_0x3a71('0x201')](NPTO);NPTO=0x0;}$(_0x3a71('0x202'))['text'](Data);WebSAGE[_0x3a71('0x203')]=0x0;if(document[_0x3a71('0x133')](_0x3a71('0x1db'))['style'][_0x3a71('0xb4')]==0x0)document[_0x3a71('0x133')](_0x3a71('0x1db'))[_0x3a71('0x1a')][_0x3a71('0xb4')]=0x1;},'doSilenciaBeep':function(){document['getElementById'](_0x3a71('0x204'))[_0x3a71('0x1a')]['display']=_0x3a71('0x1c');WebSAGE['getScript'](WebSAGE[_0x3a71('0x205')]+_0x3a71('0x206'));},'produzDestaq':function(_0x3a1b2a,_0x21a2dd){},'produzEtiq':function(_0x35d8f0,_0x3de422){},'visibEtiq':function(_0x28bb01){},'produzRelac':function(_0x2a7011,_0x31d9eb){},'mostraescRelac':function(){},'falhaTudo':function(){for(var _0x1f988a in F){F[_0x1f988a]|=0x80;}Sha1Ana='';Sha1Dig='';WebSAGE['showValsSVG']();},'hideShowBar':function(){if(document['getElementById'](_0x3a71('0x207'))[_0x3a71('0x1a')][_0x3a71('0x1b')]!=_0x3a71('0x1c'))return;if(document[_0x3a71('0x133')](_0x3a71('0x1db'))[_0x3a71('0x1a')][_0x3a71('0x16e')]==_0x3a71('0x208')){document['getElementById'](_0x3a71('0x209'))[_0x3a71('0x1a')][_0x3a71('0x1b')]='';$(_0x3a71('0x20a'))[_0x3a71('0x12b')]({'top':_0x3a71('0x208')});$('#svgdiv')[_0x3a71('0x12b')]({'top':_0x3a71('0x20b')});$('#almbox')[_0x3a71('0x12b')]({'top':_0x3a71('0x208')});}else{$(_0x3a71('0x20a'))[_0x3a71('0x12b')]({'top':_0x3a71('0x20c')});$(_0x3a71('0x20d'))[_0x3a71('0x12b')]({'top':_0x3a71('0x208')});$(_0x3a71('0x20e'))[_0x3a71('0x12b')]({'top':_0x3a71('0x20f')});}},'zoomPan':function(_0x471709,_0x37c67d){if(SVGDoc===null){return;}if(_0x37c67d===undefined)_0x37c67d=0x1;switch(_0x471709){case 0x0:case 0x2:WebSAGE['g_zpW']=WebSAGE[_0x3a71('0x210')]*0.9;WebSAGE[_0x3a71('0x211')]=WebSAGE['g_zpH']*0.9;WebSAGE[_0x3a71('0x212')]=WebSAGE[_0x3a71('0x212')]+0x1;break;case 0x1:WebSAGE[_0x3a71('0x213')]=WebSAGE['g_zpY']+_0x37c67d*0x14*WebSAGE[_0x3a71('0x210')]/ScreenViewer_SVGMaxWidth;break;case 0x3:WebSAGE[_0x3a71('0x212')]=WebSAGE[_0x3a71('0x212')]+_0x37c67d*0x1e*WebSAGE[_0x3a71('0x210')]/ScreenViewer_SVGMaxWidth;break;case 0x4:WebSAGE[_0x3a71('0x212')]=0x0;WebSAGE[_0x3a71('0x213')]=0x0;WebSAGE[_0x3a71('0x210')]=ScreenViewer_SVGMaxWidth;WebSAGE[_0x3a71('0x211')]=ScreenViewer_SVGMaxHeight;break;case 0x5:WebSAGE[_0x3a71('0x212')]=WebSAGE[_0x3a71('0x212')]-_0x37c67d*0x1e*WebSAGE['g_zpW']/ScreenViewer_SVGMaxWidth;break;case 0x6:case 0x8:WebSAGE[_0x3a71('0x210')]=WebSAGE[_0x3a71('0x210')]*1.1;WebSAGE['g_zpH']=WebSAGE['g_zpH']*1.1;WebSAGE[_0x3a71('0x212')]=WebSAGE['g_zpX']+0x1;break;case 0x7:WebSAGE[_0x3a71('0x213')]=WebSAGE[_0x3a71('0x213')]-_0x37c67d*0x14*WebSAGE[_0x3a71('0x210')]/ScreenViewer_SVGMaxWidth;break;case 0x9:WebSAGE[_0x3a71('0x210')]=WebSAGE[_0x3a71('0x210')]*1.3;WebSAGE[_0x3a71('0x211')]=WebSAGE[_0x3a71('0x211')]*1.3;WebSAGE[_0x3a71('0x212')]=WebSAGE[_0x3a71('0x212')]+0x1;break;default:break;}SVGDoc[_0x3a71('0x12a')](null,'viewBox',WebSAGE[_0x3a71('0x212')]+'\x20'+WebSAGE[_0x3a71('0x213')]+'\x20'+WebSAGE[_0x3a71('0x210')]+'\x20'+WebSAGE[_0x3a71('0x211')]);},'anteTela':function(){if(WebSAGE[_0x3a71('0x214')][_0x3a71('0x215')]>0x1){WebSAGE['g_seltela'][_0x3a71('0x215')]--;document[_0x3a71('0x216')][_0x3a71('0x217')]();}},'proxTela':function(){if(WebSAGE['g_seltela'][_0x3a71('0x215')]<WebSAGE[_0x3a71('0x214')][_0x3a71('0x2c')]-0x1){WebSAGE[_0x3a71('0x214')][_0x3a71('0x215')]++;document[_0x3a71('0x216')][_0x3a71('0x217')]();}},'playSlideshow':function(){if(WebSAGE['g_seltela'][_0x3a71('0x215')]<WebSAGE['g_seltela'][_0x3a71('0x2c')]-0x1){WebSAGE[_0x3a71('0x214')][_0x3a71('0x215')]++;}else{WebSAGE[_0x3a71('0x214')]['selectedIndex']=0x1;}document['getElementById'](_0x3a71('0x218'))[_0x3a71('0x24')]=0x1;document['getElementById'](_0x3a71('0x218'))[_0x3a71('0xdc')]=_0x3a71('0x218');document[_0x3a71('0x216')][_0x3a71('0x217')]();},'pauseSlideshow':function(){if(ScreenViewer_EnableTimeMachine){$(_0x3a71('0x219'))[_0x3a71('0x21a')](_0x3a71('0x1b'),'');}$(_0x3a71('0x21b'))['css'](_0x3a71('0x1b'),'');$(_0x3a71('0x21c'))[_0x3a71('0x21a')](_0x3a71('0x1b'),_0x3a71('0x1c'));document[_0x3a71('0x133')]('PLAY')[_0x3a71('0x24')]=0x0;clearTimeout(WebSAGE[_0x3a71('0x21d')]);},'reload':function(_0x40e25c){if(_0x40e25c===_0x3a71('0x90')){var _0x2bec83=new Date(new Date()[_0x3a71('0x6')]()+0x3e8*0x3c*0x3c*0x18);_0x2bec83[_0x3a71('0x21e')](0x4);_0x2bec83[_0x3a71('0x21f')](Math['random']()*0x3c);var _0x3126e8=_0x2bec83-new Date();setTimeout(WebSAGE[_0x3a71('0x220')],_0x3126e8);return;}if(NPTO==0x0){if(document[_0x3a71('0x133')](_0x3a71('0x218'))[_0x3a71('0x24')]==0x1){document[_0x3a71('0x133')](_0x3a71('0x218'))[_0x3a71('0xdc')]=_0x3a71('0x218');}if(tela!=''){document[_0x3a71('0x133')](_0x3a71('0x221'))[_0x3a71('0x24')]=tela;document[_0x3a71('0x133')](_0x3a71('0x221'))['name']=_0x3a71('0x221');}if(WebSAGE['g_zpX']!=0x0){document['getElementById'](_0x3a71('0x222'))[_0x3a71('0x24')]=WebSAGE[_0x3a71('0x212')];document['getElementById'](_0x3a71('0x222'))['name']='ZPX';}if(WebSAGE[_0x3a71('0x213')]!=0x0){document[_0x3a71('0x133')]('ZPY')[_0x3a71('0x24')]=WebSAGE[_0x3a71('0x213')];document[_0x3a71('0x133')](_0x3a71('0x223'))[_0x3a71('0xdc')]='ZPY';}if(WebSAGE['g_zpW']!=0x0){document['getElementById'](_0x3a71('0x224'))[_0x3a71('0x24')]=WebSAGE[_0x3a71('0x210')];document[_0x3a71('0x133')](_0x3a71('0x224'))['name']=_0x3a71('0x224');}if(WebSAGE['g_zpH']!=0x0){document[_0x3a71('0x133')]('ZPH')[_0x3a71('0x24')]=WebSAGE[_0x3a71('0x211')];document[_0x3a71('0x133')](_0x3a71('0x225'))[_0x3a71('0xdc')]=_0x3a71('0x225');}if(WebSAGE[_0x3a71('0x226')]!=0x0){document[_0x3a71('0x133')](_0x3a71('0x227'))[_0x3a71('0x24')]=WebSAGE['g_hidetoolbar'];document[_0x3a71('0x133')]('HIDETB')['name']='HIDETB';}for(var _0x4f10c6=0x0;_0x4f10c6<0x14;_0x4f10c6++)if(typeof WebSAGE[_0x3a71('0x175')][_0x4f10c6]=='string'&&WebSAGE[_0x3a71('0x175')][_0x4f10c6]!=''){document[_0x3a71('0x133')](_0x3a71('0x228')+(_0x4f10c6+0x1))[_0x3a71('0x24')]=WebSAGE[_0x3a71('0x175')][_0x4f10c6]||'';document[_0x3a71('0x133')](_0x3a71('0x228')+(_0x4f10c6+0x1))[_0x3a71('0xdc')]=_0x3a71('0x228')+(_0x4f10c6+0x1);}fmTELA[_0x3a71('0x217')]();}else{setTimeout(WebSAGE[_0x3a71('0x220')],0x3c*0x3c*0x3e8);}},'reconhece':function(_0x52ede4){if(WebSAGE['getFlags'](_0x52ede4)&0x100){WebSAGE['getScript'](WebSAGE[_0x3a71('0x205')]+'?R='+_0x52ede4+'&D=00/00/0000&H=00:00:00&M=000&A=0&'+'PS='+WebSAGE[_0x3a71('0x229')]++);}},'setaCorFundo':function(_0x2892ee){if(_0x2892ee==_0x3a71('0x1c')){var _0x3615df=SVGDoc[_0x3a71('0x133')](_0x3a71('0x22a'));if(_0x3615df)VisorTelas_BackgroundSVG=_0x2892ee=_0x3615df['attributes'][_0x3a71('0x22b')][_0x3a71('0x24')];else return;}SVGDoc[_0x3a71('0x12a')](null,_0x3a71('0x1a'),_0x3a71('0x22c')+_0x2892ee+';');$(_0x3a71('0x20d'))['css']('background-color',_0x2892ee);if(WebSAGE[_0x3a71('0x22d')]){}else{if(typeof WebSAGE[_0x3a71('0x22e')]==_0x3a71('0x134')){WebSAGE[_0x3a71('0x22e')][_0x3a71('0x12a')](null,_0x3a71('0x1a'),'fill:'+_0x2892ee);}}document[_0x3a71('0x22f')][_0x3a71('0x230')]=_0x2892ee;},'mostraDestaqPonto':function(_0x15377b){var _0x395e28=SVGDoc[_0x3a71('0x133')](_0x3a71('0x231')+_0x15377b);if(_0x395e28==null)_0x395e28=SVGDoc[_0x3a71('0x133')](_0x3a71('0x231')+TAGS[_0x15377b]);if(_0x395e28!=null){_0x395e28[_0x3a71('0x12a')](null,_0x3a71('0x1b'),'inline');if(typeof _0x395e28[_0x3a71('0x232')]['beginElement']!=_0x3a71('0x8f')){_0x395e28[_0x3a71('0x232')][_0x3a71('0x132')]();_0x395e28[_0x3a71('0x232')]['beginElement']();}}},'escondeDestaqPonto':function(_0x38a96b){var _0x39c254=SVGDoc[_0x3a71('0x133')](_0x3a71('0x231')+_0x38a96b);if(_0x39c254==null)_0x39c254=SVGDoc[_0x3a71('0x133')](_0x3a71('0x231')+TAGS[_0x38a96b]);if(_0x39c254!==null){_0x39c254[_0x3a71('0x12a')](null,_0x3a71('0x1b'),'none');if(typeof _0x39c254['anim']!==_0x3a71('0x8f'))if(_0x39c254[_0x3a71('0x232')][_0x3a71('0x132')]){_0x39c254[_0x3a71('0x232')]['endElement']();}}},'listaDestacaveis':function(){var _0x4d996c;var _0x4c76fb;for(_0x4c76fb in V){_0x4d996c=SVGDoc[_0x3a71('0x133')](_0x3a71('0x231')+_0x4c76fb);if(_0x4d996c!=null){WebSAGE[_0x3a71('0x233')][_0x3a71('0x6d')](_0x4c76fb);}}},'mostraDestaqSel':function(_0x19cb8c,_0x9dedbb){if(NPTO!=0x0){return;}var _0x2bf4f2=WebSAGE[_0x3a71('0x234')]+_0x19cb8c;var _0x248391;WebSAGE[_0x3a71('0x201')](WebSAGE['g_destaqList'][WebSAGE[_0x3a71('0x234')]]);if(_0x2bf4f2<0x0){_0x2bf4f2=WebSAGE[_0x3a71('0x233')]['length']-0x1;}if(_0x2bf4f2>=WebSAGE[_0x3a71('0x233')][_0x3a71('0x2c')]){_0x2bf4f2=0x0;}if(_0x9dedbb==0x1){var _0x2ba8eb=-0x1;for(var _0x28b402=_0x2bf4f2;_0x28b402<WebSAGE[_0x3a71('0x233')]['length']&&_0x28b402>=0x0;_0x28b402=_0x28b402+_0x19cb8c){if(WebSAGE[_0x3a71('0x157')](WebSAGE[_0x3a71('0x233')][_0x28b402])&0x4000){_0x2ba8eb=_0x28b402;break;}}_0x2bf4f2=_0x2ba8eb;}WebSAGE[_0x3a71('0x234')]=_0x2bf4f2;if(_0x2bf4f2!=-0x1){WebSAGE[_0x3a71('0x235')](WebSAGE[_0x3a71('0x233')][WebSAGE[_0x3a71('0x234')]]);setTimeout(_0x3a71('0x236')+WebSAGE[_0x3a71('0x233')][WebSAGE[_0x3a71('0x234')]]+')',0x1388);}},'setupTimeMachine':function(){},'TraduzCor':function(_0x583e51){var _0x20969b;if(_0x583e51['substr'](0x0,0x5)==_0x3a71('0x237')||_0x583e51['substr'](0x0,0x5)==_0x3a71('0x238')||_0x583e51['substr'](0x0,0x5)==_0x3a71('0x239'))switch(_0x583e51){case _0x3a71('0x23a'):_0x583e51=PBIColorBackground;break;case _0x3a71('0x23b'):_0x583e51=PBIColorForeground;break;case'-pbi-bad':_0x583e51=PBIColorBad;break;case'-pbi-good':_0x583e51=PBIColorBad;break;case'-pbi-maximum':_0x583e51=PBIColorMaximum;break;case _0x3a71('0x23c'):_0x583e51=PBIColorMinimum;break;case _0x3a71('0x23d'):_0x583e51=PBIColorSelected;break;case _0x3a71('0x23e'):_0x583e51=PBIColorNegative;break;case'-pbi-positive':_0x583e51=PBIColorPositive;break;case _0x3a71('0x23f'):case _0x3a71('0x240'):case _0x3a71('0x241'):_0x583e51=VisorTelas_BackgroundSVG;break;case'-clr-tbr':case'-cor-tbr':_0x583e51=ScreenViewer_ToolbarColor;break;case _0x3a71('0x242'):case _0x3a71('0x243'):_0x583e51=VisorTelas_CorAlarmeInibido;break;case'-clr-failed':case _0x3a71('0x244'):_0x583e51=VisorTelas_Medidas_Cor_Falha;break;default:if(_0x583e51[_0x3a71('0x14a')](0x0,0x5)=='-pbi-'){_0x20969b=parseInt(_0x583e51[_0x3a71('0x14a')](0x5,0x3),0xa);if(isNaN(_0x20969b)){_0x583e51=_0x3a71('0x1c');}else{_0x20969b=_0x20969b>0x0?_0x20969b-0x1:0x0;_0x583e51=PBIColorTable[_0x20969b]['value'];}}else{_0x20969b=parseInt(_0x583e51[_0x3a71('0x14a')](0x5,0x3),0xa);if(isNaN(_0x20969b)){_0x583e51=_0x3a71('0x1c');}else{_0x583e51=ScreenViewer_ColorTable[_0x20969b];}}break;}return _0x583e51;},'makeDraggable':function(_0x14afe8){if(!_0x14afe8)return;_0x14afe8[_0x3a71('0x1a')][_0x3a71('0x17a')]=_0x3a71('0x245');_0x14afe8[_0x3a71('0x246')]=![];_0x14afe8[_0x3a71('0x247')]=0x0;_0x14afe8[_0x3a71('0x248')]=0x0;if(typeof _0x14afe8[_0x3a71('0x135')]===_0x3a71('0x8f'))_0x14afe8['inittransform']=_0x14afe8[_0x3a71('0x136')](null,'transform');if(_0x14afe8[_0x3a71('0x135')]===null)_0x14afe8[_0x3a71('0x135')]='';$(_0x14afe8)[_0x3a71('0x249')](_0x3a71('0x1be'),function(_0x1e5975){if(_0x14afe8['style'][_0x3a71('0x1b')]==_0x3a71('0x1c')){_0x14afe8[_0x3a71('0x1a')]['cursor']=_0x3a71('0x245');_0x14afe8['drgDragging']=![];_0x14afe8['drgMouseOffsetX']=0x0;_0x14afe8[_0x3a71('0x24a')]=0x0;window[_0x3a71('0x24b')]=null;return;}_0x14afe8[_0x3a71('0x1a')][_0x3a71('0x17a')]=_0x3a71('0x24c');_0x14afe8[_0x3a71('0x246')]=!![];window[_0x3a71('0x24b')]=_0x14afe8;var _0x5bdf0d=SVGDoc[_0x3a71('0x24d')]();_0x5bdf0d['x']=_0x1e5975[_0x3a71('0x24e')];_0x5bdf0d['y']=_0x1e5975['clientY'];var _0x472f6f=_0x14afe8[_0x3a71('0xa8')][_0x3a71('0x24f')]();_0x14afe8[_0x3a71('0x250')]=_0x5bdf0d['x']-_0x14afe8[_0x3a71('0x247')];_0x14afe8['drgMouseOffsetY']=_0x5bdf0d['y']-_0x14afe8[_0x3a71('0x248')];});$(_0x14afe8)[_0x3a71('0x249')]('mouseup',function(_0x4a750c){_0x14afe8[_0x3a71('0x1a')][_0x3a71('0x17a')]=_0x3a71('0x245');_0x14afe8[_0x3a71('0x246')]=![];_0x14afe8[_0x3a71('0x250')]=0x0;_0x14afe8['drgMouseOffsetY']=0x0;window[_0x3a71('0x24b')]=null;});$(_0x14afe8)[_0x3a71('0x249')](_0x3a71('0x1bf'),function(_0x2d6b66){if(_0x14afe8[_0x3a71('0x246')]===!![]){var _0x186d33=SVGDoc[_0x3a71('0x24d')]();_0x186d33['x']=_0x2d6b66[_0x3a71('0x24e')];_0x186d33['y']=_0x2d6b66[_0x3a71('0x251')];var _0x205681=_0x14afe8[_0x3a71('0xa8')][_0x3a71('0x24f')]();_0x186d33['x']-=_0x14afe8[_0x3a71('0x250')];_0x186d33['y']-=_0x14afe8[_0x3a71('0x24a')];window[_0x3a71('0x252')]=_0x2d6b66[_0x3a71('0x24e')];window[_0x3a71('0x253')]=_0x2d6b66[_0x3a71('0x251')];_0x14afe8[_0x3a71('0x247')]=_0x186d33['x'];_0x14afe8['drgY']=_0x186d33['y'];_0x205681['e']=_0x205681['f']=0x0;_0x186d33=_0x186d33['matrixTransform'](_0x205681[_0x3a71('0x254')]());_0x14afe8[_0x3a71('0x12a')](null,_0x3a71('0xb6'),_0x3a71('0xb7')+_0x186d33['x']+','+_0x186d33['y']+')\x20'+_0x14afe8[_0x3a71('0x135')]);_0x2d6b66[_0x3a71('0x72')]();}});},'init':function(){var _0x4be628;WebSAGE['g_loadtime']=new Date();try{SVGDoc=document['getElementById'](_0x3a71('0x1db'))[_0x3a71('0x196')];if(SVGDoc==null&&tela!==''){return;}if(BrowserDetect['OS']!=_0x3a71('0x6b')){}else{ANIMA=0x0;}WebSAGE['g_isInkscape']=(SVGDoc[_0x3a71('0x136')](null,'inkscape:version')||SVGDoc[_0x3a71('0x136')]('http://www.inkscape.org/namespaces/inkscape','version'))!='';if(WebSAGE[_0x3a71('0x22d')]){VisorTelas_BackgroundSVG=ScreenViewer_Background;}if(SVGDoc!=null)WebSAGE['setaCorFundo'](VisorTelas_BackgroundSVG);}catch(_0x2f0578){return;}document[_0x3a71('0x255')]=function(){return![];};$(_0x3a71('0x256'))[_0x3a71('0xbd')]('<style>\x20body\x20{\x20user-select:none;\x20-webkit-user-select:none;\x20}\x20</style>');if(typeof SVGDoc!=_0x3a71('0x8f'))if(SVGDoc!=null){SVGDoc['oncontextmenu']=function(){return![];};}document[_0x3a71('0x22f')][_0x3a71('0x1a')]['overflowX']=_0x3a71('0x257');document[_0x3a71('0x22f')][_0x3a71('0x1a')][_0x3a71('0x258')]='hidden';if(typeof SVGDoc!=_0x3a71('0x8f'))if(SVGDoc!=null){SVGDoc['setAttributeNS'](null,_0x3a71('0xb1'),ScreenViewer_SVGMaxWidth);SVGDoc[_0x3a71('0x12a')](null,'height',ScreenViewer_SVGMaxHeight);SVGDoc[_0x3a71('0x259')]=new Function('return\x20false;');}WebSAGE['reload'](_0x3a71('0x90'));WebSAGE['g_zpW']=ScreenViewer_SVGMaxWidth;WebSAGE[_0x3a71('0x211')]=ScreenViewer_SVGMaxHeight;try{WebSAGE[_0x3a71('0x25a')]();}catch(_0xbc5de2){}if(!isNaN(parseInt(gup(_0x3a71('0x222'))))||!isNaN(parseInt(gup(_0x3a71('0x223'))))||!isNaN(parseInt(gup('ZPW')))||!isNaN(parseInt(gup(_0x3a71('0x225'))))){WebSAGE[_0x3a71('0x212')]=parseInt(gup(_0x3a71('0x222'))||0x0);WebSAGE[_0x3a71('0x213')]=parseInt(gup(_0x3a71('0x223'))||0x0);WebSAGE[_0x3a71('0x210')]=parseInt(gup(_0x3a71('0x224'))||ScreenViewer_SVGMaxWidth);WebSAGE[_0x3a71('0x211')]=parseInt(gup(_0x3a71('0x225'))||ScreenViewer_SVGMaxHeight);WebSAGE['zoomPan'](0xa);}$(SVGDoc)['bind'](_0x3a71('0x1be'),function(_0x159a4c){if(!_0x159a4c['originalEvent']['isTrusted']&&_0x159a4c[_0x3a71('0x24e')]===0x50&&_0x159a4c[_0x3a71('0x251')]===0x14)return;});$(SVGDoc)['bind'](_0x3a71('0x1fd'),function(_0x205805){if(!_0x205805['originalEvent']['isTrusted']&&_0x205805[_0x3a71('0x24e')]===0x50&&_0x205805[_0x3a71('0x251')]===0x14)return;});}};var $V=WebSAGE[_0x3a71('0x13e')];var $F=WebSAGE[_0x3a71('0x157')];var $T=WebSAGE[_0x3a71('0x6')];var $W=WebSAGE;$W[_0x3a71('0x25b')]=$W[_0x3a71('0x1a1')];_0x3a71('0x127');WebSAGE[_0x3a71('0x25c')]=0x0;WebSAGE[_0x3a71('0x25d')]=function(_0x2ced05){return _0x2ced05[_0x3a71('0xb')](/-pbi-([0-9]+)/g,function(_0x3aa316,_0x305b6d,_0x4b98d5,_0x6d88b5){var _0xcc3913=parseInt(_0x3aa316['substr'](0x5,0x3),0xa);_0xcc3913=_0xcc3913>0x0?_0xcc3913-0x1:0x0;if(_0xcc3913 in PBIColorTable)return PBIColorTable[_0xcc3913][_0x3a71('0x24')];if(_0xcc3913 in ScreenViewer_ColorTable)return ScreenViewer_ColorTable[_0xcc3913];return'gray';});};WebSAGE[_0x3a71('0x18e')]=function(_0x187bdf,_0x2a59cf,_0x5bc487){var _0x261274;function _0xb3c069(_0x31df76){if(typeof _0x31df76['data'][0x0][_0x3a71('0xdc')]!=_0x3a71('0x8f'))_0x5bc487[_0x3a71('0x25e')][0x0]=_0x31df76[_0x3a71('0xbb')][0x0][_0x3a71('0xdc')];else _0x5bc487[_0x3a71('0x25e')][0x0]=_0x3a71('0x25f');var _0x1b5340=vg[_0x3a71('0x176')][_0x3a71('0x260')](_0x31df76,function(_0x19d658,_0x3c5734){try{var _0x29d011;WebSAGE[_0x3a71('0x25c')]++;_0x5bc487[_0x3a71('0x261')]=_0x3a71('0x262')+WebSAGE['g_vega_num'];$('#VEGACHARTS')[_0x3a71('0xbd')]('<div\x20id=\x27'+_0x5bc487[_0x3a71('0x261')]+'\x27><div>');_0x5bc487['vw']=_0x3c5734({'el':_0x3a71('0x263')+WebSAGE[_0x3a71('0x25c')],'renderer':_0x3a71('0xfc')})[_0x3a71('0x264')]();if(typeof _0x5bc487[_0x3a71('0x265')]!=_0x3a71('0x8f'))_0x5bc487['vw']['_model'][_0x3a71('0x266')][_0x3a71('0xbb')][0x0][_0x3a71('0x267')]=_0x5bc487[_0x3a71('0x265')];var _0xe487b4='layer1';var _0x504ebc=SVGDoc[_0x3a71('0x133')](_0x3a71('0x22a'));if(_0x504ebc)_0xe487b4=_0x504ebc[_0x3a71('0x268')][_0x3a71('0x269')][_0x3a71('0x24')];_0x29d011=d3[_0x3a71('0xaa')](SVGDoc);_0x29d011[_0x3a71('0xaa')]('#vg_'+_0x5bc487['id'])[_0x3a71('0xcd')]();if(_0x5bc487[_0x3a71('0xa8')][_0x3a71('0x2e')]=='g'){_0x5bc487['vg']=_0x29d011[_0x3a71('0xaa')]('#'+_0x5bc487[_0x3a71('0xa8')]['id'])[_0x3a71('0xbd')]('g')[_0x3a71('0x26a')]($(_0x3a71('0x263')+WebSAGE[_0x3a71('0x25c')]+_0x3a71('0x26b'))[0x0][_0x3a71('0x2d')][0x0]['childNodes'][0x0][_0x3a71('0x1d2')]);}else{_0x5bc487['vg']=_0x29d011[_0x3a71('0xaa')]('#'+_0xe487b4)[_0x3a71('0xbd')]('g')[_0x3a71('0x26a')]($(_0x3a71('0x263')+WebSAGE[_0x3a71('0x25c')]+'\x20.vega')[0x0][_0x3a71('0x2d')][0x0]['childNodes'][0x0][_0x3a71('0x1d2')]);}_0x5bc487['vg'][0x0][0x0]['id']='vg_'+_0x5bc487['id'];_0x5bc487['vg'][0x0][0x0][_0x3a71('0x12a')](null,_0x3a71('0xb6'),(_0x5bc487[_0x3a71('0x136')](null,_0x3a71('0xb6'))||'')+_0x3a71('0x137')+_0x5bc487[_0x3a71('0x136')](null,'x')+'\x20'+_0x5bc487[_0x3a71('0x136')](null,'y')+')\x20'+_0x3a71('0x26c')+_0x5bc487[_0x3a71('0x136')](null,_0x3a71('0xb1'))/_0x5bc487['vw'][_0x3a71('0x26d')]+'\x20'+_0x5bc487['getAttributeNS'](null,_0x3a71('0xb2'))/_0x5bc487['vw'][_0x3a71('0x26e')]+')\x20');_0x5bc487['inittransform']=_0x5bc487['vg'][0x0][0x0][_0x3a71('0x136')](null,'transform');if(_0x5bc487['vw'][_0x3a71('0xbb')](_0x5bc487[_0x3a71('0x25e')][0x0])[_0x3a71('0x26f')]()[_0x3a71('0x2c')]==0x0)_0x5bc487[_0x3a71('0x270')]=JSON[_0x3a71('0x176')](JSON[_0x3a71('0x271')](_0x5bc487['vw'][_0x3a71('0x272')][_0x3a71('0x273')][_0x3a71('0x274')][_0x3a71('0x273')]));else _0x5bc487['vgInitData']=JSON[_0x3a71('0x176')](JSON[_0x3a71('0x271')](_0x5bc487['vw'][_0x3a71('0xbb')](_0x5bc487[_0x3a71('0x25e')][0x0])['values']()));}catch(_0x3f463b){console[_0x3a71('0x15f')]('erro'+_0x3f463b);};});};function _0x393006(_0x251119){if(typeof _0x251119[_0x3a71('0xbb')][0x0][_0x3a71('0xdc')]!=_0x3a71('0x8f'))_0x5bc487[_0x3a71('0x25e')][0x0]=_0x251119[_0x3a71('0xbb')][0x0][_0x3a71('0xdc')];else _0x5bc487[_0x3a71('0x25e')][0x0]=_0x3a71('0x25f');var _0x4e44ce=vega[_0x3a71('0x176')](_0x251119);var _0x20e757;WebSAGE[_0x3a71('0x25c')]++;_0x5bc487[_0x3a71('0x261')]=_0x3a71('0x262')+WebSAGE[_0x3a71('0x25c')];$('#VEGACHARTS')[_0x3a71('0xbd')]('<div\x20id=\x27'+_0x5bc487['vgId']+_0x3a71('0x275'));_0x5bc487['vw']=new vega['View'](_0x4e44ce,{'renderer':'svg'})[_0x3a71('0x276')]()[_0x3a71('0x277')]();_0x5bc487['vw']['runAfter'](function(){var _0x46a931=_0x5bc487['vw'][_0x3a71('0x278')]();_0x46a931[_0x3a71('0x279')](function(_0x3baa81){if(typeof _0x5bc487[_0x3a71('0x265')]!=_0x3a71('0x8f')&&typeof _0x5bc487['vw'][_0x3a71('0x272')]!=_0x3a71('0x8f'))_0x5bc487['vw'][_0x3a71('0x272')]['_defs'][_0x3a71('0xbb')][0x0][_0x3a71('0x267')]=_0x5bc487[_0x3a71('0x265')];var _0x18dde9=_0x3a71('0x27a');var _0x3da40f=SVGDoc['getElementById'](_0x3a71('0x22a'));if(_0x3da40f)_0x18dde9=_0x3da40f[_0x3a71('0x268')][_0x3a71('0x269')][_0x3a71('0x24')];_0x20e757=d3[_0x3a71('0xaa')](SVGDoc);_0x20e757[_0x3a71('0xaa')](_0x3a71('0x27b')+_0x5bc487['id'])[_0x3a71('0xcd')]();if(_0x5bc487[_0x3a71('0xa8')][_0x3a71('0x2e')]=='g'){_0x5bc487['vg']=_0x20e757[_0x3a71('0xaa')]('#'+_0x5bc487[_0x3a71('0xa8')]['id'])[_0x3a71('0xbd')]('g')['html'](_0x3baa81);}else{_0x5bc487['vg']=_0x20e757['select']('#'+_0x18dde9)[_0x3a71('0xbd')]('g')['html'](_0x3baa81);}_0x5bc487['vg'][0x0][0x0]['id']=_0x3a71('0x27c')+_0x5bc487['id'];_0x5bc487['vg'][0x0][0x0][_0x3a71('0x12a')](null,_0x3a71('0xb6'),(_0x5bc487[_0x3a71('0x136')](null,_0x3a71('0xb6'))||'')+_0x3a71('0x137')+_0x5bc487['getAttributeNS'](null,'x')+'\x20'+_0x5bc487[_0x3a71('0x136')](null,'y')+')\x20'+_0x3a71('0x26c')+_0x5bc487[_0x3a71('0x136')](null,_0x3a71('0xb1'))/(_0x5bc487['vw']['_width']||0x64)+'\x20'+_0x5bc487['getAttributeNS'](null,_0x3a71('0xb2'))/(_0x5bc487['vw'][_0x3a71('0x26e')]||0x64)+')\x20');_0x5bc487[_0x3a71('0x135')]=_0x5bc487['vg'][0x0][0x0][_0x3a71('0x136')](null,_0x3a71('0xb6'));_0x5bc487[_0x3a71('0x270')]=JSON[_0x3a71('0x176')](JSON['stringify'](_0x5bc487['vw'][_0x3a71('0x27d')]['data'][_0x5bc487[_0x3a71('0x25e')][0x0]][_0x3a71('0x26f')][_0x3a71('0x24')]));});});};switch(_0x187bdf[_0x2a59cf]['tag']){case _0x3a71('0x27e'):WebSAGE['acrescentaPontoLista'](_0x187bdf[_0x2a59cf][_0x3a71('0x33')]);_0x5bc487['_d3arc_tag']=_0x187bdf[_0x2a59cf][_0x3a71('0x33')];var _0x40ae0f=_0x187bdf[_0x2a59cf][_0x3a71('0x183')]['split'](',');_0x5bc487['_d3arc_min']=parseFloat(_0x40ae0f[0x0]||0x0);_0x5bc487[_0x3a71('0x27f')]=parseFloat(_0x40ae0f[0x1]||0x64);_0x5bc487[_0x3a71('0x280')]=parseFloat(_0x40ae0f[0x2]||0x0);_0x5bc487[_0x3a71('0x281')]=parseFloat(_0x40ae0f[0x3]||0x2ee);var _0x229d55=d3[_0x3a71('0xfc')][_0x3a71('0x282')]()[_0x3a71('0x283')](_0x5bc487[_0x3a71('0x280')])[_0x3a71('0x284')](0x64)[_0x3a71('0x285')](0x0)['endAngle'](0x0);var _0x173253=window['d3']['select'](_0x5bc487[_0x3a71('0xa8')])[_0x3a71('0xbd')](_0x3a71('0x1ce'))['style'](_0x3a71('0xac'),_0x3a71('0xfe'))['attr']('d',_0x229d55);_0x5bc487[_0x3a71('0x286')]=_0x173253;_0x5bc487[_0x3a71('0x286')][_0x3a71('0xfd')]({'oldAngle':0x0});_0x173253[0x0][0x0][_0x3a71('0x1a')][_0x3a71('0x287')]=_0x5bc487[_0x3a71('0x1a')][_0x3a71('0x287')];var _0x1f75f9=_0x5bc487[_0x3a71('0xae')]();_0x173253[0x0][0x0][_0x3a71('0x12a')](null,_0x3a71('0xb6'),_0x5bc487['getAttributeNS'](null,_0x3a71('0xb6'))||''+'\x20translate(\x20'+(_0x1f75f9['x']+_0x1f75f9['width']/0x2)+','+(_0x1f75f9['y']+_0x1f75f9[_0x3a71('0xb2')]/0x2)+'\x20'+')\x20'+'\x20scale(\x20'+_0x1f75f9['width']/0xc8+','+_0x1f75f9[_0x3a71('0xb2')]/0xc8+'\x20'+')\x20');_0x5bc487[_0x3a71('0x1a')][_0x3a71('0x1b')]='none';break;case _0x3a71('0x288'):{_0x5bc487[_0x3a71('0x25e')]=[];_0x5bc487[_0x3a71('0x1a')][_0x3a71('0x1b')]='none';_0x5bc487[_0x3a71('0x181')]=_0x187bdf[_0x2a59cf]['src'][_0x3a71('0x40')](',');for(_0x261274=0x0;_0x261274<_0x5bc487[_0x3a71('0x181')]['length'];_0x261274++){WebSAGE['acrescentaPontoLista'](_0x5bc487[_0x3a71('0x181')][_0x261274]);}function _0x1dcad8(_0x29db03){var _0x31d63f;_0x29db03=WebSAGE['TranslateColorsVega'](_0x29db03);if(typeof _0x29db03==='object'){_0x31d63f=vl[_0x3a71('0x289')](_0x29db03)[_0x3a71('0x260')];_0x31d63f[_0x3a71('0xb1')]=_0x31d63f[_0x3a71('0xb1')]||0x64;_0x31d63f[_0x3a71('0xb2')]=_0x31d63f[_0x3a71('0xb2')]||0x64;}else{var _0x1a157f=JSON[_0x3a71('0x176')](_0x29db03);_0x31d63f=vl[_0x3a71('0x289')](_0x1a157f)[_0x3a71('0x260')];_0x31d63f['width']=_0x31d63f['width']||_0x1a157f[_0x3a71('0xb1')]||0x64;_0x31d63f['height']=_0x31d63f[_0x3a71('0xb2')]||_0x1a157f[_0x3a71('0xb2')]||0x64;}if(typeof _0x31d63f[_0x3a71('0xbb')][0x0][_0x3a71('0x267')]!=_0x3a71('0x8f')){_0x5bc487['vgFormat']=_0x31d63f['data'][0x0][_0x3a71('0x267')];_0x31d63f[_0x3a71('0xbb')][0x0]['format']={};}_0x393006(_0x31d63f);}if(_0x187bdf[_0x2a59cf][_0x3a71('0x183')]['indexOf']('{')==0x0)_0x1dcad8(_0x187bdf[_0x2a59cf][_0x3a71('0x183')]);else $[_0x3a71('0x194')](_0x187bdf[_0x2a59cf][_0x3a71('0x183')]+'?'+new Date()[_0x3a71('0x6')](),_0x1dcad8);}break;case _0x3a71('0x28a'):{_0x5bc487['vgTableName']=[];_0x5bc487[_0x3a71('0x1a')][_0x3a71('0x1b')]=_0x3a71('0x1c');var _0x56d939=_0x187bdf[_0x2a59cf]['src'][_0x3a71('0x40')]('|');if(_0x56d939[_0x3a71('0x2c')]>0x1){var _0x28971f=_0x56d939[0x1]['split'](',');if(_0x28971f[_0x3a71('0x2c')]==0x0)_0x5bc487['timespan']=_0x5bc487[_0x3a71('0xb1')][_0x3a71('0x28b')][_0x3a71('0x24')];else _0x5bc487[_0x3a71('0x28c')]=_0x28971f[0x0];}else _0x5bc487['timespan']=_0x5bc487[_0x3a71('0xb1')][_0x3a71('0x28b')]['value'];_0x5bc487[_0x3a71('0x181')]=_0x56d939[0x0][_0x3a71('0x40')](',');for(_0x261274=0x0;_0x261274<_0x5bc487['pnts']['length'];_0x261274++){WebSAGE[_0x3a71('0x177')](_0x5bc487[_0x3a71('0x181')][_0x261274]);}if(_0x187bdf[_0x2a59cf][_0x3a71('0x183')][_0x3a71('0x3d')]('{')==0x0){var _0x1b4414=JSON['parse'](WebSAGE['TranslateColorsVega'](_0x187bdf[_0x2a59cf][_0x3a71('0x183')]));_0xb3c069(_0x1b4414);}else $['get'](_0x187bdf[_0x2a59cf][_0x3a71('0x183')]+'?'+new Date()[_0x3a71('0x6')](),function(_0x4adfdd){var _0x1b4414;if(typeof _0x4adfdd===_0x3a71('0x134'))_0x1b4414=_0x4adfdd;else _0x1b4414=JSON[_0x3a71('0x176')](WebSAGE['TranslateColorsVega'](_0x4adfdd));_0xb3c069(_0x1b4414);});}break;case _0x3a71('0x28d'):{_0x5bc487['vgTableName']=[];_0x5bc487[_0x3a71('0x1a')][_0x3a71('0x1b')]=_0x3a71('0x1c');function _0x2ea3e0(_0x455af2){var _0x1b4414;if(typeof _0x455af2===_0x3a71('0x134'))_0x1b4414=_0x455af2;else _0x1b4414=JSON[_0x3a71('0x176')](WebSAGE['TranslateColorsVega'](_0x455af2));_0xb3c069(_0x1b4414);if(_0x1b4414[_0x3a71('0xbb')][_0x3a71('0x2c')]>0x0)if(typeof _0x1b4414[_0x3a71('0xbb')][0x0]['url']!==_0x3a71('0x8f')){if(typeof _0x1b4414[_0x3a71('0xbb')][0x0][_0x3a71('0x28e')]!=_0x3a71('0x8f'))setInterval(function(){$[_0x3a71('0x194')](_0x1b4414['data'][0x0]['url'],function(_0x455af2){_0x5bc487['vw'][_0x3a71('0xbb')](_0x1b4414['data'][0x0][_0x3a71('0xdc')])[_0x3a71('0xcd')](function(_0x41dcb6){return!![];});if(typeof _0x455af2===_0x3a71('0x52'))_0x5bc487['vw'][_0x3a71('0xbb')](_0x1b4414['data'][0x0][_0x3a71('0xdc')])['insert'](JSON[_0x3a71('0x176')](WebSAGE['TranslateColorsVega'](_0x455af2)));else _0x5bc487['vw'][_0x3a71('0xbb')](_0x1b4414[_0x3a71('0xbb')][0x0][_0x3a71('0xdc')])[_0x3a71('0x28f')](_0x455af2);_0x5bc487['vw'][_0x3a71('0x264')]();_0x5bc487['vg'][_0x3a71('0x26a')]($('#'+_0x5bc487[_0x3a71('0x261')]+_0x3a71('0x26b'))[0x0]['childNodes'][0x0]['childNodes'][0x0][_0x3a71('0x1d2')]);});},_0x1b4414[_0x3a71('0xbb')][0x0]['update_period']*0x3e8);}if(_0x1b4414['data'][_0x3a71('0x2c')]>0x1)if(typeof _0x1b4414[_0x3a71('0xbb')][0x1][_0x3a71('0x290')]!=='undefined'){if(typeof _0x1b4414[_0x3a71('0xbb')][0x1][_0x3a71('0x28e')]!='undefined')setInterval(function(){$[_0x3a71('0x194')](_0x1b4414[_0x3a71('0xbb')][0x1][_0x3a71('0x290')],function(_0x455af2){_0x5bc487['vw']['data'](_0x1b4414[_0x3a71('0xbb')][0x1][_0x3a71('0xdc')])[_0x3a71('0xcd')](function(_0x7ece98){return!![];});if(typeof _0x455af2===_0x3a71('0x52'))_0x5bc487['vw']['data'](_0x1b4414[_0x3a71('0xbb')][0x0][_0x3a71('0xdc')])[_0x3a71('0x28f')](JSON['parse'](WebSAGE[_0x3a71('0x25d')](_0x455af2)));else _0x5bc487['vw']['data'](_0x1b4414[_0x3a71('0xbb')][0x0][_0x3a71('0xdc')])[_0x3a71('0x28f')](_0x455af2);_0x5bc487['vw']['update']();_0x5bc487['vg'][_0x3a71('0x26a')]($('#'+_0x5bc487[_0x3a71('0x261')]+_0x3a71('0x26b'))[0x0][_0x3a71('0x2d')][0x0][_0x3a71('0x2d')][0x0][_0x3a71('0x1d2')]);});},_0x1b4414[_0x3a71('0xbb')][0x1]['update_period']*0x3e8);}}if(_0x187bdf[_0x2a59cf]['prompt'][_0x3a71('0x3d')]('{')==0x0)_0x2ea3e0(_0x187bdf[_0x2a59cf][_0x3a71('0x183')]);else $['get'](_0x187bdf[_0x2a59cf][_0x3a71('0x183')]+'?'+new Date()[_0x3a71('0x6')](),_0x2ea3e0);}break;case _0x3a71('0x291'):case _0x3a71('0x292'):{_0x5bc487[_0x3a71('0x25e')]=[];_0x5bc487['style'][_0x3a71('0x1b')]=_0x3a71('0x1c');var _0x56d939=_0x187bdf[_0x2a59cf][_0x3a71('0x33')]['split']('|');if(_0x56d939['length']>0x1){var _0x28971f=_0x56d939[0x1]['split'](',');if(_0x28971f[_0x3a71('0x2c')]==0x0)_0x5bc487[_0x3a71('0x28c')]=_0x5bc487[_0x3a71('0xb1')][_0x3a71('0x28b')][_0x3a71('0x24')];else _0x5bc487['timespan']=_0x28971f[0x0];}else _0x5bc487[_0x3a71('0x28c')]=_0x5bc487[_0x3a71('0xb1')]['baseVal'][_0x3a71('0x24')];_0x5bc487[_0x3a71('0x181')]=_0x56d939[0x0][_0x3a71('0x40')](',');for(_0x261274=0x0;_0x261274<_0x5bc487[_0x3a71('0x181')][_0x3a71('0x2c')];_0x261274++){WebSAGE['acrescentaPontoLista'](_0x5bc487[_0x3a71('0x181')][_0x261274]);}if(_0x187bdf[_0x2a59cf][_0x3a71('0x183')][_0x3a71('0x3d')]('{')==0x0){var _0x1b4414=JSON[_0x3a71('0x176')](WebSAGE[_0x3a71('0x25d')](_0x187bdf[_0x2a59cf][_0x3a71('0x183')]));_0x1b4414['width']=_0x1b4414[_0x3a71('0xb1')]||0x64;_0x1b4414[_0x3a71('0xb2')]=_0x1b4414[_0x3a71('0xb2')]||0x64;_0x393006(_0x1b4414);}else $[_0x3a71('0x194')](_0x187bdf[_0x2a59cf][_0x3a71('0x183')]+'?'+new Date()[_0x3a71('0x6')](),function(_0x52e27f){var _0x1b4414;if(typeof _0x52e27f===_0x3a71('0x134'))_0x1b4414=_0x52e27f;else _0x1b4414=JSON[_0x3a71('0x176')](WebSAGE[_0x3a71('0x25d')](_0x52e27f));_0x1b4414['width']=_0x1b4414[_0x3a71('0xb1')]||0x64;_0x1b4414[_0x3a71('0xb2')]=_0x1b4414[_0x3a71('0xb2')]||0x64;_0x393006(_0x1b4414);});}break;case _0x3a71('0x293'):case _0x3a71('0x294'):{_0x5bc487[_0x3a71('0x25e')]=[];_0x5bc487['style'][_0x3a71('0x1b')]='none';function _0x46bc7b(_0x36a06a){var _0x1b4414;if(typeof _0x36a06a===_0x3a71('0x134'))_0x1b4414=_0x36a06a;else _0x1b4414=JSON[_0x3a71('0x176')](_0x36a06a);_0x393006(_0x1b4414);if(_0x1b4414['data']['length']>0x0)if(typeof _0x1b4414[_0x3a71('0xbb')][0x0][_0x3a71('0x290')]!=='undefined'){if(typeof _0x1b4414[_0x3a71('0xbb')][0x0][_0x3a71('0x28e')]!=_0x3a71('0x8f'))setInterval(function(){$[_0x3a71('0x194')](_0x1b4414[_0x3a71('0xbb')][0x0][_0x3a71('0x290')],function(_0x36a06a){if(typeof _0x36a06a===_0x3a71('0x52'))_0x5bc487['vw']['change'](_0x1b4414[_0x3a71('0xbb')][0x0][_0x3a71('0xdc')],vega[_0x3a71('0x295')]()[_0x3a71('0xcd')](function(_0x178f8c){return!![];})[_0x3a71('0x28f')](JSON['parse'](_0x36a06a)))['run']();else _0x5bc487['vw'][_0x3a71('0x296')](_0x1b4414[_0x3a71('0xbb')][0x0]['name'],vega['changeset']()['remove'](function(_0xe0ec22){return!![];})[_0x3a71('0x28f')](_0x36a06a))[_0x3a71('0x277')]();_0x5bc487['vw'][_0x3a71('0x297')](function(){var _0x3ba650=_0x5bc487['vw'][_0x3a71('0x278')]();_0x3ba650[_0x3a71('0x279')](function(_0x236d7a){_0x5bc487['vg'][_0x3a71('0x26a')](_0x236d7a);});});});},_0x1b4414[_0x3a71('0xbb')][0x0]['update_period']*0x3e8);}if(_0x1b4414[_0x3a71('0xbb')]['length']>0x1)if(typeof _0x1b4414[_0x3a71('0xbb')][0x1][_0x3a71('0x290')]!==_0x3a71('0x8f')){if(typeof _0x1b4414[_0x3a71('0xbb')][0x1][_0x3a71('0x28e')]!=_0x3a71('0x8f'))setInterval(function(){$[_0x3a71('0x194')](_0x1b4414[_0x3a71('0xbb')][0x1][_0x3a71('0x290')],function(_0x36a06a){if(typeof _0x36a06a===_0x3a71('0x52'))_0x5bc487['vw'][_0x3a71('0x296')](_0x1b4414[_0x3a71('0xbb')][0x1]['name'],vega[_0x3a71('0x295')]()['remove'](function(_0x4c05b1){return!![];})[_0x3a71('0x28f')](JSON[_0x3a71('0x176')](_0x36a06a)))[_0x3a71('0x277')]();else _0x5bc487['vw'][_0x3a71('0x296')](_0x1b4414[_0x3a71('0xbb')][0x1]['name'],vega['changeset']()[_0x3a71('0xcd')](function(_0x1af305){return!![];})[_0x3a71('0x28f')](_0x36a06a))[_0x3a71('0x277')]();_0x5bc487['vw'][_0x3a71('0x297')](function(){var _0x27f11d=_0x5bc487['vw']['toSVG']();_0x27f11d[_0x3a71('0x279')](function(_0x9af58d){_0x5bc487['vg'][_0x3a71('0x26a')](_0x9af58d);});});});},_0x1b4414['data'][0x1][_0x3a71('0x28e')]*0x3e8);}}if(_0x187bdf[_0x2a59cf]['prompt'][_0x3a71('0x3d')]('{')==0x0)_0x46bc7b(_0x187bdf[_0x2a59cf]['prompt']);else $[_0x3a71('0x194')](_0x187bdf[_0x2a59cf][_0x3a71('0x183')]+'?'+new Date()['getTime'](),_0x46bc7b);}break;}};WebSAGE[_0x3a71('0x1e0')]=function(_0x57ce33){var _0x56e6d7;var _0x3da54c;switch(WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x164')]){case _0x3a71('0x27e'):var _0x3421c2=WebSAGE['valorTagueado'](WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x165')][_0x3a71('0x298')],WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x165')]);var _0x4c3f28=(_0x3421c2-WebSAGE['InkSage'][_0x57ce33][_0x3a71('0x165')]['_d3arc_min'])/(WebSAGE[_0x3a71('0x138')][_0x57ce33]['parent']['_d3arc_max']-WebSAGE[_0x3a71('0x138')][_0x57ce33]['parent']['_d3arc_min']);var _0x4e9cb0=d3['svg'][_0x3a71('0x282')]()[_0x3a71('0x283')](WebSAGE['InkSage'][_0x57ce33][_0x3a71('0x165')]['_d3arc_innerRadius'])[_0x3a71('0x284')](0x64)[_0x3a71('0x285')](0x0);function _0x223188(_0x307a3f){return function(_0x5ab102){var _0x43695c=d3[_0x3a71('0x299')](_0x5ab102[_0x3a71('0x29a')],_0x307a3f);return function(_0xbaaae2){_0x5ab102[_0x3a71('0x29b')]=_0x43695c(_0xbaaae2);return _0x4e9cb0(_0x5ab102);};};}WebSAGE['InkSage'][_0x57ce33][_0x3a71('0x165')]['_d3arc'][_0x3a71('0xea')]()['duration'](WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x165')]['_d3arc_duration'])[_0x3a71('0x29c')]('d',_0x223188(_0x4c3f28*0x2*Math['PI']))[_0x3a71('0xb8')](_0x3a71('0x29d'),function(){WebSAGE['InkSage'][_0x57ce33][_0x3a71('0x165')]['_d3arc'][_0x3a71('0xfd')]({'oldAngle':_0x4c3f28*0x2*Math['PI']});});break;case _0x3a71('0x28a'):if(typeof WebSAGE[_0x3a71('0x138')][_0x57ce33]['parent']['vw']!=_0x3a71('0x8f')&&typeof WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x165')][_0x3a71('0x270')]!='undefined'&&WebSAGE['InkSage'][_0x57ce33][_0x3a71('0x165')]['vgInitData']!=''){WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x165')]['vw'][_0x3a71('0xbb')](WebSAGE[_0x3a71('0x138')][_0x57ce33]['parent'][_0x3a71('0x25e')][0x0])[_0x3a71('0xcd')](function(_0x1d226b){return!![];});_0x3da54c=JSON[_0x3a71('0x176')](JSON[_0x3a71('0x271')](WebSAGE[_0x3a71('0x138')][_0x57ce33]['parent'][_0x3a71('0x270')]));}var _0x451abd=new Date();var _0x4e9ae7=0x0;if(WebSAGE[_0x3a71('0x138')][_0x57ce33]['parent']['hasOwnProperty'](_0x3a71('0x270')))$['each'](WebSAGE['InkSage'][_0x57ce33][_0x3a71('0x165')][_0x3a71('0x270')],function(_0x1c89ed,_0x30fda2){$['each'](_0x30fda2,function(_0x9bb7c6,_0x130d46){try{if(typeof _0x130d46===_0x3a71('0x52')){if(_0x130d46['indexOf']('HIS#')>=0x0){_0x4e9ae7++;var _0x7ad2c1=WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x165')][_0x3a71('0x181')][_0x130d46[_0x3a71('0x40')]('#')[0x1]-0x1];if(_0x4e9ae7===0x1)_0x3da54c=[];if(WebSAGE['InkSage'][_0x57ce33][_0x3a71('0x130')](_0x3a71('0x139'))&&typeof WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x139')][_0x7ad2c1]!=_0x3a71('0x8f')){for(_0x56e6d7=0x0;_0x56e6d7<WebSAGE[_0x3a71('0x138')][_0x57ce33]['valores'][_0x7ad2c1]['length'];_0x56e6d7++){_0x3da54c[_0x3a71('0x6d')]({'pnt':''+_0x7ad2c1,'x':WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x13a')][_0x7ad2c1][_0x56e6d7],'y':WebSAGE['InkSage'][_0x57ce33][_0x3a71('0x139')][_0x7ad2c1][_0x56e6d7]});}WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x139')][_0x7ad2c1][_0x3a71('0x6d')](V[_0x7ad2c1]);WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x13a')][_0x7ad2c1][_0x3a71('0x6d')](_0x451abd['getTime']());for(var _0x3a4b2b=WebSAGE['InkSage'][_0x57ce33][_0x3a71('0x139')][_0x7ad2c1]['length']-0x1;_0x3a4b2b>=0x0;_0x3a4b2b--){var _0x257d73=(_0x451abd['getTime']()-WebSAGE['InkSage'][_0x57ce33]['datas'][_0x7ad2c1][_0x3a4b2b])/0x3e8;if(_0x257d73>WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x165')][_0x3a71('0x28c')]*0x3c){WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x139')][_0x7ad2c1][_0x3a71('0x182')](_0x3a4b2b,0x1);WebSAGE['InkSage'][_0x57ce33]['datas'][_0x7ad2c1][_0x3a71('0x182')](_0x3a4b2b,0x1);}}}else{var _0x14e666=new Date()['getTime']()-WebSAGE['InkSage'][_0x57ce33][_0x3a71('0x165')]['timespan']*0x3c*0x3e8;if(!WebSAGE[_0x3a71('0x138')][_0x57ce33]['parent'][_0x3a71('0x130')](_0x3a71('0x29e'))){WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x165')]['histCalls']=[];}if(!WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x165')]['histCalls'][_0x3a71('0x130')](_0x7ad2c1)){var _0x3a32e3=_0x3a71('0x1ac')+_0x7ad2c1+_0x3a71('0x1ad')+_0x14e666/0x3e8+_0x3a71('0x1af')+'&B=histdata('+_0x57ce33+','+_0x7ad2c1+_0x3a71('0x29f')+'\x22'+_0x3a71('0x1b2');WebSAGE[_0x3a71('0x1b4')]=WebSAGE[_0x3a71('0x1b4')]+0x7d0;setTimeout(_0x3a32e3,WebSAGE['g_timeshift']);WebSAGE['InkSage'][_0x57ce33]['parent'][_0x3a71('0x29e')][_0x7ad2c1]=!![];}}}if(_0x130d46[_0x3a71('0x3d')](_0x3a71('0x2a0'))>=0x0){if(WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x165')]['pnts'][_0x3a71('0x2c')]>_0x130d46[_0x3a71('0x40')]('#')[0x1]-0x1){var _0x3421c2=WebSAGE['valorTagueado'](WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x165')][_0x3a71('0x181')][_0x130d46[_0x3a71('0x40')]('#')[0x1]-0x1],WebSAGE[_0x3a71('0x138')][_0x57ce33]['parent']);if(_0x3421c2!=='????')_0x3da54c[_0x1c89ed][_0x9bb7c6]=_0x3421c2;else _0x3da54c[_0x3a71('0x182')](-0x1,0x1);}else _0x3da54c[_0x3a71('0x182')](-0x1,0x1);}else if(_0x130d46['indexOf']('TAG#')>=0x0){if(WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x165')][_0x3a71('0x181')][_0x3a71('0x2c')]>_0x130d46[_0x3a71('0x40')]('#')[0x1]-0x1){var _0x3421c2=WebSAGE[_0x3a71('0x160')](WebSAGE['InkSage'][_0x57ce33]['parent'][_0x3a71('0x181')][_0x130d46[_0x3a71('0x40')]('#')[0x1]-0x1],WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x165')]);if(_0x3421c2!==_0x3a71('0x150'))_0x3da54c[_0x1c89ed][_0x9bb7c6]=WebSAGE[_0x3a71('0x138')][_0x57ce33]['parent'][_0x3a71('0x181')][_0x130d46[_0x3a71('0x40')]('#')[0x1]-0x1];}else _0x3da54c[_0x3a71('0x182')](-0x1,0x1);}else if(_0x130d46[_0x3a71('0x3d')](_0x3a71('0x2a1'))>=0x0){if(WebSAGE[_0x3a71('0x138')][_0x57ce33]['parent'][_0x3a71('0x181')][_0x3a71('0x2c')]>_0x130d46[_0x3a71('0x40')]('#')[0x1]-0x1)_0x3da54c[_0x1c89ed][_0x9bb7c6]=WebSAGE[_0x3a71('0x157')](WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x165')][_0x3a71('0x181')][_0x130d46[_0x3a71('0x40')]('#')[0x1]-0x1]);}else if(_0x130d46['indexOf'](_0x3a71('0x2a2'))>=0x0){if(WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x165')][_0x3a71('0x181')][_0x3a71('0x2c')]>_0x130d46[_0x3a71('0x40')]('#')[0x1]-0x1)_0x3da54c[_0x1c89ed][_0x9bb7c6]=WebSAGE[_0x3a71('0x157')](WebSAGE['InkSage'][_0x57ce33]['parent'][_0x3a71('0x181')][_0x130d46[_0x3a71('0x40')]('#')[0x1]-0x1])&0x80?0x1:0x0;}else if(_0x130d46['indexOf'](_0x3a71('0x2a3'))>=0x0){if(WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x165')][_0x3a71('0x181')][_0x3a71('0x2c')]>_0x130d46[_0x3a71('0x40')]('#')[0x1]-0x1)_0x3da54c[_0x1c89ed][_0x9bb7c6]=WebSAGE[_0x3a71('0x2a4')](WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x165')][_0x3a71('0x181')][_0x130d46[_0x3a71('0x40')]('#')[0x1]-0x1]);}else if(_0x130d46[_0x3a71('0x3d')]('LMS#')>=0x0){if(WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x165')][_0x3a71('0x181')][_0x3a71('0x2c')]>_0x130d46[_0x3a71('0x40')]('#')[0x1]-0x1)_0x3da54c[_0x1c89ed][_0x9bb7c6]=WebSAGE[_0x3a71('0x2a5')](WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x165')][_0x3a71('0x181')][_0x130d46[_0x3a71('0x40')]('#')[0x1]-0x1]);}else if(_0x130d46[_0x3a71('0x3d')]('DCR#')>=0x0){if(WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x165')][_0x3a71('0x181')][_0x3a71('0x2c')]>_0x130d46[_0x3a71('0x40')]('#')[0x1]-0x1)_0x3da54c[_0x1c89ed][_0x9bb7c6]=WebSAGE['getDescription'](WebSAGE[_0x3a71('0x138')][_0x57ce33]['parent'][_0x3a71('0x181')][_0x130d46[_0x3a71('0x40')]('#')[0x1]-0x1]);}else if(_0x130d46[_0x3a71('0x3d')](_0x3a71('0x2a6'))>=0x0){if(WebSAGE[_0x3a71('0x138')][_0x57ce33]['parent'][_0x3a71('0x181')][_0x3a71('0x2c')]>_0x130d46[_0x3a71('0x40')]('#')[0x1]-0x1)_0x3da54c[_0x1c89ed][_0x9bb7c6]=WebSAGE[_0x3a71('0x2a7')](WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x165')][_0x3a71('0x181')][_0x130d46[_0x3a71('0x40')]('#')[0x1]-0x1]);}else if(_0x130d46[_0x3a71('0x3d')](_0x3a71('0x2a8'))>=0x0){if(WebSAGE[_0x3a71('0x138')][_0x57ce33]['parent'][_0x3a71('0x181')]['length']>_0x130d46[_0x3a71('0x40')]('#')[0x1]-0x1)_0x3da54c[_0x1c89ed][_0x9bb7c6]=WebSAGE[_0x3a71('0x2a9')](WebSAGE[_0x3a71('0x138')][_0x57ce33]['parent'][_0x3a71('0x181')][_0x130d46['split']('#')[0x1]-0x1]);}}}catch(_0x526eea){};});});if(typeof WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x165')]['vw']!=_0x3a71('0x8f')){WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x165')]['vw'][_0x3a71('0xbb')](WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x165')][_0x3a71('0x25e')][0x0])[_0x3a71('0x28f')](_0x3da54c);WebSAGE['InkSage'][_0x57ce33][_0x3a71('0x165')]['vw'][_0x3a71('0x264')]();WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x165')]['vg']['html']($('#'+WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x165')][_0x3a71('0x261')]+_0x3a71('0x26b'))[0x0][_0x3a71('0x2d')][0x0]['childNodes'][0x0]['innerHTML']);}break;case _0x3a71('0x288'):case _0x3a71('0x291'):case _0x3a71('0x292'):if(typeof WebSAGE[_0x3a71('0x138')][_0x57ce33]['parent']['vw']!=_0x3a71('0x8f')&&typeof WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x165')]['vgInitData']!=_0x3a71('0x8f')&&WebSAGE['InkSage'][_0x57ce33][_0x3a71('0x165')]['vgInitData']!=''){_0x3da54c=JSON[_0x3a71('0x176')](JSON[_0x3a71('0x271')](WebSAGE[_0x3a71('0x138')][_0x57ce33]['parent'][_0x3a71('0x270')]));}var _0x451abd=new Date();var _0x4e9ae7=0x0;if(WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x165')]['hasOwnProperty']('vgInitData'))$['each'](WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x165')][_0x3a71('0x270')],function(_0x41c882,_0x5f59dd){$[_0x3a71('0xb8')](_0x5f59dd,function(_0xc6844,_0x339cde){try{if(typeof _0x339cde===_0x3a71('0x52')){if(_0x339cde['indexOf']('HIS#')>=0x0){_0x4e9ae7++;var _0x123a3a=WebSAGE[_0x3a71('0x138')][_0x57ce33]['parent'][_0x3a71('0x181')][_0x339cde[_0x3a71('0x40')]('#')[0x1]-0x1];if(_0x4e9ae7===0x1)_0x3da54c=[];if(WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x130')](_0x3a71('0x139'))&&typeof WebSAGE['InkSage'][_0x57ce33]['valores'][_0x123a3a]!=_0x3a71('0x8f')){for(_0x56e6d7=0x0;_0x56e6d7<WebSAGE[_0x3a71('0x138')][_0x57ce33]['valores'][_0x123a3a][_0x3a71('0x2c')];_0x56e6d7++){_0x3da54c[_0x3a71('0x6d')]({'pnt':''+_0x123a3a,'x':WebSAGE['InkSage'][_0x57ce33][_0x3a71('0x13a')][_0x123a3a][_0x56e6d7],'y':WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x139')][_0x123a3a][_0x56e6d7]});}WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x139')][_0x123a3a][_0x3a71('0x6d')](V[_0x123a3a]);WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x13a')][_0x123a3a][_0x3a71('0x6d')](_0x451abd[_0x3a71('0x6')]());for(var _0x3f1898=WebSAGE[_0x3a71('0x138')][_0x57ce33]['valores'][_0x123a3a]['length']-0x1;_0x3f1898>=0x0;_0x3f1898--){var _0x44ebf4=(_0x451abd[_0x3a71('0x6')]()-WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x13a')][_0x123a3a][_0x3f1898])/0x3e8;if(WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x165')][_0x3a71('0x28c')]>0x0){if(_0x44ebf4>WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x165')][_0x3a71('0x28c')]*0x3c){WebSAGE['InkSage'][_0x57ce33]['valores'][_0x123a3a]['splice'](_0x3f1898,0x1);WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x13a')][_0x123a3a][_0x3a71('0x182')](_0x3f1898,0x1);}}else{if(WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x13a')][_0x123a3a][_0x3f1898]>WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x165')][_0x3a71('0x1e2')]){WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x139')][_0x3a71('0xde')](function(_0xd1df00,_0x41c882,_0x30b6e1){_0x30b6e1[_0x41c882]=[];});WebSAGE[_0x3a71('0x138')][_0x57ce33]['datas'][_0x3a71('0xde')](function(_0x527414,_0x41c882,_0x102175){_0x102175[_0x41c882]=[];});WebSAGE['InkSage'][_0x57ce33]['parent'][_0x3a71('0x1ab')]=new Date()['getTime']()-new Date()[_0x3a71('0x6')]()%(Math[_0x3a71('0x3c')](WebSAGE['InkSage'][_0x57ce33][_0x3a71('0x165')][_0x3a71('0x28c')]*0x3c)*0x3e8)+new Date()[_0x3a71('0x1b3')]()*0x3c*0x3e8%(Math[_0x3a71('0x3c')](WebSAGE[_0x3a71('0x138')][_0x57ce33]['parent'][_0x3a71('0x28c')]*0x3c)*0x3e8);WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x165')][_0x3a71('0x1e2')]=WebSAGE['InkSage'][_0x57ce33][_0x3a71('0x165')][_0x3a71('0x1ab')]+Math[_0x3a71('0x3c')](WebSAGE['InkSage'][_0x57ce33][_0x3a71('0x165')]['timespan']*0x3c*0x3e8);}}}}else{if(WebSAGE['InkSage'][_0x57ce33][_0x3a71('0x165')][_0x3a71('0x28c')]<0x0){WebSAGE[_0x3a71('0x138')][_0x57ce33]['parent'][_0x3a71('0x1ab')]=new Date()[_0x3a71('0x6')]()-new Date()[_0x3a71('0x6')]()%(Math[_0x3a71('0x3c')](WebSAGE['InkSage'][_0x57ce33][_0x3a71('0x165')][_0x3a71('0x28c')]*0x3c)*0x3e8)+new Date()[_0x3a71('0x1b3')]()*0x3c*0x3e8%(Math['abs'](WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x165')][_0x3a71('0x28c')]*0x3c)*0x3e8);WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x165')][_0x3a71('0x1e2')]=WebSAGE['InkSage'][_0x57ce33]['parent'][_0x3a71('0x1ab')]+Math[_0x3a71('0x3c')](WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x165')][_0x3a71('0x28c')]*0x3c*0x3e8);}var _0x1572cb=WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x165')][_0x3a71('0x1ab')];if(!WebSAGE[_0x3a71('0x138')][_0x57ce33]['parent']['hasOwnProperty']('histCalls')){WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x165')][_0x3a71('0x29e')]=[];}if(!WebSAGE['InkSage'][_0x57ce33]['parent'][_0x3a71('0x29e')][_0x3a71('0x130')](_0x123a3a)){var _0x9da098='$.getScript(\x20WebSAGE.g_timePntServer\x20+\x20\x22?P='+_0x123a3a+'&U='+_0x1572cb/0x3e8+'&F=S'+_0x3a71('0x1b0')+_0x57ce33+','+_0x123a3a+');histdata'+'\x22'+_0x3a71('0x1b2');WebSAGE[_0x3a71('0x1b4')]=WebSAGE['g_timeshift']+0x7d0;setTimeout(_0x9da098,WebSAGE[_0x3a71('0x1b4')]);WebSAGE['InkSage'][_0x57ce33][_0x3a71('0x165')][_0x3a71('0x29e')][_0x123a3a]=!![];}}}if(_0x339cde[_0x3a71('0x3d')](_0x3a71('0x2a0'))>=0x0){if(WebSAGE[_0x3a71('0x138')][_0x57ce33]['parent']['pnts'][_0x3a71('0x2c')]>_0x339cde['split']('#')[0x1]-0x1){var _0x3421c2=WebSAGE['valorTagueado'](WebSAGE['InkSage'][_0x57ce33][_0x3a71('0x165')][_0x3a71('0x181')][_0x339cde[_0x3a71('0x40')]('#')[0x1]-0x1],WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x165')]);if(_0x3421c2!=='????')_0x3da54c[_0x41c882][_0xc6844]=_0x3421c2;else _0x3da54c['splice'](-0x1,0x1);}else _0x3da54c['splice'](-0x1,0x1);}else if(_0x339cde[_0x3a71('0x3d')](_0x3a71('0x2aa'))>=0x0){if(WebSAGE['InkSage'][_0x57ce33][_0x3a71('0x165')]['pnts']['length']>_0x339cde['split']('#')[0x1]-0x1){var _0x3421c2=WebSAGE['valorTagueado'](WebSAGE[_0x3a71('0x138')][_0x57ce33]['parent'][_0x3a71('0x181')][_0x339cde[_0x3a71('0x40')]('#')[0x1]-0x1],WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x165')]);if(_0x3421c2!==_0x3a71('0x150'))_0x3da54c[_0x41c882][_0xc6844]=WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x165')][_0x3a71('0x181')][_0x339cde[_0x3a71('0x40')]('#')[0x1]-0x1];}else _0x3da54c[_0x3a71('0x182')](-0x1,0x1);}else if(_0x339cde[_0x3a71('0x3d')](_0x3a71('0x2a1'))>=0x0){if(WebSAGE[_0x3a71('0x138')][_0x57ce33]['parent'][_0x3a71('0x181')]['length']>_0x339cde[_0x3a71('0x40')]('#')[0x1]-0x1)_0x3da54c[_0x41c882][_0xc6844]=WebSAGE['getFlags'](WebSAGE['InkSage'][_0x57ce33]['parent'][_0x3a71('0x181')][_0x339cde['split']('#')[0x1]-0x1]);}else if(_0x339cde[_0x3a71('0x3d')](_0x3a71('0x2a2'))>=0x0){if(WebSAGE['InkSage'][_0x57ce33][_0x3a71('0x165')]['pnts'][_0x3a71('0x2c')]>_0x339cde[_0x3a71('0x40')]('#')[0x1]-0x1)_0x3da54c[_0x41c882][_0xc6844]=WebSAGE[_0x3a71('0x157')](WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x165')][_0x3a71('0x181')][_0x339cde[_0x3a71('0x40')]('#')[0x1]-0x1])&0x80?0x1:0x0;}else if(_0x339cde[_0x3a71('0x3d')]('LMI#')>=0x0){if(WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x165')][_0x3a71('0x181')][_0x3a71('0x2c')]>_0x339cde['split']('#')[0x1]-0x1)_0x3da54c[_0x41c882][_0xc6844]=WebSAGE[_0x3a71('0x2a4')](WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x165')][_0x3a71('0x181')][_0x339cde['split']('#')[0x1]-0x1]);}else if(_0x339cde[_0x3a71('0x3d')](_0x3a71('0x2ab'))>=0x0){if(WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x165')][_0x3a71('0x181')][_0x3a71('0x2c')]>_0x339cde[_0x3a71('0x40')]('#')[0x1]-0x1)_0x3da54c[_0x41c882][_0xc6844]=WebSAGE['getSupLim'](WebSAGE['InkSage'][_0x57ce33][_0x3a71('0x165')][_0x3a71('0x181')][_0x339cde[_0x3a71('0x40')]('#')[0x1]-0x1]);}else if(_0x339cde[_0x3a71('0x3d')](_0x3a71('0x2ac'))>=0x0){if(WebSAGE['InkSage'][_0x57ce33][_0x3a71('0x165')][_0x3a71('0x181')][_0x3a71('0x2c')]>_0x339cde[_0x3a71('0x40')]('#')[0x1]-0x1)_0x3da54c[_0x41c882][_0xc6844]=WebSAGE['getDescription'](WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x165')][_0x3a71('0x181')][_0x339cde[_0x3a71('0x40')]('#')[0x1]-0x1]);}else if(_0x339cde['indexOf'](_0x3a71('0x2a6'))>=0x0){if(WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x165')][_0x3a71('0x181')]['length']>_0x339cde[_0x3a71('0x40')]('#')[0x1]-0x1)_0x3da54c[_0x41c882][_0xc6844]=WebSAGE['getBay'](WebSAGE['InkSage'][_0x57ce33][_0x3a71('0x165')][_0x3a71('0x181')][_0x339cde[_0x3a71('0x40')]('#')[0x1]-0x1]);}else if(_0x339cde[_0x3a71('0x3d')](_0x3a71('0x2a8'))>=0x0){if(WebSAGE['InkSage'][_0x57ce33][_0x3a71('0x165')]['pnts'][_0x3a71('0x2c')]>_0x339cde[_0x3a71('0x40')]('#')[0x1]-0x1)_0x3da54c[_0x41c882][_0xc6844]=WebSAGE[_0x3a71('0x2a9')](WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x165')][_0x3a71('0x181')][_0x339cde[_0x3a71('0x40')]('#')[0x1]-0x1]);}}}catch(_0x110d93){}});});if(typeof WebSAGE['InkSage'][_0x57ce33][_0x3a71('0x165')]['vw']!='undefined'){WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x165')]['vw'][_0x3a71('0x296')](WebSAGE['InkSage'][_0x57ce33][_0x3a71('0x165')][_0x3a71('0x25e')][0x0],vega['changeset']()['remove'](function(_0x451abd){return!![];})[_0x3a71('0x28f')](_0x3da54c))[_0x3a71('0x277')]();WebSAGE['InkSage'][_0x57ce33][_0x3a71('0x165')]['vw'][_0x3a71('0x297')](function(){var _0xcbcd60=WebSAGE['InkSage'][_0x57ce33][_0x3a71('0x165')]['vw'][_0x3a71('0x278')]();_0xcbcd60['then'](function(_0x39457e){WebSAGE[_0x3a71('0x138')][_0x57ce33][_0x3a71('0x165')]['vg']['html'](_0x39457e);});});}break;}};WebSAGE[_0x3a71('0x2ad')]=function(_0x4b414e,_0x594491,_0x2b02d2){WebSAGE[_0x3a71('0x2ae')]=_0x594491;WebSAGE['idalt2']=_0x2b02d2;window['setTimeout'](function(_0x5c4b02){window[_0x3a71('0x2af')][_0x3a71('0x2b0')](_0x5c4b02);},0x1f4,_0x2b02d2);window[_0x3a71('0x2b1')](function fn(_0x554f3a,_0x5e9189){var _0x6e05d0=fn[_0x3a71('0x2b2')]||_0x554f3a;fn[_0x3a71('0x2b2')]=fn['idb']||_0x5e9189;fn[_0x3a71('0x2b3')]=_0x6e05d0;window[_0x3a71('0x2af')][_0x3a71('0x2b0')](fn[_0x3a71('0x2b3')]);window[_0x3a71('0x2af')][_0x3a71('0x2b4')](fn['ida']);},_0x4b414e,_0x594491,_0x2b02d2);};WebSAGE[_0x3a71('0x2b0')]=function(_0x5498ba){var _0xf69fb0=window[_0x3a71('0x2b5')][_0x3a71('0x133')](_0x5498ba);if(_0xf69fb0===null)return;if(typeof _0xf69fb0[_0x3a71('0x135')]==='undefined'){if(_0xf69fb0['getAttributeNS'](null,_0x3a71('0xb6'))===null){_0xf69fb0['inittransform']='';}else{_0xf69fb0[_0x3a71('0x135')]=_0xf69fb0[_0x3a71('0x136')](null,'transform');}}window['d3'][_0x3a71('0xaa')](_0xf69fb0)[_0x3a71('0xea')]()[_0x3a71('0xee')](0x4e2)[_0x3a71('0xb0')](_0x3a71('0xb6'),_0x3a71('0x2b6')+_0xf69fb0[_0x3a71('0xae')]()['x']+_0x3a71('0x2b7')+_0xf69fb0[_0x3a71('0x135')]+'\x20scale(0,\x201)');};WebSAGE['flipIn']=function(_0x160fff){var _0x41510a=window[_0x3a71('0x2b5')][_0x3a71('0x133')](_0x160fff);if(_0x41510a===null)return;if(typeof _0x41510a[_0x3a71('0x135')]===_0x3a71('0x8f')){if(_0x41510a[_0x3a71('0x136')](null,_0x3a71('0xb6'))===null){_0x41510a[_0x3a71('0x135')]='';}else{_0x41510a[_0x3a71('0x135')]=_0x41510a[_0x3a71('0x136')](null,_0x3a71('0xb6'));}}window['d3'][_0x3a71('0xaa')](_0x41510a)['transition']()[_0x3a71('0xee')](0x4e2)[_0x3a71('0xb0')]('transform',_0x41510a['inittransform']+_0x3a71('0x2b8'));};'use\x20strict';WebSAGE['getJSONData']=function(){$[_0x3a71('0x13f')]({'url':'jsondatasimul.php?KEYS='+WebSAGE[_0x3a71('0x14d')]+_0x3a71('0x2b9')+Math['random'](),'dataType':_0x3a71('0xab'),'success':WebSAGE[_0x3a71('0x2ba')],'headers':{'Content-Type':_0x3a71('0x2bb')}});};WebSAGE[_0x3a71('0x2ba')]=function(_0x1ad6c9){var _0x5eb2c8,_0x3b48cd,_0x5897c3,_0x35d179,_0x55eba9,_0x41c288,_0x2c468d,_0x335890,_0x3806d2,_0x2237c1,_0x3f5ce2,_0x1255ff,_0x45abe3,_0xd32448,_0x3d5bde,_0x39590a,_0x491481,_0x3b9ef5,_0xbc17f5,_0x239df3,_0x35458d;var _0xe80de5=new Array();var _0x1991f6;if(typeof _0x1ad6c9===_0x3a71('0x52'))_0x1991f6=JSON[_0x3a71('0x176')](_0x1ad6c9);else if(typeof _0x1ad6c9==='object')_0x1991f6=_0x1ad6c9;if(_0x1991f6[_0x3a71('0x130')](_0x3a71('0xbb'))){_0x1991f6=_0x1991f6[_0x3a71('0xbb')];}if(_0x1991f6['hasOwnProperty']('tags')){if(_0x1991f6[_0x3a71('0x2bc')][_0x3a71('0x2c')]==0x0)return;for(_0x5eb2c8=0x0;_0x5eb2c8<_0x1991f6[_0x3a71('0x2bc')][_0x3a71('0x2c')];_0x5eb2c8++){_0x35d179=_0x1991f6[_0x3a71('0x2bc')][_0x5eb2c8];_0x41c288=_0x35d179[_0x3a71('0x1ce')];if(!_0x35d179[_0x3a71('0x130')](_0x3a71('0x17')))_0x35d179[_0x3a71('0x17')]=typeof _0x35d179['val']==_0x3a71('0x2bd')?_0x3a71('0x2bd'):'float';if(!_0x35d179[_0x3a71('0x130')]('quality'))_0x35d179[_0x3a71('0x2be')]=!![];if(!_0x35d179['hasOwnProperty'](_0x3a71('0x2bf')))_0x35d179[_0x3a71('0x2bf')]={};if(!_0x35d179[_0x3a71('0x2bf')]['hasOwnProperty'](_0x3a71('0x2c0')))_0x35d179[_0x3a71('0x2bf')]['Value']={};if(!_0x35d179['parameters']['hasOwnProperty'](_0x3a71('0x2c1')))_0x35d179[_0x3a71('0x2bf')]['HighAlarmLimit']={};if(!_0x35d179['parameters'][_0x3a71('0x130')](_0x3a71('0x2c2')))_0x35d179[_0x3a71('0x2bf')][_0x3a71('0x2c2')]={};_0x2c468d=parseInt(_0x35d179[_0x3a71('0x2bf')][_0x3a71('0x2c0')][_0x3a71('0x2c3')])||NaN;if(!isNaN(_0x2c468d)&&_0x2c468d!==0x0)_0x55eba9=_0x2c468d;else _0x55eba9=_0x5eb2c8+0x1;NPTS[_0x41c288]=_0x55eba9;TAGS[_0x55eba9]=_0x41c288;DCRS[_0x55eba9]=_0x35d179[_0x3a71('0x2bf')][_0x3a71('0x2c0')]['Desc']||_0x41c288;SUBS[_0x55eba9]=_0x35d179[_0x3a71('0x2bf')][_0x3a71('0x2c0')]['LocationLevel0']||'';BAYS[_0x55eba9]=_0x35d179[_0x3a71('0x2bf')][_0x3a71('0x2c0')][_0x3a71('0x2c4')]||'';T[_0x55eba9]=_0x35d179[_0x3a71('0x2bf')][_0x3a71('0x2c0')][_0x3a71('0x2c5')]||new Date()['getTime']();ANOTS[_0x55eba9]=_0x35d179[_0x3a71('0x2bf')][_0x3a71('0x2c0')][_0x3a71('0x2c6')]||'';if(_0x35d179[_0x3a71('0x17')]===_0x3a71('0x2c7')){LIMSUPS[_0x55eba9]=parseFloat(_0x35d179[_0x3a71('0x2bf')][_0x3a71('0x2c1')]['Value']||0x3b9ac9ff);LIMINFS[_0x55eba9]=parseFloat(_0x35d179['parameters']['LowAlarmLimit'][_0x3a71('0x2c0')]||-0x3b9ac9ff);V[_0x55eba9]=_0x35d179[_0x3a71('0x24')];F[_0x55eba9]=_0x35d179[_0x3a71('0x2be')]?0x20:0x20|0x80;}else if(_0x35d179[_0x3a71('0x17')]==='bool'){STONS[_0x55eba9]=_0x35d179['parameters'][_0x3a71('0x2c0')][_0x3a71('0x2c8')]||'_TRUE_';STOFS[_0x55eba9]=_0x35d179[_0x3a71('0x2bf')][_0x3a71('0x2c0')][_0x3a71('0x2c9')]||'_FALSE_';F[_0x55eba9]=_0x35d179[_0x3a71('0x2be')]?0x0:0x80;if(_0x35d179['value']){V[_0x55eba9]=0x0;F[_0x55eba9]=F[_0x55eba9]|0x2;}else{V[_0x55eba9]=0x1;F[_0x55eba9]=F[_0x55eba9]|0x1;}_0x335890=_0x35d179['parameters'][_0x3a71('0x2c0')]['OutOfRange']||0x0;if(_0x335890!==0x0){V[_0x55eba9]=_0x35d179[_0x3a71('0x24')]?0x1:0x0;F[_0x55eba9]=F[_0x55eba9]|_0x35d179[_0x3a71('0x24')]?0x3:0x0;}}F[_0x55eba9]=F[_0x55eba9]|(_0x35d179[_0x3a71('0x2bf')]['Value'][_0x3a71('0x2ca')]|![]?0x100:0x0);}var _0x571af2=new Date();Data=_0x571af2[_0x3a71('0x3b')]();Sha1Ana=Data;Sha1Dig=Data;setTimeout(function(){WebSAGE[_0x3a71('0x2cb')]();},0x32);return;}if(_0x1991f6[_0x3a71('0x130')](_0x3a71('0x2cc'))){_0x239df3=0x0;for(_0x5eb2c8=0x0;_0x5eb2c8<_0x1991f6['valueRanges'][_0x3a71('0x2c')];_0x5eb2c8++){_0x3806d2=_0x1991f6[_0x3a71('0x2cc')][_0x5eb2c8];if(!_0x3806d2['hasOwnProperty'](_0x3a71('0x2cd'))||_0x3806d2[_0x3a71('0x2cd')]===_0x3a71('0x2ce')){for(_0x3b48cd=0x0;_0x3b48cd<_0x3806d2[_0x3a71('0x26f')][_0x3a71('0x2c')];_0x3b48cd++){_0x35d179=_0x3806d2['values'][_0x3b48cd];_0x39590a=null;_0x491481=!![];_0x3b9ef5=null;_0x41c288=null;_0xbc17f5=null;_0xd32448=null;_0x3d5bde=null;_0x1255ff=null;_0x45abe3=null;_0x2237c1=null;_0x3f5ce2=null;_0x35458d=![];for(_0x5897c3=0x0;_0x5897c3<_0x35d179[_0x3a71('0x2c')];_0x5897c3++){switch(typeof _0x35d179[_0x5897c3]){case _0x3a71('0x2cf'):if(_0x1255ff!==null&&_0x45abe3===null)_0x45abe3=_0x35d179[_0x5897c3];if(_0x1255ff===null)_0x1255ff=_0x35d179[_0x5897c3];break;case _0x3a71('0x3e'):if(_0xd32448!==null&&_0x3d5bde===null)_0x3d5bde=_0x35d179[_0x5897c3];if(_0xd32448===null)_0xd32448=_0x35d179[_0x5897c3];break;case _0x3a71('0x52'):if(_0x2237c1!==null&&_0x3f5ce2===null)_0x3f5ce2=_0x35d179[_0x5897c3];if(_0x2237c1===null)_0x2237c1=_0x35d179[_0x5897c3];break;default:break;}}if(_0xd32448!==null){_0x39590a=_0xd32448;if(_0x2237c1!==null&&isNaN(parseFloat(_0x2237c1)))_0x41c288=_0x2237c1;else if(_0x3f5ce2!==null&&isNaN(parseFloat(_0x3f5ce2)))_0x41c288=_0x3f5ce2;}else{if(!isNaN(parseFloat(_0x2237c1))){_0x39590a=parseFloat(_0x2237c1);if(_0x3f5ce2!==null&&isNaN(parseFloat(_0x3f5ce2)))_0x41c288=_0x3f5ce2;}else if(!isNaN(parseFloat(_0x3f5ce2))){_0x39590a=parseFloat(_0x3f5ce2);if(_0x2237c1!==null&&isNaN(parseFloat(_0x2237c1)))_0x41c288=_0x2237c1;}}if(_0x39590a===null&&_0x1255ff!==null){_0x39590a=_0x1255ff?0x1:0x0;_0x35458d=!![];if(_0x45abe3!==null)_0x491481=_0x45abe3;}else{if(_0x1255ff!==null)_0x491481=_0x1255ff;if(_0x3d5bde!==null){_0x3b9ef5=_0x3d5bde;}}if(_0x41c288===null||_0x41c288===''){_0x41c288=_0x35d179[_0x3a71('0xc9')]+'-'+(_0x3b48cd+0x1);}else{if(_0x3f5ce2!==null)_0xbc17f5=_0x3f5ce2;}_0x55eba9=++_0x239df3;NPTS[_0x41c288]=_0x55eba9;TAGS[_0x55eba9]=_0x41c288;DCRS[_0x55eba9]=_0xbc17f5||_0x41c288;SUBS[_0x55eba9]=_0x35d179['range'];BAYS[_0x55eba9]='';T[_0x55eba9]=_0x3b9ef5||new Date()[_0x3a71('0x6')]();ANOTS[_0x55eba9]='';if(!_0x35458d){STONS[_0x55eba9]=_0x3a71('0x2d0');STOFS[_0x55eba9]=_0x3a71('0x2d1');LIMSUPS[_0x55eba9]=0x3b9ac9ff;LIMINFS[_0x55eba9]=-0x3b9ac9ff;V[_0x55eba9]=_0x39590a;F[_0x55eba9]=_0x491481?0x0:0x80;}else{STONS[_0x55eba9]='TRUE';STOFS[_0x55eba9]='FALSE';F[_0x55eba9]=_0x35d179[_0x3a71('0x2be')]?0x20:0x20|0x80;if(_0x39590a){V[_0x55eba9]=0x0;F[_0x55eba9]=F[_0x55eba9]|0x2;}else{V[_0x55eba9]=0x1;F[_0x55eba9]=F[_0x55eba9]|0x1;}}}}}}if(_0x1991f6[_0x3a71('0x130')]('type')&&_0x1991f6[_0x3a71('0x17')]==='zoomTo'){if(SVGDoc===null)return;WebSAGE[_0x3a71('0x212')]=0x0;WebSAGE[_0x3a71('0x213')]=0x0;WebSAGE[_0x3a71('0x210')]=ScreenViewer_SVGMaxWidth;WebSAGE[_0x3a71('0x211')]=ScreenViewer_SVGMaxHeight;var _0x20ffbf=0x0,_0x27e552=0x0;if(typeof _0x1991f6[_0x3a71('0x82')]===_0x3a71('0x52')&&SVGDoc[_0x3a71('0x133')](_0x1991f6[_0x3a71('0x82')])){_0x20ffbf=SVGDoc['getElementById'](_0x1991f6[_0x3a71('0x82')])[_0x3a71('0xae')]()['x']+SVGDoc[_0x3a71('0x133')](_0x1991f6[_0x3a71('0x82')])[_0x3a71('0xae')]()[_0x3a71('0xb1')]/0x2;_0x27e552=SVGDoc[_0x3a71('0x133')](_0x1991f6[_0x3a71('0x82')])[_0x3a71('0xae')]()['y']+SVGDoc['getElementById'](_0x1991f6[_0x3a71('0x82')])['getBBox']()['height']/0x2;}else if(typeof _0x1991f6[_0x3a71('0x82')]==='object'){_0x20ffbf=_0x1991f6[_0x3a71('0x82')]['x']||0x0;_0x27e552=_0x1991f6['target']['y']||0x0;}var _0x11f14a=WebSAGE[_0x3a71('0x210')]/_0x1991f6['zoomLevel'];var _0x20dc56=WebSAGE[_0x3a71('0x211')]/_0x1991f6[_0x3a71('0x2d2')];var _0x469e0d=WebSAGE['g_zpX']-(_0x11f14a-WebSAGE['g_zpW'])*((_0x20ffbf-WebSAGE[_0x3a71('0x212')])/WebSAGE[_0x3a71('0x210')]);var _0x3d8e64=WebSAGE[_0x3a71('0x213')]-(_0x20dc56-WebSAGE['g_zpH'])*((_0x27e552-WebSAGE[_0x3a71('0x213')])/WebSAGE[_0x3a71('0x211')]);WebSAGE[_0x3a71('0x212')]=_0x469e0d;WebSAGE['g_zpY']=_0x3d8e64;WebSAGE['g_zpW']=_0x11f14a;WebSAGE[_0x3a71('0x211')]=_0x20dc56;SVGDoc[_0x3a71('0x12a')](null,_0x3a71('0x2d3'),WebSAGE['g_zpX']+'\x20'+WebSAGE[_0x3a71('0x213')]+'\x20'+WebSAGE['g_zpW']+'\x20'+WebSAGE['g_zpH']);$(_0x3a71('0x20d'))[_0x3a71('0x21a')](_0x3a71('0x14e'),_0x3a71('0xa6'));return;}if(_0x1991f6[_0x3a71('0x130')](_0x3a71('0x17'))&&_0x1991f6[_0x3a71('0x17')]===_0x3a71('0x2d4')){if(SVGDoc===null)return;WebSAGE[_0x3a71('0x212')]+=_0x1991f6['dx'];WebSAGE[_0x3a71('0x213')]+=_0x1991f6['dy'];SVGDoc[_0x3a71('0x12a')](null,_0x3a71('0x2d3'),WebSAGE[_0x3a71('0x212')]+'\x20'+WebSAGE[_0x3a71('0x213')]+'\x20'+WebSAGE['g_zpW']+'\x20'+WebSAGE['g_zpH']);return;}if(_0x1991f6[_0x3a71('0x130')](_0x3a71('0x17'))&&_0x1991f6[_0x3a71('0x17')]==='zoomToOriginal'){if(SVGDoc===null)return;WebSAGE[_0x3a71('0x212')]=0x0;WebSAGE[_0x3a71('0x213')]=0x0;WebSAGE[_0x3a71('0x210')]=ScreenViewer_SVGMaxWidth;WebSAGE[_0x3a71('0x211')]=ScreenViewer_SVGMaxHeight;SVGDoc[_0x3a71('0x12a')](null,_0x3a71('0x2d3'),WebSAGE[_0x3a71('0x212')]+'\x20'+WebSAGE[_0x3a71('0x213')]+'\x20'+WebSAGE[_0x3a71('0x210')]+'\x20'+WebSAGE['g_zpH']);return;}if(_0x1991f6[_0x3a71('0x130')]('type')&&_0x1991f6['type']===_0x3a71('0x2d5')){if(SVGDoc===null)return;document['getElementById'](_0x3a71('0x2d6'))[_0x3a71('0x1a')]['display']=_0x1991f6[_0x3a71('0x2d7')]?'':_0x3a71('0x1c');document[_0x3a71('0x133')]('ZOOMOUT_ID')[_0x3a71('0x1a')][_0x3a71('0x1b')]=_0x1991f6[_0x3a71('0x2d7')]?'':_0x3a71('0x1c');document['getElementById'](_0x3a71('0x2d8'))[_0x3a71('0x1a')][_0x3a71('0x1b')]=_0x1991f6[_0x3a71('0x2d9')]?'':_0x3a71('0x1c');}if(_0x1991f6[_0x3a71('0x130')](_0x3a71('0x17'))&&_0x1991f6['type']==='enableMouse'){if(_0x1991f6['panEnabled']===![])window[_0x3a71('0x2da')]=!![];else delete window[_0x3a71('0x2da')];}if(_0x1991f6[_0x3a71('0x130')](_0x3a71('0x17'))&&_0x1991f6['type']===_0x3a71('0x2db')){if(SVGDoc===null)return;}if(_0x1991f6[_0x3a71('0x130')](_0x3a71('0x17'))&&_0x1991f6[_0x3a71('0x17')]===_0x3a71('0x2dc')){if(SVGDoc===null)return;document[_0x3a71('0x133')](_0x3a71('0x2dd'))['style'][_0x3a71('0x1b')]='none';}if(_0x1991f6[_0x3a71('0x130')](_0x3a71('0x17'))&&_0x1991f6['type']===_0x3a71('0x2de')){LT=_0x1991f6['lt'];VK=_0x1991f6['vk'];}if(_0x1991f6[_0x3a71('0x130')](_0x3a71('0x17'))&&_0x1991f6[_0x3a71('0x17')]===_0x3a71('0x2df')){if(SVGDoc===null)return;TAGS=[];NPTS=[];SUBS=[];BAYS=[];DCRS=[];ANOTS=[];STONS=[];STOFS=[];LIMSUPS=[];LIMINFS=[];}};WebSAGE[_0x3a71('0x2e0')]=function(){if($('#timemachinecontrols')[_0x3a71('0x21a')](_0x3a71('0x1b'))!=_0x3a71('0x1c')){return;}var _0x23736f=0x0;var _0x1c3c6d;var _0x10ba2e;var _0x52b25d;Data='';WebSAGE[_0x3a71('0x1d6')]=setTimeout(WebSAGE[_0x3a71('0x2e1')],WebSAGE[_0x3a71('0x2e2')]);WebSAGE[_0x3a71('0x2e3')]();WebSAGE[_0x3a71('0x2e4')]=setTimeout(WebSAGE['getServerStatus'],WebSAGE[_0x3a71('0x2e5')]/0x2);WebSAGE[_0x3a71('0x2e6')]=setTimeout(WebSAGE['callServer'],WebSAGE[_0x3a71('0x2e5')]);WebSAGE[_0x3a71('0x1d9')]++;};WebSAGE['getServerStatus']=function(){if(BrowserDetect[_0x3a71('0x49')]==_0x3a71('0x2e7')&&typeof WebSAGE[_0x3a71('0x2e8')]==_0x3a71('0x8f')){WebSAGE['SafariRenderBugRedraw']=0x1;setTimeout(function(){var _0x3f86be=document[_0x3a71('0x1f9')]('MouseEvents');_0x3f86be[_0x3a71('0x1fc')](_0x3a71('0x1be'),!![],!![],window,0x0,0x0,0x0,0x50,0x14,![],![],![],![],0x0,SVGDoc);SVGDoc['dispatchEvent'](_0x3f86be);},0x64);setTimeout(function(){var _0x135371=document[_0x3a71('0x1f9')](_0x3a71('0x1fb'));_0x135371[_0x3a71('0x1fc')](_0x3a71('0x1fd'),!![],!![],window,0x0,0x0,0x0,0x50,0x14,![],![],![],![],0x0,null);SVGDoc[_0x3a71('0x1fa')](_0x135371);},0x6e);}};var PBIColorBad='red';var PBIColorGood=_0x3a71('0x105');var PBIColorBackground='none';var PBIColorForeground=_0x3a71('0x2e9');var PBIColorSelected='#333333';var PBIColorNegative=_0x3a71('0x2ea');var PBIColorPositive=_0x3a71('0x2eb');var PBIColorMaximum=_0x3a71('0x2ec');var PBIColorMinimum='#FD625E';var PBIColorTable=new Array();var ScreenViewer_Background=_0x3a71('0x1c');var xPlain=!![];var optval=[];var opttxt=[];var optfilt=[];var optgroup=[];var optionhtml='';function lista_telas(){};var tela='';var indtela=0x0;var hvalues=[];window[_0x3a71('0x2ed')]=![];function scadavis(_0x277456,_0x13ac58,_0x3a2af7){var _0xdae03b=this;var _0x58a9be='1.0.1';var _0x298211;var _0x4a6a30=_0x3a71('0x2ee');if(typeof _0x277456===_0x3a71('0x134')){_0xdae03b['container']=_0x277456[_0x3a71('0x2ef')]||'';_0xdae03b[_0x3a71('0x2f0')]=_0x277456['apikey']||'';_0xdae03b[_0x3a71('0x2f1')]=_0x277456[_0x3a71('0x2f1')]||_0x3a71('0x2f2');_0xdae03b[_0x3a71('0x2f3')]=_0x277456[_0x3a71('0x2f3')]||'';}else{_0xdae03b[_0x3a71('0x2ef')]=_0x277456||'';_0xdae03b[_0x3a71('0x2f0')]=apikey||'';_0xdae03b['iframeparams']=_0x13ac58||'frameborder=\x220\x22\x20height=\x22250\x22\x20width=\x22250\x22';_0xdae03b[_0x3a71('0x2f3')]=_0x3a2af7||'';}_0xdae03b[_0x3a71('0x2f4')]=null;_0xdae03b['componentloaded']=![];_0xdae03b[_0x3a71('0x2f5')]=![];_0xdae03b['domain']='*';_0xdae03b[_0x3a71('0x2f6')]={'data':{'type':_0x3a71('0x2bc'),'tags':[]}};_0xdae03b[_0x3a71('0x2f7')]={};_0xdae03b[_0x3a71('0x2f8')]={};_0xdae03b[_0x3a71('0x2f9')]={};_0xdae03b[_0x3a71('0x2fa')]={};_0xdae03b[_0x3a71('0x2fb')]=0x0;_0xdae03b[_0x3a71('0x2fc')]=null;_0xdae03b[_0x3a71('0x2fd')]=null;_0xdae03b[_0x3a71('0x2fe')]=null;_0xdae03b['enabletoolsobj']=null;_0xdae03b[_0x3a71('0x2ff')]=null;_0xdae03b['hidewatermarkobj']=null;_0xdae03b[_0x3a71('0x300')]=null;_0xdae03b[_0x3a71('0x301')]='';_0xdae03b[_0x3a71('0x302')]=null;_0xdae03b['onclick']=null;_0xdae03b[_0x3a71('0x303')]=null;_0xdae03b[_0x3a71('0x304')]=0x1;_0xdae03b[_0x3a71('0x305')]=0x0;_0xdae03b['guidGenerator']=function(){var _0x2f623a=function(){return((0x1+Math['random']())*0x10000|0x0)[_0x3a71('0x3b')](0x10)[_0x3a71('0x45')](0x1);};return _0x2f623a()+_0x2f623a()+'-'+_0x2f623a()+'-'+_0x2f623a()+'-'+_0x2f623a()+'-'+_0x2f623a()+_0x2f623a()+_0x2f623a();};_0xdae03b[_0x3a71('0x306')]=function(_0x2e7685){var _0x59e38e=document['createElement'](_0x3a71('0x1d1'));_0x59e38e[_0x3a71('0x1d2')]=_0x2e7685[_0x3a71('0x38')]();return _0x59e38e['firstChild'];};_0x298211=_0xdae03b[_0x3a71('0x307')]();if(typeof _0xdae03b[_0x3a71('0x2ef')]===_0x3a71('0x52')){_0xdae03b['container']=document[_0x3a71('0x133')](_0xdae03b[_0x3a71('0x2ef')]);if(_0xdae03b[_0x3a71('0x2ef')]===null){_0xdae03b[_0x3a71('0x2ef')]=document[_0x3a71('0x22f')];}}if(_0xdae03b['iframeparams'][_0x3a71('0x3d')](_0x3a71('0x308'))>=0x0)_0x4a6a30='';_0xdae03b['loadScript']=function(_0x1ecaf1,_0x26e3ee){if(_0x26e3ee==_0x1ecaf1[_0x3a71('0x2c')]-0x1)_0x1ecaf1[_0x26e3ee]();else{var _0x26bea2,_0x3d2136,_0x19e284;_0x3d2136=![];_0x26bea2=document[_0x3a71('0x15')](_0x3a71('0x1dd'));_0x26bea2['type']=_0x3a71('0x309');_0x26bea2[_0x3a71('0x33')]=_0x1ecaf1[_0x26e3ee];_0x26bea2[_0x3a71('0x30a')]=_0x26bea2['onreadystatechange']=function(){if(!_0x3d2136&&(!this[_0x3a71('0x30b')]||this[_0x3a71('0x30b')]==_0x3a71('0x30c'))){_0x3d2136=!![];_0xdae03b[_0x3a71('0x30d')](_0x1ecaf1,_0x26e3ee+0x1);}};_0x19e284=document['getElementsByTagName'](_0x3a71('0x1dd'))[0x0];_0x19e284[_0x3a71('0xa8')]['insertBefore'](_0x26bea2,_0x19e284);}};WebSAGE['reload']=function(_0x38669f){};WebSAGE[_0x3a71('0x2e0')]=function(){};V[0x1869f]=0x0;F[0x1869f]=0x0;V[0x18695]=0x0;F[0x18695]=0x0;var _0x364a20=_0x3a71('0x30e');if(_0xdae03b[_0x3a71('0x2ef')][_0x3a71('0x1d2')]!==undefined)_0xdae03b[_0x3a71('0x2ef')]['appendChild'](_0xdae03b[_0x3a71('0x306')](_0x364a20));else _0xdae03b[_0x3a71('0x2ef')][_0x3a71('0x30f')](_0x3a71('0x310'),_0x364a20);_0xdae03b['iframe']=document[_0x3a71('0x133')](_0x3a71('0x1db'));var _0x260f18=_0x3a71('0x311');if(_0xdae03b[_0x3a71('0x2ef')][_0x3a71('0x1d2')]!==undefined)_0xdae03b[_0x3a71('0x2ef')][_0x3a71('0x19')](_0xdae03b[_0x3a71('0x306')](_0x260f18));else _0xdae03b[_0x3a71('0x2ef')][_0x3a71('0x30f')](_0x3a71('0x310'),_0x260f18);var _0x50d9bb='<div\x20id=\x27SVTEXT\x27></div>';if(_0xdae03b[_0x3a71('0x2ef')]['innerHTML']!==undefined)_0xdae03b[_0x3a71('0x2ef')][_0x3a71('0x19')](_0xdae03b[_0x3a71('0x306')](_0x50d9bb));else _0xdae03b['container'][_0x3a71('0x30f')]('afterend',_0x50d9bb);window[_0x3a71('0x312')]=function(_0x210fc9,_0x2e5714){var _0x295668={'data':{'type':_0x3a71('0x313'),'id':'3','attributes':{'version':'1.0.1','event':{'target':{'id':_0x210fc9[_0x3a71('0x82')]['id']},'currentTarget':{'id':_0x210fc9[_0x3a71('0x314')]['id']},'clientX':_0x210fc9[_0x3a71('0x24e')],'ClientY':_0x210fc9[_0x3a71('0x251')],'ctrlKey':_0x210fc9[_0x3a71('0x315')],'altKey':_0x210fc9['altKey'],'shiftKey':_0x210fc9['shiftKey'],'metaKey':_0x210fc9[_0x3a71('0x316')],'which':_0x210fc9['which'],'timeStamp':_0x210fc9['timeStamp']},'tag':TAGS[_0x2e5714]},'links':{'self':_0x3a71('0x317')}},'meta':{'copyright':_0x3a71('0x318'),'authors':['Ricardo\x20Olsen']},'jsonapi':{'version':_0x3a71('0x319')}};window[_0x3a71('0x31a')](_0x295668,'*');};window[_0x3a71('0x6f')](_0x3a71('0x1f8'),function(_0x586e97){if(typeof _0x586e97['data']=='string'&&_0x586e97[_0x3a71('0xbb')][_0x3a71('0x3d')]('<?xml')>=0x0){var _0x19a46f=document['getElementById']('svgdiv');_0x19a46f[_0x3a71('0x1d2')]=_0x586e97[_0x3a71('0xbb')];$(_0x19a46f[_0x3a71('0x196')])['css']('background-color',VisorTelas_BackgroundSVG);_0x19a46f[_0x3a71('0x196')]['id']=_0x3a71('0x31b');setTimeout(function(){WebSAGE[_0x3a71('0x90')]();var _0x4e1172={'data':{'type':_0x3a71('0x31c'),'id':'2','attributes':{'version':_0x3a71('0x31d'),'tagsList':$W[_0x3a71('0x14d')][_0x3a71('0x31e')](0x0,-0x1)},'links':{'self':'http://scadavis.io/synoptic/synoptic.html'}},'meta':{'copyright':_0x3a71('0x31f'),'authors':['Ricardo\x20Olsen']},'jsonapi':{'version':'1.0'}};setTimeout(function(){window['postMessage'](_0x4e1172,'*');},0x262);},0x258);}else{if(typeof _0x586e97[_0x3a71('0xbb')]==='object')WebSAGE[_0x3a71('0x2ba')](_0x586e97[_0x3a71('0xbb')]);}},![]);var _0x1a0448={'data':{'type':'loaded','id':'1','attributes':{'version':_0x3a71('0x31d')},'links':{'self':_0x3a71('0x317')}},'meta':{'copyright':_0x3a71('0x318'),'authors':[_0x3a71('0x320')]},'jsonapi':{'version':_0x3a71('0x319')}};window[_0x3a71('0x31a')](_0x1a0448,'*');_0xdae03b['loadURL']=function(_0x3a2af7){_0xdae03b['svgobj']=null;_0xdae03b[_0x3a71('0x2f5')]=![];_0xdae03b[_0x3a71('0x2f3')]=_0x3a2af7;if(_0xdae03b['svgurl']!==''&&_0xdae03b['loadingSVG']===0x0){_0xdae03b[_0x3a71('0x305')]=0x1;var _0x4b5296=new XMLHttpRequest();_0x4b5296[_0x3a71('0x27')]('GET',_0xdae03b['svgurl']);_0x4b5296['onload']=function(){if(_0x4b5296[_0x3a71('0x321')]===0xc8){_0xdae03b[_0x3a71('0x305')]=0x0;if(_0xdae03b[_0x3a71('0x322')])window[_0x3a71('0x31a')](_0x4b5296[_0x3a71('0x323')],_0xdae03b[_0x3a71('0x324')]);else _0xdae03b[_0x3a71('0x2fc')]=_0x4b5296['responseText'];}};_0x4b5296[_0x3a71('0x325')]=function(_0x1efc18){if(_0x4b5296[_0x3a71('0x30b')]===0x4){if(_0x4b5296['status']===0xc8){}else{_0xdae03b[_0x3a71('0x305')]=0x0;console[_0x3a71('0x15f')](_0x3a71('0x326')+_0x4b5296['statusText']);}}};_0x4b5296['send']();}};_0xdae03b[_0x3a71('0x327')]=function(_0x392614){if(!_0xdae03b[_0x3a71('0x2f5')])return;if(typeof _0x392614===_0x3a71('0x134')&&_0x392614!==null)Object[_0x3a71('0x328')](_0x392614)[_0x3a71('0xbf')](function(_0x5a104c,_0xbba910){var _0x1634c4;if(_0x5a104c in _0xdae03b['npts']){_0x1634c4=_0xdae03b[_0x3a71('0x2f7')][_0x5a104c];}else{_0x1634c4=++_0xdae03b['npt'];_0xdae03b[_0x3a71('0x2f7')][_0x5a104c]=_0x1634c4;}_0xdae03b[_0x3a71('0x2f8')][_0x5a104c]=_0x392614[_0x5a104c];_0xdae03b[_0x3a71('0x2f9')][_0x5a104c]=0x0;});var _0x201f21={'data':{'type':'tags','tags':[]}};Object['keys'](_0xdae03b[_0x3a71('0x2f7')])[_0x3a71('0xbf')](function(_0x2f10ea,_0x3cb51d){_0x201f21['data'][_0x3a71('0x2bc')][_0x3cb51d]={};_0x201f21[_0x3a71('0xbb')][_0x3a71('0x2bc')][_0x3cb51d][_0x3a71('0x1ce')]=_0x2f10ea;_0x201f21['data'][_0x3a71('0x2bc')][_0x3cb51d][_0x3a71('0x24')]=_0xdae03b[_0x3a71('0x2f8')][_0x2f10ea];_0x201f21[_0x3a71('0xbb')][_0x3a71('0x2bc')][_0x3cb51d][_0x3a71('0x2be')]=!(_0xdae03b[_0x3a71('0x2f9')][_0x2f10ea]&0x80);if(typeof _0xdae03b['vals'][_0x2f10ea]==_0x3a71('0x3e'))_0x201f21[_0x3a71('0xbb')][_0x3a71('0x2bc')][_0x3cb51d][_0x3a71('0x17')]=_0x3a71('0x2c7');else if(typeof _0xdae03b['vals'][_0x2f10ea]=='boolean')_0x201f21[_0x3a71('0xbb')]['tags'][_0x3cb51d]['type']=_0x3a71('0x2bd');else _0x201f21[_0x3a71('0xbb')]['tags'][_0x3cb51d]['type']=_0x3a71('0x52');_0x201f21[_0x3a71('0xbb')]['tags'][_0x3cb51d]['parameters']={'Value':{'TagClientItem':_0xdae03b[_0x3a71('0x2f7')][_0x2f10ea],'Alarmed':(_0xdae03b['qualifs'][_0x2f10ea]&0x100)===0x100,'Desc':_0xdae03b[_0x3a71('0x2fa')][_0x2f10ea]}};});if(_0xdae03b[_0x3a71('0x2f5')])window[_0x3a71('0x31a')](_0x201f21,_0xdae03b[_0x3a71('0x324')]);};_0xdae03b[_0x3a71('0x329')]=function(_0x1b736a,_0x4514c9,_0xcdf2e,_0x582a68,_0x53c675){var _0x41260b;_0xcdf2e=_0xcdf2e||![];_0x582a68=_0x582a68||![];_0x53c675=_0x53c675||_0x1b736a;if(_0x1b736a in _0xdae03b[_0x3a71('0x2f7')]){_0x41260b=_0xdae03b['npts'][_0x1b736a];}else{_0x41260b=++_0xdae03b['npt'];_0xdae03b[_0x3a71('0x2f7')][_0x1b736a]=_0x41260b;}_0xdae03b[_0x3a71('0x2f8')][_0x1b736a]=_0x4514c9;_0xdae03b[_0x3a71('0x2f9')][_0x1b736a]=(_0xcdf2e?0x80:0x0)|(_0x582a68?0x100:0x0);_0xdae03b[_0x3a71('0x2fa')][_0x1b736a]=_0x53c675;if(_0xdae03b[_0x3a71('0x2f5')]){var _0xa7345={'data':{'type':_0x3a71('0x2bc'),'tags':[]}};_0xa7345[_0x3a71('0xbb')]['tags'][0x0]={};_0xa7345[_0x3a71('0xbb')][_0x3a71('0x2bc')][0x0][_0x3a71('0x1ce')]=_0x1b736a;_0xa7345['data']['tags'][0x0][_0x3a71('0x24')]=_0x4514c9;_0xa7345[_0x3a71('0xbb')][_0x3a71('0x2bc')][0x0][_0x3a71('0x2be')]=!(_0xdae03b[_0x3a71('0x2f9')][_0x1b736a]&0x80);if(typeof _0x4514c9==_0x3a71('0x3e'))_0xa7345[_0x3a71('0xbb')][_0x3a71('0x2bc')][0x0][_0x3a71('0x17')]=_0x3a71('0x2c7');else if(typeof _0x4514c9==_0x3a71('0x2cf'))_0xa7345[_0x3a71('0xbb')][_0x3a71('0x2bc')][0x0][_0x3a71('0x17')]='bool';else _0xa7345[_0x3a71('0xbb')]['tags'][0x0]['type']=_0x3a71('0x52');_0xa7345[_0x3a71('0xbb')]['tags'][0x0][_0x3a71('0x2bf')]={'Value':{'TagClientItem':_0x41260b,'Alarmed':(_0xdae03b[_0x3a71('0x2f9')][_0x1b736a]&0x100)===0x100,'Desc':_0xdae03b[_0x3a71('0x2fa')][_0x1b736a]}};window['postMessage'](_0xa7345,_0xdae03b[_0x3a71('0x324')]);}return _0xdae03b[_0x3a71('0x2f5')];};_0xdae03b[_0x3a71('0x32a')]=function(_0x26280c,_0x2d936b,_0x38f197,_0x45d8c6,_0x4c7f1e){var _0x8ee2c6;_0x38f197=_0x38f197||![];_0x45d8c6=_0x45d8c6||![];_0x4c7f1e=_0x4c7f1e||_0x26280c;if(_0x26280c in _0xdae03b[_0x3a71('0x2f7')]){_0x8ee2c6=_0xdae03b[_0x3a71('0x2f7')][_0x26280c];}else{_0x8ee2c6=++_0xdae03b[_0x3a71('0x2fb')];_0xdae03b[_0x3a71('0x2f7')][_0x26280c]=_0x8ee2c6;}_0xdae03b['vals'][_0x26280c]=_0x2d936b;_0xdae03b['qualifs'][_0x26280c]=(_0x38f197?0x80:0x0)|(_0x45d8c6?0x100:0x0);_0xdae03b[_0x3a71('0x2fa')][_0x26280c]=_0x4c7f1e;return _0xdae03b['readyfordata'];};_0xdae03b['resetData']=function(){_0xdae03b['npt']=0x0;_0xdae03b[_0x3a71('0x2f7')]={};_0xdae03b[_0x3a71('0x2f8')]={};_0xdae03b['qualifs']={};_0xdae03b[_0x3a71('0x2fa')]={};var _0x2b4080={'data':{'type':'resetData'}};if(_0xdae03b['readyfordata'])window['postMessage'](_0x2b4080,_0xdae03b[_0x3a71('0x324')]);else _0xdae03b[_0x3a71('0x300')]=_0x2b4080;};_0xdae03b[_0x3a71('0x13e')]=function(_0x590093){if(_0x590093 in _0xdae03b['vals']){return _0xdae03b['vals'][_0x590093];}return null;};_0xdae03b[_0x3a71('0x32b')]=function(){return _0xdae03b[_0x3a71('0x2f0')];};_0xdae03b[_0x3a71('0x32c')]=function(){return _0x58a9be;};_0xdae03b[_0x3a71('0x32d')]=function(){return _0xdae03b[_0x3a71('0x2f4')];};_0xdae03b[_0x3a71('0x32e')]=function(){if(_0xdae03b[_0x3a71('0x322')]==![])return 0x0;else if(_0xdae03b[_0x3a71('0x2f5')]==![])return 0x1;return 0x2;};_0xdae03b[_0x3a71('0x32f')]=function(){return _0x58a9be;};_0xdae03b['getTagsList']=function(){return _0xdae03b[_0x3a71('0x301')];};_0xdae03b[_0x3a71('0x2d4')]=function(_0x361026,_0xdf9c8b,_0x11e126){_0x361026=_0x361026||0x0;_0xdf9c8b=_0xdf9c8b||0x0;_0x11e126=_0x11e126||![];var _0x4649a1={'data':{'type':'moveBy','dx':_0x361026,'dy':_0xdf9c8b,'animate':_0x11e126}};if(_0xdae03b[_0x3a71('0x2f5')])window[_0x3a71('0x31a')](_0x4649a1,_0xdae03b['domain']);else _0xdae03b['moveobj']=_0x4649a1;};_0xdae03b[_0x3a71('0x330')]=function(_0x5ced20,_0x38829d,_0xe9d61d){_0x5ced20=_0x5ced20||1.1;this['zoomlevel']=_0x5ced20;_0xe9d61d=_0xe9d61d||![];var _0x342b02={'data':{'type':_0x3a71('0x330'),'zoomLevel':_0x5ced20,'target':_0x38829d,'animate':_0xe9d61d}};if(_0xdae03b['readyfordata'])window[_0x3a71('0x31a')](_0x342b02,_0xdae03b['domain']);else _0xdae03b[_0x3a71('0x2fd')]=_0x342b02;};_0xdae03b['zoomToOriginal']=function(_0x3f46c4){this['zoomlevel']=0x1;_0x3f46c4=_0x3f46c4||![];var _0x118968={'data':{'type':_0x3a71('0x331'),'animate':_0x3f46c4}};if(_0xdae03b['readyfordata'])window[_0x3a71('0x31a')](_0x118968,_0xdae03b['domain']);};_0xdae03b['enableTools']=function(_0x406282,_0x5bc294){if(typeof _0x406282===_0x3a71('0x8f')||_0x406282)_0x406282=!![];if(typeof _0x5bc294===_0x3a71('0x8f')||_0x5bc294)_0x5bc294=!![];var _0x1d7df1={'data':{'type':_0x3a71('0x2d5'),'panEnabled':_0x406282,'zoomEnabled':_0x5bc294}};if(_0xdae03b[_0x3a71('0x2f5')])window[_0x3a71('0x31a')](_0x1d7df1,_0xdae03b[_0x3a71('0x324')]);else _0xdae03b[_0x3a71('0x332')]=_0x1d7df1;};_0xdae03b[_0x3a71('0x333')]=function(_0x1b4d81,_0x4ba928){if(typeof _0x1b4d81===_0x3a71('0x8f')||_0x1b4d81)_0x1b4d81=!![];if(typeof _0x4ba928==='undefined'||_0x4ba928)_0x4ba928=!![];var _0x4cb885={'data':{'type':'enableMouse','panEnabled':_0x1b4d81,'zoomEnabled':_0x4ba928}};if(_0xdae03b[_0x3a71('0x2f5')])window[_0x3a71('0x31a')](_0x4cb885,_0xdae03b[_0x3a71('0x324')]);else _0xdae03b[_0x3a71('0x334')]=_0x4cb885;};_0xdae03b[_0x3a71('0x2db')]=function(_0x388013){if(typeof _0x388013===_0x3a71('0x8f')||_0x388013)_0x388013=!![];var _0x463f07={'data':{'type':'enableKeyboard','keyEnabled':_0x388013}};if(_0xdae03b[_0x3a71('0x2f5')])window[_0x3a71('0x31a')](_0x463f07,_0xdae03b[_0x3a71('0x324')]);else _0xdae03b[_0x3a71('0x2ff')]=_0x463f07;};_0xdae03b[_0x3a71('0x2de')]=function(_0x1ea417,_0x2b2a6a){LT=_0x1ea417,VK=_0x2b2a6a;var _0x23d480={'data':{'type':_0x3a71('0x2de'),'lt':_0x1ea417,'vk':_0x2b2a6a}};if(_0xdae03b['readyfordata'])window[_0x3a71('0x31a')](_0x23d480,_0xdae03b[_0x3a71('0x324')]);else _0xdae03b[_0x3a71('0x303')]=_0x23d480;};_0xdae03b['getLt']=function(){return LT;};_0xdae03b['getVk']=function(){return VK;};_0xdae03b[_0x3a71('0x2dc')]=function(){var _0x5814ad={'data':{'type':'hideWatermark'}};if(_0xdae03b[_0x3a71('0x2f5')])window[_0x3a71('0x31a')](_0x5814ad,_0xdae03b[_0x3a71('0x324')]);else _0xdae03b[_0x3a71('0x335')]=_0x5814ad;};_0xdae03b['on']=function(_0x404e49,_0x2d7b8b){var _0x16d6ef=![];switch(_0x404e49){case _0x3a71('0x31c'):_0xdae03b['onready']=_0x2d7b8b;_0x16d6ef=!![];break;case _0x3a71('0x313'):_0xdae03b[_0x3a71('0x192')]=_0x2d7b8b;_0x16d6ef=!![];break;default:break;}return _0x16d6ef;};_0xdae03b[_0x3a71('0x322')]=![];_0xdae03b[_0x3a71('0x2f5')]=![];if(_0xdae03b['svgurl']!=='')_0xdae03b['loadURL'](_0xdae03b[_0x3a71('0x2f3')]);window[_0x3a71('0x6f')](_0x3a71('0x1f8'),function(_0x317f54){if(!![]){if(typeof _0x317f54[_0x3a71('0xbb')]===_0x3a71('0x134')&&_0x317f54[_0x3a71('0xbb')]['data']['type']!==undefined&&_0x317f54[_0x3a71('0xbb')][_0x3a71('0xbb')]['type']===_0x3a71('0x336')){_0xdae03b[_0x3a71('0x322')]=!![];if(_0xdae03b[_0x3a71('0x2fc')]!==null)window[_0x3a71('0x31a')](_0xdae03b[_0x3a71('0x2fc')],'*');else if(_0xdae03b[_0x3a71('0x2f3')]!=='')_0xdae03b[_0x3a71('0x337')](_0xdae03b[_0x3a71('0x2f3')]);}if(typeof _0x317f54[_0x3a71('0xbb')]===_0x3a71('0x134')&&_0x317f54['data']['data'][_0x3a71('0x17')]!==undefined&&_0x317f54[_0x3a71('0xbb')][_0x3a71('0xbb')]['type']===_0x3a71('0x31c')){var _0x5e55f0=_0x317f54['origin'];if(_0x317f54['origin']==_0x3a71('0x338'))_0x5e55f0='*';_0xdae03b[_0x3a71('0x2f5')]=!![];_0xdae03b[_0x3a71('0x301')]=_0x317f54['data'][_0x3a71('0xbb')][_0x3a71('0x268')][_0x3a71('0x301')];_0xdae03b[_0x3a71('0x327')]();if(_0xdae03b[_0x3a71('0x2fd')]){_0x317f54[_0x3a71('0x274')][_0x3a71('0x31a')](_0xdae03b['zoomobj'],_0x5e55f0);_0xdae03b[_0x3a71('0x2fd')]=null;}if(_0xdae03b[_0x3a71('0x2fe')]){window[_0x3a71('0x31a')](_0xdae03b['moveobj'],_0x5e55f0);_0xdae03b[_0x3a71('0x2fe')]=null;}if(_0xdae03b['enabletoolsobj']){window[_0x3a71('0x31a')](_0xdae03b[_0x3a71('0x332')],_0x5e55f0);_0xdae03b['enabletoolsobj']=null;}if(_0xdae03b[_0x3a71('0x334')]){window['postMessage'](_0xdae03b[_0x3a71('0x334')],_0x5e55f0);_0xdae03b['enablemouseobj']=null;}if(_0xdae03b['enablekeyboardobj']){window[_0x3a71('0x31a')](_0xdae03b[_0x3a71('0x2ff')],_0x5e55f0);_0xdae03b['enablekeyboardobj']=null;}if(_0xdae03b[_0x3a71('0x303')]){window[_0x3a71('0x31a')](_0xdae03b[_0x3a71('0x303')],_0x5e55f0);_0xdae03b[_0x3a71('0x303')]=null;}if(_0xdae03b[_0x3a71('0x335')]){window['postMessage'](_0xdae03b['hidewatermarkobj'],_0x5e55f0);_0xdae03b[_0x3a71('0x335')]=null;}if(_0xdae03b[_0x3a71('0x302')])_0xdae03b[_0x3a71('0x302')]();}if(typeof _0x317f54[_0x3a71('0xbb')]===_0x3a71('0x134')&&_0x317f54[_0x3a71('0xbb')][_0x3a71('0xbb')][_0x3a71('0x17')]!==undefined&&_0x317f54['data'][_0x3a71('0xbb')]['type']===_0x3a71('0x313')){if(_0xdae03b[_0x3a71('0x192')])_0xdae03b[_0x3a71('0x192')](_0x317f54[_0x3a71('0xbb')][_0x3a71('0xbb')][_0x3a71('0x268')][_0x3a71('0x75')],_0x317f54[_0x3a71('0xbb')][_0x3a71('0xbb')][_0x3a71('0x268')]['tag']);}}});}
var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
/*
 *  SCADAvis.io Infographic & Synoptic Panel Custom Visual for Power BI
 *
 *  Copyright (c) 2019 Ricardo Lastra Olsen / DSC Systems
 *  All rights reserved.
 *  https://scadavis.io/powerbi
 *
 *  Permission is hereby granted, free of charge for up to 35 animations per panel.
 *  For more animated objects it is required to acquire a license.
 *  It is strictly prohibited the unauthorized distribution, modification,
 *  merge, publish, sublicense, and/or sell of the Software.
 *  The use of the Software is also subject to the following conditions:
 *
 *  THE SOFTWARE IS PROVIDED *AS IS*, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 *  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 *  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 *  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 *  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 *  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 *  THE SOFTWARE.
 */
var powerbi;
(function (powerbi) {
    var extensibility;
    (function (extensibility) {
        var visual;
        (function (visual) {
            var sCADAvisA1696DB7096B4CBBA3B7595D70A805AF;
            (function (sCADAvisA1696DB7096B4CBBA3B7595D70A805AF) {
                "use strict";
                var DataViewObjectsParser = powerbi.extensibility.utils.dataview.DataViewObjectsParser;
                var VisualSettings = (function (_super) {
                    __extends(VisualSettings, _super);
                    function VisualSettings() {
                        var _this = _super !== null && _super.apply(this, arguments) || this;
                        _this.scadavis_settings = new scadavisSettings();
                        return _this;
                    }
                    return VisualSettings;
                }(DataViewObjectsParser));
                sCADAvisA1696DB7096B4CBBA3B7595D70A805AF.VisualSettings = VisualSettings;
                var scadavisSettings = (function () {
                    function scadavisSettings() {
                        this.svgurl = "";
                        this.zoomlevel = 1;
                        this.licensetext = "";
                        this.validationkey = "";
                    }
                    return scadavisSettings;
                }());
                sCADAvisA1696DB7096B4CBBA3B7595D70A805AF.scadavisSettings = scadavisSettings;
            })(sCADAvisA1696DB7096B4CBBA3B7595D70A805AF = visual.sCADAvisA1696DB7096B4CBBA3B7595D70A805AF || (visual.sCADAvisA1696DB7096B4CBBA3B7595D70A805AF = {}));
        })(visual = extensibility.visual || (extensibility.visual = {}));
    })(extensibility = powerbi.extensibility || (powerbi.extensibility = {}));
})(powerbi || (powerbi = {}));
/*
 *  SCADAvis.io Infographic & Synoptic Panel Custom Visual for Power BI
 *
 *  Copyright (c) 2019 Ricardo Lastra Olsen / DSC Systems
 *  All rights reserved.
 *  https://scadavis.io/powerbi
 *
 *  Permission is hereby granted, free of charge for up to 35 animations per panel.
 *  For more animated objects it is required to acquire a license.
 *  It is strictly prohibited the unauthorized distribution, modification,
 *  merge, publish, sublicense, and/or sell of the Software.
 *  The use of the Software is also subject to the following conditions:
 *
 *  THE SOFTWARE IS PROVIDED *AS IS*, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 *  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 *  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 *  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 *  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 *  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 *  THE SOFTWARE.
 */
var powerbi;
(function (powerbi) {
    var extensibility;
    (function (extensibility) {
        var visual;
        (function (visual) {
            var sCADAvisA1696DB7096B4CBBA3B7595D70A805AF;
            (function (sCADAvisA1696DB7096B4CBBA3B7595D70A805AF) {
                "use strict";
                var Visual = (function () {
                    // private initctl: number = 0;
                    function Visual(options) {
                        this.tm = 0;
                        this.target = options.element;
                        this.host = options.host;
                        if (typeof document !== "undefined") {
                            this.svgraph =
                                new scadavis({
                                    container: this.target
                                });
                            this.target.children[2].innerHTML = '<div id="welcomediv" style="text-align:center;font-family:Segoe UI,arial,helvetica;font-size:15px;">' +
                                '<svg width="64px" height="64px" version="1.1" viewBox="0 0 354.33071 354.33071" xmlns="http://www.w3.org/2000/svg" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><g transform="translate(0 -698.03)"><g transform="translate(0 .71429)"><path d="m0.90434 696.62 63.865 61.536 230.07 0.10306 59.228-61.405c-137.07 0.38061-216.09 0.12678-353.17-0.23407z" fill="#555"/><path d="m105.74 799.33 45.813 45.344 16.048-0.0144v62.27l-20.229-0.24168-42.28 43.932c175.85-0.32139-19.684-0.21704 142.96-0.21713l-38.21-42.969-20.915-0.24865v-62.547l18.889-0.0179 44.034-45.06c-175.85 0.3214 16.982-0.23115-145.66-0.23115z" fill="#bbb"/><path d="m0.86814 1053.4 63.865-61.536 230.07-0.10304 59.228 61.405c-137.07-0.3807-216.09-0.1268-353.17 0.234z" fill="#555"/></g></g></svg>' +
                                "<br>SCADAvis.io<br>Synoptic Visual<br><a href='https://scadavis.io/powerbi' target='_blank'>https://scadavis.io/powerbi</a>" +
                                "</div>";
                            this.target.children[2]["style"].opacity = 0.7;
                        }
                    }
                    Visual.prototype.update = function (options) {
                        if (!options ||
                            !options.dataViews ||
                            !options.dataViews[0] ||
                            !options.viewport) {
                            return;
                        }
                        var _this = this;
                        this.visualSettings = Visual.parseSettings(options && options.dataViews && options.dataViews[0]);
                        //console.log('Visual update', options);
                        //console.log(this.visualSettings);
                        //console.log(options.type);
                        //console.log(this.host)
                        var welcomeDiv = document.getElementById("welcomediv");
                        if (welcomeDiv)
                            welcomeDiv.style.fontSize = 8 + options.viewport.width / 30 + "px";
                        var urlchanged = false;
                        var hasnewurl = this.visualSettings.scadavis_settings.svgurl != this.svgraph.svgurl;
                        if ((typeof options.dataViews["0"].metadata.objects === 'undefined' || typeof options.dataViews["0"].metadata.objects.svgurl === 'undefined' || hasnewurl) && this.visualSettings.scadavis_settings.svgurl == "") {
                            document.getElementById("svgdiv").style.display = "none";
                            this.svgraph.resetData();
                            if (this.visualSettings.scadavis_settings.svgurl && this.svgraph.svgurl != "")
                                this.svgraph.svgurl = "";
                            var svginstuctions = "";
                            // Safari does not allow for local file load in PowerBI iframe!
                            if (navigator.userAgent.indexOf('Safari') != -1 && navigator.userAgent.indexOf('Chrome') == -1 && navigator.userAgent.indexOf('Android') == -1) {
                                svginstuctions =
                                    "<br>Go to 'Format' tool | 'SVG Source' | 'URL'" +
                                        "<br>Enter the URL or a Base64 URI for an SVG file." +
                                        "<br>Try: https://scadavis.io/powerbi/powerbi-scadavis-custom-visual.svg" +
                                        "<br>OR" +
                                        "<br>Convert a local file to a Base64 data URI like data:image/svg+xml;base64,...";
                            }
                            else {
                                svginstuctions =
                                    "<br>Select a local file" +
                                        "<br><input type='button' id='loadFile' value='Load File' onclick=\"document.getElementById('fileInput').click();\" />" +
                                        "<input type='file' id='fileInput' accept='.svg' value='' style='display:none;'>" +
                                        "<br>OR" +
                                        "<br>Go to 'Format' tool | 'SVG Source' | 'URL'" +
                                        "<br>Enter the URL or a Base64 URI for an SVG file." +
                                        "<br>Try: https://scadavis.io/powerbi/powerbi-scadavis-custom-visual.svg";
                            }
                            var fontsize = 8 + options.viewport.width / 100;
                            this.target.children[2].innerHTML = '<div id="welcomediv" style="text-align:center;font-family:Segoe UI,arial,helvetica;font-size:' + fontsize + 'px;">' +
                                '<svg width="64px" height="64px" version="1.1" viewBox="0 0 354.33071 354.33071" xmlns="http://www.w3.org/2000/svg" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><g transform="translate(0 -698.03)"><g transform="translate(0 .71429)"><path d="m0.90434 696.62 63.865 61.536 230.07 0.10306 59.228-61.405c-137.07 0.38061-216.09 0.12678-353.17-0.23407z" fill="#555"/><path d="m105.74 799.33 45.813 45.344 16.048-0.0144v62.27l-20.229-0.24168-42.28 43.932c175.85-0.32139-19.684-0.21704 142.96-0.21713l-38.21-42.969-20.915-0.24865v-62.547l18.889-0.0179 44.034-45.06c-175.85 0.3214 16.982-0.23115-145.66-0.23115z" fill="#bbb"/><path d="m0.86814 1053.4 63.865-61.536 230.07-0.10304 59.228 61.405c-137.07-0.3807-216.09-0.1268-353.17 0.234z" fill="#555"/></g></g></svg>' +
                                "<br>SCADAvis.io Synoptic Visual<br><a href='https://scadavis.io/powerbi' target='_blank'>https://scadavis.io/powerbi</a><br>" +
                                svginstuctions +
                                "</div>";
                            this.target.children[2]["style"].opacity = 0.7;
                            this.target.children[2]["style"].display = "";
                            var fileInput = document.getElementById("fileInput");
                            if (fileInput)
                                fileInput.addEventListener('change', function (e) {
                                    var file = fileInput["files"][0];
                                    if (file.type == "image/svg+xml") {
                                        var reader = new FileReader();
                                        reader.onload = function (e) {
                                            _this.host.persistProperties({
                                                replace: [{
                                                        objectName: "scadavis_settings",
                                                        selector: null,
                                                        properties: {
                                                            svgurl: reader.result
                                                        }
                                                    }]
                                            });
                                        };
                                        reader.readAsDataURL(file);
                                    }
                                });
                            return;
                        }
                        document.getElementById("svgdiv").style.display = "";
                        try {
                            if (this.host.colorPalette.hasOwnProperty("colors")) {
                                PBIColorTable = this.host.colorPalette["colors"].slice();
                                PBIColorBackground = this.host.colorPalette.background;
                                PBIColorForeground = this.host.colorPalette.foreground;
                                PBIColorBad = this.host.colorPalette["bad"];
                                PBIColorGood = this.host.colorPalette["good"];
                                PBIColorMaximum = this.host.colorPalette["maximum"];
                                PBIColorMinimum = this.host.colorPalette["minimum"];
                            }
                        }
                        catch (e) { }
                        ;
                        try {
                            if (this.visualSettings.scadavis_settings.licensetext != this.svgraph.getLt() ||
                                this.visualSettings.scadavis_settings.validationkey != this.svgraph.getVk()) {
                                hasnewurl = true;
                            }
                            this.svgraph.setLtVk(this.visualSettings.scadavis_settings.licensetext, this.visualSettings.scadavis_settings.validationkey);
                        }
                        catch (e) { }
                        ;
                        if (hasnewurl) {
                            if (this.visualSettings.scadavis_settings.svgurl !== undefined) {
                                this.svgraph.resetData();
                                if (this.visualSettings.scadavis_settings.svgurl !== "") {
                                    document.getElementById("SVTEXT").style.display = "none";
                                    this.svgraph.loadURL(this.visualSettings.scadavis_settings.svgurl);
                                }
                                this.svgraph.enableMouse(false, false);
                                urlchanged = true;
                            }
                        }
                        var ifrm = this.svgraph.getIframe();
                        var hasnwewzoomlv = this.visualSettings.scadavis_settings.zoomlevel !== this.svgraph.zoomlevel;
                        if (urlchanged || hasnwewzoomlv) {
                            if (this.visualSettings.scadavis_settings.zoomlevel === 0)
                                this.visualSettings.scadavis_settings.zoomlevel = 1; // default value
                            ifrm.width = options.viewport.width - 5;
                            ifrm.height = options.viewport.height - 5;
                            if (this.tm)
                                clearTimeout(this.tm);
                            this.tm = setTimeout(function () {
                                _this.svgraph.zoomTo(_this.visualSettings.scadavis_settings.zoomlevel * (ifrm.width < ifrm.height ? ifrm.width / 1000 : ifrm.height / 1000));
                            }, 300);
                        }
                        else if (ifrm.width != options.viewport.width - 5 || ifrm.height != options.viewport.height - 5) {
                            ifrm.width = options.viewport.width - 5;
                            ifrm.height = options.viewport.height - 5;
                            if (this.tm)
                                clearTimeout(this.tm);
                            setTimeout(function () {
                                _this.svgraph.zoomTo(_this.visualSettings.scadavis_settings.zoomlevel * (ifrm.width < ifrm.height ? ifrm.width / 1000 : ifrm.height / 1000));
                            }, 600);
                        }
                        // reset previous data
                        this.svgraph.resetData();
                        var gr_level0 = {};
                        var i = 0, j = 0, k = 0;
                        for (k = 0; k < options.dataViews[0].categorical.values.length; k++)
                            for (i = 0; i < options.dataViews[0].categorical.values[k].values.length; i++) {
                                var catvalstr = "";
                                if (typeof options.dataViews[0].categorical.categories != "undefined")
                                    catvalstr = options.dataViews[0].categorical.categories[k].values[i].toString();
                                else
                                    catvalstr = options.dataViews[0].categorical.values[k].source.displayName.toString();
                                if (gr_level0.hasOwnProperty(catvalstr))
                                    gr_level0[catvalstr] +=
                                        options.dataViews[0].categorical.values[k].values[i];
                                else
                                    gr_level0[catvalstr] =
                                        options.dataViews[0].categorical.values[k].values[i];
                                if (typeof options.dataViews[0].categorical.categories != "undefined") {
                                    var cat = "";
                                    for (j = 0; j < options.dataViews[0].categorical.categories.length; j++) {
                                        if (j != 0)
                                            cat = cat + "|";
                                        cat = cat + options.dataViews[0].categorical.categories[j].values[i].toString();
                                    }
                                    this.svgraph.storeValue(cat, options.dataViews[0].categorical.values[k].values[i], false, false, cat);
                                }
                                else
                                    this.svgraph.storeValue(catvalstr, options.dataViews[0].categorical.values[k].values[i], false, false, catvalstr);
                            }
                        // sort by key
                        var ordered = {};
                        Object.keys(gr_level0).sort().forEach(function (key) {
                            ordered[key] = gr_level0[key];
                        });
                        i = 0;
                        var min = Number.POSITIVE_INFINITY;
                        var max = Number.NEGATIVE_INFINITY;
                        var tot = 0;
                        for (var prop in ordered) {
                            this.svgraph.storeValue("@" + (i + 1), gr_level0[prop], false, false, prop);
                            this.svgraph.storeValue(prop, gr_level0[prop], false, false, prop);
                            min = gr_level0[prop] < min ? gr_level0[prop] : min;
                            max = gr_level0[prop] > max ? gr_level0[prop] : max;
                            tot = tot + gr_level0[prop];
                            i++;
                        }
                        this.svgraph.storeValue("@min", min, false, false, "min");
                        this.svgraph.storeValue("@max", max, false, false, "max");
                        this.svgraph.storeValue("@total", tot, false, false, options.dataViews[0].categorical.values[0].source.displayName);
                        tot = 0;
                        if (typeof options.dataViews[0].categorical.categories != "undefined")
                            for (i = 0; i < options.dataViews[0].categorical.values[0].values.length; i++) {
                                this.svgraph.storeValue("@@" + (i + 1), options.dataViews[0].categorical.values[0].values[i], false, false, options.dataViews[0].categorical.categories[options.dataViews[0].categorical.categories.length - 1].values[i].toString());
                                tot = tot + parseFloat(options.dataViews[0].categorical.values[0].values[i].toString());
                            }
                        this.svgraph.storeValue("@@min", options.dataViews[0].categorical.values[0].minLocal, false, false, "min");
                        this.svgraph.storeValue("@@max", options.dataViews[0].categorical.values[0].maxLocal, false, false, "max");
                        this.svgraph.storeValue("@@total", tot, false, false, options.dataViews[0].categorical.values[0].source.displayName);
                        this.svgraph.storeValue("@zero", 0, false, false, "Zero");
                        //this.svgraph.storeValue("@true", true, false, false, "True");
                        //this.svgraph.storeValue("@false", false, false, false, "False");
                        this.svgraph.updateValues();
                    };
                    Visual.parseSettings = function (dataView) {
                        return sCADAvisA1696DB7096B4CBBA3B7595D70A805AF.VisualSettings.parse(dataView);
                    };
                    /**
                     * This function gets called for each of the objects defined in the capabilities files and allows you to select which of the
                     * objects and properties you want to expose to the users in the property pane.
                     */
                    Visual.prototype.enumerateObjectInstances = function (options) {
                        var settings = this.visualSettings || sCADAvisA1696DB7096B4CBBA3B7595D70A805AF.VisualSettings.getDefault();
                        return sCADAvisA1696DB7096B4CBBA3B7595D70A805AF.VisualSettings.enumerateObjectInstances(settings, options);
                    };
                    return Visual;
                }());
                sCADAvisA1696DB7096B4CBBA3B7595D70A805AF.Visual = Visual;
            })(sCADAvisA1696DB7096B4CBBA3B7595D70A805AF = visual.sCADAvisA1696DB7096B4CBBA3B7595D70A805AF || (visual.sCADAvisA1696DB7096B4CBBA3B7595D70A805AF = {}));
        })(visual = extensibility.visual || (extensibility.visual = {}));
    })(extensibility = powerbi.extensibility || (powerbi.extensibility = {}));
})(powerbi || (powerbi = {}));
var powerbi;
(function (powerbi) {
    var visuals;
    (function (visuals) {
        var plugins;
        (function (plugins) {
            plugins.sCADAvisA1696DB7096B4CBBA3B7595D70A805AF = {
                name: 'sCADAvisA1696DB7096B4CBBA3B7595D70A805AF',
                displayName: 'SCADAvis',
                class: 'Visual',
                version: '1.0.2',
                apiVersion: '2.1.0',
                create: function (options) { return new powerbi.extensibility.visual.sCADAvisA1696DB7096B4CBBA3B7595D70A805AF.Visual(options); },
                custom: true
            };
        })(plugins = visuals.plugins || (visuals.plugins = {}));
    })(visuals = powerbi.visuals || (powerbi.visuals = {}));
})(powerbi || (powerbi = {}));
//# sourceMappingURL=visual.js.map