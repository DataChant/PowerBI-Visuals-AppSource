var powerbi;!function(e){!function(e){!function(e){!function(e){var t=function(){function e(e){this.columns=-1,this.target=e.element,this.selectionManager=e.host.createSelectionManager(),this.host=e.host,this.colors=e.host.colorPalette}return e.prototype.update=function(e){if(!(e&&e.dataViews&&e.dataViews[0]&&e.dataViews[0].categorical&&e.dataViews[0].categorical.values&&e.dataViews[0].categorical.values[0]))return void(this.target.innerHTML="");this.dataView=e.dataViews[0];for(var t=this.getVisualProperties(),a=this.dataView.categorical.values[0].values.length,l=0,i=0,o=0;o<this.dataView.categorical.values[0].values.length;o++)l+=+this.dataView.categorical.values[0].values[o],i=Math.max(i,+this.dataView.categorical.values[0].values[o]);var s=100*i/l,r=Math.ceil(s/10),c="calc("+80/r+"vh - 10px)";this.columns=a,this.rebuildHtml(r),this.dataPoints=[];for(var n=0;n<this.dataView.categorical.categories[0].values.length;n++){var u=this.dataView.categorical.categories[0].values[n];null===u&&(u="(Blank)");var d=+this.dataView.categorical.values[0].values[n],b=Math.round(d/l*100),h=this.getCategoricalObjectValue(this.dataView.categorical.categories[0],n,"colorSelector","fill",{solid:{color:t.defaultcolor}}).solid.color,g={columnlabel:""+u,value:d,percent:b,bubbleSize:c,maxBubbles:r,datalabel:b+"%",colour:h,selectionId:this.host.createSelectionIdBuilder().withCategory(this.dataView.categorical.categories[0],n).createSelectionId()};this.dataPoints.push(g);var v=this.target.querySelector('.column[data-column="'+u+'"]');this.updateBubbles(v,g)}for(var m=this.target.querySelectorAll(".column"),p=0;p<m.length;p++){var n=m[p],f=this.host.createSelectionIdBuilder().withCategory(e.dataViews[0].categorical.categories[0],p).createSelectionId();!function(e,t,a,l){e.addEventListener("click",function(){a(e,t,l)})}(n,f,this.click,this)}for(var x=0;x<m.length;x++){for(var w=m[x].getAttribute("data-column"),y=!1,V=0;V<this.dataPoints.length;V++)w!==this.dataPoints[V].columnlabel||(y=!0);if(y===!1){var S=m[x].querySelectorAll(".bubble"),h=S[S.length-1].style.backgroundColor;this.updateBubbles(m[x],{bubbleSize:c,maxBubbles:r,columnlabel:w,value:0,percent:0,datalabel:"0%",colour:h})}}},e.prototype.click=function(e,t,a){if(e.classList.contains("selected")){for(var l=a.target.querySelectorAll(".column"),i=0;i<l.length;i++)l[i].classList.remove("non-selected"),l[i].classList.remove("selected");return void a.selectionManager.clear()}for(var l=a.target.querySelectorAll(".column"),i=0;i<l.length;i++)l[i]===e?(l[i].classList.add("selected"),l[i].classList.remove("non-selected")):(l[i].classList.add("non-selected"),l[i].classList.remove("selected"));a.selectionManager.select(t)},e.prototype.updateBubbles=function(e,t){var a=this.getVisualProperties(),l=e.querySelector(".columnlabel");l.textContent=""+t.columnlabel,l.setAttribute("style","color:"+a.xaxis.color.solid.color+";font-size:"+a.xaxis.textsize+"px");var i=e.querySelector(".datalabel");i.textContent=a.datalabels.show?t.percent+"%":"",i.setAttribute("style","color:"+a.datalabels.color.solid.color+";font-size:"+a.datalabels.textsize+"px");for(var o=e.querySelectorAll(".bubble"),s=0;s<10;s++){var r=o[9-s];if(10*s>=t.percent)r.setAttribute("style","height:0;border-width:0;width:0;");else if(10*s<t.percent-10)r.setAttribute("style","width: "+t.bubbleSize+";height: "+t.bubbleSize+";border-width: "+4/t.maxBubbles+"vh;background-color: "+t.colour+"; border-color: "+t.colour+";");else{var c=100-10*(t.percent-10*s);r.setAttribute("style","width: "+t.bubbleSize+";height: "+t.bubbleSize+";border-width: "+4/t.maxBubbles+"vh;background-color: "+t.colour+"; border-color: "+t.colour+";background: linear-gradient(transparent "+c+"%, "+t.colour+" "+c+"%);")}}},e.prototype.rebuildHtml=function(e){for(var t=this.getVisualProperties(),a='<div class="wrapper"><div class="chart" style="min-width:calc(('+100/e+"vh + "+t.xaxis.minimumcategorywidth+"px) * "+this.columns+')">',l=0;l<this.columns;l++){var i=this.dataView.categorical.categories[0].values[l];null===i&&(i="(Blank)"),a+='<div class="column" style="width: calc('+100/e+"vh + "+t.xaxis.minimumcategorywidth+'px);" data-column="'+i+'">',a+='<div class="datalabel" style="font-size: 18px"></div>';for(var o=0;o<10;o++)a+='<div class="bubble"></div>';a+='<div class="columnlabel" style="font-size: 18px"></div>',a+="</div>"}a+="</div></div>",this.target.innerHTML=a},e.prototype.destroy=function(){},e.prototype.getVisualProperties=function(){var e="#777777";return null!=this.colors&&(e=this.colors.getColor("0").value),{xaxis:{color:this.getValueOrDefault("xaxis","color",{solid:{color:"#777777"}}),textsize:this.getValueOrDefault("xaxis","textsize",12),minimumcategorywidth:this.getValueOrDefault("xaxis","minimumcategorywidth",20)},datalabels:{show:this.getValueOrDefault("datalabels","show",!0),color:this.getValueOrDefault("datalabels","color",{solid:{color:"#777777"}}),textsize:this.getValueOrDefault("datalabels","textsize",12)},defaultcolor:e}},e.prototype.enumerateObjectInstances=function(e){var t=[],a=this.getVisualProperties();switch(e.objectName){case"xaxis":t.push({objectName:"xaxis",displayName:"X-Axis",properties:{color:a.xaxis.color.solid.color,textsize:a.xaxis.textsize,minimumcategorywidth:a.xaxis.minimumcategorywidth},validValues:{textsize:{numberRange:{min:8,max:40}},minimumcategorywidth:{numberRange:{min:20,max:180}}},selector:null});break;case"colorSelector":for(var l=0;l<this.dataPoints.length;l++)t.push({objectName:e.objectName,displayName:this.dataPoints[l].columnlabel,properties:{fill:{solid:{color:this.dataPoints[l].colour}}},selector:this.dataPoints[l].selectionId.getSelector()});break;case"datalabels":t.push({objectName:"datalabels",displayName:"Data labels",properties:{color:a.datalabels.color.solid.color,textsize:a.datalabels.textsize,show:a.datalabels.show},validValues:{textsize:{numberRange:{min:8,max:40}}},selector:null})}return t},e.prototype.getValueOrDefault=function(e,t,a){if(this.dataView&&this.dataView.metadata&&this.dataView.metadata.objects){var l=this.dataView.metadata.objects[e];if(l){var i=l[t];if(void 0!==i)return i}}return a},e.prototype.getCategoricalObjectValue=function(e,t,a,l,i){var o=e.objects;if(o){var s=o[t];if(s){var r=s[a];if(r){var c=r[l];if(void 0!==c)return c}}}return i},e}();e.Visual=t}(e.enlightenBubbleStack13709305C6AD4E59B8F78FFEA36FB62E||(e.enlightenBubbleStack13709305C6AD4E59B8F78FFEA36FB62E={}))}(e.visual||(e.visual={}))}(e.extensibility||(e.extensibility={}))}(powerbi||(powerbi={}));var powerbi;!function(e){!function(t){!function(t){t.enlightenBubbleStack13709305C6AD4E59B8F78FFEA36FB62E={name:"enlightenBubbleStack13709305C6AD4E59B8F78FFEA36FB62E",displayName:"Enlighten Bubble Stack",class:"Visual",version:"1.0.0",apiVersion:"1.5.0",create:function(t){return new e.extensibility.visual.enlightenBubbleStack13709305C6AD4E59B8F78FFEA36FB62E.Visual(t)},custom:!0}}(t.plugins||(t.plugins={}))}(e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));