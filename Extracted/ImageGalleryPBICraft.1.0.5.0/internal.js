var ImageGalleryPBICraft;(()=>{var e={181:e=>{var t=/^\s+|\s+$/g,s=/^[-+]0x[0-9a-f]+$/i,i=/^0b[01]+$/i,n=/^0o[0-7]+$/i,a=parseInt,r="object"==typeof global&&global&&global.Object===Object&&global,o="object"==typeof self&&self&&self.Object===Object&&self,l=r||o||Function("return this")(),c=Object.prototype.toString,d=Math.max,g=Math.min,u=function(){return l.Date.now()};function h(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function m(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==c.call(e)}(e))return NaN;if(h(e)){var r="function"==typeof e.valueOf?e.valueOf():e;e=h(r)?r+"":r}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(t,"");var o=i.test(e);return o||n.test(e)?a(e.slice(2),o?2:8):s.test(e)?NaN:+e}e.exports=function(e,t,s){var i,n,a,r,o,l,c=0,p=!1,v=!1,y=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function f(t){var s=i,a=n;return i=n=void 0,c=t,r=e.apply(a,s)}function b(e){var s=e-l;return void 0===l||s>=t||s<0||v&&e-c>=a}function S(){var e=u();if(b(e))return I(e);o=setTimeout(S,function(e){var s=t-(e-l);return v?g(s,a-(e-c)):s}(e))}function I(e){return o=void 0,y&&i?f(e):(i=n=void 0,r)}function D(){var e=u(),s=b(e);if(i=arguments,n=this,l=e,s){if(void 0===o)return function(e){return c=e,o=setTimeout(S,t),p?f(e):r}(l);if(v)return o=setTimeout(S,t),f(l)}return void 0===o&&(o=setTimeout(S,t)),r}return t=m(t)||0,h(s)&&(p=!!s.leading,a=(v="maxWait"in s)?d(m(s.maxWait)||0,t):a,y="trailing"in s?!!s.trailing:y),D.cancel=function(){void 0!==o&&clearTimeout(o),c=0,i=l=n=o=void 0},D.flush=function(){return void 0===o?r:I(u())},D}},572:(e,t,s)=>{"use strict";s.r(t)},754:(e,t,s)=>{"use strict";s.r(t),s.d(t,{AlignmentGroup:()=>g,AutoDropdown:()=>f,AutoFlagsSelection:()=>L,CardGroupEntity:()=>a,ColorPicker:()=>h,CompositeCard:()=>o,CompositeSlice:()=>O,Container:()=>j,ContainerItem:()=>_,DatePicker:()=>v,DurationPicker:()=>b,ErrorRangeControl:()=>S,FieldPicker:()=>I,FontControl:()=>w,FontPicker:()=>C,GradientBar:()=>P,Group:()=>l,ImageUpload:()=>E,ItemDropdown:()=>y,ItemFlagsSelection:()=>D,ListEditor:()=>N,MarginPadding:()=>A,Model:()=>r,NumUpDown:()=>m,ReadOnlyText:()=>F,ShapeMapSelector:()=>T,SimpleCard:()=>c,SimpleSlice:()=>d,Slider:()=>p,TextArea:()=>M,TextInput:()=>x,ToggleSwitch:()=>u});var i=s(639);class n{}class a extends n{}class r{}class o extends n{}class l extends a{constructor(e){super(),Object.assign(this,e)}}class c extends a{}class d extends n{constructor(e){super(),Object.assign(this,e)}getFormattingSlice(e,t){const s=this.type,i=this.name,n={displayName:t&&this.displayNameKey?t.getDisplayName(this.displayNameKey):this.displayName,description:t&&this.descriptionKey?t.getDisplayName(this.descriptionKey):this.description,uid:e+"-"+i};return Object.assign(Object.assign({},n),{control:{type:s,properties:this.getFormattingComponent(e,t)}})}getFormattingComponent(e,t){return{descriptor:i.y(e,this),value:this.value}}getRevertToDefaultDescriptor(e){return[{objectName:e,propertyName:this.name}]}setPropertiesValues(e,t){var s;const n=null===(s=null==e?void 0:e[t])||void 0===s?void 0:s[this.name];this.value=i.D(this,n,this.value)}}class g extends d{constructor(e){super(e),this.type="AlignmentGroup"}getFormattingComponent(e){return Object.assign(Object.assign({},super.getFormattingComponent(e)),{mode:this.mode,supportsNoSelection:this.supportsNoSelection})}}class u extends d{constructor(e){super(e),this.type="ToggleSwitch"}}class h extends d{constructor(e){super(e),this.type="ColorPicker"}getFormattingComponent(e){return Object.assign(Object.assign({},super.getFormattingComponent(e)),{defaultColor:this.defaultColor,isNoFillItemSupported:this.isNoFillItemSupported})}}class m extends d{constructor(e){super(e),this.type="NumUpDown"}getFormattingComponent(e){return Object.assign(Object.assign({},super.getFormattingComponent(e)),{options:this.options})}}class p extends m{constructor(){super(...arguments),this.type="Slider"}}class v extends d{constructor(e){super(e),this.type="DatePicker"}getFormattingComponent(e,t){return Object.assign(Object.assign({},super.getFormattingComponent(e)),{placeholder:t&&this.placeholderKey?t.getDisplayName(this.placeholderKey):this.placeholder,validators:this.validators})}}class y extends d{constructor(e){super(e),this.type="Dropdown"}getFormattingComponent(e){return Object.assign(Object.assign({},super.getFormattingComponent(e)),{items:this.items})}}class f extends d{constructor(e){super(e),this.type="Dropdown"}getFormattingComponent(e){return Object.assign(Object.assign({},super.getFormattingComponent(e)),{mergeValues:this.mergeValues,filterValues:this.filterValues})}}class b extends d{constructor(e){super(e),this.type="DurationPicker"}getFormattingComponent(e){return Object.assign(Object.assign({},super.getFormattingComponent(e)),{validators:this.validators})}}class S extends d{constructor(e){super(e),this.type="ErrorRangeControl"}getFormattingComponent(e){return Object.assign(Object.assign({},super.getFormattingComponent(e)),{validators:this.validators})}}class I extends d{constructor(e){super(e),this.type="FieldPicker"}getFormattingComponent(e){return Object.assign(Object.assign({},super.getFormattingComponent(e)),{validators:this.validators,allowMultipleValues:this.allowMultipleValues})}}class D extends d{constructor(e){super(e),this.type="FlagsSelection"}getFormattingComponent(e){return Object.assign(Object.assign({},super.getFormattingComponent(e)),{items:this.items})}}class L extends d{constructor(){super(...arguments),this.type="FlagsSelection"}}class x extends d{constructor(e){super(e),this.type="TextInput"}getFormattingComponent(e){return Object.assign(Object.assign({},super.getFormattingComponent(e)),{placeholder:this.placeholder})}}class M extends x{constructor(){super(...arguments),this.type="TextArea"}}class C extends d{constructor(){super(...arguments),this.type="FontPicker"}}class P extends d{constructor(){super(...arguments),this.type="GradientBar"}}class E extends d{constructor(){super(...arguments),this.type="ImageUpload"}}class N extends d{constructor(){super(...arguments),this.type="ListEditor"}}class F extends d{constructor(){super(...arguments),this.type="ReadOnlyText"}}class T extends d{constructor(e){super(e),this.type="ShapeMapSelector"}getFormattingComponent(e){return Object.assign(Object.assign({},super.getFormattingComponent(e)),{isAzMapReferenceSelector:this.isAzMapReferenceSelector})}}class O extends n{constructor(e){super(),Object.assign(this,e)}getFormattingSlice(e,t){const s=this.type,i=this.name,n={displayName:t&&this.displayNameKey?t.getDisplayName(this.displayNameKey):this.displayName,description:t&&this.descriptionKey?t.getDisplayName(this.descriptionKey):this.description,uid:e+"-"+i};return Object.assign(Object.assign({},n),{control:{type:s,properties:this.getFormattingComponent(e)}})}}class w extends O{constructor(e){super(e),this.type="FontControl"}getFormattingComponent(e){var t,s,i;return{fontFamily:this.fontFamily.getFormattingComponent(e),fontSize:this.fontSize.getFormattingComponent(e),bold:null===(t=this.bold)||void 0===t?void 0:t.getFormattingComponent(e),italic:null===(s=this.italic)||void 0===s?void 0:s.getFormattingComponent(e),underline:null===(i=this.underline)||void 0===i?void 0:i.getFormattingComponent(e)}}getRevertToDefaultDescriptor(e){return this.fontFamily.getRevertToDefaultDescriptor(e).concat(this.fontSize.getRevertToDefaultDescriptor(e)).concat(this.bold?this.bold.getRevertToDefaultDescriptor(e):[]).concat(this.italic?this.italic.getRevertToDefaultDescriptor(e):[]).concat(this.underline?this.underline.getRevertToDefaultDescriptor(e):[])}setPropertiesValues(e,t){var s,i,n;this.fontFamily.setPropertiesValues(e,t),this.fontSize.setPropertiesValues(e,t),null===(s=this.bold)||void 0===s||s.setPropertiesValues(e,t),null===(i=this.italic)||void 0===i||i.setPropertiesValues(e,t),null===(n=this.underline)||void 0===n||n.setPropertiesValues(e,t)}}class A extends O{constructor(e){super(e),this.type="MarginPadding"}getFormattingComponent(e){return{left:this.left.getFormattingComponent(e),right:this.right.getFormattingComponent(e),top:this.top.getFormattingComponent(e),bottom:this.bottom.getFormattingComponent(e)}}getRevertToDefaultDescriptor(e){return this.left.getRevertToDefaultDescriptor(e).concat(this.right.getRevertToDefaultDescriptor(e)).concat(this.top.getRevertToDefaultDescriptor(e)).concat(this.bottom.getRevertToDefaultDescriptor(e))}setPropertiesValues(e,t){this.left.setPropertiesValues(e,t),this.right.setPropertiesValues(e,t),this.top.setPropertiesValues(e,t),this.bottom.setPropertiesValues(e,t)}}class j extends n{constructor(e){super(),Object.assign(this,e)}}class _ extends n{}},667:(e,t,s)=>{"use strict";s.d(t,{A:()=>n});var i=s(754);const n=class{constructor(e){this.localizationManager=e}populateFormattingSettingsModel(e,t){var s,n;const a=new e,r=null===(s=null==t?void 0:t.metadata)||void 0===s?void 0:s.objects;return r&&(null===(n=a.cards)||void 0===n||n.forEach((e=>{var t;e instanceof i.CompositeCard&&(null===(t=e.topLevelSlice)||void 0===t||t.setPropertiesValues(r,e.name)),(e instanceof i.SimpleCard?[e]:e.groups).forEach((t=>{var s,i,n,a;null===(s=t.topLevelSlice)||void 0===s||s.setPropertiesValues(r,e.name),null===(i=null==t?void 0:t.slices)||void 0===i||i.forEach((t=>{null==t||t.setPropertiesValues(r,e.name)})),null===(a=null===(n=null==t?void 0:t.container)||void 0===n?void 0:n.containerItems)||void 0===a||a.forEach((t=>{var s;null===(s=null==t?void 0:t.slices)||void 0===s||s.forEach((t=>{null==t||t.setPropertiesValues(r,e.name)}))}))}))}))),a}buildFormattingModel(e){const t={cards:[]};return e.cards.filter((({visible:e=!0})=>e)).forEach((e=>{var s;const n={displayName:this.localizationManager&&e.displayNameKey?this.localizationManager.getDisplayName(e.displayNameKey):e.displayName,description:this.localizationManager&&e.descriptionKey?this.localizationManager.getDisplayName(e.descriptionKey):e.description,groups:[],uid:e.name+"-card",analyticsPane:e.analyticsPane},a=e.name;if(e.topLevelSlice){const t=e.topLevelSlice.getFormattingSlice(a,this.localizationManager);t.suppressDisplayName=!0,n.topLevelToggle=t}null===(s=e.onPreProcess)||void 0===s||s.call(e);const r=e instanceof i.SimpleCard;(r?[e].filter((({visible:e=!0})=>e)):e.groups.filter((({visible:e=!0})=>e))).forEach((e=>{const t=e.name+"-group",s={displayName:r?void 0:this.localizationManager&&e.displayNameKey?this.localizationManager.getDisplayName(e.displayNameKey):e.displayName,description:r?void 0:this.localizationManager&&e.descriptionKey?this.localizationManager.getDisplayName(e.descriptionKey):e.description,slices:[],uid:t,collapsible:e.collapsible,delaySaveSlices:e.delaySaveSlices,disabled:e.disabled,disabledReason:e.disabledReason};n.groups.push(s);const i={};if(e.container){const n=e.container,r=t+"-container",o={displayName:this.localizationManager&&n.displayNameKey?this.localizationManager.getDisplayName(n.displayNameKey):n.displayName,description:this.localizationManager&&n.descriptionKey?this.localizationManager.getDisplayName(n.descriptionKey):n.description,containerItems:[],uid:r};n.containerItems.forEach((e=>{const t=e.displayNameKey?e.displayNameKey:e.displayName,s=r+t,n={displayName:this.localizationManager&&e.displayNameKey?this.localizationManager.getDisplayName(e.displayNameKey):e.displayName,slices:[],uid:s};this.buildFormattingSlices({slices:e.slices,objectName:a,sliceNames:i,formattingSlices:n.slices}),o.containerItems.push(n)})),s.container=o}if(e.slices){if(e.topLevelSlice){const t=e.topLevelSlice.getFormattingSlice(a,this.localizationManager);t.suppressDisplayName=!0,(null==s.displayName?n:s).topLevelToggle=t}this.buildFormattingSlices({slices:e.slices,objectName:a,sliceNames:i,formattingSlices:s.slices})}})),n.revertToDefaultDescriptors=this.getRevertToDefaultDescriptor(e),t.cards.push(n)})),t}buildFormattingSlices({slices:e,objectName:t,sliceNames:s,formattingSlices:i}){null==e||e.filter((({visible:e=!0})=>e)).forEach((e=>{const n=null==e?void 0:e.getFormattingSlice(t,this.localizationManager);n&&(void 0===s[e.name]?s[e.name]=0:(s[e.name]++,n.uid=`${n.uid}-${s[e.name]}`),i.push(n))}))}getRevertToDefaultDescriptor(e){var t;const s={},n=[];let a,r=[];return e instanceof i.CompositeCard&&e.topLevelSlice&&n.push(...null===(t=e.topLevelSlice)||void 0===t?void 0:t.getRevertToDefaultDescriptor(e.name)),(e instanceof i.SimpleCard?[e].filter((({visible:e=!0})=>e)):e.groups.filter((({visible:e=!0})=>e))).forEach((t=>{var i,o;a=this.getSlicesRevertToDefaultDescriptor(e.name,t.slices,s,t.topLevelSlice),null===(o=null===(i=t.container)||void 0===i?void 0:i.containerItems)||void 0===o||o.forEach((t=>{r=r.concat(this.getSlicesRevertToDefaultDescriptor(e.name,t.slices,s))})),n.push(...a.concat(r))})),n}getSlicesRevertToDefaultDescriptor(e,t,s,i){let n=[];return i&&(s[i.name]=!0,n=n.concat(i.getRevertToDefaultDescriptor(e))),null==t||t.forEach((t=>{t&&!s[t.name]&&(s[t.name]=!0,n=n.concat(t.getRevertToDefaultDescriptor(e)))})),n}}},674:(e,t,s)=>{"use strict";s.r(t),s.d(t,{FormattingSettingsService:()=>n.A,formattingSettings:()=>i});var i=s(754),n=s(667)},639:(e,t,s)=>{"use strict";function i(e,t){return{objectName:e,propertyName:t.name,selector:t.selector,altConstantValueSelector:t.altConstantSelector,instanceKind:t.instanceKind}}function n(e,t,s){return null==t||"object"==typeof t&&!t.solid?s:t.solid?{value:null==t?void 0:t.solid.color}:(null==e?void 0:e.items)?e.items.find((e=>e.value==t)):t}s.d(t,{D:()=>n,y:()=>i})},406:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default='\n<div class="gallery" id="gallery">\n  <div id="upload-btn-wrapper">\n    <button id="upload-btn">Upload images</button>\n    <input type="file" id="image-upload" accept="image/*" multiple  />\n  </div>\n\n  <span class="last-element"></span>\n</div>\n\n<div id="lightbox" class="lightbox">\n  <span class="close">&times;</span>\n  <a class="prev">&#10094;</a>\n  <img class="lightbox-image" src="">\n  <a class="next" >&#10095;</a>\n</div>\n    '},652:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileManager=void 0,t.FileManager=class{host;imageGallery;lightbox;images=[];lastData="";lastModified=0;currentImageIndex=-1;constructor(e,t,s){this.host=e,this.imageGallery=t,this.lightbox=s;const i=document.getElementById("image-upload");i.addEventListener("change",this.handleImageUpload.bind(this)),document.getElementById("upload-btn").addEventListener("click",(function(){i.click()})),this.lightbox.onChangeImage=this.onChangeImage.bind(this),this.lightbox.onCloseImage=this.onCloseImage.bind(this),this.imageGallery.onOpenImage=this.onOpenImage.bind(this),this.imageGallery.onRemoveImage=this.onRemoveImage.bind(this)}onChangeImage(e){this.currentImageIndex+=e,this.currentImageIndex>=this.images.length?this.currentImageIndex=0:this.currentImageIndex<0&&(this.currentImageIndex=this.images.length-1),this.lightbox.toggleLightbox(!0,this.images[this.currentImageIndex]),this.saveImages()}onCloseImage(){this.currentImageIndex=-1,this.lightbox.toggleLightbox(!1),this.saveImages()}onOpenImage(e){this.currentImageIndex=this.images.indexOf(e),this.lightbox.toggleLightbox(!0,e),this.saveImages()}onRemoveImage(e){this.images=this.images.filter((t=>t!==e)),this.saveImages()}handleImageUpload(e){const t=e.target.files;for(let e=0;e<t.length;e++){const s=t[e],i=new FileReader;i.onload=e=>{const t=e.target?.result||null;"string"==typeof t&&(this.imageGallery.add(t),this.images.push(t),this.saveImages())},i.readAsDataURL(s)}}loadImages(e){if(this.toggleEditMode(1===e.viewMode),0!=(e.images!==this.lastData&&e.modified>=this.lastModified))try{this.images=JSON.parse(e.images),this.currentImageIndex=e.imageIndex,this.imageGallery.clear();for(const e of this.images)this.imageGallery.add(e);-1!==this.currentImageIndex&&this.lightbox.toggleLightbox(!0,this.images[this.currentImageIndex]),1===e.viewMode&&this.onSaveImages(e.images,e.imageIndex)}catch(e){console.error("Error loading images",e)}}toggleEditMode(e){const t=document.getElementById("upload-btn-wrapper");t&&(t.style.display=e?"flex":"none"),this.imageGallery.toggleEditMode(e)}saveImages(){const e=JSON.stringify(this.images);this.onSaveImages(e,this.currentImageIndex)}onSaveImages(e,t){const s=Date.now();this.lastData!=e?(this.host.persistProperties({merge:[{objectName:"storage",properties:{images:e,imageIndex:t,modified:s},selector:null}]}),this.lastData=e,this.lastModified=s):this.host.persistProperties({merge:[{objectName:"storage",properties:{imageIndex:t,modified:s},selector:null}]})}}},791:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ImageGallery=void 0,t.ImageGallery=class{galleryContainer;onOpenImage=()=>{};onRemoveImage=()=>{};constructor(){this.galleryContainer=document.querySelector(".gallery")}removeImage(e){void 0!==this.onRemoveImage&&(this.onRemoveImage(e.src),e?.closest(".image-container")?.remove())}openImage(e){void 0!==this.onOpenImage&&this.onOpenImage(e.src)}clear(){this.galleryContainer.querySelectorAll(".image-container").forEach((e=>{e.remove()}))}add(e){const t=document.createElement("img");t.addEventListener("click",this.openImage.bind(this,t)),t.src=e;const s=document.createElement("span");s.classList.add("remove-btn"),s.innerHTML="&times;",s.addEventListener("click",this.removeImage.bind(this,t));const i=document.createElement("div");i.classList.add("image-container");const n=document.createElement("div");n.classList.add("float-container"),n.appendChild(t),n.appendChild(s),i.appendChild(n),this.galleryContainer.insertBefore(i,document.querySelector(".last-element"))}toggleEditMode(e){document.querySelectorAll(".remove-btn").forEach((t=>{t.style.display=e?"block":"none"}))}}},175:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LicenseEmbeddedPremium=void 0;const i=s(76);class n extends i.LicenseEmbedded{constructor(e,t){super(e,t)}static validate(e){if(!e||!e.length)return 4;const t=this.hasActiveServicePlan(e),s=this.hasActiveMinimalServicePlan(e);return t&&!s?e.some((e=>1==e.state))?1:e.some((e=>2==e.state))?2:4:4}static hasActiveServicePlan(e){return e&&e.length&&e.some((e=>1==e.state||2==e.state))}static hasActiveMinimalServicePlan(e){return e&&e.length&&e.some((e=>(e.spIdentifier.includes("freemium1")||e.spIdentifier.includes("plan1"))&&(1==e.state||2==e.state)))}}t.LicenseEmbeddedPremium=n},357:function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.BaseLicensedVisual=void 0;const n=s(674),a=s(980),r=i(s(181)),o=s(295);t.BaseLicensedVisual=class{host;target;formattingSettings;formattingSettingsService;selectionManager;cachedLicense=-1;licenseManager;renderLicense;setItemDebouncedInternal=()=>this.renderLicense&&this.renderLicense();runRenderLicenseDebounced=(0,r.default)(this.setItemDebouncedInternal,200);constructor(e,t){this.host=e.host,this.target=e.element,this.selectionManager=this.host.createSelectionManager(),this.formattingSettingsService=new n.FormattingSettingsService,this.licenseManager=new o.LicenseManager(this.host,t)}update(e){(e?.dataViews?.length||e.dataViews[0].metadata)&&(this.formattingSettings=this.formattingSettingsService.populateFormattingSettingsModel(a.VisualFormattingSettingsModel,e.dataViews[0]))}getFormattingModel(){return this.formattingSettings?this.formattingSettingsService.buildFormattingModel(this.formattingSettings):null}async toggleLicenseMode(e){const t=await this.licenseManager.checkLicense(e);if(1==e.viewMode&&this.licenseManager.saveLicense(e.savedPlans),t!==this.cachedLicense)switch(this.cachedLicense=t,t){case 1:this.host.licenseManager.clearLicenseNotification();break;case 2:this.host.licenseManager.notifyLicenseRequired(0);break;default:this.host.licenseManager.notifyLicenseRequired(2)}}}},599:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LicenseAPI=void 0;const i=s(804);class n extends i.LicenseCached{getAvailableServicePlans;servicePlans=[];constructor(e){super(),this.getAvailableServicePlans=()=>(0,i.wrapIPromise2)(e.getAvailableServicePlans())}async checkLicenseInternal(){try{const e=await this.getAvailableServicePlans();return this.servicePlans=e?.plans||[],e?.plans?.some((e=>1==e.state))?1:e?.plans?.some((e=>2==e.state))?2:4}catch(e){console.error(e)}return 4}}t.LicenseAPI=n},804:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LicenseCached=t.wrapIPromise2=void 0,t.wrapIPromise2=function(e){return new Promise(((t,s)=>{e.then((e=>{t(e)})).catch((e=>{s(e)}))}))},t.LicenseCached=class{hasChecked=!1;cachedResult=4;async checkLicense(){if(this.hasChecked)return this.cachedResult;{const e=await this.checkLicenseInternal();return this.cachedResult=e,this.hasChecked=!0,e}}}},345:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateShortLicenseKey=void 0,t.generateShortLicenseKey=function(e){let t=[...e].reduce(((e,t)=>Math.imul(31,e)+t.charCodeAt(0)|0),0);t=Math.abs(t);let s=t.toString(16);for(;s.length<10;)s+=s;return s.substring(0,10).toUpperCase()}},76:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LicenseEmbedded=void 0;const s=128;class i{savedLicensePlans;isEmbedded;constructor(e,t){this.savedLicensePlans=t,this.isEmbedded=[2,8,s].includes(e)}async checkLicense(){if(!this.isEmbedded)return 4;try{const e=JSON.parse(this.savedLicensePlans);return i.validate(e)}catch(e){return 4}}static validate(e){return e&&e.length?e.some((e=>1==e.state))?1:e.some((e=>2==e.state))?2:4:4}}t.LicenseEmbedded=i},295:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LicenseManager=void 0;const i=s(676),n=s(599),a=s(610),r=s(83),o=s(76),l=s(175);t.LicenseManager=class{host;licenseOptions;strategies=[];licenseAPI;constructor(e,t){this.host=e,this.licenseOptions=t,this.licenseAPI=new n.LicenseAPI(this.host.licenseManager),this.strategies.push(this.licenseAPI),this.strategies.push(new i.LicenseTrial(this.host.storageV2Service))}async checkLicense(e){const t=[new a.LicenseTestData(this.licenseOptions.TEST_DATA,e.testDataInput),new r.LicensePersistent(this.licenseOptions.licenseGUID,e.persistentKey)];this.licenseOptions.IsPremiumRequiredForEmbedded?t.push(new l.LicenseEmbeddedPremium(this.host.hostEnv,e.savedPlans)):t.push(new o.LicenseEmbedded(this.host.hostEnv,e.savedPlans));const s=[...this.strategies,...t],i=await Promise.all(s.map((e=>e.checkLicense())));return i.includes(1)?1:i.includes(2)?2:4}saveLicense(e){try{const t=JSON.stringify(this?.licenseAPI?.servicePlans);if(!this.licenseAPI||t.length<10)return void console.log("saveLicense. LicenseAPI is not found. Skipping...");if(e==t)return void console.log("saveLicense. plan is already saved. Skipping...");console.log("saveLicense. Saving license plan: ",t),this.host.persistProperties({merge:[{objectName:"license",properties:{plans:t},selector:null}]})}catch(e){console.error(e)}}}},83:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LicensePersistent=void 0;const i=s(345);t.LicensePersistent=class{licenseGUID;persistentKey;constructor(e,t){this.licenseGUID=e,this.persistentKey=t}async checkLicense(){const e=new Date,t=e.getFullYear(),s=e.getMonth()+1,n=s<10?`0${s}`:`${s}`,a=`${this.licenseGUID}-${t}-${n}`;return this.persistentKey==(0,i.generateShortLicenseKey)(a)?2:4}}},395:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LicenseSettings=void 0;const i=s(674);var n=i.formattingSettings.SimpleCard;t.LicenseSettings=class extends n{plans=new i.formattingSettings.TextInput({name:"plans",displayName:"Plans",value:"",placeholder:"",visible:!1});licenseKey=new i.formattingSettings.TextInput({name:"licenseKey",displayName:"License Key",value:"",placeholder:"",visible:!0});name="license";displayName="License";slices=[this.plans,this.licenseKey]}},610:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LicenseTestData=void 0;const i=s(345);t.LicenseTestData=class{TEST_DATA;input;constructor(e,t){this.TEST_DATA=e,this.input=t}async checkLicense(){if(!this.TEST_DATA||0===this.TEST_DATA.length)return 4;if(!this.input||0===this.input.length)return 2;try{if(this.validateTestData(this.input))return 2}catch(e){console.error(e)}return 4}validateTestData(e){if(!e)return!1;if(Array.isArray(e))return e.every((e=>{const t=(0,i.generateShortLicenseKey)(e);return this.TEST_DATA.includes(t)}));{const t=(0,i.generateShortLicenseKey)(e);return this.TEST_DATA.includes(t)}}}},676:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LicenseTrial=void 0;const i=s(804);class n extends i.LicenseCached{static LICENSE_STORAGE_NAME="license_date_start";static MAX_DATE_DIFF=7;statusAsync;setAsync;getAsync;constructor(e){super(),this.statusAsync=()=>(0,i.wrapIPromise2)(e.status()),this.setAsync=(t,s)=>(0,i.wrapIPromise2)(e.set(t,s)),this.getAsync=t=>(0,i.wrapIPromise2)(e.get(t))}async checkLicenseInternal(){try{if(await this.hasValidTrialLicense())return 2}catch(e){console.error(e)}return 4}async getLicenseStartDate(){const e=await this.getAsync(n.LICENSE_STORAGE_NAME);return!!e&&this.validateLicenseDate(Number(e))}async hasValidTrialLicense(){const e=await this.getStatus();if(1==e)return!1;if(0!=e)return!1;try{if(await this.getLicenseStartDate())return!0}catch(e){}return!!await this.saveLicenseStartDate()&&this.getLicenseStartDate()}validateLicenseDate(e){if(isNaN(e))return!1;const t=Number(new Date);return!(Math.abs(t-e)/864e5>n.MAX_DATE_DIFF)}async getStatus(){try{return this.statusAsync()}catch(e){return 2}}async saveLicenseStartDate(){try{const e=Number(new Date);return!!(await this.setAsync(n.LICENSE_STORAGE_NAME,e)).success}catch(e){return!1}}}t.LicenseTrial=n},172:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Lightbox=void 0,t.Lightbox=class{lightbox;onChangeImage;onCloseImage;constructor(){this.lightbox=document.getElementById("lightbox"),this.onChangeImage=()=>{},this.onCloseImage=()=>{},this.lightbox.querySelector(".prev")?.addEventListener("click",(()=>this.changeImage(-1))),this.lightbox.querySelector(".next")?.addEventListener("click",(()=>this.changeImage(1))),this.lightbox.querySelector(".close")?.addEventListener("click",(()=>this.closeImage())),document.addEventListener("keydown",(e=>{if("none"!==this.lightbox.style.display)switch(e.key){case"ArrowLeft":this.changeImage(-1);break;case"ArrowRight":this.changeImage(1);break;case"Escape":this.closeImage()}}))}closeImage(){void 0!==this.onCloseImage&&this.onCloseImage()}toggleLightbox(e,t=""){document.querySelector(".lightbox-image").src=t,this.lightbox.style.display=e?"flex":"none"}changeImage(e){void 0!==this.onChangeImage&&this.onChangeImage(e)}}},980:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VisualFormattingSettingsModel=void 0;const i=s(674),n=s(395);var a=i.formattingSettings.SimpleCard,r=i.formattingSettings.Model;class o extends a{images=new i.formattingSettings.TextInput({name:"images",displayName:"images",value:"",placeholder:"",visible:!1});imageIndex=new i.formattingSettings.NumUpDown({name:"imageIndex",displayName:"imageIndex",value:-1,visible:!1});modified=new i.formattingSettings.NumUpDown({name:"modified",displayName:"modified",value:0,visible:!1});name="storage";displayName="storage";visible=!1;slices=[this.images,this.imageIndex,this.modified]}t.VisualFormattingSettingsModel=class extends r{licenseSettings=new n.LicenseSettings;storageSettings=new o;cards=[this.storageSettings,this.licenseSettings]}},789:function(e,t,s){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Visual=void 0,s(572);const n=i(s(406)),a=s(357),r=s(172),o=s(791),l=s(652);class c extends a.BaseLicensedVisual{static LICENSE_GUID="c6f93777-3574-4e68-9b60-bafd6d024d04";static TEST_DATA=["73CE7B6773","18DA8D1018","1095B57710","4E8BE86A4E","36A1603B36","34753F4634","228393FD22","2B34AE942B","8E5477B8E5","75B8326A75","6D4A02FA6D","5678822556","413C869E41"];static IsPremiumRequiredForEmbedded=!1;lightbox;imageGallery;fileManager;constructor(e){super(e,{licenseGUID:c.LICENSE_GUID,TEST_DATA:c.TEST_DATA,IsPremiumRequiredForEmbedded:c.IsPremiumRequiredForEmbedded}),e.element.innerHTML=n.default,this.handleContextMenu(),this.imageGallery=new o.ImageGallery,this.lightbox=new r.Lightbox,this.fileManager=new l.FileManager(this.host,this.imageGallery,this.lightbox)}handleContextMenu(){this?.target?.addEventListener("contextmenu",(e=>{this.selectionManager.showContextMenu({},{x:e.clientX,y:e.clientY}),e.preventDefault()}))}update(e){super.update(e),this.host.eventService.renderingStarted(e);const t=this.formattingSettings?.licenseSettings?.plans?.value||"",s=this.formattingSettings?.licenseSettings?.licenseKey?.value||"";this.renderLicense=()=>{const i=this.formattingSettings?.storageSettings.images.value||"",n=this.formattingSettings?.storageSettings.imageIndex.value,a=this.formattingSettings?.storageSettings.modified.value||0;this.fileManager.loadImages({images:i,imageIndex:n,modified:a,viewMode:e.viewMode});let r=[];try{r=JSON.parse(i)}catch(e){console.log("Error parsing images",e)}const o={savedPlans:t,persistentKey:s,testDataInput:r,viewMode:e.viewMode};this.toggleLicenseMode(o)},this.runRenderLicenseDebounced(),this.host.eventService.renderingFinished(e)}}t.Visual=c}},t={};function s(i){var n=t[i];if(void 0!==n)return n.exports;var a=t[i]={exports:{}};return e[i].call(a.exports,a,a.exports,s),a.exports}s.d=(e,t)=>{for(var i in t)s.o(t,i)&&!s.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};(()=>{"use strict";var e=i;Object.defineProperty(e,"__esModule",{value:!0});const t=s(789);var n=window.powerbi,a={name:"ImageGalleryPBICraft",displayName:"Image Gallery",class:"Visual",apiVersion:"5.8.0",create:e=>{if(t.Visual)return new t.Visual(e);throw"Visual instance not found"},createModalDialog:(e,t,s)=>{const i=globalThis.dialogRegistry;e in i&&new i[e](t,s)},custom:!0};void 0!==n&&(n.visuals=n.visuals||{},n.visuals.plugins=n.visuals.plugins||{},n.visuals.plugins.ImageGalleryPBICraft=a),e.default=a})(),ImageGalleryPBICraft=i})();