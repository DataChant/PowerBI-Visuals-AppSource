var artemis3DDAAF4C926E4256ABEE19B4AB7444B0;(()=>{"use strict";var e={754:(e,t,a)=>{a.d(t,{Kx:()=>s,St:()=>n,Tn:()=>r,iB:()=>p,jF:()=>d,ks:()=>m,sk:()=>u});var i=a(639);class o{}class l extends o{}class s{}class n extends o{}class r extends l{}class c extends o{constructor(e){super(),Object.assign(this,e)}getFormattingSlice(e,t){const a=this.type,i=this.name,o={displayName:t&&this.displayNameKey?t.getDisplayName(this.displayNameKey):this.displayName,description:t&&this.descriptionKey?t.getDisplayName(this.descriptionKey):this.description,uid:e+"-"+i};return Object.assign(Object.assign({},o),{control:{type:a,properties:this.getFormattingComponent(e,t)}})}getFormattingComponent(e,t){return{descriptor:i.y(e,this),value:this.value}}getRevertToDefaultDescriptor(e){return[{objectName:e,propertyName:this.name}]}setPropertiesValues(e,t){var a;let o=null===(a=null==e?void 0:e[t])||void 0===a?void 0:a[this.name];this.value=i.D(this,o,this.value)}}class d extends c{constructor(e){super(e),this.type="ToggleSwitch"}}class u extends c{constructor(e){super(e),this.type="ColorPicker"}getFormattingComponent(e){return Object.assign(Object.assign({},super.getFormattingComponent(e)),{defaultColor:this.defaultColor,isNoFillItemSupported:this.isNoFillItemSupported})}}class p extends c{constructor(e){super(e),this.type="NumUpDown"}getFormattingComponent(e){return Object.assign(Object.assign({},super.getFormattingComponent(e)),{options:this.options})}}class m extends c{constructor(e){super(e),this.type="TextInput"}getFormattingComponent(e){return Object.assign(Object.assign({},super.getFormattingComponent(e)),{placeholder:this.placeholder})}}},667:(e,t,a)=>{a.d(t,{A:()=>o});var i=a(754);const o=class{constructor(e){this.localizationManager=e}populateFormattingSettingsModel(e,t){var a,o;let l=new e,s=null===(a=null==t?void 0:t.metadata)||void 0===a?void 0:a.objects;return s&&(null===(o=l.cards)||void 0===o||o.forEach((e=>{var t;e instanceof i.St&&(null===(t=e.topLevelSlice)||void 0===t||t.setPropertiesValues(s,e.name)),(e instanceof i.Tn?[e]:e.groups).forEach((t=>{var a,i,o,l;null===(a=t.topLevelSlice)||void 0===a||a.setPropertiesValues(s,e.name),null===(i=null==t?void 0:t.slices)||void 0===i||i.forEach((t=>{null==t||t.setPropertiesValues(s,e.name)})),null===(l=null===(o=null==t?void 0:t.container)||void 0===o?void 0:o.containerItems)||void 0===l||l.forEach((t=>{var a;null===(a=null==t?void 0:t.slices)||void 0===a||a.forEach((t=>{null==t||t.setPropertiesValues(s,e.name)}))}))}))}))),l}buildFormattingModel(e){let t={cards:[]};return e.cards.filter((({visible:e=!0})=>e)).forEach((e=>{var a;let o={displayName:this.localizationManager&&e.displayNameKey?this.localizationManager.getDisplayName(e.displayNameKey):e.displayName,description:this.localizationManager&&e.descriptionKey?this.localizationManager.getDisplayName(e.descriptionKey):e.description,groups:[],uid:e.name+"-card",analyticsPane:e.analyticsPane};const l=e.name;if(e.topLevelSlice){let t=e.topLevelSlice.getFormattingSlice(l,this.localizationManager);t.suppressDisplayName=!0,o.topLevelToggle=t}null===(a=e.onPreProcess)||void 0===a||a.call(e);const s=e instanceof i.Tn;(s?[e].filter((({visible:e=!0})=>e)):e.groups.filter((({visible:e=!0})=>e))).forEach((e=>{const t=e.name+"-group",a={displayName:s?void 0:this.localizationManager&&e.displayNameKey?this.localizationManager.getDisplayName(e.displayNameKey):e.displayName,description:s?void 0:this.localizationManager&&e.descriptionKey?this.localizationManager.getDisplayName(e.descriptionKey):e.description,slices:[],uid:t,collapsible:e.collapsible,delaySaveSlices:e.delaySaveSlices,disabled:e.disabled,disabledReason:e.disabledReason};o.groups.push(a);const i={};if(e.container){const o=e.container,s=t+"-container",n={displayName:this.localizationManager&&o.displayNameKey?this.localizationManager.getDisplayName(o.displayNameKey):o.displayName,description:this.localizationManager&&o.descriptionKey?this.localizationManager.getDisplayName(o.descriptionKey):o.description,containerItems:[],uid:s};o.containerItems.forEach((e=>{const t=e.displayNameKey?e.displayNameKey:e.displayName,a=s+t;let o={displayName:this.localizationManager&&e.displayNameKey?this.localizationManager.getDisplayName(e.displayNameKey):e.displayName,slices:[],uid:a};this.buildFormattingSlices({slices:e.slices,objectName:l,sliceNames:i,formattingSlices:o.slices}),n.containerItems.push(o)})),a.container=n}if(e.slices){if(e.topLevelSlice){let t=e.topLevelSlice.getFormattingSlice(l,this.localizationManager);t.suppressDisplayName=!0,(null==a.displayName?o:a).topLevelToggle=t}this.buildFormattingSlices({slices:e.slices,objectName:l,sliceNames:i,formattingSlices:a.slices})}})),o.revertToDefaultDescriptors=this.getRevertToDefaultDescriptor(e),t.cards.push(o)})),t}buildFormattingSlices({slices:e,objectName:t,sliceNames:a,formattingSlices:i}){null==e||e.filter((({visible:e=!0})=>e)).forEach((e=>{let o=null==e?void 0:e.getFormattingSlice(t,this.localizationManager);o&&(void 0===a[e.name]?a[e.name]=0:(a[e.name]++,o.uid=`${o.uid}-${a[e.name]}`),i.push(o))}))}getRevertToDefaultDescriptor(e){var t;const a={};let o,l=[],s=[];return e instanceof i.St&&e.topLevelSlice&&l.push(...null===(t=e.topLevelSlice)||void 0===t?void 0:t.getRevertToDefaultDescriptor(e.name)),(e instanceof i.Tn?[e].filter((({visible:e=!0})=>e)):e.groups.filter((({visible:e=!0})=>e))).forEach((t=>{var i,n;o=this.getSlicesRevertToDefaultDescriptor(e.name,t.slices,a,t.topLevelSlice),null===(n=null===(i=t.container)||void 0===i?void 0:i.containerItems)||void 0===n||n.forEach((t=>{s=s.concat(this.getSlicesRevertToDefaultDescriptor(e.name,t.slices,a))})),l.push(...o.concat(s))})),l}getSlicesRevertToDefaultDescriptor(e,t,a,i){let o=[];return i&&(a[i.name]=!0,o=o.concat(i.getRevertToDefaultDescriptor(e))),null==t||t.forEach((t=>{t&&!a[t.name]&&(a[t.name]=!0,o=o.concat(t.getRevertToDefaultDescriptor(e)))})),o}}},674:(e,t,a)=>{a.d(t,{O:()=>o.A,z:()=>i});var i=a(754),o=a(667)},639:(e,t,a)=>{function i(e,t){return{objectName:e,propertyName:t.name,selector:t.selector,altConstantValueSelector:t.altConstantSelector,instanceKind:t.instanceKind}}function o(e,t,a){return null==t||"object"==typeof t&&!t.solid?a:t.solid?{value:null==t?void 0:t.solid.color}:(null==e?void 0:e.items)?e.items.find((e=>e.value==t)):t}a.d(t,{D:()=>o,y:()=>i})},82:(e,t,a)=>{a.d(t,{S:()=>c});var i=a(674);class o{enabled;value;color;size;constructor(e,t="Enabled"){this.enabled=new i.z.jF({name:e+"Enabled",displayName:t,value:!1}),this.value=new i.z.iB({name:e+"Value",displayName:"Condition Value",value:0}),this.color=new i.z.sk({name:e+"Color",displayName:"Circle Color",value:{value:"#000000"}}),this.size=new i.z.iB({name:e+"Size",displayName:"Circle Size",value:20,options:{minValue:{type:0,value:5},maxValue:{type:1,value:50}}})}}class l extends i.z.St{applyTo=new i.z.ks({name:"firstColumnColorApplyTo",displayName:"Apply specific background to",placeholder:"Enter 'all' or specific value",value:"all"});specificBackgroundColor=new i.z.sk({name:"firstColumnSpecificBackgroundColor",displayName:"Specific Background Color",value:{value:"#FFFFFF"}});defaultBackgroundColor=new i.z.sk({name:"firstColumnDefaultBackgroundColor",displayName:"Default Background Color",value:{value:"#F0F0F0"}});name="firstColumnColor";displayName="First Column Color";slices=[this.applyTo,this.specificBackgroundColor,this.defaultBackgroundColor];groups=[{name:"firstColumnColorGroup",displayName:"First Column Color",slices:[this.applyTo,this.specificBackgroundColor,this.defaultBackgroundColor]}]}class s{enabled;color;constructor(e){this.enabled=new i.z.jF({name:`categoryColor${e}Enabled`,displayName:`Enable Color for Category ${e+1}`,value:!1}),this.color=new i.z.sk({name:`categoryColor${e}`,displayName:`Color for Category ${e+1}`,value:{value:"#FFFFFF"}})}}class n extends i.z.St{categoryColors=[];constructor(){super();for(let e=0;e<15;e++)this.categoryColors.push(new s(e))}name="categoryFormatting";displayName="Category Formatting";slices=this.categoryColors.flatMap((e=>[e.enabled,e.color]));groups=[{name:"categoryFormattingGroup",displayName:"Category Formatting",slices:this.slices}]}class r extends i.z.St{circleConditions=[new o("circle1","Circle 1"),new o("circle2","Circle 2"),new o("circle3","Circle 3"),new o("circle4","Circle 4")];positivePercentageThreshold=new i.z.iB({name:"positivePercentageThreshold",displayName:"Positive Percentage Threshold",value:50,options:{minValue:{type:0,value:1},maxValue:{type:1,value:100}}});negativePercentageThreshold=new i.z.iB({name:"negativePercentageThreshold",displayName:"Negative Percentage Threshold",value:50,options:{minValue:{type:0,value:1},maxValue:{type:1,value:100}}});analysisFastEnabled=new i.z.jF({name:"analysisFastEnabled",displayName:"Enable Fast Analysis",value:!1});positiveHighlightColor=new i.z.sk({name:"positiveHighlightColor",displayName:"Positive Highlight Color",value:{value:"#E6F7FF"}});negativeHighlightColor=new i.z.sk({name:"negativeHighlightColor",displayName:"Negative Highlight Color",value:{value:"#FFF1F0"}});tooltipEnabled=new i.z.jF({name:"tooltipEnabled",displayName:"Enable Tooltip",value:!1});firstColumnBackgroundColor=new i.z.sk({name:"firstColumnBackgroundColor",displayName:"First Column Background Color",value:{value:"#FFFFFF"}});headerFontSize=new i.z.iB({name:"headerFontSize",displayName:"Header Font Size",value:14,options:{minValue:{type:0,value:8},maxValue:{type:1,value:40}}});firstColumnFontSize=new i.z.iB({name:"firstColumnFontSize",displayName:"First Column Font Size",value:14,options:{minValue:{type:0,value:8},maxValue:{type:1,value:40}}});headerCornerRadius=new i.z.iB({name:"headerCornerRadius",displayName:"Header Corner Radius",value:0});firstColumnCornerRadius=new i.z.iB({name:"firstColumnCornerRadius",displayName:"First Column Corner Radius",value:0});firstColumnColor=new l;categoryFormatting=new n;dataView;name="tableFormatting";displayName="Table Formatting";groups;constructor(){super(),this.initializeGroups()}initializeGroups(){this.groups=[{name:"circleGroup",displayName:"Circle Conditions",slices:this.circleConditions.flatMap((e=>[e.enabled,e.value,e.color,e.size]))},{name:"thresholdGroup",displayName:"Threshold Settings",slices:[this.positivePercentageThreshold,this.negativePercentageThreshold]},{name:"analysisFastGroup",displayName:"Fast Analysis",slices:[this.analysisFastEnabled,this.positiveHighlightColor,this.negativeHighlightColor]},{name:"columnGroup",displayName:"Column Formatting",slices:[this.firstColumnColor.applyTo,this.firstColumnColor.specificBackgroundColor,this.firstColumnBackgroundColor,this.headerCornerRadius,this.firstColumnCornerRadius,this.headerFontSize,this.firstColumnFontSize]},{name:"categoryGroup",displayName:"Category Formatting",slices:this.categoryFormatting.categoryColors.flatMap((e=>[e.enabled,e.color]))},{name:"tooltipGroup",displayName:"Tooltip",slices:[this.tooltipEnabled]}]}updateFirstColumnColorOptions(e){const t=[...new Set(e)];this.firstColumnColor.applyTo.placeholder=`Enter 'all' or one of: ${t.join(", ")}`}}class c extends i.z.Kx{tableFormattingCard=new r;cards=[this.tableFormattingCard]}},187:(e,t,a)=>{a.d(t,{b:()=>l});var i=a(674),o=a(82);class l{target;formattingSettings;formattingSettingsService;table;host;selectionManager;constructor(e){this.formattingSettingsService=new i.O,this.target=e.element,this.host=e.host,this.selectionManager=this.host.createSelectionManager(),this.formattingSettings=new o.S,this.createTable(),this.handleContextMenu()}createTable(){const e=document.createElement("div");e.className="table-container",this.table=document.createElement("table"),this.table.className="scrollable-table",e.appendChild(this.table),this.target.appendChild(e)}update(e){if(!e||!e.dataViews||!e.dataViews[0])return;const t=e.dataViews[0];this.formattingSettings=this.formattingSettingsService.populateFormattingSettingsModel(o.S,e.dataViews[0]),this.formattingSettings.tableFormattingCard.dataView=t;const a=t.table;if(!a)return;const i=this.formattingSettings.tableFormattingCard,l=a.rows.map((e=>e[0].toString()));for(i.updateFirstColumnColorOptions(l);this.table.firstChild;)this.table.removeChild(this.table.firstChild);const s=this.table.createTHead().insertRow();a.columns.forEach(((e,t)=>{const a=document.createElement("th");a.textContent=e.displayName,a.setAttribute("data-header",e.displayName),0===t&&(a.className="fixed-column"),s.appendChild(a)}));const n=this.table.createTBody();a.rows.forEach(((e,t)=>{const a=n.insertRow();e.forEach(((e,i)=>{const o=a.insertCell();this.renderCell(e,o,t,i),0===i&&(o.className="fixed-column",o.setAttribute("data-first-column",e.toString()),o.style.backgroundColor=o.style.backgroundColor||"white")}))})),this.applyHeaderColors(),this.applyCornerRadiuses(),this.applyFontSizes(),this.performFastAnalysis()}renderCell(e,t,a,i){const o=this.formattingSettings.tableFormattingCard;for(;t.firstChild;)t.removeChild(t.firstChild);if(0===i){const a=o.firstColumnBackgroundColor.value.value;t.style.backgroundColor=a,this.applyFirstColumnColor(t,e.toString())}let l=!1;if(o.circleConditions.forEach(((a,i)=>{if(a.enabled.value&&parseFloat(e)===a.value.value){const s=document.createElement("div");s.style.width=`${a.size.value}px`,s.style.height=`${a.size.value}px`,s.style.borderRadius="50%",s.style.backgroundColor=a.color.value.value,s.style.margin="auto";let n="";switch(i){case 0:n="none";break;case 1:n="negative";break;case 2:n="normal";break;case 3:n="positive"}if(s.setAttribute("data-feedback-type",n),o.tooltipEnabled.value){let e="";switch(i){case 0:e="Not Feedback";break;case 1:e="Negative Feedback";break;case 2:e="Normal Feedback";break;case 3:e="Positive Feedback"}s.title=e}else s.title=e.toString();t.appendChild(s),l=!0}})),!l){const a=document.createTextNode(e.toString());t.appendChild(a),t.title=e.toString()}}applyFirstColumnColor(e,t){const a=this.formattingSettings.tableFormattingCard.firstColumnColor,i=this.formattingSettings.tableFormattingCard.firstColumnBackgroundColor.value.value,o=a.specificBackgroundColor.value.value||i,l=a.applyTo.value.toLowerCase();"all"===l?e.style.backgroundColor=i:l===t.toLowerCase()?e.style.backgroundColor=o:e.style.backgroundColor=i,e.style.opacity="1",e.style.color=""}applyHeaderColors(){const e=this.formattingSettings.tableFormattingCard.categoryFormatting;this.table.querySelectorAll("th").forEach(((t,a)=>{if(a<e.categoryColors.length){const i=e.categoryColors[a];i.enabled.value?t.style.backgroundColor=i.color.value.value:t.style.backgroundColor=""}}))}applyCornerRadiuses(){const e=this.formattingSettings.tableFormattingCard,t=e.headerCornerRadius.value,a=e.firstColumnCornerRadius.value;this.table.querySelectorAll("th").forEach((e=>{e.style.borderRadius=`${t}px`})),this.table.querySelectorAll("td.fixed-column").forEach((e=>{e.style.borderRadius=`${a}px`}))}applyFontSizes(){const e=this.formattingSettings.tableFormattingCard,t=e.headerFontSize.value,a=e.firstColumnFontSize.value;this.table.querySelectorAll("th").forEach((e=>{e.style.fontSize=`${t}px`})),this.table.querySelectorAll("td.fixed-column").forEach((e=>{e.style.fontSize=`${a}px`}))}performFastAnalysis(){if(!this.formattingSettings.tableFormattingCard.analysisFastEnabled.value)return;const e=this.table.querySelectorAll("tbody tr"),t=[],a=[],i=this.formattingSettings.tableFormattingCard.positivePercentageThreshold.value/100,o=this.formattingSettings.tableFormattingCard.negativePercentageThreshold.value/100;e.forEach(((e,l)=>{let s=0,n=0,r=0;e.querySelectorAll("td").forEach(((e,t)=>{if(0===t)return;r++;const a=e.querySelector("div");if(a)switch(a.getAttribute("data-feedback-type")){case"positive":s++;break;case"negative":n++}}));const c=s/r,d=n/r;c>=i&&t.push({index:l,count:s,ratio:c}),d>=o&&a.push({index:l,count:n,ratio:d})})),t.sort(((e,t)=>t.ratio-e.ratio)),a.sort(((e,t)=>t.ratio-e.ratio)),t.forEach((t=>{e[t.index].style.backgroundColor=this.formattingSettings.tableFormattingCard.positiveHighlightColor.value.value})),a.forEach((t=>{e[t.index].style.backgroundColor=this.formattingSettings.tableFormattingCard.negativeHighlightColor.value.value}));const l=document.createElement("div"),s=document.createElement("h3");s.textContent="Fast Analysis Summary",l.appendChild(s);const n=document.createElement("p");n.textContent=`Companies with ${(100*i).toFixed(1)}% or more Positive Feedbacks: ${t.length}`,l.appendChild(n);const r=document.createElement("p");if(r.textContent=`Companies with ${(100*o).toFixed(1)}% or more Negative Feedbacks: ${a.length}`,l.appendChild(r),t.length>0){const a=e[t[0].index].querySelector("td").textContent,i=document.createElement("p");i.textContent=`Top Positive Company: ${a} (${t[0].count} positive feedbacks, ${(100*t[0].ratio).toFixed(1)}%)`,l.appendChild(i)}if(a.length>0){const t=e[a[0].index].querySelector("td").textContent,i=document.createElement("p");i.textContent=`Top Negative Company: ${t} (${a[0].count} negative feedbacks, ${(100*a[0].ratio).toFixed(1)}%)`,l.appendChild(i)}this.target.appendChild(l)}handleContextMenu(){this.target.addEventListener("contextmenu",(e=>{const t=e.target.closest("td");if(t){const a=Array.from(t.parentElement.parentElement.children).indexOf(t.parentElement)-1,i=(t.cellIndex,this.host.createSelectionIdBuilder().withTable(this.getDataView().table,a).createSelectionId());this.selectionManager.showContextMenu(i,{x:e.clientX,y:e.clientY}),e.preventDefault()}else this.selectionManager.showContextMenu(null,{x:e.clientX,y:e.clientY}),e.preventDefault()}))}getDataView(){return this.formattingSettings.tableFormattingCard.dataView}getFormattingModel(){return this.formattingSettingsService.buildFormattingModel(this.formattingSettings)}}}},t={};function a(i){var o=t[i];if(void 0!==o)return o.exports;var l=t[i]={exports:{}};return e[i](l,l.exports,a),l.exports}a.d=(e,t)=>{for(var i in t)a.o(t,i)&&!a.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};(()=>{a.r(i),a.d(i,{default:()=>l});var e=a(187),t=window.powerbi,o={name:"artemis3DDAAF4C926E4256ABEE19B4AB7444B0",displayName:"Market Monitor",class:"Visual",apiVersion:"5.3.0",create:t=>{if(e.b)return new e.b(t);throw"Visual instance not found"},createModalDialog:(e,t,a)=>{const i=globalThis.dialogRegistry;e in i&&new i[e](t,a)},custom:!0};void 0!==t&&(t.visuals=t.visuals||{},t.visuals.plugins=t.visuals.plugins||{},t.visuals.plugins.artemis3DDAAF4C926E4256ABEE19B4AB7444B0=o);const l=o})(),artemis3DDAAF4C926E4256ABEE19B4AB7444B0=i})();