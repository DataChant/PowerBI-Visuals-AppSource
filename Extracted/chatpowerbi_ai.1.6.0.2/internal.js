/*! For license information please see visual.js.LICENSE.txt */
var chatpowerbi_ai;(()=>{var t,e,r={6170:(t,e,r)=>{"use strict";function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(){o=function(t,e){return new r(t,void 0,e)};var t=RegExp.prototype,e=new WeakMap;function r(t,n,o){var a=RegExp(t,n);return e.set(a,o||e.get(t)),i(a,r.prototype)}function a(t,r){var n=e.get(r);return Object.keys(n).reduce((function(e,r){var o=n[r];if("number"==typeof o)e[r]=t[o];else{for(var i=0;void 0===t[o[i]]&&i+1<o.length;)i++;e[r]=t[o[i]]}return e}),Object.create(null))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&i(t,e)}(r,RegExp),r.prototype.exec=function(e){var r=t.exec.call(this,e);if(r){r.groups=a(r,this);var n=r.indices;n&&(n.groups=a(n,this))}return r},r.prototype[Symbol.replace]=function(r,o){if("string"==typeof o){var i=e.get(this);return t[Symbol.replace].call(this,r,o.replace(/\$<([^>]+)>/g,(function(t,e){var r=i[e];return"$"+(Array.isArray(r)?r.join("$"):r)})))}if("function"==typeof o){var u=this;return t[Symbol.replace].call(this,r,(function(){var t=arguments;return"object"!=n(t[t.length-1])&&(t=[].slice.call(t)).push(a(t,u)),o.apply(this,t)}))}return t[Symbol.replace].call(this,r,o)},o.apply(this,arguments)}function i(t,e){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},i(t,e)}function a(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],s=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);s=!0);}catch(t){c=!0,o=t}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(t,e)||u(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t,e){if(t){if("string"==typeof t)return s(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(t,e):void 0}}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}t=r.nmd(t);var c=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return function(e){return"[".concat(38+t,";5;").concat(e,"m")}},l=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return function(e,r,n){return"[".concat(38+t,";2;").concat(e,";").concat(r,";").concat(n,"m")}};Object.defineProperty(t,"exports",{enumerable:!0,get:function(){var t=new Map,e={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};e.color.gray=e.color.blackBright,e.bgColor.bgGray=e.bgColor.bgBlackBright,e.color.grey=e.color.blackBright,e.bgColor.bgGrey=e.bgColor.bgBlackBright;for(var r=0,n=Object.entries(e);r<n.length;r++){for(var i=a(n[r],2),f=i[0],p=i[1],h=0,d=Object.entries(p);h<d.length;h++){var y=a(d[h],2),v=y[0],m=y[1];e[v]={open:"[".concat(m[0],"m"),close:"[".concat(m[1],"m")},p[v]=e[v],t.set(m[0],m[1])}Object.defineProperty(e,f,{value:p,enumerable:!1})}return Object.defineProperty(e,"codes",{value:t,enumerable:!1}),e.color.close="[39m",e.bgColor.close="[49m",e.color.ansi256=c(),e.color.ansi16m=l(),e.bgColor.ansi256=c(10),e.bgColor.ansi16m=l(10),Object.defineProperties(e,{rgbToAnsi256:{value:function(t,e,r){return t===e&&e===r?t<8?16:t>248?231:Math.round((t-8)/247*24)+232:16+36*Math.round(t/255*5)+6*Math.round(e/255*5)+Math.round(r/255*5)},enumerable:!1},hexToRgb:{value:function(t){var e=o(/([a-f\d]{6}|[a-f\d]{3})/i,{colorString:1}).exec(t.toString(16));if(!e)return[0,0,0];var r=e.groups.colorString;3===r.length&&(r=r.split("").map((function(t){return t+t})).join(""));var n=Number.parseInt(r,16);return[n>>16&255,n>>8&255,255&n]},enumerable:!1},hexToAnsi256:{value:function(t){return e.rgbToAnsi256.apply(e,function(t){if(Array.isArray(t))return s(t)}(r=e.hexToRgb(t))||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(r)||u(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());var r},enumerable:!1}}),e}})},5883:(t,e)=>{"use strict";e.byteLength=function(t){var e=u(t),r=e[0],n=e[1];return 3*(r+n)/4-n},e.toByteArray=function(t){var e,r,i=u(t),a=i[0],s=i[1],c=new o(function(t,e,r){return 3*(e+r)/4-r}(0,a,s)),l=0,f=s>0?a-4:a;for(r=0;r<f;r+=4)e=n[t.charCodeAt(r)]<<18|n[t.charCodeAt(r+1)]<<12|n[t.charCodeAt(r+2)]<<6|n[t.charCodeAt(r+3)],c[l++]=e>>16&255,c[l++]=e>>8&255,c[l++]=255&e;return 2===s&&(e=n[t.charCodeAt(r)]<<2|n[t.charCodeAt(r+1)]>>4,c[l++]=255&e),1===s&&(e=n[t.charCodeAt(r)]<<10|n[t.charCodeAt(r+1)]<<4|n[t.charCodeAt(r+2)]>>2,c[l++]=e>>8&255,c[l++]=255&e),c},e.fromByteArray=function(t){for(var e,n=t.length,o=n%3,i=[],a=16383,u=0,c=n-o;u<c;u+=a)i.push(s(t,u,u+a>c?c:u+a));return 1===o?(e=t[n-1],i.push(r[e>>2]+r[e<<4&63]+"==")):2===o&&(e=(t[n-2]<<8)+t[n-1],i.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"=")),i.join("")};for(var r=[],n=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0;a<64;++a)r[a]=i[a],n[i.charCodeAt(a)]=a;function u(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");return-1===r&&(r=e),[r,r===e?0:4-r%4]}function s(t,e,n){for(var o,i,a=[],u=e;u<n;u+=3)o=(t[u]<<16&16711680)+(t[u+1]<<8&65280)+(255&t[u+2]),a.push(r[(i=o)>>18&63]+r[i>>12&63]+r[i>>6&63]+r[63&i]);return a.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},3372:t=>{"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}function r(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function n(t,r,n){return(r=function(t){var r=function(t){if("object"!=e(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!=e(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(r)?r:r+""}(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}var o=/(?:[A-Z\xC0-\xD6\xD8-\xDE\u0100\u0102\u0104\u0106\u0108\u010A\u010C\u010E\u0110\u0112\u0114\u0116\u0118\u011A\u011C\u011E\u0120\u0122\u0124\u0126\u0128\u012A\u012C\u012E\u0130\u0132\u0134\u0136\u0139\u013B\u013D\u013F\u0141\u0143\u0145\u0147\u014A\u014C\u014E\u0150\u0152\u0154\u0156\u0158\u015A\u015C\u015E\u0160\u0162\u0164\u0166\u0168\u016A\u016C\u016E\u0170\u0172\u0174\u0176\u0178\u0179\u017B\u017D\u0181\u0182\u0184\u0186\u0187\u0189-\u018B\u018E-\u0191\u0193\u0194\u0196-\u0198\u019C\u019D\u019F\u01A0\u01A2\u01A4\u01A6\u01A7\u01A9\u01AC\u01AE\u01AF\u01B1-\u01B3\u01B5\u01B7\u01B8\u01BC\u01C4\u01C7\u01CA\u01CD\u01CF\u01D1\u01D3\u01D5\u01D7\u01D9\u01DB\u01DE\u01E0\u01E2\u01E4\u01E6\u01E8\u01EA\u01EC\u01EE\u01F1\u01F4\u01F6-\u01F8\u01FA\u01FC\u01FE\u0200\u0202\u0204\u0206\u0208\u020A\u020C\u020E\u0210\u0212\u0214\u0216\u0218\u021A\u021C\u021E\u0220\u0222\u0224\u0226\u0228\u022A\u022C\u022E\u0230\u0232\u023A\u023B\u023D\u023E\u0241\u0243-\u0246\u0248\u024A\u024C\u024E\u0370\u0372\u0376\u037F\u0386\u0388-\u038A\u038C\u038E\u038F\u0391-\u03A1\u03A3-\u03AB\u03CF\u03D2-\u03D4\u03D8\u03DA\u03DC\u03DE\u03E0\u03E2\u03E4\u03E6\u03E8\u03EA\u03EC\u03EE\u03F4\u03F7\u03F9\u03FA\u03FD-\u042F\u0460\u0462\u0464\u0466\u0468\u046A\u046C\u046E\u0470\u0472\u0474\u0476\u0478\u047A\u047C\u047E\u0480\u048A\u048C\u048E\u0490\u0492\u0494\u0496\u0498\u049A\u049C\u049E\u04A0\u04A2\u04A4\u04A6\u04A8\u04AA\u04AC\u04AE\u04B0\u04B2\u04B4\u04B6\u04B8\u04BA\u04BC\u04BE\u04C0\u04C1\u04C3\u04C5\u04C7\u04C9\u04CB\u04CD\u04D0\u04D2\u04D4\u04D6\u04D8\u04DA\u04DC\u04DE\u04E0\u04E2\u04E4\u04E6\u04E8\u04EA\u04EC\u04EE\u04F0\u04F2\u04F4\u04F6\u04F8\u04FA\u04FC\u04FE\u0500\u0502\u0504\u0506\u0508\u050A\u050C\u050E\u0510\u0512\u0514\u0516\u0518\u051A\u051C\u051E\u0520\u0522\u0524\u0526\u0528\u052A\u052C\u052E\u0531-\u0556\u10A0-\u10C5\u10C7\u10CD\u13A0-\u13F5\u1C89\u1C90-\u1CBA\u1CBD-\u1CBF\u1E00\u1E02\u1E04\u1E06\u1E08\u1E0A\u1E0C\u1E0E\u1E10\u1E12\u1E14\u1E16\u1E18\u1E1A\u1E1C\u1E1E\u1E20\u1E22\u1E24\u1E26\u1E28\u1E2A\u1E2C\u1E2E\u1E30\u1E32\u1E34\u1E36\u1E38\u1E3A\u1E3C\u1E3E\u1E40\u1E42\u1E44\u1E46\u1E48\u1E4A\u1E4C\u1E4E\u1E50\u1E52\u1E54\u1E56\u1E58\u1E5A\u1E5C\u1E5E\u1E60\u1E62\u1E64\u1E66\u1E68\u1E6A\u1E6C\u1E6E\u1E70\u1E72\u1E74\u1E76\u1E78\u1E7A\u1E7C\u1E7E\u1E80\u1E82\u1E84\u1E86\u1E88\u1E8A\u1E8C\u1E8E\u1E90\u1E92\u1E94\u1E9E\u1EA0\u1EA2\u1EA4\u1EA6\u1EA8\u1EAA\u1EAC\u1EAE\u1EB0\u1EB2\u1EB4\u1EB6\u1EB8\u1EBA\u1EBC\u1EBE\u1EC0\u1EC2\u1EC4\u1EC6\u1EC8\u1ECA\u1ECC\u1ECE\u1ED0\u1ED2\u1ED4\u1ED6\u1ED8\u1EDA\u1EDC\u1EDE\u1EE0\u1EE2\u1EE4\u1EE6\u1EE8\u1EEA\u1EEC\u1EEE\u1EF0\u1EF2\u1EF4\u1EF6\u1EF8\u1EFA\u1EFC\u1EFE\u1F08-\u1F0F\u1F18-\u1F1D\u1F28-\u1F2F\u1F38-\u1F3F\u1F48-\u1F4D\u1F59\u1F5B\u1F5D\u1F5F\u1F68-\u1F6F\u1FB8-\u1FBB\u1FC8-\u1FCB\u1FD8-\u1FDB\u1FE8-\u1FEC\u1FF8-\u1FFB\u2102\u2107\u210B-\u210D\u2110-\u2112\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u2130-\u2133\u213E\u213F\u2145\u2183\u2C00-\u2C2F\u2C60\u2C62-\u2C64\u2C67\u2C69\u2C6B\u2C6D-\u2C70\u2C72\u2C75\u2C7E-\u2C80\u2C82\u2C84\u2C86\u2C88\u2C8A\u2C8C\u2C8E\u2C90\u2C92\u2C94\u2C96\u2C98\u2C9A\u2C9C\u2C9E\u2CA0\u2CA2\u2CA4\u2CA6\u2CA8\u2CAA\u2CAC\u2CAE\u2CB0\u2CB2\u2CB4\u2CB6\u2CB8\u2CBA\u2CBC\u2CBE\u2CC0\u2CC2\u2CC4\u2CC6\u2CC8\u2CCA\u2CCC\u2CCE\u2CD0\u2CD2\u2CD4\u2CD6\u2CD8\u2CDA\u2CDC\u2CDE\u2CE0\u2CE2\u2CEB\u2CED\u2CF2\uA640\uA642\uA644\uA646\uA648\uA64A\uA64C\uA64E\uA650\uA652\uA654\uA656\uA658\uA65A\uA65C\uA65E\uA660\uA662\uA664\uA666\uA668\uA66A\uA66C\uA680\uA682\uA684\uA686\uA688\uA68A\uA68C\uA68E\uA690\uA692\uA694\uA696\uA698\uA69A\uA722\uA724\uA726\uA728\uA72A\uA72C\uA72E\uA732\uA734\uA736\uA738\uA73A\uA73C\uA73E\uA740\uA742\uA744\uA746\uA748\uA74A\uA74C\uA74E\uA750\uA752\uA754\uA756\uA758\uA75A\uA75C\uA75E\uA760\uA762\uA764\uA766\uA768\uA76A\uA76C\uA76E\uA779\uA77B\uA77D\uA77E\uA780\uA782\uA784\uA786\uA78B\uA78D\uA790\uA792\uA796\uA798\uA79A\uA79C\uA79E\uA7A0\uA7A2\uA7A4\uA7A6\uA7A8\uA7AA-\uA7AE\uA7B0-\uA7B4\uA7B6\uA7B8\uA7BA\uA7BC\uA7BE\uA7C0\uA7C2\uA7C4-\uA7C7\uA7C9\uA7CB\uA7CC\uA7D0\uA7D6\uA7D8\uA7DA\uA7DC\uA7F5\uFF21-\uFF3A]|\uD801[\uDC00-\uDC27\uDCB0-\uDCD3\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95]|\uD803[\uDC80-\uDCB2\uDD50-\uDD65]|\uD806[\uDCA0-\uDCBF]|\uD81B[\uDE40-\uDE5F]|\uD835[\uDC00-\uDC19\uDC34-\uDC4D\uDC68-\uDC81\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB5\uDCD0-\uDCE9\uDD04\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD38\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD6C-\uDD85\uDDA0-\uDDB9\uDDD4-\uDDED\uDE08-\uDE21\uDE3C-\uDE55\uDE70-\uDE89\uDEA8-\uDEC0\uDEE2-\uDEFA\uDF1C-\uDF34\uDF56-\uDF6E\uDF90-\uDFA8\uDFCA]|\uD83A[\uDD00-\uDD21])/,i=/(?:[a-z\xB5\xDF-\xF6\xF8-\xFF\u0101\u0103\u0105\u0107\u0109\u010B\u010D\u010F\u0111\u0113\u0115\u0117\u0119\u011B\u011D\u011F\u0121\u0123\u0125\u0127\u0129\u012B\u012D\u012F\u0131\u0133\u0135\u0137\u0138\u013A\u013C\u013E\u0140\u0142\u0144\u0146\u0148\u0149\u014B\u014D\u014F\u0151\u0153\u0155\u0157\u0159\u015B\u015D\u015F\u0161\u0163\u0165\u0167\u0169\u016B\u016D\u016F\u0171\u0173\u0175\u0177\u017A\u017C\u017E-\u0180\u0183\u0185\u0188\u018C\u018D\u0192\u0195\u0199-\u019B\u019E\u01A1\u01A3\u01A5\u01A8\u01AA\u01AB\u01AD\u01B0\u01B4\u01B6\u01B9\u01BA\u01BD-\u01BF\u01C6\u01C9\u01CC\u01CE\u01D0\u01D2\u01D4\u01D6\u01D8\u01DA\u01DC\u01DD\u01DF\u01E1\u01E3\u01E5\u01E7\u01E9\u01EB\u01ED\u01EF\u01F0\u01F3\u01F5\u01F9\u01FB\u01FD\u01FF\u0201\u0203\u0205\u0207\u0209\u020B\u020D\u020F\u0211\u0213\u0215\u0217\u0219\u021B\u021D\u021F\u0221\u0223\u0225\u0227\u0229\u022B\u022D\u022F\u0231\u0233-\u0239\u023C\u023F\u0240\u0242\u0247\u0249\u024B\u024D\u024F-\u0293\u0295-\u02AF\u0371\u0373\u0377\u037B-\u037D\u0390\u03AC-\u03CE\u03D0\u03D1\u03D5-\u03D7\u03D9\u03DB\u03DD\u03DF\u03E1\u03E3\u03E5\u03E7\u03E9\u03EB\u03ED\u03EF-\u03F3\u03F5\u03F8\u03FB\u03FC\u0430-\u045F\u0461\u0463\u0465\u0467\u0469\u046B\u046D\u046F\u0471\u0473\u0475\u0477\u0479\u047B\u047D\u047F\u0481\u048B\u048D\u048F\u0491\u0493\u0495\u0497\u0499\u049B\u049D\u049F\u04A1\u04A3\u04A5\u04A7\u04A9\u04AB\u04AD\u04AF\u04B1\u04B3\u04B5\u04B7\u04B9\u04BB\u04BD\u04BF\u04C2\u04C4\u04C6\u04C8\u04CA\u04CC\u04CE\u04CF\u04D1\u04D3\u04D5\u04D7\u04D9\u04DB\u04DD\u04DF\u04E1\u04E3\u04E5\u04E7\u04E9\u04EB\u04ED\u04EF\u04F1\u04F3\u04F5\u04F7\u04F9\u04FB\u04FD\u04FF\u0501\u0503\u0505\u0507\u0509\u050B\u050D\u050F\u0511\u0513\u0515\u0517\u0519\u051B\u051D\u051F\u0521\u0523\u0525\u0527\u0529\u052B\u052D\u052F\u0560-\u0588\u10D0-\u10FA\u10FD-\u10FF\u13F8-\u13FD\u1C80-\u1C88\u1C8A\u1D00-\u1D2B\u1D6B-\u1D77\u1D79-\u1D9A\u1E01\u1E03\u1E05\u1E07\u1E09\u1E0B\u1E0D\u1E0F\u1E11\u1E13\u1E15\u1E17\u1E19\u1E1B\u1E1D\u1E1F\u1E21\u1E23\u1E25\u1E27\u1E29\u1E2B\u1E2D\u1E2F\u1E31\u1E33\u1E35\u1E37\u1E39\u1E3B\u1E3D\u1E3F\u1E41\u1E43\u1E45\u1E47\u1E49\u1E4B\u1E4D\u1E4F\u1E51\u1E53\u1E55\u1E57\u1E59\u1E5B\u1E5D\u1E5F\u1E61\u1E63\u1E65\u1E67\u1E69\u1E6B\u1E6D\u1E6F\u1E71\u1E73\u1E75\u1E77\u1E79\u1E7B\u1E7D\u1E7F\u1E81\u1E83\u1E85\u1E87\u1E89\u1E8B\u1E8D\u1E8F\u1E91\u1E93\u1E95-\u1E9D\u1E9F\u1EA1\u1EA3\u1EA5\u1EA7\u1EA9\u1EAB\u1EAD\u1EAF\u1EB1\u1EB3\u1EB5\u1EB7\u1EB9\u1EBB\u1EBD\u1EBF\u1EC1\u1EC3\u1EC5\u1EC7\u1EC9\u1ECB\u1ECD\u1ECF\u1ED1\u1ED3\u1ED5\u1ED7\u1ED9\u1EDB\u1EDD\u1EDF\u1EE1\u1EE3\u1EE5\u1EE7\u1EE9\u1EEB\u1EED\u1EEF\u1EF1\u1EF3\u1EF5\u1EF7\u1EF9\u1EFB\u1EFD\u1EFF-\u1F07\u1F10-\u1F15\u1F20-\u1F27\u1F30-\u1F37\u1F40-\u1F45\u1F50-\u1F57\u1F60-\u1F67\u1F70-\u1F7D\u1F80-\u1F87\u1F90-\u1F97\u1FA0-\u1FA7\u1FB0-\u1FB4\u1FB6\u1FB7\u1FBE\u1FC2-\u1FC4\u1FC6\u1FC7\u1FD0-\u1FD3\u1FD6\u1FD7\u1FE0-\u1FE7\u1FF2-\u1FF4\u1FF6\u1FF7\u210A\u210E\u210F\u2113\u212F\u2134\u2139\u213C\u213D\u2146-\u2149\u214E\u2184\u2C30-\u2C5F\u2C61\u2C65\u2C66\u2C68\u2C6A\u2C6C\u2C71\u2C73\u2C74\u2C76-\u2C7B\u2C81\u2C83\u2C85\u2C87\u2C89\u2C8B\u2C8D\u2C8F\u2C91\u2C93\u2C95\u2C97\u2C99\u2C9B\u2C9D\u2C9F\u2CA1\u2CA3\u2CA5\u2CA7\u2CA9\u2CAB\u2CAD\u2CAF\u2CB1\u2CB3\u2CB5\u2CB7\u2CB9\u2CBB\u2CBD\u2CBF\u2CC1\u2CC3\u2CC5\u2CC7\u2CC9\u2CCB\u2CCD\u2CCF\u2CD1\u2CD3\u2CD5\u2CD7\u2CD9\u2CDB\u2CDD\u2CDF\u2CE1\u2CE3\u2CE4\u2CEC\u2CEE\u2CF3\u2D00-\u2D25\u2D27\u2D2D\uA641\uA643\uA645\uA647\uA649\uA64B\uA64D\uA64F\uA651\uA653\uA655\uA657\uA659\uA65B\uA65D\uA65F\uA661\uA663\uA665\uA667\uA669\uA66B\uA66D\uA681\uA683\uA685\uA687\uA689\uA68B\uA68D\uA68F\uA691\uA693\uA695\uA697\uA699\uA69B\uA723\uA725\uA727\uA729\uA72B\uA72D\uA72F-\uA731\uA733\uA735\uA737\uA739\uA73B\uA73D\uA73F\uA741\uA743\uA745\uA747\uA749\uA74B\uA74D\uA74F\uA751\uA753\uA755\uA757\uA759\uA75B\uA75D\uA75F\uA761\uA763\uA765\uA767\uA769\uA76B\uA76D\uA76F\uA771-\uA778\uA77A\uA77C\uA77F\uA781\uA783\uA785\uA787\uA78C\uA78E\uA791\uA793-\uA795\uA797\uA799\uA79B\uA79D\uA79F\uA7A1\uA7A3\uA7A5\uA7A7\uA7A9\uA7AF\uA7B5\uA7B7\uA7B9\uA7BB\uA7BD\uA7BF\uA7C1\uA7C3\uA7C8\uA7CA\uA7CD\uA7D1\uA7D3\uA7D5\uA7D7\uA7D9\uA7DB\uA7F6\uA7FA\uAB30-\uAB5A\uAB60-\uAB68\uAB70-\uABBF\uFB00-\uFB06\uFB13-\uFB17\uFF41-\uFF5A]|\uD801[\uDC28-\uDC4F\uDCD8-\uDCFB\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC]|\uD803[\uDCC0-\uDCF2\uDD70-\uDD85]|\uD806[\uDCC0-\uDCDF]|\uD81B[\uDE60-\uDE7F]|\uD835[\uDC1A-\uDC33\uDC4E-\uDC54\uDC56-\uDC67\uDC82-\uDC9B\uDCB6-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDCCF\uDCEA-\uDD03\uDD1E-\uDD37\uDD52-\uDD6B\uDD86-\uDD9F\uDDBA-\uDDD3\uDDEE-\uDE07\uDE22-\uDE3B\uDE56-\uDE6F\uDE8A-\uDEA5\uDEC2-\uDEDA\uDEDC-\uDEE1\uDEFC-\uDF14\uDF16-\uDF1B\uDF36-\uDF4E\uDF50-\uDF55\uDF70-\uDF88\uDF8A-\uDF8F\uDFAA-\uDFC2\uDFC4-\uDFC9\uDFCB]|\uD837[\uDF00-\uDF09\uDF0B-\uDF1E\uDF25-\uDF2A]|\uD83A[\uDD22-\uDD43])/,a=/^(?:[A-Z\xC0-\xD6\xD8-\xDE\u0100\u0102\u0104\u0106\u0108\u010A\u010C\u010E\u0110\u0112\u0114\u0116\u0118\u011A\u011C\u011E\u0120\u0122\u0124\u0126\u0128\u012A\u012C\u012E\u0130\u0132\u0134\u0136\u0139\u013B\u013D\u013F\u0141\u0143\u0145\u0147\u014A\u014C\u014E\u0150\u0152\u0154\u0156\u0158\u015A\u015C\u015E\u0160\u0162\u0164\u0166\u0168\u016A\u016C\u016E\u0170\u0172\u0174\u0176\u0178\u0179\u017B\u017D\u0181\u0182\u0184\u0186\u0187\u0189-\u018B\u018E-\u0191\u0193\u0194\u0196-\u0198\u019C\u019D\u019F\u01A0\u01A2\u01A4\u01A6\u01A7\u01A9\u01AC\u01AE\u01AF\u01B1-\u01B3\u01B5\u01B7\u01B8\u01BC\u01C4\u01C7\u01CA\u01CD\u01CF\u01D1\u01D3\u01D5\u01D7\u01D9\u01DB\u01DE\u01E0\u01E2\u01E4\u01E6\u01E8\u01EA\u01EC\u01EE\u01F1\u01F4\u01F6-\u01F8\u01FA\u01FC\u01FE\u0200\u0202\u0204\u0206\u0208\u020A\u020C\u020E\u0210\u0212\u0214\u0216\u0218\u021A\u021C\u021E\u0220\u0222\u0224\u0226\u0228\u022A\u022C\u022E\u0230\u0232\u023A\u023B\u023D\u023E\u0241\u0243-\u0246\u0248\u024A\u024C\u024E\u0370\u0372\u0376\u037F\u0386\u0388-\u038A\u038C\u038E\u038F\u0391-\u03A1\u03A3-\u03AB\u03CF\u03D2-\u03D4\u03D8\u03DA\u03DC\u03DE\u03E0\u03E2\u03E4\u03E6\u03E8\u03EA\u03EC\u03EE\u03F4\u03F7\u03F9\u03FA\u03FD-\u042F\u0460\u0462\u0464\u0466\u0468\u046A\u046C\u046E\u0470\u0472\u0474\u0476\u0478\u047A\u047C\u047E\u0480\u048A\u048C\u048E\u0490\u0492\u0494\u0496\u0498\u049A\u049C\u049E\u04A0\u04A2\u04A4\u04A6\u04A8\u04AA\u04AC\u04AE\u04B0\u04B2\u04B4\u04B6\u04B8\u04BA\u04BC\u04BE\u04C0\u04C1\u04C3\u04C5\u04C7\u04C9\u04CB\u04CD\u04D0\u04D2\u04D4\u04D6\u04D8\u04DA\u04DC\u04DE\u04E0\u04E2\u04E4\u04E6\u04E8\u04EA\u04EC\u04EE\u04F0\u04F2\u04F4\u04F6\u04F8\u04FA\u04FC\u04FE\u0500\u0502\u0504\u0506\u0508\u050A\u050C\u050E\u0510\u0512\u0514\u0516\u0518\u051A\u051C\u051E\u0520\u0522\u0524\u0526\u0528\u052A\u052C\u052E\u0531-\u0556\u10A0-\u10C5\u10C7\u10CD\u13A0-\u13F5\u1C89\u1C90-\u1CBA\u1CBD-\u1CBF\u1E00\u1E02\u1E04\u1E06\u1E08\u1E0A\u1E0C\u1E0E\u1E10\u1E12\u1E14\u1E16\u1E18\u1E1A\u1E1C\u1E1E\u1E20\u1E22\u1E24\u1E26\u1E28\u1E2A\u1E2C\u1E2E\u1E30\u1E32\u1E34\u1E36\u1E38\u1E3A\u1E3C\u1E3E\u1E40\u1E42\u1E44\u1E46\u1E48\u1E4A\u1E4C\u1E4E\u1E50\u1E52\u1E54\u1E56\u1E58\u1E5A\u1E5C\u1E5E\u1E60\u1E62\u1E64\u1E66\u1E68\u1E6A\u1E6C\u1E6E\u1E70\u1E72\u1E74\u1E76\u1E78\u1E7A\u1E7C\u1E7E\u1E80\u1E82\u1E84\u1E86\u1E88\u1E8A\u1E8C\u1E8E\u1E90\u1E92\u1E94\u1E9E\u1EA0\u1EA2\u1EA4\u1EA6\u1EA8\u1EAA\u1EAC\u1EAE\u1EB0\u1EB2\u1EB4\u1EB6\u1EB8\u1EBA\u1EBC\u1EBE\u1EC0\u1EC2\u1EC4\u1EC6\u1EC8\u1ECA\u1ECC\u1ECE\u1ED0\u1ED2\u1ED4\u1ED6\u1ED8\u1EDA\u1EDC\u1EDE\u1EE0\u1EE2\u1EE4\u1EE6\u1EE8\u1EEA\u1EEC\u1EEE\u1EF0\u1EF2\u1EF4\u1EF6\u1EF8\u1EFA\u1EFC\u1EFE\u1F08-\u1F0F\u1F18-\u1F1D\u1F28-\u1F2F\u1F38-\u1F3F\u1F48-\u1F4D\u1F59\u1F5B\u1F5D\u1F5F\u1F68-\u1F6F\u1FB8-\u1FBB\u1FC8-\u1FCB\u1FD8-\u1FDB\u1FE8-\u1FEC\u1FF8-\u1FFB\u2102\u2107\u210B-\u210D\u2110-\u2112\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u2130-\u2133\u213E\u213F\u2145\u2183\u2C00-\u2C2F\u2C60\u2C62-\u2C64\u2C67\u2C69\u2C6B\u2C6D-\u2C70\u2C72\u2C75\u2C7E-\u2C80\u2C82\u2C84\u2C86\u2C88\u2C8A\u2C8C\u2C8E\u2C90\u2C92\u2C94\u2C96\u2C98\u2C9A\u2C9C\u2C9E\u2CA0\u2CA2\u2CA4\u2CA6\u2CA8\u2CAA\u2CAC\u2CAE\u2CB0\u2CB2\u2CB4\u2CB6\u2CB8\u2CBA\u2CBC\u2CBE\u2CC0\u2CC2\u2CC4\u2CC6\u2CC8\u2CCA\u2CCC\u2CCE\u2CD0\u2CD2\u2CD4\u2CD6\u2CD8\u2CDA\u2CDC\u2CDE\u2CE0\u2CE2\u2CEB\u2CED\u2CF2\uA640\uA642\uA644\uA646\uA648\uA64A\uA64C\uA64E\uA650\uA652\uA654\uA656\uA658\uA65A\uA65C\uA65E\uA660\uA662\uA664\uA666\uA668\uA66A\uA66C\uA680\uA682\uA684\uA686\uA688\uA68A\uA68C\uA68E\uA690\uA692\uA694\uA696\uA698\uA69A\uA722\uA724\uA726\uA728\uA72A\uA72C\uA72E\uA732\uA734\uA736\uA738\uA73A\uA73C\uA73E\uA740\uA742\uA744\uA746\uA748\uA74A\uA74C\uA74E\uA750\uA752\uA754\uA756\uA758\uA75A\uA75C\uA75E\uA760\uA762\uA764\uA766\uA768\uA76A\uA76C\uA76E\uA779\uA77B\uA77D\uA77E\uA780\uA782\uA784\uA786\uA78B\uA78D\uA790\uA792\uA796\uA798\uA79A\uA79C\uA79E\uA7A0\uA7A2\uA7A4\uA7A6\uA7A8\uA7AA-\uA7AE\uA7B0-\uA7B4\uA7B6\uA7B8\uA7BA\uA7BC\uA7BE\uA7C0\uA7C2\uA7C4-\uA7C7\uA7C9\uA7CB\uA7CC\uA7D0\uA7D6\uA7D8\uA7DA\uA7DC\uA7F5\uFF21-\uFF3A]|\uD801[\uDC00-\uDC27\uDCB0-\uDCD3\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95]|\uD803[\uDC80-\uDCB2\uDD50-\uDD65]|\uD806[\uDCA0-\uDCBF]|\uD81B[\uDE40-\uDE5F]|\uD835[\uDC00-\uDC19\uDC34-\uDC4D\uDC68-\uDC81\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB5\uDCD0-\uDCE9\uDD04\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD38\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD6C-\uDD85\uDDA0-\uDDB9\uDDD4-\uDDED\uDE08-\uDE21\uDE3C-\uDE55\uDE70-\uDE89\uDEA8-\uDEC0\uDEE2-\uDEFA\uDF1C-\uDF34\uDF56-\uDF6E\uDF90-\uDFA8\uDFCA]|\uD83A[\uDD00-\uDD21])(?!(?:[A-Z\xC0-\xD6\xD8-\xDE\u0100\u0102\u0104\u0106\u0108\u010A\u010C\u010E\u0110\u0112\u0114\u0116\u0118\u011A\u011C\u011E\u0120\u0122\u0124\u0126\u0128\u012A\u012C\u012E\u0130\u0132\u0134\u0136\u0139\u013B\u013D\u013F\u0141\u0143\u0145\u0147\u014A\u014C\u014E\u0150\u0152\u0154\u0156\u0158\u015A\u015C\u015E\u0160\u0162\u0164\u0166\u0168\u016A\u016C\u016E\u0170\u0172\u0174\u0176\u0178\u0179\u017B\u017D\u0181\u0182\u0184\u0186\u0187\u0189-\u018B\u018E-\u0191\u0193\u0194\u0196-\u0198\u019C\u019D\u019F\u01A0\u01A2\u01A4\u01A6\u01A7\u01A9\u01AC\u01AE\u01AF\u01B1-\u01B3\u01B5\u01B7\u01B8\u01BC\u01C4\u01C7\u01CA\u01CD\u01CF\u01D1\u01D3\u01D5\u01D7\u01D9\u01DB\u01DE\u01E0\u01E2\u01E4\u01E6\u01E8\u01EA\u01EC\u01EE\u01F1\u01F4\u01F6-\u01F8\u01FA\u01FC\u01FE\u0200\u0202\u0204\u0206\u0208\u020A\u020C\u020E\u0210\u0212\u0214\u0216\u0218\u021A\u021C\u021E\u0220\u0222\u0224\u0226\u0228\u022A\u022C\u022E\u0230\u0232\u023A\u023B\u023D\u023E\u0241\u0243-\u0246\u0248\u024A\u024C\u024E\u0370\u0372\u0376\u037F\u0386\u0388-\u038A\u038C\u038E\u038F\u0391-\u03A1\u03A3-\u03AB\u03CF\u03D2-\u03D4\u03D8\u03DA\u03DC\u03DE\u03E0\u03E2\u03E4\u03E6\u03E8\u03EA\u03EC\u03EE\u03F4\u03F7\u03F9\u03FA\u03FD-\u042F\u0460\u0462\u0464\u0466\u0468\u046A\u046C\u046E\u0470\u0472\u0474\u0476\u0478\u047A\u047C\u047E\u0480\u048A\u048C\u048E\u0490\u0492\u0494\u0496\u0498\u049A\u049C\u049E\u04A0\u04A2\u04A4\u04A6\u04A8\u04AA\u04AC\u04AE\u04B0\u04B2\u04B4\u04B6\u04B8\u04BA\u04BC\u04BE\u04C0\u04C1\u04C3\u04C5\u04C7\u04C9\u04CB\u04CD\u04D0\u04D2\u04D4\u04D6\u04D8\u04DA\u04DC\u04DE\u04E0\u04E2\u04E4\u04E6\u04E8\u04EA\u04EC\u04EE\u04F0\u04F2\u04F4\u04F6\u04F8\u04FA\u04FC\u04FE\u0500\u0502\u0504\u0506\u0508\u050A\u050C\u050E\u0510\u0512\u0514\u0516\u0518\u051A\u051C\u051E\u0520\u0522\u0524\u0526\u0528\u052A\u052C\u052E\u0531-\u0556\u10A0-\u10C5\u10C7\u10CD\u13A0-\u13F5\u1C89\u1C90-\u1CBA\u1CBD-\u1CBF\u1E00\u1E02\u1E04\u1E06\u1E08\u1E0A\u1E0C\u1E0E\u1E10\u1E12\u1E14\u1E16\u1E18\u1E1A\u1E1C\u1E1E\u1E20\u1E22\u1E24\u1E26\u1E28\u1E2A\u1E2C\u1E2E\u1E30\u1E32\u1E34\u1E36\u1E38\u1E3A\u1E3C\u1E3E\u1E40\u1E42\u1E44\u1E46\u1E48\u1E4A\u1E4C\u1E4E\u1E50\u1E52\u1E54\u1E56\u1E58\u1E5A\u1E5C\u1E5E\u1E60\u1E62\u1E64\u1E66\u1E68\u1E6A\u1E6C\u1E6E\u1E70\u1E72\u1E74\u1E76\u1E78\u1E7A\u1E7C\u1E7E\u1E80\u1E82\u1E84\u1E86\u1E88\u1E8A\u1E8C\u1E8E\u1E90\u1E92\u1E94\u1E9E\u1EA0\u1EA2\u1EA4\u1EA6\u1EA8\u1EAA\u1EAC\u1EAE\u1EB0\u1EB2\u1EB4\u1EB6\u1EB8\u1EBA\u1EBC\u1EBE\u1EC0\u1EC2\u1EC4\u1EC6\u1EC8\u1ECA\u1ECC\u1ECE\u1ED0\u1ED2\u1ED4\u1ED6\u1ED8\u1EDA\u1EDC\u1EDE\u1EE0\u1EE2\u1EE4\u1EE6\u1EE8\u1EEA\u1EEC\u1EEE\u1EF0\u1EF2\u1EF4\u1EF6\u1EF8\u1EFA\u1EFC\u1EFE\u1F08-\u1F0F\u1F18-\u1F1D\u1F28-\u1F2F\u1F38-\u1F3F\u1F48-\u1F4D\u1F59\u1F5B\u1F5D\u1F5F\u1F68-\u1F6F\u1FB8-\u1FBB\u1FC8-\u1FCB\u1FD8-\u1FDB\u1FE8-\u1FEC\u1FF8-\u1FFB\u2102\u2107\u210B-\u210D\u2110-\u2112\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u2130-\u2133\u213E\u213F\u2145\u2183\u2C00-\u2C2F\u2C60\u2C62-\u2C64\u2C67\u2C69\u2C6B\u2C6D-\u2C70\u2C72\u2C75\u2C7E-\u2C80\u2C82\u2C84\u2C86\u2C88\u2C8A\u2C8C\u2C8E\u2C90\u2C92\u2C94\u2C96\u2C98\u2C9A\u2C9C\u2C9E\u2CA0\u2CA2\u2CA4\u2CA6\u2CA8\u2CAA\u2CAC\u2CAE\u2CB0\u2CB2\u2CB4\u2CB6\u2CB8\u2CBA\u2CBC\u2CBE\u2CC0\u2CC2\u2CC4\u2CC6\u2CC8\u2CCA\u2CCC\u2CCE\u2CD0\u2CD2\u2CD4\u2CD6\u2CD8\u2CDA\u2CDC\u2CDE\u2CE0\u2CE2\u2CEB\u2CED\u2CF2\uA640\uA642\uA644\uA646\uA648\uA64A\uA64C\uA64E\uA650\uA652\uA654\uA656\uA658\uA65A\uA65C\uA65E\uA660\uA662\uA664\uA666\uA668\uA66A\uA66C\uA680\uA682\uA684\uA686\uA688\uA68A\uA68C\uA68E\uA690\uA692\uA694\uA696\uA698\uA69A\uA722\uA724\uA726\uA728\uA72A\uA72C\uA72E\uA732\uA734\uA736\uA738\uA73A\uA73C\uA73E\uA740\uA742\uA744\uA746\uA748\uA74A\uA74C\uA74E\uA750\uA752\uA754\uA756\uA758\uA75A\uA75C\uA75E\uA760\uA762\uA764\uA766\uA768\uA76A\uA76C\uA76E\uA779\uA77B\uA77D\uA77E\uA780\uA782\uA784\uA786\uA78B\uA78D\uA790\uA792\uA796\uA798\uA79A\uA79C\uA79E\uA7A0\uA7A2\uA7A4\uA7A6\uA7A8\uA7AA-\uA7AE\uA7B0-\uA7B4\uA7B6\uA7B8\uA7BA\uA7BC\uA7BE\uA7C0\uA7C2\uA7C4-\uA7C7\uA7C9\uA7CB\uA7CC\uA7D0\uA7D6\uA7D8\uA7DA\uA7DC\uA7F5\uFF21-\uFF3A]|\uD801[\uDC00-\uDC27\uDCB0-\uDCD3\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95]|\uD803[\uDC80-\uDCB2\uDD50-\uDD65]|\uD806[\uDCA0-\uDCBF]|\uD81B[\uDE40-\uDE5F]|\uD835[\uDC00-\uDC19\uDC34-\uDC4D\uDC68-\uDC81\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB5\uDCD0-\uDCE9\uDD04\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD38\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD6C-\uDD85\uDDA0-\uDDB9\uDDD4-\uDDED\uDE08-\uDE21\uDE3C-\uDE55\uDE70-\uDE89\uDEA8-\uDEC0\uDEE2-\uDEFA\uDF1C-\uDF34\uDF56-\uDF6E\uDF90-\uDFA8\uDFCA]|\uD83A[\uDD00-\uDD21]))/g,u=/((?:[0-9A-Z_a-z\xAA\xB2\xB3\xB5\xB9\xBA\xBC-\xBE\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0345\u0363-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05B0-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05EF-\u05F2\u0610-\u061A\u0620-\u0657\u0659-\u0669\u066E-\u06D3\u06D5-\u06DC\u06E1-\u06E8\u06ED-\u06FC\u06FF\u0710-\u073F\u074D-\u07B1\u07C0-\u07EA\u07F4\u07F5\u07FA\u0800-\u0817\u081A-\u082C\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u0897\u08A0-\u08C9\u08D4-\u08DF\u08E3-\u08E9\u08F0-\u093B\u093D-\u094C\u094E-\u0950\u0955-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD-\u09C4\u09C7\u09C8\u09CB\u09CC\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u09F4-\u09F9\u09FC\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3E-\u0A42\u0A47\u0A48\u0A4B\u0A4C\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD-\u0AC5\u0AC7-\u0AC9\u0ACB\u0ACC\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9-\u0AFC\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D-\u0B44\u0B47\u0B48\u0B4B\u0B4C\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71-\u0B77\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCC\u0BD0\u0BD7\u0BE6-\u0BF2\u0C00-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4C\u0C55\u0C56\u0C58-\u0C5A\u0C5D\u0C60-\u0C63\u0C66-\u0C6F\u0C78-\u0C7E\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCC\u0CD5\u0CD6\u0CDD\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1-\u0CF3\u0D00-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D-\u0D44\u0D46-\u0D48\u0D4A-\u0D4C\u0D4E\u0D54-\u0D63\u0D66-\u0D78\u0D7A-\u0D7F\u0D81-\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E46\u0E4D\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F20-\u0F33\u0F40-\u0F47\u0F49-\u0F6C\u0F71-\u0F83\u0F88-\u0F97\u0F99-\u0FBC\u1000-\u1036\u1038\u103B-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1369-\u137C\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u1713\u171F-\u1733\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17B3\u17B6-\u17C8\u17D7\u17DC\u17E0-\u17E9\u17F0-\u17F9\u1810-\u1819\u1820-\u1878\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u1938\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A1B\u1A20-\u1A5E\u1A61-\u1A74\u1A80-\u1A89\u1A90-\u1A99\u1AA7\u1ABF\u1AC0\u1ACC-\u1ACE\u1B00-\u1B33\u1B35-\u1B43\u1B45-\u1B4C\u1B50-\u1B59\u1B80-\u1BA9\u1BAC-\u1BE5\u1BE7-\u1BF1\u1C00-\u1C36\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1DD3-\u1DF4\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2070\u2071\u2074-\u2079\u207F-\u2089\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2189\u2150-\u2182\u2460-\u249B\u24B6-\u24FF\u2776-\u2793\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2CFD\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u3192-\u3195\u31A0-\u31BF\u31F0-\u31FF\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66E\uA674-\uA67B\uA67F-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CD\uA7D0\uA7D1\uA7D3\uA7D5-\uA7DC\uA7F2-\uA805\uA807-\uA827\uA830-\uA835\uA840-\uA873\uA880-\uA8C3\uA8C5\uA8D0-\uA8D9\uA8F2-\uA8F7\uA8FB\uA8FD-\uA92A\uA930-\uA952\uA960-\uA97C\uA980-\uA9B2\uA9B4-\uA9BF\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAABE\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF5\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABEA\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD07-\uDD33\uDD40-\uDD78\uDD8A\uDD8B\uDE80-\uDE9C\uDEA0-\uDED0\uDEE1-\uDEFB\uDF00-\uDF23\uDF2D-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDDC0-\uDDF3\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC58-\uDC76\uDC79-\uDC9E\uDCA7-\uDCAF\uDCE0-\uDCF2\uDCF4\uDCF5\uDCFB-\uDD1B\uDD20-\uDD39\uDD80-\uDDB7\uDDBC-\uDDCF\uDDD2-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE40-\uDE48\uDE60-\uDE7E\uDE80-\uDE9F\uDEC0-\uDEC7\uDEC9-\uDEE4\uDEEB-\uDEEF\uDF00-\uDF35\uDF40-\uDF55\uDF58-\uDF72\uDF78-\uDF91\uDFA9-\uDFAF]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDCFA-\uDD27\uDD30-\uDD39\uDD40-\uDD65\uDD69\uDD6F-\uDD85\uDE60-\uDE7E\uDE80-\uDEA9\uDEAB\uDEAC\uDEB0\uDEB1\uDEC2-\uDEC4\uDEFC\uDF00-\uDF27\uDF30-\uDF45\uDF51-\uDF54\uDF70-\uDF81\uDFB0-\uDFCB\uDFE0-\uDFF6]|\uD804[\uDC00-\uDC45\uDC52-\uDC6F\uDC71-\uDC75\uDC80-\uDCB8\uDCC2\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD32\uDD36-\uDD3F\uDD44-\uDD47\uDD50-\uDD72\uDD76\uDD80-\uDDBF\uDDC1-\uDDC4\uDDCE-\uDDDA\uDDDC\uDDE1-\uDDF4\uDE00-\uDE11\uDE13-\uDE34\uDE37\uDE3E-\uDE41\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEE8\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D-\uDF44\uDF47\uDF48\uDF4B\uDF4C\uDF50\uDF57\uDF5D-\uDF63\uDF80-\uDF89\uDF8B\uDF8E\uDF90-\uDFB5\uDFB7-\uDFC0\uDFC2\uDFC5\uDFC7-\uDFCA\uDFCC\uDFCD\uDFD1\uDFD3]|\uD805[\uDC00-\uDC41\uDC43-\uDC45\uDC47-\uDC4A\uDC50-\uDC59\uDC5F-\uDC61\uDC80-\uDCC1\uDCC4\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDBE\uDDD8-\uDDDD\uDE00-\uDE3E\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB5\uDEB8\uDEC0-\uDEC9\uDED0-\uDEE3\uDF00-\uDF1A\uDF1D-\uDF2A\uDF30-\uDF3B\uDF40-\uDF46]|\uD806[\uDC00-\uDC38\uDCA0-\uDCF2\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD35\uDD37\uDD38\uDD3B\uDD3C\uDD3F-\uDD42\uDD50-\uDD59\uDDA0-\uDDA7\uDDAA-\uDDD7\uDDDA-\uDDDF\uDDE1\uDDE3\uDDE4\uDE00-\uDE32\uDE35-\uDE3E\uDE50-\uDE97\uDE9D\uDEB0-\uDEF8\uDFC0-\uDFE0\uDFF0-\uDFF9]|\uD807[\uDC00-\uDC08\uDC0A-\uDC36\uDC38-\uDC3E\uDC40\uDC50-\uDC6C\uDC72-\uDC8F\uDC92-\uDCA7\uDCA9-\uDCB6\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD36\uDD3A\uDD3C\uDD3D\uDD3F-\uDD41\uDD43\uDD46\uDD47\uDD50-\uDD59\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD8E\uDD90\uDD91\uDD93-\uDD96\uDD98\uDDA0-\uDDA9\uDEE0-\uDEF6\uDF00-\uDF10\uDF12-\uDF3A\uDF3E-\uDF40\uDF50-\uDF59\uDFB0\uDFC0-\uDFD4]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD80E\uD80F\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46\uDC60-\uDFFF]|\uD810[\uDC00-\uDFFA]|\uD811[\uDC00-\uDE46]|\uD818[\uDD00-\uDD2E\uDD30-\uDD39]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDE70-\uDEBE\uDEC0-\uDEC9\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF50-\uDF59\uDF5B-\uDF61\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDD40-\uDD6C\uDD70-\uDD79\uDE40-\uDE96\uDF00-\uDF4A\uDF4F-\uDF87\uDF8F-\uDF9F\uDFE0\uDFE1\uDFE3\uDFF0\uDFF1]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9E]|\uD833[\uDCF0-\uDCF9]|\uD834[\uDEC0-\uDED3\uDEE0-\uDEF3\uDF60-\uDF78]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A\uDC30-\uDC6D\uDC8F\uDD00-\uDD2C\uDD37-\uDD3D\uDD40-\uDD49\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB\uDEF0-\uDEF9]|\uD839[\uDCD0-\uDCEB\uDCF0-\uDCF9\uDDD0-\uDDED\uDDF0-\uDDFA\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDCC7-\uDCCF\uDD00-\uDD43\uDD47\uDD4B\uDD50-\uDD59]|\uD83B[\uDC71-\uDCAB\uDCAD-\uDCAF\uDCB1-\uDCB4\uDD01-\uDD2D\uDD2F-\uDD3D\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD83C[\uDD00-\uDD0C\uDD30-\uDD49\uDD50-\uDD69\uDD70-\uDD89]|\uD83E[\uDFF0-\uDFF9]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])|$)/,s=/[_.\- ]+/,c=new RegExp("^"+s.source),l=new RegExp(s.source+u.source,"gu"),f=new RegExp("\\d+"+u.source,"gu"),p=function(t,e){if("string"!=typeof t&&!Array.isArray(t))throw new TypeError("Expected the input to be `string | string[]`");if(e=function(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?r(Object(o),!0).forEach((function(e){n(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):r(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}({pascalCase:!1,preserveConsecutiveUppercase:!1},e),0===(t=Array.isArray(t)?t.map((function(t){return t.trim()})).filter((function(t){return t.length})).join("-"):t.trim()).length)return"";var u=!1===e.locale?function(t){return t.toLowerCase()}:function(t){return t.toLocaleLowerCase(e.locale)},s=!1===e.locale?function(t){return t.toUpperCase()}:function(t){return t.toLocaleUpperCase(e.locale)};return 1===t.length?e.pascalCase?s(t):u(t):(t!==u(t)&&(t=function(t,e,r){for(var n=!1,a=!1,u=!1,s=0;s<t.length;s++){var c=t[s];n&&o.test(c)?(t=t.slice(0,s)+"-"+t.slice(s),n=!1,u=a,a=!0,s++):a&&u&&i.test(c)?(t=t.slice(0,s-1)+"-"+t.slice(s-1),u=a,a=!1,n=!0):(n=e(c)===c&&r(c)!==c,u=a,a=r(c)===c&&e(c)!==c)}return t}(t,u,s)),t=t.replace(c,""),t=e.preserveConsecutiveUppercase?function(t,e){return a.lastIndex=0,t.replace(a,(function(t){return e(t)}))}(t,u):u(t),e.pascalCase&&(t=s(t.charAt(0))+t.slice(1)),function(t,e){return l.lastIndex=0,f.lastIndex=0,t.replace(l,(function(t,r){return e(r)})).replace(f,(function(t){return e(t)}))}(t,s))};t.exports=p,t.exports.default=p},1013:t=>{"use strict";t.exports=function(t,e){if("string"!=typeof t)throw new TypeError("Expected a string");return e=void 0===e?"_":e,t.replace(/([a-z\d])([A-Z])/g,"$1"+e+"$2").replace(/([A-Z]+)([A-Z][a-z\d]+)/g,"$1"+e+"$2").toLowerCase()}},7551:function(t,e,r){var n,o=r(494);function i(t,e){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},i(t,e)}function a(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(a=function(){return!!t})()}function u(t){return function(t){if(Array.isArray(t))return c(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||s(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){if(t){if("string"==typeof t)return c(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c(t,e):void 0}}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}n=function(){"use strict";var t=Object.entries,e=Object.setPrototypeOf,r=Object.isFrozen,n=Object.getPrototypeOf,o=Object.getOwnPropertyDescriptor,c=Object.freeze,f=Object.seal,p=Object.create,h="undefined"!=typeof Reflect&&Reflect,d=h.apply,y=h.construct;c||(c=function(t){return t}),f||(f=function(t){return t}),d||(d=function(t,e,r){return t.apply(e,r)}),y||(y=function(t,e){return function(t,e,r){if(a())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,e);var o=new(t.bind.apply(t,n));return r&&i(o,r.prototype),o}(t,u(e))});var v,m=A(Array.prototype.forEach),b=A(Array.prototype.pop),g=A(Array.prototype.push),w=A(String.prototype.toLowerCase),x=A(String.prototype.toString),_=A(String.prototype.match),E=A(String.prototype.replace),O=A(String.prototype.indexOf),k=A(String.prototype.trim),j=A(RegExp.prototype.test),S=(v=TypeError,function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return y(v,e)});function A(t){return function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return d(t,e,n)}}function D(t,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:w;e&&e(t,null);for(var i=n.length;i--;){var a=n[i];if("string"==typeof a){var u=o(a);u!==a&&(r(n)||(n[i]=u),a=u)}t[a]=!0}return t}function P(t){for(var e=0;e<t.length;e++)void 0===o(t,e)&&(t[e]=null);return t}function C(e){var r,n,i,a=p(null),u=function(t){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=s(t))){e&&(t=e);var r=0,n=function(){};return{s:n,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,a=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return i=t.done,t},e:function(t){a=!0,o=t},f:function(){try{i||null==e.return||e.return()}finally{if(a)throw o}}}}(t(e));try{for(u.s();!(r=u.n()).done;){var c=(n=r.value,i=2,function(t){if(Array.isArray(t))return t}(n)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],s=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);s=!0);}catch(t){c=!0,o=t}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(n,i)||s(n,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),f=c[0],h=c[1];void 0!==o(e,f)&&(Array.isArray(h)?a[f]=P(h):h&&"object"===l(h)&&h.constructor===Object?a[f]=C(h):a[f]=h)}}catch(t){u.e(t)}finally{u.f()}return a}function L(t,e){for(;null!==t;){var r=o(t,e);if(r){if(r.get)return A(r.get);if("function"==typeof r.value)return A(r.value)}t=n(t)}return function(t){return console.warn("fallback value for",t),null}}var T=c(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),F=c(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),I=c(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),N=c(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),R=c(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),M=c(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),B=c(["#text"]),G=c(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),U=c(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),z=c(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),$=c(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),q=f(/\{\{[\w\W]*|[\w\W]*\}\}/gm),K=f(/<%[\w\W]*|[\w\W]*%>/gm),H=f(/\${[\w\W]*}/gm),Z=f(/^data-[\-\w.\u00B7-\uFFFF]/),Y=f(/^aria-[\-\w]+$/),V=f(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),W=f(/^(?:\w+script|data):/i),J=f(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),X=f(/^html$/i),Q=Object.freeze({__proto__:null,MUSTACHE_EXPR:q,ERB_EXPR:K,TMPLIT_EXPR:H,DATA_ATTR:Z,ARIA_ATTR:Y,IS_ALLOWED_URI:V,IS_SCRIPT_OR_DATA:W,ATTR_WHITESPACE:J,DOCTYPE_NAME:X}),tt=function(){return"undefined"==typeof window?null:window},et=function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:tt(),n=function(t){return e(t)};if(n.version="3.0.8",n.removed=[],!r||!r.document||9!==r.document.nodeType)return n.isSupported=!1,n;var o,i=r.document,a=i,s=a.currentScript,f=r.DocumentFragment,h=r.HTMLTemplateElement,d=r.Node,y=r.Element,v=r.NodeFilter,A=r.NamedNodeMap,P=void 0===A?r.NamedNodeMap||r.MozNamedAttrMap:A,q=r.HTMLFormElement,K=r.DOMParser,H=r.trustedTypes,Z=y.prototype,Y=L(Z,"cloneNode"),W=L(Z,"nextSibling"),J=L(Z,"childNodes"),et=L(Z,"parentNode");if("function"==typeof h){var rt=i.createElement("template");rt.content&&rt.content.ownerDocument&&(i=rt.content.ownerDocument)}var nt="",ot=i,it=ot.implementation,at=ot.createNodeIterator,ut=ot.createDocumentFragment,st=ot.getElementsByTagName,ct=a.importNode,lt={};n.isSupported="function"==typeof t&&"function"==typeof et&&it&&void 0!==it.createHTMLDocument;var ft=Q.MUSTACHE_EXPR,pt=Q.ERB_EXPR,ht=Q.TMPLIT_EXPR,dt=Q.DATA_ATTR,yt=Q.ARIA_ATTR,vt=Q.IS_SCRIPT_OR_DATA,mt=Q.ATTR_WHITESPACE,bt=Q.IS_ALLOWED_URI,gt=null,wt=D({},[].concat(u(T),u(F),u(I),u(R),u(B))),xt=null,_t=D({},[].concat(u(G),u(U),u(z),u($))),Et=Object.seal(p(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Ot=null,kt=null,jt=!0,St=!0,At=!1,Dt=!0,Pt=!1,Ct=!1,Lt=!1,Tt=!1,Ft=!1,It=!1,Nt=!1,Rt=!0,Mt=!1,Bt=!0,Gt=!1,Ut={},zt=null,$t=D({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),qt=null,Kt=D({},["audio","video","img","source","image","track"]),Ht=null,Zt=D({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Yt="http://www.w3.org/1998/Math/MathML",Vt="http://www.w3.org/2000/svg",Wt="http://www.w3.org/1999/xhtml",Jt=Wt,Xt=!1,Qt=null,te=D({},[Yt,Vt,Wt],x),ee=null,re=["application/xhtml+xml","text/html"],ne=null,oe=null,ie=i.createElement("form"),ae=function(t){return t instanceof RegExp||t instanceof Function},ue=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!oe||oe!==t){if(t&&"object"===l(t)||(t={}),t=C(t),ee=-1===re.indexOf(t.PARSER_MEDIA_TYPE)?"text/html":t.PARSER_MEDIA_TYPE,ne="application/xhtml+xml"===ee?x:w,gt="ALLOWED_TAGS"in t?D({},t.ALLOWED_TAGS,ne):wt,xt="ALLOWED_ATTR"in t?D({},t.ALLOWED_ATTR,ne):_t,Qt="ALLOWED_NAMESPACES"in t?D({},t.ALLOWED_NAMESPACES,x):te,Ht="ADD_URI_SAFE_ATTR"in t?D(C(Zt),t.ADD_URI_SAFE_ATTR,ne):Zt,qt="ADD_DATA_URI_TAGS"in t?D(C(Kt),t.ADD_DATA_URI_TAGS,ne):Kt,zt="FORBID_CONTENTS"in t?D({},t.FORBID_CONTENTS,ne):$t,Ot="FORBID_TAGS"in t?D({},t.FORBID_TAGS,ne):{},kt="FORBID_ATTR"in t?D({},t.FORBID_ATTR,ne):{},Ut="USE_PROFILES"in t&&t.USE_PROFILES,jt=!1!==t.ALLOW_ARIA_ATTR,St=!1!==t.ALLOW_DATA_ATTR,At=t.ALLOW_UNKNOWN_PROTOCOLS||!1,Dt=!1!==t.ALLOW_SELF_CLOSE_IN_ATTR,Pt=t.SAFE_FOR_TEMPLATES||!1,Ct=t.WHOLE_DOCUMENT||!1,Ft=t.RETURN_DOM||!1,It=t.RETURN_DOM_FRAGMENT||!1,Nt=t.RETURN_TRUSTED_TYPE||!1,Tt=t.FORCE_BODY||!1,Rt=!1!==t.SANITIZE_DOM,Mt=t.SANITIZE_NAMED_PROPS||!1,Bt=!1!==t.KEEP_CONTENT,Gt=t.IN_PLACE||!1,bt=t.ALLOWED_URI_REGEXP||V,Jt=t.NAMESPACE||Wt,Et=t.CUSTOM_ELEMENT_HANDLING||{},t.CUSTOM_ELEMENT_HANDLING&&ae(t.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Et.tagNameCheck=t.CUSTOM_ELEMENT_HANDLING.tagNameCheck),t.CUSTOM_ELEMENT_HANDLING&&ae(t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Et.attributeNameCheck=t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),t.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(Et.allowCustomizedBuiltInElements=t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Pt&&(St=!1),It&&(Ft=!0),Ut&&(gt=D({},B),xt=[],!0===Ut.html&&(D(gt,T),D(xt,G)),!0===Ut.svg&&(D(gt,F),D(xt,U),D(xt,$)),!0===Ut.svgFilters&&(D(gt,I),D(xt,U),D(xt,$)),!0===Ut.mathMl&&(D(gt,R),D(xt,z),D(xt,$))),t.ADD_TAGS&&(gt===wt&&(gt=C(gt)),D(gt,t.ADD_TAGS,ne)),t.ADD_ATTR&&(xt===_t&&(xt=C(xt)),D(xt,t.ADD_ATTR,ne)),t.ADD_URI_SAFE_ATTR&&D(Ht,t.ADD_URI_SAFE_ATTR,ne),t.FORBID_CONTENTS&&(zt===$t&&(zt=C(zt)),D(zt,t.FORBID_CONTENTS,ne)),Bt&&(gt["#text"]=!0),Ct&&D(gt,["html","head","body"]),gt.table&&(D(gt,["tbody"]),delete Ot.tbody),t.TRUSTED_TYPES_POLICY){if("function"!=typeof t.TRUSTED_TYPES_POLICY.createHTML)throw S('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if("function"!=typeof t.TRUSTED_TYPES_POLICY.createScriptURL)throw S('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');o=t.TRUSTED_TYPES_POLICY,nt=o.createHTML("")}else void 0===o&&(o=function(t,e){if("object"!==l(t)||"function"!=typeof t.createPolicy)return null;var r=null,n="data-tt-policy-suffix";e&&e.hasAttribute(n)&&(r=e.getAttribute(n));var o="dompurify"+(r?"#"+r:"");try{return t.createPolicy(o,{createHTML:function(t){return t},createScriptURL:function(t){return t}})}catch(t){return console.warn("TrustedTypes policy "+o+" could not be created."),null}}(H,s)),null!==o&&"string"==typeof nt&&(nt=o.createHTML(""));c&&c(t),oe=t}},se=D({},["mi","mo","mn","ms","mtext"]),ce=D({},["foreignobject","desc","title","annotation-xml"]),le=D({},["title","style","font","a","script"]),fe=D({},[].concat(u(F),u(I),u(N))),pe=D({},[].concat(u(R),u(M))),he=function(t){g(n.removed,{element:t});try{t.parentNode.removeChild(t)}catch(e){t.remove()}},de=function(t,e){try{g(n.removed,{attribute:e.getAttributeNode(t),from:e})}catch(t){g(n.removed,{attribute:null,from:e})}if(e.removeAttribute(t),"is"===t&&!xt[t])if(Ft||It)try{he(e)}catch(t){}else try{e.setAttribute(t,"")}catch(t){}},ye=function(t){var e=null,r=null;if(Tt)t="<remove></remove>"+t;else{var n=_(t,/^[\r\n\t ]+/);r=n&&n[0]}"application/xhtml+xml"===ee&&Jt===Wt&&(t='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+t+"</body></html>");var a=o?o.createHTML(t):t;if(Jt===Wt)try{e=(new K).parseFromString(a,ee)}catch(t){}if(!e||!e.documentElement){e=it.createDocument(Jt,"template",null);try{e.documentElement.innerHTML=Xt?nt:a}catch(t){}}var u=e.body||e.documentElement;return t&&r&&u.insertBefore(i.createTextNode(r),u.childNodes[0]||null),Jt===Wt?st.call(e,Ct?"html":"body")[0]:Ct?e.documentElement:u},ve=function(t){return at.call(t.ownerDocument||t,t,v.SHOW_ELEMENT|v.SHOW_COMMENT|v.SHOW_TEXT,null)},me=function(t){return"function"==typeof d&&t instanceof d},be=function(t,e,r){lt[t]&&m(lt[t],(function(t){t.call(n,e,r,oe)}))},ge=function(t){var e,r=null;if(be("beforeSanitizeElements",t,null),(e=t)instanceof q&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof P)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore||"function"!=typeof e.hasChildNodes))return he(t),!0;var o=ne(t.nodeName);if(be("uponSanitizeElement",t,{tagName:o,allowedTags:gt}),t.hasChildNodes()&&!me(t.firstElementChild)&&j(/<[/\w]/g,t.innerHTML)&&j(/<[/\w]/g,t.textContent))return he(t),!0;if(!gt[o]||Ot[o]){if(!Ot[o]&&xe(o)){if(Et.tagNameCheck instanceof RegExp&&j(Et.tagNameCheck,o))return!1;if(Et.tagNameCheck instanceof Function&&Et.tagNameCheck(o))return!1}if(Bt&&!zt[o]){var i=et(t)||t.parentNode,a=J(t)||t.childNodes;if(a&&i)for(var u=a.length-1;u>=0;--u)i.insertBefore(Y(a[u],!0),W(t))}return he(t),!0}return t instanceof y&&!function(t){var e=et(t);e&&e.tagName||(e={namespaceURI:Jt,tagName:"template"});var r=w(t.tagName),n=w(e.tagName);return!!Qt[t.namespaceURI]&&(t.namespaceURI===Vt?e.namespaceURI===Wt?"svg"===r:e.namespaceURI===Yt?"svg"===r&&("annotation-xml"===n||se[n]):Boolean(fe[r]):t.namespaceURI===Yt?e.namespaceURI===Wt?"math"===r:e.namespaceURI===Vt?"math"===r&&ce[n]:Boolean(pe[r]):t.namespaceURI===Wt?!(e.namespaceURI===Vt&&!ce[n])&&!(e.namespaceURI===Yt&&!se[n])&&!pe[r]&&(le[r]||!fe[r]):!("application/xhtml+xml"!==ee||!Qt[t.namespaceURI]))}(t)?(he(t),!0):"noscript"!==o&&"noembed"!==o&&"noframes"!==o||!j(/<\/no(script|embed|frames)/i,t.innerHTML)?(Pt&&3===t.nodeType&&(r=t.textContent,m([ft,pt,ht],(function(t){r=E(r,t," ")})),t.textContent!==r&&(g(n.removed,{element:t.cloneNode()}),t.textContent=r)),be("afterSanitizeElements",t,null),!1):(he(t),!0)},we=function(t,e,r){if(Rt&&("id"===e||"name"===e)&&(r in i||r in ie))return!1;if(St&&!kt[e]&&j(dt,e));else if(jt&&j(yt,e));else if(!xt[e]||kt[e]){if(!(xe(t)&&(Et.tagNameCheck instanceof RegExp&&j(Et.tagNameCheck,t)||Et.tagNameCheck instanceof Function&&Et.tagNameCheck(t))&&(Et.attributeNameCheck instanceof RegExp&&j(Et.attributeNameCheck,e)||Et.attributeNameCheck instanceof Function&&Et.attributeNameCheck(e))||"is"===e&&Et.allowCustomizedBuiltInElements&&(Et.tagNameCheck instanceof RegExp&&j(Et.tagNameCheck,r)||Et.tagNameCheck instanceof Function&&Et.tagNameCheck(r))))return!1}else if(Ht[e]);else if(j(bt,E(r,mt,"")));else if("src"!==e&&"xlink:href"!==e&&"href"!==e||"script"===t||0!==O(r,"data:")||!qt[t])if(At&&!j(vt,E(r,mt,"")));else if(r)return!1;return!0},xe=function(t){return t.indexOf("-")>0},_e=function(t){be("beforeSanitizeAttributes",t,null);var e=t.attributes;if(e){for(var r={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:xt},i=e.length,a=function(){var a=e[i],u=a.name,s=a.namespaceURI,c=a.value,f=ne(u),p="value"===u?c:k(c);if(r.attrName=f,r.attrValue=p,r.keepAttr=!0,r.forceKeepAttr=void 0,be("uponSanitizeAttribute",t,r),p=r.attrValue,r.forceKeepAttr)return 0;if(de(u,t),!r.keepAttr)return 0;if(!Dt&&j(/\/>/i,p))return de(u,t),0;Pt&&m([ft,pt,ht],(function(t){p=E(p,t," ")}));var h=ne(t.nodeName);if(!we(h,f,p))return 0;if(!Mt||"id"!==f&&"name"!==f||(de(u,t),p="user-content-"+p),o&&"object"===l(H)&&"function"==typeof H.getAttributeType)if(s);else switch(H.getAttributeType(h,f)){case"TrustedHTML":p=o.createHTML(p);break;case"TrustedScriptURL":p=o.createScriptURL(p)}try{s?t.setAttributeNS(s,u,p):t.setAttribute(u,p),b(n.removed)}catch(t){}};i--;)a();be("afterSanitizeAttributes",t,null)}},Ee=function t(e){var r=null,n=ve(e);for(be("beforeSanitizeShadowDOM",e,null);r=n.nextNode();)be("uponSanitizeShadowNode",r,null),ge(r)||(r.content instanceof f&&t(r.content),_e(r));be("afterSanitizeShadowDOM",e,null)};return n.sanitize=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=null,i=null,u=null,s=null;if((Xt=!t)&&(t="\x3c!--\x3e"),"string"!=typeof t&&!me(t)){if("function"!=typeof t.toString)throw S("toString is not a function");if("string"!=typeof(t=t.toString()))throw S("dirty is not a string, aborting")}if(!n.isSupported)return t;if(Lt||ue(e),n.removed=[],"string"==typeof t&&(Gt=!1),Gt){if(t.nodeName){var c=ne(t.nodeName);if(!gt[c]||Ot[c])throw S("root node is forbidden and cannot be sanitized in-place")}}else if(t instanceof d)1===(i=(r=ye("\x3c!----\x3e")).ownerDocument.importNode(t,!0)).nodeType&&"BODY"===i.nodeName||"HTML"===i.nodeName?r=i:r.appendChild(i);else{if(!Ft&&!Pt&&!Ct&&-1===t.indexOf("<"))return o&&Nt?o.createHTML(t):t;if(!(r=ye(t)))return Ft?null:Nt?nt:""}r&&Tt&&he(r.firstChild);for(var l=ve(Gt?t:r);u=l.nextNode();)ge(u)||(u.content instanceof f&&Ee(u.content),_e(u));if(Gt)return t;if(Ft){if(It)for(s=ut.call(r.ownerDocument);r.firstChild;)s.appendChild(r.firstChild);else s=r;return(xt.shadowroot||xt.shadowrootmode)&&(s=ct.call(a,s,!0)),s}var p=Ct?r.outerHTML:r.innerHTML;return Ct&&gt["!doctype"]&&r.ownerDocument&&r.ownerDocument.doctype&&r.ownerDocument.doctype.name&&j(X,r.ownerDocument.doctype.name)&&(p="<!DOCTYPE "+r.ownerDocument.doctype.name+">\n"+p),Pt&&m([ft,pt,ht],(function(t){p=E(p,t," ")})),o&&Nt?o.createHTML(p):p},n.setConfig=function(){ue(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),Lt=!0},n.clearConfig=function(){oe=null,Lt=!1},n.isValidAttribute=function(t,e,r){oe||ue({});var n=ne(t),o=ne(e);return we(n,o,r)},n.addHook=function(t,e){"function"==typeof e&&(lt[t]=lt[t]||[],g(lt[t],e))},n.removeHook=function(t){if(lt[t])return b(lt[t])},n.removeHooks=function(t){lt[t]&&(lt[t]=[])},n.removeAllHooks=function(){lt={}},n}();return et},"object"===l(e)?t.exports=n():o(n)},2557:t=>{"use strict";var e=Object.prototype.hasOwnProperty,r="~";function n(){}function o(t,e,r){this.fn=t,this.context=e,this.once=r||!1}function i(t,e,n,i,a){if("function"!=typeof n)throw new TypeError("The listener must be a function");var u=new o(n,i||t,a),s=r?r+e:e;return t._events[s]?t._events[s].fn?t._events[s]=[t._events[s],u]:t._events[s].push(u):(t._events[s]=u,t._eventsCount++),t}function a(t,e){0==--t._eventsCount?t._events=new n:delete t._events[e]}function u(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),u.prototype.eventNames=function(){var t,n,o=[];if(0===this._eventsCount)return o;for(n in t=this._events)e.call(t,n)&&o.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(t)):o},u.prototype.listeners=function(t){var e=r?r+t:t,n=this._events[e];if(!n)return[];if(n.fn)return[n.fn];for(var o=0,i=n.length,a=new Array(i);o<i;o++)a[o]=n[o].fn;return a},u.prototype.listenerCount=function(t){var e=r?r+t:t,n=this._events[e];return n?n.fn?1:n.length:0},u.prototype.emit=function(t,e,n,o,i,a){var u=r?r+t:t;if(!this._events[u])return!1;var s,c,l=this._events[u],f=arguments.length;if(l.fn){switch(l.once&&this.removeListener(t,l.fn,void 0,!0),f){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,e),!0;case 3:return l.fn.call(l.context,e,n),!0;case 4:return l.fn.call(l.context,e,n,o),!0;case 5:return l.fn.call(l.context,e,n,o,i),!0;case 6:return l.fn.call(l.context,e,n,o,i,a),!0}for(c=1,s=new Array(f-1);c<f;c++)s[c-1]=arguments[c];l.fn.apply(l.context,s)}else{var p,h=l.length;for(c=0;c<h;c++)switch(l[c].once&&this.removeListener(t,l[c].fn,void 0,!0),f){case 1:l[c].fn.call(l[c].context);break;case 2:l[c].fn.call(l[c].context,e);break;case 3:l[c].fn.call(l[c].context,e,n);break;case 4:l[c].fn.call(l[c].context,e,n,o);break;default:if(!s)for(p=1,s=new Array(f-1);p<f;p++)s[p-1]=arguments[p];l[c].fn.apply(l[c].context,s)}}return!0},u.prototype.on=function(t,e,r){return i(this,t,e,r,!1)},u.prototype.once=function(t,e,r){return i(this,t,e,r,!0)},u.prototype.removeListener=function(t,e,n,o){var i=r?r+t:t;if(!this._events[i])return this;if(!e)return a(this,i),this;var u=this._events[i];if(u.fn)u.fn!==e||o&&!u.once||n&&u.context!==n||a(this,i);else{for(var s=0,c=[],l=u.length;s<l;s++)(u[s].fn!==e||o&&!u[s].once||n&&u[s].context!==n)&&c.push(u[s]);c.length?this._events[i]=1===c.length?c[0]:c:a(this,i)}return this},u.prototype.removeAllListeners=function(t){var e;return t?(e=r?r+t:t,this._events[e]&&a(this,e)):(this._events=new n,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=r,u.EventEmitter=u,t.exports=u},2926:function(t,e,r){var n=r(494),o=function(){var t=function(t,e,r,n){for(r=r||{},n=t.length;n--;r[t[n]]=e);return r},e=[1,8],r=[1,4],n=[2,4],o=[1,11],i=[1,10],a=[2,16],u=[1,14],s=[1,15],c=[1,16],l=[6,8],f=[2,148],p=[1,19],h=[1,20],d=[16,33,35,36,37,38,39,40,41,42,45,46,50,51,54,55,57,58,60,76,79,81,83,84,85,86,88,89,90,103,197],y=[16,18,32,33,35,36,37,38,39,40,41,42,45,46,50,51,54,55,57,58,60,76,79,81,83,84,85,86,88,89,90,103,197],v=[2,162],m=[1,29],b=[6,8,14,17,148,152,154,156],g=[1,42],w=[1,62],x=[1,53],_=[1,61],E=[1,63],O=[1,64],k=[1,65],j=[1,66],S=[1,67],A=[1,59],D=[1,60],P=[1,54],C=[1,55],L=[1,56],T=[1,57],F=[1,58],I=[1,43],N=[1,44],R=[1,45],M=[1,34],B=[1,68],G=[16,35,36,37,38,39,40,41,42,45,46,50,51,54,55,57,58,60,76,79,81,83,84,85,86,88,89,90,103,197],U=[6,8,14,17,152,154,156],z=[2,145],$=[1,77],q=[1,78],K=[6,8,14,17,43,135,140,146,148,152,154,156],H=[1,83],Z=[1,80],Y=[1,81],V=[1,82],W=[1,84],J=[6,8,14,17,36,43,49,50,51,71,72,74,77,91,109,126,127,128,129,131,135,137,140,143,144,146,148,152,154,156,159,166,167,169,170,175,179,181,182,184],X=[6,8,14,17,34,36,43,49,50,51,71,72,74,77,91,109,114,115,116,117,118,119,123,126,127,128,129,131,135,137,140,143,144,146,148,152,154,156,159,166,167,169,170,175,179,181,182,184],Q=[1,105],tt=[1,103],et=[1,104],rt=[1,99],nt=[1,100],ot=[1,101],it=[1,102],at=[1,106],ut=[1,107],st=[1,108],ct=[1,109],lt=[1,110],ft=[1,111],pt=[2,105],ht=[6,8,14,17,34,36,43,45,49,50,51,71,72,74,77,81,83,91,93,94,95,96,97,98,99,100,101,103,107,108,109,110,111,112,114,115,116,117,118,119,123,126,127,128,129,131,135,137,140,143,144,146,148,152,154,156,159,166,167,169,170,175,179,181,182,184],dt=[6,8,14,17,34,36,43,45,49,50,51,71,72,74,77,81,83,91,93,94,95,96,97,98,99,100,101,103,105,107,108,109,110,111,112,114,115,116,117,118,119,123,126,127,128,129,131,135,137,140,143,144,146,148,152,154,156,159,166,167,169,170,175,179,181,182,184],yt=[1,112],vt=[1,119],mt=[2,64],bt=[1,120],gt=[16,35,37,38,39,40,41,42,45,46,50,51,54,55,57,58,60,76,79,81,83,84,85,86,88,89,90,103,197],wt=[16,29,35,50,51,54,55,57,58,60,76,79,81,83,84,85,86,88,89,90,121,197],xt=[1,167],_t=[17,43],Et=[2,59],Ot=[1,176],kt=[1,174],jt=[1,175],St=[6,8,140,148],At=[16,35,38,39,40,41,42,45,46,50,51,54,55,57,58,60,76,79,81,83,84,85,86,88,89,90,103,197],Dt=[6,8,14,17,140,146,148,152,154,156],Pt=[6,8,14,17,36,43,49,50,51,71,72,74,77,91,127,128,129,131,135,137,140,143,144,146,148,152,154,156,159,166,167,169,170,175,179,181,182,184],Ct=[6,8,14,17,34,36,43,49,50,51,71,72,74,77,91,93,94,95,96,101,103,107,108,109,110,111,112,114,115,116,117,118,119,123,126,127,128,129,131,135,137,140,143,144,146,148,152,154,156,159,166,167,169,170,175,179,181,182,184],Lt=[6,8,14,17,34,36,43,49,50,51,71,72,74,77,81,83,91,93,94,95,96,101,103,107,108,109,110,111,112,114,115,116,117,118,119,123,126,127,128,129,131,135,137,140,143,144,146,148,152,154,156,159,166,167,169,170,175,179,181,182,184],Tt=[16,35,39,40,41,42,45,46,50,51,54,55,57,58,60,76,79,81,83,84,85,86,88,89,90,103,197],Ft=[16,35,40,41,42,45,46,50,51,54,55,57,58,60,76,79,81,83,84,85,86,88,89,90,103,197],It=[16,35,42,45,46,50,51,54,55,57,58,60,76,79,81,83,84,85,86,88,89,90,103,197],Nt=[71,74,77],Rt=[16,35,45,46,50,51,54,55,57,58,60,76,79,81,83,84,85,86,88,89,90,103,197],Mt=[1,240],Bt=[1,241],Gt=[6,8,14,17],Ut=[6,8,14,17,43,159],zt=[1,258],$t=[1,254],qt=[2,199],Kt=[1,262],Ht=[1,263],Zt=[6,8,14,17,43,131,137,140,146,148,152,154,156,184],Yt=[1,265],Vt=[1,268],Wt=[1,269],Jt=[1,270],Xt=[1,271],Qt=[2,176],te=[1,267],ee=[6,8,14,17,36,43,91,131,137,140,146,148,152,154,156,166,167,169,170,175,179,181,182,184],re=[6,8,14,17,137,140,146,148,152,154,156],ne=[1,283],oe=[2,181],ie=[172,175],ae=[6,8,14,17,36,43,91,131,137,140,146,148,152,154,156,166,167,169,170,175,179,181,182,184,194,195,196],ue=[2,201],se=[1,288],ce=[1,300],le=[1,308],fe=[1,309],pe=[1,310],he=[6,8,14,17,140,148,152,154,156],de=[1,320],ye=[1,326],ve=[1,327],me=[2,206],be=[1,338],ge=[16,154],we=[6,8,14,17,154,156],xe=[1,354],_e={trace:function(){},yy:{},symbols_:{error:2,main:3,selectClause:4,semicolonOpt:5,EOF:6,unionClause:7,";":8,unionClauseNotParenthesized:9,unionClauseParenthesized:10,order_by_opt:11,limit_opt:12,selectClauseParenthesized:13,UNION:14,distinctOpt:15,"(":16,")":17,SELECT:18,highPriorityOpt:19,maxStateMentTimeOpt:20,straightJoinOpt:21,sqlSmallResultOpt:22,sqlBigResultOpt:23,sqlBufferResultOpt:24,sqlCacheOpt:25,sqlCalcFoundRowsOpt:26,selectExprList:27,selectDataSetOpt:28,ALL:29,DISTINCT:30,DISTINCTROW:31,HIGH_PRIORITY:32,MAX_STATEMENT_TIME:33,"=":34,NUMERIC:35,STRAIGHT_JOIN:36,SQL_SMALL_RESULT:37,SQL_BIG_RESULT:38,SQL_BUFFER_RESULT:39,SQL_CACHE:40,SQL_NO_CACHE:41,SQL_CALC_FOUND_ROWS:42,",":43,selectExpr:44,"*":45,SELECT_EXPR_STAR:46,expr:47,selectExprAliasOpt:48,AS:49,IDENTIFIER:50,STRING:51,string:52,number:53,EXPONENT_NUMERIC:54,HEX_NUMERIC:55,boolean:56,TRUE:57,FALSE:58,null:59,NULL:60,literal:61,place_holder:62,function_call:63,function_call_param_list:64,function_call_param:65,identifier:66,DOT:67,identifier_list:68,case_expr_opt:69,when_then_list:70,WHEN:71,THEN:72,case_when_else:73,ELSE:74,case_when:75,CASE:76,END:77,cast:78,CAST:79,simple_expr_prefix:80,"+":81,simple_expr:82,"-":83,"~":84,"!":85,BINARY:86,expr_list:87,ROW:88,EXISTS:89,"{":90,"}":91,bit_expr:92,"|":93,"&":94,"<<":95,">>":96,"/":97,DIV:98,MOD:99,"%":100,"^":101,not_opt:102,NOT:103,escape_opt:104,ESCAPE:105,predicate:106,IN:107,BETWEEN:108,AND:109,SOUNDS:110,LIKE:111,REGEXP:112,comparison_operator:113,">=":114,">":115,"<=":116,"<":117,"<>":118,"!=":119,sub_query_data_set_opt:120,ANY:121,boolean_primary:122,IS:123,boolean_extra:124,UNKNOWN:125,"&&":126,"||":127,OR:128,XOR:129,where_opt:130,WHERE:131,group_by_opt:132,group_by:133,roll_up_opt:134,WITH:135,ROLLUP:136,GROUP_BY:137,group_by_order_by_item_list:138,order_by:139,ORDER_BY:140,group_by_order_by_item:141,sort_opt:142,ASC:143,DESC:144,having_opt:145,HAVING:146,limit:147,LIMIT:148,OFFSET:149,procedure_opt:150,procedure:151,PROCEDURE:152,for_update_lock_in_share_mode_opt:153,FOR:154,UPDATE:155,LOCK:156,SHARE:157,MODE:158,FROM:159,table_references:160,partitionOpt:161,escaped_table_reference:162,table_reference:163,OJ:164,join_inner_cross:165,INNER:166,CROSS:167,left_right:168,LEFT:169,RIGHT:170,out_opt:171,OUTER:172,left_right_out_opt:173,join_table:174,JOIN:175,table_factor:176,join_condition:177,on_join_condition:178,NATURAL:179,join_condition_opt:180,ON:181,USING:182,partition_names:183,PARTITION:184,aliasOpt:185,index_or_key:186,INDEX:187,KEY:188,for_opt:189,identifier_list_opt:190,index_hint_list_opt:191,index_hint_list:192,index_hint:193,USE:194,IGNORE:195,FORCE:196,PLACE_HOLDER:197,$accept:0,$end:1},terminals_:{2:"error",6:"EOF",8:";",14:"UNION",16:"(",17:")",18:"SELECT",29:"ALL",30:"DISTINCT",31:"DISTINCTROW",32:"HIGH_PRIORITY",33:"MAX_STATEMENT_TIME",34:"=",35:"NUMERIC",36:"STRAIGHT_JOIN",37:"SQL_SMALL_RESULT",38:"SQL_BIG_RESULT",39:"SQL_BUFFER_RESULT",40:"SQL_CACHE",41:"SQL_NO_CACHE",42:"SQL_CALC_FOUND_ROWS",43:",",45:"*",46:"SELECT_EXPR_STAR",49:"AS",50:"IDENTIFIER",51:"STRING",54:"EXPONENT_NUMERIC",55:"HEX_NUMERIC",57:"TRUE",58:"FALSE",60:"NULL",67:"DOT",71:"WHEN",72:"THEN",74:"ELSE",76:"CASE",77:"END",79:"CAST",81:"+",83:"-",84:"~",85:"!",86:"BINARY",88:"ROW",89:"EXISTS",90:"{",91:"}",93:"|",94:"&",95:"<<",96:">>",97:"/",98:"DIV",99:"MOD",100:"%",101:"^",103:"NOT",105:"ESCAPE",107:"IN",108:"BETWEEN",109:"AND",110:"SOUNDS",111:"LIKE",112:"REGEXP",114:">=",115:">",116:"<=",117:"<",118:"<>",119:"!=",121:"ANY",123:"IS",125:"UNKNOWN",126:"&&",127:"||",128:"OR",129:"XOR",131:"WHERE",135:"WITH",136:"ROLLUP",137:"GROUP_BY",140:"ORDER_BY",143:"ASC",144:"DESC",146:"HAVING",148:"LIMIT",149:"OFFSET",152:"PROCEDURE",154:"FOR",155:"UPDATE",156:"LOCK",157:"SHARE",158:"MODE",159:"FROM",164:"OJ",166:"INNER",167:"CROSS",169:"LEFT",170:"RIGHT",172:"OUTER",175:"JOIN",179:"NATURAL",181:"ON",182:"USING",184:"PARTITION",187:"INDEX",188:"KEY",194:"USE",195:"IGNORE",196:"FORCE",197:"PLACE_HOLDER"},productions_:[0,[3,3],[3,3],[5,1],[5,0],[7,1],[7,3],[10,4],[10,4],[13,3],[9,4],[9,4],[4,12],[15,1],[15,1],[15,1],[15,0],[19,1],[19,0],[20,3],[20,0],[21,1],[21,0],[22,1],[22,0],[23,1],[23,0],[24,1],[24,0],[25,0],[25,1],[25,1],[26,1],[26,0],[27,3],[27,1],[44,1],[44,1],[44,2],[48,0],[48,2],[48,1],[48,2],[48,1],[52,1],[53,1],[53,1],[53,1],[56,1],[56,1],[59,1],[61,1],[61,1],[61,1],[61,1],[61,1],[63,4],[64,3],[64,1],[65,0],[65,1],[65,1],[65,2],[65,1],[66,1],[66,3],[68,1],[68,3],[69,0],[69,1],[70,4],[70,5],[73,0],[73,2],[75,5],[78,6],[80,2],[80,2],[80,2],[80,2],[80,2],[82,1],[82,1],[82,1],[82,1],[82,3],[82,4],[82,3],[82,4],[82,4],[82,1],[82,1],[92,1],[92,3],[92,3],[92,3],[92,3],[92,3],[92,3],[92,3],[92,3],[92,3],[92,3],[92,3],[92,3],[102,0],[102,1],[104,0],[104,2],[106,1],[106,6],[106,6],[106,6],[106,4],[106,5],[106,4],[113,1],[113,1],[113,1],[113,1],[113,1],[113,1],[113,1],[120,1],[120,1],[122,1],[122,4],[122,3],[122,6],[124,1],[124,1],[47,1],[47,4],[47,2],[47,3],[47,3],[47,3],[47,3],[47,3],[87,1],[87,3],[130,0],[130,2],[132,0],[132,1],[134,0],[134,2],[133,3],[11,0],[11,1],[139,3],[138,1],[138,3],[141,2],[142,0],[142,1],[142,1],[145,0],[145,2],[147,2],[147,4],[147,4],[12,0],[12,1],[150,0],[150,1],[151,2],[153,0],[153,2],[153,4],[28,0],[28,10],[160,1],[160,3],[162,1],[162,4],[165,0],[165,1],[165,1],[168,1],[168,1],[171,0],[171,1],[173,0],[173,2],[174,4],[174,5],[174,4],[174,6],[174,5],[180,0],[180,1],[178,2],[177,1],[177,4],[163,1],[163,1],[183,1],[183,3],[161,0],[161,4],[185,0],[185,2],[185,1],[186,1],[186,1],[189,0],[189,2],[189,2],[189,2],[190,0],[190,1],[191,0],[191,1],[192,1],[192,3],[193,6],[193,6],[193,6],[176,4],[176,4],[176,3],[62,1]],performAction:function(t,e,r,n,o,i,a){var u=i.length-1;switch(o){case 1:case 2:return{nodeType:"Main",value:i[u-2],hasSemicolon:i[u-1]};case 3:case 146:this.$=!0;break;case 4:this.$=!1;break;case 5:case 13:case 14:case 15:case 17:case 19:case 21:case 23:case 25:case 27:case 30:case 31:case 32:case 51:case 52:case 53:case 54:case 55:case 60:case 61:case 63:case 69:case 73:case 81:case 82:case 83:case 84:case 90:case 91:case 92:case 106:case 108:case 109:case 116:case 117:case 118:case 119:case 120:case 121:case 122:case 123:case 124:case 125:case 129:case 131:case 142:case 144:case 149:case 155:case 156:case 158:case 163:case 165:case 166:case 177:case 178:case 179:case 180:case 182:case 191:case 193:case 195:case 196:case 204:case 205:case 211:case 213:this.$=i[u];break;case 6:this.$=i[u-2],this.$.orderBy=i[u-1],this.$.limit=i[u];break;case 7:case 8:case 10:case 11:this.$={type:"Union",left:i[u-3],distinctOpt:i[u-1],right:i[u]};break;case 9:this.$={type:"SelectParenthesized",value:i[u-1]};break;case 12:this.$={type:"Select",distinctOpt:i[u-10],highPriorityOpt:i[u-9],maxStateMentTimeOpt:i[u-8],straightJoinOpt:i[u-7],sqlSmallResultOpt:i[u-6],sqlBigResultOpt:i[u-5],sqlBufferResultOpt:i[u-4],sqlCacheOpt:i[u-3],sqlCalcFoundRowsOpt:i[u-2],selectItems:i[u-1],from:i[u].from,partition:i[u].partition,where:i[u].where,groupBy:i[u].groupBy,having:i[u].having,orderBy:i[u].orderBy,limit:i[u].limit,procedure:i[u].procedure,updateLockMode:i[u].updateLockMode};break;case 16:case 18:case 20:case 22:case 24:case 26:case 28:case 29:case 33:case 59:case 68:case 72:case 105:case 107:case 141:case 143:case 145:case 148:case 154:case 157:case 162:case 164:case 167:case 176:case 181:case 190:case 199:case 206:case 210:case 212:this.$=null;break;case 34:i[u-2].value.push(i[u]);break;case 35:this.$={type:"SelectExpr",value:[i[u]]};break;case 36:case 37:case 64:this.$={type:"Identifier",value:i[u]};break;case 38:this.$=i[u-1],this.$.alias=i[u].alias,this.$.hasAs=i[u].hasAs;break;case 39:case 201:this.$={alias:null,hasAs:null};break;case 40:case 42:this.$={alias:i[u],hasAs:!0};break;case 41:this.$={alias:i[u],hasAs:!1};break;case 43:this.$={alias:i[$01],hasAs:!1};break;case 44:this.$={type:"String",value:i[u]};break;case 45:case 46:case 47:this.$={type:"Number",value:i[u]};break;case 48:this.$={type:"Boolean",value:"TRUE"};break;case 49:this.$={type:"Boolean",value:"FALSE"};break;case 50:this.$={type:"Null",value:"null"};break;case 56:this.$={type:"FunctionCall",name:i[u-3],params:i[u-1]};break;case 57:i[u-2].push(i[u]),this.$=i[u-2];break;case 58:case 151:case 197:this.$=[i[u]];break;case 62:this.$={type:"FunctionCallParam",distinctOpt:i[u-1],value:i[u]};break;case 65:this.$=i[u-2],i[u-2].value+="."+i[u];break;case 66:this.$={type:"IdentifierList",value:[i[u]]};break;case 67:case 173:this.$=i[u-2],i[u-2].value.push(i[u]);break;case 70:this.$={type:"WhenThenList",value:[{when:i[u-2],then:i[u]}]};break;case 71:this.$=i[u-4],this.$.value.push({when:i[u-2],then:i[u]});break;case 74:this.$={type:"CaseWhen",caseExprOpt:i[u-3],whenThenList:i[u-2],else:i[u-1]};break;case 75:this.$={type:"Cast",expr:i[u-3],castTo:i[u-1]};break;case 76:case 77:case 78:case 79:case 80:this.$={type:"Prefix",prefix:i[u-1],value:i[u]};break;case 85:this.$={type:"SimpleExprParentheses",value:i[u-1]};break;case 86:this.$={type:"SimpleExprParentheses",value:i[u-2],hasRow:!0};break;case 87:this.$={type:"SubQuery",value:i[u-1]};break;case 88:this.$={type:"SubQuery",value:i[u-1],hasExists:!0};break;case 89:this.$={type:"IdentifierExpr",identifier:i[u-2],value:i[u-1]};break;case 93:this.$={type:"BitExpression",operator:"|",left:i[u-2],right:i[u]};break;case 94:this.$={type:"BitExpression",operator:"&",left:i[u-2],right:i[u]};break;case 95:this.$={type:"BitExpression",operator:"<<",left:i[u-2],right:i[u]};break;case 96:this.$={type:"BitExpression",operator:">>",left:i[u-2],right:i[u]};break;case 97:this.$={type:"BitExpression",operator:"+",left:i[u-2],right:i[u]};break;case 98:this.$={type:"BitExpression",operator:"-",left:i[u-2],right:i[u]};break;case 99:this.$={type:"BitExpression",operator:"*",left:i[u-2],right:i[u]};break;case 100:this.$={type:"BitExpression",operator:"/",left:i[u-2],right:i[u]};break;case 101:this.$={type:"BitExpression",operator:"DIV",left:i[u-2],right:i[u]};break;case 102:this.$={type:"BitExpression",operator:"MOD",left:i[u-2],right:i[u]};break;case 103:this.$={type:"BitExpression",operator:"%",left:i[u-2],right:i[u]};break;case 104:this.$={type:"BitExpression",operator:"^",left:i[u-2],right:i[u]};break;case 110:this.$={type:"InSubQueryPredicate",hasNot:i[u-4],left:i[u-5],right:i[u-1]};break;case 111:this.$={type:"InExpressionListPredicate",hasNot:i[u-4],left:i[u-5],right:i[u-1]};break;case 112:this.$={type:"BetweenPredicate",hasNot:i[u-4],left:i[u-5],right:{left:i[u-2],right:i[u]}};break;case 113:this.$={type:"SoundsLikePredicate",hasNot:!1,left:i[u-3],right:i[u]};break;case 114:this.$={type:"LikePredicate",hasNot:i[u-3],left:i[u-4],right:i[u-1],escape:i[u]};break;case 115:this.$={type:"RegexpPredicate",hasNot:i[u-2],left:i[u-3],right:i[u]};break;case 126:this.$={type:"IsNullBooleanPrimary",hasNot:i[u-1],value:i[u-3]};break;case 127:this.$={type:"ComparisonBooleanPrimary",left:i[u-2],operator:i[u-1],right:i[u]};break;case 128:this.$={type:"ComparisonSubQueryBooleanPrimary",operator:i[u-4],subQueryOpt:i[u-3],left:i[u-5],right:i[u-1]};break;case 130:this.$={type:"BooleanExtra",value:i[u]};break;case 132:this.$={type:"IsExpression",hasNot:i[u-1],left:i[u-3],right:i[u]};break;case 133:this.$={type:"NotExpression",value:i[u]};break;case 134:case 137:this.$={type:"AndExpression",operator:i[u-1],left:i[u-2],right:i[u]};break;case 135:case 136:this.$={type:"OrExpression",operator:i[u-1],left:i[u-2],right:i[u]};break;case 138:this.$={type:"XORExpression",left:i[u-2],right:i[u]};break;case 139:this.$={type:"ExpressionList",value:[i[u]]};break;case 140:case 215:this.$=i[u-2],this.$.value.push(i[u]);break;case 147:this.$={type:"GroupBy",value:i[u-1],rollUp:i[u]};break;case 150:this.$={type:"OrderBy",value:i[u-1],rollUp:i[u]};break;case 152:case 198:this.$=i[u-2],i[u-2].push(i[u]);break;case 153:this.$={type:"GroupByOrderByItem",value:i[u-1],sortOpt:i[u]};break;case 159:this.$={type:"Limit",value:[i[u]]};break;case 160:this.$={type:"Limit",value:[i[u-2],i[u]]};break;case 161:this.$={type:"Limit",value:[i[u],i[u-2]],offsetMode:!0};break;case 168:this.$=i[u-1]+" "+i[u];break;case 169:this.$=i[u-3]+" "+i[u-2]+" "+i[u-1]+" "+i[u];break;case 170:this.$={};break;case 171:this.$={from:i[u-8],partition:i[u-7],where:i[u-6],groupBy:i[u-5],having:i[u-4],orderBy:i[u-3],limit:i[u-2],procedure:i[u-1],updateLockMode:i[u]};break;case 172:this.$={type:"TableReferences",value:[i[u]]};break;case 174:this.$={type:"TableReference",value:i[u]};break;case 175:this.$={type:"TableReference",hasOj:!0,value:i[u-1]};break;case 183:this.$={leftRight:null,outOpt:null};break;case 184:this.$={leftRight:i[u-1],outOpt:i[u]};break;case 185:this.$={type:"InnerCrossJoinTable",innerCrossOpt:i[u-2],left:i[u-3],right:i[u],condition:null};break;case 186:this.$={type:"InnerCrossJoinTable",innerCrossOpt:i[u-3],left:i[u-4],right:i[u-1],condition:i[u]};break;case 187:this.$={type:"StraightJoinTable",left:i[u-3],right:i[u-1],condition:i[u]};break;case 188:this.$={type:"LeftRightJoinTable",leftRight:i[u-4],outOpt:i[u-3],left:i[u-5],right:i[u-1],condition:i[u]};break;case 189:this.$={type:"NaturalJoinTable",leftRight:i[u-2].leftRight,outOpt:i[u-2].outOpt,left:i[u-4],right:i[u]};break;case 192:this.$={type:"OnJoinCondition",value:i[u]};break;case 194:this.$={type:"UsingJoinCondition",value:i[u-1]};break;case 200:this.$={type:"Partitions",value:i[u-1]};break;case 202:this.$={hasAs:!0,alias:i[u]};break;case 203:this.$={hasAs:!1,alias:i[u]};break;case 207:case 208:case 209:this.$={type:"ForOptIndexHint",value:i[u]};break;case 214:this.$={type:"IndexHintList",value:[i[u]]};break;case 216:this.$={type:"UseIndexHint",value:i[u-1],forOpt:i[u-3],indexOrKey:i[u-4]};break;case 217:this.$={type:"IgnoreIndexHint",value:i[u-1],forOpt:i[u-3],indexOrKey:i[u-4]};break;case 218:this.$={type:"ForceIndexHint",value:i[u-1],forOpt:i[u-3],indexOrKey:i[u-4]};break;case 219:this.$={type:"TableFactor",value:i[u-3],partition:i[u-2],alias:i[u-1].alias,hasAs:i[u-1].hasAs,indexHintOpt:i[u]};break;case 220:this.$={type:"TableFactor",value:{type:"SubQuery",value:i[u-2]},alias:i[u].alias,hasAs:i[u].hasAs};break;case 221:this.$=i[u-1],this.$.hasParentheses=!0;break;case 222:this.$={type:"PlaceHolder",value:i[u],param:i[u].slice(2,-1)}}},table:[{3:1,4:2,7:3,9:5,10:6,13:7,16:e,18:r},{1:[3]},{5:9,6:n,8:o,14:i},{5:12,6:n,8:o},t([16,32,33,35,36,37,38,39,40,41,42,45,46,50,51,54,55,57,58,60,76,79,81,83,84,85,86,88,89,90,103,197],a,{15:13,29:u,30:s,31:c}),t(l,[2,5]),t([6,8,148],f,{11:17,139:18,140:p}),{14:h},{4:21,18:r},{6:[1,22]},{15:23,18:a,29:u,30:s,31:c},{6:[2,3]},{6:[1,24]},t(d,[2,18],{19:25,32:[1,26]}),t(y,[2,13]),t(y,[2,14]),t(y,[2,15]),t(l,v,{12:27,147:28,148:m}),t(b,[2,149]),{16:g,35:w,47:32,50:x,51:_,52:48,53:49,54:E,55:O,56:50,57:k,58:j,59:51,60:S,61:38,62:52,63:40,66:39,75:46,76:A,78:47,79:D,80:41,81:P,82:37,83:C,84:L,85:T,86:F,88:I,89:N,90:R,92:36,103:M,106:35,122:33,138:30,141:31,197:B},{15:69,16:a,29:u,30:s,31:c},{17:[1,70]},{1:[2,1]},{4:71,9:72,18:r},{1:[2,2]},t(G,[2,20],{20:73,33:[1,74]}),t(d,[2,17]),t(l,[2,6]),t(U,[2,163]),{35:[1,75]},t(b,z,{134:76,43:$,135:q}),t(K,[2,151]),t(K,[2,154],{142:79,109:H,126:Z,127:Y,128:V,129:W,143:[1,85],144:[1,86]}),t(J,[2,131],{113:88,34:[1,89],114:[1,90],115:[1,91],116:[1,92],117:[1,93],118:[1,94],119:[1,95],123:[1,87]}),{16:g,35:w,47:96,50:x,51:_,52:48,53:49,54:E,55:O,56:50,57:k,58:j,59:51,60:S,61:38,62:52,63:40,66:39,75:46,76:A,78:47,79:D,80:41,81:P,82:37,83:C,84:L,85:T,86:F,88:I,89:N,90:R,92:36,103:M,106:35,122:33,197:B},t(X,[2,125]),t(X,[2,109],{102:97,45:Q,81:tt,83:et,93:rt,94:nt,95:ot,96:it,97:at,98:ut,99:st,100:ct,101:lt,103:ft,107:pt,108:pt,111:pt,112:pt,110:[1,98]}),t(ht,[2,92]),t(dt,[2,81]),t(dt,[2,82],{67:yt}),t(dt,[2,83]),t(dt,[2,84]),{4:114,16:g,18:r,35:w,47:115,50:x,51:_,52:48,53:49,54:E,55:O,56:50,57:k,58:j,59:51,60:S,61:38,62:52,63:40,66:39,75:46,76:A,78:47,79:D,80:41,81:P,82:37,83:C,84:L,85:T,86:F,87:113,88:I,89:N,90:R,92:36,103:M,106:35,122:33,197:B},{16:[1,116]},{16:[1,117]},{50:vt,66:118},t(dt,[2,90]),t(dt,[2,91]),t(dt,[2,51]),t(dt,[2,52]),t(dt,[2,53]),t(dt,[2,54]),t(dt,[2,55]),t([6,8,14,17,34,36,43,45,49,50,51,67,71,72,74,77,81,83,91,93,94,95,96,97,98,99,100,101,103,105,107,108,109,110,111,112,114,115,116,117,118,119,123,126,127,128,129,131,135,137,140,143,144,146,148,152,154,156,159,166,167,169,170,175,179,181,182,184],mt,{16:bt}),{16:g,35:w,50:x,51:_,52:48,53:49,54:E,55:O,56:50,57:k,58:j,59:51,60:S,61:38,62:52,63:40,66:39,75:46,76:A,78:47,79:D,80:41,81:P,82:121,83:C,84:L,85:T,86:F,88:I,89:N,90:R,197:B},{16:g,35:w,50:x,51:_,52:48,53:49,54:E,55:O,56:50,57:k,58:j,59:51,60:S,61:38,62:52,63:40,66:39,75:46,76:A,78:47,79:D,80:41,81:P,82:122,83:C,84:L,85:T,86:F,88:I,89:N,90:R,197:B},{16:g,35:w,50:x,51:_,52:48,53:49,54:E,55:O,56:50,57:k,58:j,59:51,60:S,61:38,62:52,63:40,66:39,75:46,76:A,78:47,79:D,80:41,81:P,82:123,83:C,84:L,85:T,86:F,88:I,89:N,90:R,197:B},{16:g,35:w,50:x,51:_,52:48,53:49,54:E,55:O,56:50,57:k,58:j,59:51,60:S,61:38,62:52,63:40,66:39,75:46,76:A,78:47,79:D,80:41,81:P,82:124,83:C,84:L,85:T,86:F,88:I,89:N,90:R,197:B},{16:g,35:w,50:x,51:_,52:48,53:49,54:E,55:O,56:50,57:k,58:j,59:51,60:S,61:38,62:52,63:40,66:39,75:46,76:A,78:47,79:D,80:41,81:P,82:125,83:C,84:L,85:T,86:F,88:I,89:N,90:R,197:B},{16:g,35:w,47:127,50:x,51:_,52:48,53:49,54:E,55:O,56:50,57:k,58:j,59:51,60:S,61:38,62:52,63:40,66:39,69:126,71:[2,68],75:46,76:A,78:47,79:D,80:41,81:P,82:37,83:C,84:L,85:T,86:F,88:I,89:N,90:R,92:36,103:M,106:35,122:33,197:B},{16:[1,128]},t(dt,[2,44]),t(dt,[2,45]),t(dt,[2,46]),t(dt,[2,47]),t(dt,[2,48]),t(dt,[2,49]),t(dt,[2,50]),t(dt,[2,222]),{10:130,13:129,16:e},t([6,8,14,140,148],[2,9]),t(l,[2,10],{14:i}),t(l,[2,11]),t(gt,[2,22],{21:131,36:[1,132]}),{34:[1,133]},t(U,[2,159],{43:[1,134],149:[1,135]}),t(b,[2,150]),{16:g,35:w,47:32,50:x,51:_,52:48,53:49,54:E,55:O,56:50,57:k,58:j,59:51,60:S,61:38,62:52,63:40,66:39,75:46,76:A,78:47,79:D,80:41,81:P,82:37,83:C,84:L,85:T,86:F,88:I,89:N,90:R,92:36,103:M,106:35,122:33,141:136,197:B},{136:[1,137]},t(K,[2,153]),{16:g,35:w,47:138,50:x,51:_,52:48,53:49,54:E,55:O,56:50,57:k,58:j,59:51,60:S,61:38,62:52,63:40,66:39,75:46,76:A,78:47,79:D,80:41,81:P,82:37,83:C,84:L,85:T,86:F,88:I,89:N,90:R,92:36,103:M,106:35,122:33,197:B},{16:g,35:w,47:139,50:x,51:_,52:48,53:49,54:E,55:O,56:50,57:k,58:j,59:51,60:S,61:38,62:52,63:40,66:39,75:46,76:A,78:47,79:D,80:41,81:P,82:37,83:C,84:L,85:T,86:F,88:I,89:N,90:R,92:36,103:M,106:35,122:33,197:B},{16:g,35:w,47:140,50:x,51:_,52:48,53:49,54:E,55:O,56:50,57:k,58:j,59:51,60:S,61:38,62:52,63:40,66:39,75:46,76:A,78:47,79:D,80:41,81:P,82:37,83:C,84:L,85:T,86:F,88:I,89:N,90:R,92:36,103:M,106:35,122:33,197:B},{16:g,35:w,47:141,50:x,51:_,52:48,53:49,54:E,55:O,56:50,57:k,58:j,59:51,60:S,61:38,62:52,63:40,66:39,75:46,76:A,78:47,79:D,80:41,81:P,82:37,83:C,84:L,85:T,86:F,88:I,89:N,90:R,92:36,103:M,106:35,122:33,197:B},{16:g,35:w,47:142,50:x,51:_,52:48,53:49,54:E,55:O,56:50,57:k,58:j,59:51,60:S,61:38,62:52,63:40,66:39,75:46,76:A,78:47,79:D,80:41,81:P,82:37,83:C,84:L,85:T,86:F,88:I,89:N,90:R,92:36,103:M,106:35,122:33,197:B},t(K,[2,155]),t(K,[2,156]),t([57,58,60,125],pt,{102:143,103:ft}),{16:g,29:[1,146],35:w,50:x,51:_,52:48,53:49,54:E,55:O,56:50,57:k,58:j,59:51,60:S,61:38,62:52,63:40,66:39,75:46,76:A,78:47,79:D,80:41,81:P,82:37,83:C,84:L,85:T,86:F,88:I,89:N,90:R,92:36,106:144,120:145,121:[1,147],197:B},t(wt,[2,116]),t(wt,[2,117]),t(wt,[2,118]),t(wt,[2,119]),t(wt,[2,120]),t(wt,[2,121]),t(wt,[2,122]),t(J,[2,133]),{107:[1,148],108:[1,149],111:[1,150],112:[1,151]},{111:[1,152]},{16:g,35:w,50:x,51:_,52:48,53:49,54:E,55:O,56:50,57:k,58:j,59:51,60:S,61:38,62:52,63:40,66:39,75:46,76:A,78:47,79:D,80:41,81:P,82:37,83:C,84:L,85:T,86:F,88:I,89:N,90:R,92:153,197:B},{16:g,35:w,50:x,51:_,52:48,53:49,54:E,55:O,56:50,57:k,58:j,59:51,60:S,61:38,62:52,63:40,66:39,75:46,76:A,78:47,79:D,80:41,81:P,82:37,83:C,84:L,85:T,86:F,88:I,89:N,90:R,92:154,197:B},{16:g,35:w,50:x,51:_,52:48,53:49,54:E,55:O,56:50,57:k,58:j,59:51,60:S,61:38,62:52,63:40,66:39,75:46,76:A,78:47,79:D,80:41,81:P,82:37,83:C,84:L,85:T,86:F,88:I,89:N,90:R,92:155,197:B},{16:g,35:w,50:x,51:_,52:48,53:49,54:E,55:O,56:50,57:k,58:j,59:51,60:S,61:38,62:52,63:40,66:39,75:46,76:A,78:47,79:D,80:41,81:P,82:37,83:C,84:L,85:T,86:F,88:I,89:N,90:R,92:156,197:B},{16:g,35:w,50:x,51:_,52:48,53:49,54:E,55:O,56:50,57:k,58:j,59:51,60:S,61:38,62:52,63:40,66:39,75:46,76:A,78:47,79:D,80:41,81:P,82:37,83:C,84:L,85:T,86:F,88:I,89:N,90:R,92:157,197:B},{16:g,35:w,50:x,51:_,52:48,53:49,54:E,55:O,56:50,57:k,58:j,59:51,60:S,61:38,62:52,63:40,66:39,75:46,76:A,78:47,79:D,80:41,81:P,82:37,83:C,84:L,85:T,86:F,88:I,89:N,90:R,92:158,197:B},{16:g,35:w,50:x,51:_,52:48,53:49,54:E,55:O,56:50,57:k,58:j,59:51,60:S,61:38,62:52,63:40,66:39,75:46,76:A,78:47,79:D,80:41,81:P,82:37,83:C,84:L,85:T,86:F,88:I,89:N,90:R,92:159,197:B},{16:g,35:w,50:x,51:_,52:48,53:49,54:E,55:O,56:50,57:k,58:j,59:51,60:S,61:38,62:52,63:40,66:39,75:46,76:A,78:47,79:D,80:41,81:P,82:37,83:C,84:L,85:T,86:F,88:I,89:N,90:R,92:160,197:B},{16:g,35:w,50:x,51:_,52:48,53:49,54:E,55:O,56:50,57:k,58:j,59:51,60:S,61:38,62:52,63:40,66:39,75:46,76:A,78:47,79:D,80:41,81:P,82:37,83:C,84:L,85:T,86:F,88:I,89:N,90:R,92:161,197:B},{16:g,35:w,50:x,51:_,52:48,53:49,54:E,55:O,56:50,57:k,58:j,59:51,60:S,61:38,62:52,63:40,66:39,75:46,76:A,78:47,79:D,80:41,81:P,82:37,83:C,84:L,85:T,86:F,88:I,89:N,90:R,92:162,197:B},{16:g,35:w,50:x,51:_,52:48,53:49,54:E,55:O,56:50,57:k,58:j,59:51,60:S,61:38,62:52,63:40,66:39,75:46,76:A,78:47,79:D,80:41,81:P,82:37,83:C,84:L,85:T,86:F,88:I,89:N,90:R,92:163,197:B},{16:g,35:w,50:x,51:_,52:48,53:49,54:E,55:O,56:50,57:k,58:j,59:51,60:S,61:38,62:52,63:40,66:39,75:46,76:A,78:47,79:D,80:41,81:P,82:37,83:C,84:L,85:T,86:F,88:I,89:N,90:R,92:164,197:B},t([57,58,60,107,108,111,112,125],[2,106]),{50:[1,165]},{17:[1,166],43:xt},{17:[1,168]},t(_t,[2,139],{109:H,126:Z,127:Y,128:V,129:W}),{16:g,35:w,47:115,50:x,51:_,52:48,53:49,54:E,55:O,56:50,57:k,58:j,59:51,60:S,61:38,62:52,63:40,66:39,75:46,76:A,78:47,79:D,80:41,81:P,82:37,83:C,84:L,85:T,86:F,87:169,88:I,89:N,90:R,92:36,103:M,106:35,122:33,197:B},{4:170,18:r},{16:g,35:w,47:171,50:x,51:_,52:48,53:49,54:E,55:O,56:50,57:k,58:j,59:51,60:S,61:38,62:52,63:40,66:39,67:yt,75:46,76:A,78:47,79:D,80:41,81:P,82:37,83:C,84:L,85:T,86:F,88:I,89:N,90:R,92:36,103:M,106:35,122:33,197:B},t([6,8,14,16,17,35,36,43,49,50,51,54,55,57,58,60,67,76,79,81,83,84,85,86,88,89,90,91,103,131,137,140,146,148,152,154,156,166,167,169,170,175,179,181,182,184,194,195,196,197],mt),t(_t,Et,{122:33,106:35,92:36,82:37,61:38,66:39,63:40,80:41,75:46,78:47,52:48,53:49,56:50,59:51,62:52,64:172,65:173,47:177,16:g,30:Ot,35:w,45:kt,46:jt,50:x,51:_,54:E,55:O,57:k,58:j,60:S,76:A,79:D,81:P,83:C,84:L,85:T,86:F,88:I,89:N,90:R,103:M,197:B}),t(dt,[2,76]),t(dt,[2,77]),t(dt,[2,78]),t(dt,[2,79]),t(dt,[2,80]),{70:178,71:[1,179]},{71:[2,69],109:H,126:Z,127:Y,128:V,129:W},{16:g,35:w,47:180,50:x,51:_,52:48,53:49,54:E,55:O,56:50,57:k,58:j,59:51,60:S,61:38,62:52,63:40,66:39,75:46,76:A,78:47,79:D,80:41,81:P,82:37,83:C,84:L,85:T,86:F,88:I,89:N,90:R,92:36,103:M,106:35,122:33,197:B},t(St,[2,7],{14:h}),t(St,[2,8]),t(At,[2,24],{22:181,37:[1,182]}),t(gt,[2,21]),{35:[1,183]},{35:[1,184]},{35:[1,185]},t(K,[2,152]),t(Dt,[2,146]),t(J,[2,134]),t(Pt,[2,135],{109:H,126:Z}),t(Pt,[2,136],{109:H,126:Z}),t(J,[2,137]),t(Pt,[2,138],{109:H,126:Z}),{56:188,57:k,58:j,60:[1,187],124:186,125:[1,189]},t(X,[2,127]),{16:[1,190]},{16:[2,123]},{16:[2,124]},{16:[1,191]},{16:g,35:w,50:x,51:_,52:48,53:49,54:E,55:O,56:50,57:k,58:j,59:51,60:S,61:38,62:52,63:40,66:39,75:46,76:A,78:47,79:D,80:41,81:P,82:37,83:C,84:L,85:T,86:F,88:I,89:N,90:R,92:192,197:B},{16:g,35:w,50:x,51:_,52:48,53:49,54:E,55:O,56:50,57:k,58:j,59:51,60:S,61:38,62:52,63:40,66:39,75:46,76:A,78:47,79:D,80:41,81:P,82:193,83:C,84:L,85:T,86:F,88:I,89:N,90:R,197:B},{16:g,35:w,50:x,51:_,52:48,53:49,54:E,55:O,56:50,57:k,58:j,59:51,60:S,61:38,62:52,63:40,66:39,75:46,76:A,78:47,79:D,80:41,81:P,82:37,83:C,84:L,85:T,86:F,88:I,89:N,90:R,92:194,197:B},{16:g,35:w,50:x,51:_,52:48,53:49,54:E,55:O,56:50,57:k,58:j,59:51,60:S,61:38,62:52,63:40,66:39,75:46,76:A,78:47,79:D,80:41,81:P,82:37,83:C,84:L,85:T,86:F,88:I,89:N,90:R,92:195,197:B},t([6,8,14,17,34,36,43,49,50,51,71,72,74,77,91,93,103,107,108,109,110,111,112,114,115,116,117,118,119,123,126,127,128,129,131,135,137,140,143,144,146,148,152,154,156,159,166,167,169,170,175,179,181,182,184],[2,93],{45:Q,81:tt,83:et,94:nt,95:ot,96:it,97:at,98:ut,99:st,100:ct,101:lt}),t([6,8,14,17,34,36,43,49,50,51,71,72,74,77,91,93,94,101,103,107,108,109,110,111,112,114,115,116,117,118,119,123,126,127,128,129,131,135,137,140,143,144,146,148,152,154,156,159,166,167,169,170,175,179,181,182,184],[2,94],{45:Q,81:tt,83:et,95:ot,96:it,97:at,98:ut,99:st,100:ct}),t(Ct,[2,95],{45:Q,81:tt,83:et,97:at,98:ut,99:st,100:ct}),t(Ct,[2,96],{45:Q,81:tt,83:et,97:at,98:ut,99:st,100:ct}),t(Lt,[2,97],{45:Q,97:at,98:ut,99:st,100:ct}),t(Lt,[2,98],{45:Q,97:at,98:ut,99:st,100:ct}),t(ht,[2,99]),t(ht,[2,100]),t(ht,[2,101]),t(ht,[2,102]),t(ht,[2,103]),t([6,8,14,17,34,36,43,49,50,51,71,72,74,77,91,93,101,103,107,108,109,110,111,112,114,115,116,117,118,119,123,126,127,128,129,131,135,137,140,143,144,146,148,152,154,156,159,166,167,169,170,175,179,181,182,184],[2,104],{45:Q,81:tt,83:et,94:nt,95:ot,96:it,97:at,98:ut,99:st,100:ct}),t([6,8,14,16,17,34,35,36,43,45,49,50,51,54,55,57,58,60,67,71,72,74,76,77,79,81,83,84,85,86,88,89,90,91,93,94,95,96,97,98,99,100,101,103,105,107,108,109,110,111,112,114,115,116,117,118,119,123,126,127,128,129,131,135,137,140,143,144,146,148,152,154,156,159,166,167,169,170,175,179,181,182,184,194,195,196,197],[2,65]),t(dt,[2,85]),{16:g,35:w,47:196,50:x,51:_,52:48,53:49,54:E,55:O,56:50,57:k,58:j,59:51,60:S,61:38,62:52,63:40,66:39,75:46,76:A,78:47,79:D,80:41,81:P,82:37,83:C,84:L,85:T,86:F,88:I,89:N,90:R,92:36,103:M,106:35,122:33,197:B},t(dt,[2,87]),{17:[1,197],43:xt},{17:[1,198]},{91:[1,199],109:H,126:Z,127:Y,128:V,129:W},{17:[1,200],43:[1,201]},t(_t,[2,58]),t(_t,[2,60]),t(_t,[2,61]),{16:g,35:w,47:202,50:x,51:_,52:48,53:49,54:E,55:O,56:50,57:k,58:j,59:51,60:S,61:38,62:52,63:40,66:39,75:46,76:A,78:47,79:D,80:41,81:P,82:37,83:C,84:L,85:T,86:F,88:I,89:N,90:R,92:36,103:M,106:35,122:33,197:B},t(_t,[2,63],{109:H,126:Z,127:Y,128:V,129:W}),{71:[1,204],73:203,74:[1,205],77:[2,72]},{16:g,35:w,47:206,50:x,51:_,52:48,53:49,54:E,55:O,56:50,57:k,58:j,59:51,60:S,61:38,62:52,63:40,66:39,75:46,76:A,78:47,79:D,80:41,81:P,82:37,83:C,84:L,85:T,86:F,88:I,89:N,90:R,92:36,103:M,106:35,122:33,197:B},{49:[1,207],109:H,126:Z,127:Y,128:V,129:W},t(Tt,[2,26],{23:208,38:[1,209]}),t(At,[2,23]),t(G,[2,19]),t(U,[2,160]),t(U,[2,161]),t(J,[2,132]),t(X,[2,126]),t(J,[2,129]),t(J,[2,130]),{4:210,18:r},{4:211,16:g,18:r,35:w,47:115,50:x,51:_,52:48,53:49,54:E,55:O,56:50,57:k,58:j,59:51,60:S,61:38,62:52,63:40,66:39,75:46,76:A,78:47,79:D,80:41,81:P,82:37,83:C,84:L,85:T,86:F,87:212,88:I,89:N,90:R,92:36,103:M,106:35,122:33,197:B},{45:Q,81:tt,83:et,93:rt,94:nt,95:ot,96:it,97:at,98:ut,99:st,100:ct,101:lt,109:[1,213]},t(X,[2,107],{104:214,105:[1,215]}),t(X,[2,115],{45:Q,81:tt,83:et,93:rt,94:nt,95:ot,96:it,97:at,98:ut,99:st,100:ct,101:lt}),t(X,[2,113],{45:Q,81:tt,83:et,93:rt,94:nt,95:ot,96:it,97:at,98:ut,99:st,100:ct,101:lt}),t(_t,[2,140],{109:H,126:Z,127:Y,128:V,129:W}),t(dt,[2,86]),t(dt,[2,88]),t(dt,[2,89]),t(dt,[2,56]),t(_t,Et,{122:33,106:35,92:36,82:37,61:38,66:39,63:40,80:41,75:46,78:47,52:48,53:49,56:50,59:51,62:52,47:177,65:216,16:g,30:Ot,35:w,45:kt,46:jt,50:x,51:_,54:E,55:O,57:k,58:j,60:S,76:A,79:D,81:P,83:C,84:L,85:T,86:F,88:I,89:N,90:R,103:M,197:B}),t(_t,[2,62],{109:H,126:Z,127:Y,128:V,129:W}),{77:[1,217]},{16:g,35:w,47:218,50:x,51:_,52:48,53:49,54:E,55:O,56:50,57:k,58:j,59:51,60:S,61:38,62:52,63:40,66:39,75:46,76:A,78:47,79:D,80:41,81:P,82:37,83:C,84:L,85:T,86:F,88:I,89:N,90:R,92:36,103:M,106:35,122:33,197:B},{16:g,35:w,47:219,50:x,51:_,52:48,53:49,54:E,55:O,56:50,57:k,58:j,59:51,60:S,61:38,62:52,63:40,66:39,75:46,76:A,78:47,79:D,80:41,81:P,82:37,83:C,84:L,85:T,86:F,88:I,89:N,90:R,92:36,103:M,106:35,122:33,197:B},{72:[1,220],109:H,126:Z,127:Y,128:V,129:W},{50:[1,221]},t(Ft,[2,28],{24:222,39:[1,223]}),t(Tt,[2,25]),{17:[1,224]},{17:[1,225]},{17:[1,226],43:xt},{16:g,35:w,50:x,51:_,52:48,53:49,54:E,55:O,56:50,57:k,58:j,59:51,60:S,61:38,62:52,63:40,66:39,75:46,76:A,78:47,79:D,80:41,81:P,82:37,83:C,84:L,85:T,86:F,88:I,89:N,90:R,92:36,106:227,197:B},t(X,[2,114]),{16:g,35:w,50:x,51:_,52:48,53:49,54:E,55:O,56:50,57:k,58:j,59:51,60:S,61:38,62:52,63:40,66:39,75:46,76:A,78:47,79:D,80:41,81:P,82:228,83:C,84:L,85:T,86:F,88:I,89:N,90:R,197:B},t(_t,[2,57]),t(dt,[2,74]),{72:[1,229],109:H,126:Z,127:Y,128:V,129:W},{77:[2,73],109:H,126:Z,127:Y,128:V,129:W},{16:g,35:w,47:230,50:x,51:_,52:48,53:49,54:E,55:O,56:50,57:k,58:j,59:51,60:S,61:38,62:52,63:40,66:39,75:46,76:A,78:47,79:D,80:41,81:P,82:37,83:C,84:L,85:T,86:F,88:I,89:N,90:R,92:36,103:M,106:35,122:33,197:B},{17:[1,231]},t(It,[2,29],{25:232,40:[1,233],41:[1,234]}),t(Ft,[2,27]),t(X,[2,128]),t(X,[2,110]),t(X,[2,111]),t(X,[2,112]),t(X,[2,108]),{16:g,35:w,47:235,50:x,51:_,52:48,53:49,54:E,55:O,56:50,57:k,58:j,59:51,60:S,61:38,62:52,63:40,66:39,75:46,76:A,78:47,79:D,80:41,81:P,82:37,83:C,84:L,85:T,86:F,88:I,89:N,90:R,92:36,103:M,106:35,122:33,197:B},t(Nt,[2,70],{109:H,126:Z,127:Y,128:V,129:W}),t(dt,[2,75]),t(Rt,[2,33],{26:236,42:[1,237]}),t(It,[2,30]),t(It,[2,31]),t(Nt,[2,71],{109:H,126:Z,127:Y,128:V,129:W}),{16:g,27:238,35:w,44:239,45:Mt,46:Bt,47:242,50:x,51:_,52:48,53:49,54:E,55:O,56:50,57:k,58:j,59:51,60:S,61:38,62:52,63:40,66:39,75:46,76:A,78:47,79:D,80:41,81:P,82:37,83:C,84:L,85:T,86:F,88:I,89:N,90:R,92:36,103:M,106:35,122:33,197:B},t(Rt,[2,32]),t(Gt,[2,170],{28:243,43:[1,244],159:[1,245]}),t(Ut,[2,35]),t(Ut,[2,36]),t(Ut,[2,37]),t(Ut,[2,39],{48:246,49:[1,247],50:[1,248],51:[1,249],109:H,126:Z,127:Y,128:V,129:W}),t(Gt,[2,12]),{16:g,35:w,44:250,45:Mt,46:Bt,47:242,50:x,51:_,52:48,53:49,54:E,55:O,56:50,57:k,58:j,59:51,60:S,61:38,62:52,63:40,66:39,75:46,76:A,78:47,79:D,80:41,81:P,82:37,83:C,84:L,85:T,86:F,88:I,89:N,90:R,92:36,103:M,106:35,122:33,197:B},{16:zt,50:vt,66:257,90:$t,160:251,162:252,163:253,174:256,176:255},t(Ut,[2,38]),{50:[1,259],51:[1,260]},t(Ut,[2,41]),t(Ut,[2,43]),t(Ut,[2,34]),t([6,8,14,17,131,137,140,146,148,152,154,156],qt,{161:261,43:Kt,184:Ht}),t(Zt,[2,172]),t(Zt,[2,174],{165:264,168:266,36:Yt,166:Vt,167:Wt,169:Jt,170:Xt,175:Qt,179:te}),{164:[1,272]},t(ee,[2,195]),t(ee,[2,196]),t([6,8,14,17,36,43,49,50,91,131,137,140,146,148,152,154,156,166,167,169,170,175,179,181,182,194,195,196],qt,{161:273,67:yt,184:Ht}),{4:274,16:zt,18:r,50:vt,66:257,90:$t,160:275,162:252,163:253,174:256,176:255},t(Ut,[2,40]),t(Ut,[2,42]),t(re,[2,141],{130:276,131:[1,277]}),{16:zt,50:vt,66:257,90:$t,162:278,163:253,174:256,176:255},{16:[1,279]},{175:[1,280]},{16:zt,50:vt,66:257,176:281},{171:282,172:ne,175:oe},{168:285,169:Jt,170:Xt,173:284,175:[2,183]},{175:[2,177]},{175:[2,178]},t(ie,[2,179]),t(ie,[2,180]),{16:zt,50:vt,66:257,163:286,174:256,176:255},t(ae,ue,{185:287,66:289,49:se,50:vt}),{17:[1,290]},{17:[1,291],43:Kt},t(Dt,[2,143],{132:292,133:293,137:[1,294]}),{16:g,35:w,47:295,50:x,51:_,52:48,53:49,54:E,55:O,56:50,57:k,58:j,59:51,60:S,61:38,62:52,63:40,66:39,75:46,76:A,78:47,79:D,80:41,81:P,82:37,83:C,84:L,85:T,86:F,88:I,89:N,90:R,92:36,103:M,106:35,122:33,197:B},t(Zt,[2,173]),{50:vt,66:297,183:296},{16:zt,50:vt,66:257,176:298},{178:299,181:ce},{175:[1,301]},{175:[2,182]},{175:[1,302]},{171:303,172:ne,175:oe},{36:Yt,91:[1,304],165:264,166:Vt,167:Wt,168:266,169:Jt,170:Xt,175:Qt,179:te},t(ee,[2,212],{191:305,192:306,193:307,194:le,195:fe,196:pe}),{50:vt,66:311},t(ae,[2,203],{67:yt}),t(ee,ue,{66:289,185:312,49:se,50:vt}),t(ee,[2,221]),t(he,[2,157],{145:313,146:[1,314]}),t(Dt,[2,144]),{16:g,35:w,47:32,50:x,51:_,52:48,53:49,54:E,55:O,56:50,57:k,58:j,59:51,60:S,61:38,62:52,63:40,66:39,75:46,76:A,78:47,79:D,80:41,81:P,82:37,83:C,84:L,85:T,86:F,88:I,89:N,90:R,92:36,103:M,106:35,122:33,138:315,141:31,197:B},t(re,[2,142],{109:H,126:Z,127:Y,128:V,129:W}),{17:[1,316],43:[1,317]},t(_t,[2,197],{67:yt}),t([6,8,14,17,36,43,91,131,137,140,146,148,152,154,156,166,167,169,170,175,179,184],[2,185],{177:318,178:319,181:ce,182:de}),t(ee,[2,187]),{16:g,35:w,47:321,50:x,51:_,52:48,53:49,54:E,55:O,56:50,57:k,58:j,59:51,60:S,61:38,62:52,63:40,66:39,75:46,76:A,78:47,79:D,80:41,81:P,82:37,83:C,84:L,85:T,86:F,88:I,89:N,90:R,92:36,103:M,106:35,122:33,197:B},{16:zt,50:vt,66:257,163:322,174:256,176:255},{16:zt,50:vt,66:257,176:323},{175:[2,184]},t(Zt,[2,175]),t(ee,[2,219]),t(ee,[2,213]),t(ee,[2,214]),{186:325,187:ye,188:ve},{186:328,187:ye,188:ve},{186:329,187:ye,188:ve},t(ae,[2,202],{67:yt}),t(ee,[2,220]),t(b,f,{139:18,11:330,140:p}),{16:g,35:w,47:331,50:x,51:_,52:48,53:49,54:E,55:O,56:50,57:k,58:j,59:51,60:S,61:38,62:52,63:40,66:39,75:46,76:A,78:47,79:D,80:41,81:P,82:37,83:C,84:L,85:T,86:F,88:I,89:N,90:R,92:36,103:M,106:35,122:33,197:B},t(Dt,z,{134:332,43:$,135:q}),t([6,8,14,17,36,43,49,50,91,131,137,140,146,148,152,154,156,166,167,169,170,175,179,181,182,184,194,195,196],[2,200]),{50:vt,66:333},t(ee,[2,186]),t(ee,[2,193]),{16:[1,334]},t(ee,[2,192],{109:H,126:Z,127:Y,128:V,129:W}),{36:Yt,165:264,166:Vt,167:Wt,168:266,169:Jt,170:Xt,175:Qt,177:335,178:319,179:te,181:ce,182:de},t(ee,[2,189]),{193:336,194:le,195:fe,196:pe},{16:me,154:be,189:337},t(ge,[2,204]),t(ge,[2,205]),{16:me,154:be,189:339},{16:me,154:be,189:340},t(U,v,{147:28,12:341,148:m}),t(he,[2,158],{109:H,126:Z,127:Y,128:V,129:W}),t(Dt,[2,147]),t(_t,[2,198],{67:yt}),{50:vt,66:343,68:342},t(ee,[2,188]),t(ee,[2,215]),{16:[1,344]},{137:[1,347],140:[1,346],175:[1,345]},{16:[1,348]},{16:[1,349]},t(we,[2,164],{150:350,151:351,152:[1,352]}),{17:[1,353],43:xe},t(_t,[2,66],{67:yt}),{17:[2,210],50:vt,66:343,68:356,190:355},{16:[2,207]},{16:[2,208]},{16:[2,209]},{50:vt,66:343,68:357},{50:vt,66:343,68:358},t(Gt,[2,167],{153:359,154:[1,360],156:[1,361]}),t(we,[2,165]),{50:[1,363],63:362},t(ee,[2,194]),{50:vt,66:364},{17:[1,365]},{17:[2,211],43:xe},{17:[1,366],43:xe},{17:[1,367],43:xe},t(Gt,[2,171]),{155:[1,368]},{107:[1,369]},t(we,[2,166]),{16:bt},t(_t,[2,67],{67:yt}),t(ee,[2,216]),t(ee,[2,217]),t(ee,[2,218]),t(Gt,[2,168]),{157:[1,370]},{158:[1,371]},t(Gt,[2,169])],defaultActions:{11:[2,3],22:[2,1],24:[2,2],146:[2,123],147:[2,124],268:[2,177],269:[2,178],283:[2,182],303:[2,184],345:[2,207],346:[2,208],347:[2,209]},parseError:function(t,e){if(!e.recoverable){var r=new Error(t);throw r.hash=e,r}this.trace(t)},parse:function(t){var e=this,r=[0],n=[null],o=[],i=this.table,a="",u=0,s=0,c=0,l=o.slice.call(arguments,1),f=Object.create(this.lexer),p={yy:{}};for(var h in this.yy)Object.prototype.hasOwnProperty.call(this.yy,h)&&(p.yy[h]=this.yy[h]);f.setInput(t,p.yy),p.yy.lexer=f,p.yy.parser=this,void 0===f.yylloc&&(f.yylloc={});var d=f.yylloc;o.push(d);var y,v=f.options&&f.options.ranges;"function"==typeof p.yy.parseError?this.parseError=p.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var m,b,g,w,x,_,E,O,k,j={};;){if(g=r[r.length-1],this.defaultActions[g]?w=this.defaultActions[g]:(null==m&&(y=void 0,"number"!=typeof(y=f.lex()||1)&&(y=e.symbols_[y]||y),m=y),w=i[g]&&i[g][m]),void 0===w||!w.length||!w[0]){var S;for(_ in k=[],i[g])this.terminals_[_]&&_>2&&k.push("'"+this.terminals_[_]+"'");S=f.showPosition?"Parse error on line "+(u+1)+":\n"+f.showPosition()+"\nExpecting "+k.join(", ")+", got '"+(this.terminals_[m]||m)+"'":"Parse error on line "+(u+1)+": Unexpected "+(1==m?"end of input":"'"+(this.terminals_[m]||m)+"'"),this.parseError(S,{text:f.match,token:this.terminals_[m]||m,line:f.yylineno,loc:d,expected:k})}if(w[0]instanceof Array&&w.length>1)throw new Error("Parse Error: multiple actions possible at state: "+g+", token: "+m);switch(w[0]){case 1:r.push(m),n.push(f.yytext),o.push(f.yylloc),r.push(w[1]),m=null,b?(m=b,b=null):(s=f.yyleng,a=f.yytext,u=f.yylineno,d=f.yylloc,c>0&&c--);break;case 2:if(E=this.productions_[w[1]][1],j.$=n[n.length-E],j._$={first_line:o[o.length-(E||1)].first_line,last_line:o[o.length-1].last_line,first_column:o[o.length-(E||1)].first_column,last_column:o[o.length-1].last_column},v&&(j._$.range=[o[o.length-(E||1)].range[0],o[o.length-1].range[1]]),void 0!==(x=this.performAction.apply(j,[a,s,u,p.yy,w[1],n,o].concat(l))))return x;E&&(r=r.slice(0,-1*E*2),n=n.slice(0,-1*E),o=o.slice(0,-1*E)),r.push(this.productions_[w[1]][0]),n.push(j.$),o.push(j._$),O=i[r[r.length-2]][r[r.length-1]],r.push(O);break;case 3:return!0}}return!0}},Ee={EOF:1,parseError:function(t,e){if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,e)},setInput:function(t,e){return this.yy=e||this.yy||{},this._input=t,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var t=this._input[0];return this.yytext+=t,this.yyleng++,this.offset++,this.match+=t,this.matched+=t,t.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),t},unput:function(t){var e=t.length,r=t.split(/(?:\r\n?|\n)/g);this._input=t+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-e),this.offset-=e;var n=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),r.length-1&&(this.yylineno-=r.length-1);var o=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:r?(r.length===n.length?this.yylloc.first_column:0)+n[n.length-r.length].length-r[0].length:this.yylloc.first_column-e},this.options.ranges&&(this.yylloc.range=[o[0],o[0]+this.yyleng-e]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(t){this.unput(this.match.slice(t))},pastInput:function(){var t=this.matched.substr(0,this.matched.length-this.match.length);return(t.length>20?"...":"")+t.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var t=this.match;return t.length<20&&(t+=this._input.substr(0,20-t.length)),(t.substr(0,20)+(t.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var t=this.pastInput(),e=new Array(t.length+1).join("-");return t+this.upcomingInput()+"\n"+e+"^"},test_match:function(t,e){var r,n,o;if(this.options.backtrack_lexer&&(o={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(o.yylloc.range=this.yylloc.range.slice(0))),(n=t[0].match(/(?:\r\n?|\n).*/g))&&(this.yylineno+=n.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:n?n[n.length-1].length-n[n.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],r=this.performAction.call(this,this.yy,this,e,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),r)return r;if(this._backtrack){for(var i in o)this[i]=o[i];return!1}return!1},next:function(){if(this.done)return this.EOF;var t,e,r,n;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var o=this._currentRules(),i=0;i<o.length;i++)if((r=this._input.match(this.rules[o[i]]))&&(!e||r[0].length>e[0].length)){if(e=r,n=i,this.options.backtrack_lexer){if(!1!==(t=this.test_match(r,o[i])))return t;if(this._backtrack){e=!1;continue}return!1}if(!this.options.flex)break}return e?!1!==(t=this.test_match(e,o[n]))&&t:""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){return this.next()||this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){return this.conditionStack.length-1>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(t){return(t=this.conditionStack.length-1-Math.abs(t||0))>=0?this.conditionStack[t]:"INITIAL"},pushState:function(t){this.begin(t)},stateStackSize:function(){return this.conditionStack.length},options:{"case-insensitive":!0},performAction:function(t,e,r,n){switch(r){case 0:case 1:case 2:case 3:break;case 4:return 197;case 5:case 6:case 7:case 116:case 120:return 50;case 8:return 18;case 9:return 29;case 10:return 121;case 11:return 30;case 12:return 31;case 13:return 32;case 14:return 33;case 15:return 36;case 16:return 37;case 17:return 38;case 18:return 39;case 19:return 40;case 20:return 41;case 21:return 42;case 22:return 46;case 23:return 49;case 24:return 57;case 25:return 58;case 26:return 60;case 27:return"COLLATE";case 28:return 86;case 29:return 88;case 30:return 89;case 31:return 76;case 32:return 71;case 33:return 72;case 34:return 74;case 35:return 77;case 36:return 98;case 37:return 99;case 38:return 103;case 39:return 108;case 40:return 107;case 41:return 110;case 42:return 111;case 43:return 105;case 44:return 79;case 45:return 112;case 46:return 123;case 47:return 125;case 48:return 109;case 49:return 128;case 50:return 129;case 51:return 159;case 52:return 184;case 53:return 194;case 54:return 187;case 55:return 188;case 56:return 154;case 57:return 175;case 58:return 140;case 59:return 137;case 60:return 195;case 61:return 196;case 62:return 166;case 63:return 167;case 64:return 181;case 65:return 182;case 66:return 169;case 67:return 170;case 68:return 172;case 69:return 179;case 70:return 131;case 71:return 143;case 72:return 144;case 73:return 135;case 74:return 136;case 75:return 146;case 76:return 149;case 77:return 152;case 78:return 155;case 79:return 156;case 80:return 157;case 81:return 158;case 82:return 164;case 83:return 148;case 84:return 14;case 85:return 43;case 86:return 34;case 87:return 16;case 88:return 17;case 89:return 84;case 90:return 119;case 91:return 85;case 92:return 93;case 93:return 94;case 94:return 81;case 95:return 83;case 96:return 45;case 97:return 97;case 98:return 100;case 99:return 101;case 100:return 96;case 101:return 114;case 102:return 115;case 103:return 95;case 104:return"<=>";case 105:return 116;case 106:return 118;case 107:return 117;case 108:return 90;case 109:return 91;case 110:return 8;case 111:case 112:case 118:case 119:return 51;case 113:return 55;case 114:return 35;case 115:return 54;case 117:return 67;case 121:return 6;case 122:return"INVALID"}},rules:[/^(?:[/][*](.|\n)*?[*][/])/i,/^(?:[-][-]\s.*\n)/i,/^(?:[#]\s.*\n)/i,/^(?:\s+)/i,/^(?:[$][{](.*?)[}])/i,/^(?:[`][a-zA-Z_\u4e00-\u9fa5\u0080-\uFFFF][a-zA-Z0-9_\u4e00-\u9fa5\u0080-\uFFFF]*[`])/i,/^(?:[\w]+[\u4e00-\u9fa5\u0080-\uFFFF]+[0-9a-zA-Z_\u4e00-\u9fa5\u0080-\uFFFF]*)/i,/^(?:[\u4e00-\u9fa5\u0080-\uFFFF][0-9a-zA-Z_\u4e00-\u9fa5\u0080-\uFFFF]*)/i,/^(?:SELECT\b)/i,/^(?:ALL\b)/i,/^(?:ANY\b)/i,/^(?:DISTINCT\b)/i,/^(?:DISTINCTROW\b)/i,/^(?:HIGH_PRIORITY\b)/i,/^(?:MAX_STATEMENT_TIME\b)/i,/^(?:STRAIGHT_JOIN\b)/i,/^(?:SQL_SMALL_RESULT\b)/i,/^(?:SQL_BIG_RESULT\b)/i,/^(?:SQL_BUFFER_RESULT\b)/i,/^(?:SQL_CACHE\b)/i,/^(?:SQL_NO_CACHE\b)/i,/^(?:SQL_CALC_FOUND_ROWS\b)/i,/^(?:([a-zA-Z_\u4e00-\u9fa5][a-zA-Z0-9_\u4e00-\u9fa5]*\.){1,2}\*)/i,/^(?:AS\b)/i,/^(?:TRUE\b)/i,/^(?:FALSE\b)/i,/^(?:NULL\b)/i,/^(?:COLLATE\b)/i,/^(?:BINARY\b)/i,/^(?:ROW\b)/i,/^(?:EXISTS\b)/i,/^(?:CASE\b)/i,/^(?:WHEN\b)/i,/^(?:THEN\b)/i,/^(?:ELSE\b)/i,/^(?:END\b)/i,/^(?:DIV\b)/i,/^(?:MOD\b)/i,/^(?:NOT\b)/i,/^(?:BETWEEN\b)/i,/^(?:IN\b)/i,/^(?:SOUNDS\b)/i,/^(?:LIKE\b)/i,/^(?:ESCAPE\b)/i,/^(?:CAST\b)/i,/^(?:REGEXP\b)/i,/^(?:IS\b)/i,/^(?:UNKNOWN\b)/i,/^(?:AND\b)/i,/^(?:OR\b)/i,/^(?:XOR\b)/i,/^(?:FROM\b)/i,/^(?:PARTITION\b)/i,/^(?:USE\b)/i,/^(?:INDEX\b)/i,/^(?:KEY\b)/i,/^(?:FOR\b)/i,/^(?:JOIN\b)/i,/^(?:ORDER\s+BY\b)/i,/^(?:GROUP\s+BY\b)/i,/^(?:IGNORE\b)/i,/^(?:FORCE\b)/i,/^(?:INNER\b)/i,/^(?:CROSS\b)/i,/^(?:ON\b)/i,/^(?:USING\b)/i,/^(?:LEFT\b)/i,/^(?:RIGHT\b)/i,/^(?:OUTER\b)/i,/^(?:NATURAL\b)/i,/^(?:WHERE\b)/i,/^(?:ASC\b)/i,/^(?:DESC\b)/i,/^(?:WITH\b)/i,/^(?:ROLLUP\b)/i,/^(?:HAVING\b)/i,/^(?:OFFSET\b)/i,/^(?:PROCEDURE\b)/i,/^(?:UPDATE\b)/i,/^(?:LOCK\b)/i,/^(?:SHARE\b)/i,/^(?:MODE\b)/i,/^(?:OJ\b)/i,/^(?:LIMIT\b)/i,/^(?:UNION\b)/i,/^(?:,)/i,/^(?:=)/i,/^(?:\()/i,/^(?:\))/i,/^(?:~)/i,/^(?:!=)/i,/^(?:!)/i,/^(?:\|)/i,/^(?:&)/i,/^(?:\+)/i,/^(?:-)/i,/^(?:\*)/i,/^(?:\/)/i,/^(?:%)/i,/^(?:\^)/i,/^(?:>>)/i,/^(?:>=)/i,/^(?:>)/i,/^(?:<<)/i,/^(?:<=>)/i,/^(?:<=)/i,/^(?:<>)/i,/^(?:<)/i,/^(?:\{)/i,/^(?:\})/i,/^(?:;)/i,/^(?:['](\\.|[^'])*['])/i,/^(?:["](\\.|[^"])*["])/i,/^(?:[0][x][0-9a-fA-F]+)/i,/^(?:[-]?[0-9]+(\.[0-9]+)?)/i,/^(?:[-]?[0-9]+(\.[0-9]+)?[eE][-][0-9]+(\.[0-9]+)?)/i,/^(?:[a-zA-Z_\u4e00-\u9fa5\u0080-\uFFFF][a-zA-Z0-9_\u4e00-\u9fa5\u0080-\uFFFF]*)/i,/^(?:\.)/i,/^(?:["][a-zA-Z_\u4e00-\u9fa5][a-zA-Z0-9_\u4e00-\u9fa5]*["])/i,/^(?:['][a-zA-Z_\u4e00-\u9fa5][a-zA-Z0-9_\u4e00-\u9fa5]*['])/i,/^(?:([`])(?:(?=(\\?))\2.)*?\1)/i,/^(?:$)/i,/^(?:.)/i],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122],inclusive:!0}}};function Oe(){this.yy={}}return _e.lexer=Ee,Oe.prototype=_e,_e.Parser=Oe,new Oe}();function i(){this.buffer=""}o||(o={}),o.stringify=function(t){var e=new i;return e.travelMain(t),e.buffer},i.prototype.travel=function(t){if(t){if("string"==typeof t)return this.append(t);this["travel"+t.type].call(this,t)}};var a=!1;i.prototype.appendKeyword=function(t,e,r){a&&(e=!0,a=!1),this.buffer+=e?t.toUpperCase():" "+t.toUpperCase(),r&&(a=!0)},i.prototype.append=function(t,e,r){a&&(e=!0,a=!1),this.buffer+=e?t:" "+t,r&&(a=!0)},i.prototype.travelMain=function(t){this.travel(t.value),t.hasSemicolon&&this.append(";",!0)},i.prototype.travelSelect=function(t){this.appendKeyword("select"),t.distinctOpt&&this.appendKeyword(t.distinctOpt),t.highPriorityOpt&&this.appendKeyword(t.highPriorityOpt),t.maxStateMentTimeOpt&&this.append("MAX_STATEMENT_TIME = "+t.maxStateMentTimeOpt),t.straightJoinOpt&&this.appendKeyword(t.straightJoinOpt),t.sqlSmallResultOpt&&this.appendKeyword(t.sqlSmallResultOpt),t.sqlBigResultOpt&&this.appendKeyword(t.sqlBigResultOpt),t.sqlBufferResultOpt&&this.appendKeyword(t.sqlBufferResultOpt),t.sqlCacheOpt&&this.appendKeyword(t.sqlCacheOpt),t.sqlCalcFoundRowsOpt&&this.appendKeyword(t.sqlCalcFoundRowsOpt),t.selectItems&&this.travelSelectExpr(t.selectItems),t.from&&(this.appendKeyword("from"),this.travel(t.from)),t.partition&&this.travel(t.partition),t.where&&(this.appendKeyword("where"),this.travel(t.where)),t.groupBy&&this.travel(t.groupBy),t.having&&(this.appendKeyword("having"),this.travel(t.having)),t.orderBy&&this.travel(t.orderBy),t.limit&&this.travel(t.limit),t.procedure&&(this.appendKeyword("procedure"),this.travel(t.procedure)),t.updateLockMode&&this.appendKeyword(t.updateLockMode)},i.prototype.travelSelectExpr=function(t){for(var e=t.value,r=0;r<e.length;r++)"string"==typeof t?this.append(e[r]):(this.travel(e[r]),e[r].alias&&(e[r].hasAs&&this.appendKeyword("as"),this.travel(e[r].alias))),r!==e.length-1&&this.append(",",!0)},i.prototype.travelIsExpression=function(t){this.travel(t.left),this.appendKeyword("in"),t.hasNot&&this.appendKeyword("not"),this.append(t.right)},i.prototype.travelNotExpression=function(t){this.appendKeyword("not"),this.travel(t.value)},i.prototype.travelOrExpression=i.prototype.travelAndExpression=i.prototype.travelXORExpression=function(t){this.travel(t.left),this.appendKeyword(t.operator),this.travel(t.right)},i.prototype.travelNull=i.prototype.travelBoolean=i.prototype.travelBooleanExtra=function(t){this.appendKeyword(t.value)},i.prototype.travelNumber=function(t){this.append(t.value)},i.prototype.travelString=function(t){this.append(t.value)},i.prototype.travelFunctionCall=function(t){this.append(t.name),this.append("(",!0,!0);for(var e=t.params,r=0;r<e.length;r++){var n=e[r];this.travel(n),r!==e.length-1&&this.append(",",!0)}this.append(")",!0)},i.prototype.travelFunctionCallParam=function(t){t.distinctOpt&&this.appendKeyword(t.distinctOpt),this.travel(t.value)},i.prototype.travelIdentifier=function(t){this.append(t.value)},i.prototype.travelIdentifierList=function(t){for(var e=t.value,r=0;r<e.length;r++)this.travel(e[r]),r!==e.length-1&&this.append(",",!0)},i.prototype.travelWhenThenList=function(t){for(var e=t.value,r=0;r<e.length;r++)this.appendKeyword("when"),this.travel(e[r].when),this.appendKeyword("then"),this.travel(e[r].then)},i.prototype.travelCaseWhen=function(t){this.appendKeyword("case"),t.caseExprOpt&&this.travel(t.caseExprOpt),this.travel(t.whenThenList),t.else&&(this.appendKeyword("else"),this.travel(t.else)),this.appendKeyword("end")},i.prototype.travelCast=function(t){this.appendKeyword("cast"),this.append("(",!0,!0),this.travel(t.expr),this.appendKeyword("as"),this.append(t.castTo),this.append(")",!0)},i.prototype.travelPrefix=function(t){this.appendKeyword(t.prefix),this.travel(t.value)},i.prototype.travelSimpleExprParentheses=function(t){t.hasRow&&this.appendKeyword("row"),this.append("(",!1,!0),this.travel(t.value),this.append(")",!0)},i.prototype.travelSubQuery=function(t){t.hasExists&&this.appendKeyword("exists"),this.append("(",!1,!0),this.travel(t.value),this.append(")",!0)},i.prototype.travelIdentifierExpr=function(t){this.append("{"),this.travel(t.identifier),this.travel(t.value),this.append("}")},i.prototype.travelBitExpression=function(t){this.travel(t.left),this.appendKeyword(t.operator),this.travel(t.right)},i.prototype.travelInSubQueryPredicate=function(t){this.travel(t.left),t.hasNot&&this.appendKeyword("not"),this.appendKeyword("in"),this.append("(",!1,!0),this.travel(t.right),this.append(")")},i.prototype.travelInExpressionListPredicate=function(t){this.travel(t.left),t.hasNot&&this.appendKeyword("not"),this.appendKeyword("in"),this.append("(",!1,!0),this.travel(t.right),this.append(")")},i.prototype.travelBetweenPredicate=function(t){this.travel(t.left),t.hasNot&&this.appendKeyword("not"),this.appendKeyword("between"),this.travel(t.right.left),this.appendKeyword("and"),this.travel(t.right.right)},i.prototype.travelSoundsLikePredicate=function(t){this.travel(t.left),this.appendKeyword("sounds"),this.appendKeyword("like"),this.travel(t.right)},i.prototype.travelLikePredicate=function(t){this.travel(t.left),t.hasNot&&this.appendKeyword("not"),this.appendKeyword("like"),this.travel(t.right),t.escape&&(this.appendKeyword("escape"),this.travel(t.escape))},i.prototype.travelRegexpPredicate=function(t){this.travel(t.left),t.hasNot&&this.appendKeyword("not"),this.appendKeyword("regexp"),this.travel(t.right)},i.prototype.travelIsNullBooleanPrimary=function(t){this.travel(t.value),this.appendKeyword("is"),t.hasNot&&this.appendKeyword("not"),this.appendKeyword("null")},i.prototype.travelComparisonBooleanPrimary=function(t){this.travel(t.left),this.append(t.operator),this.travel(t.right)},i.prototype.travelComparisonSubQueryBooleanPrimary=function(t){this.travel(t.left),this.append(t.operator),this.appendKeyword(t.subQueryOpt),this.append("(",!1,!0),this.travel(t.right),this.append(")")},i.prototype.travelExpressionList=function(t){for(var e=t.value,r=0;r<e.length;r++)this.travel(e[r]),r!==e.length-1&&this.append(",",!0)},i.prototype.travelGroupBy=function(t){this.appendKeyword("group by");for(var e=t.value,r=0;r<e.length;r++)this.travel(e[r]),r!==e.length-1&&this.append(",",!0)},i.prototype.travelOrderBy=function(t){this.appendKeyword("order by");for(var e=t.value,r=0;r<e.length;r++)this.travel(e[r]),r!==e.length-1&&this.append(",",!0);t.rollUp&&this.appendKeyword("with rollup")},i.prototype.travelGroupByOrderByItem=function(t){this.travel(t.value),t.sortOpt&&this.appendKeyword(t.sortOpt)},i.prototype.travelLimit=function(t){this.appendKeyword("limit");var e=t.value;1===e.length?this.append(e[0]):2===e.length&&(t.offsetMode?(this.append(e[1]),this.append("offset"),this.append(e[0])):(this.append(e[0]),this.append(",",!0),this.append(e[1])))},i.prototype.travelTableReferences=function(t){var e=t.value;t.TableReferences&&this.append("(",!1,!0);for(var r=0;r<e.length;r++)this.travel(e[r]),r!==e.length-1&&this.append(",",!0);t.TableReferences&&this.append(")")},i.prototype.travelTableReference=function(t){t.hasOj?(this.append("{"),this.appendKeyword("oj"),this.travel(t.value),this.append("}")):this.travel(t.value)},i.prototype.travelInnerCrossJoinTable=function(t){this.travel(t.left),t.innerCrossOpt&&this.appendKeyword(t.innerCrossOpt),this.appendKeyword("join"),this.travel(t.right),t.condition&&this.travel(t.condition)},i.prototype.travelStraightJoinTable=function(t){this.travel(t.left),this.appendKeyword("straight_join"),this.travel(t.right),this.travel(t.condition)},i.prototype.travelLeftRightJoinTable=function(t){this.travel(t.left),this.appendKeyword(t.leftRight),t.outOpt&&this.appendKeyword(t.outOpt),this.appendKeyword("join"),this.travel(t.right),this.travel(t.condition)},i.prototype.travelNaturalJoinTable=function(t){this.travel(t.left),this.appendKeyword("natural"),t.leftRight&&this.appendKeyword(t.leftRight),t.outOpt&&this.appendKeyword(t.outOpt),this.appendKeyword("join"),this.travel(t.right)},i.prototype.travelOnJoinCondition=function(t){this.appendKeyword("on"),this.travel(t.value)},i.prototype.travelUsingJoinCondition=function(t){this.appendKeyword("using"),this.appendKeyword("(",!1,!0),this.travel(t.value),this.appendKeyword(")")},i.prototype.travelPartitions=function(t){this.appendKeyword("partition"),this.appendKeyword("(",!1,!0);for(var e=t.value,r=0;r<e.length;r++)this.travel(e[r]),r!==e.length-1&&this.append(",",!0);this.appendKeyword(")")},i.prototype.travelForOptIndexHint=function(t){this.appendKeyword("for"),this.appendKeyword(t.value)},i.prototype.travelIndexList=function(t){for(var e=t.value,r=0;r<e.length;r++)this.travel(e[r]),r!==e.length-1&&this.append(",",!0)},i.prototype.travelUseIndexHint=function(t){this.appendKeyword("use"),this.appendKeyword(t.indexOrKey),t.forOpt&&this.travel(t.forOpt),this.appendKeyword("(",!1,!0),t.value&&this.travel(t.value),this.appendKeyword(")")},i.prototype.travelIgnoreIndexHint=function(t){this.appendKeyword("ignore"),this.appendKeyword(t.indexOrKey),t.forOpt&&this.travel(t.forOpt),this.appendKeyword("(",!1,!0),t.value&&this.travel(t.value),this.appendKeyword(")")},i.prototype.travelForceIndexHint=function(t){this.appendKeyword("force"),this.appendKeyword(t.indexOrKey),t.forOpt&&this.travel(t.forOpt),this.appendKeyword("(",!1,!0),t.value&&this.travel(t.value),this.appendKeyword(")")},i.prototype.travelTableFactor=function(t){this.travel(t.value),t.partition&&this.travel(t.partition),t.alias&&(t.hasAs&&this.appendKeyword("as"),this.travel(t.alias)),t.indexHintOpt&&this.travel(t.indexHintOpt)},i.prototype.travelUnion=function(t){this.travel(t.left),this.appendKeyword("UNION"),t.distinctOpt&&this.appendKeyword(t.distinctOpt),this.travel(t.right)},i.prototype.travelSelectParenthesized=function(t){this.appendKeyword("("),this.travel(t.value),this.appendKeyword(")")},i.prototype.travelPlaceHolder=function(t){t.left&&this.travel(t.left),t.operator&&this.append(t.operator),t.right&&this.append(t.right),t.value&&this.travel(t.value)},n&&r.amdO?n([],(function(){return o})):t.exports?t.exports=o:this.sqlParser=o},650:(t,e)=>{},1708:(t,e,r)=>{function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,i(n.key),n)}}function i(t){var e=function(t){if("object"!=n(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==n(e)?e:e+""}var a=Symbol("SemVer ANY"),u=function(){"use strict";function t(e,r){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),r=s(r),e instanceof t){if(e.loose===!!r.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),h("comparator",e,r),this.options=r,this.loose=!!r.loose,this.parse(e),this.semver===a?this.value="":this.value=this.operator+this.semver.version,h("comp",this)}return function(t,e,r){return e&&o(t.prototype,e),r&&o(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}(t,[{key:"parse",value:function(t){var e=this.options.loose?l[f.COMPARATORLOOSE]:l[f.COMPARATOR],r=t.match(e);if(!r)throw new TypeError("Invalid comparator: ".concat(t));this.operator=void 0!==r[1]?r[1]:"","="===this.operator&&(this.operator=""),r[2]?this.semver=new d(r[2],this.options.loose):this.semver=a}},{key:"toString",value:function(){return this.value}},{key:"test",value:function(t){if(h("Comparator.test",t,this.options.loose),this.semver===a||t===a)return!0;if("string"==typeof t)try{t=new d(t,this.options)}catch(t){return!1}return p(t,this.operator,this.semver,this.options)}},{key:"intersects",value:function(e,r){if(!(e instanceof t))throw new TypeError("a Comparator is required");return""===this.operator?""===this.value||new y(e.value,r).test(this.value):""===e.operator?""===e.value||new y(this.value,r).test(e.semver):!((r=s(r)).includePrerelease&&("<0.0.0-0"===this.value||"<0.0.0-0"===e.value)||!r.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))||(!this.operator.startsWith(">")||!e.operator.startsWith(">"))&&(!this.operator.startsWith("<")||!e.operator.startsWith("<"))&&(this.semver.version!==e.semver.version||!this.operator.includes("=")||!e.operator.includes("="))&&!(p(this.semver,"<",e.semver,r)&&this.operator.startsWith(">")&&e.operator.startsWith("<"))&&!(p(this.semver,">",e.semver,r)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))}}],[{key:"ANY",get:function(){return a}}])}();t.exports=u;var s=r(1711),c=r(4426),l=c.safeRe,f=c.t,p=r(4299),h=r(8684),d=r(2176),y=r(5443)},5443:(t,e,r)=>{function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=i(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,u=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return u=t.done,t},e:function(t){s=!0,a=t},f:function(){try{u||null==r.return||r.return()}finally{if(s)throw a}}}}function i(t,e){if(t){if("string"==typeof t)return a(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(t,e):void 0}}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function u(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,s(n.key),n)}}function s(t){var e=function(t){if("object"!=n(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==n(e)?e:e+""}var c=/\s+/g,l=function(){"use strict";function t(e,r){var n=this;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),r=p(r),e instanceof t)return e.loose===!!r.loose&&e.includePrerelease===!!r.includePrerelease?e:new t(e.raw,r);if(e instanceof h)return this.raw=e.value,this.set=[[e]],this.formatted=void 0,this;if(this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease,this.raw=e.trim().replace(c," "),this.set=this.raw.split("||").map((function(t){return n.parseRange(t.trim())})).filter((function(t){return t.length})),!this.set.length)throw new TypeError("Invalid SemVer Range: ".concat(this.raw));if(this.set.length>1){var i=this.set[0];if(this.set=this.set.filter((function(t){return!k(t[0])})),0===this.set.length)this.set=[i];else if(this.set.length>1){var a,u=o(this.set);try{for(u.s();!(a=u.n()).done;){var s=a.value;if(1===s.length&&j(s[0])){this.set=[s];break}}}catch(t){u.e(t)}finally{u.f()}}}this.formatted=void 0}return e=t,(r=[{key:"range",get:function(){if(void 0===this.formatted){this.formatted="";for(var t=0;t<this.set.length;t++){t>0&&(this.formatted+="||");for(var e=this.set[t],r=0;r<e.length;r++)r>0&&(this.formatted+=" "),this.formatted+=e[r].toString().trim()}}return this.formatted}},{key:"format",value:function(){return this.range}},{key:"toString",value:function(){return this.range}},{key:"parseRange",value:function(t){var e=this,r=((this.options.includePrerelease&&E)|(this.options.loose&&O))+":"+t,n=f.get(r);if(n)return n;var u=this.options.loose,s=u?m[b.HYPHENRANGELOOSE]:m[b.HYPHENRANGE];t=t.replace(s,M(this.options.includePrerelease)),d("hyphen replace",t),t=t.replace(m[b.COMPARATORTRIM],g),d("comparator trim",t),t=t.replace(m[b.TILDETRIM],w),d("tilde trim",t),t=t.replace(m[b.CARETTRIM],x),d("caret trim",t);var c=t.split(" ").map((function(t){return A(t,e.options)})).join(" ").split(/\s+/).map((function(t){return R(t,e.options)}));u&&(c=c.filter((function(t){return d("loose invalid filter",t,e.options),!!t.match(m[b.COMPARATORLOOSE])}))),d("range list",c);var l,p=new Map,y=c.map((function(t){return new h(t,e.options)})),v=o(y);try{for(v.s();!(l=v.n()).done;){var _=l.value;if(k(_))return[_];p.set(_.value,_)}}catch(t){v.e(t)}finally{v.f()}p.size>1&&p.has("")&&p.delete("");var j,S=function(t){if(Array.isArray(t))return a(t)}(j=p.values())||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(j)||i(j)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}();return f.set(r,S),S}},{key:"intersects",value:function(e,r){if(!(e instanceof t))throw new TypeError("a Range is required");return this.set.some((function(t){return S(t,r)&&e.set.some((function(e){return S(e,r)&&t.every((function(t){return e.every((function(e){return t.intersects(e,r)}))}))}))}))}},{key:"test",value:function(t){if(!t)return!1;if("string"==typeof t)try{t=new y(t,this.options)}catch(t){return!1}for(var e=0;e<this.set.length;e++)if(B(this.set[e],t,this.options))return!0;return!1}}])&&u(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r}();t.exports=l;var f=new(r(894)),p=r(1711),h=r(1708),d=r(8684),y=r(2176),v=r(4426),m=v.safeRe,b=v.t,g=v.comparatorTrimReplace,w=v.tildeTrimReplace,x=v.caretTrimReplace,_=r(6790),E=_.FLAG_INCLUDE_PRERELEASE,O=_.FLAG_LOOSE,k=function(t){return"<0.0.0-0"===t.value},j=function(t){return""===t.value},S=function(t,e){for(var r=!0,n=t.slice(),o=n.pop();r&&n.length;)r=n.every((function(t){return o.intersects(t,e)})),o=n.pop();return r},A=function(t,e){return d("comp",t,e),t=L(t,e),d("caret",t),t=P(t,e),d("tildes",t),t=F(t,e),d("xrange",t),t=N(t,e),d("stars",t),t},D=function(t){return!t||"x"===t.toLowerCase()||"*"===t},P=function(t,e){return t.trim().split(/\s+/).map((function(t){return C(t,e)})).join(" ")},C=function(t,e){var r=e.loose?m[b.TILDELOOSE]:m[b.TILDE];return t.replace(r,(function(e,r,n,o,i){var a;return d("tilde",t,e,r,n,o,i),D(r)?a="":D(n)?a=">=".concat(r,".0.0 <").concat(+r+1,".0.0-0"):D(o)?a=">=".concat(r,".").concat(n,".0 <").concat(r,".").concat(+n+1,".0-0"):i?(d("replaceTilde pr",i),a=">=".concat(r,".").concat(n,".").concat(o,"-").concat(i," <").concat(r,".").concat(+n+1,".0-0")):a=">=".concat(r,".").concat(n,".").concat(o," <").concat(r,".").concat(+n+1,".0-0"),d("tilde return",a),a}))},L=function(t,e){return t.trim().split(/\s+/).map((function(t){return T(t,e)})).join(" ")},T=function(t,e){d("caret",t,e);var r=e.loose?m[b.CARETLOOSE]:m[b.CARET],n=e.includePrerelease?"-0":"";return t.replace(r,(function(e,r,o,i,a){var u;return d("caret",t,e,r,o,i,a),D(r)?u="":D(o)?u=">=".concat(r,".0.0").concat(n," <").concat(+r+1,".0.0-0"):D(i)?u="0"===r?">=".concat(r,".").concat(o,".0").concat(n," <").concat(r,".").concat(+o+1,".0-0"):">=".concat(r,".").concat(o,".0").concat(n," <").concat(+r+1,".0.0-0"):a?(d("replaceCaret pr",a),u="0"===r?"0"===o?">=".concat(r,".").concat(o,".").concat(i,"-").concat(a," <").concat(r,".").concat(o,".").concat(+i+1,"-0"):">=".concat(r,".").concat(o,".").concat(i,"-").concat(a," <").concat(r,".").concat(+o+1,".0-0"):">=".concat(r,".").concat(o,".").concat(i,"-").concat(a," <").concat(+r+1,".0.0-0")):(d("no pr"),u="0"===r?"0"===o?">=".concat(r,".").concat(o,".").concat(i).concat(n," <").concat(r,".").concat(o,".").concat(+i+1,"-0"):">=".concat(r,".").concat(o,".").concat(i).concat(n," <").concat(r,".").concat(+o+1,".0-0"):">=".concat(r,".").concat(o,".").concat(i," <").concat(+r+1,".0.0-0")),d("caret return",u),u}))},F=function(t,e){return d("replaceXRanges",t,e),t.split(/\s+/).map((function(t){return I(t,e)})).join(" ")},I=function(t,e){t=t.trim();var r=e.loose?m[b.XRANGELOOSE]:m[b.XRANGE];return t.replace(r,(function(r,n,o,i,a,u){d("xRange",t,r,n,o,i,a,u);var s=D(o),c=s||D(i),l=c||D(a),f=l;return"="===n&&f&&(n=""),u=e.includePrerelease?"-0":"",s?r=">"===n||"<"===n?"<0.0.0-0":"*":n&&f?(c&&(i=0),a=0,">"===n?(n=">=",c?(o=+o+1,i=0,a=0):(i=+i+1,a=0)):"<="===n&&(n="<",c?o=+o+1:i=+i+1),"<"===n&&(u="-0"),r="".concat(n+o,".").concat(i,".").concat(a).concat(u)):c?r=">=".concat(o,".0.0").concat(u," <").concat(+o+1,".0.0-0"):l&&(r=">=".concat(o,".").concat(i,".0").concat(u," <").concat(o,".").concat(+i+1,".0-0")),d("xRange return",r),r}))},N=function(t,e){return d("replaceStars",t,e),t.trim().replace(m[b.STAR],"")},R=function(t,e){return d("replaceGTE0",t,e),t.trim().replace(m[e.includePrerelease?b.GTE0PRE:b.GTE0],"")},M=function(t){return function(e,r,n,o,i,a,u,s,c,l,f,p){return r=D(n)?"":D(o)?">=".concat(n,".0.0").concat(t?"-0":""):D(i)?">=".concat(n,".").concat(o,".0").concat(t?"-0":""):a?">=".concat(r):">=".concat(r).concat(t?"-0":""),s=D(c)?"":D(l)?"<".concat(+c+1,".0.0-0"):D(f)?"<".concat(c,".").concat(+l+1,".0-0"):p?"<=".concat(c,".").concat(l,".").concat(f,"-").concat(p):t?"<".concat(c,".").concat(l,".").concat(+f+1,"-0"):"<=".concat(s),"".concat(r," ").concat(s).trim()}},B=function(t,e,r){for(var n=0;n<t.length;n++)if(!t[n].test(e))return!1;if(e.prerelease.length&&!r.includePrerelease){for(var o=0;o<t.length;o++)if(d(t[o].semver),t[o].semver!==h.ANY&&t[o].semver.prerelease.length>0){var i=t[o].semver;if(i.major===e.major&&i.minor===e.minor&&i.patch===e.patch)return!0}return!1}return!0}},2176:(t,e,r)=>{function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,i(n.key),n)}}function i(t){var e=function(t){if("object"!=n(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==n(e)?e:e+""}var a=r(8684),u=r(6790),s=u.MAX_LENGTH,c=u.MAX_SAFE_INTEGER,l=r(4426),f=l.safeRe,p=l.t,h=r(1711),d=r(4295).compareIdentifiers,y=function(){"use strict";function t(e,r){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),r=h(r),e instanceof t){if(e.loose===!!r.loose&&e.includePrerelease===!!r.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError('Invalid version. Must be a string. Got type "'.concat(n(e),'".'));if(e.length>s)throw new TypeError("version is longer than ".concat(s," characters"));a("SemVer",e,r),this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease;var o=e.trim().match(r.loose?f[p.LOOSE]:f[p.FULL]);if(!o)throw new TypeError("Invalid Version: ".concat(e));if(this.raw=e,this.major=+o[1],this.minor=+o[2],this.patch=+o[3],this.major>c||this.major<0)throw new TypeError("Invalid major version");if(this.minor>c||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>c||this.patch<0)throw new TypeError("Invalid patch version");o[4]?this.prerelease=o[4].split(".").map((function(t){if(/^[0-9]+$/.test(t)){var e=+t;if(e>=0&&e<c)return e}return t})):this.prerelease=[],this.build=o[5]?o[5].split("."):[],this.format()}return e=t,(r=[{key:"format",value:function(){return this.version="".concat(this.major,".").concat(this.minor,".").concat(this.patch),this.prerelease.length&&(this.version+="-".concat(this.prerelease.join("."))),this.version}},{key:"toString",value:function(){return this.version}},{key:"compare",value:function(e){if(a("SemVer.compare",this.version,this.options,e),!(e instanceof t)){if("string"==typeof e&&e===this.version)return 0;e=new t(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}},{key:"compareMain",value:function(e){return e instanceof t||(e=new t(e,this.options)),d(this.major,e.major)||d(this.minor,e.minor)||d(this.patch,e.patch)}},{key:"comparePre",value:function(e){if(e instanceof t||(e=new t(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;var r=0;do{var n=this.prerelease[r],o=e.prerelease[r];if(a("prerelease compare",r,n,o),void 0===n&&void 0===o)return 0;if(void 0===o)return 1;if(void 0===n)return-1;if(n!==o)return d(n,o)}while(++r)}},{key:"compareBuild",value:function(e){e instanceof t||(e=new t(e,this.options));var r=0;do{var n=this.build[r],o=e.build[r];if(a("build compare",r,n,o),void 0===n&&void 0===o)return 0;if(void 0===o)return 1;if(void 0===n)return-1;if(n!==o)return d(n,o)}while(++r)}},{key:"inc",value:function(t,e,r){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",e,r);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",e,r);break;case"prepatch":this.prerelease.length=0,this.inc("patch",e,r),this.inc("pre",e,r);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",e,r),this.inc("pre",e,r);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":var n=Number(r)?1:0;if(!e&&!1===r)throw new Error("invalid increment argument: identifier is empty");if(0===this.prerelease.length)this.prerelease=[n];else{for(var o=this.prerelease.length;--o>=0;)"number"==typeof this.prerelease[o]&&(this.prerelease[o]++,o=-2);if(-1===o){if(e===this.prerelease.join(".")&&!1===r)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(n)}}if(e){var i=[e,n];!1===r&&(i=[e]),0===d(this.prerelease[0],e)?isNaN(this.prerelease[1])&&(this.prerelease=i):this.prerelease=i}break;default:throw new Error("invalid increment argument: ".concat(t))}return this.raw=this.format(),this.build.length&&(this.raw+="+".concat(this.build.join("."))),this}}])&&o(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r}();t.exports=y},7426:(t,e,r)=>{var n=r(4332);t.exports=function(t,e){var r=n(t.trim().replace(/^[=v]+/,""),e);return r?r.version:null}},4299:(t,e,r)=>{function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}var o=r(2293),i=r(3987),a=r(8328),u=r(5381),s=r(7871),c=r(8204);t.exports=function(t,e,r,l){switch(e){case"===":return"object"===n(t)&&(t=t.version),"object"===n(r)&&(r=r.version),t===r;case"!==":return"object"===n(t)&&(t=t.version),"object"===n(r)&&(r=r.version),t!==r;case"":case"=":case"==":return o(t,r,l);case"!=":return i(t,r,l);case">":return a(t,r,l);case">=":return u(t,r,l);case"<":return s(t,r,l);case"<=":return c(t,r,l);default:throw new TypeError("Invalid operator: ".concat(e))}}},4078:(t,e,r)=>{var n=r(2176),o=r(4332),i=r(4426),a=i.safeRe,u=i.t;t.exports=function(t,e){if(t instanceof n)return t;if("number"==typeof t&&(t=String(t)),"string"!=typeof t)return null;var r=null;if((e=e||{}).rtl){for(var i,s=e.includePrerelease?a[u.COERCERTLFULL]:a[u.COERCERTL];(i=s.exec(t))&&(!r||r.index+r[0].length!==t.length);)r&&i.index+i[0].length===r.index+r[0].length||(r=i),s.lastIndex=i.index+i[1].length+i[2].length;s.lastIndex=-1}else r=t.match(e.includePrerelease?a[u.COERCEFULL]:a[u.COERCE]);if(null===r)return null;var c=r[2],l=r[3]||"0",f=r[4]||"0",p=e.includePrerelease&&r[5]?"-".concat(r[5]):"",h=e.includePrerelease&&r[6]?"+".concat(r[6]):"";return o("".concat(c,".").concat(l,".").concat(f).concat(p).concat(h),e)}},2393:(t,e,r)=>{var n=r(2176);t.exports=function(t,e,r){var o=new n(t,r),i=new n(e,r);return o.compare(i)||o.compareBuild(i)}},9095:(t,e,r)=>{var n=r(2444);t.exports=function(t,e){return n(t,e,!0)}},2444:(t,e,r)=>{var n=r(2176);t.exports=function(t,e,r){return new n(t,r).compare(new n(e,r))}},1404:(t,e,r)=>{var n=r(4332);t.exports=function(t,e){var r=n(t,null,!0),o=n(e,null,!0),i=r.compare(o);if(0===i)return null;var a=i>0,u=a?r:o,s=a?o:r,c=!!u.prerelease.length;if(s.prerelease.length&&!c)return s.patch||s.minor?u.patch?"patch":u.minor?"minor":"major":"major";var l=c?"pre":"";return r.major!==o.major?l+"major":r.minor!==o.minor?l+"minor":r.patch!==o.patch?l+"patch":"prerelease"}},2293:(t,e,r)=>{var n=r(2444);t.exports=function(t,e,r){return 0===n(t,e,r)}},8328:(t,e,r)=>{var n=r(2444);t.exports=function(t,e,r){return n(t,e,r)>0}},5381:(t,e,r)=>{var n=r(2444);t.exports=function(t,e,r){return n(t,e,r)>=0}},8187:(t,e,r)=>{var n=r(2176);t.exports=function(t,e,r,o,i){"string"==typeof r&&(i=o,o=r,r=void 0);try{return new n(t instanceof n?t.version:t,r).inc(e,o,i).version}catch(t){return null}}},7871:(t,e,r)=>{var n=r(2444);t.exports=function(t,e,r){return n(t,e,r)<0}},8204:(t,e,r)=>{var n=r(2444);t.exports=function(t,e,r){return n(t,e,r)<=0}},9854:(t,e,r)=>{var n=r(2176);t.exports=function(t,e){return new n(t,e).major}},7898:(t,e,r)=>{var n=r(2176);t.exports=function(t,e){return new n(t,e).minor}},3987:(t,e,r)=>{var n=r(2444);t.exports=function(t,e,r){return 0!==n(t,e,r)}},4332:(t,e,r)=>{var n=r(2176);t.exports=function(t,e){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(t instanceof n)return t;try{return new n(t,e)}catch(t){if(!r)return null;throw t}}},5305:(t,e,r)=>{var n=r(2176);t.exports=function(t,e){return new n(t,e).patch}},7925:(t,e,r)=>{var n=r(4332);t.exports=function(t,e){var r=n(t,e);return r&&r.prerelease.length?r.prerelease:null}},806:(t,e,r)=>{var n=r(2444);t.exports=function(t,e,r){return n(e,t,r)}},6681:(t,e,r)=>{var n=r(2393);t.exports=function(t,e){return t.sort((function(t,r){return n(r,t,e)}))}},4594:(t,e,r)=>{var n=r(5443);t.exports=function(t,e,r){try{e=new n(e,r)}catch(t){return!1}return e.test(t)}},4419:(t,e,r)=>{var n=r(2393);t.exports=function(t,e){return t.sort((function(t,r){return n(t,r,e)}))}},101:(t,e,r)=>{var n=r(4332);t.exports=function(t,e){var r=n(t,e);return r?r.version:null}},3961:(t,e,r)=>{var n=r(4426),o=r(6790),i=r(2176),a=r(4295),u=r(4332),s=r(101),c=r(7426),l=r(8187),f=r(1404),p=r(9854),h=r(7898),d=r(5305),y=r(7925),v=r(2444),m=r(806),b=r(9095),g=r(2393),w=r(4419),x=r(6681),_=r(8328),E=r(7871),O=r(2293),k=r(3987),j=r(5381),S=r(8204),A=r(4299),D=r(4078),P=r(1708),C=r(5443),L=r(4594),T=r(4339),F=r(6744),I=r(1490),N=r(7257),R=r(574),M=r(1103),B=r(4263),G=r(3602),U=r(9808),z=r(3233),$=r(396);t.exports={parse:u,valid:s,clean:c,inc:l,diff:f,major:p,minor:h,patch:d,prerelease:y,compare:v,rcompare:m,compareLoose:b,compareBuild:g,sort:w,rsort:x,gt:_,lt:E,eq:O,neq:k,gte:j,lte:S,cmp:A,coerce:D,Comparator:P,Range:C,satisfies:L,toComparators:T,maxSatisfying:F,minSatisfying:I,minVersion:N,validRange:R,outside:M,gtr:B,ltr:G,intersects:U,simplifyRange:z,subset:$,SemVer:i,re:n.re,src:n.src,tokens:n.t,SEMVER_SPEC_VERSION:o.SEMVER_SPEC_VERSION,RELEASE_TYPES:o.RELEASE_TYPES,compareIdentifiers:a.compareIdentifiers,rcompareIdentifiers:a.rcompareIdentifiers}},6790:t=>{var e=Number.MAX_SAFE_INTEGER||9007199254740991;t.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:e,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}},8684:t=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}var r="object"===("undefined"==typeof process?"undefined":e(process))&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?function(){for(var t,e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return(t=console).error.apply(t,["SEMVER"].concat(r))}:function(){};t.exports=r},4295:t=>{var e=/^[0-9]+$/,r=function(t,r){var n=e.test(t),o=e.test(r);return n&&o&&(t=+t,r=+r),t===r?0:n&&!o?-1:o&&!n?1:t<r?-1:1};t.exports={compareIdentifiers:r,rcompareIdentifiers:function(t,e){return r(e,t)}}},894:t=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}function r(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,n(o.key),o)}}function n(t){var r=function(t){if("object"!=e(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!=e(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(r)?r:r+""}var o=function(){"use strict";return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.max=1e3,this.map=new Map},(e=[{key:"get",value:function(t){var e=this.map.get(t);return void 0===e?void 0:(this.map.delete(t),this.map.set(t,e),e)}},{key:"delete",value:function(t){return this.map.delete(t)}},{key:"set",value:function(t,e){if(!this.delete(t)&&void 0!==e){if(this.map.size>=this.max){var r=this.map.keys().next().value;this.delete(r)}this.map.set(t,e)}return this}}])&&r(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();t.exports=o},1711:t=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}var r=Object.freeze({loose:!0}),n=Object.freeze({});t.exports=function(t){return t?"object"!==e(t)?r:t:n}},4426:(t,e,r)=>{function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var o=r(6790),i=o.MAX_SAFE_COMPONENT_LENGTH,a=o.MAX_SAFE_BUILD_LENGTH,u=o.MAX_LENGTH,s=r(8684),c=(e=t.exports={}).re=[],l=e.safeRe=[],f=e.src=[],p=e.t={},h=0,d="[a-zA-Z0-9-]",y=[["\\s",1],["\\d",u],[d,a]],v=function(t,e,r){var o=function(t){for(var e=0,r=y;e<r.length;e++){var o=(s=2,function(t){if(Array.isArray(t))return t}(u=r[e])||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],s=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);s=!0);}catch(t){c=!0,o=t}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(u,s)||function(t,e){if(t){if("string"==typeof t)return n(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(t,e):void 0}}(u,s)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=o[0],a=o[1];t=t.split("".concat(i,"*")).join("".concat(i,"{0,").concat(a,"}")).split("".concat(i,"+")).join("".concat(i,"{1,").concat(a,"}"))}var u,s;return t}(e),i=h++;s(t,i,e),p[t]=i,f[i]=e,c[i]=new RegExp(e,r?"g":void 0),l[i]=new RegExp(o,r?"g":void 0)};v("NUMERICIDENTIFIER","0|[1-9]\\d*"),v("NUMERICIDENTIFIERLOOSE","\\d+"),v("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-]".concat(d,"*")),v("MAINVERSION","(".concat(f[p.NUMERICIDENTIFIER],")\\.")+"(".concat(f[p.NUMERICIDENTIFIER],")\\.")+"(".concat(f[p.NUMERICIDENTIFIER],")")),v("MAINVERSIONLOOSE","(".concat(f[p.NUMERICIDENTIFIERLOOSE],")\\.")+"(".concat(f[p.NUMERICIDENTIFIERLOOSE],")\\.")+"(".concat(f[p.NUMERICIDENTIFIERLOOSE],")")),v("PRERELEASEIDENTIFIER","(?:".concat(f[p.NUMERICIDENTIFIER],"|").concat(f[p.NONNUMERICIDENTIFIER],")")),v("PRERELEASEIDENTIFIERLOOSE","(?:".concat(f[p.NUMERICIDENTIFIERLOOSE],"|").concat(f[p.NONNUMERICIDENTIFIER],")")),v("PRERELEASE","(?:-(".concat(f[p.PRERELEASEIDENTIFIER],"(?:\\.").concat(f[p.PRERELEASEIDENTIFIER],")*))")),v("PRERELEASELOOSE","(?:-?(".concat(f[p.PRERELEASEIDENTIFIERLOOSE],"(?:\\.").concat(f[p.PRERELEASEIDENTIFIERLOOSE],")*))")),v("BUILDIDENTIFIER","".concat(d,"+")),v("BUILD","(?:\\+(".concat(f[p.BUILDIDENTIFIER],"(?:\\.").concat(f[p.BUILDIDENTIFIER],")*))")),v("FULLPLAIN","v?".concat(f[p.MAINVERSION]).concat(f[p.PRERELEASE],"?").concat(f[p.BUILD],"?")),v("FULL","^".concat(f[p.FULLPLAIN],"$")),v("LOOSEPLAIN","[v=\\s]*".concat(f[p.MAINVERSIONLOOSE]).concat(f[p.PRERELEASELOOSE],"?").concat(f[p.BUILD],"?")),v("LOOSE","^".concat(f[p.LOOSEPLAIN],"$")),v("GTLT","((?:<|>)?=?)"),v("XRANGEIDENTIFIERLOOSE","".concat(f[p.NUMERICIDENTIFIERLOOSE],"|x|X|\\*")),v("XRANGEIDENTIFIER","".concat(f[p.NUMERICIDENTIFIER],"|x|X|\\*")),v("XRANGEPLAIN","[v=\\s]*(".concat(f[p.XRANGEIDENTIFIER],")")+"(?:\\.(".concat(f[p.XRANGEIDENTIFIER],")")+"(?:\\.(".concat(f[p.XRANGEIDENTIFIER],")")+"(?:".concat(f[p.PRERELEASE],")?").concat(f[p.BUILD],"?")+")?)?"),v("XRANGEPLAINLOOSE","[v=\\s]*(".concat(f[p.XRANGEIDENTIFIERLOOSE],")")+"(?:\\.(".concat(f[p.XRANGEIDENTIFIERLOOSE],")")+"(?:\\.(".concat(f[p.XRANGEIDENTIFIERLOOSE],")")+"(?:".concat(f[p.PRERELEASELOOSE],")?").concat(f[p.BUILD],"?")+")?)?"),v("XRANGE","^".concat(f[p.GTLT],"\\s*").concat(f[p.XRANGEPLAIN],"$")),v("XRANGELOOSE","^".concat(f[p.GTLT],"\\s*").concat(f[p.XRANGEPLAINLOOSE],"$")),v("COERCEPLAIN","".concat("(^|[^\\d])(\\d{1,").concat(i,"})")+"(?:\\.(\\d{1,".concat(i,"}))?")+"(?:\\.(\\d{1,".concat(i,"}))?")),v("COERCE","".concat(f[p.COERCEPLAIN],"(?:$|[^\\d])")),v("COERCEFULL",f[p.COERCEPLAIN]+"(?:".concat(f[p.PRERELEASE],")?")+"(?:".concat(f[p.BUILD],")?")+"(?:$|[^\\d])"),v("COERCERTL",f[p.COERCE],!0),v("COERCERTLFULL",f[p.COERCEFULL],!0),v("LONETILDE","(?:~>?)"),v("TILDETRIM","(\\s*)".concat(f[p.LONETILDE],"\\s+"),!0),e.tildeTrimReplace="$1~",v("TILDE","^".concat(f[p.LONETILDE]).concat(f[p.XRANGEPLAIN],"$")),v("TILDELOOSE","^".concat(f[p.LONETILDE]).concat(f[p.XRANGEPLAINLOOSE],"$")),v("LONECARET","(?:\\^)"),v("CARETTRIM","(\\s*)".concat(f[p.LONECARET],"\\s+"),!0),e.caretTrimReplace="$1^",v("CARET","^".concat(f[p.LONECARET]).concat(f[p.XRANGEPLAIN],"$")),v("CARETLOOSE","^".concat(f[p.LONECARET]).concat(f[p.XRANGEPLAINLOOSE],"$")),v("COMPARATORLOOSE","^".concat(f[p.GTLT],"\\s*(").concat(f[p.LOOSEPLAIN],")$|^$")),v("COMPARATOR","^".concat(f[p.GTLT],"\\s*(").concat(f[p.FULLPLAIN],")$|^$")),v("COMPARATORTRIM","(\\s*)".concat(f[p.GTLT],"\\s*(").concat(f[p.LOOSEPLAIN],"|").concat(f[p.XRANGEPLAIN],")"),!0),e.comparatorTrimReplace="$1$2$3",v("HYPHENRANGE","^\\s*(".concat(f[p.XRANGEPLAIN],")")+"\\s+-\\s+"+"(".concat(f[p.XRANGEPLAIN],")")+"\\s*$"),v("HYPHENRANGELOOSE","^\\s*(".concat(f[p.XRANGEPLAINLOOSE],")")+"\\s+-\\s+"+"(".concat(f[p.XRANGEPLAINLOOSE],")")+"\\s*$"),v("STAR","(<|>)?=?\\s*\\*"),v("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),v("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")},4263:(t,e,r)=>{var n=r(1103);t.exports=function(t,e,r){return n(t,e,">",r)}},9808:(t,e,r)=>{var n=r(5443);t.exports=function(t,e,r){return t=new n(t,r),e=new n(e,r),t.intersects(e,r)}},3602:(t,e,r)=>{var n=r(1103);t.exports=function(t,e,r){return n(t,e,"<",r)}},6744:(t,e,r)=>{var n=r(2176),o=r(5443);t.exports=function(t,e,r){var i=null,a=null,u=null;try{u=new o(e,r)}catch(t){return null}return t.forEach((function(t){u.test(t)&&(i&&-1!==a.compare(t)||(a=new n(i=t,r)))})),i}},1490:(t,e,r)=>{var n=r(2176),o=r(5443);t.exports=function(t,e,r){var i=null,a=null,u=null;try{u=new o(e,r)}catch(t){return null}return t.forEach((function(t){u.test(t)&&(i&&1!==a.compare(t)||(a=new n(i=t,r)))})),i}},7257:(t,e,r)=>{var n=r(2176),o=r(5443),i=r(8328);t.exports=function(t,e){t=new o(t,e);var r=new n("0.0.0");if(t.test(r))return r;if(r=new n("0.0.0-0"),t.test(r))return r;r=null;for(var a=function(){var e=t.set[u],o=null;e.forEach((function(t){var e=new n(t.semver.version);switch(t.operator){case">":0===e.prerelease.length?e.patch++:e.prerelease.push(0),e.raw=e.format();case"":case">=":o&&!i(e,o)||(o=e);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: ".concat(t.operator))}})),!o||r&&!i(r,o)||(r=o)},u=0;u<t.set.length;++u)a();return r&&t.test(r)?r:null}},1103:(t,e,r)=>{var n=r(2176),o=r(1708),i=o.ANY,a=r(5443),u=r(4594),s=r(8328),c=r(7871),l=r(8204),f=r(5381);t.exports=function(t,e,r,p){var h,d,y,v,m;switch(t=new n(t,p),e=new a(e,p),r){case">":h=s,d=l,y=c,v=">",m=">=";break;case"<":h=c,d=f,y=s,v="<",m="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(u(t,e,p))return!1;for(var b,g=function(){var r=e.set[w],n=null,a=null;return r.forEach((function(t){t.semver===i&&(t=new o(">=0.0.0")),n=n||t,a=a||t,h(t.semver,n.semver,p)?n=t:y(t.semver,a.semver,p)&&(a=t)})),n.operator===v||n.operator===m?{v:!1}:a.operator&&a.operator!==v||!d(t,a.semver)?a.operator===m&&y(t,a.semver)?{v:!1}:void 0:{v:!1}},w=0;w<e.set.length;++w)if(b=g())return b.v;return!0}},3233:(t,e,r)=>{function n(t,e){if(t){if("string"==typeof t)return o(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(t,e):void 0}}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var i=r(4594),a=r(2444);t.exports=function(t,e,r){var o,u,s,c=[],l=null,f=null,p=t.sort((function(t,e){return a(t,e,r)})),h=function(t){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=n(t))){e&&(t=e);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==e.return||e.return()}finally{if(u)throw i}}}}(p);try{for(h.s();!(o=h.n()).done;){var d=o.value;i(d,e,r)?(f=d,l||(l=d)):(f&&c.push([l,f]),f=null,l=null)}}catch(t){h.e(t)}finally{h.f()}l&&c.push([l,null]);for(var y=[],v=0,m=c;v<m.length;v++){var b=(u=m[v],s=2,function(t){if(Array.isArray(t))return t}(u)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],s=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);s=!0);}catch(t){c=!0,o=t}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(u,s)||n(u,s)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),g=b[0],w=b[1];g===w?y.push(g):w||g!==p[0]?w?g===p[0]?y.push("<=".concat(w)):y.push("".concat(g," - ").concat(w)):y.push(">=".concat(g)):y.push("*")}var x=y.join(" || "),_="string"==typeof e.raw?e.raw:String(e);return x.length<_.length?x:e}},396:(t,e,r)=>{function n(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return o(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,i=function(){};return{s:i,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,u=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return u=t.done,t},e:function(t){s=!0,a=t},f:function(){try{u||null==r.return||r.return()}finally{if(s)throw a}}}}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var i=r(5443),a=r(1708),u=a.ANY,s=r(4594),c=r(2444),l=[new a(">=0.0.0-0")],f=[new a(">=0.0.0")],p=function(t,e,r){if(t===e)return!0;if(1===t.length&&t[0].semver===u){if(1===e.length&&e[0].semver===u)return!0;t=r.includePrerelease?l:f}if(1===e.length&&e[0].semver===u){if(r.includePrerelease)return!0;e=f}var o,i,a,p,y=new Set,v=n(t);try{for(v.s();!(a=v.n()).done;){var m=a.value;">"===m.operator||">="===m.operator?o=h(o,m,r):"<"===m.operator||"<="===m.operator?i=d(i,m,r):y.add(m.semver)}}catch(t){v.e(t)}finally{v.f()}if(y.size>1)return null;if(o&&i){if((p=c(o.semver,i.semver,r))>0)return null;if(0===p&&(">="!==o.operator||"<="!==i.operator))return null}var b,g,w,x,_,E=n(y);try{for(E.s();!(b=E.n()).done;){var O=b.value;if(o&&!s(O,String(o),r))return null;if(i&&!s(O,String(i),r))return null;var k,j=n(e);try{for(j.s();!(k=j.n()).done;){var S=k.value;if(!s(O,String(S),r))return!1}}catch(t){j.e(t)}finally{j.f()}return!0}}catch(t){E.e(t)}finally{E.f()}var A=!(!i||r.includePrerelease||!i.semver.prerelease.length)&&i.semver,D=!(!o||r.includePrerelease||!o.semver.prerelease.length)&&o.semver;A&&1===A.prerelease.length&&"<"===i.operator&&0===A.prerelease[0]&&(A=!1);var P,C=n(e);try{for(C.s();!(P=C.n()).done;){var L=P.value;if(_=_||">"===L.operator||">="===L.operator,x=x||"<"===L.operator||"<="===L.operator,o)if(D&&L.semver.prerelease&&L.semver.prerelease.length&&L.semver.major===D.major&&L.semver.minor===D.minor&&L.semver.patch===D.patch&&(D=!1),">"===L.operator||">="===L.operator){if((g=h(o,L,r))===L&&g!==o)return!1}else if(">="===o.operator&&!s(o.semver,String(L),r))return!1;if(i)if(A&&L.semver.prerelease&&L.semver.prerelease.length&&L.semver.major===A.major&&L.semver.minor===A.minor&&L.semver.patch===A.patch&&(A=!1),"<"===L.operator||"<="===L.operator){if((w=d(i,L,r))===L&&w!==i)return!1}else if("<="===i.operator&&!s(i.semver,String(L),r))return!1;if(!L.operator&&(i||o)&&0!==p)return!1}}catch(t){C.e(t)}finally{C.f()}return!(o&&x&&!i&&0!==p||i&&_&&!o&&0!==p||D||A)},h=function(t,e,r){if(!t)return e;var n=c(t.semver,e.semver,r);return n>0?t:n<0||">"===e.operator&&">="===t.operator?e:t},d=function(t,e,r){if(!t)return e;var n=c(t.semver,e.semver,r);return n<0?t:n>0||"<"===e.operator&&"<="===t.operator?e:t};t.exports=function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t===e)return!0;t=new i(t,r),e=new i(e,r);var o,a=!1,u=n(t.set);try{t:for(u.s();!(o=u.n()).done;){var s,c=o.value,l=n(e.set);try{for(l.s();!(s=l.n()).done;){var f=s.value,h=p(c,f,r);if(a=a||null!==h,h)continue t}}catch(t){l.e(t)}finally{l.f()}if(a)return!1}}catch(t){u.e(t)}finally{u.f()}return!0}},4339:(t,e,r)=>{var n=r(5443);t.exports=function(t,e){return new n(t,e).set.map((function(t){return t.map((function(t){return t.value})).join(" ").trim().split(" ")}))}},574:(t,e,r)=>{var n=r(5443);t.exports=function(t,e){try{return new n(t,e).range||"*"}catch(t){return null}}},3316:t=>{"use strict";t.exports=function(t,e){return e=e||function(){},t.then((function(t){return new Promise((function(t){t(e())})).then((function(){return t}))}),(function(t){return new Promise((function(t){t(e())})).then((function(){throw t}))}))}},4869:(t,e,r)=>{"use strict";function n(){n=function(){return e};var t,e={},r=Object.prototype,o=r.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},u="function"==typeof Symbol?Symbol:{},s=u.iterator||"@@iterator",c=u.asyncIterator||"@@asyncIterator",l=u.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,r){return t[e]=r}}function p(t,e,r,n){var o=e&&e.prototype instanceof g?e:g,a=Object.create(o.prototype),u=new L(n||[]);return i(a,"_invoke",{value:A(t,r,u)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=p;var d="suspendedStart",y="suspendedYield",v="executing",m="completed",b={};function g(){}function w(){}function x(){}var _={};f(_,s,(function(){return this}));var E=Object.getPrototypeOf,O=E&&E(E(T([])));O&&O!==r&&o.call(O,s)&&(_=O);var k=x.prototype=g.prototype=Object.create(_);function j(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(n,i,u,s){var c=h(t[n],t,i);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==a(f)&&o.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,u,s)}),(function(t){r("throw",t,u,s)})):e.resolve(f).then((function(t){l.value=t,u(l)}),(function(t){return r("throw",t,u,s)}))}s(c.arg)}var n;i(this,"_invoke",{value:function(t,o){function i(){return new e((function(e,n){r(t,o,e,n)}))}return n=n?n.then(i,i):i()}})}function A(e,r,n){var o=d;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=D(u,n);if(s){if(s===b)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var c=h(e,r,n);if("normal"===c.type){if(o=n.done?m:y,c.arg===b)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=m,n.method="throw",n.arg=c.arg)}}}function D(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,D(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,b;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,b):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,b)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[s];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function r(){for(;++n<e.length;)if(o.call(e,n))return r.value=e[n],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(a(e)+" is not iterable")}return w.prototype=x,i(k,"constructor",{value:x,configurable:!0}),i(x,"constructor",{value:w,configurable:!0}),w.displayName=f(x,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,f(t,l,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},j(S.prototype),f(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(p(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},j(k),f(k,l,"Generator"),f(k,s,(function(){return this})),f(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var s=o.call(a,"catchLoc"),c=o.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,b):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),C(r),b}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;C(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),b}},e}function o(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function i(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var a=t.apply(e,r);function u(t){o(a,n,i,u,s,"next",t)}function s(t){o(a,n,i,u,s,"throw",t)}u(void 0)}))}}function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function u(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,s(n.key),n)}}function s(t){var e=function(t){if("object"!=a(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==a(e)?e:e+""}function c(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(c=function(){return!!t})()}function l(t){return l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},l(t)}function f(t,e){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},f(t,e)}Object.defineProperty(e,"__esModule",{value:!0});var p=r(2557),h=r(4372),d=r(1047),y=function(){},v=new h.TimeoutError,m=function(t){function e(t){var r,n,o,i,u;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=function(t,e,r){return e=l(e),function(t,e){if(e&&("object"==a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,c()?Reflect.construct(e,r||[],l(t).constructor):e.apply(t,r))}(this,e))._intervalCount=0,r._intervalEnd=0,r._pendingCount=0,r._resolveEmpty=y,r._resolveIdle=y,!("number"==typeof(t=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:d.default},t)).intervalCap&&t.intervalCap>=1))throw new TypeError("Expected `intervalCap` to be a number from 1 and up, got `".concat(null!==(o=null===(n=t.intervalCap)||void 0===n?void 0:n.toString())&&void 0!==o?o:"","` (").concat(a(t.intervalCap),")"));if(void 0===t.interval||!(Number.isFinite(t.interval)&&t.interval>=0))throw new TypeError("Expected `interval` to be a finite number >= 0, got `".concat(null!==(u=null===(i=t.interval)||void 0===i?void 0:i.toString())&&void 0!==u?u:"","` (").concat(a(t.interval),")"));return r._carryoverConcurrencyCount=t.carryoverConcurrencyCount,r._isIntervalIgnored=t.intervalCap===1/0||0===t.interval,r._intervalCap=t.intervalCap,r._interval=t.interval,r._queue=new t.queueClass,r._queueClass=t.queueClass,r.concurrency=t.concurrency,r._timeout=t.timeout,r._throwOnTimeout=!0===t.throwOnTimeout,r._isPaused=!1===t.autoStart,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&f(t,e)}(e,t),r=e,o=[{key:"_doesIntervalAllowAnother",get:function(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}},{key:"_doesConcurrentAllowAnother",get:function(){return this._pendingCount<this._concurrency}},{key:"_next",value:function(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}},{key:"_resolvePromises",value:function(){this._resolveEmpty(),this._resolveEmpty=y,0===this._pendingCount&&(this._resolveIdle(),this._resolveIdle=y,this.emit("idle"))}},{key:"_onResumeInterval",value:function(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}},{key:"_isIntervalPaused",value:function(){var t=this,e=Date.now();if(void 0===this._intervalId){var r=this._intervalEnd-e;if(!(r<0))return void 0===this._timeoutId&&(this._timeoutId=setTimeout((function(){t._onResumeInterval()}),r)),!0;this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0}return!1}},{key:"_tryToStartAnother",value:function(){if(0===this._queue.size)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){var t=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){var e=this._queue.dequeue();return!!e&&(this.emit("active"),e(),t&&this._initializeIntervalIfNeeded(),!0)}}return!1}},{key:"_initializeIntervalIfNeeded",value:function(){var t=this;this._isIntervalIgnored||void 0!==this._intervalId||(this._intervalId=setInterval((function(){t._onInterval()}),this._interval),this._intervalEnd=Date.now()+this._interval)}},{key:"_onInterval",value:function(){0===this._intervalCount&&0===this._pendingCount&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}},{key:"_processQueue",value:function(){for(;this._tryToStartAnother(););}},{key:"concurrency",get:function(){return this._concurrency},set:function(t){if(!("number"==typeof t&&t>=1))throw new TypeError("Expected `concurrency` to be a number from 1 and up, got `".concat(t,"` (").concat(a(t),")"));this._concurrency=t,this._processQueue()}},{key:"add",value:(b=i(n().mark((function t(e){var r,o=this,a=arguments;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a.length>1&&void 0!==a[1]?a[1]:{},t.abrupt("return",new Promise((function(t,a){var u=function(){var u=i(n().mark((function i(){var u;return n().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o._pendingCount++,o._intervalCount++,n.prev=2,u=void 0===o._timeout&&void 0===r.timeout?e():h.default(Promise.resolve(e()),void 0===r.timeout?o._timeout:r.timeout,(function(){(void 0===r.throwOnTimeout?o._throwOnTimeout:r.throwOnTimeout)&&a(v)})),n.t0=t,n.next=7,u;case 7:n.t1=n.sent,(0,n.t0)(n.t1),n.next=14;break;case 11:n.prev=11,n.t2=n.catch(2),a(n.t2);case 14:o._next();case 15:case"end":return n.stop()}}),i,null,[[2,11]])})));return function(){return u.apply(this,arguments)}}();o._queue.enqueue(u,r),o._tryToStartAnother(),o.emit("add")})));case 2:case"end":return t.stop()}}),t)}))),function(t){return b.apply(this,arguments)})},{key:"addAll",value:(m=i(n().mark((function t(e,r){var o=this;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Promise.all(e.map(function(){var t=i(n().mark((function t(e){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",o.add(e,r));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())));case 1:case"end":return t.stop()}}),t)}))),function(t,e){return m.apply(this,arguments)})},{key:"start",value:function(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}},{key:"pause",value:function(){this._isPaused=!0}},{key:"clear",value:function(){this._queue=new this._queueClass}},{key:"onEmpty",value:(p=i(n().mark((function t(){var e=this;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0!==this._queue.size){t.next=2;break}return t.abrupt("return");case 2:return t.abrupt("return",new Promise((function(t){var r=e._resolveEmpty;e._resolveEmpty=function(){r(),t()}})));case 3:case"end":return t.stop()}}),t,this)}))),function(){return p.apply(this,arguments)})},{key:"onIdle",value:(s=i(n().mark((function t(){var e=this;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0!==this._pendingCount||0!==this._queue.size){t.next=2;break}return t.abrupt("return");case 2:return t.abrupt("return",new Promise((function(t){var r=e._resolveIdle;e._resolveIdle=function(){r(),t()}})));case 3:case"end":return t.stop()}}),t,this)}))),function(){return s.apply(this,arguments)})},{key:"size",get:function(){return this._queue.size}},{key:"sizeBy",value:function(t){return this._queue.filter(t).length}},{key:"pending",get:function(){return this._pendingCount}},{key:"isPaused",get:function(){return this._isPaused}},{key:"timeout",get:function(){return this._timeout},set:function(t){this._timeout=t}}],o&&u(r.prototype,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,o,s,p,m,b}(p);e.default=m},3213:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,r){for(var n=0,o=t.length;o>0;){var i=o/2|0,a=n+i;r(t[a],e)<=0?(n=++a,o-=i+1):o=i}return n}},1047:(t,e,r)=>{"use strict";function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,i(n.key),n)}}function i(t){var e=function(t){if("object"!=n(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==n(e)?e:e+""}Object.defineProperty(e,"__esModule",{value:!0});var a=r(3213),u=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._queue=[]},(e=[{key:"enqueue",value:function(t,e){var r={priority:(e=Object.assign({priority:0},e)).priority,run:t};if(this.size&&this._queue[this.size-1].priority>=e.priority)this._queue.push(r);else{var n=a.default(this._queue,r,(function(t,e){return e.priority-t.priority}));this._queue.splice(n,0,r)}}},{key:"dequeue",value:function(){var t=this._queue.shift();return null==t?void 0:t.run}},{key:"filter",value:function(t){return this._queue.filter((function(e){return e.priority===t.priority})).map((function(t){return t.run}))}},{key:"size",get:function(){return this._queue.length}}])&&o(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();e.default=u},1461:(t,e,r)=>{"use strict";function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(){o=function(){return e};var t,e={},r=Object.prototype,i=r.hasOwnProperty,a=Object.defineProperty||function(t,e,r){t[e]=r.value},u="function"==typeof Symbol?Symbol:{},s=u.iterator||"@@iterator",c=u.asyncIterator||"@@asyncIterator",l=u.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,r){return t[e]=r}}function p(t,e,r,n){var o=e&&e.prototype instanceof g?e:g,i=Object.create(o.prototype),u=new L(n||[]);return a(i,"_invoke",{value:A(t,r,u)}),i}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=p;var d="suspendedStart",y="suspendedYield",v="executing",m="completed",b={};function g(){}function w(){}function x(){}var _={};f(_,s,(function(){return this}));var E=Object.getPrototypeOf,O=E&&E(E(T([])));O&&O!==r&&i.call(O,s)&&(_=O);var k=x.prototype=g.prototype=Object.create(_);function j(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,a,u,s){var c=h(t[o],t,a);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==n(f)&&i.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,u,s)}),(function(t){r("throw",t,u,s)})):e.resolve(f).then((function(t){l.value=t,u(l)}),(function(t){return r("throw",t,u,s)}))}s(c.arg)}var o;a(this,"_invoke",{value:function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}})}function A(e,r,n){var o=d;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=D(u,n);if(s){if(s===b)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var c=h(e,r,n);if("normal"===c.type){if(o=n.done?m:y,c.arg===b)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=m,n.method="throw",n.arg=c.arg)}}}function D(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,D(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,b;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,b):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,b)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[s];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(i.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(n(e)+" is not iterable")}return w.prototype=x,a(k,"constructor",{value:x,configurable:!0}),a(x,"constructor",{value:w,configurable:!0}),w.displayName=f(x,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,f(t,l,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},j(S.prototype),f(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(p(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},j(k),f(k,l,"Generator"),f(k,s,(function(){return this})),f(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var r in this)"t"===r.charAt(0)&&i.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],u=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var s=i.call(a,"catchLoc"),c=i.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,b):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),C(r),b}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;C(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),b}},e}function i(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function a(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function u(t,e,r){return(e=s(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function s(t){var e=function(t){if("object"!=n(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==n(e)?e:e+""}function c(t){var e="function"==typeof Map?new Map:void 0;return c=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(e){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return function(t,e,r){if(l())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,e);var o=new(t.bind.apply(t,n));return r&&f(o,r.prototype),o}(t,arguments,p(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),f(r,t)},c(t)}function l(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(l=function(){return!!t})()}function f(t,e){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},f(t,e)}function p(t){return p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},p(t)}var h=r(56),d=["Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed"],y=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=function(t,e,r){return e=p(e),function(t,e){if(e&&("object"==n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,l()?Reflect.construct(e,r||[],p(t).constructor):e.apply(t,r))}(this,e),t instanceof Error?(r.originalError=t,t=t.message):(r.originalError=new Error(t),r.originalError.stack=r.stack),r.name="AbortError",r.message=t,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&f(t,e)}(e,t),r=e,Object.defineProperty(r,"prototype",{writable:!1}),r;var r}(c(Error)),v=function(t,e,r){var n=r.retries-(e-1);return t.attemptNumber=e,t.retriesLeft=n,t},m=function(t,e){return new Promise((function(r,n){e=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?a(Object(r),!0).forEach((function(e){u(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({onFailedAttempt:function(){},retries:10},e);var s=h.operation(e);s.attempt(function(){var a,u=(a=o().mark((function i(a){return o().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.t0=r,o.next=4,t(a);case 4:o.t1=o.sent,(0,o.t0)(o.t1),o.next=34;break;case 8:if(o.prev=8,o.t2=o.catch(0),o.t2 instanceof Error){o.next=13;break}return n(new TypeError('Non-error was thrown: "'.concat(o.t2,'". You should only throw errors.'))),o.abrupt("return");case 13:if(!(o.t2 instanceof y)){o.next=18;break}s.stop(),n(o.t2.originalError),o.next=34;break;case 18:if(!(o.t2 instanceof TypeError)||(i=o.t2.message,d.includes(i))){o.next=23;break}s.stop(),n(o.t2),o.next=34;break;case 23:return v(o.t2,a,e),o.prev=24,o.next=27,e.onFailedAttempt(o.t2);case 27:o.next=33;break;case 29:return o.prev=29,o.t3=o.catch(24),n(o.t3),o.abrupt("return");case 33:s.retry(o.t2)||n(s.mainError());case 34:case"end":return o.stop()}var i}),i,null,[[0,8],[24,29]])})),function(){var t=this,e=arguments;return new Promise((function(r,n){var o=a.apply(t,e);function u(t){i(o,r,n,u,s,"next",t)}function s(t){i(o,r,n,u,s,"throw",t)}u(void 0)}))});return function(t){return u.apply(this,arguments)}}())}))};t.exports=m,t.exports.default=m,t.exports.AbortError=y},4372:(t,e,r)=>{"use strict";function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(t){var e="function"==typeof Map?new Map:void 0;return o=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(e){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return function(t,e,r){if(i())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,e);var o=new(t.bind.apply(t,n));return r&&a(o,r.prototype),o}(t,arguments,u(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),a(r,t)},o(t)}function i(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(i=function(){return!!t})()}function a(t,e){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},a(t,e)}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}var s=r(3316),c=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=function(t,e,r){return e=u(e),function(t,e){if(e&&("object"==n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,i()?Reflect.construct(e,r||[],u(t).constructor):e.apply(t,r))}(this,e,[t])).name="TimeoutError",r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(e,t),r=e,Object.defineProperty(r,"prototype",{writable:!1}),r;var r}(o(Error)),l=function(t,e,r){return new Promise((function(n,o){if("number"!=typeof e||e<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(e!==1/0){var i=setTimeout((function(){if("function"!=typeof r){var i="string"==typeof r?r:"Promise timed out after ".concat(e," milliseconds"),a=r instanceof Error?r:new c(i);"function"==typeof t.cancel&&t.cancel(),o(a)}else try{n(r())}catch(t){o(t)}}),e);s(t.then(n,o),(function(){clearTimeout(i)}))}else n(t)}))};t.exports=l,t.exports.default=l,t.exports.TimeoutError=c},56:(t,e,r)=>{t.exports=r(406)},406:(t,e,r)=>{var n=r(6072);e.operation=function(t){var r=e.timeouts(t);return new n(r,{forever:t&&(t.forever||t.retries===1/0),unref:t&&t.unref,maxRetryTime:t&&t.maxRetryTime})},e.timeouts=function(t){if(t instanceof Array)return[].concat(t);var e={retries:10,factor:2,minTimeout:1e3,maxTimeout:1/0,randomize:!1};for(var r in t)e[r]=t[r];if(e.minTimeout>e.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var n=[],o=0;o<e.retries;o++)n.push(this.createTimeout(o,e));return t&&t.forever&&!n.length&&n.push(this.createTimeout(o,e)),n.sort((function(t,e){return t-e})),n},e.createTimeout=function(t,e){var r=e.randomize?Math.random()+1:1,n=Math.round(r*Math.max(e.minTimeout,1)*Math.pow(e.factor,t));return Math.min(n,e.maxTimeout)},e.wrap=function(t,r,n){if(r instanceof Array&&(n=r,r=null),!n)for(var o in n=[],t)"function"==typeof t[o]&&n.push(o);for(var i=0;i<n.length;i++){var a=n[i],u=t[a];t[a]=function(n){var o=e.operation(r),i=Array.prototype.slice.call(arguments,1),a=i.pop();i.push((function(t){o.retry(t)||(t&&(arguments[0]=o.mainError()),a.apply(this,arguments))})),o.attempt((function(){n.apply(t,i)}))}.bind(t,u),t[a].options=r}}},6072:t=>{function e(t,e){"boolean"==typeof e&&(e={forever:e}),this._originalTimeouts=JSON.parse(JSON.stringify(t)),this._timeouts=t,this._options=e||{},this._maxRetryTime=e&&e.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}t.exports=e,e.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)},e.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null},e.prototype.retry=function(t){if(this._timeout&&clearTimeout(this._timeout),!t)return!1;var e=(new Date).getTime();if(t&&e-this._operationStart>=this._maxRetryTime)return this._errors.push(t),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(t);var r=this._timeouts.shift();if(void 0===r){if(!this._cachedTimeouts)return!1;this._errors.splice(0,this._errors.length-1),r=this._cachedTimeouts.slice(-1)}var n=this;return this._timer=setTimeout((function(){n._attempts++,n._operationTimeoutCb&&(n._timeout=setTimeout((function(){n._operationTimeoutCb(n._attempts)}),n._operationTimeout),n._options.unref&&n._timeout.unref()),n._fn(n._attempts)}),r),this._options.unref&&this._timer.unref(),!0},e.prototype.attempt=function(t,e){this._fn=t,e&&(e.timeout&&(this._operationTimeout=e.timeout),e.cb&&(this._operationTimeoutCb=e.cb));var r=this;this._operationTimeoutCb&&(this._timeout=setTimeout((function(){r._operationTimeoutCb()}),r._operationTimeout)),this._operationStart=(new Date).getTime(),this._fn(this._attempts)},e.prototype.try=function(t){console.log("Using RetryOperation.try() is deprecated"),this.attempt(t)},e.prototype.start=function(t){console.log("Using RetryOperation.start() is deprecated"),this.attempt(t)},e.prototype.start=e.prototype.try,e.prototype.errors=function(){return this._errors},e.prototype.attempts=function(){return this._attempts},e.prototype.mainError=function(){if(0===this._errors.length)return null;for(var t={},e=null,r=0,n=0;n<this._errors.length;n++){var o=this._errors[n],i=o.message,a=(t[i]||0)+1;t[i]=a,a>=r&&(e=o,r=a)}return e}},4633:(t,e,r)=>{t=r.nmd(t);var n=r(494);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}var i=void 0,a=function(e){return i||(i=new Promise((function(n,i){var a,u=void 0!==e?e:{},s=u.onAbort;u.onAbort=function(t){i(new Error(t)),s&&s(t)},u.postRun=u.postRun||[],u.postRun.push((function(){n(u)})),t=void 0,a||(a=void 0!==u?u:{}),a.onRuntimeInitialized=function(){function t(t,e){switch(o(e)){case"boolean":W(t,e?1:0);break;case"number":H(t,e);break;case"string":Y(t,e,-1,-1);break;case"object":if(null===e)Z(t);else if(null!=e.length){var r=je(e);V(t,r,e.length,-1),Ce(r)}else J(t,"Wrong API use : tried to return a value of an unknown type ("+e+").",-1);break;default:Z(t)}}function e(t,e){for(var r=[],n=0;n<t;n+=1){var o=rt(e+4*n,"i32"),i=U(o);if(1===i||2===i)o=K(o);else if(3===i)o=$(o);else if(4===i){o=z(i=o),i=q(i);for(var a=new Uint8Array(o),u=0;u<o;u+=1)a[u]=j[i+u];o=a}else o=null;r.push(o)}return r}function r(t,e){this.La=t,this.db=e,this.Ja=1,this.fb=[]}function n(t,e){if(this.db=e,e=M(t)+1,this.Ya=Pe(e),null===this.Ya)throw Error("Unable to allocate memory for the SQL string");R(t,S,this.Ya,e),this.eb=this.Ya,this.Ua=this.ib=null}function i(t){if(this.filename="dbfile_"+(4294967295*Math.random()>>>0),null!=t){var e=this.filename,r="/",n=e;if(r&&(r="string"==typeof r?r:Dt(r),n=e?it(r+"/"+e):r),e=ue(!0,!0),n=$t(n,4095&(void 0!==e?e:438)|32768,0),t){if("string"==typeof t){r=Array(t.length);for(var o=0,i=t.length;o<i;++o)r[o]=t.charCodeAt(o);t=r}Xt(n,146|e),r=te(n,577),oe(r,t,0,t.length,0),ee(r),Xt(n,e)}}this.handleError(c(this.filename,u)),this.db=rt(u,"i32"),Q(this.db),this.Za={},this.Na={}}var u=Ne(4),s=a.cwrap,c=s("sqlite3_open","number",["string","number"]),l=s("sqlite3_close_v2","number",["number"]),f=s("sqlite3_exec","number",["number","string","number","number","number"]),p=s("sqlite3_changes","number",["number"]),h=s("sqlite3_prepare_v2","number",["number","string","number","number","number"]),d=s("sqlite3_sql","string",["number"]),y=s("sqlite3_normalized_sql","string",["number"]),v=s("sqlite3_prepare_v2","number",["number","number","number","number","number"]),m=s("sqlite3_bind_text","number",["number","number","number","number","number"]),b=s("sqlite3_bind_blob","number",["number","number","number","number","number"]),g=s("sqlite3_bind_double","number",["number","number","number"]),w=s("sqlite3_bind_int","number",["number","number","number"]),x=s("sqlite3_bind_parameter_index","number",["number","string"]),_=s("sqlite3_step","number",["number"]),E=s("sqlite3_errmsg","string",["number"]),O=s("sqlite3_column_count","number",["number"]),k=s("sqlite3_data_count","number",["number"]),A=s("sqlite3_column_double","number",["number","number"]),D=s("sqlite3_column_text","string",["number","number"]),P=s("sqlite3_column_blob","number",["number","number"]),C=s("sqlite3_column_bytes","number",["number","number"]),L=s("sqlite3_column_type","number",["number","number"]),T=s("sqlite3_column_name","string",["number","number"]),F=s("sqlite3_reset","number",["number"]),I=s("sqlite3_clear_bindings","number",["number"]),B=s("sqlite3_finalize","number",["number"]),G=s("sqlite3_create_function_v2","number","number string number number number number number number number".split(" ")),U=s("sqlite3_value_type","number",["number"]),z=s("sqlite3_value_bytes","number",["number"]),$=s("sqlite3_value_text","string",["number"]),q=s("sqlite3_value_blob","number",["number"]),K=s("sqlite3_value_double","number",["number"]),H=s("sqlite3_result_double","",["number","number"]),Z=s("sqlite3_result_null","",["number"]),Y=s("sqlite3_result_text","",["number","string","number","number"]),V=s("sqlite3_result_blob","",["number","number","number","number"]),W=s("sqlite3_result_int","",["number","number"]),J=s("sqlite3_result_error","",["number","string","number"]),X=s("sqlite3_aggregate_context","number",["number","number"]),Q=s("RegisterExtensionFunctions","number",["number"]);r.prototype.bind=function(t){if(!this.La)throw"Statement closed";return this.reset(),Array.isArray(t)?this.xb(t):null==t||"object"!==o(t)||this.yb(t)},r.prototype.step=function(){if(!this.La)throw"Statement closed";this.Ja=1;var t=_(this.La);switch(t){case 100:return!0;case 101:return!1;default:throw this.db.handleError(t)}},r.prototype.sb=function(t){return null==t&&(t=this.Ja,this.Ja+=1),A(this.La,t)},r.prototype.Cb=function(t){if(null==t&&(t=this.Ja,this.Ja+=1),t=D(this.La,t),"function"!=typeof BigInt)throw Error("BigInt is not supported");return BigInt(t)},r.prototype.Db=function(t){return null==t&&(t=this.Ja,this.Ja+=1),D(this.La,t)},r.prototype.getBlob=function(t){null==t&&(t=this.Ja,this.Ja+=1);var e=C(this.La,t);t=P(this.La,t);for(var r=new Uint8Array(e),n=0;n<e;n+=1)r[n]=j[t+n];return r},r.prototype.get=function(t,e){e=e||{},null!=t&&this.bind(t)&&this.step(),t=[];for(var r=k(this.La),n=0;n<r;n+=1)switch(L(this.La,n)){case 1:var o=e.useBigInt?this.Cb(n):this.sb(n);t.push(o);break;case 2:t.push(this.sb(n));break;case 3:t.push(this.Db(n));break;case 4:t.push(this.getBlob(n));break;default:t.push(null)}return t},r.prototype.getColumnNames=function(){for(var t=[],e=O(this.La),r=0;r<e;r+=1)t.push(T(this.La,r));return t},r.prototype.getAsObject=function(t,e){t=this.get(t,e),e=this.getColumnNames();for(var r={},n=0;n<e.length;n+=1)r[e[n]]=t[n];return r},r.prototype.getSQL=function(){return d(this.La)},r.prototype.getNormalizedSQL=function(){return y(this.La)},r.prototype.run=function(t){return null!=t&&this.bind(t),this.step(),this.reset()},r.prototype.nb=function(t,e){null==e&&(e=this.Ja,this.Ja+=1);var r=je(t=ct(t));this.fb.push(r),this.db.handleError(m(this.La,e,r,t.length-1,0))},r.prototype.wb=function(t,e){null==e&&(e=this.Ja,this.Ja+=1);var r=je(t);this.fb.push(r),this.db.handleError(b(this.La,e,r,t.length,0))},r.prototype.mb=function(t,e){null==e&&(e=this.Ja,this.Ja+=1),this.db.handleError((t===(0|t)?w:g)(this.La,e,t))},r.prototype.zb=function(t){null==t&&(t=this.Ja,this.Ja+=1),b(this.La,t,0,0,0)},r.prototype.ob=function(t,e){switch(null==e&&(e=this.Ja,this.Ja+=1),o(t)){case"string":return void this.nb(t,e);case"number":return void this.mb(t,e);case"bigint":return void this.nb(t.toString(),e);case"boolean":return void this.mb(t+0,e);case"object":if(null===t)return void this.zb(e);if(null!=t.length)return void this.wb(t,e)}throw"Wrong API use : tried to bind a value of an unknown type ("+t+")."},r.prototype.yb=function(t){var e=this;return Object.keys(t).forEach((function(r){var n=x(e.La,r);0!==n&&e.ob(t[r],n)})),!0},r.prototype.xb=function(t){for(var e=0;e<t.length;e+=1)this.ob(t[e],e+1);return!0},r.prototype.reset=function(){return this.freemem(),0===I(this.La)&&0===F(this.La)},r.prototype.freemem=function(){for(var t;void 0!==(t=this.fb.pop());)Ce(t)},r.prototype.free=function(){this.freemem();var t=0===B(this.La);return delete this.db.Za[this.La],this.La=0,t},n.prototype.next=function(){if(null===this.Ya)return{done:!0};if(null!==this.Ua&&(this.Ua.free(),this.Ua=null),!this.db.db)throw this.gb(),Error("Database closed");var t=Fe(),e=Ne(4);nt(u),nt(e);try{this.db.handleError(v(this.db.db,this.eb,-1,u,e)),this.eb=rt(e,"i32");var n=rt(u,"i32");return 0===n?(this.gb(),{done:!0}):(this.Ua=new r(n,this.db),this.db.Za[n]=this.Ua,{value:this.Ua,done:!1})}catch(t){throw this.ib=N(this.eb),this.gb(),t}finally{Ie(t)}},n.prototype.gb=function(){Ce(this.Ya),this.Ya=null},n.prototype.getRemainingSQL=function(){return null!==this.ib?this.ib:N(this.eb)},"function"==typeof Symbol&&"symbol"===o(Symbol.iterator)&&(n.prototype[Symbol.iterator]=function(){return this}),i.prototype.run=function(t,e){if(!this.db)throw"Database closed";if(e){t=this.prepare(t,e);try{t.step()}finally{t.free()}}else this.handleError(f(this.db,t,0,0,u));return this},i.prototype.exec=function(t,e,n){if(!this.db)throw"Database closed";var o=Fe(),i=null;try{var a=M(t)+1,s=Ne(a);R(t,j,s,a);var c=s,l=Ne(4);for(t=[];0!==rt(c,"i8");){nt(u),nt(l),this.handleError(v(this.db,c,-1,u,l));var f=rt(u,"i32");if(c=rt(l,"i32"),0!==f){for(a=null,i=new r(f,this),null!=e&&i.bind(e);i.step();)null===a&&(a={columns:i.getColumnNames(),values:[]},t.push(a)),a.values.push(i.get(null,n));i.free()}}return t}catch(t){throw i&&i.free(),t}finally{Ie(o)}},i.prototype.each=function(t,e,r,n,o){"function"==typeof e&&(n=r,r=e,e=void 0),t=this.prepare(t,e);try{for(;t.step();)r(t.getAsObject(null,o))}finally{t.free()}if("function"==typeof n)return n()},i.prototype.prepare=function(t,e){if(nt(u),this.handleError(h(this.db,t,-1,u,0)),0===(t=rt(u,"i32")))throw"Nothing to prepare";var n=new r(t,this);return null!=e&&n.bind(e),this.Za[t]=n},i.prototype.iterateStatements=function(t){return new n(t,this)},i.prototype.export=function(){Object.values(this.Za).forEach((function(t){t.free()})),Object.values(this.Na).forEach(Ee),this.Na={},this.handleError(l(this.db));var t=ie(this.filename);return this.handleError(c(this.filename,u)),this.db=rt(u,"i32"),t},i.prototype.close=function(){null!==this.db&&(Object.values(this.Za).forEach((function(t){t.free()})),Object.values(this.Na).forEach(Ee),this.Na={},this.handleError(l(this.db)),Yt("/"+this.filename),this.db=null)},i.prototype.handleError=function(t){if(0===t)return null;throw t=E(this.db),Error(t)},i.prototype.getRowsModified=function(){return p(this.db)},i.prototype.create_function=function(r,n){Object.prototype.hasOwnProperty.call(this.Na,r)&&(Ee(this.Na[r]),delete this.Na[r]);var o=_e((function(r,o,i){o=e(o,i);try{var a=n.apply(null,o)}catch(t){return void J(r,t,-1)}t(r,a)}),"viii");return this.Na[r]=o,this.handleError(G(this.db,r,n.length,1,0,o,0,0,0)),this},i.prototype.create_aggregate=function(r,n){var o=n.init||function(){return null},i=n.finalize||function(t){return t},a=n.step;if(!a)throw"An aggregate function must have a step function in "+r;var u={};Object.hasOwnProperty.call(this.Na,r)&&(Ee(this.Na[r]),delete this.Na[r]),n=r+"__finalize",Object.hasOwnProperty.call(this.Na,n)&&(Ee(this.Na[n]),delete this.Na[n]);var s=_e((function(t,r,n){var i=X(t,1);Object.hasOwnProperty.call(u,i)||(u[i]=o()),r=e(r,n),r=[u[i]].concat(r);try{u[i]=a.apply(null,r)}catch(e){delete u[i],J(t,e,-1)}}),"viii"),c=_e((function(e){var r=X(e,1);try{var n=i(u[r])}catch(t){return delete u[r],void J(e,t,-1)}t(e,n),delete u[r]}),"vi");return this.Na[r]=s,this.Na[n]=c,this.handleError(G(this.db,r,a.length-1,1,0,0,s,c,0)),this},a.Database=i};var c,l,f,p,h,d,y=Object.assign({},a),v="./this.program",m="object"==("undefined"==typeof window?"undefined":o(window)),b="function"==typeof importScripts,g="object"==("undefined"==typeof process?"undefined":o(process))&&"object"==o(process.versions)&&"string"==typeof process.versions.node,w="";g?(w=b?r(9234).dirname(w)+"/":"//",d=function(){h||(p=r(6490),h=r(9234))},c=function(t,e){return d(),t=h.normalize(t),p.readFileSync(t,e?void 0:"utf8")},f=function(t){return(t=c(t,!0)).buffer||(t=new Uint8Array(t)),t},l=function(t,e,r){d(),t=h.normalize(t),p.readFile(t,(function(t,n){t?r(t):e(n.buffer)}))},1<process.argv.length&&(v=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),t.exports=a,a.inspect=function(){return"[Emscripten Module object]"}):(m||b)&&(b?w=self.location.href:"undefined"!=typeof document&&document.currentScript&&(w=document.currentScript.src),w=0!==w.indexOf("blob:")?w.substr(0,w.replace(/[?#].*/,"").lastIndexOf("/")+1):"",c=function(t){var e=new XMLHttpRequest;return e.open("GET",t,!1),e.send(null),e.responseText},b&&(f=function(t){var e=new XMLHttpRequest;return e.open("GET",t,!1),e.responseType="arraybuffer",e.send(null),new Uint8Array(e.response)}),l=function(t,e,r){var n=new XMLHttpRequest;n.open("GET",t,!0),n.responseType="arraybuffer",n.onload=function(){200==n.status||0==n.status&&n.response?e(n.response):r()},n.onerror=r,n.send(null)});var x,_=a.print||console.log.bind(console),E=a.printErr||console.warn.bind(console);Object.assign(a,y),y=null,a.thisProgram&&(v=a.thisProgram),a.wasmBinary&&(x=a.wasmBinary),a.noExitRuntime,"object"!=("undefined"==typeof WebAssembly?"undefined":o(WebAssembly))&&J("no native wasm support detected");var O,k,j,S,A,D,P,C,L,T=!1,F="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function I(t,e,r){var n=e+r;for(r=e;t[r]&&!(r>=n);)++r;if(16<r-e&&t.buffer&&F)return F.decode(t.subarray(e,r));for(n="";e<r;){var o=t[e++];if(128&o){var i=63&t[e++];if(192==(224&o))n+=String.fromCharCode((31&o)<<6|i);else{var a=63&t[e++];65536>(o=224==(240&o)?(15&o)<<12|i<<6|a:(7&o)<<18|i<<12|a<<6|63&t[e++])?n+=String.fromCharCode(o):(o-=65536,n+=String.fromCharCode(55296|o>>10,56320|1023&o))}}else n+=String.fromCharCode(o)}return n}function N(t,e){return t?I(S,t,e):""}function R(t,e,r,n){if(!(0<n))return 0;var o=r;n=r+n-1;for(var i=0;i<t.length;++i){var a=t.charCodeAt(i);if(55296<=a&&57343>=a&&(a=65536+((1023&a)<<10)|1023&t.charCodeAt(++i)),127>=a){if(r>=n)break;e[r++]=a}else{if(2047>=a){if(r+1>=n)break;e[r++]=192|a>>6}else{if(65535>=a){if(r+2>=n)break;e[r++]=224|a>>12}else{if(r+3>=n)break;e[r++]=240|a>>18,e[r++]=128|a>>12&63}e[r++]=128|a>>6&63}e[r++]=128|63&a}}return e[r]=0,r-o}function M(t){for(var e=0,r=0;r<t.length;++r){var n=t.charCodeAt(r);127>=n?e++:2047>=n?e+=2:55296<=n&&57343>=n?(e+=4,++r):e+=3}return e}function B(){var t=O.buffer;k=t,a.HEAP8=j=new Int8Array(t),a.HEAP16=A=new Int16Array(t),a.HEAP32=D=new Int32Array(t),a.HEAPU8=S=new Uint8Array(t),a.HEAPU16=new Uint16Array(t),a.HEAPU32=P=new Uint32Array(t),a.HEAPF32=C=new Float32Array(t),a.HEAPF64=L=new Float64Array(t)}var G,U=[],z=[],$=[];function q(){var t=a.preRun.shift();U.unshift(t)}var K,H,Z,Y=0,V=null,W=null;function J(t){throw a.onAbort&&a.onAbort(t),E(t="Aborted("+t+")"),T=!0,new WebAssembly.RuntimeError(t+". Build with -sASSERTIONS for more info.")}function X(){return K.startsWith("data:application/octet-stream;base64,")}if(K="sql-wasm.wasm",!X()){var Q=K;K=a.locateFile?a.locateFile(Q,w):w+Q}function tt(){var t=K;try{if(t==K&&x)return new Uint8Array(x);if(f)return f(t);throw"both async and sync fetching of the wasm failed"}catch(t){J(t)}}function et(t){for(;0<t.length;)t.shift()(a)}function rt(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"i8";switch(e.endsWith("*")&&(e="*"),e){case"i1":case"i8":return j[0|t];case"i16":return A[t>>1];case"i32":case"i64":return D[t>>2];case"float":return C[t>>2];case"double":return L[t>>3];case"*":return P[t>>2];default:J("invalid type for getValue: "+e)}return null}function nt(t){var e="i32";switch(e.endsWith("*")&&(e="*"),e){case"i1":case"i8":j[0|t]=0;break;case"i16":A[t>>1]=0;break;case"i32":D[t>>2]=0;break;case"i64":Z=[0,(H=0,1<=+Math.abs(H)?0<H?(0|Math.min(+Math.floor(H/4294967296),4294967295))>>>0:~~+Math.ceil((H-+(~~H>>>0))/4294967296)>>>0:0)],D[t>>2]=Z[0],D[t+4>>2]=Z[1];break;case"float":C[t>>2]=0;break;case"double":L[t>>3]=0;break;case"*":P[t>>2]=0;break;default:J("invalid type for setValue: "+e)}}var ot=function(t,e){for(var r=0,n=t.length-1;0<=n;n--){var o=t[n];"."===o?t.splice(n,1):".."===o?(t.splice(n,1),r++):r&&(t.splice(n,1),r--)}if(e)for(;r;r--)t.unshift("..");return t},it=function(t){var e="/"===t.charAt(0),r="/"===t.substr(-1);return(t=ot(t.split("/").filter((function(t){return!!t})),!e).join("/"))||e||(t="."),t&&r&&(t+="/"),(e?"/":"")+t},at=function(t){var e=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(t).slice(1);return t=e[0],e=e[1],t||e?(e&&(e=e.substr(0,e.length-1)),t+e):"."},ut=function(t){if("/"===t)return"/";var e=(t=(t=it(t)).replace(/\/$/,"")).lastIndexOf("/");return-1===e?t:t.substr(e+1)};function st(){for(var t="",e=!1,r=arguments.length-1;-1<=r&&!e;r--){if("string"!=typeof(e=0<=r?arguments[r]:"/"))throw new TypeError("Arguments to path.resolve must be strings");if(!e)return"";t=e+"/"+t,e="/"===e.charAt(0)}return(e?"/":"")+(t=ot(t.split("/").filter((function(t){return!!t})),!e).join("/"))||"."}function ct(t,e){var r=Array(M(t)+1);return t=R(t,r,0,r.length),e&&(r.length=t),r}var lt=[];function ft(t,e){lt[t]={input:[],output:[],Xa:e},Ut(t,vt)}var pt,ht,dt,yt,vt={open:function(t){var e=lt[t.node.rdev];if(!e)throw new jt(43);t.tty=e,t.seekable=!1},close:function(t){t.tty.Xa.fsync(t.tty)},fsync:function(t){t.tty.Xa.fsync(t.tty)},read:function(t,e,r,n){if(!t.tty||!t.tty.Xa.tb)throw new jt(60);for(var o=0,i=0;i<n;i++){try{var a=t.tty.Xa.tb(t.tty)}catch(t){throw new jt(29)}if(void 0===a&&0===o)throw new jt(6);if(null==a)break;o++,e[r+i]=a}return o&&(t.node.timestamp=Date.now()),o},write:function(t,e,r,n){if(!t.tty||!t.tty.Xa.jb)throw new jt(60);try{for(var o=0;o<n;o++)t.tty.Xa.jb(t.tty,e[r+o])}catch(t){throw new jt(29)}return n&&(t.node.timestamp=Date.now()),o}},mt={tb:function(t){if(!t.input.length){var e=null;if(g){var r=Buffer.alloc(256),n=0;try{n=p.readSync(process.stdin.fd,r,0,256,-1)}catch(t){if(!t.toString().includes("EOF"))throw t;n=0}e=0<n?r.slice(0,n).toString("utf-8"):null}else"undefined"!=typeof window&&"function"==typeof window.prompt?null!==(e=window.prompt("Input: "))&&(e+="\n"):"function"==typeof readline&&null!==(e=readline())&&(e+="\n");if(!e)return null;t.input=ct(e,!0)}return t.input.shift()},jb:function(t,e){null===e||10===e?(_(I(t.output,0)),t.output=[]):0!=e&&t.output.push(e)},fsync:function(t){t.output&&0<t.output.length&&(_(I(t.output,0)),t.output=[])}},bt={jb:function(t,e){null===e||10===e?(E(I(t.output,0)),t.output=[]):0!=e&&t.output.push(e)},fsync:function(t){t.output&&0<t.output.length&&(E(I(t.output,0)),t.output=[])}},gt={Qa:null,Ra:function(){return gt.createNode(null,"/",16895,0)},createNode:function(t,e,r,n){if(24576==(61440&r)||4096==(61440&r))throw new jt(63);return gt.Qa||(gt.Qa={dir:{node:{Pa:gt.Ga.Pa,Oa:gt.Ga.Oa,lookup:gt.Ga.lookup,ab:gt.Ga.ab,rename:gt.Ga.rename,unlink:gt.Ga.unlink,rmdir:gt.Ga.rmdir,readdir:gt.Ga.readdir,symlink:gt.Ga.symlink},stream:{Ta:gt.Ha.Ta}},file:{node:{Pa:gt.Ga.Pa,Oa:gt.Ga.Oa},stream:{Ta:gt.Ha.Ta,read:gt.Ha.read,write:gt.Ha.write,lb:gt.Ha.lb,bb:gt.Ha.bb,cb:gt.Ha.cb}},link:{node:{Pa:gt.Ga.Pa,Oa:gt.Ga.Oa,readlink:gt.Ga.readlink},stream:{}},pb:{node:{Pa:gt.Ga.Pa,Oa:gt.Ga.Oa},stream:Gt}}),16384==(61440&(r=Tt(t,e,r,n)).mode)?(r.Ga=gt.Qa.dir.node,r.Ha=gt.Qa.dir.stream,r.Ia={}):32768==(61440&r.mode)?(r.Ga=gt.Qa.file.node,r.Ha=gt.Qa.file.stream,r.Ma=0,r.Ia=null):40960==(61440&r.mode)?(r.Ga=gt.Qa.link.node,r.Ha=gt.Qa.link.stream):8192==(61440&r.mode)&&(r.Ga=gt.Qa.pb.node,r.Ha=gt.Qa.pb.stream),r.timestamp=Date.now(),t&&(t.Ia[e]=r,t.timestamp=r.timestamp),r},Jb:function(t){return t.Ia?t.Ia.subarray?t.Ia.subarray(0,t.Ma):new Uint8Array(t.Ia):new Uint8Array(0)},qb:function(t,e){var r=t.Ia?t.Ia.length:0;r>=e||(e=Math.max(e,r*(1048576>r?2:1.125)>>>0),0!=r&&(e=Math.max(e,256)),r=t.Ia,t.Ia=new Uint8Array(e),0<t.Ma&&t.Ia.set(r.subarray(0,t.Ma),0))},Gb:function(t,e){if(t.Ma!=e)if(0==e)t.Ia=null,t.Ma=0;else{var r=t.Ia;t.Ia=new Uint8Array(e),r&&t.Ia.set(r.subarray(0,Math.min(e,t.Ma))),t.Ma=e}},Ga:{Pa:function(t){var e={};return e.dev=8192==(61440&t.mode)?t.id:1,e.ino=t.id,e.mode=t.mode,e.nlink=1,e.uid=0,e.gid=0,e.rdev=t.rdev,16384==(61440&t.mode)?e.size=4096:32768==(61440&t.mode)?e.size=t.Ma:40960==(61440&t.mode)?e.size=t.link.length:e.size=0,e.atime=new Date(t.timestamp),e.mtime=new Date(t.timestamp),e.ctime=new Date(t.timestamp),e.Ab=4096,e.blocks=Math.ceil(e.size/e.Ab),e},Oa:function(t,e){void 0!==e.mode&&(t.mode=e.mode),void 0!==e.timestamp&&(t.timestamp=e.timestamp),void 0!==e.size&&gt.Gb(t,e.size)},lookup:function(){throw St[44]},ab:function(t,e,r,n){return gt.createNode(t,e,r,n)},rename:function(t,e,r){if(16384==(61440&t.mode)){try{var n=Lt(e,r)}catch(t){}if(n)for(var o in n.Ia)throw new jt(55)}delete t.parent.Ia[t.name],t.parent.timestamp=Date.now(),t.name=r,e.Ia[r]=t,e.timestamp=t.parent.timestamp,t.parent=e},unlink:function(t,e){delete t.Ia[e],t.timestamp=Date.now()},rmdir:function(t,e){var r,n=Lt(t,e);for(r in n.Ia)throw new jt(55);delete t.Ia[e],t.timestamp=Date.now()},readdir:function(t){var e,r=[".",".."];for(e in t.Ia)t.Ia.hasOwnProperty(e)&&r.push(e);return r},symlink:function(t,e,r){return(t=gt.createNode(t,e,41471,0)).link=r,t},readlink:function(t){if(40960!=(61440&t.mode))throw new jt(28);return t.link}},Ha:{read:function(t,e,r,n,o){var i=t.node.Ia;if(o>=t.node.Ma)return 0;if(8<(t=Math.min(t.node.Ma-o,n))&&i.subarray)e.set(i.subarray(o,o+t),r);else for(n=0;n<t;n++)e[r+n]=i[o+n];return t},write:function(t,e,r,n,o,i){if(e.buffer===j.buffer&&(i=!1),!n)return 0;if((t=t.node).timestamp=Date.now(),e.subarray&&(!t.Ia||t.Ia.subarray)){if(i)return t.Ia=e.subarray(r,r+n),t.Ma=n;if(0===t.Ma&&0===o)return t.Ia=e.slice(r,r+n),t.Ma=n;if(o+n<=t.Ma)return t.Ia.set(e.subarray(r,r+n),o),n}if(gt.qb(t,o+n),t.Ia.subarray&&e.subarray)t.Ia.set(e.subarray(r,r+n),o);else for(i=0;i<n;i++)t.Ia[o+i]=e[r+i];return t.Ma=Math.max(t.Ma,o+n),n},Ta:function(t,e,r){if(1===r?e+=t.position:2===r&&32768==(61440&t.node.mode)&&(e+=t.node.Ma),0>e)throw new jt(28);return e},lb:function(t,e,r){gt.qb(t.node,e+r),t.node.Ma=Math.max(t.node.Ma,e+r)},bb:function(t,e,r,n,o){if(32768!=(61440&t.node.mode))throw new jt(43);if(t=t.node.Ia,2&o||t.buffer!==k){if((0<r||r+e<t.length)&&(t=t.subarray?t.subarray(r,r+e):Array.prototype.slice.call(t,r,r+e)),r=!0,e=65536*Math.ceil(e/65536),(o=Te(65536,e))?(S.fill(0,o,o+e),e=o):e=0,!e)throw new jt(48);j.set(t,e)}else r=!1,e=t.byteOffset;return{Fb:e,vb:r}},cb:function(t,e,r,n,o){if(32768!=(61440&t.node.mode))throw new jt(43);return 2&o||gt.Ha.write(t,e,0,n,r,!1),0}}},wt=null,xt={},_t=[],Et=1,Ot=null,kt=!0,jt=null,St={},At=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(t=st("/",t)))return{path:"",node:null};if(8<(e=Object.assign({rb:!0,kb:0},e)).kb)throw new jt(32);t=ot(t.split("/").filter((function(t){return!!t})),!1);for(var r=wt,n="/",o=0;o<t.length;o++){var i=o===t.length-1;if(i&&e.parent)break;if(r=Lt(r,t[o]),n=it(n+"/"+t[o]),r.Va&&(!i||i&&e.rb)&&(r=r.Va.root),!i||e.Sa)for(i=0;40960==(61440&r.mode);)if(r=Vt(n),n=st(at(n),r),r=At(n,{kb:e.kb+1}).node,40<i++)throw new jt(32)}return{path:n,node:r}},Dt=function(t){for(var e;;){if(t===t.parent)return t=t.Ra.ub,e?"/"!==t[t.length-1]?t+"/"+e:t+e:t;e=e?t.name+"/"+e:t.name,t=t.parent}},Pt=function(t,e){for(var r=0,n=0;n<e.length;n++)r=(r<<5)-r+e.charCodeAt(n)|0;return(t+r>>>0)%Ot.length},Ct=function(t){var e=Pt(t.parent.id,t.name);if(Ot[e]===t)Ot[e]=t.Wa;else for(e=Ot[e];e;){if(e.Wa===t){e.Wa=t.Wa;break}e=e.Wa}},Lt=function(t,e){var r;if(r=(r=Nt(t,"x"))?r:t.Ga.lookup?0:2)throw new jt(r,t);for(r=Ot[Pt(t.id,e)];r;r=r.Wa){var n=r.name;if(r.parent.id===t.id&&n===e)return r}return t.Ga.lookup(t,e)},Tt=function(t,e,r,n){return t=new Se(t,e,r,n),e=Pt(t.parent.id,t.name),t.Wa=Ot[e],Ot[e]=t},Ft={r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090},It=function(t){var e=["r","w","rw"][3&t];return 512&t&&(e+="w"),e},Nt=function(t,e){return kt?0:!e.includes("r")||292&t.mode?e.includes("w")&&!(146&t.mode)||e.includes("x")&&!(73&t.mode)?2:0:2},Rt=function(t,e){try{return Lt(t,e),20}catch(t){}return Nt(t,"wx")},Mt=function(t,e,r){try{var n=Lt(t,e)}catch(t){return t.Ka}if(t=Nt(t,"wx"))return t;if(r){if(16384!=(61440&n.mode))return 54;if(n===n.parent||"/"===Dt(n))return 10}else if(16384==(61440&n.mode))return 31;return 0},Bt=function(t,e){return dt||((dt=function(){this.$a={}}).prototype={},Object.defineProperties(dt.prototype,{object:{get:function(){return this.node},set:function(t){this.node=t}},flags:{get:function(){return this.$a.flags},set:function(t){this.$a.flags=t}},position:{get:function(){return this.$a.position},set:function(t){this.$a.position=t}}})),t=Object.assign(new dt,t),e=function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;4096>=t;t++)if(!_t[t])return t;throw new jt(33)}(e),t.fd=e,_t[e]=t},Gt={open:function(t){t.Ha=xt[t.node.rdev].Ha,t.Ha.open&&t.Ha.open(t)},Ta:function(){throw new jt(70)}},Ut=function(t,e){xt[t]={Ha:e}},zt=function(t,e){var r="/"===e,n=!e;if(r&&wt)throw new jt(10);if(!r&&!n){var o=At(e,{rb:!1});if(e=o.path,(o=o.node).Va)throw new jt(10);if(16384!=(61440&o.mode))throw new jt(54)}e={type:t,Kb:{},ub:e,Eb:[]},(t=t.Ra(e)).Ra=e,e.root=t,r?wt=t:o&&(o.Va=e,o.Ra&&o.Ra.Eb.push(e))},$t=function(t,e,r){var n=At(t,{parent:!0}).node;if(!(t=ut(t))||"."===t||".."===t)throw new jt(28);var o=Rt(n,t);if(o)throw new jt(o);if(!n.Ga.ab)throw new jt(63);return n.Ga.ab(n,t,e,r)},qt=function(t,e){return $t(t,1023&(void 0!==e?e:511)|16384,0)},Kt=function(t,e,r){void 0===r&&(r=e,e=438),$t(t,8192|e,r)},Ht=function(t,e){if(!st(t))throw new jt(44);var r=At(e,{parent:!0}).node;if(!r)throw new jt(44);e=ut(e);var n=Rt(r,e);if(n)throw new jt(n);if(!r.Ga.symlink)throw new jt(63);r.Ga.symlink(r,e,t)},Zt=function(t){var e=At(t,{parent:!0}).node;t=ut(t);var r=Lt(e,t),n=Mt(e,t,!0);if(n)throw new jt(n);if(!e.Ga.rmdir)throw new jt(63);if(r.Va)throw new jt(10);e.Ga.rmdir(e,t),Ct(r)},Yt=function(t){var e=At(t,{parent:!0}).node;if(!e)throw new jt(44);t=ut(t);var r=Lt(e,t),n=Mt(e,t,!1);if(n)throw new jt(n);if(!e.Ga.unlink)throw new jt(63);if(r.Va)throw new jt(10);e.Ga.unlink(e,t),Ct(r)},Vt=function(t){if(!(t=At(t).node))throw new jt(44);if(!t.Ga.readlink)throw new jt(28);return st(Dt(t.parent),t.Ga.readlink(t))},Wt=function(t,e){if(!(t=At(t,{Sa:!e}).node))throw new jt(44);if(!t.Ga.Pa)throw new jt(63);return t.Ga.Pa(t)},Jt=function(t){return Wt(t,!0)},Xt=function(t,e){if(!(t="string"==typeof t?At(t,{Sa:!0}).node:t).Ga.Oa)throw new jt(63);t.Ga.Oa(t,{mode:4095&e|-4096&t.mode,timestamp:Date.now()})},Qt=function(t,e){if(0>e)throw new jt(28);if(!(t="string"==typeof t?At(t,{Sa:!0}).node:t).Ga.Oa)throw new jt(63);if(16384==(61440&t.mode))throw new jt(31);if(32768!=(61440&t.mode))throw new jt(28);var r=Nt(t,"w");if(r)throw new jt(r);t.Ga.Oa(t,{size:e,timestamp:Date.now()})},te=function(t,e,r){if(""===t)throw new jt(44);if("string"==typeof e){var n=Ft[e];if(void 0===n)throw Error("Unknown file open mode: "+e);e=n}if(r=64&e?4095&(void 0===r?438:r)|32768:0,"object"==o(t))var i=t;else{t=it(t);try{i=At(t,{Sa:!(131072&e)}).node}catch(t){}}if(n=!1,64&e)if(i){if(128&e)throw new jt(20)}else i=$t(t,r,0),n=!0;if(!i)throw new jt(44);if(8192==(61440&i.mode)&&(e&=-513),65536&e&&16384!=(61440&i.mode))throw new jt(54);if(!n&&(r=i?40960==(61440&i.mode)?32:16384==(61440&i.mode)&&("r"!==It(e)||512&e)?31:Nt(i,It(e)):44))throw new jt(r);return 512&e&&!n&&Qt(i,0),e&=-131713,(i=Bt({node:i,path:Dt(i),flags:e,seekable:!0,position:0,Ha:i.Ha,Ib:[],error:!1})).Ha.open&&i.Ha.open(i),!a.logReadFiles||1&e||(yt||(yt={}),t in yt||(yt[t]=1)),i},ee=function(t){if(null===t.fd)throw new jt(8);t.hb&&(t.hb=null);try{t.Ha.close&&t.Ha.close(t)}catch(t){throw t}finally{_t[t.fd]=null}t.fd=null},re=function(t,e,r){if(null===t.fd)throw new jt(8);if(!t.seekable||!t.Ha.Ta)throw new jt(70);if(0!=r&&1!=r&&2!=r)throw new jt(28);t.position=t.Ha.Ta(t,e,r),t.Ib=[]},ne=function(t,e,r,n,o){if(0>n||0>o)throw new jt(28);if(null===t.fd)throw new jt(8);if(1==(2097155&t.flags))throw new jt(8);if(16384==(61440&t.node.mode))throw new jt(31);if(!t.Ha.read)throw new jt(28);var i=void 0!==o;if(i){if(!t.seekable)throw new jt(70)}else o=t.position;return e=t.Ha.read(t,e,r,n,o),i||(t.position+=e),e},oe=function(t,e,r,n,o){if(0>n||0>o)throw new jt(28);if(null===t.fd)throw new jt(8);if(!(2097155&t.flags))throw new jt(8);if(16384==(61440&t.node.mode))throw new jt(31);if(!t.Ha.write)throw new jt(28);t.seekable&&1024&t.flags&&re(t,0,2);var i=void 0!==o;if(i){if(!t.seekable)throw new jt(70)}else o=t.position;return e=t.Ha.write(t,e,r,n,o,void 0),i||(t.position+=e),e},ie=function(t){var e,r=te(t,r||0);t=Wt(t).size;var n=new Uint8Array(t);return ne(r,n,0,t,0),e=n,ee(r),e},ae=function(){jt||((jt=function(t,e){this.node=e,this.Hb=function(t){this.Ka=t},this.Hb(t),this.message="FS error"}).prototype=Error(),jt.prototype.constructor=jt,[44].forEach((function(t){St[t]=new jt(t),St[t].stack="<generic error, no stack>"})))},ue=function(t,e){var r=0;return t&&(r|=365),e&&(r|=146),r},se=function(t,e,r){t=it("/dev/"+t);var n=ue(!!e,!!r);ht||(ht=64);var o=ht++<<8;Ut(o,{open:function(t){t.seekable=!1},close:function(){r&&r.buffer&&r.buffer.length&&r(10)},read:function(t,r,n,o){for(var i=0,a=0;a<o;a++){try{var u=e()}catch(t){throw new jt(29)}if(void 0===u&&0===i)throw new jt(6);if(null==u)break;i++,r[n+a]=u}return i&&(t.node.timestamp=Date.now()),i},write:function(t,e,n,o){for(var i=0;i<o;i++)try{r(e[n+i])}catch(t){throw new jt(29)}return o&&(t.node.timestamp=Date.now()),i}}),Kt(t,n,o)};function ce(t,e,r){if("/"===e.charAt(0))return e;if(t=-100===t?"/":de(t).path,0==e.length){if(!r)throw new jt(44);return t}return it(t+"/"+e)}function le(t,e,r){try{var n=t(e)}catch(t){if(t&&t.node&&it(e)!==it(Dt(t.node)))return-54;throw t}return D[r>>2]=n.dev,D[r+8>>2]=n.ino,D[r+12>>2]=n.mode,P[r+16>>2]=n.nlink,D[r+20>>2]=n.uid,D[r+24>>2]=n.gid,D[r+28>>2]=n.rdev,Z=[n.size>>>0,(H=n.size,1<=+Math.abs(H)?0<H?(0|Math.min(+Math.floor(H/4294967296),4294967295))>>>0:~~+Math.ceil((H-+(~~H>>>0))/4294967296)>>>0:0)],D[r+40>>2]=Z[0],D[r+44>>2]=Z[1],D[r+48>>2]=4096,D[r+52>>2]=n.blocks,Z=[Math.floor(n.atime.getTime()/1e3)>>>0,(H=Math.floor(n.atime.getTime()/1e3),1<=+Math.abs(H)?0<H?(0|Math.min(+Math.floor(H/4294967296),4294967295))>>>0:~~+Math.ceil((H-+(~~H>>>0))/4294967296)>>>0:0)],D[r+56>>2]=Z[0],D[r+60>>2]=Z[1],P[r+64>>2]=0,Z=[Math.floor(n.mtime.getTime()/1e3)>>>0,(H=Math.floor(n.mtime.getTime()/1e3),1<=+Math.abs(H)?0<H?(0|Math.min(+Math.floor(H/4294967296),4294967295))>>>0:~~+Math.ceil((H-+(~~H>>>0))/4294967296)>>>0:0)],D[r+72>>2]=Z[0],D[r+76>>2]=Z[1],P[r+80>>2]=0,Z=[Math.floor(n.ctime.getTime()/1e3)>>>0,(H=Math.floor(n.ctime.getTime()/1e3),1<=+Math.abs(H)?0<H?(0|Math.min(+Math.floor(H/4294967296),4294967295))>>>0:~~+Math.ceil((H-+(~~H>>>0))/4294967296)>>>0:0)],D[r+88>>2]=Z[0],D[r+92>>2]=Z[1],P[r+96>>2]=0,Z=[n.ino>>>0,(H=n.ino,1<=+Math.abs(H)?0<H?(0|Math.min(+Math.floor(H/4294967296),4294967295))>>>0:~~+Math.ceil((H-+(~~H>>>0))/4294967296)>>>0:0)],D[r+104>>2]=Z[0],D[r+108>>2]=Z[1],0}var fe,pe=void 0;function he(){return D[(pe+=4)-4>>2]}function de(t){if(!(t=_t[t]))throw new jt(8);return t}function ye(t){return P[t>>2]+4294967296*D[t+4>>2]}function ve(t){var e=M(t)+1,r=Pe(e);return r&&R(t,j,r,e),r}fe=g?function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6}:function(){return performance.now()};var me={};function be(){if(!ge){var t,e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==("undefined"==typeof navigator?"undefined":o(navigator))&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:v||"./this.program"};for(t in me)void 0===me[t]?delete e[t]:e[t]=me[t];var r=[];for(t in e)r.push(t+"="+e[t]);ge=r}return ge}var ge,we=void 0,xe=[];function _e(t,e){if(!we){we=new WeakMap;var r=G.length;if(we)for(var n=0;n<0+r;n++){var o=G.get(n);o&&we.set(o,n)}}if(we.has(t))return we.get(t);if(xe.length)r=xe.pop();else{try{G.grow(1)}catch(t){if(!(t instanceof RangeError))throw t;throw"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH."}r=G.length-1}try{G.set(r,t)}catch(u){if(!(u instanceof TypeError))throw u;if("function"==typeof WebAssembly.Function){n=WebAssembly.Function,o={i:"i32",j:"i64",f:"f32",d:"f64",p:"i32"};for(var i={parameters:[],results:"v"==e[0]?[]:[o[e[0]]]},a=1;a<e.length;++a)i.parameters.push(o[e[a]]);e=new n(i,t)}else{for(n=[1,96],o=e.slice(0,1),i={i:127,p:127,j:126,f:125,d:124},128>(a=(e=e.slice(1)).length)?n.push(a):n.push(a%128|128,a>>7),a=0;a<e.length;++a)n.push(i[e[a]]);"v"==o?n.push(0):n.push(1,i[o]),e=[0,97,115,109,1,0,0,0,1],128>(o=n.length)?e.push(o):e.push(o%128|128,o>>7),e.push.apply(e,n),e.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0),e=new WebAssembly.Module(new Uint8Array(e)),e=new WebAssembly.Instance(e,{e:{f:t}}).exports.f}G.set(r,e)}return we.set(t,r),r}function Ee(t){we.delete(G.get(t)),xe.push(t)}var Oe=0,ke=1;function je(t){var e=Oe==ke?Ne(t.length):Pe(t.length);return t.subarray||t.slice||(t=new Uint8Array(t)),S.set(t,e),e}function Se(t,e,r,n){t||(t=this),this.parent=t,this.Ra=t.Ra,this.Va=null,this.id=Et++,this.name=e,this.mode=r,this.Ga={},this.Ha={},this.rdev=n}Object.defineProperties(Se.prototype,{read:{get:function(){return!(365&~this.mode)},set:function(t){t?this.mode|=365:this.mode&=-366}},write:{get:function(){return!(146&~this.mode)},set:function(t){t?this.mode|=146:this.mode&=-147}}}),ae(),Ot=Array(4096),zt(gt,"/"),qt("/tmp"),qt("/home"),qt("/home/web_user"),function(){qt("/dev"),Ut(259,{read:function(){return 0},write:function(t,e,r,n){return n}}),Kt("/dev/null",259),ft(1280,mt),ft(1536,bt),Kt("/dev/tty",1280),Kt("/dev/tty1",1536);var t=function(){if("object"==("undefined"==typeof crypto?"undefined":o(crypto))&&"function"==typeof crypto.getRandomValues){var t=new Uint8Array(1);return function(){return crypto.getRandomValues(t),t[0]}}if(g)try{var e=r(7920);return function(){return e.randomBytes(1)[0]}}catch(t){}return function(){return J("randomDevice")}}();se("random",t),se("urandom",t),qt("/dev/shm"),qt("/dev/shm/tmp")}(),function(){qt("/proc");var t=qt("/proc/self");qt("/proc/self/fd"),zt({Ra:function(){var e=Tt(t,"fd",16895,73);return e.Ga={lookup:function(t,e){var r=_t[+e];if(!r)throw new jt(8);return(t={parent:null,Ra:{ub:"fake"},Ga:{readlink:function(){return r.path}}}).parent=t}},e}},"/proc/self/fd")}();var Ae={a:function(t,e,r,n){J("Assertion failed: "+N(t)+", at: "+[e?N(e):"unknown filename",r,n?N(n):"unknown function"])},h:function(t,e){try{return t=N(t),Xt(t,e),0}catch(t){if(!(t instanceof jt))throw t;return-t.Ka}},H:function(t,e,r){try{if(e=ce(t,e=N(e)),-8&r)return-28;var n=At(e,{Sa:!0}).node;return n?(t="",4&r&&(t+="r"),2&r&&(t+="w"),1&r&&(t+="x"),t&&Nt(n,t)?-2:0):-44}catch(t){if(!(t instanceof jt))throw t;return-t.Ka}},i:function(t,e){try{var r=_t[t];if(!r)throw new jt(8);return Xt(r.node,e),0}catch(t){if(!(t instanceof jt))throw t;return-t.Ka}},g:function(t){try{var e=_t[t];if(!e)throw new jt(8);var r=e.node,n="string"==typeof r?At(r,{Sa:!0}).node:r;if(!n.Ga.Oa)throw new jt(63);return n.Ga.Oa(n,{timestamp:Date.now()}),0}catch(t){if(!(t instanceof jt))throw t;return-t.Ka}},b:function(t,e,r){pe=r;try{var n=de(t);switch(e){case 0:var o=he();return 0>o?-28:Bt(n,o).fd;case 1:case 2:case 6:case 7:return 0;case 3:return n.flags;case 4:return o=he(),n.flags|=o,0;case 5:return o=he(),A[o+0>>1]=2,0;case 16:case 8:default:return-28;case 9:return D[De()>>2]=28,-1}}catch(t){if(!(t instanceof jt))throw t;return-t.Ka}},G:function(t,e){try{var r=de(t);return le(Wt,r.path,e)}catch(t){if(!(t instanceof jt))throw t;return-t.Ka}},l:function(t,e,r){try{if(e=r+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*r:NaN,isNaN(e))return-61;var n=_t[t];if(!n)throw new jt(8);if(!(2097155&n.flags))throw new jt(28);return Qt(n.node,e),0}catch(t){if(!(t instanceof jt))throw t;return-t.Ka}},B:function(t,e){try{if(0===e)return-28;var r=M("/")+1;return e<r?-68:(R("/",S,t,e),r)}catch(t){if(!(t instanceof jt))throw t;return-t.Ka}},E:function(t,e){try{return t=N(t),le(Jt,t,e)}catch(t){if(!(t instanceof jt))throw t;return-t.Ka}},y:function(t,e,r){try{return e=ce(t,e=N(e)),"/"===(e=it(e))[e.length-1]&&(e=e.substr(0,e.length-1)),qt(e,r),0}catch(t){if(!(t instanceof jt))throw t;return-t.Ka}},D:function(t,e,r,n){try{e=N(e);var o=256&n;return e=ce(t,e,4096&n),le(o?Jt:Wt,e,r)}catch(t){if(!(t instanceof jt))throw t;return-t.Ka}},v:function(t,e,r,n){pe=n;try{e=ce(t,e=N(e));var o=n?he():0;return te(e,r,o).fd}catch(t){if(!(t instanceof jt))throw t;return-t.Ka}},t:function(t,e,r,n){try{if(e=ce(t,e=N(e)),0>=n)return-28;var o=Vt(e),i=Math.min(n,M(o)),a=j[r+i];return R(o,S,r,n+1),j[r+i]=a,i}catch(t){if(!(t instanceof jt))throw t;return-t.Ka}},s:function(t){try{return t=N(t),Zt(t),0}catch(t){if(!(t instanceof jt))throw t;return-t.Ka}},F:function(t,e){try{return t=N(t),le(Wt,t,e)}catch(t){if(!(t instanceof jt))throw t;return-t.Ka}},p:function(t,e,r){try{return e=ce(t,e=N(e)),0===r?Yt(e):512===r?Zt(e):J("Invalid flags passed to unlinkat"),0}catch(t){if(!(t instanceof jt))throw t;return-t.Ka}},o:function(t,e,r){try{if(e=ce(t,e=N(e),!0),r){var n=ye(r),o=D[r+8>>2];i=1e3*n+o/1e6,a=1e3*(n=ye(r+=16))+(o=D[r+8>>2])/1e6}else var i=Date.now(),a=i;t=i;var u=At(e,{Sa:!0}).node;return u.Ga.Oa(u,{timestamp:Math.max(t,a)}),0}catch(t){if(!(t instanceof jt))throw t;return-t.Ka}},e:function(){return Date.now()},j:function(t,e){t=new Date(1e3*ye(t)),D[e>>2]=t.getSeconds(),D[e+4>>2]=t.getMinutes(),D[e+8>>2]=t.getHours(),D[e+12>>2]=t.getDate(),D[e+16>>2]=t.getMonth(),D[e+20>>2]=t.getFullYear()-1900,D[e+24>>2]=t.getDay();var r=new Date(t.getFullYear(),0,1);D[e+28>>2]=(t.getTime()-r.getTime())/864e5|0,D[e+36>>2]=-60*t.getTimezoneOffset();var n=new Date(t.getFullYear(),6,1).getTimezoneOffset();r=r.getTimezoneOffset(),D[e+32>>2]=0|(n!=r&&t.getTimezoneOffset()==Math.min(r,n))},w:function t(e,r,n,o,i,a){try{var u=de(o);if(2&r&&!(2&n)&&2!=(2097155&u.flags))throw new jt(2);if(1==(2097155&u.flags))throw new jt(2);if(!u.Ha.bb)throw new jt(43);var s=u.Ha.bb(u,e,i,r,n),c=s.Fb;return D[a>>2]=s.vb,c}catch(t){if(!(t instanceof jt))throw t;return-t.Ka}},x:function t(e,r,n,o,i,a){try{var u=de(i);if(2&n){var s=S.slice(e,e+r);u&&u.Ha.cb&&u.Ha.cb(u,s,a,r,o)}}catch(t){if(!(t instanceof jt))throw t;return-t.Ka}},n:function t(e,r,n){t.Bb||(t.Bb=!0,function(t,e,r){function n(t){return(t=t.toTimeString().match(/\(([A-Za-z ]+)\)$/))?t[1]:"GMT"}var o=(new Date).getFullYear(),i=new Date(o,0,1),a=new Date(o,6,1);o=i.getTimezoneOffset();var u=a.getTimezoneOffset();D[t>>2]=60*Math.max(o,u),D[e>>2]=Number(o!=u),t=n(i),e=n(a),t=ve(t),e=ve(e),u<o?(P[r>>2]=t,P[r+4>>2]=e):(P[r>>2]=e,P[r+4>>2]=t)}(e,r,n))},q:function(){return 2147483648},d:fe,c:function(t){var e=S.length;if(2147483648<(t>>>=0))return!1;for(var r=1;4>=r;r*=2){var n=e*(1+.2/r);n=Math.min(n,t+100663296);var o=Math;n=Math.max(t,n),o=o.min.call(o,2147483648,n+(65536-n%65536)%65536);t:{try{O.grow(o-k.byteLength+65535>>>16),B();var i=1;break t}catch(t){}i=void 0}if(i)return!0}return!1},z:function(t,e){var r=0;return be().forEach((function(n,o){var i=e+r;for(o=P[t+4*o>>2]=i,i=0;i<n.length;++i)j[0|o++]=n.charCodeAt(i);j[0|o]=0,r+=n.length+1})),0},A:function(t,e){var r=be();P[t>>2]=r.length;var n=0;return r.forEach((function(t){n+=t.length+1})),P[e>>2]=n,0},f:function(t){try{var e=de(t);return ee(e),0}catch(t){if(!(t instanceof jt))throw t;return t.Ka}},m:function(t,e){try{var r=de(t);return j[0|e]=r.tty?2:16384==(61440&r.mode)?3:40960==(61440&r.mode)?7:4,0}catch(t){if(!(t instanceof jt))throw t;return t.Ka}},u:function(t,e,r,n){try{t:{var o=de(t);t=e;for(var i=e=0;i<r;i++){var a=P[t>>2],u=P[t+4>>2];t+=8;var s=ne(o,j,a,u);if(0>s){var c=-1;break t}if(e+=s,s<u)break}c=e}return P[n>>2]=c,0}catch(t){if(!(t instanceof jt))throw t;return t.Ka}},k:function t(e,r,n,o,i){try{if(r=n+2097152>>>0<4194305-!!r?(r>>>0)+4294967296*n:NaN,isNaN(r))return 61;var a=de(e);return re(a,r,o),Z=[a.position>>>0,(H=a.position,1<=+Math.abs(H)?0<H?(0|Math.min(+Math.floor(H/4294967296),4294967295))>>>0:~~+Math.ceil((H-+(~~H>>>0))/4294967296)>>>0:0)],D[i>>2]=Z[0],D[i+4>>2]=Z[1],a.hb&&0===r&&0===o&&(a.hb=null),0}catch(t){if(!(t instanceof jt))throw t;return t.Ka}},C:function(t){try{var e=de(t);return e.Ha&&e.Ha.fsync?e.Ha.fsync(e):0}catch(t){if(!(t instanceof jt))throw t;return t.Ka}},r:function(t,e,r,n){try{t:{var o=de(t);t=e;for(var i=e=0;i<r;i++){var a=P[t>>2],u=P[t+4>>2];t+=8;var s=oe(o,j,a,u);if(0>s){var c=-1;break t}e+=s}c=e}return P[n>>2]=c,0}catch(t){if(!(t instanceof jt))throw t;return t.Ka}}};!function(){function t(t){a.asm=t.exports,O=a.asm.I,B(),G=a.asm.Aa,z.unshift(a.asm.J),Y--,a.monitorRunDependencies&&a.monitorRunDependencies(Y),0==Y&&(null!==V&&(clearInterval(V),V=null),W&&(t=W,W=null,t()))}function e(e){t(e.instance)}function r(t){return function(){if(!x&&(m||b)){if("function"==typeof fetch&&!K.startsWith("file://"))return fetch(K,{credentials:"same-origin"}).then((function(t){if(!t.ok)throw"failed to load wasm binary file at '"+K+"'";return t.arrayBuffer()})).catch((function(){return tt()}));if(l)return new Promise((function(t,e){l(K,(function(e){t(new Uint8Array(e))}),e)}))}return Promise.resolve().then((function(){return tt()}))}().then((function(t){return WebAssembly.instantiate(t,n)})).then((function(t){return t})).then(t,(function(t){E("failed to asynchronously prepare wasm: "+t),J(t)}))}var n={a:Ae};if(Y++,a.monitorRunDependencies&&a.monitorRunDependencies(Y),a.instantiateWasm)try{return a.instantiateWasm(n,t)}catch(t){return E("Module.instantiateWasm callback failed with error: "+t),!1}x||"function"!=typeof WebAssembly.instantiateStreaming||X()||K.startsWith("file://")||g||"function"!=typeof fetch?r(e):fetch(K,{credentials:"same-origin"}).then((function(t){return WebAssembly.instantiateStreaming(t,n).then(e,(function(t){return E("wasm streaming compile failed: "+t),E("falling back to ArrayBuffer instantiation"),r(e)}))}))}(),a.___wasm_call_ctors=function(){return(a.___wasm_call_ctors=a.asm.J).apply(null,arguments)},a._sqlite3_free=function(){return(a._sqlite3_free=a.asm.K).apply(null,arguments)},a._sqlite3_value_double=function(){return(a._sqlite3_value_double=a.asm.L).apply(null,arguments)},a._sqlite3_value_text=function(){return(a._sqlite3_value_text=a.asm.M).apply(null,arguments)};var De=a.___errno_location=function(){return(De=a.___errno_location=a.asm.N).apply(null,arguments)};a._sqlite3_prepare_v2=function(){return(a._sqlite3_prepare_v2=a.asm.O).apply(null,arguments)},a._sqlite3_step=function(){return(a._sqlite3_step=a.asm.P).apply(null,arguments)},a._sqlite3_finalize=function(){return(a._sqlite3_finalize=a.asm.Q).apply(null,arguments)},a._sqlite3_reset=function(){return(a._sqlite3_reset=a.asm.R).apply(null,arguments)},a._sqlite3_value_int=function(){return(a._sqlite3_value_int=a.asm.S).apply(null,arguments)},a._sqlite3_clear_bindings=function(){return(a._sqlite3_clear_bindings=a.asm.T).apply(null,arguments)},a._sqlite3_value_blob=function(){return(a._sqlite3_value_blob=a.asm.U).apply(null,arguments)},a._sqlite3_value_bytes=function(){return(a._sqlite3_value_bytes=a.asm.V).apply(null,arguments)},a._sqlite3_value_type=function(){return(a._sqlite3_value_type=a.asm.W).apply(null,arguments)},a._sqlite3_result_blob=function(){return(a._sqlite3_result_blob=a.asm.X).apply(null,arguments)},a._sqlite3_result_double=function(){return(a._sqlite3_result_double=a.asm.Y).apply(null,arguments)},a._sqlite3_result_error=function(){return(a._sqlite3_result_error=a.asm.Z).apply(null,arguments)},a._sqlite3_result_int=function(){return(a._sqlite3_result_int=a.asm._).apply(null,arguments)},a._sqlite3_result_int64=function(){return(a._sqlite3_result_int64=a.asm.$).apply(null,arguments)},a._sqlite3_result_null=function(){return(a._sqlite3_result_null=a.asm.aa).apply(null,arguments)},a._sqlite3_result_text=function(){return(a._sqlite3_result_text=a.asm.ba).apply(null,arguments)},a._sqlite3_sql=function(){return(a._sqlite3_sql=a.asm.ca).apply(null,arguments)},a._sqlite3_aggregate_context=function(){return(a._sqlite3_aggregate_context=a.asm.da).apply(null,arguments)},a._sqlite3_column_count=function(){return(a._sqlite3_column_count=a.asm.ea).apply(null,arguments)},a._sqlite3_data_count=function(){return(a._sqlite3_data_count=a.asm.fa).apply(null,arguments)},a._sqlite3_column_blob=function(){return(a._sqlite3_column_blob=a.asm.ga).apply(null,arguments)},a._sqlite3_column_bytes=function(){return(a._sqlite3_column_bytes=a.asm.ha).apply(null,arguments)},a._sqlite3_column_double=function(){return(a._sqlite3_column_double=a.asm.ia).apply(null,arguments)},a._sqlite3_column_text=function(){return(a._sqlite3_column_text=a.asm.ja).apply(null,arguments)},a._sqlite3_column_type=function(){return(a._sqlite3_column_type=a.asm.ka).apply(null,arguments)},a._sqlite3_column_name=function(){return(a._sqlite3_column_name=a.asm.la).apply(null,arguments)},a._sqlite3_bind_blob=function(){return(a._sqlite3_bind_blob=a.asm.ma).apply(null,arguments)},a._sqlite3_bind_double=function(){return(a._sqlite3_bind_double=a.asm.na).apply(null,arguments)},a._sqlite3_bind_int=function(){return(a._sqlite3_bind_int=a.asm.oa).apply(null,arguments)},a._sqlite3_bind_text=function(){return(a._sqlite3_bind_text=a.asm.pa).apply(null,arguments)},a._sqlite3_bind_parameter_index=function(){return(a._sqlite3_bind_parameter_index=a.asm.qa).apply(null,arguments)},a._sqlite3_normalized_sql=function(){return(a._sqlite3_normalized_sql=a.asm.ra).apply(null,arguments)},a._sqlite3_errmsg=function(){return(a._sqlite3_errmsg=a.asm.sa).apply(null,arguments)},a._sqlite3_exec=function(){return(a._sqlite3_exec=a.asm.ta).apply(null,arguments)},a._sqlite3_changes=function(){return(a._sqlite3_changes=a.asm.ua).apply(null,arguments)},a._sqlite3_close_v2=function(){return(a._sqlite3_close_v2=a.asm.va).apply(null,arguments)},a._sqlite3_create_function_v2=function(){return(a._sqlite3_create_function_v2=a.asm.wa).apply(null,arguments)},a._sqlite3_open=function(){return(a._sqlite3_open=a.asm.xa).apply(null,arguments)};var Pe=a._malloc=function(){return(Pe=a._malloc=a.asm.ya).apply(null,arguments)},Ce=a._free=function(){return(Ce=a._free=a.asm.za).apply(null,arguments)};a._RegisterExtensionFunctions=function(){return(a._RegisterExtensionFunctions=a.asm.Ba).apply(null,arguments)};var Le,Te=a._emscripten_builtin_memalign=function(){return(Te=a._emscripten_builtin_memalign=a.asm.Ca).apply(null,arguments)},Fe=a.stackSave=function(){return(Fe=a.stackSave=a.asm.Da).apply(null,arguments)},Ie=a.stackRestore=function(){return(Ie=a.stackRestore=a.asm.Ea).apply(null,arguments)},Ne=a.stackAlloc=function(){return(Ne=a.stackAlloc=a.asm.Fa).apply(null,arguments)};function Re(){function t(){if(!Le&&(Le=!0,a.calledRun=!0,!T)){if(a.noFSInit||pt||(pt=!0,ae(),a.stdin=a.stdin,a.stdout=a.stdout,a.stderr=a.stderr,a.stdin?se("stdin",a.stdin):Ht("/dev/tty","/dev/stdin"),a.stdout?se("stdout",null,a.stdout):Ht("/dev/tty","/dev/stdout"),a.stderr?se("stderr",null,a.stderr):Ht("/dev/tty1","/dev/stderr"),te("/dev/stdin",0),te("/dev/stdout",1),te("/dev/stderr",1)),kt=!1,et(z),a.onRuntimeInitialized&&a.onRuntimeInitialized(),a.postRun)for("function"==typeof a.postRun&&(a.postRun=[a.postRun]);a.postRun.length;){var t=a.postRun.shift();$.unshift(t)}et($)}}if(!(0<Y)){if(a.preRun)for("function"==typeof a.preRun&&(a.preRun=[a.preRun]);a.preRun.length;)q();et(U),0<Y||(a.setStatus?(a.setStatus("Running..."),setTimeout((function(){setTimeout((function(){a.setStatus("")}),1),t()}),1)):t())}}if(a.UTF8ToString=N,a.stackAlloc=Ne,a.stackSave=Fe,a.stackRestore=Ie,a.cwrap=function(t,e,r,n){var o=(r=r||[]).every((function(t){return"number"===t||"boolean"===t}));return"string"!==e&&o&&!n?a["_"+t]:function(){return function(t,e,r,n){var o={string:function(t){var e=0;if(null!=t&&0!==t){var r=1+(t.length<<2);e=Ne(r),R(t,S,e,r)}return e},array:function(t){var e=Ne(t.length);return j.set(t,e),e}};t=a["_"+t];var i,u=[],s=0;if(n)for(var c=0;c<n.length;c++){var l=o[r[c]];l?(0===s&&(s=Fe()),u[c]=l(n[c])):u[c]=n[c]}return i=r=t.apply(null,u),0!==s&&Ie(s),"string"===e?N(i):"boolean"===e?!!i:i}(t,e,r,arguments)}},W=function t(){Le||Re(),Le||(W=t)},a.preInit)for("function"==typeof a.preInit&&(a.preInit=[a.preInit]);0<a.preInit.length;)a.preInit.pop()();return Re(),u})),i)};"object"===o(e)&&"object"===o(t)?(t.exports=a,t.exports.default=a):n([],(function(){return a}))},6963:(t,e,r)=>{"use strict";r.d(e,{A:()=>c});const n={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};var o,i=new Uint8Array(16);function a(){if(!o&&!(o="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return o(i)}for(var u=[],s=0;s<256;++s)u.push((s+256).toString(16).slice(1));const c=function(t,e,r){if(n.randomUUID&&!e&&!t)return n.randomUUID();var o=(t=t||{}).random||(t.rng||a)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,e){r=r||0;for(var i=0;i<16;++i)e[r+i]=o[i];return e}return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(u[t[e+0]]+u[t[e+1]]+u[t[e+2]]+u[t[e+3]]+"-"+u[t[e+4]]+u[t[e+5]]+"-"+u[t[e+6]]+u[t[e+7]]+"-"+u[t[e+8]]+u[t[e+9]]+"-"+u[t[e+10]]+u[t[e+11]]+u[t[e+12]]+u[t[e+13]]+u[t[e+14]]+u[t[e+15]]).toLowerCase()}(o)}},7622:(t,e,r)=>{"use strict";r.d(e,{A:()=>o});const n=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i,o=function(t){return"string"==typeof t&&n.test(t)}},494:t=>{"use strict";t.exports=!1},7920:()=>{},6490:()=>{},9234:()=>{},5545:()=>{},4958:(t,e,r)=>{"use strict";r.d(e,{H_:()=>n.H_,Td:()=>n.Td});var n=r(9126)},491:(t,e,r)=>{"use strict";r.d(e,{N:()=>m});var n=r(6963),o=r(4865),i=r(4054);function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function s(t,e,r){return e=l(e),function(t,e){if(e&&("object"==a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,c()?Reflect.construct(e,r||[],l(t).constructor):e.apply(t,r))}function c(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(c=function(){return!!t})()}function l(t){return l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},l(t)}function f(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&p(t,e)}function p(t,e){return p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},p(t,e)}function h(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,y(n.key),n)}}function d(t,e,r){return e&&h(t.prototype,e),r&&h(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function y(t){var e=function(t){if("object"!=a(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==a(e)?e:e+""}function v(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var m=function(t){function e(t){var r,n,o,a,u,c,l,f;return v(this,e),r=s(this,e),Object.defineProperty(r,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(r,"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(r,"ignoreLLM",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(r,"ignoreChain",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(r,"ignoreAgent",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(r,"ignoreRetriever",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(r,"ignoreCustomEvent",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(r,"raiseError",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(r,"awaitHandlers",{enumerable:!0,configurable:!0,writable:!0,value:"true"!==(0,i.Az)("LANGCHAIN_CALLBACKS_BACKGROUND")}),r.lc_kwargs=t||{},t&&(r.ignoreLLM=null!==(n=t.ignoreLLM)&&void 0!==n?n:r.ignoreLLM,r.ignoreChain=null!==(o=t.ignoreChain)&&void 0!==o?o:r.ignoreChain,r.ignoreAgent=null!==(a=t.ignoreAgent)&&void 0!==a?a:r.ignoreAgent,r.ignoreRetriever=null!==(u=t.ignoreRetriever)&&void 0!==u?u:r.ignoreRetriever,r.ignoreCustomEvent=null!==(c=t.ignoreCustomEvent)&&void 0!==c?c:r.ignoreCustomEvent,r.raiseError=null!==(l=t.raiseError)&&void 0!==l?l:r.raiseError,r.awaitHandlers=r.raiseError||(null!==(f=t._awaitHandler)&&void 0!==f?f:r.awaitHandlers)),r}return f(e,t),d(e,[{key:"lc_namespace",get:function(){return["langchain_core","callbacks",this.name]}},{key:"lc_secrets",get:function(){}},{key:"lc_attributes",get:function(){}},{key:"lc_aliases",get:function(){}},{key:"lc_id",get:function(){return[].concat(function(t){if(Array.isArray(t))return u(t)}(t=this.lc_namespace)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return u(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[(0,o.Z)(this.constructor)]);var t}},{key:"copy",value:function(){return new this.constructor(this)}},{key:"toJSON",value:function(){return o.y.prototype.toJSON.call(this)}},{key:"toJSONNotImplemented",value:function(){return o.y.prototype.toJSONNotImplemented.call(this)}}],[{key:"lc_name",value:function(){return this.name}},{key:"fromMethods",value:function(t){return new(function(e){function r(){var e;return v(this,r),e=s(this,r),Object.defineProperty(e,"name",{enumerable:!0,configurable:!0,writable:!0,value:n.A()}),Object.assign(e,t),e}return f(r,e),d(r)}(e))}}])}(d((function t(){v(this,t)})))},9126:(t,e,r)=>{"use strict";r.d(e,{Td:()=>Et,tW:()=>Ot,H_:()=>vt});var n=r(6963),o=r(491),i=r(6170),a=r(4277);function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function c(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,l(n.key),n)}}function l(t){var e=function(t){if("object"!=u(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==u(e)?e:e+""}function f(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(f=function(){return!!t})()}function p(t){return p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},p(t)}function h(t,e){return h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},h(t,e)}function d(t,e){return"".concat(t.open).concat(e).concat(t.close)}function y(t,e){try{return JSON.stringify(t,null,2)}catch(t){return e}}function v(t){return"string"==typeof t?t.trim():null==t?t:y(t,t.toString())}function m(t){if(!t.end_time)return"";var e=t.end_time-t.start_time;return e<1e3?"".concat(e,"ms"):"".concat((e/1e3).toFixed(2),"s")}var b=i.color,g=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t=function(t,e,r){return e=p(e),function(t,e){if(e&&("object"==u(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,f()?Reflect.construct(e,r||[],p(t).constructor):e.apply(t,r))}(this,e,arguments),Object.defineProperty(t,"name",{enumerable:!0,configurable:!0,writable:!0,value:"console_callback_handler"}),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&h(t,e)}(e,t),r=e,(n=[{key:"persistRun",value:function(t){return Promise.resolve()}},{key:"getParents",value:function(t){for(var e=[],r=t;r.parent_run_id;){var n=this.runMap.get(r.parent_run_id);if(!n)break;e.push(n),r=n}return e}},{key:"getBreadcrumbs",value:function(t){var e=this.getParents(t).reverse(),r=[].concat(function(t){return function(t){if(Array.isArray(t))return s(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return s(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(e),[t]).map((function(t,e,r){var n="".concat(t.execution_order,":").concat(t.run_type,":").concat(t.name);return e===r.length-1?d(i.bold,n):n})).join(" > ");return d(b.grey,r)}},{key:"onChainStart",value:function(t){var e=this.getBreadcrumbs(t);console.log("".concat(d(b.green,"[chain/start]")," [").concat(e,"] Entering Chain run with input: ").concat(y(t.inputs,"[inputs]")))}},{key:"onChainEnd",value:function(t){var e=this.getBreadcrumbs(t);console.log("".concat(d(b.cyan,"[chain/end]")," [").concat(e,"] [").concat(m(t),"] Exiting Chain run with output: ").concat(y(t.outputs,"[outputs]")))}},{key:"onChainError",value:function(t){var e=this.getBreadcrumbs(t);console.log("".concat(d(b.red,"[chain/error]")," [").concat(e,"] [").concat(m(t),"] Chain run errored with error: ").concat(y(t.error,"[error]")))}},{key:"onLLMStart",value:function(t){var e=this.getBreadcrumbs(t),r="prompts"in t.inputs?{prompts:t.inputs.prompts.map((function(t){return t.trim()}))}:t.inputs;console.log("".concat(d(b.green,"[llm/start]")," [").concat(e,"] Entering LLM run with input: ").concat(y(r,"[inputs]")))}},{key:"onLLMEnd",value:function(t){var e=this.getBreadcrumbs(t);console.log("".concat(d(b.cyan,"[llm/end]")," [").concat(e,"] [").concat(m(t),"] Exiting LLM run with output: ").concat(y(t.outputs,"[response]")))}},{key:"onLLMError",value:function(t){var e=this.getBreadcrumbs(t);console.log("".concat(d(b.red,"[llm/error]")," [").concat(e,"] [").concat(m(t),"] LLM run errored with error: ").concat(y(t.error,"[error]")))}},{key:"onToolStart",value:function(t){var e=this.getBreadcrumbs(t);console.log("".concat(d(b.green,"[tool/start]")," [").concat(e,'] Entering Tool run with input: "').concat(v(t.inputs.input),'"'))}},{key:"onToolEnd",value:function(t){var e,r=this.getBreadcrumbs(t);console.log("".concat(d(b.cyan,"[tool/end]")," [").concat(r,"] [").concat(m(t),'] Exiting Tool run with output: "').concat(v(null===(e=t.outputs)||void 0===e?void 0:e.output),'"'))}},{key:"onToolError",value:function(t){var e=this.getBreadcrumbs(t);console.log("".concat(d(b.red,"[tool/error]")," [").concat(e,"] [").concat(m(t),"] Tool run errored with error: ").concat(y(t.error,"[error]")))}},{key:"onRetrieverStart",value:function(t){var e=this.getBreadcrumbs(t);console.log("".concat(d(b.green,"[retriever/start]")," [").concat(e,"] Entering Retriever run with input: ").concat(y(t.inputs,"[inputs]")))}},{key:"onRetrieverEnd",value:function(t){var e=this.getBreadcrumbs(t);console.log("".concat(d(b.cyan,"[retriever/end]")," [").concat(e,"] [").concat(m(t),"] Exiting Retriever run with output: ").concat(y(t.outputs,"[outputs]")))}},{key:"onRetrieverError",value:function(t){var e=this.getBreadcrumbs(t);console.log("".concat(d(b.red,"[retriever/error]")," [").concat(e,"] [").concat(m(t),"] Retriever run errored with error: ").concat(y(t.error,"[error]")))}},{key:"onAgentAction",value:function(t){var e=t,r=this.getBreadcrumbs(t);console.log("".concat(d(b.blue,"[agent/action]")," [").concat(r,"] Agent selected action: ").concat(y(e.actions[e.actions.length-1],"[action]")))}}])&&c(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(a.J),w=r(9721),x=r(4054),_=r(3836),E=r(2877),O=r(8956);function k(t){return k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},k(t)}function j(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],s=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);s=!0);}catch(t){c=!0,o=t}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(t,e)||A(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(t){return function(t){if(Array.isArray(t))return D(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||A(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(t,e){if(t){if("string"==typeof t)return D(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?D(t,e):void 0}}function D(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function P(){P=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:S(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function b(){}function g(){}var w={};c(w,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(T([])));_&&_!==r&&n.call(_,a)&&(w=_);var E=g.prototype=m.prototype=Object.create(w);function O(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function j(t,e){function r(o,i,a,u){var s=f(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==k(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function S(e,r,n){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=A(u,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?y:h,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=y,n.method="throw",n.arg=c.arg)}}}function A(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,A(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function D(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(D,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(k(e)+" is not iterable")}return b.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=c(g,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,c(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},O(j.prototype),c(j.prototype,u,(function(){return this})),e.AsyncIterator=j,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new j(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(E),c(E,s,"Generator"),c(E,a,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),C(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;C(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function C(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function L(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?C(Object(r),!0).forEach((function(e){T(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):C(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function T(t,e,r){return(e=R(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function F(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function I(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){F(i,n,o,a,u,"next",t)}function u(t){F(i,n,o,a,u,"throw",t)}a(void 0)}))}}function N(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,R(n.key),n)}}function R(t){var e=function(t){if("object"!=k(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=k(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==k(e)?e:e+""}function M(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(M=function(){return!!t})()}function B(t){return B=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},B(t)}function G(t,e){return G=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},G(t,e)}var U,z=function(t){function e(){var t,r,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=function(t,e,r){return e=B(e),function(t,e){if(e&&("object"==k(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,M()?Reflect.construct(e,r||[],B(t).constructor):e.apply(t,r))}(this,e,[n]),Object.defineProperty(r,"name",{enumerable:!0,configurable:!0,writable:!0,value:"langchain_tracer"}),Object.defineProperty(r,"projectName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(r,"exampleId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(r,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0});var o=n.exampleId,i=n.projectName,a=n.client;r.projectName=null!==(t=null!=i?i:(0,x.Az)("LANGCHAIN_PROJECT"))&&void 0!==t?t:(0,x.Az)("LANGCHAIN_SESSION"),r.exampleId=o,r.client=null!=a?a:new _.Kj({});var u=e.getTraceableRunTree();return u&&r.updateFromRunTree(u),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&G(t,e)}(e,t),r=e,n=[{key:"_convertToCreate",value:(s=I(P().mark((function t(e){var r,n=arguments;return P().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.length>1&&void 0!==n[1]?n[1]:void 0,t.t0=L,t.t1=L({},e),t.t2={},t.t3=L,t.t4=L({},e.extra),t.t5={},t.next=9,(0,x.Ec)();case 9:return t.t6=t.sent,t.t7={runtime:t.t6},t.t8=(0,t.t3)(t.t4,t.t5,t.t7),t.t9=void 0,t.t10=this.projectName,t.t11=e.parent_run_id?void 0:r,t.t12={extra:t.t8,child_runs:t.t9,session_name:t.t10,reference_example_id:t.t11},t.abrupt("return",(0,t.t0)(t.t1,t.t2,t.t12));case 17:case"end":return t.stop()}}),t,this)}))),function(t){return s.apply(this,arguments)})},{key:"persistRun",value:(u=I(P().mark((function t(e){return P().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(t){return u.apply(this,arguments)})},{key:"onRunCreate",value:(a=I(P().mark((function t(e){var r;return P().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._convertToCreate(e,this.exampleId);case 2:return r=t.sent,t.next=5,this.client.createRun(r);case 5:case"end":return t.stop()}}),t,this)}))),function(t){return a.apply(this,arguments)})},{key:"onRunUpdate",value:(i=I(P().mark((function t(e){var r;return P().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r={end_time:e.end_time,error:e.error,outputs:e.outputs,events:e.events,inputs:e.inputs,trace_id:e.trace_id,dotted_order:e.dotted_order,parent_run_id:e.parent_run_id},t.next=3,this.client.updateRun(e.id,r);case 3:case"end":return t.stop()}}),t,this)}))),function(t){return i.apply(this,arguments)})},{key:"getRun",value:function(t){return this.runMap.get(t)}},{key:"updateFromRunTree",value:function(t){for(var e,r,n,o=t,i=new Set;o.parent_run&&!i.has(o.id)&&(i.add(o.id),o.parent_run);)o=o.parent_run;i.clear();for(var a=[o];a.length>0;){var u=a.shift();u&&!i.has(u.id)&&(i.add(u.id),this.runMap.set(u.id,u),u.child_runs&&a.push.apply(a,S(u.child_runs)))}this.client=null!==(e=t.client)&&void 0!==e?e:this.client,this.projectName=null!==(r=t.project_name)&&void 0!==r?r:this.projectName,this.exampleId=null!==(n=t.reference_example_id)&&void 0!==n?n:this.exampleId}},{key:"convertToRunTree",value:function(t){var e,r={},n=[],o=function(t){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=A(t))){e&&(t=e);var r=0,n=function(){};return{s:n,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,a=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return i=t.done,t},e:function(t){a=!0,o=t},f:function(){try{i||null==e.return||e.return()}finally{if(a)throw o}}}}(this.runMap);try{for(o.s();!(e=o.n()).done;){var i=j(e.value,2),a=i[0],u=i[1],s=new E.gk(L(L({},u),{},{child_runs:[],parent_run:void 0,client:this.client,project_name:this.projectName,reference_example_id:this.exampleId,tracingEnabled:!0}));r[a]=s,n.push([a,u.dotted_order])}}catch(t){o.e(t)}finally{o.f()}n.sort((function(t,e){return t[1]&&e[1]?t[1].localeCompare(e[1]):0}));for(var c=0,l=n;c<l.length;c++){var f=j(l[c],1)[0],p=this.runMap.get(f),h=r[f];if(p&&h&&p.parent_run_id){var d=r[p.parent_run_id];d&&(d.child_runs.push(h),h.parent_run=d)}}return r[t]}}],o=[{key:"getTraceableRunTree",value:function(){try{return(0,O.vR)()}catch(t){return}}}],n&&N(r.prototype,n),o&&N(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o,i,a,u,s}(a.J),$=r(4869);function q(t){return q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},q(t)}function K(){K=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new P(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function b(){}function g(){}var w={};c(w,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(w=_);var E=g.prototype=m.prototype=Object.create(w);function O(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,i,a,u){var s=f(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==q(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=S(u,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?y:h,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=y,n.method="throw",n.arg=c.arg)}}}function S(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,S(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function C(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(q(e)+" is not iterable")}return b.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=c(g,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,c(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},O(k.prototype),c(k.prototype,u,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(E),c(E,s,"Generator"),c(E,a,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=C,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),D(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;D(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:C(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function H(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function Z(t,e){return Y.apply(this,arguments)}function Y(){var t;return t=K().mark((function t(e,r){return K().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!0!==r){t.next=5;break}return t.next=3,e();case 3:t.next=7;break;case 5:void 0===U&&(U=new(0,$.default)({autoStart:!0,concurrency:1})),U.add(e);case 7:case"end":return t.stop()}}),t)})),Y=function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){H(i,n,o,a,u,"next",t)}function u(t){H(i,n,o,a,u,"throw",t)}a(void 0)}))},Y.apply(this,arguments)}var V=function(t){return void 0!==t?t:!!["LANGSMITH_TRACING_V2","LANGCHAIN_TRACING_V2","LANGSMITH_TRACING","LANGCHAIN_TRACING"].find((function(t){return"true"===(0,x.Az)(t)}))};function W(t){return W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},W(t)}function J(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function X(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?J(Object(r),!0).forEach((function(e){Q(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):J(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Q(t,e,r){return(e=yt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function tt(t){return function(t){if(Array.isArray(t))return nt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||rt(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function et(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=rt(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}function rt(t,e){if(t){if("string"==typeof t)return nt(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?nt(t,e):void 0}}function nt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function ot(t,e,r){return e=at(e),function(t,e){if(e&&("object"==W(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,it()?Reflect.construct(e,r||[],at(t).constructor):e.apply(t,r))}function it(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(it=function(){return!!t})()}function at(t){return at=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},at(t)}function ut(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&st(t,e)}function st(t,e){return st=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},st(t,e)}function ct(){ct=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new P(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function b(){}function g(){}var w={};c(w,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(w=_);var E=g.prototype=m.prototype=Object.create(w);function O(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,i,a,u){var s=f(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==W(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=S(u,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?y:h,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=y,n.method="throw",n.arg=c.arg)}}}function S(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,S(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function C(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(W(e)+" is not iterable")}return b.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=c(g,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,c(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},O(k.prototype),c(k.prototype,u,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(E),c(E,s,"Generator"),c(E,a,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=C,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),D(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;D(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:C(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function lt(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function ft(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){lt(i,n,o,a,u,"next",t)}function u(t){lt(i,n,o,a,u,"throw",t)}a(void 0)}))}}function pt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ht(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,yt(n.key),n)}}function dt(t,e,r){return e&&ht(t.prototype,e),r&&ht(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function yt(t){var e=function(t){if("object"!=W(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=W(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==W(e)?e:e+""}function vt(t){return t?Array.isArray(t)||"name"in t?{callbacks:t}:t:{}}V()&&"true"!==(0,x.Az)("LANGCHAIN_CALLBACKS_BACKGROUND")&&["[WARN]: You have enabled LangSmith tracing without backgrounding callbacks.","[WARN]: If you are not using a serverless environment where you must wait for tracing calls to finish,",'[WARN]: we suggest setting "process.env.LANGCHAIN_CALLBACKS_BACKGROUND=true" to avoid additional latency.'].join("\n");var mt=function(){return dt((function t(){pt(this,t)}),[{key:"setHandler",value:function(t){return this.setHandlers([t])}}])}(),bt=function(){return dt((function t(e,r,n,o,i,a,u,s){pt(this,t),Object.defineProperty(this,"runId",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:o}),Object.defineProperty(this,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(this,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:u}),Object.defineProperty(this,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:s})}),[{key:"parentRunId",get:function(){return this._parentRunId}},{key:"handleText",value:(e=ft(ct().mark((function t(e){var r=this;return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(this.handlers.map((function(t){return Z(ft(ct().mark((function n(){var o;return ct().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,null===(o=t.handleText)||void 0===o?void 0:o.call(t,e,r.runId,r._parentRunId,r.tags);case 3:n.next=11;break;case 5:if(n.prev=5,n.t0=n.catch(0),(t.raiseError?console.error:console.warn)("Error in handler ".concat(t.constructor.name,", handleText: ").concat(n.t0)),!t.raiseError){n.next=11;break}throw n.t0;case 11:case"end":return n.stop()}}),n,null,[[0,5]])}))),t.awaitHandlers)})));case 2:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})},{key:"handleCustomEvent",value:(t=ft(ct().mark((function t(e,r,n,o,i){var a=this;return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(this.handlers.map((function(t){return Z(ft(ct().mark((function n(){var o;return ct().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,null===(o=t.handleCustomEvent)||void 0===o?void 0:o.call(t,e,r,a.runId,a.tags,a.metadata);case 3:n.next=11;break;case 5:if(n.prev=5,n.t0=n.catch(0),(t.raiseError?console.error:console.warn)("Error in handler ".concat(t.constructor.name,", handleCustomEvent: ").concat(n.t0)),!t.raiseError){n.next=11;break}throw n.t0;case 11:case"end":return n.stop()}}),n,null,[[0,5]])}))),t.awaitHandlers)})));case 2:case"end":return t.stop()}}),t,this)}))),function(e,r,n,o,i){return t.apply(this,arguments)})}]);var t,e}(),gt=function(t){function e(){return pt(this,e),ot(this,e,arguments)}return ut(e,t),dt(e,[{key:"getChild",value:function(t){var e=new Et(this.runId);return e.setHandlers(this.inheritableHandlers),e.addTags(this.inheritableTags),e.addMetadata(this.inheritableMetadata),t&&e.addTags([t],!1),e}},{key:"handleRetrieverEnd",value:(n=ft(ct().mark((function t(e){var r=this;return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(this.handlers.map((function(t){return Z(ft(ct().mark((function n(){var o;return ct().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t.ignoreRetriever){n.next=12;break}return n.prev=1,n.next=4,null===(o=t.handleRetrieverEnd)||void 0===o?void 0:o.call(t,e,r.runId,r._parentRunId,r.tags);case 4:n.next=12;break;case 6:if(n.prev=6,n.t0=n.catch(1),(t.raiseError?console.error:console.warn)("Error in handler ".concat(t.constructor.name,", handleRetriever")),!t.raiseError){n.next=12;break}throw n.t0;case 12:case"end":return n.stop()}}),n,null,[[1,6]])}))),t.awaitHandlers)})));case 2:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"handleRetrieverError",value:(r=ft(ct().mark((function t(e){var r=this;return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(this.handlers.map((function(t){return Z(ft(ct().mark((function n(){var o;return ct().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t.ignoreRetriever){n.next=12;break}return n.prev=1,n.next=4,null===(o=t.handleRetrieverError)||void 0===o?void 0:o.call(t,e,r.runId,r._parentRunId,r.tags);case 4:n.next=12;break;case 6:if(n.prev=6,n.t0=n.catch(1),(t.raiseError?console.error:console.warn)("Error in handler ".concat(t.constructor.name,", handleRetrieverError: ").concat(n.t0)),!t.raiseError){n.next=12;break}throw e;case 12:case"end":return n.stop()}}),n,null,[[1,6]])}))),t.awaitHandlers)})));case 2:case"end":return t.stop()}}),t,this)}))),function(t){return r.apply(this,arguments)})}]);var r,n}(bt),wt=function(t){function e(){return pt(this,e),ot(this,e,arguments)}return ut(e,t),dt(e,[{key:"handleLLMNewToken",value:(o=ft(ct().mark((function t(e,r,n,o,i,a){var u=this;return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(this.handlers.map((function(t){return Z(ft(ct().mark((function n(){var o;return ct().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t.ignoreLLM){n.next=12;break}return n.prev=1,n.next=4,null===(o=t.handleLLMNewToken)||void 0===o?void 0:o.call(t,e,null!=r?r:{prompt:0,completion:0},u.runId,u._parentRunId,u.tags,a);case 4:n.next=12;break;case 6:if(n.prev=6,n.t0=n.catch(1),(t.raiseError?console.error:console.warn)("Error in handler ".concat(t.constructor.name,", handleLLMNewToken: ").concat(n.t0)),!t.raiseError){n.next=12;break}throw n.t0;case 12:case"end":return n.stop()}}),n,null,[[1,6]])}))),t.awaitHandlers)})));case 2:case"end":return t.stop()}}),t,this)}))),function(t,e,r,n,i,a){return o.apply(this,arguments)})},{key:"handleLLMError",value:(n=ft(ct().mark((function t(e){var r=this;return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(this.handlers.map((function(t){return Z(ft(ct().mark((function n(){var o;return ct().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t.ignoreLLM){n.next=12;break}return n.prev=1,n.next=4,null===(o=t.handleLLMError)||void 0===o?void 0:o.call(t,e,r.runId,r._parentRunId,r.tags);case 4:n.next=12;break;case 6:if(n.prev=6,n.t0=n.catch(1),(t.raiseError?console.error:console.warn)("Error in handler ".concat(t.constructor.name,", handleLLMError: ").concat(n.t0)),!t.raiseError){n.next=12;break}throw n.t0;case 12:case"end":return n.stop()}}),n,null,[[1,6]])}))),t.awaitHandlers)})));case 2:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"handleLLMEnd",value:(r=ft(ct().mark((function t(e){var r=this;return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(this.handlers.map((function(t){return Z(ft(ct().mark((function n(){var o;return ct().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t.ignoreLLM){n.next=12;break}return n.prev=1,n.next=4,null===(o=t.handleLLMEnd)||void 0===o?void 0:o.call(t,e,r.runId,r._parentRunId,r.tags);case 4:n.next=12;break;case 6:if(n.prev=6,n.t0=n.catch(1),(t.raiseError?console.error:console.warn)("Error in handler ".concat(t.constructor.name,", handleLLMEnd: ").concat(n.t0)),!t.raiseError){n.next=12;break}throw n.t0;case 12:case"end":return n.stop()}}),n,null,[[1,6]])}))),t.awaitHandlers)})));case 2:case"end":return t.stop()}}),t,this)}))),function(t){return r.apply(this,arguments)})}]);var r,n,o}(bt),xt=function(t){function e(){return pt(this,e),ot(this,e,arguments)}return ut(e,t),dt(e,[{key:"getChild",value:function(t){var e=new Et(this.runId);return e.setHandlers(this.inheritableHandlers),e.addTags(this.inheritableTags),e.addMetadata(this.inheritableMetadata),t&&e.addTags([t],!1),e}},{key:"handleChainError",value:(i=ft(ct().mark((function t(e,r,n,o,i){var a=this;return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(this.handlers.map((function(t){return Z(ft(ct().mark((function r(){var n;return ct().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t.ignoreChain){r.next=12;break}return r.prev=1,r.next=4,null===(n=t.handleChainError)||void 0===n?void 0:n.call(t,e,a.runId,a._parentRunId,a.tags,i);case 4:r.next=12;break;case 6:if(r.prev=6,r.t0=r.catch(1),(t.raiseError?console.error:console.warn)("Error in handler ".concat(t.constructor.name,", handleChainError: ").concat(r.t0)),!t.raiseError){r.next=12;break}throw r.t0;case 12:case"end":return r.stop()}}),r,null,[[1,6]])}))),t.awaitHandlers)})));case 2:case"end":return t.stop()}}),t,this)}))),function(t,e,r,n,o){return i.apply(this,arguments)})},{key:"handleChainEnd",value:(o=ft(ct().mark((function t(e,r,n,o,i){var a=this;return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(this.handlers.map((function(t){return Z(ft(ct().mark((function r(){var n;return ct().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t.ignoreChain){r.next=12;break}return r.prev=1,r.next=4,null===(n=t.handleChainEnd)||void 0===n?void 0:n.call(t,e,a.runId,a._parentRunId,a.tags,i);case 4:r.next=12;break;case 6:if(r.prev=6,r.t0=r.catch(1),(t.raiseError?console.error:console.warn)("Error in handler ".concat(t.constructor.name,", handleChainEnd: ").concat(r.t0)),!t.raiseError){r.next=12;break}throw r.t0;case 12:case"end":return r.stop()}}),r,null,[[1,6]])}))),t.awaitHandlers)})));case 2:case"end":return t.stop()}}),t,this)}))),function(t,e,r,n,i){return o.apply(this,arguments)})},{key:"handleAgentAction",value:(n=ft(ct().mark((function t(e){var r=this;return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(this.handlers.map((function(t){return Z(ft(ct().mark((function n(){var o;return ct().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t.ignoreAgent){n.next=12;break}return n.prev=1,n.next=4,null===(o=t.handleAgentAction)||void 0===o?void 0:o.call(t,e,r.runId,r._parentRunId,r.tags);case 4:n.next=12;break;case 6:if(n.prev=6,n.t0=n.catch(1),(t.raiseError?console.error:console.warn)("Error in handler ".concat(t.constructor.name,", handleAgentAction: ").concat(n.t0)),!t.raiseError){n.next=12;break}throw n.t0;case 12:case"end":return n.stop()}}),n,null,[[1,6]])}))),t.awaitHandlers)})));case 2:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"handleAgentEnd",value:(r=ft(ct().mark((function t(e){var r=this;return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(this.handlers.map((function(t){return Z(ft(ct().mark((function n(){var o;return ct().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t.ignoreAgent){n.next=12;break}return n.prev=1,n.next=4,null===(o=t.handleAgentEnd)||void 0===o?void 0:o.call(t,e,r.runId,r._parentRunId,r.tags);case 4:n.next=12;break;case 6:if(n.prev=6,n.t0=n.catch(1),(t.raiseError?console.error:console.warn)("Error in handler ".concat(t.constructor.name,", handleAgentEnd: ").concat(n.t0)),!t.raiseError){n.next=12;break}throw n.t0;case 12:case"end":return n.stop()}}),n,null,[[1,6]])}))),t.awaitHandlers)})));case 2:case"end":return t.stop()}}),t,this)}))),function(t){return r.apply(this,arguments)})}]);var r,n,o,i}(bt),_t=function(t){function e(){return pt(this,e),ot(this,e,arguments)}return ut(e,t),dt(e,[{key:"getChild",value:function(t){var e=new Et(this.runId);return e.setHandlers(this.inheritableHandlers),e.addTags(this.inheritableTags),e.addMetadata(this.inheritableMetadata),t&&e.addTags([t],!1),e}},{key:"handleToolError",value:(n=ft(ct().mark((function t(e){var r=this;return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(this.handlers.map((function(t){return Z(ft(ct().mark((function n(){var o;return ct().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t.ignoreAgent){n.next=12;break}return n.prev=1,n.next=4,null===(o=t.handleToolError)||void 0===o?void 0:o.call(t,e,r.runId,r._parentRunId,r.tags);case 4:n.next=12;break;case 6:if(n.prev=6,n.t0=n.catch(1),(t.raiseError?console.error:console.warn)("Error in handler ".concat(t.constructor.name,", handleToolError: ").concat(n.t0)),!t.raiseError){n.next=12;break}throw n.t0;case 12:case"end":return n.stop()}}),n,null,[[1,6]])}))),t.awaitHandlers)})));case 2:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"handleToolEnd",value:(r=ft(ct().mark((function t(e){var r=this;return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(this.handlers.map((function(t){return Z(ft(ct().mark((function n(){var o;return ct().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t.ignoreAgent){n.next=12;break}return n.prev=1,n.next=4,null===(o=t.handleToolEnd)||void 0===o?void 0:o.call(t,e,r.runId,r._parentRunId,r.tags);case 4:n.next=12;break;case 6:if(n.prev=6,n.t0=n.catch(1),(t.raiseError?console.error:console.warn)("Error in handler ".concat(t.constructor.name,", handleToolEnd: ").concat(n.t0)),!t.raiseError){n.next=12;break}throw n.t0;case 12:case"end":return n.stop()}}),n,null,[[1,6]])}))),t.awaitHandlers)})));case 2:case"end":return t.stop()}}),t,this)}))),function(t){return r.apply(this,arguments)})}]);var r,n}(bt),Et=function(t){function e(t,r){var n,o,i,a,u,s,c;return pt(this,e),c=ot(this,e),Object.defineProperty(c,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(c,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(c,"tags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(c,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(c,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(c,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(c,"name",{enumerable:!0,configurable:!0,writable:!0,value:"callback_manager"}),Object.defineProperty(c,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),c.handlers=null!==(n=null==r?void 0:r.handlers)&&void 0!==n?n:c.handlers,c.inheritableHandlers=null!==(o=null==r?void 0:r.inheritableHandlers)&&void 0!==o?o:c.inheritableHandlers,c.tags=null!==(i=null==r?void 0:r.tags)&&void 0!==i?i:c.tags,c.inheritableTags=null!==(a=null==r?void 0:r.inheritableTags)&&void 0!==a?a:c.inheritableTags,c.metadata=null!==(u=null==r?void 0:r.metadata)&&void 0!==u?u:c.metadata,c.inheritableMetadata=null!==(s=null==r?void 0:r.inheritableMetadata)&&void 0!==s?s:c.inheritableMetadata,c._parentRunId=t,c}return ut(e,t),dt(e,[{key:"getParentRunId",value:function(){return this._parentRunId}},{key:"handleLLMStart",value:(f=ft(ct().mark((function t(e,r){var o,i,u,s=this,c=arguments;return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=c.length>2&&void 0!==c[2]?c[2]:void 0,i=c.length>4&&void 0!==c[4]?c[4]:void 0,u=c.length>7&&void 0!==c[7]?c[7]:void 0,t.abrupt("return",Promise.all(r.map(function(){var t=ft(ct().mark((function t(r,c){var l;return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return l=0===c&&o?o:(0,n.A)(),t.next=3,Promise.all(s.handlers.map((function(t){if(!t.ignoreLLM)return(0,a.j)(t)&&t._createRunForLLMStart(e,[r],l,s._parentRunId,i,s.tags,s.metadata,u),Z(ft(ct().mark((function n(){var o;return ct().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,null===(o=t.handleLLMStart)||void 0===o?void 0:o.call(t,e,[r],l,s._parentRunId,i,s.tags,s.metadata,u);case 3:n.next=11;break;case 5:if(n.prev=5,n.t0=n.catch(0),(t.raiseError?console.error:console.warn)("Error in handler ".concat(t.constructor.name,", handleLLMStart: ").concat(n.t0)),!t.raiseError){n.next=11;break}throw n.t0;case 11:case"end":return n.stop()}}),n,null,[[0,5]])}))),t.awaitHandlers)})));case 3:return t.abrupt("return",new wt(l,s.handlers,s.inheritableHandlers,s.tags,s.inheritableTags,s.metadata,s.inheritableMetadata,s._parentRunId));case 4:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}())));case 7:case"end":return t.stop()}}),t)}))),function(t,e){return f.apply(this,arguments)})},{key:"handleChatModelStart",value:(l=ft(ct().mark((function t(e,r){var o,i,u,s=this,c=arguments;return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=c.length>2&&void 0!==c[2]?c[2]:void 0,i=c.length>4&&void 0!==c[4]?c[4]:void 0,u=c.length>7&&void 0!==c[7]?c[7]:void 0,t.abrupt("return",Promise.all(r.map(function(){var t=ft(ct().mark((function t(r,c){var l;return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return l=0===c&&o?o:(0,n.A)(),t.next=3,Promise.all(s.handlers.map((function(t){if(!t.ignoreLLM)return(0,a.j)(t)&&t._createRunForChatModelStart(e,[r],l,s._parentRunId,i,s.tags,s.metadata,u),Z(ft(ct().mark((function n(){var o,a,c;return ct().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,!t.handleChatModelStart){n.next=6;break}return n.next=4,null===(o=t.handleChatModelStart)||void 0===o?void 0:o.call(t,e,[r],l,s._parentRunId,i,s.tags,s.metadata,u);case 4:n.next=10;break;case 6:if(!t.handleLLMStart){n.next=10;break}return c=(0,w.Sw)(r),n.next=10,null===(a=t.handleLLMStart)||void 0===a?void 0:a.call(t,e,[c],l,s._parentRunId,i,s.tags,s.metadata,u);case 10:n.next=18;break;case 12:if(n.prev=12,n.t0=n.catch(0),(t.raiseError?console.error:console.warn)("Error in handler ".concat(t.constructor.name,", handleLLMStart: ").concat(n.t0)),!t.raiseError){n.next=18;break}throw n.t0;case 18:case"end":return n.stop()}}),n,null,[[0,12]])}))),t.awaitHandlers)})));case 3:return t.abrupt("return",new wt(l,s.handlers,s.inheritableHandlers,s.tags,s.inheritableTags,s.metadata,s.inheritableMetadata,s._parentRunId));case 4:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}())));case 7:case"end":return t.stop()}}),t)}))),function(t,e){return l.apply(this,arguments)})},{key:"handleChainStart",value:(c=ft(ct().mark((function t(e,r){var o,i,u,s=this,c=arguments;return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=c.length>2&&void 0!==c[2]?c[2]:(0,n.A)(),i=c.length>3&&void 0!==c[3]?c[3]:void 0,u=c.length>6&&void 0!==c[6]?c[6]:void 0,t.next=7,Promise.all(this.handlers.map((function(t){if(!t.ignoreChain)return(0,a.j)(t)&&t._createRunForChainStart(e,r,o,s._parentRunId,s.tags,s.metadata,i,u),Z(ft(ct().mark((function n(){var a;return ct().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,null===(a=t.handleChainStart)||void 0===a?void 0:a.call(t,e,r,o,s._parentRunId,s.tags,s.metadata,i,u);case 3:n.next=11;break;case 5:if(n.prev=5,n.t0=n.catch(0),(t.raiseError?console.error:console.warn)("Error in handler ".concat(t.constructor.name,", handleChainStart: ").concat(n.t0)),!t.raiseError){n.next=11;break}throw n.t0;case 11:case"end":return n.stop()}}),n,null,[[0,5]])}))),t.awaitHandlers)})));case 7:return t.abrupt("return",new xt(o,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId));case 8:case"end":return t.stop()}}),t,this)}))),function(t,e){return c.apply(this,arguments)})},{key:"handleToolStart",value:(s=ft(ct().mark((function t(e,r){var o,i,u=this,s=arguments;return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=s.length>2&&void 0!==s[2]?s[2]:(0,n.A)(),i=s.length>6&&void 0!==s[6]?s[6]:void 0,t.next=7,Promise.all(this.handlers.map((function(t){if(!t.ignoreAgent)return(0,a.j)(t)&&t._createRunForToolStart(e,r,o,u._parentRunId,u.tags,u.metadata,i),Z(ft(ct().mark((function n(){var a;return ct().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,null===(a=t.handleToolStart)||void 0===a?void 0:a.call(t,e,r,o,u._parentRunId,u.tags,u.metadata,i);case 3:n.next=11;break;case 5:if(n.prev=5,n.t0=n.catch(0),(t.raiseError?console.error:console.warn)("Error in handler ".concat(t.constructor.name,", handleToolStart: ").concat(n.t0)),!t.raiseError){n.next=11;break}throw n.t0;case 11:case"end":return n.stop()}}),n,null,[[0,5]])}))),t.awaitHandlers)})));case 7:return t.abrupt("return",new _t(o,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId));case 8:case"end":return t.stop()}}),t,this)}))),function(t,e){return s.apply(this,arguments)})},{key:"handleRetrieverStart",value:(u=ft(ct().mark((function t(e,r){var o,i,u=this,s=arguments;return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=s.length>2&&void 0!==s[2]?s[2]:(0,n.A)(),i=s.length>6&&void 0!==s[6]?s[6]:void 0,t.next=7,Promise.all(this.handlers.map((function(t){if(!t.ignoreRetriever)return(0,a.j)(t)&&t._createRunForRetrieverStart(e,r,o,u._parentRunId,u.tags,u.metadata,i),Z(ft(ct().mark((function n(){var a;return ct().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,null===(a=t.handleRetrieverStart)||void 0===a?void 0:a.call(t,e,r,o,u._parentRunId,u.tags,u.metadata,i);case 3:n.next=11;break;case 5:if(n.prev=5,n.t0=n.catch(0),(t.raiseError?console.error:console.warn)("Error in handler ".concat(t.constructor.name,", handleRetrieverStart: ").concat(n.t0)),!t.raiseError){n.next=11;break}throw n.t0;case 11:case"end":return n.stop()}}),n,null,[[0,5]])}))),t.awaitHandlers)})));case 7:return t.abrupt("return",new gt(o,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId));case 8:case"end":return t.stop()}}),t,this)}))),function(t,e){return u.apply(this,arguments)})},{key:"handleCustomEvent",value:(i=ft(ct().mark((function t(e,r,n,o,i){var a=this;return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(this.handlers.map((function(t){return Z(ft(ct().mark((function o(){var i;return ct().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(t.ignoreCustomEvent){o.next=12;break}return o.prev=1,o.next=4,null===(i=t.handleCustomEvent)||void 0===i?void 0:i.call(t,e,r,n,a.tags,a.metadata);case 4:o.next=12;break;case 6:if(o.prev=6,o.t0=o.catch(1),(t.raiseError?console.error:console.warn)("Error in handler ".concat(t.constructor.name,", handleCustomEvent: ").concat(o.t0)),!t.raiseError){o.next=12;break}throw o.t0;case 12:case"end":return o.stop()}}),o,null,[[1,6]])}))),t.awaitHandlers)})));case 2:case"end":return t.stop()}}),t,this)}))),function(t,e,r,n,o){return i.apply(this,arguments)})},{key:"addHandler",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.handlers.push(t),e&&this.inheritableHandlers.push(t)}},{key:"removeHandler",value:function(t){this.handlers=this.handlers.filter((function(e){return e!==t})),this.inheritableHandlers=this.inheritableHandlers.filter((function(e){return e!==t}))}},{key:"setHandlers",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.handlers=[],this.inheritableHandlers=[];var r,n=et(t);try{for(n.s();!(r=n.n()).done;){var o=r.value;this.addHandler(o,e)}}catch(t){n.e(t)}finally{n.f()}}},{key:"addTags",value:function(t){var e,r,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.removeTags(t),(e=this.tags).push.apply(e,tt(t)),n&&(r=this.inheritableTags).push.apply(r,tt(t))}},{key:"removeTags",value:function(t){this.tags=this.tags.filter((function(e){return!t.includes(e)})),this.inheritableTags=this.inheritableTags.filter((function(e){return!t.includes(e)}))}},{key:"addMetadata",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.metadata=X(X({},this.metadata),t),e&&(this.inheritableMetadata=X(X({},this.inheritableMetadata),t))}},{key:"removeMetadata",value:function(t){for(var e=0,r=Object.keys(t);e<r.length;e++){var n=r[e];delete this.metadata[n],delete this.inheritableMetadata[n]}}},{key:"copy",value:function(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=new e(this._parentRunId),i=et(this.handlers);try{for(i.s();!(t=i.n()).done;){var a=t.value,u=this.inheritableHandlers.includes(a);o.addHandler(a,u)}}catch(t){i.e(t)}finally{i.f()}var s,c=et(this.tags);try{for(c.s();!(s=c.n()).done;){var l=s.value,f=this.inheritableTags.includes(l);o.addTags([l],f)}}catch(t){c.e(t)}finally{c.f()}for(var p=0,h=Object.keys(this.metadata);p<h.length;p++){var d=h[p],y=Object.keys(this.inheritableMetadata).includes(d);o.addMetadata(Q({},d,this.metadata[d]),y)}var v,m=et(r);try{var b=function(){var t=v.value;if(o.handlers.filter((function(t){return"console_callback_handler"===t.name})).some((function(e){return e.name===t.name})))return 1;o.addHandler(t,n)};for(m.s();!(v=m.n()).done;)b()}catch(t){m.e(t)}finally{m.f()}return o}}],[{key:"fromHandlers",value:function(t){var e=function(e){function r(){var e;return pt(this,r),e=ot(this,r),Object.defineProperty(e,"name",{enumerable:!0,configurable:!0,writable:!0,value:(0,n.A)()}),Object.assign(e,t),e}return ut(r,e),dt(r)}(o.N),r=new this;return r.addHandler(new e),r}},{key:"configure",value:(r=ft(ct().mark((function t(e,r,n,o,i,a,u){return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this._configureSync(e,r,n,o,i,a,u));case 1:case"end":return t.stop()}}),t,this)}))),function(t,e,n,o,i,a,u){return r.apply(this,arguments)})},{key:"_configureSync",value:function(t,r,n,o,i,a,u){var s,c,l,f;(t||r)&&(Array.isArray(t)||!t?(l=new e).setHandlers(null!==(f=null==t?void 0:t.map(Ot))&&void 0!==f?f:[],!0):l=t,l=l.copy(Array.isArray(r)?r.map(Ot):null==r?void 0:r.handlers,!1));var p="true"===(0,x.Az)("LANGCHAIN_VERBOSE")||(null==u?void 0:u.verbose),h=(null===(s=z.getTraceableRunTree())||void 0===s?void 0:s.tracingEnabled)||V(),d=h||null!==(c=(0,x.Az)("LANGCHAIN_TRACING"))&&void 0!==c&&c;if(p||d){if(l||(l=new e),p&&!l.handlers.some((function(t){return t.name===g.prototype.name}))){var y=new g;l.addHandler(y,!0)}if(d&&!l.handlers.some((function(t){return"langchain_tracer"===t.name}))&&h){var v,m,b=new z;l.addHandler(b,!0),l._parentRunId=null!==(v=null===(m=z.getTraceableRunTree())||void 0===m?void 0:m.id)&&void 0!==v?v:l._parentRunId}}return(n||o)&&l&&(l.addTags(null!=n?n:[]),l.addTags(null!=o?o:[],!1)),(i||a)&&l&&(l.addMetadata(null!=i?i:{}),l.addMetadata(null!=a?a:{},!1)),l}}]);var r,i,u,s,c,l,f}(mt);function Ot(t){return"name"in t?t:o.N.fromMethods(t)}},888:(t,e,r)=>{"use strict";function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}r.d(e,{ZE:()=>At,j_:()=>Dt,VC:()=>St});var o="object"===("undefined"==typeof window?"undefined":n(window))?window:{},i="0123456789abcdef".split(""),a=[-2147483648,8388608,32768,128],u=[24,16,8,0],s=[];function c(t){t?(s[0]=s[16]=s[1]=s[2]=s[3]=s[4]=s[5]=s[6]=s[7]=s[8]=s[9]=s[10]=s[11]=s[12]=s[13]=s[14]=s[15]=0,this.blocks=s):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.h0=1732584193,this.h1=4023233417,this.h2=2562383102,this.h3=271733878,this.h4=3285377520,this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}c.prototype.update=function(t){if(!this.finalized){var e="string"!=typeof t;e&&t.constructor===o.ArrayBuffer&&(t=new Uint8Array(t));for(var r,n,i=0,a=t.length||0,s=this.blocks;i<a;){if(this.hashed&&(this.hashed=!1,s[0]=this.block,s[16]=s[1]=s[2]=s[3]=s[4]=s[5]=s[6]=s[7]=s[8]=s[9]=s[10]=s[11]=s[12]=s[13]=s[14]=s[15]=0),e)for(n=this.start;i<a&&n<64;++i)s[n>>2]|=t[i]<<u[3&n++];else for(n=this.start;i<a&&n<64;++i)(r=t.charCodeAt(i))<128?s[n>>2]|=r<<u[3&n++]:r<2048?(s[n>>2]|=(192|r>>6)<<u[3&n++],s[n>>2]|=(128|63&r)<<u[3&n++]):r<55296||r>=57344?(s[n>>2]|=(224|r>>12)<<u[3&n++],s[n>>2]|=(128|r>>6&63)<<u[3&n++],s[n>>2]|=(128|63&r)<<u[3&n++]):(r=65536+((1023&r)<<10|1023&t.charCodeAt(++i)),s[n>>2]|=(240|r>>18)<<u[3&n++],s[n>>2]|=(128|r>>12&63)<<u[3&n++],s[n>>2]|=(128|r>>6&63)<<u[3&n++],s[n>>2]|=(128|63&r)<<u[3&n++]);this.lastByteIndex=n,this.bytes+=n-this.start,n>=64?(this.block=s[16],this.start=n-64,this.hash(),this.hashed=!0):this.start=n}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296|0,this.bytes=this.bytes%4294967296),this}},c.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var t=this.blocks,e=this.lastByteIndex;t[16]=this.block,t[e>>2]|=a[3&e],this.block=t[16],e>=56&&(this.hashed||this.hash(),t[0]=this.block,t[16]=t[1]=t[2]=t[3]=t[4]=t[5]=t[6]=t[7]=t[8]=t[9]=t[10]=t[11]=t[12]=t[13]=t[14]=t[15]=0),t[14]=this.hBytes<<3|this.bytes>>>29,t[15]=this.bytes<<3,this.hash()}},c.prototype.hash=function(){var t,e,r=this.h0,n=this.h1,o=this.h2,i=this.h3,a=this.h4,u=this.blocks;for(t=16;t<80;++t)e=u[t-3]^u[t-8]^u[t-14]^u[t-16],u[t]=e<<1|e>>>31;for(t=0;t<20;t+=5)r=(e=(n=(e=(o=(e=(i=(e=(a=(e=r<<5|r>>>27)+(n&o|~n&i)+a+1518500249+u[t]|0)<<5|a>>>27)+(r&(n=n<<30|n>>>2)|~r&o)+i+1518500249+u[t+1]|0)<<5|i>>>27)+(a&(r=r<<30|r>>>2)|~a&n)+o+1518500249+u[t+2]|0)<<5|o>>>27)+(i&(a=a<<30|a>>>2)|~i&r)+n+1518500249+u[t+3]|0)<<5|n>>>27)+(o&(i=i<<30|i>>>2)|~o&a)+r+1518500249+u[t+4]|0,o=o<<30|o>>>2;for(;t<40;t+=5)r=(e=(n=(e=(o=(e=(i=(e=(a=(e=r<<5|r>>>27)+(n^o^i)+a+1859775393+u[t]|0)<<5|a>>>27)+(r^(n=n<<30|n>>>2)^o)+i+1859775393+u[t+1]|0)<<5|i>>>27)+(a^(r=r<<30|r>>>2)^n)+o+1859775393+u[t+2]|0)<<5|o>>>27)+(i^(a=a<<30|a>>>2)^r)+n+1859775393+u[t+3]|0)<<5|n>>>27)+(o^(i=i<<30|i>>>2)^a)+r+1859775393+u[t+4]|0,o=o<<30|o>>>2;for(;t<60;t+=5)r=(e=(n=(e=(o=(e=(i=(e=(a=(e=r<<5|r>>>27)+(n&o|n&i|o&i)+a-1894007588+u[t]|0)<<5|a>>>27)+(r&(n=n<<30|n>>>2)|r&o|n&o)+i-1894007588+u[t+1]|0)<<5|i>>>27)+(a&(r=r<<30|r>>>2)|a&n|r&n)+o-1894007588+u[t+2]|0)<<5|o>>>27)+(i&(a=a<<30|a>>>2)|i&r|a&r)+n-1894007588+u[t+3]|0)<<5|n>>>27)+(o&(i=i<<30|i>>>2)|o&a|i&a)+r-1894007588+u[t+4]|0,o=o<<30|o>>>2;for(;t<80;t+=5)r=(e=(n=(e=(o=(e=(i=(e=(a=(e=r<<5|r>>>27)+(n^o^i)+a-899497514+u[t]|0)<<5|a>>>27)+(r^(n=n<<30|n>>>2)^o)+i-899497514+u[t+1]|0)<<5|i>>>27)+(a^(r=r<<30|r>>>2)^n)+o-899497514+u[t+2]|0)<<5|o>>>27)+(i^(a=a<<30|a>>>2)^r)+n-899497514+u[t+3]|0)<<5|n>>>27)+(o^(i=i<<30|i>>>2)^a)+r-899497514+u[t+4]|0,o=o<<30|o>>>2;this.h0=this.h0+r|0,this.h1=this.h1+n|0,this.h2=this.h2+o|0,this.h3=this.h3+i|0,this.h4=this.h4+a|0},c.prototype.hex=function(){this.finalize();var t=this.h0,e=this.h1,r=this.h2,n=this.h3,o=this.h4;return i[t>>28&15]+i[t>>24&15]+i[t>>20&15]+i[t>>16&15]+i[t>>12&15]+i[t>>8&15]+i[t>>4&15]+i[15&t]+i[e>>28&15]+i[e>>24&15]+i[e>>20&15]+i[e>>16&15]+i[e>>12&15]+i[e>>8&15]+i[e>>4&15]+i[15&e]+i[r>>28&15]+i[r>>24&15]+i[r>>20&15]+i[r>>16&15]+i[r>>12&15]+i[r>>8&15]+i[r>>4&15]+i[15&r]+i[n>>28&15]+i[n>>24&15]+i[n>>20&15]+i[n>>16&15]+i[n>>12&15]+i[n>>8&15]+i[n>>4&15]+i[15&n]+i[o>>28&15]+i[o>>24&15]+i[o>>20&15]+i[o>>16&15]+i[o>>12&15]+i[o>>8&15]+i[o>>4&15]+i[15&o]},c.prototype.toString=c.prototype.hex,c.prototype.digest=function(){this.finalize();var t=this.h0,e=this.h1,r=this.h2,n=this.h3,o=this.h4;return[t>>24&255,t>>16&255,t>>8&255,255&t,e>>24&255,e>>16&255,e>>8&255,255&e,r>>24&255,r>>16&255,r>>8&255,255&r,n>>24&255,n>>16&255,n>>8&255,255&n,o>>24&255,o>>16&255,o>>8&255,255&o]},c.prototype.array=c.prototype.digest,c.prototype.arrayBuffer=function(){this.finalize();var t=new ArrayBuffer(20),e=new DataView(t);return e.setUint32(0,this.h0),e.setUint32(4,this.h1),e.setUint32(8,this.h2),e.setUint32(12,this.h3),e.setUint32(16,this.h4),t};var l=r(9721);function f(t){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f(t)}function p(){p=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof g?e:g,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:A(t,r,u)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var d="suspendedStart",y="suspendedYield",v="executing",m="completed",b={};function g(){}function w(){}function x(){}var _={};c(_,a,(function(){return this}));var E=Object.getPrototypeOf,O=E&&E(E(T([])));O&&O!==r&&n.call(O,a)&&(_=O);var k=x.prototype=g.prototype=Object.create(_);function j(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,u){var s=h(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==f(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function A(e,r,n){var o=d;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=D(u,n);if(s){if(s===b)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var c=h(e,r,n);if("normal"===c.type){if(o=n.done?m:y,c.arg===b)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=m,n.method="throw",n.arg=c.arg)}}}function D(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,D(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,b;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,b):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,b)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(f(e)+" is not iterable")}return w.prototype=x,o(k,"constructor",{value:x,configurable:!0}),o(x,"constructor",{value:w,configurable:!0}),w.displayName=c(x,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,c(t,s,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},j(S.prototype),c(S.prototype,u,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},j(k),c(k,s,"Generator"),c(k,a,(function(){return this})),c(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,b):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),C(r),b}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;C(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),b}},e}function h(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function d(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(d=function(){return!!t})()}function y(t){return y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},y(t)}function v(t,e){return v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},v(t,e)}function m(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,g(n.key),n)}}function b(t,e,r){return e&&m(t.prototype,e),r&&m(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function g(t){var e=function(t){if("object"!=f(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=f(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==f(e)?e:e+""}function w(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var x=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return n=e.join("_"),new c(!0).update(n).hex();var n},_=b((function t(){w(this,t)})),E=new Map,O=function(t){function e(t){var r,n,o,i;return w(this,e),n=this,o=y(o=e),r=function(t,e){if(e&&("object"==f(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(n,d()?Reflect.construct(o,i||[],y(n).constructor):o.apply(n,i)),Object.defineProperty(r,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),r.cache=null!=t?t:new Map,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&v(t,e)}(e,t),b(e,[{key:"lookup",value:function(t,e){var r;return Promise.resolve(null!==(r=this.cache.get(x(t,e)))&&void 0!==r?r:null)}},{key:"update",value:(r=p().mark((function t(e,r,n){return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.cache.set(x(e,r),n);case 1:case"end":return t.stop()}}),t,this)})),n=function(){var t=this,e=arguments;return new Promise((function(n,o){var i=r.apply(t,e);function a(t){h(i,n,o,a,u,"next",t)}function u(t){h(i,n,o,a,u,"throw",t)}a(void 0)}))},function(t,e,r){return n.apply(this,arguments)})}],[{key:"global",value:function(){return new e(E)}}]);var r,n}(_),k=r(4238),j=r(6463),S=r(5883);function A(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=F(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}function D(t){return function(t){if(Array.isArray(t))return I(t)}(t)||N(t)||F(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function P(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function C(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?P(Object(r),!0).forEach((function(e){B(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):P(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function L(t,e){return R(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],s=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);s=!0);}catch(t){c=!0,o=t}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(t,e)||F(t,e)||T()}function T(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function F(t,e){if(t){if("string"==typeof t)return I(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?I(t,e):void 0}}function I(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function N(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function R(t){if(Array.isArray(t))return t}function M(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,G(n.key),n)}}function B(t,e,r){return(e=G(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function G(t){var e=function(t){if("object"!=U(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=U(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==U(e)?e:e+""}function U(t){return U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},U(t)}var z=Object.defineProperty;function $(t,e){return 1===t.length?[e.get(t.join(","))]:function(t,e){for(var r=Array.from({length:t.length},(function(t,e){return{start:e,end:e+1}}));r.length>1;){for(var n=null,o=0;o<r.length-1;o++){var i=t.slice(r[o].start,r[o+1].end),a=e.get(i.join(","));null!=a&&(null==n||a<n[0])&&(n=[a,o])}if(null==n)break;var u=n[1];r[u]={start:r[u].start,end:r[u+1].end},r.splice(u+1,1)}return r}(t,e).map((function(r){return e.get(t.slice(r.start,r.end).join(","))})).filter((function(t){return null!=t}))}var q,K,H=function(){return t=function t(e,r){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),B(this,"specialTokens",void 0),B(this,"inverseSpecialTokens",void 0),B(this,"patStr",void 0),B(this,"textEncoder",new TextEncoder),B(this,"textDecoder",new TextDecoder("utf-8")),B(this,"rankMap",new Map),B(this,"textMap",new Map),this.patStr=e.pat_str;for(var o=e.bpe_ranks.split("\n").filter(Boolean).reduce((function(t,e){var r,n=R(r=e.split(" "))||N(r)||F(r)||T(),o=(n[0],n[1]),i=n.slice(2),a=Number.parseInt(o,10);return i.forEach((function(e,r){return t[e]=a+r})),t}),{}),i=0,a=Object.entries(o);i<a.length;i++){var u=L(a[i],2),s=u[0],c=u[1],l=S.toByteArray(s);this.rankMap.set(l.join(","),c),this.textMap.set(c,l)}this.specialTokens=C(C({},e.special_tokens),r),this.inverseSpecialTokens=Object.entries(this.specialTokens).reduce((function(t,e){var r=L(e,2),o=r[0];return t[r[1]]=n.textEncoder.encode(o),t}),{})},e=[{key:"encode",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"all",n=new RegExp(this.patStr,"ug"),o=H.specialTokenRegex(Object.keys(this.specialTokens)),i=[],a=new Set("all"===e?Object.keys(this.specialTokens):e),u=new Set("all"===r?Object.keys(this.specialTokens).filter((function(t){return!a.has(t)})):r);if(u.size>0){var s=H.specialTokenRegex(D(u)),c=t.match(s);if(null!=c)throw new Error("The text contains a special token that is not allowed: ".concat(c[0]))}for(var l=0;;){for(var f,p,h=null,d=l;o.lastIndex=d,null!=(h=o.exec(t))&&!a.has(h[0]);)d=h.index+1;var y,v=null!==(f=null===(p=h)||void 0===p?void 0:p.index)&&void 0!==f?f:t.length,m=A(t.substring(l,v).matchAll(n));try{for(m.s();!(y=m.n()).done;){var b=y.value,g=this.textEncoder.encode(b[0]),w=this.rankMap.get(g.join(","));null==w?i.push.apply(i,D($(g,this.rankMap))):i.push(w)}}catch(t){m.e(t)}finally{m.f()}if(null==h)break;var x=this.specialTokens[h[0]];i.push(x),l=h.index+h[0].length}return i}},{key:"decode",value:function(t){for(var e=[],r=0,n=0;n<t.length;++n){var o,i=t[n],a=null!==(o=this.textMap.get(i))&&void 0!==o?o:this.inverseSpecialTokens[i];null!=a&&(e.push(a),r+=a.length)}for(var u=new Uint8Array(r),s=0,c=0,l=e;c<l.length;c++){var f=l[c];u.set(f,s),s+=f.length}return this.textDecoder.decode(u)}}],e&&M(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}(),Z=H;function Y(t){switch(t){case"gpt2":return"gpt2";case"code-cushman-001":case"code-cushman-002":case"code-davinci-001":case"code-davinci-002":case"cushman-codex":case"davinci-codex":case"davinci-002":case"text-davinci-002":case"text-davinci-003":return"p50k_base";case"code-davinci-edit-001":case"text-davinci-edit-001":return"p50k_edit";case"ada":case"babbage":case"babbage-002":case"code-search-ada-code-001":case"code-search-babbage-code-001":case"curie":case"davinci":case"text-ada-001":case"text-babbage-001":case"text-curie-001":case"text-davinci-001":case"text-search-ada-doc-001":case"text-search-babbage-doc-001":case"text-search-curie-doc-001":case"text-search-davinci-doc-001":case"text-similarity-ada-001":case"text-similarity-babbage-001":case"text-similarity-curie-001":case"text-similarity-davinci-001":return"r50k_base";case"gpt-3.5-turbo-instruct-0914":case"gpt-3.5-turbo-instruct":case"gpt-3.5-turbo-16k-0613":case"gpt-3.5-turbo-16k":case"gpt-3.5-turbo-0613":case"gpt-3.5-turbo-0301":case"gpt-3.5-turbo":case"gpt-4-32k-0613":case"gpt-4-32k-0314":case"gpt-4-32k":case"gpt-4-0613":case"gpt-4-0314":case"gpt-4":case"gpt-3.5-turbo-1106":case"gpt-35-turbo":case"gpt-4-1106-preview":case"gpt-4-vision-preview":case"gpt-3.5-turbo-0125":case"gpt-4-turbo":case"gpt-4-turbo-2024-04-09":case"gpt-4-turbo-preview":case"gpt-4-0125-preview":case"text-embedding-ada-002":case"text-embedding-3-small":case"text-embedding-3-large":return"cl100k_base";case"gpt-4o":case"gpt-4o-2024-05-13":case"gpt-4o-2024-08-06":case"gpt-4o-mini-2024-07-18":case"gpt-4o-mini":case"o1-mini":case"o1-preview":case"o1-preview-2024-09-12":case"o1-mini-2024-09-12":case"chatgpt-4o-latest":case"gpt-4o-realtime":case"gpt-4o-realtime-preview-2024-10-01":return"o200k_base";default:throw new Error("Unknown model")}}function V(t){return V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},V(t)}function W(){W=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new P(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function b(){}function g(){}var w={};c(w,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(w=_);var E=g.prototype=m.prototype=Object.create(w);function O(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,i,a,u){var s=f(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==V(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=S(u,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?y:h,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=y,n.method="throw",n.arg=c.arg)}}}function S(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,S(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function C(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(V(e)+" is not iterable")}return b.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=c(g,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,c(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},O(k.prototype),c(k.prototype,u,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(E),c(E,s,"Generator"),c(E,a,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=C,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),D(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;D(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:C(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function J(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function X(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){J(i,n,o,a,u,"next",t)}function u(t){J(i,n,o,a,u,"throw",t)}a(void 0)}))}}K=function(t){return new RegExp(t.map((function(t){return t.replace(/[\\^$*+?.()|[\]{}]/g,"\\$&")})).join("|"),"g")},function(t,e,r){e in t?z(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r}(Z,"symbol"!==U(q="specialTokenRegex")?q+"":q,K);var Q={},tt=new j.g({});function et(t){return rt.apply(this,arguments)}function rt(){return(rt=X(W().mark((function t(e){return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e in Q||(Q[e]=tt.fetch("https://tiktoken.pages.dev/js/".concat(e,".json")).then((function(t){return t.json()})).then((function(t){return new Z(t)})).catch((function(t){throw delete Q[e],t}))),t.next=3,Q[e];case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function nt(t){return ot.apply(this,arguments)}function ot(){return(ot=X(W().mark((function t(e){return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",et(Y(e)));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var it=r(7889),at=["callbacks","callbackManager"],ut=["config"];function st(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],s=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);s=!0);}catch(t){c=!0,o=t}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(t,e)||function(t,e){if(t){if("string"==typeof t)return ct(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ct(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ct(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function lt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function ft(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?lt(Object(r),!0).forEach((function(e){pt(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):lt(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function pt(t,e,r){return(e=mt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ht(t,e){if(null==t)return{};var r,n,o=function(t,e){if(null==t)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.includes(n))continue;r[n]=t[n]}return r}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.includes(r)||{}.propertyIsEnumerable.call(t,r)&&(o[r]=t[r])}return o}function dt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function yt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,mt(n.key),n)}}function vt(t,e,r){return e&&yt(t.prototype,e),r&&yt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function mt(t){var e=function(t){if("object"!=jt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=jt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==jt(e)?e:e+""}function bt(t,e,r){return e=wt(e),function(t,e){if(e&&("object"==jt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,gt()?Reflect.construct(e,r||[],wt(t).constructor):e.apply(t,r))}function gt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(gt=function(){return!!t})()}function wt(t){return wt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},wt(t)}function xt(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_t(t,e)}function _t(t,e){return _t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_t(t,e)}function Et(){Et=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new P(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function b(){}function g(){}var w={};c(w,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(w=_);var E=g.prototype=m.prototype=Object.create(w);function O(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,i,a,u){var s=f(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==jt(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=S(u,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?y:h,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=y,n.method="throw",n.arg=c.arg)}}}function S(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,S(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function C(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(jt(e)+" is not iterable")}return b.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=c(g,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,c(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},O(k.prototype),c(k.prototype,u,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(E),c(E,s,"Generator"),c(E,a,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=C,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),D(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;D(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:C(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function Ot(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function kt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Ot(i,n,o,a,u,"next",t)}function u(t){Ot(i,n,o,a,u,"throw",t)}a(void 0)}))}}function jt(t){return jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jt(t)}function St(t){return!("object"!==jt(t)||!t||!("type"in t&&"function"===t.type&&"function"in t&&"object"===jt(t.function)&&t.function&&"name"in t.function&&"parameters"in t.function))}var At=function(t){function e(t){var r,n,o,i;return dt(this,e),i=bt(this,e,[t]),Object.defineProperty(i,"verbose",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(i,"callbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(i,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(i,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),i.verbose=null!==(r=t.verbose)&&void 0!==r&&r,i.callbacks=t.callbacks,i.tags=null!==(n=t.tags)&&void 0!==n?n:[],i.metadata=null!==(o=t.metadata)&&void 0!==o?o:{},i}return xt(e,t),vt(e,[{key:"lc_attributes",get:function(){return{callbacks:void 0,verbose:void 0}}}])}(it.YN),Dt=function(t){function e(t){var r,n=t.callbacks,o=t.callbackManager,i=ht(t,at);return dt(this,e),r=bt(this,e,[ft({callbacks:null!=n?n:o},i)]),Object.defineProperty(r,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(r,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(r,"_encoding",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),"object"===jt(i.cache)?r.cache=i.cache:i.cache?r.cache=O.global():r.cache=void 0,r.caller=new j.g(null!=i?i:{}),r}return xt(e,t),vt(e,[{key:"callKeys",get:function(){return["stop","timeout","signal","tags","metadata","callbacks"]}},{key:"getNumTokens",value:(n=kt(Et().mark((function t(e){var r;return Et().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("string"==typeof e){t.next=2;break}return t.abrupt("return",0);case 2:if(r=Math.ceil(e.length/4),this._encoding){t.next=13;break}return t.prev=4,t.next=7,nt("modelName"in this?(n=this.modelName).startsWith("gpt-3.5-turbo-16k")?"gpt-3.5-turbo-16k":n.startsWith("gpt-3.5-turbo-")?"gpt-3.5-turbo":n.startsWith("gpt-4-32k")?"gpt-4-32k":n.startsWith("gpt-4-")?"gpt-4":n.startsWith("gpt-4o")?"gpt-4o":n:"gpt2");case 7:this._encoding=t.sent,t.next=13;break;case 10:t.prev=10,t.t0=t.catch(4),console.warn("Failed to calculate number of tokens, falling back to approximate count",t.t0);case 13:if(this._encoding)try{r=this._encoding.encode(e).length}catch(t){console.warn("Failed to calculate number of tokens, falling back to approximate count",t)}return t.abrupt("return",r);case 15:case"end":return t.stop()}var n}),t,this,[[4,10]])}))),function(t){return n.apply(this,arguments)})},{key:"_identifyingParams",value:function(){return{}}},{key:"_getSerializedCacheKeyParametersForCall",value:function(t){t.config;var e=ht(t,ut),r=ft(ft(ft({},this._identifyingParams()),e),{},{_type:this._llmType(),_model:this._modelType()}),n=Object.entries(r).filter((function(t){var e=st(t,2);return e[0],void 0!==e[1]})).map((function(t){var e=st(t,2),r=e[0],n=e[1];return"".concat(r,":").concat(JSON.stringify(n))})).sort().join(",");return n}},{key:"serialize",value:function(){return ft(ft({},this._identifyingParams()),{},{_type:this._llmType(),_model:this._modelType()})}}],[{key:"_convertInputToPromptValue",value:function(t){return"string"==typeof t?new k.HY(t):Array.isArray(t)?new k.aB(t.map(l.K0)):t}},{key:"deserialize",value:(r=kt(Et().mark((function t(e){return Et().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:throw new Error("Use .toJSON() instead");case 1:case"end":return t.stop()}}),t)}))),function(t){return r.apply(this,arguments)})}]);var r,n}(At)},4865:(t,e,r)=>{"use strict";r.d(e,{y:()=>_,Z:()=>x});var n=r(1013);function o(t,e){return(null==e?void 0:e[t])||n(t)}function i(t,e,r){var n={};for(var o in t)Object.hasOwn(t,o)&&(n[e(o,r)]=t[o]);return n}function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function u(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,d(n.key),n)}}function s(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=v(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}function c(t){return f(t)||m(t)||v(t)||l()}function l(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function f(t){if(Array.isArray(t))return t}function p(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function h(t,e,r){return(e=d(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function d(t){var e=function(t){if("object"!=a(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==a(e)?e:e+""}function y(t){return function(t){if(Array.isArray(t))return b(t)}(t)||m(t)||v(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(t,e){if(t){if("string"==typeof t)return b(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?b(t,e):void 0}}function m(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function b(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function g(t){return Array.isArray(t)?y(t):function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?p(Object(r),!0).forEach((function(e){h(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},t)}function w(t,e){for(var r=g(t),n=0,o=Object.entries(e);n<o.length;n++){var i,a=(w=o[n],x=2,f(w)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],s=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);s=!0);}catch(t){c=!0,o=t}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(w,x)||v(w,x)||l()),u=a[0],p=a[1],h=c(u.split(".").reverse()),d=h[0],y=r,m=s(h.slice(1).reverse());try{for(m.s();!(i=m.n()).done;){var b=i.value;if(void 0===y[b])break;y[b]=g(y[b]),y=y[b]}}catch(t){m.e(t)}finally{m.f()}void 0!==y[d]&&(y[d]={lc:1,type:"secret",id:[p]})}var w,x;return r}function x(t){var e=Object.getPrototypeOf(t);return"function"!=typeof t.lc_name||"function"==typeof e.lc_name&&t.lc_name()===e.lc_name()?t.name:t.lc_name()}r(3372);var _=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.lc_kwargs=e||{}}return e=t,n=[{key:"lc_name",value:function(){return this.name}}],(r=[{key:"lc_id",get:function(){return[].concat(y(this.lc_namespace),[x(this.constructor)])}},{key:"lc_secrets",get:function(){}},{key:"lc_attributes",get:function(){}},{key:"lc_aliases",get:function(){}},{key:"toJSON",value:function(){var e=this;if(!this.lc_serializable)return this.toJSONNotImplemented();if(this.lc_kwargs instanceof t||"object"!==a(this.lc_kwargs)||Array.isArray(this.lc_kwargs))return this.toJSONNotImplemented();for(var r={},n={},u=Object.keys(this.lc_kwargs).reduce((function(t,r){return t[r]=r in e?e[r]:e.lc_kwargs[r],t}),{}),l=Object.getPrototypeOf(this);l;l=Object.getPrototypeOf(l))Object.assign(r,Reflect.get(l,"lc_aliases",this)),Object.assign(n,Reflect.get(l,"lc_secrets",this)),Object.assign(u,Reflect.get(l,"lc_attributes",this));return Object.keys(n).forEach((function(t){var r,n=e,o=u,i=c(t.split(".").reverse()),l=i[0],f=s(i.slice(1).reverse());try{for(f.s();!(r=f.n()).done;){var p=r.value;if(!(p in n)||void 0===n[p])return;p in o&&void 0!==o[p]||("object"===a(n[p])&&null!=n[p]?o[p]={}:Array.isArray(n[p])&&(o[p]=[])),n=n[p],o=o[p]}}catch(t){f.e(t)}finally{f.f()}l in n&&void 0!==n[l]&&(o[l]=o[l]||n[l])})),{lc:1,type:"constructor",id:this.lc_id,kwargs:i(Object.keys(n).length?w(u,n):u,o,r)}}},{key:"toJSONNotImplemented",value:function(){return{lc:1,type:"not_implemented",id:this.lc_id}}}])&&u(e.prototype,r),n&&u(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n}()},1260:(t,e,r)=>{"use strict";r.d(e,{H:()=>k,KX:()=>O,Od:()=>E});var n=r(6179),o=r(5743),i=r(2372);function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function u(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function s(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?u(Object(r),!0).forEach((function(e){c(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function c(t,e,r){return(e=y(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function l(t,e){if(t){if("string"==typeof t)return f(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?f(t,e):void 0}}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function p(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,y(n.key),n)}}function d(t,e,r){return e&&h(t.prototype,e),r&&h(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function y(t){var e=function(t){if("object"!=a(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==a(e)?e:e+""}function v(t,e,r){return e=_(e),function(t,e){if(e&&("object"==a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,m()?Reflect.construct(e,r||[],_(t).constructor):e.apply(t,r))}function m(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(m=function(){return!!t})()}function b(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&g(t,e)}function g(t,e){return g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},g(t,e)}function w(t,e,r,n){var o=x(_(1&n?t.prototype:t),e,r);return 2&n&&"function"==typeof o?function(t){return o.apply(r,t)}:o}function x(){return x="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=_(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},x.apply(null,arguments)}function _(t){return _=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_(t)}var E=function(t){function e(t,r){var n,o,a,u,s,c;if(p(this,e),"string"==typeof t)o={content:t,tool_calls:[],invalid_tool_calls:[],additional_kwargs:null!=r?r:{}};else{var f,h=null===(f=(o=t).additional_kwargs)||void 0===f?void 0:f.tool_calls,d=o.tool_calls;null!=h&&h.length>0&&(void 0===d||0===d.length)&&console.warn(["New LangChain packages are available that more efficiently handle","tool calling.\n\nPlease upgrade your packages to versions that set","message tool calls. e.g., `yarn add @langchain/anthropic`,","yarn add @langchain/openai`, etc."].join(" "));try{if(null!=h&&void 0===d){var y=(s=(0,i.p1)(h),c=2,function(t){if(Array.isArray(t))return t}(s)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],s=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);s=!0);}catch(t){c=!0,o=t}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(s,c)||l(s,c)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),m=y[0],b=y[1];o.tool_calls=null!=m?m:[],o.invalid_tool_calls=null!=b?b:[]}else{var g,w;o.tool_calls=null!==(g=o.tool_calls)&&void 0!==g?g:[],o.invalid_tool_calls=null!==(w=o.invalid_tool_calls)&&void 0!==w?w:[]}}catch(c){o.tool_calls=[],o.invalid_tool_calls=[]}}return n=v(this,e,[o]),Object.defineProperty(n,"tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(n,"invalid_tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(n,"usage_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),"string"!=typeof o&&(n.tool_calls=null!==(a=o.tool_calls)&&void 0!==a?a:n.tool_calls,n.invalid_tool_calls=null!==(u=o.invalid_tool_calls)&&void 0!==u?u:n.invalid_tool_calls),n.usage_metadata=o.usage_metadata,n}return b(e,t),d(e,[{key:"lc_aliases",get:function(){return s(s({},w(e,"lc_aliases",this,1)),{},{tool_calls:"tool_calls",invalid_tool_calls:"invalid_tool_calls"})}},{key:"_getType",value:function(){return"ai"}},{key:"_printableFields",get:function(){return s(s({},w(e,"_printableFields",this,1)),{},{tool_calls:this.tool_calls,invalid_tool_calls:this.invalid_tool_calls,usage_metadata:this.usage_metadata})}}],[{key:"lc_name",value:function(){return"AIMessage"}}])}(o.XQ);function O(t){return"ai"===t._getType()}var k=function(t){function e(t){var r,o,i,u,c;if(p(this,e),"string"==typeof t)c={content:t,tool_calls:[],invalid_tool_calls:[],tool_call_chunks:[]};else if(void 0===t.tool_call_chunks){var f;c=s(s({},t),{},{tool_calls:null!==(f=t.tool_calls)&&void 0!==f?f:[],invalid_tool_calls:[],tool_call_chunks:[]})}else{var h,d=[],y=[],m=function(t){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=l(t))){e&&(t=e);var r=0,n=function(){};return{s:n,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,a=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return i=t.done,t},e:function(t){a=!0,o=t},f:function(){try{i||null==e.return||e.return()}finally{if(a)throw o}}}}(t.tool_call_chunks);try{for(m.s();!(h=m.n()).done;){var b=h.value,g={};try{var w;if(null===(g=(0,n.d)(b.args||"{}"))||"object"!==a(g)||Array.isArray(g))throw new Error("Malformed tool call chunk args.");d.push({name:null!==(w=b.name)&&void 0!==w?w:"",args:g,id:b.id,type:"tool_call"})}catch(t){y.push({name:b.name,args:b.args,id:b.id,error:"Malformed args.",type:"invalid_tool_call"})}}}catch(t){m.e(t)}finally{m.f()}c=s(s({},t),{},{tool_calls:d,invalid_tool_calls:y})}return u=v(this,e,[c]),Object.defineProperty(u,"tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(u,"invalid_tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(u,"tool_call_chunks",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(u,"usage_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),u.tool_call_chunks=null!==(r=c.tool_call_chunks)&&void 0!==r?r:u.tool_call_chunks,u.tool_calls=null!==(o=c.tool_calls)&&void 0!==o?o:u.tool_calls,u.invalid_tool_calls=null!==(i=c.invalid_tool_calls)&&void 0!==i?i:u.invalid_tool_calls,u.usage_metadata=c.usage_metadata,u}return b(e,t),d(e,[{key:"lc_aliases",get:function(){return s(s({},w(e,"lc_aliases",this,1)),{},{tool_calls:"tool_calls",invalid_tool_calls:"invalid_tool_calls",tool_call_chunks:"tool_call_chunks"})}},{key:"_getType",value:function(){return"ai"}},{key:"_printableFields",get:function(){return s(s({},w(e,"_printableFields",this,1)),{},{tool_calls:this.tool_calls,tool_call_chunks:this.tool_call_chunks,invalid_tool_calls:this.invalid_tool_calls,usage_metadata:this.usage_metadata})}},{key:"concat",value:function(t){var r,n={content:(0,o._I)(this.content,t.content),additional_kwargs:(0,o.ns)(this.additional_kwargs,t.additional_kwargs),response_metadata:(0,o.ns)(this.response_metadata,t.response_metadata),tool_call_chunks:[],id:null!==(r=this.id)&&void 0!==r?r:t.id};if(void 0!==this.tool_call_chunks||void 0!==t.tool_call_chunks){var i=(0,o.Vt)(this.tool_call_chunks,t.tool_call_chunks);void 0!==i&&i.length>0&&(n.tool_call_chunks=i)}if(void 0!==this.usage_metadata||void 0!==t.usage_metadata){var a,u,s=null!==(a=this.usage_metadata)&&void 0!==a?a:{input_tokens:0,output_tokens:0,total_tokens:0},c=null!==(u=t.usage_metadata)&&void 0!==u?u:{input_tokens:0,output_tokens:0,total_tokens:0},l={input_tokens:s.input_tokens+c.input_tokens,output_tokens:s.output_tokens+c.output_tokens,total_tokens:s.total_tokens+c.total_tokens};n.usage_metadata=l}return new e(n)}}],[{key:"lc_name",value:function(){return"AIMessageChunk"}}])}(o.gj)},5743:(t,e,r)=>{"use strict";function n(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function o(t,e,r){return(e=s(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,s(n.key),n)}}function u(t,e,r){return e&&a(t.prototype,e),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function s(t){var e=function(t){if("object"!=d(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=d(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==d(e)?e:e+""}function c(t,e,r){return e=f(e),function(t,e){if(e&&("object"==d(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,l()?Reflect.construct(e,r||[],f(t).constructor):e.apply(t,r))}function l(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(l=function(){return!!t})()}function f(t){return f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},f(t)}function p(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&h(t,e)}function h(t,e){return h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},h(t,e)}function d(t){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d(t)}function y(t){return function(t){if(Array.isArray(t))return m(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||v(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(t,e){if(t){if("string"==typeof t)return m(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?m(t,e):void 0}}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function b(t,e){return"string"==typeof t?"string"==typeof e?t+e:[{type:"text",text:t}].concat(y(e)):Array.isArray(e)?null!==(r=_(t,e))&&void 0!==r?r:[].concat(y(t),y(e)):[].concat(y(t),[{type:"text",text:e}]);var r}function g(t,e){return"error"===t||"error"===e?"error":"success"}r.d(e,{AJ:()=>S,F7:()=>E,Iv:()=>g,Vt:()=>_,XQ:()=>w,_I:()=>b,dp:()=>k,gj:()=>O,ns:()=>x,ny:()=>j});var w=function(t){function e(t,r){var n;return i(this,e),"string"==typeof t&&(t={content:t,additional_kwargs:r,response_metadata:{}}),t.additional_kwargs||(t.additional_kwargs={}),t.response_metadata||(t.response_metadata={}),n=c(this,e,[t]),Object.defineProperty(n,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","messages"]}),Object.defineProperty(n,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(n,"content",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(n,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(n,"additional_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(n,"response_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(n,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),n.name=t.name,n.content=t.content,n.additional_kwargs=t.additional_kwargs,n.response_metadata=t.response_metadata,n.id=t.id,n}return p(e,t),u(e,[{key:"lc_aliases",get:function(){return{additional_kwargs:"additional_kwargs",response_metadata:"response_metadata"}}},{key:"text",get:function(){return"string"==typeof this.content?this.content:""}},{key:"toDict",value:function(){return{type:this._getType(),data:this.toJSON().kwargs}}},{key:"_printableFields",get:function(){return{id:this.id,content:this.content,name:this.name,additional_kwargs:this.additional_kwargs,response_metadata:this.response_metadata}}},{key:"_updateId",value:function(t){this.id=t,this.lc_kwargs.id=t}},{key:Symbol.toStringTag,get:function(){return this.constructor.lc_name()}},{key:Symbol.for("nodejs.util.inspect.custom"),value:function(t){if(null===t)return this;var e,r,n=(e=this._printableFields,r=Math.max(4,t),JSON.stringify(function t(e,n){if("object"!==d(e)||null==e)return e;if(n>=r)return Array.isArray(e)?"[Array]":"[Object]";if(Array.isArray(e))return e.map((function(e){return t(e,n+1)}));for(var o={},i=0,a=Object.keys(e);i<a.length;i++){var u=a[i];o[u]=t(e[u],n+1)}return o}(e,0),null,2));return"".concat(this.constructor.lc_name()," ").concat(n)}}],[{key:"lc_name",value:function(){return"BaseMessage"}}])}(r(4865).y);function x(t,e){for(var r=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?n(Object(r),!0).forEach((function(e){o(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},t),i=0,a=Object.entries(e);i<a.length;i++){var u=(l=a[i],f=2,function(t){if(Array.isArray(t))return t}(l)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],s=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);s=!0);}catch(t){c=!0,o=t}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(l,f)||v(l,f)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),s=u[0],c=u[1];if(null==r[s])r[s]=c;else{if(null==c)continue;if(d(r[s])!==d(c)||Array.isArray(r[s])!==Array.isArray(c))throw new Error("field[".concat(s,"] already exists in the message chunk, but with a different type."));if("string"==typeof r[s]){if("type"===s)continue;r[s]+=c}else if("object"!==d(r[s])||Array.isArray(r[s]))if(Array.isArray(r[s]))r[s]=_(r[s],c);else{if(r[s]===c)continue;console.warn("field[".concat(s,"] already exists in this message chunk and value has unsupported type."))}else r[s]=x(r[s],c)}}var l,f;return r}function _(t,e){if(void 0!==t||void 0!==e){if(void 0===t||void 0===e)return t||e;var r,n=y(t),o=function(t){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=v(t))){e&&(t=e);var r=0,n=function(){};return{s:n,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,a=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return i=t.done,t},e:function(t){a=!0,o=t},f:function(){try{i||null==e.return||e.return()}finally{if(a)throw o}}}}(e);try{var i=function(){var t=r.value;if("object"===d(t)&&"index"in t&&"number"==typeof t.index){var e=n.findIndex((function(e){return e.index===t.index}));-1!==e?n[e]=x(n[e],t):n.push(t)}else{if("object"===d(t)&&"text"in t&&""===t.text)return 1;n.push(t)}};for(o.s();!(r=o.n()).done;)i()}catch(t){o.e(t)}finally{o.f()}return n}}function E(t,e){if(!t&&!e)throw new Error("Cannot merge two undefined objects.");if(t&&e){if(d(t)!==d(e))throw new Error("Cannot merge objects of different types.\nLeft ".concat(d(t),"\nRight ").concat(d(e)));if("string"==typeof t&&"string"==typeof e)return t+e;if(Array.isArray(t)&&Array.isArray(e))return _(t,e);if("object"===d(t)&&"object"===d(e))return x(t,e);if(t===e)return t;throw new Error("Can not merge objects of different types.\nLeft ".concat(t,"\nRight ").concat(e))}return t||e}var O=function(t){function e(){return i(this,e),c(this,e,arguments)}return p(e,t),u(e)}(w);function k(t){return"string"==typeof t.role}function j(t){return"function"==typeof(null==t?void 0:t._getType)}function S(t){return j(t)&&"function"==typeof t.concat}},5480:(t,e,r)=>{"use strict";r.d(e,{X:()=>w,c:()=>g});var n=r(5743);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function i(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function a(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?i(Object(r),!0).forEach((function(e){u(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function u(t,e,r){return(e=f(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,f(n.key),n)}}function l(t,e,r){return e&&c(t.prototype,e),r&&c(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function f(t){var e=function(t){if("object"!=o(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==o(e)?e:e+""}function p(t,e,r){return e=v(e),function(t,e){if(e&&("object"==o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,h()?Reflect.construct(e,r||[],v(t).constructor):e.apply(t,r))}function h(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(h=function(){return!!t})()}function d(t,e,r,n){var o=y(v(1&n?t.prototype:t),e,r);return 2&n&&"function"==typeof o?function(t){return o.apply(r,t)}:o}function y(){return y="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=v(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},y.apply(null,arguments)}function v(t){return v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},v(t)}function m(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&b(t,e)}function b(t,e){return b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},b(t,e)}var g=function(t){function e(t,r){var n;return s(this,e),"string"==typeof t&&(t={content:t,role:r}),n=p(this,e,[t]),Object.defineProperty(n,"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),n.role=t.role,n}return m(e,t),l(e,[{key:"_getType",value:function(){return"generic"}},{key:"_printableFields",get:function(){return a(a({},d(e,"_printableFields",this,1)),{},{role:this.role})}}],[{key:"lc_name",value:function(){return"ChatMessage"}},{key:"_chatMessageClass",value:function(){return e}},{key:"isInstance",value:function(t){return"generic"===t._getType()}}])}(n.XQ),w=function(t){function e(t,r){var n;return s(this,e),"string"==typeof t&&(t={content:t,role:r}),n=p(this,e,[t]),Object.defineProperty(n,"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),n.role=t.role,n}return m(e,t),l(e,[{key:"_getType",value:function(){return"generic"}},{key:"concat",value:function(t){var r;return new e({content:(0,n._I)(this.content,t.content),additional_kwargs:(0,n.ns)(this.additional_kwargs,t.additional_kwargs),response_metadata:(0,n.ns)(this.response_metadata,t.response_metadata),role:this.role,id:null!==(r=this.id)&&void 0!==r?r:t.id})}},{key:"_printableFields",get:function(){return a(a({},d(e,"_printableFields",this,1)),{},{role:this.role})}}],[{key:"lc_name",value:function(){return"ChatMessageChunk"}}])}(n.gj)},4770:(t,e,r)=>{"use strict";r.d(e,{F:()=>y,m:()=>d});var n=r(5743);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,s(n.key),n)}}function u(t,e,r){return e&&a(t.prototype,e),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function s(t){var e=function(t){if("object"!=o(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==o(e)?e:e+""}function c(t,e,r){return e=f(e),function(t,e){if(e&&("object"==o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,l()?Reflect.construct(e,r||[],f(t).constructor):e.apply(t,r))}function l(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(l=function(){return!!t})()}function f(t){return f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},f(t)}function p(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&h(t,e)}function h(t,e){return h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},h(t,e)}var d=function(t){function e(t,r){return i(this,e),"string"==typeof t&&(t={content:t,name:r}),c(this,e,[t])}return p(e,t),u(e,[{key:"_getType",value:function(){return"function"}}],[{key:"lc_name",value:function(){return"FunctionMessage"}}])}(n.XQ),y=function(t){function e(){return i(this,e),c(this,e,arguments)}return p(e,t),u(e,[{key:"_getType",value:function(){return"function"}},{key:"concat",value:function(t){var r,o;return new e({content:(0,n._I)(this.content,t.content),additional_kwargs:(0,n.ns)(this.additional_kwargs,t.additional_kwargs),response_metadata:(0,n.ns)(this.response_metadata,t.response_metadata),name:null!==(r=this.name)&&void 0!==r?r:"",id:null!==(o=this.id)&&void 0!==o?o:t.id})}}],[{key:"lc_name",value:function(){return"FunctionMessageChunk"}}])}(n.gj)},3789:(t,e,r)=>{"use strict";r.d(e,{a:()=>y,x:()=>d});var n=r(5743);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,s(n.key),n)}}function u(t,e,r){return e&&a(t.prototype,e),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function s(t){var e=function(t){if("object"!=o(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==o(e)?e:e+""}function c(t,e,r){return e=f(e),function(t,e){if(e&&("object"==o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,l()?Reflect.construct(e,r||[],f(t).constructor):e.apply(t,r))}function l(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(l=function(){return!!t})()}function f(t){return f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},f(t)}function p(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&h(t,e)}function h(t,e){return h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},h(t,e)}var d=function(t){function e(){return i(this,e),c(this,e,arguments)}return p(e,t),u(e,[{key:"_getType",value:function(){return"human"}}],[{key:"lc_name",value:function(){return"HumanMessage"}}])}(n.XQ),y=function(t){function e(){return i(this,e),c(this,e,arguments)}return p(e,t),u(e,[{key:"_getType",value:function(){return"human"}},{key:"concat",value:function(t){var r;return new e({content:(0,n._I)(this.content,t.content),additional_kwargs:(0,n.ns)(this.additional_kwargs,t.additional_kwargs),response_metadata:(0,n.ns)(this.response_metadata,t.response_metadata),id:null!==(r=this.id)&&void 0!==r?r:t.id})}}],[{key:"lc_name",value:function(){return"HumanMessageChunk"}}])}(n.gj)},6641:(t,e,r)=>{"use strict";r.d(e,{Od:()=>n.Od,H:()=>n.H,XQ:()=>o.XQ,cM:()=>i.c,XU:()=>i.X,FK:()=>a.F,xc:()=>u.x,a7:()=>u.a,tn:()=>s.t,uU:()=>s.u,uf:()=>w.uf,dr:()=>w.dr,K0:()=>c.K0,ih:()=>c.ih,Sw:()=>c.Sw,KX:()=>n.KX,ny:()=>o.ny});var n=r(1260),o=r(5743),i=r(5480),a=r(4770),u=r(3789),s=r(5451),c=r(9721);function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function f(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function p(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?f(Object(r),!0).forEach((function(e){h(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function h(t,e,r){return(e=y(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function d(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,y(n.key),n)}}function y(t){var e=function(t){if("object"!=l(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=l(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==l(e)?e:e+""}function v(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(v=function(){return!!t})()}function m(){return m="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=b(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},m.apply(null,arguments)}function b(t){return b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},b(t)}function g(t,e){return g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},g(t,e)}r(7889);o.XQ;var w=r(2372);u.x,u.a,n.Od,n.H,s.t,s.u,w.uf,w.dr,a.m,a.F,i.c,i.X},5451:(t,e,r)=>{"use strict";r.d(e,{t:()=>d,u:()=>y});var n=r(5743);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,s(n.key),n)}}function u(t,e,r){return e&&a(t.prototype,e),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function s(t){var e=function(t){if("object"!=o(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==o(e)?e:e+""}function c(t,e,r){return e=f(e),function(t,e){if(e&&("object"==o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,l()?Reflect.construct(e,r||[],f(t).constructor):e.apply(t,r))}function l(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(l=function(){return!!t})()}function f(t){return f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},f(t)}function p(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&h(t,e)}function h(t,e){return h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},h(t,e)}var d=function(t){function e(){return i(this,e),c(this,e,arguments)}return p(e,t),u(e,[{key:"_getType",value:function(){return"system"}}],[{key:"lc_name",value:function(){return"SystemMessage"}}])}(n.XQ),y=function(t){function e(){return i(this,e),c(this,e,arguments)}return p(e,t),u(e,[{key:"_getType",value:function(){return"system"}},{key:"concat",value:function(t){var r;return new e({content:(0,n._I)(this.content,t.content),additional_kwargs:(0,n.ns)(this.additional_kwargs,t.additional_kwargs),response_metadata:(0,n.ns)(this.response_metadata,t.response_metadata),id:null!==(r=this.id)&&void 0!==r?r:t.id})}}],[{key:"lc_name",value:function(){return"SystemMessageChunk"}}])}(n.gj)},2372:(t,e,r)=>{"use strict";r.d(e,{dr:()=>x,p1:()=>_,uf:()=>w});var n=r(5743);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function a(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function u(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?a(Object(r),!0).forEach((function(e){s(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function s(t,e,r){return(e=p(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,p(n.key),n)}}function f(t,e,r){return e&&l(t.prototype,e),r&&l(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function p(t){var e=function(t){if("object"!=o(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==o(e)?e:e+""}function h(t,e,r){return e=m(e),function(t,e){if(e&&("object"==o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,d()?Reflect.construct(e,r||[],m(t).constructor):e.apply(t,r))}function d(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(d=function(){return!!t})()}function y(t,e,r,n){var o=v(m(1&n?t.prototype:t),e,r);return 2&n&&"function"==typeof o?function(t){return o.apply(r,t)}:o}function v(){return v="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=m(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},v.apply(null,arguments)}function m(t){return m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},m(t)}function b(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&g(t,e)}function g(t,e){return g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},g(t,e)}var w=function(t){function e(t,r,n){var o;return c(this,e),"string"==typeof t&&(t={content:t,name:n,tool_call_id:r}),o=h(this,e,[t]),Object.defineProperty(o,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(o,"tool_call_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(o,"artifact",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),o.tool_call_id=t.tool_call_id,o.artifact=t.artifact,o.status=t.status,o}return b(e,t),f(e,[{key:"lc_aliases",get:function(){return{tool_call_id:"tool_call_id"}}},{key:"_getType",value:function(){return"tool"}},{key:"_printableFields",get:function(){return u(u({},y(e,"_printableFields",this,1)),{},{tool_call_id:this.tool_call_id,artifact:this.artifact})}}],[{key:"lc_name",value:function(){return"ToolMessage"}},{key:"isInstance",value:function(t){return"tool"===t._getType()}}])}(n.XQ),x=function(t){function e(t){var r;return c(this,e),r=h(this,e,[t]),Object.defineProperty(r,"tool_call_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(r,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(r,"artifact",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),r.tool_call_id=t.tool_call_id,r.artifact=t.artifact,r.status=t.status,r}return b(e,t),f(e,[{key:"_getType",value:function(){return"tool"}},{key:"concat",value:function(t){var r;return new e({content:(0,n._I)(this.content,t.content),additional_kwargs:(0,n.ns)(this.additional_kwargs,t.additional_kwargs),response_metadata:(0,n.ns)(this.response_metadata,t.response_metadata),artifact:(0,n.F7)(this.artifact,t.artifact),tool_call_id:this.tool_call_id,id:null!==(r=this.id)&&void 0!==r?r:t.id,status:(0,n.Iv)(this.status,t.status)})}},{key:"_printableFields",get:function(){return u(u({},y(e,"_printableFields",this,1)),{},{tool_call_id:this.tool_call_id,artifact:this.artifact})}}],[{key:"lc_name",value:function(){return"ToolMessageChunk"}}])}(n.gj);function _(t){var e,r=[],n=[],o=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return i(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,u=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return u=t.done,t},e:function(t){s=!0,a=t},f:function(){try{u||null==r.return||r.return()}finally{if(s)throw a}}}}(t);try{for(o.s();!(e=o.n()).done;){var a=e.value;if(a.function){var u=a.function.name;try{var s={name:u||"",args:JSON.parse(a.function.arguments)||{},id:a.id};r.push(s)}catch(t){n.push({name:u,args:a.function.arguments,id:a.id,error:"Malformed args."})}}}}catch(t){o.e(t)}finally{o.f()}return[r,n]}},9721:(t,e,r)=>{"use strict";r.d(e,{K0:()=>E,Sw:()=>O,ih:()=>k});var n=r(8662),o=r(1260),i=r(5743),a=r(5480),u=r(4770),s=r(3789),c=r(5451),l=r(2372),f=["type"],p=["tool_calls"],h=["role"];function d(t,e){if(t){if("string"==typeof t)return y(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?y(t,e):void 0}}function y(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function v(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function m(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?v(Object(r),!0).forEach((function(e){b(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function b(t,e,r){return(e=function(t){var e=function(t){if("object"!=w(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=w(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==w(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function g(t,e){if(null==t)return{};var r,n,o=function(t,e){if(null==t)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.includes(n))continue;r[n]=t[n]}return r}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.includes(r)||{}.propertyIsEnumerable.call(t,r)&&(o[r]=t[r])}return o}function w(t){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},w(t)}function x(t){return(0,n.K)(t)?t:"string"==typeof t.id&&"function"===t.type&&"object"===w(t.function)&&null!==t.function&&"arguments"in t.function&&"string"==typeof t.function.arguments&&"name"in t.function&&"string"==typeof t.function.name?{id:t.id,args:JSON.parse(t.function.arguments),name:t.function.name,type:"tool_call"}:t}function _(t){var e=t.type,r=g(t,f);if("human"===e||"user"===e)return new s.x(r);if("ai"===e||"assistant"===e){var n=r.tool_calls,i=g(r,p);if(!Array.isArray(n))return new o.Od(r);var a=n.map(x);return new o.Od(m(m({},i),{},{tool_calls:a}))}if("system"===e)return new c.t(r);if("tool"===e&&"tool_call_id"in r)return new l.uf(m(m({},r),{},{content:r.content,tool_call_id:r.tool_call_id,name:r.name}));throw new Error("Unable to coerce message from array: only human, AI, or system message coercion is currently supported.")}function E(t){if("string"==typeof t)return new s.x(t);if((0,i.ny)(t))return t;if(Array.isArray(t)){var e=(n=2,function(t){if(Array.isArray(t))return t}(r=t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],s=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);s=!0);}catch(t){c=!0,o=t}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(r,n)||d(r,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());return _({type:e[0],content:e[1]})}var r,n;if((0,i.dp)(t)){var o=t.role;return _(m(m({},g(t,h)),{},{type:o}))}return _(t)}function O(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Human",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"AI",o=[],i=function(t){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=d(t))){e&&(t=e);var r=0,n=function(){};return{s:n,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,a=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return i=t.done,t},e:function(t){a=!0,o=t},f:function(){try{i||null==e.return||e.return()}finally{if(a)throw o}}}}(t);try{for(i.s();!(e=i.n()).done;){var a=e.value,u=void 0;if("human"===a._getType())u=r;else if("ai"===a._getType())u=n;else if("system"===a._getType())u="System";else if("function"===a._getType())u="Function";else if("tool"===a._getType())u="Tool";else{if("generic"!==a._getType())throw new Error("Got unsupported message type: ".concat(a._getType()));u=a.role}var s=a.name?"".concat(a.name,", "):"",c="string"==typeof a.content?a.content:JSON.stringify(a.content,null,2);o.push("".concat(u,": ").concat(s).concat(c))}}catch(t){i.e(t)}finally{i.f()}return o.join("\n")}function k(t){var e=t._getType();if("human"===e)return new s.a(m({},t));if("ai"===e){var r,n=m({},t);return"tool_calls"in n&&(n=m(m({},n),{},{tool_call_chunks:null===(r=n.tool_calls)||void 0===r?void 0:r.map((function(t){return m(m({},t),{},{type:"tool_call_chunk",index:void 0,args:JSON.stringify(t.args)})}))})),new o.H(m({},n))}if("system"===e)return new c.u(m({},t));if("function"===e)return new u.F(m({},t));if(a.c.isInstance(t))return new a.X(m({},t));throw new Error("Unknown message type.")}},9445:(t,e,r)=>{"use strict";function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(t){var e="function"==typeof Map?new Map:void 0;return o=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(e){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return function(t,e,r){if(v())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,e);var o=new(t.bind.apply(t,n));return r&&g(o,r.prototype),o}(t,arguments,m(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),g(r,t)},o(t)}function i(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function a(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?i(Object(r),!0).forEach((function(e){u(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function u(t,e,r){return(e=d(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function s(){s=function(){return e};var t,e={},r=Object.prototype,o=r.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},u=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,r){return t[e]=r}}function p(t,e,r,n){var o=e&&e.prototype instanceof g?e:g,a=Object.create(o.prototype),u=new L(n||[]);return i(a,"_invoke",{value:A(t,r,u)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=p;var d="suspendedStart",y="suspendedYield",v="executing",m="completed",b={};function g(){}function w(){}function x(){}var _={};f(_,u,(function(){return this}));var E=Object.getPrototypeOf,O=E&&E(E(T([])));O&&O!==r&&o.call(O,u)&&(_=O);var k=x.prototype=g.prototype=Object.create(_);function j(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(i,a,u,s){var c=h(t[i],t,a);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==n(f)&&o.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,u,s)}),(function(t){r("throw",t,u,s)})):e.resolve(f).then((function(t){l.value=t,u(l)}),(function(t){return r("throw",t,u,s)}))}s(c.arg)}var a;i(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function A(e,r,n){var o=d;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=D(u,n);if(s){if(s===b)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var c=h(e,r,n);if("normal"===c.type){if(o=n.done?m:y,c.arg===b)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=m,n.method="throw",n.arg=c.arg)}}}function D(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,D(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,b;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,b):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,b)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[u];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,a=function r(){for(;++i<e.length;)if(o.call(e,i))return r.value=e[i],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(n(e)+" is not iterable")}return w.prototype=x,i(k,"constructor",{value:x,configurable:!0}),i(x,"constructor",{value:w,configurable:!0}),w.displayName=f(x,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,f(t,l,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},j(S.prototype),f(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(p(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},j(k),f(k,l,"Generator"),f(k,u,(function(){return this})),f(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var s=o.call(a,"catchLoc"),c=o.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,b):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),C(r),b}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;C(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),b}},e}function c(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function l(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){c(i,n,o,a,u,"next",t)}function u(t){c(i,n,o,a,u,"throw",t)}a(void 0)}))}}function f(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function p(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,d(n.key),n)}}function h(t,e,r){return e&&p(t.prototype,e),r&&p(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function d(t){var e=function(t){if("object"!=n(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==n(e)?e:e+""}function y(t,e,r){return e=m(e),function(t,e){if(e&&("object"==n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,v()?Reflect.construct(e,r||[],m(t).constructor):e.apply(t,r))}function v(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(v=function(){return!!t})()}function m(t){return m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},m(t)}function b(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&g(t,e)}function g(t,e){return g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},g(t,e)}r.d(e,{CC:()=>_,mJ:()=>x,vd:()=>w});var w=function(t){function e(){return f(this,e),y(this,e,arguments)}return b(e,t),h(e,[{key:"parseResultWithPrompt",value:function(t,e,r){return this.parseResult(t,r)}},{key:"_baseMessageToString",value:function(t){return"string"==typeof t.content?t.content:this._baseMessageContentToString(t.content)}},{key:"_baseMessageContentToString",value:function(t){return JSON.stringify(t)}},{key:"invoke",value:(r=l(s().mark((function t(e,r){var n=this;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("string"!=typeof e){t.next=4;break}return t.abrupt("return",this._callWithConfig(function(){var t=l(s().mark((function t(e,r){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",n.parseResult([{text:e}],null==r?void 0:r.callbacks));case 1:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),e,a(a({},r),{},{runType:"parser"})));case 4:return t.abrupt("return",this._callWithConfig(function(){var t=l(s().mark((function t(e,r){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",n.parseResult([{message:e,text:n._baseMessageToString(e)}],null==r?void 0:r.callbacks));case 1:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),e,a(a({},r),{},{runType:"parser"})));case 5:case"end":return t.stop()}}),t,this)}))),function(t,e){return r.apply(this,arguments)})}]);var r}(r(7258).YN),x=function(t){function e(){return f(this,e),y(this,e,arguments)}return b(e,t),h(e,[{key:"parseResult",value:function(t,e){return this.parse(t[0].text,e)}},{key:"parseWithPrompt",value:(r=l(s().mark((function t(e,r,n){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.parse(e,n));case 1:case"end":return t.stop()}}),t,this)}))),function(t,e,n){return r.apply(this,arguments)})},{key:"_type",value:function(){throw new Error("_type not implemented")}}]);var r}(w),_=function(t){function e(t,r,n){var o,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(f(this,e),o=y(this,e,[t]),Object.defineProperty(o,"llmOutput",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(o,"observation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(o,"sendToLLM",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),o.llmOutput=r,o.observation=n,o.sendToLLM=i,i&&(void 0===n||void 0===r))throw new Error("Arguments 'observation' & 'llmOutput' are required if 'sendToLlm' is true");return o}return b(e,t),h(e)}(o(Error))},9190:(t,e,r)=>{"use strict";r.d(e,{d1:()=>i.d,hU:()=>y});var n=r(1176),o=r(2398),i=r(6179);function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function u(){u=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",l=i.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,r){return t[e]=r}}function p(t,e,r,n){var i=e&&e.prototype instanceof g?e:g,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:A(t,r,u)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=p;var d="suspendedStart",y="suspendedYield",v="executing",m="completed",b={};function g(){}function w(){}function x(){}var _={};f(_,s,(function(){return this}));var E=Object.getPrototypeOf,O=E&&E(E(T([])));O&&O!==r&&n.call(O,s)&&(_=O);var k=x.prototype=g.prototype=Object.create(_);function j(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,u,s){var c=h(t[o],t,i);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==a(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,u,s)}),(function(t){r("throw",t,u,s)})):e.resolve(f).then((function(t){l.value=t,u(l)}),(function(t){return r("throw",t,u,s)}))}s(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function A(e,r,n){var o=d;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=D(u,n);if(s){if(s===b)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var c=h(e,r,n);if("normal"===c.type){if(o=n.done?m:y,c.arg===b)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=m,n.method="throw",n.arg=c.arg)}}}function D(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,D(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,b;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,b):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,b)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[s];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(a(e)+" is not iterable")}return w.prototype=x,o(k,"constructor",{value:x,configurable:!0}),o(x,"constructor",{value:w,configurable:!0}),w.displayName=f(x,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,f(t,l,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},j(S.prototype),f(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(p(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},j(k),f(k,l,"Generator"),f(k,s,(function(){return this})),f(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,b):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),C(r),b}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;C(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),b}},e}function s(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function c(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){s(i,n,o,a,u,"next",t)}function u(t){s(i,n,o,a,u,"throw",t)}a(void 0)}))}}function l(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,f(n.key),n)}}function f(t){var e=function(t){if("object"!=a(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==a(e)?e:e+""}function p(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(p=function(){return!!t})()}function h(t){return h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},h(t)}function d(t,e){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},d(t,e)}var y=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t=function(t,e,r){return e=h(e),function(t,e){if(e&&("object"==a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,p()?Reflect.construct(e,r||[],h(t).constructor):e.apply(t,r))}(this,e,arguments),Object.defineProperty(t,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","output_parsers"]}),Object.defineProperty(t,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&d(t,e)}(e,t),r=e,n=[{key:"_diff",value:function(t,e){if(e)return t?(0,o.U)(t,e):[{op:"replace",path:"",value:e}]}},{key:"parsePartialResult",value:(y=c(u().mark((function t(e){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,i.D)(e[0].text));case 1:case"end":return t.stop()}}),t)}))),function(t){return y.apply(this,arguments)})},{key:"parse",value:(f=c(u().mark((function t(e){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,i.D)(e,JSON.parse));case 1:case"end":return t.stop()}}),t)}))),function(t){return f.apply(this,arguments)})},{key:"getFormatInstructions",value:function(){return""}}],s=[{key:"lc_name",value:function(){return"JsonOutputParser"}}],n&&l(r.prototype,n),s&&l(r,s),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,s,f,y}(n.T)},1176:(t,e,r)=>{"use strict";r.d(e,{T:()=>it});var n=r(9445),o=r(5743),i=r(9721),a=r(5681);function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function s(t,e){var r=u(t);if(r!==u(e))return!1;if(Array.isArray(t)){if(!Array.isArray(e))return!1;var n=t.length;if(n!==e.length)return!1;for(var o=0;o<n;o++)if(!s(t[o],e[o]))return!1;return!0}if("object"===r){if(!t||!e)return t===e;var i=Object.keys(t),a=Object.keys(e);if(i.length!==a.length)return!1;for(var c=0,l=i;c<l.length;c++){var f=l[c];if(!s(t[f],e[f]))return!1}return!0}return t===e}function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function l(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function f(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?l(Object(r),!0).forEach((function(e){p(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function p(t,e,r){return(e=function(t){var e=function(t){if("object"!=c(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=c(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==c(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}"undefined"!=typeof self&&self.location&&"null"!==self.location.origin&&(self.location.origin,self.location.pathname,location.search);var d=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,y=[0,31,28,31,30,31,30,31,31,30,31,30,31],v=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d(?::?\d\d)?)?$/i,m=/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,b=/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,g=/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,w=/^(?:(?:http[s\u017F]?|ftp):\/\/)(?:(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+(?::(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?@)?(?:(?!10(?:\.[0-9]{1,3}){3})(?!127(?:\.[0-9]{1,3}){3})(?!169\.254(?:\.[0-9]{1,3}){2})(?!192\.168(?:\.[0-9]{1,3}){2})(?!172\.(?:1[6-9]|2[0-9]|3[01])(?:\.[0-9]{1,3}){2})(?:[1-9][0-9]?|1[0-9][0-9]|2[01][0-9]|22[0-3])(?:\.(?:1?[0-9]{1,2}|2[0-4][0-9]|25[0-5])){2}(?:\.(?:[1-9][0-9]?|1[0-9][0-9]|2[0-4][0-9]|25[0-4]))|(?:(?:[0-9KSa-z\xA1-\uFFFF]+-?)*[0-9KSa-z\xA1-\uFFFF]+)(?:\.(?:[0-9KSa-z\xA1-\uFFFF]+-?)*[0-9KSa-z\xA1-\uFFFF]+)*(?:\.(?:[KSa-z\xA1-\uFFFF]{2,})))(?::[0-9]{2,5})?(?:\/(?:(?![\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uD800-\uDFFF\uFEFF])[^]|[\uD800-\uDBFF][\uDC00-\uDFFF])*)?$/i,x=/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,_=/^(?:\/(?:[^~/]|~0|~1)*)*$/,E=/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,O=/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,k=/^\d\d\d\d-[0-1]\d-[0-3]\d$/,j=/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,S=/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,A=/^(?:(?:[a-z][a-z0-9+-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,D=/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,P=/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i;function C(t){return t.test.bind(t)}function L(t){var e=t.match(d);if(!e)return!1;var r=+e[1],n=+e[2],o=+e[3];return n>=1&&n<=12&&o>=1&&o<=(2==n&&function(t){return t%4==0&&(t%100!=0||t%400==0)}(r)?29:y[n])}function T(t,e){var r=e.match(v);if(!r)return!1;var n=+r[1],o=+r[2],i=+r[3],a=!!r[5];return(n<=23&&o<=59&&i<=59||23==n&&59==o&&60==i)&&(!t||a)}f(f({},{date:L,time:T.bind(void 0,!1),"date-time":function(t){var e=t.split(F);return 2==e.length&&L(e[0])&&T(!0,e[1])},duration:function(t){return t.length>1&&t.length<80&&(/^P\d+([.,]\d+)?W$/.test(t)||/^P[\dYMDTHS]*(\d[.,]\d+)?[YMDHS]$/.test(t)&&/^P([.,\d]+Y)?([.,\d]+M)?([.,\d]+D)?(T([.,\d]+H)?([.,\d]+M)?([.,\d]+S)?)?$/.test(t))},uri:function(t){return I.test(t)&&N.test(t)},"uri-reference":C(b),"uri-template":C(g),url:C(w),email:function(t){if('"'===t[0])return!1;var e,r=function(t){if(Array.isArray(t))return t}(e=t.split("@"))||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(e)||function(t,e){if(t){if("string"==typeof t)return h(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?h(t,e):void 0}}(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),n=r[0],o=r[1],i=r.slice(2);return!(!n||!o||0!==i.length||n.length>64||o.length>253)&&"."!==n[0]&&!n.endsWith(".")&&!n.includes("..")&&!(!/^[a-z0-9.-]+$/i.test(o)||!/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+$/i.test(n))&&o.split(".").every((function(t){return/^[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?$/i.test(t)}))},hostname:C(m),ipv4:C(D),ipv6:C(P),regex:function(t){if(R.test(t))return!1;try{return new RegExp(t),!0}catch(t){return!1}},uuid:C(x),"json-pointer":C(_),"json-pointer-uri-fragment":C(E),"relative-json-pointer":C(O)}),{},{date:C(k),time:C(j),"date-time":C(S),"uri-reference":C(A)});var F=/t|\s/i,I=/\/|:/,N=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,R=/[^\\]\\Z/;function M(t){return M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},M(t)}function B(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function G(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?B(Object(r),!0).forEach((function(e){U(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):B(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function U(t,e,r){return(e=H(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function z(){z=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new P(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function b(){}function g(){}var w={};c(w,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(w=_);var E=g.prototype=m.prototype=Object.create(w);function O(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,i,a,u){var s=f(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==M(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=S(u,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?y:h,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=y,n.method="throw",n.arg=c.arg)}}}function S(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,S(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function C(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(M(e)+" is not iterable")}return b.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=c(g,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,c(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},O(k.prototype),c(k.prototype,u,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(E),c(E,s,"Generator"),c(E,a,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=C,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),D(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;D(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:C(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function $(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function q(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,H(n.key),n)}}function K(t,e,r){return e&&q(t.prototype,e),r&&q(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function H(t){var e=function(t){if("object"!=M(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=M(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==M(e)?e:e+""}function Z(t,e,r){return e=V(e),function(t,e){if(e&&("object"==M(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Y()?Reflect.construct(e,r||[],V(t).constructor):e.apply(t,r))}function Y(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Y=function(){return!!t})()}function V(t){return V=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},V(t)}function W(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&J(t,e)}function J(t,e){return J=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},J(t,e)}function X(t){var e={},r=!1;function n(e,n){return r=!0,n=new Promise((function(r){r(t[e](n))})),{done:!1,value:new rt(n,1)}}return e["undefined"!=typeof Symbol&&Symbol.iterator||"@@iterator"]=function(){return this},e.next=function(t){return r?(r=!1,t):n("next",t)},"function"==typeof t.throw&&(e.throw=function(t){if(r)throw r=!1,t;return n("throw",t)}),"function"==typeof t.return&&(e.return=function(t){return r?(r=!1,t):n("return",t)}),e}function Q(t){return new rt(t,0)}function tt(t){return function(){return new et(t.apply(this,arguments))}}function et(t){var e,r;function n(e,r){try{var i=t[e](r),a=i.value,u=a instanceof rt;Promise.resolve(u?a.v:a).then((function(r){if(u){var s="return"===e?"return":"next";if(!a.k||r.done)return n(s,r);r=t[s](r).value}o(i.done?"return":"normal",r)}),(function(t){n("throw",t)}))}catch(t){o("throw",t)}}function o(t,o){switch(t){case"return":e.resolve({value:o,done:!0});break;case"throw":e.reject(o);break;default:e.resolve({value:o,done:!1})}(e=e.next)?n(e.key,e.arg):r=null}this._invoke=function(t,o){return new Promise((function(i,a){var u={key:t,arg:o,resolve:i,reject:a,next:null};r?r=r.next=u:(e=r=u,n(t,o))}))},"function"!=typeof t.return&&(this.return=void 0)}function rt(t,e){this.v=t,this.k=e}function nt(t){var e,r,n,o=2;for("undefined"!=typeof Symbol&&(r=Symbol.asyncIterator,n=Symbol.iterator);o--;){if(r&&null!=(e=t[r]))return e.call(t);if(n&&null!=(e=t[n]))return new ot(e.call(t));r="@@asyncIterator",n="@@iterator"}throw new TypeError("Object is not async iterable")}function ot(t){function e(t){if(Object(t)!==t)return Promise.reject(new TypeError(t+" is not an object."));var e=t.done;return Promise.resolve(t.value).then((function(t){return{value:t,done:e}}))}return ot=function(t){this.s=t,this.n=t.next},ot.prototype={s:null,n:null,next:function(){return e(this.n.apply(this.s,arguments))},return:function(t){var r=this.s.return;return void 0===r?Promise.resolve({value:t,done:!0}):e(r.apply(this.s,arguments))},throw:function(t){var r=this.s.return;return void 0===r?Promise.reject(t):e(r.apply(this.s,arguments))}},new ot(t)}et.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},et.prototype.next=function(t){return this._invoke("next",t)},et.prototype.throw=function(t){return this._invoke("throw",t)},et.prototype.return=function(t){return this._invoke("return",t)};var it=function(t){function e(t){var r,n;return $(this,e),n=Z(this,e,[t]),Object.defineProperty(n,"diff",{enumerable:!0,configurable:!0,writable:!0,value:!1}),n.diff=null!==(r=null==t?void 0:t.diff)&&void 0!==r?r:n.diff,n}return W(e,t),K(e,[{key:"_transform",value:function(t){var e=this;return tt(z().mark((function r(){var n,u,c,l,f,p,h,d,y,v;return z().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:c=!1,l=!1,r.prev=2,p=nt(t);case 4:return r.next=6,Q(p.next());case 6:if(!(c=!(h=r.sent).done)){r.next=40;break}if("string"==typeof(d=h.value)||"string"==typeof d.content){r.next=10;break}throw new Error("Cannot handle non-string output.");case 10:if(y=void 0,!(0,o.AJ)(d)){r.next=17;break}if("string"==typeof d.content){r.next=14;break}throw new Error("Cannot handle non-string message output.");case 14:y=new a.Cf({message:d,text:d.content}),r.next=24;break;case 17:if(!(0,o.ny)(d)){r.next=23;break}if("string"==typeof d.content){r.next=20;break}throw new Error("Cannot handle non-string message output.");case 20:y=new a.Cf({message:(0,i.ih)(d),text:d.content}),r.next=24;break;case 23:y=new a.mu({text:d});case 24:return u=void 0===u?y:u.concat(y),r.next=27,Q(e.parsePartialResult([u]));case 27:if(null==(v=r.sent)||s(v,n)){r.next=37;break}if(!e.diff){r.next=34;break}return r.next=32,e._diff(n,v);case 32:r.next=36;break;case 34:return r.next=36,v;case 36:n=v;case 37:c=!1,r.next=4;break;case 40:r.next=46;break;case 42:r.prev=42,r.t0=r.catch(2),l=!0,f=r.t0;case 46:if(r.prev=46,r.prev=47,!c||null==p.return){r.next=51;break}return r.next=51,Q(p.return());case 51:if(r.prev=51,!l){r.next=54;break}throw f;case 54:return r.finish(51);case 55:return r.finish(46);case 56:case"end":return r.stop()}}),r,null,[[2,42,46,56],[47,,51,55]])})))()}},{key:"getFormatInstructions",value:function(){return""}}])}(function(t){function e(){return $(this,e),Z(this,e,arguments)}return W(e,t),K(e,[{key:"_transform",value:function(t){var e=this;return tt(z().mark((function r(){var n,o,i,a,u,s;return z().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:n=!1,o=!1,r.prev=2,a=nt(t);case 4:return r.next=6,Q(a.next());case 6:if(!(n=!(u=r.sent).done)){r.next=18;break}if("string"!=typeof(s=u.value)){r.next=13;break}return r.next=11,e.parseResult([{text:s}]);case 11:r.next=15;break;case 13:return r.next=15,e.parseResult([{message:s,text:e._baseMessageToString(s)}]);case 15:n=!1,r.next=4;break;case 18:r.next=24;break;case 20:r.prev=20,r.t0=r.catch(2),o=!0,i=r.t0;case 24:if(r.prev=24,r.prev=25,!n||null==a.return){r.next=29;break}return r.next=29,Q(a.return());case 29:if(r.prev=29,!o){r.next=32;break}throw i;case 32:return r.finish(29);case 33:return r.finish(24);case 34:case"end":return r.stop()}}),r,null,[[2,20,24,34],[25,,29,33]])})))()}},{key:"transform",value:function(t,e){var r=this;return tt(z().mark((function n(){return z().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.delegateYield(X(nt(r._transformStreamWithConfig(t,r._transform.bind(r),G(G({},e),{},{runType:"parser"})))),"t0",1);case 1:case"end":return n.stop()}}),n)})))()}}])}(n.mJ))},5681:(t,e,r)=>{"use strict";function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(o=function(){return!!t})()}function i(t){return i=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},i(t)}function a(t,e){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},a(t,e)}function u(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function s(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?u(Object(r),!0).forEach((function(e){c(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function c(t,e,r){return(e=h(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function f(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,h(n.key),n)}}function p(t,e,r){return e&&f(t.prototype,e),r&&f(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function h(t){var e=function(t){if("object"!=n(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==n(e)?e:e+""}r.d(e,{Cf:()=>v,SP:()=>d,mu:()=>y});var d="__run",y=function(){function t(e){l(this,t),Object.defineProperty(this,"text",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"generationInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.text=e.text,this.generationInfo=e.generationInfo}return p(t,[{key:"concat",value:function(e){return new t({text:this.text+e.text,generationInfo:s(s({},this.generationInfo),e.generationInfo)})}}])}(),v=function(t){function e(t){var r,a,u,s;return l(this,e),a=this,s=[t],u=i(u=e),r=function(t,e){if(e&&("object"==n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(a,o()?Reflect.construct(u,s||[],i(a).constructor):u.apply(a,s)),Object.defineProperty(r,"message",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),r.message=t.message,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(e,t),p(e,[{key:"concat",value:function(t){return new e({text:this.text+t.text,generationInfo:s(s({},this.generationInfo),t.generationInfo),message:this.message.concat(t.message)})}}])}(y)},4238:(t,e,r)=>{"use strict";r.d(e,{HY:()=>m,aB:()=>b,vX:()=>g});var n=r(4865),o=r(3789),i=r(9721);function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function u(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,c(n.key),n)}}function s(t,e,r){return e&&u(t.prototype,e),r&&u(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function c(t){var e=function(t){if("object"!=a(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==a(e)?e:e+""}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function f(t,e,r){return e=h(e),function(t,e){if(e&&("object"==a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,p()?Reflect.construct(e,r||[],h(t).constructor):e.apply(t,r))}function p(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(p=function(){return!!t})()}function h(t){return h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},h(t)}function d(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&y(t,e)}function y(t,e){return y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},y(t,e)}var v=function(t){function e(){return l(this,e),f(this,e,arguments)}return d(e,t),s(e)}(n.y),m=function(t){function e(t){var r;return l(this,e),r=f(this,e,[{value:t}]),Object.defineProperty(r,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(r,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(r,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),r.value=t,r}return d(e,t),s(e,[{key:"toString",value:function(){return this.value}},{key:"toChatMessages",value:function(){return[new o.x(this.value)]}}],[{key:"lc_name",value:function(){return"StringPromptValue"}}])}(v),b=function(t){function e(t){var r;return l(this,e),Array.isArray(t)&&(t={messages:t}),r=f(this,e,[t]),Object.defineProperty(r,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(r,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(r,"messages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),r.messages=t.messages,r}return d(e,t),s(e,[{key:"toString",value:function(){return(0,i.Sw)(this.messages)}},{key:"toChatMessages",value:function(){return this.messages}}],[{key:"lc_name",value:function(){return"ChatPromptValue"}}])}(v),g=function(t){function e(t){var r;return l(this,e),"imageUrl"in t||(t={imageUrl:t}),r=f(this,e,[t]),Object.defineProperty(r,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(r,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(r,"imageUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(r,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),r.imageUrl=t.imageUrl,r}return d(e,t),s(e,[{key:"toString",value:function(){return this.imageUrl.url}},{key:"toChatMessages",value:function(){return[new o.x({content:[{type:"image_url",image_url:{detail:this.imageUrl.detail,url:this.imageUrl.url}}]})]}}],[{key:"lc_name",value:function(){return"ImagePromptValue"}}])}(v)},6106:(t,e,r)=>{"use strict";function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(){o=function(){return e};var t,e={},r=Object.prototype,i=r.hasOwnProperty,a=Object.defineProperty||function(t,e,r){t[e]=r.value},u="function"==typeof Symbol?Symbol:{},s=u.iterator||"@@iterator",c=u.asyncIterator||"@@asyncIterator",l=u.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,r){return t[e]=r}}function p(t,e,r,n){var o=e&&e.prototype instanceof g?e:g,i=Object.create(o.prototype),u=new L(n||[]);return a(i,"_invoke",{value:A(t,r,u)}),i}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=p;var d="suspendedStart",y="suspendedYield",v="executing",m="completed",b={};function g(){}function w(){}function x(){}var _={};f(_,s,(function(){return this}));var E=Object.getPrototypeOf,O=E&&E(E(T([])));O&&O!==r&&i.call(O,s)&&(_=O);var k=x.prototype=g.prototype=Object.create(_);function j(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,a,u,s){var c=h(t[o],t,a);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==n(f)&&i.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,u,s)}),(function(t){r("throw",t,u,s)})):e.resolve(f).then((function(t){l.value=t,u(l)}),(function(t){return r("throw",t,u,s)}))}s(c.arg)}var o;a(this,"_invoke",{value:function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}})}function A(e,r,n){var o=d;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=D(u,n);if(s){if(s===b)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var c=h(e,r,n);if("normal"===c.type){if(o=n.done?m:y,c.arg===b)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=m,n.method="throw",n.arg=c.arg)}}}function D(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,D(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,b;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,b):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,b)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[s];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(i.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(n(e)+" is not iterable")}return w.prototype=x,a(k,"constructor",{value:x,configurable:!0}),a(x,"constructor",{value:w,configurable:!0}),w.displayName=f(x,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,f(t,l,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},j(S.prototype),f(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(p(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},j(k),f(k,l,"Generator"),f(k,s,(function(){return this})),f(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var r in this)"t"===r.charAt(0)&&i.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],u=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var s=i.call(a,"catchLoc"),c=i.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,b):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),C(r),b}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;C(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),b}},e}function i(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function a(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?i(Object(r),!0).forEach((function(e){u(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function u(t,e,r){return(e=h(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function s(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],s=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);s=!0);}catch(t){c=!0,o=t}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(t,e)||function(t,e){if(t){if("string"==typeof t)return c(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function l(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function f(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){l(i,n,o,a,u,"next",t)}function u(t){l(i,n,o,a,u,"throw",t)}a(void 0)}))}}function p(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,h(n.key),n)}}function h(t){var e=function(t){if("object"!=n(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==n(e)?e:e+""}function d(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(d=function(){return!!t})()}function y(t){return y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},y(t)}function v(t,e){return v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},v(t,e)}r.d(e,{m:()=>m});var m=function(t){function e(t){var r;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=function(t,e,r){return e=y(e),function(t,e){if(e&&("object"==n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,d()?Reflect.construct(e,r||[],y(t).constructor):e.apply(t,r))}(this,e,[t]),Object.defineProperty(r,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(r,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompts",r._getPromptType()]}),Object.defineProperty(r,"inputVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(r,"outputParser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(r,"partialVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),t.inputVariables.includes("stop"))throw new Error("Cannot have an input variable named 'stop', as it is used internally, please rename.");return Object.assign(r,t),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&v(t,e)}(e,t),i=e,u=[{key:"lc_attributes",get:function(){return{partialVariables:void 0}}},{key:"mergePartialAndUserVariables",value:(m=f(o().mark((function t(e){var r,n,i,u,c,l,f,p,h;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=null!==(r=this.partialVariables)&&void 0!==r?r:{},i={},u=0,c=Object.entries(n);case 3:if(!(u<c.length)){t.next=15;break}if(l=s(c[u],2),f=l[0],"string"!=typeof(p=l[1])){t.next=9;break}i[f]=p,t.next=12;break;case 9:return t.next=11,p();case 11:i[f]=t.sent;case 12:u++,t.next=3;break;case 15:return h=a(a({},i),e),t.abrupt("return",h);case 17:case"end":return t.stop()}}),t,this)}))),function(t){return m.apply(this,arguments)})},{key:"invoke",value:(h=f(o().mark((function t(e,r){var n=this;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this._callWithConfig((function(t){return n.formatPromptValue(t)}),e,a(a({},r),{},{runType:"prompt"})));case 1:case"end":return t.stop()}}),t,this)}))),function(t,e){return h.apply(this,arguments)})},{key:"serialize",value:function(){throw new Error("Use .toJSON() instead")}}],c=[{key:"deserialize",value:(l=f(o().mark((function t(e){var n,i,u,s,c,l;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=e._type,t.next="prompt"===t.t0?3:void 0===t.t0?8:"few_shot"===t.t0?13:18;break;case 3:return t.next=5,Promise.resolve().then(r.bind(r,6917));case 5:return n=t.sent,i=n.PromptTemplate,t.abrupt("return",i.deserialize(e));case 8:return t.next=10,Promise.resolve().then(r.bind(r,6917));case 10:return u=t.sent,s=u.PromptTemplate,t.abrupt("return",s.deserialize(a(a({},e),{},{_type:"prompt"})));case 13:return t.next=15,Promise.resolve().then(r.bind(r,7428));case 15:return c=t.sent,l=c.FewShotPromptTemplate,t.abrupt("return",l.deserialize(e));case 18:throw new Error("Invalid prompt type in config: ".concat(e._type));case 19:case"end":return t.stop()}}),t)}))),function(t){return l.apply(this,arguments)})}],u&&p(i.prototype,u),c&&p(i,c),Object.defineProperty(i,"prototype",{writable:!1}),i;var i,u,c,l,h,m}(r(7889).YN)},6725:(t,e,r)=>{"use strict";r.d(e,{BJ:()=>B,FS:()=>R,GL:()=>L,RZ:()=>U,qF:()=>F,sS:()=>M});var n=r(6641),o=r(4238),i=r(7889),a=r(4150),u=r(6106),s=r(6917),c=r(2610),l=r(1754);function f(t){return function(t){if(Array.isArray(t))return y(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||d(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(t){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p(t)}function h(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=d(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}function d(t,e){if(t){if("string"==typeof t)return y(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?y(t,e):void 0}}function y(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function v(){v=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof g?e:g,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:A(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",d="suspendedYield",y="executing",m="completed",b={};function g(){}function w(){}function x(){}var _={};c(_,a,(function(){return this}));var E=Object.getPrototypeOf,O=E&&E(E(T([])));O&&O!==r&&n.call(O,a)&&(_=O);var k=x.prototype=g.prototype=Object.create(_);function j(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,u){var s=f(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==p(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function A(e,r,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=D(u,n);if(s){if(s===b)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?m:d,c.arg===b)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=m,n.method="throw",n.arg=c.arg)}}}function D(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,D(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,b;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,b):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,b)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(p(e)+" is not iterable")}return w.prototype=x,o(k,"constructor",{value:x,configurable:!0}),o(x,"constructor",{value:w,configurable:!0}),w.displayName=c(x,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,c(t,s,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},j(S.prototype),c(S.prototype,u,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},j(k),c(k,s,"Generator"),c(k,a,(function(){return this})),c(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,b):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),C(r),b}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;C(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),b}},e}function m(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function b(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?m(Object(r),!0).forEach((function(e){g(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function g(t,e,r){return(e=k(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function w(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function x(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){w(i,n,o,a,u,"next",t)}function u(t){w(i,n,o,a,u,"throw",t)}a(void 0)}))}}function _(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function E(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,k(n.key),n)}}function O(t,e,r){return e&&E(t.prototype,e),r&&E(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function k(t){var e=function(t){if("object"!=p(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=p(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==p(e)?e:e+""}function j(t,e,r){return e=A(e),function(t,e){if(e&&("object"==p(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,S()?Reflect.construct(e,r||[],A(t).constructor):e.apply(t,r))}function S(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(S=function(){return!!t})()}function A(t){return A=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},A(t)}function D(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&P(t,e)}function P(t,e){return P=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},P(t,e)}var C=function(t){function e(){var t;return _(this,e),t=j(this,e,arguments),Object.defineProperty(t,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompts","chat"]}),Object.defineProperty(t,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),t}return D(e,t),O(e,[{key:"invoke",value:(r=x(v().mark((function t(e,r){var n=this;return v().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this._callWithConfig((function(t){return n.formatMessages(t)}),e,b(b({},r),{},{runType:"prompt"})));case 1:case"end":return t.stop()}}),t,this)}))),function(t,e){return r.apply(this,arguments)})}]);var r}(i.YN),L=function(t){function e(t){var r,n;return _(this,e),"string"==typeof t&&(t={variableName:t}),n=j(this,e,[t]),Object.defineProperty(n,"variableName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(n,"optional",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),n.variableName=t.variableName,n.optional=null!==(r=t.optional)&&void 0!==r&&r,n}return D(e,t),O(e,[{key:"inputVariables",get:function(){return[this.variableName]}},{key:"formatMessages",value:(r=x(v().mark((function t(e){var r,o,i,a,u;return v().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e[this.variableName],!this.optional||r){t.next=5;break}return t.abrupt("return",[]);case 5:if(r){t.next=9;break}throw(o=new Error('Field "'.concat(this.variableName,'" in prompt uses a MessagesPlaceholder, which expects an array of BaseMessages as an input value. Received: undefined'))).name="InputFormatError",o;case 9:t.prev=9,i=Array.isArray(r)?r.map(n.K0):[(0,n.K0)(r)],t.next=19;break;case 13:throw t.prev=13,t.t0=t.catch(9),a="string"==typeof r?r:JSON.stringify(r,null,2),(u=new Error(['Field "'.concat(this.variableName,'" in prompt uses a MessagesPlaceholder, which expects an array of BaseMessages or coerceable values as input.'),"Received value: ".concat(a),"Additional message: ".concat(t.t0.message)].join("\n\n"))).name="InputFormatError",u;case 19:return t.abrupt("return",i);case 20:case"end":return t.stop()}}),t,this,[[9,13]])}))),function(t){return r.apply(this,arguments)})}],[{key:"lc_name",value:function(){return"MessagesPlaceholder"}}]);var r}(C),T=function(t){function e(t){var r;return _(this,e),"prompt"in t||(t={prompt:t}),r=j(this,e,[t]),Object.defineProperty(r,"prompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),r.prompt=t.prompt,r}return D(e,t),O(e,[{key:"inputVariables",get:function(){return this.prompt.inputVariables}},{key:"formatMessages",value:(r=x(v().mark((function t(e){return v().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.format(e);case 2:return t.t0=t.sent,t.abrupt("return",[t.t0]);case 4:case"end":return t.stop()}}),t,this)}))),function(t){return r.apply(this,arguments)})}]);var r}(C),F=function(t){function e(t){return _(this,e),j(this,e,[t])}return D(e,t),O(e,[{key:"format",value:(n=x(v().mark((function t(e){return v().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.formatPromptValue(e);case 2:return t.abrupt("return",t.sent.toString());case 3:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"formatPromptValue",value:(r=x(v().mark((function t(e){var r;return v().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.formatMessages(e);case 2:return r=t.sent,t.abrupt("return",new o.aB(r));case 4:case"end":return t.stop()}}),t,this)}))),function(t){return r.apply(this,arguments)})}]);var r,n}(u.m),I=function(t){function e(t,r){var n;return _(this,e),"prompt"in t||(t={prompt:t,role:r}),n=j(this,e,[t]),Object.defineProperty(n,"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),n.role=t.role,n}return D(e,t),O(e,[{key:"format",value:(r=x(v().mark((function t(e){return v().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=n.cM,t.next=3,this.prompt.format(e);case 3:return t.t1=t.sent,t.t2=this.role,t.abrupt("return",new t.t0(t.t1,t.t2));case 6:case"end":return t.stop()}}),t,this)}))),function(t){return r.apply(this,arguments)})}],[{key:"lc_name",value:function(){return"ChatMessagePromptTemplate"}},{key:"fromTemplate",value:function(t,e,r){return new this(s.PromptTemplate.fromTemplate(t,{templateFormat:null==r?void 0:r.templateFormat}),e)}}]);var r}(T),N=function(t){function e(t,r){var n;if(_(this,e),"prompt"in t||(t={prompt:t}),n=j(this,e,[t]),Object.defineProperty(n,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompts","chat"]}),Object.defineProperty(n,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(n,"inputVariables",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(n,"additionalOptions",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(n,"prompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(n,"messageClass",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(n,"chatMessageClass",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),n.prompt=t.prompt,Array.isArray(n.prompt)){var o=[];n.prompt.forEach((function(t){"inputVariables"in t&&(o=o.concat(t.inputVariables))})),n.inputVariables=o}else n.inputVariables=n.prompt.inputVariables;return n.additionalOptions=null!=r?r:n.additionalOptions,n}return D(e,t),O(e,[{key:"createMessage",value:function(t){var e=this.constructor;if(e._messageClass())return new(e._messageClass())({content:t});if(e.chatMessageClass){var r=e.chatMessageClass();return new r({content:t,role:this.getRoleFromMessageClass(r.lc_name())})}throw new Error("No message class defined")}},{key:"getRoleFromMessageClass",value:function(t){switch(t){case"HumanMessage":return"human";case"AIMessage":return"ai";case"SystemMessage":return"system";case"ChatMessage":return"chat";default:throw new Error("Invalid message class name")}}},{key:"format",value:(n=x(v().mark((function t(e){var r,n,o,i,u,s,l,f,p,d,y,m,w;return v().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(this.prompt instanceof a.L)){t.next=7;break}return t.next=3,this.prompt.format(e);case 3:return r=t.sent,t.abrupt("return",this.createMessage(r));case 7:n=[],o=h(this.prompt),t.prev=9,o.s();case 11:if((i=o.n()).done){t.next=36;break}if(u=i.value,s={},"inputVariables"in u){t.next=16;break}throw new Error("Prompt ".concat(u," does not have inputVariables defined."));case 16:l=h(u.inputVariables);try{for(l.s();!(f=l.n()).done;)p=f.value,s||(s=g({},p,e[p])),s=b(b({},s),{},g({},p,e[p]))}catch(t){l.e(t)}finally{l.f()}if(!(u instanceof a.L)){t.next=27;break}return t.next=21,u.format(s);case 21:d=t.sent,y=void 0,"additionalContentFields"in u&&(y=u.additionalContentFields),n.push(b(b({},y),{},{type:"text",text:d})),t.next=34;break;case 27:if(!(u instanceof c.C)){t.next=34;break}return t.next=30,u.format(s);case 30:m=t.sent,w=void 0,"additionalContentFields"in u&&(w=u.additionalContentFields),n.push(b(b({},w),{},{type:"image_url",image_url:m}));case 34:t.next=11;break;case 36:t.next=41;break;case 38:t.prev=38,t.t0=t.catch(9),o.e(t.t0);case 41:return t.prev=41,o.f(),t.finish(41);case 44:return t.abrupt("return",this.createMessage(n));case 45:case"end":return t.stop()}}),t,this,[[9,38,41,44]])}))),function(t){return n.apply(this,arguments)})},{key:"formatMessages",value:(r=x(v().mark((function t(e){return v().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.format(e);case 2:return t.t0=t.sent,t.abrupt("return",[t.t0]);case 4:case"end":return t.stop()}}),t,this)}))),function(t){return r.apply(this,arguments)})}],[{key:"_messageClass",value:function(){throw new Error("Can not invoke _messageClass from inside _StringImageMessagePromptTemplate")}},{key:"fromTemplate",value:function(t,e){if("string"==typeof t)return new this(s.PromptTemplate.fromTemplate(t,e));var r,n=[],o=h(t);try{for(o.s();!(r=o.n()).done;){var i=r.value;if("string"==typeof i||"object"===p(i)&&"text"in i){var a="";if("string"==typeof i)a=i;else if("string"==typeof i.text){var u;a=null!==(u=i.text)&&void 0!==u?u:""}var f=b(b({},e),"string"!=typeof i?{additionalContentFields:i}:{});n.push(s.PromptTemplate.fromTemplate(a,f))}else if("object"===p(i)&&"image_url"in i){var d,y=null!==(d=i.image_url)&&void 0!==d?d:"",v=void 0,m=[];if("string"==typeof y){var g,w=("mustache"===(null==e?void 0:e.templateFormat)?(0,l.g2)(y):(0,l.D4)(y)).flatMap((function(t){return"variable"===t.type?[t.name]:[]}));if((null!==(g=null==w?void 0:w.length)&&void 0!==g?g:0)>0){if(w.length>1)throw new Error("Only one format variable allowed per image template.\nGot: ".concat(w,"\nFrom: ").concat(y));m=[w[0]]}else m=[];y={url:y},v=new c.C({template:y,inputVariables:m,templateFormat:null==e?void 0:e.templateFormat,additionalContentFields:i})}else{if("object"!==p(y))throw new Error("Invalid image template");m="url"in y?("mustache"===(null==e?void 0:e.templateFormat)?(0,l.g2)(y.url):(0,l.D4)(y.url)).flatMap((function(t){return"variable"===t.type?[t.name]:[]})):[],v=new c.C({template:y,inputVariables:m,templateFormat:null==e?void 0:e.templateFormat,additionalContentFields:i})}n.push(v)}}}catch(t){o.e(t)}finally{o.f()}return new this({prompt:n,additionalOptions:e})}}]);var r,n}(C),R=function(t){function e(){return _(this,e),j(this,e,arguments)}return D(e,t),O(e,null,[{key:"_messageClass",value:function(){return n.xc}},{key:"lc_name",value:function(){return"HumanMessagePromptTemplate"}}])}(N),M=function(t){function e(){return _(this,e),j(this,e,arguments)}return D(e,t),O(e,null,[{key:"_messageClass",value:function(){return n.Od}},{key:"lc_name",value:function(){return"AIMessagePromptTemplate"}}])}(N),B=function(t){function e(){return _(this,e),j(this,e,arguments)}return D(e,t),O(e,null,[{key:"_messageClass",value:function(){return n.tn}},{key:"lc_name",value:function(){return"SystemMessagePromptTemplate"}}])}(N);function G(t,e){if("function"==typeof t.formatMessages||(0,n.ny)(t))return t;if(Array.isArray(t)&&"placeholder"===t[0]){var r=t[1];if("string"!=typeof r||"{"!==r[0]||"}"!==r[r.length-1])throw new Error('Invalid placeholder template: "'.concat(t[1],'". Expected a variable name surrounded by curly braces.'));var o=r.slice(1,-1);return new L({variableName:o,optional:!0})}var i,a=(0,n.K0)(t);if(i="string"==typeof a.content?a.content:a.content.map((function(t){return"text"in t?b(b({},t),{},{text:t.text}):"image_url"in t?b(b({},t),{},{image_url:t.image_url}):t})),"human"===a._getType())return R.fromTemplate(i,e);if("ai"===a._getType())return M.fromTemplate(i,e);if("system"===a._getType())return B.fromTemplate(i,e);if(n.cM.isInstance(a))return I.fromTemplate(a.content,a.role,e);throw new Error('Could not coerce message prompt template from input. Received message type: "'.concat(a._getType(),'".'))}var U=function(t){function e(t){var r;if(_(this,e),r=j(this,e,[t]),Object.defineProperty(r,"promptMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(r,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(r,"templateFormat",{enumerable:!0,configurable:!0,writable:!0,value:"f-string"}),"mustache"===t.templateFormat&&void 0===t.validateTemplate&&(r.validateTemplate=!1),Object.assign(r,t),r.validateTemplate){var o,i=new Set,a=h(r.promptMessages);try{for(a.s();!(o=a.n()).done;){var u=o.value;if(!(u instanceof n.XQ)){var s,c=h(u.inputVariables);try{for(c.s();!(s=c.n()).done;){var l=s.value;i.add(l)}}catch(t){c.e(t)}finally{c.f()}}}}catch(t){a.e(t)}finally{a.f()}var p=r.inputVariables,d=new Set(r.partialVariables?p.concat(Object.keys(r.partialVariables)):p),y=new Set(f(d).filter((function(t){return!i.has(t)})));if(y.size>0)throw new Error("Input variables `".concat(f(y),"` are not used in any of the prompt messages."));var v=new Set(f(i).filter((function(t){return!d.has(t)})));if(v.size>0)throw new Error("Input variables `".concat(f(v),"` are used in prompt messages but not in the prompt template."))}return r}return D(e,t),O(e,[{key:"lc_aliases",get:function(){return{promptMessages:"messages"}}},{key:"_getPromptType",value:function(){return"chat"}},{key:"_parseImagePrompts",value:(i=x(v().mark((function t(e,r){var n,o=this;return v().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("string"!=typeof e.content){t.next=2;break}return t.abrupt("return",e);case 2:return t.next=4,Promise.all(e.content.map(function(){var t=x(v().mark((function t(e){var n,i,a;return v().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("image_url"===e.type){t.next=2;break}return t.abrupt("return",e);case 2:return"",n="string"==typeof e.image_url?e.image_url:e.image_url.url,i=s.PromptTemplate.fromTemplate(n,{templateFormat:o.templateFormat}),t.next=7,i.format(r);case 7:return a=t.sent,"string"!=typeof e.image_url&&"url"in e.image_url?e.image_url.url=a:e.image_url=a,t.abrupt("return",e);case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 4:return n=t.sent,e.content=n,t.abrupt("return",e);case 7:case"end":return t.stop()}}),t)}))),function(t,e){return i.apply(this,arguments)})},{key:"formatMessages",value:(o=x(v().mark((function t(e){var r,o,i,a,u,s=this;return v().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.mergePartialAndUserVariables(e);case 2:r=t.sent,o=[],i=h(this.promptMessages),t.prev=5,u=v().mark((function t(){var e,i,u;return v().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!((e=a.value)instanceof n.XQ)){t.next=9;break}return t.t0=o,t.next=5,s._parseImagePrompts(e,r);case 5:t.t1=t.sent,t.t0.push.call(t.t0,t.t1),t.next=14;break;case 9:return i=e.inputVariables.reduce((function(t,n){if(!(n in r||"MessagesPlaceholder"===e.constructor.lc_name()&&e.optional))throw new Error("Missing value for input variable `".concat(n.toString(),"`"));return t[n]=r[n],t}),{}),t.next=12,e.formatMessages(i);case 12:u=t.sent,o=o.concat(u);case 14:case"end":return t.stop()}}),t)})),i.s();case 8:if((a=i.n()).done){t.next=12;break}return t.delegateYield(u(),"t0",10);case 10:t.next=8;break;case 12:t.next=17;break;case 14:t.prev=14,t.t1=t.catch(5),i.e(t.t1);case 17:return t.prev=17,i.f(),t.finish(17);case 20:return t.abrupt("return",o);case 21:case"end":return t.stop()}}),t,this,[[5,14,17,20]])}))),function(t){return o.apply(this,arguments)})},{key:"partial",value:(r=x(v().mark((function t(r){var n,o,i,a;return v().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=this.inputVariables.filter((function(t){return!(t in r)})),i=b(b({},null!==(n=this.partialVariables)&&void 0!==n?n:{}),r),a=b(b({},this),{},{inputVariables:o,partialVariables:i}),t.abrupt("return",new e(a));case 4:case"end":return t.stop()}}),t,this)}))),function(t){return r.apply(this,arguments)})}],[{key:"lc_name",value:function(){return"ChatPromptTemplate"}},{key:"fromTemplate",value:function(t,e){var r=s.PromptTemplate.fromTemplate(t,e),n=new R({prompt:r});return this.fromMessages([n])}},{key:"fromMessages",value:function(t,r){var o,i=t.reduce((function(t,n){return t.concat(n instanceof e?n.promptMessages:[G(n,r)])}),[]),a=t.reduce((function(t,r){return r instanceof e?Object.assign(t,r.partialVariables):t}),Object.create(null)),u=new Set,s=h(i);try{for(s.s();!(o=s.n()).done;){var c=o.value;if(!(c instanceof n.XQ)){var l,p=h(c.inputVariables);try{for(p.s();!(l=p.n()).done;){var d=l.value;d in a||u.add(d)}}catch(t){p.e(t)}finally{p.f()}}}}catch(t){s.e(t)}finally{s.f()}return new this(b(b({},r),{},{inputVariables:f(u),promptMessages:i,partialVariables:a,templateFormat:null==r?void 0:r.templateFormat}))}},{key:"fromPromptMessages",value:function(t){return this.fromMessages(t)}}]);var r,o,i}(F)},7428:(t,e,r)=>{"use strict";r.r(e),r.d(e,{FewShotChatMessagePromptTemplate:()=>A,FewShotPromptTemplate:()=>S});var n=r(4150),o=r(1754),i=r(6917),a=r(6725);function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function s(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=l(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}function c(t){return function(t){if(Array.isArray(t))return f(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||l(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t,e){if(t){if("string"==typeof t)return f(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?f(t,e):void 0}}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function p(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function h(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?p(Object(r),!0).forEach((function(e){d(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function d(t,e,r){return(e=x(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function y(){y=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function f(t,e,r,n){var i=e&&e.prototype instanceof g?e:g,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:A(t,r,u)}),a}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=f;var h="suspendedStart",d="suspendedYield",v="executing",m="completed",b={};function g(){}function w(){}function x(){}var _={};l(_,a,(function(){return this}));var E=Object.getPrototypeOf,O=E&&E(E(T([])));O&&O!==r&&n.call(O,a)&&(_=O);var k=x.prototype=g.prototype=Object.create(_);function j(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,s){var c=p(t[o],t,i);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==u(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function A(e,r,n){var o=h;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=D(u,n);if(s){if(s===b)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var c=p(e,r,n);if("normal"===c.type){if(o=n.done?m:d,c.arg===b)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=m,n.method="throw",n.arg=c.arg)}}}function D(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,D(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;var i=p(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,b;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,b):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,b)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(u(e)+" is not iterable")}return w.prototype=x,o(k,"constructor",{value:x,configurable:!0}),o(x,"constructor",{value:w,configurable:!0}),w.displayName=l(x,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,l(t,c,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},j(S.prototype),l(S.prototype,s,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(f(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},j(k),l(k,c,"Generator"),l(k,a,(function(){return this})),l(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,b):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),C(r),b}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;C(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),b}},e}function v(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function m(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){v(i,n,o,a,u,"next",t)}function u(t){v(i,n,o,a,u,"throw",t)}a(void 0)}))}}function b(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function g(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,x(n.key),n)}}function w(t,e,r){return e&&g(t.prototype,e),r&&g(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function x(t){var e=function(t){if("object"!=u(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==u(e)?e:e+""}function _(t,e,r){return e=O(e),function(t,e){if(e&&("object"==u(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,E()?Reflect.construct(e,r||[],O(t).constructor):e.apply(t,r))}function E(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(E=function(){return!!t})()}function O(t){return O=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},O(t)}function k(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&j(t,e)}function j(t,e){return j=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},j(t,e)}var S=function(t){function e(t){var r;if(b(this,e),r=_(this,e,[t]),Object.defineProperty(r,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(r,"examples",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(r,"exampleSelector",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(r,"examplePrompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(r,"suffix",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(r,"exampleSeparator",{enumerable:!0,configurable:!0,writable:!0,value:"\n\n"}),Object.defineProperty(r,"prefix",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(r,"templateFormat",{enumerable:!0,configurable:!0,writable:!0,value:"f-string"}),Object.defineProperty(r,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.assign(r,t),void 0!==r.examples&&void 0!==r.exampleSelector)throw new Error("Only one of 'examples' and 'example_selector' should be provided");if(void 0===r.examples&&void 0===r.exampleSelector)throw new Error("One of 'examples' and 'example_selector' should be provided");if(r.validateTemplate){var n=r.inputVariables;r.partialVariables&&(n=n.concat(Object.keys(r.partialVariables))),(0,o.Ns)(r.prefix+r.suffix,r.templateFormat,n)}return r}return k(e,t),w(e,[{key:"_getPromptType",value:function(){return"few_shot"}},{key:"getExamples",value:(u=m(y().mark((function t(e){return y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===this.examples){t.next=2;break}return t.abrupt("return",this.examples);case 2:if(void 0===this.exampleSelector){t.next=4;break}return t.abrupt("return",this.exampleSelector.selectExamples(e));case 4:throw new Error("One of 'examples' and 'example_selector' should be provided");case 5:case"end":return t.stop()}}),t,this)}))),function(t){return u.apply(this,arguments)})},{key:"partial",value:(a=m(y().mark((function t(r){var n,o,i,a;return y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=this.inputVariables.filter((function(t){return!(t in r)})),i=h(h({},null!==(n=this.partialVariables)&&void 0!==n?n:{}),r),a=h(h({},this),{},{inputVariables:o,partialVariables:i}),t.abrupt("return",new e(a));case 4:case"end":return t.stop()}}),t,this)}))),function(t){return a.apply(this,arguments)})},{key:"format",value:(n=m(y().mark((function t(e){var r,n,i,a,u=this;return y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.mergePartialAndUserVariables(e);case 2:return r=t.sent,t.next=5,this.getExamples(r);case 5:return n=t.sent,t.next=8,Promise.all(n.map((function(t){return u.examplePrompt.format(t)})));case 8:return i=t.sent,a=[this.prefix].concat(c(i),[this.suffix]).join(this.exampleSeparator),t.abrupt("return",(0,o.Xm)(a,this.templateFormat,r));case 11:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"serialize",value:function(){if(this.exampleSelector||!this.examples)throw new Error("Serializing an example selector is not currently supported");if(void 0!==this.outputParser)throw new Error("Serializing an output parser is not currently supported");return{_type:this._getPromptType(),input_variables:this.inputVariables,example_prompt:this.examplePrompt.serialize(),example_separator:this.exampleSeparator,suffix:this.suffix,prefix:this.prefix,template_format:this.templateFormat,examples:this.examples}}}],[{key:"lc_name",value:function(){return"FewShotPromptTemplate"}},{key:"deserialize",value:(r=m(y().mark((function t(r){var n,o,a;return y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=r.example_prompt){t.next=3;break}throw new Error("Missing example prompt");case 3:return t.next=5,i.PromptTemplate.deserialize(n);case 5:if(o=t.sent,!Array.isArray(r.examples)){t.next=10;break}a=r.examples,t.next=11;break;case 10:throw new Error("Invalid examples format. Only list or string are supported.");case 11:return t.abrupt("return",new e({inputVariables:r.input_variables,examplePrompt:o,examples:a,exampleSeparator:r.example_separator,prefix:r.prefix,suffix:r.suffix,templateFormat:r.template_format}));case 12:case"end":return t.stop()}}),t)}))),function(t){return r.apply(this,arguments)})}]);var r,n,a,u}(n.L),A=function(t){function e(t){var r,n,i,a,u,s;if(b(this,e),s=_(this,e,[t]),Object.defineProperty(s,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(s,"examples",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(s,"exampleSelector",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(s,"examplePrompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(s,"suffix",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(s,"exampleSeparator",{enumerable:!0,configurable:!0,writable:!0,value:"\n\n"}),Object.defineProperty(s,"prefix",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(s,"templateFormat",{enumerable:!0,configurable:!0,writable:!0,value:"f-string"}),Object.defineProperty(s,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),s.examples=t.examples,s.examplePrompt=t.examplePrompt,s.exampleSeparator=null!==(r=t.exampleSeparator)&&void 0!==r?r:"\n\n",s.exampleSelector=t.exampleSelector,s.prefix=null!==(n=t.prefix)&&void 0!==n?n:"",s.suffix=null!==(i=t.suffix)&&void 0!==i?i:"",s.templateFormat=null!==(a=t.templateFormat)&&void 0!==a?a:"f-string",s.validateTemplate=null===(u=t.validateTemplate)||void 0===u||u,void 0!==s.examples&&void 0!==s.exampleSelector)throw new Error("Only one of 'examples' and 'example_selector' should be provided");if(void 0===s.examples&&void 0===s.exampleSelector)throw new Error("One of 'examples' and 'example_selector' should be provided");if(s.validateTemplate){var c=s.inputVariables;s.partialVariables&&(c=c.concat(Object.keys(s.partialVariables))),(0,o.Ns)(s.prefix+s.suffix,s.templateFormat,c)}return s}return k(e,t),w(e,[{key:"_getPromptType",value:function(){return"few_shot_chat"}},{key:"getExamples",value:(a=m(y().mark((function t(e){return y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===this.examples){t.next=2;break}return t.abrupt("return",this.examples);case 2:if(void 0===this.exampleSelector){t.next=4;break}return t.abrupt("return",this.exampleSelector.selectExamples(e));case 4:throw new Error("One of 'examples' and 'example_selector' should be provided");case 5:case"end":return t.stop()}}),t,this)}))),function(t){return a.apply(this,arguments)})},{key:"formatMessages",value:(i=m(y().mark((function t(e){var r,n,o,i,a,u,l,f=this;return y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.mergePartialAndUserVariables(e);case 2:return r=t.sent,t.next=5,this.getExamples(r);case 5:n=(n=t.sent).map((function(t){var e={};return f.examplePrompt.inputVariables.forEach((function(r){e[r]=t[r]})),e})),o=[],i=s(n),t.prev=9,i.s();case 11:if((a=i.n()).done){t.next=19;break}return u=a.value,t.next=15,this.examplePrompt.formatMessages(u);case 15:l=t.sent,o.push.apply(o,c(l));case 17:t.next=11;break;case 19:t.next=24;break;case 21:t.prev=21,t.t0=t.catch(9),i.e(t.t0);case 24:return t.prev=24,i.f(),t.finish(24);case 27:return t.abrupt("return",o);case 28:case"end":return t.stop()}}),t,this,[[9,21,24,27]])}))),function(t){return i.apply(this,arguments)})},{key:"format",value:(n=m(y().mark((function t(e){var r,n,i,a,u,s=this;return y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.mergePartialAndUserVariables(e);case 2:return r=t.sent,t.next=5,this.getExamples(r);case 5:return n=t.sent,t.next=8,Promise.all(n.map((function(t){return s.examplePrompt.formatMessages(t)})));case 8:return i=t.sent,a=i.flat().map((function(t){return t.content})),u=[this.prefix].concat(c(a),[this.suffix]).join(this.exampleSeparator),t.abrupt("return",(0,o.Xm)(u,this.templateFormat,r));case 12:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"partial",value:(r=m(y().mark((function t(r){var n,o,i,a;return y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=this.inputVariables.filter((function(t){return!(t in r)})),i=h(h({},null!==(n=this.partialVariables)&&void 0!==n?n:{}),r),a=h(h({},this),{},{inputVariables:o,partialVariables:i}),t.abrupt("return",new e(a));case 4:case"end":return t.stop()}}),t,this)}))),function(t){return r.apply(this,arguments)})}],[{key:"lc_name",value:function(){return"FewShotChatMessagePromptTemplate"}}]);var r,n,i,a}(a.qF)},2610:(t,e,r)=>{"use strict";r.d(e,{C:()=>w});var n=r(4238),o=r(6106),i=r(1754);function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function u(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],s=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);s=!0);}catch(t){c=!0,o=t}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(t,e)||function(t,e){if(t){if("string"==typeof t)return s(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function c(){c=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},u=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",l=i.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,r){return t[e]=r}}function p(t,e,r,n){var i=e&&e.prototype instanceof g?e:g,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:A(t,r,u)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=p;var d="suspendedStart",y="suspendedYield",v="executing",m="completed",b={};function g(){}function w(){}function x(){}var _={};f(_,u,(function(){return this}));var E=Object.getPrototypeOf,O=E&&E(E(T([])));O&&O!==r&&n.call(O,u)&&(_=O);var k=x.prototype=g.prototype=Object.create(_);function j(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,u,s){var c=h(t[o],t,i);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==a(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,u,s)}),(function(t){r("throw",t,u,s)})):e.resolve(f).then((function(t){l.value=t,u(l)}),(function(t){return r("throw",t,u,s)}))}s(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function A(e,r,n){var o=d;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=D(u,n);if(s){if(s===b)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var c=h(e,r,n);if("normal"===c.type){if(o=n.done?m:y,c.arg===b)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=m,n.method="throw",n.arg=c.arg)}}}function D(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,D(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,b;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,b):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,b)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[u];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(a(e)+" is not iterable")}return w.prototype=x,o(k,"constructor",{value:x,configurable:!0}),o(x,"constructor",{value:w,configurable:!0}),w.displayName=f(x,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,f(t,l,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},j(S.prototype),f(S.prototype,s,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(p(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},j(k),f(k,l,"Generator"),f(k,u,(function(){return this})),f(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,b):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),C(r),b}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;C(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),b}},e}function l(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function f(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?l(Object(r),!0).forEach((function(e){p(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function p(t,e,r){return(e=v(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function h(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function d(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){h(i,n,o,a,u,"next",t)}function u(t){h(i,n,o,a,u,"throw",t)}a(void 0)}))}}function y(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,v(n.key),n)}}function v(t){var e=function(t){if("object"!=a(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==a(e)?e:e+""}function m(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(m=function(){return!!t})()}function b(t){return b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},b(t)}function g(t,e){return g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},g(t,e)}var w=function(t){function e(t){var r,n,o;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=function(t,e,r){return e=b(e),function(t,e){if(e&&("object"==a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,m()?Reflect.construct(e,r||[],b(t).constructor):e.apply(t,r))}(this,e,[t]),Object.defineProperty(o,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompts","image"]}),Object.defineProperty(o,"template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(o,"templateFormat",{enumerable:!0,configurable:!0,writable:!0,value:"f-string"}),Object.defineProperty(o,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(o,"additionalContentFields",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),o.template=t.template,o.templateFormat=null!==(r=t.templateFormat)&&void 0!==r?r:o.templateFormat,o.validateTemplate=null!==(n=t.validateTemplate)&&void 0!==n?n:o.validateTemplate,o.additionalContentFields=t.additionalContentFields,o.validateTemplate){var u=o.inputVariables;o.partialVariables&&(u=u.concat(Object.keys(o.partialVariables))),(0,i.Ns)([{type:"image_url",image_url:o.template}],o.templateFormat,u)}return o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&g(t,e)}(e,t),r=e,o=[{key:"_getPromptType",value:function(){return"prompt"}},{key:"partial",value:(h=d(c().mark((function t(r){var n,o,i,a;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=this.inputVariables.filter((function(t){return!(t in r)})),i=f(f({},null!==(n=this.partialVariables)&&void 0!==n?n:{}),r),a=f(f({},this),{},{inputVariables:o,partialVariables:i}),t.abrupt("return",new e(a));case 4:case"end":return t.stop()}}),t,this)}))),function(t){return h.apply(this,arguments)})},{key:"format",value:(p=d(c().mark((function t(e){var r,n,o,a,s,l,f,p,h;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(r={},n=0,o=Object.entries(this.template);n<o.length;n++)a=u(o[n],2),s=a[0],l=a[1],r[s]="string"==typeof l?(0,i.Xm)(l,this.templateFormat,e):l;if(f=e.url||r.url,p=e.detail||r.detail,f){t.next=6;break}throw new Error("Must provide either an image URL.");case 6:if("string"==typeof f){t.next=8;break}throw new Error("url must be a string.");case 8:return h={url:f},p&&(h.detail=p),t.abrupt("return",h);case 11:case"end":return t.stop()}}),t,this)}))),function(t){return p.apply(this,arguments)})},{key:"formatPromptValue",value:(l=d(c().mark((function t(e){var r;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.format(e);case 2:return r=t.sent,t.abrupt("return",new n.vX(r));case 4:case"end":return t.stop()}}),t,this)}))),function(t){return l.apply(this,arguments)})}],s=[{key:"lc_name",value:function(){return"ImagePromptTemplate"}}],o&&y(r.prototype,o),s&&y(r,s),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,o,s,l,p,h}(o.m)},6917:(t,e,r)=>{"use strict";r.r(e),r.d(e,{PromptTemplate:()=>w});var n=r(4150),o=r(1754);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}var a=["templateFormat"];function u(t){return function(t){if(Array.isArray(t))return s(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return s(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function c(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function l(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?c(Object(r),!0).forEach((function(e){f(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function f(t,e,r){return(e=v(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function p(){p=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},u=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function f(t,e,r,n){var i=e&&e.prototype instanceof g?e:g,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:A(t,r,u)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=f;var d="suspendedStart",y="suspendedYield",v="executing",m="completed",b={};function g(){}function w(){}function x(){}var _={};l(_,u,(function(){return this}));var E=Object.getPrototypeOf,O=E&&E(E(T([])));O&&O!==r&&n.call(O,u)&&(_=O);var k=x.prototype=g.prototype=Object.create(_);function j(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,a,u,s){var c=h(t[o],t,a);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==i(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,u,s)}),(function(t){r("throw",t,u,s)})):e.resolve(f).then((function(t){l.value=t,u(l)}),(function(t){return r("throw",t,u,s)}))}s(c.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function A(e,r,n){var o=d;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=D(u,n);if(s){if(s===b)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var c=h(e,r,n);if("normal"===c.type){if(o=n.done?m:y,c.arg===b)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=m,n.method="throw",n.arg=c.arg)}}}function D(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,D(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,b;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,b):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,b)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[u];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(i(e)+" is not iterable")}return w.prototype=x,o(k,"constructor",{value:x,configurable:!0}),o(x,"constructor",{value:w,configurable:!0}),w.displayName=l(x,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,l(t,c,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},j(S.prototype),l(S.prototype,s,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(f(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},j(k),l(k,c,"Generator"),l(k,u,(function(){return this})),l(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,b):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),C(r),b}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;C(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),b}},e}function h(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function d(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){h(i,n,o,a,u,"next",t)}function u(t){h(i,n,o,a,u,"throw",t)}a(void 0)}))}}function y(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,v(n.key),n)}}function v(t){var e=function(t){if("object"!=i(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==i(e)?e:e+""}function m(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(m=function(){return!!t})()}function b(t){return b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},b(t)}function g(t,e){return g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},g(t,e)}var w=function(t){function e(t){var r;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=function(t,e,r){return e=b(e),function(t,e){if(e&&("object"==i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,m()?Reflect.construct(e,r||[],b(t).constructor):e.apply(t,r))}(this,e,[t]),Object.defineProperty(r,"template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(r,"templateFormat",{enumerable:!0,configurable:!0,writable:!0,value:"f-string"}),Object.defineProperty(r,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(r,"additionalContentFields",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),"mustache"===t.templateFormat&&void 0===t.validateTemplate&&(r.validateTemplate=!1),Object.assign(r,t),r.validateTemplate){if("mustache"===r.templateFormat)throw new Error("Mustache templates cannot be validated.");var n=r.inputVariables;r.partialVariables&&(n=n.concat(Object.keys(r.partialVariables))),(0,o.Ns)(r.template,r.templateFormat,n)}return r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&g(t,e)}(e,t),r=e,n=[{key:"_getPromptType",value:function(){return"prompt"}},{key:"format",value:(h=d(p().mark((function t(e){var r;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.mergePartialAndUserVariables(e);case 2:return r=t.sent,t.abrupt("return",(0,o.Xm)(this.template,this.templateFormat,r));case 4:case"end":return t.stop()}}),t,this)}))),function(t){return h.apply(this,arguments)})},{key:"partial",value:(f=d(p().mark((function t(r){var n,o,i,a;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=this.inputVariables.filter((function(t){return!(t in r)})),i=l(l({},null!==(n=this.partialVariables)&&void 0!==n?n:{}),r),a=l(l({},this),{},{inputVariables:o,partialVariables:i}),t.abrupt("return",new e(a));case 4:case"end":return t.stop()}}),t,this)}))),function(t){return f.apply(this,arguments)})},{key:"serialize",value:function(){if(void 0!==this.outputParser)throw new Error("Cannot serialize a prompt template with an output parser");return{_type:this._getPromptType(),input_variables:this.inputVariables,template:this.template,template_format:this.templateFormat}}}],s=[{key:"lc_name",value:function(){return"PromptTemplate"}},{key:"fromExamples",value:function(t,r,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"\n\n";return new e({inputVariables:n,template:[arguments.length>4&&void 0!==arguments[4]?arguments[4]:""].concat(u(t),[r]).join(o)})}},{key:"fromTemplate",value:function(t,r){var n=null!=r?r:{},i=n.templateFormat,s=void 0===i?"f-string":i,c=function(t,e){if(null==t)return{};var r,n,o=function(t,e){if(null==t)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.includes(n))continue;r[n]=t[n]}return r}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.includes(r)||{}.propertyIsEnumerable.call(t,r)&&(o[r]=t[r])}return o}(n,a),f=new Set;return(0,o.QC)(t,s).forEach((function(t){"variable"===t.type&&f.add(t.name)})),new e(l({inputVariables:u(f),templateFormat:s,template:t},c))}},{key:"deserialize",value:(c=d(p().mark((function t(r){var n;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r.template){t.next=2;break}throw new Error("Prompt template must have a template");case 2:return n=new e({inputVariables:r.input_variables,template:r.template,templateFormat:r.template_format}),t.abrupt("return",n);case 4:case"end":return t.stop()}}),t)}))),function(t){return c.apply(this,arguments)})}],n&&y(r.prototype,n),s&&y(r,s),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,s,c,f,h}(n.L)},4150:(t,e,r)=>{"use strict";r.d(e,{L:()=>p});var n=r(4238);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function i(){i=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,a=Object.defineProperty||function(t,e,r){t[e]=r.value},u="function"==typeof Symbol?Symbol:{},s=u.iterator||"@@iterator",c=u.asyncIterator||"@@asyncIterator",l=u.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,r){return t[e]=r}}function p(t,e,r,n){var o=e&&e.prototype instanceof g?e:g,i=Object.create(o.prototype),u=new L(n||[]);return a(i,"_invoke",{value:A(t,r,u)}),i}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=p;var d="suspendedStart",y="suspendedYield",v="executing",m="completed",b={};function g(){}function w(){}function x(){}var _={};f(_,s,(function(){return this}));var E=Object.getPrototypeOf,O=E&&E(E(T([])));O&&O!==r&&n.call(O,s)&&(_=O);var k=x.prototype=g.prototype=Object.create(_);function j(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(i,a,u,s){var c=h(t[i],t,a);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==o(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,u,s)}),(function(t){r("throw",t,u,s)})):e.resolve(f).then((function(t){l.value=t,u(l)}),(function(t){return r("throw",t,u,s)}))}s(c.arg)}var i;a(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function A(e,r,n){var o=d;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=D(u,n);if(s){if(s===b)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var c=h(e,r,n);if("normal"===c.type){if(o=n.done?m:y,c.arg===b)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=m,n.method="throw",n.arg=c.arg)}}}function D(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,D(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,b;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,b):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,b)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[s];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,a=function r(){for(;++i<e.length;)if(n.call(e,i))return r.value=e[i],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(o(e)+" is not iterable")}return w.prototype=x,a(k,"constructor",{value:x,configurable:!0}),a(x,"constructor",{value:w,configurable:!0}),w.displayName=f(x,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,f(t,l,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},j(S.prototype),f(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(p(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},j(k),f(k,l,"Generator"),f(k,s,(function(){return this})),f(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,b):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),C(r),b}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;C(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),b}},e}function a(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function u(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,s(n.key),n)}}function s(t){var e=function(t){if("object"!=o(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==o(e)?e:e+""}function c(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(c=function(){return!!t})()}function l(t){return l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},l(t)}function f(t,e){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},f(t,e)}var p=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=l(e),function(t,e){if(e&&("object"==o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,c()?Reflect.construct(e,r||[],l(t).constructor):e.apply(t,r))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&f(t,e)}(e,t),r=e,s=[{key:"formatPromptValue",value:(p=i().mark((function t(e){var r;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.format(e);case 2:return r=t.sent,t.abrupt("return",new n.HY(r));case 4:case"end":return t.stop()}}),t,this)})),h=function(){var t=this,e=arguments;return new Promise((function(r,n){var o=p.apply(t,e);function i(t){a(o,r,n,i,u,"next",t)}function u(t){a(o,r,n,i,u,"throw",t)}i(void 0)}))},function(t){return h.apply(this,arguments)})}],s&&u(r.prototype,s),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,s,p,h}(r(6106).m)},1754:(t,e,r)=>{"use strict";r.d(e,{Ns:()=>D,D4:()=>E,g2:()=>O,QC:()=>A,Xm:()=>S});var n=Object.prototype.toString,o=Array.isArray||function(t){return"[object Array]"===n.call(t)};function i(t){return"function"==typeof t}function a(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function u(t,e){return null!=t&&"object"==typeof t&&e in t}var s=RegExp.prototype.test,c=/\S/;var l={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},f=/\s*/,p=/\s+/,h=/\s*=/,d=/\s*\}/,y=/#|\^|\/|>|\{|&|=|!/;function v(t){this.string=t,this.tail=t,this.pos=0}function m(t,e){this.view=t,this.cache={".":this.view},this.parent=e}function b(){this.templateCache={_cache:{},set:function(t,e){this._cache[t]=e},get:function(t){return this._cache[t]},clear:function(){this._cache={}}}}v.prototype.eos=function(){return""===this.tail},v.prototype.scan=function(t){var e=this.tail.match(t);if(!e||0!==e.index)return"";var r=e[0];return this.tail=this.tail.substring(r.length),this.pos+=r.length,r},v.prototype.scanUntil=function(t){var e,r=this.tail.search(t);switch(r){case-1:e=this.tail,this.tail="";break;case 0:e="";break;default:e=this.tail.substring(0,r),this.tail=this.tail.substring(r)}return this.pos+=e.length,e},m.prototype.push=function(t){return new m(t,this)},m.prototype.lookup=function(t){var e,r,n,o=this.cache;if(o.hasOwnProperty(t))e=o[t];else{for(var a,s,c,l=this,f=!1;l;){if(t.indexOf(".")>0)for(a=l.view,s=t.split("."),c=0;null!=a&&c<s.length;)c===s.length-1&&(f=u(a,s[c])||(r=a,n=s[c],null!=r&&"object"!=typeof r&&r.hasOwnProperty&&r.hasOwnProperty(n))),a=a[s[c++]];else a=l.view[t],f=u(l.view,t);if(f){e=a;break}l=l.parent}o[t]=e}return i(e)&&(e=e.call(this.view)),e},b.prototype.clearCache=function(){void 0!==this.templateCache&&this.templateCache.clear()},b.prototype.parse=function(t,e){var r=this.templateCache,n=t+":"+(e||g.tags).join(":"),i=void 0!==r,u=i?r.get(n):void 0;return null==u&&(u=function(t,e){if(!t)return[];var r,n,i,u,l=!1,m=[],b=[],w=[],x=!1,_=!1,E="",O=0;function k(){if(x&&!_)for(;w.length;)delete b[w.pop()];else w=[];x=!1,_=!1}function j(t){if("string"==typeof t&&(t=t.split(p,2)),!o(t)||2!==t.length)throw new Error("Invalid tags: "+t);r=new RegExp(a(t[0])+"\\s*"),n=new RegExp("\\s*"+a(t[1])),i=new RegExp("\\s*"+a("}"+t[1]))}j(e||g.tags);for(var S,A,D,P,C,L,T=new v(t);!T.eos();){if(S=T.pos,D=T.scanUntil(r))for(var F=0,I=D.length;F<I;++F)u=P=D.charAt(F),function(t,e){return s.call(t,e)}(c,u)?(_=!0,l=!0,E+=" "):(w.push(b.length),E+=P),b.push(["text",P,S,S+1]),S+=1,"\n"===P&&(k(),E="",O=0,l=!1);if(!T.scan(r))break;if(x=!0,A=T.scan(y)||"name",T.scan(f),"="===A?(D=T.scanUntil(h),T.scan(h),T.scanUntil(n)):"{"===A?(D=T.scanUntil(i),T.scan(d),T.scanUntil(n),A="&"):D=T.scanUntil(n),!T.scan(n))throw new Error("Unclosed tag at "+T.pos);if(C=">"==A?[A,D,S,T.pos,E,O,l]:[A,D,S,T.pos],O++,b.push(C),"#"===A||"^"===A)m.push(C);else if("/"===A){if(!(L=m.pop()))throw new Error('Unopened section "'+D+'" at '+S);if(L[1]!==D)throw new Error('Unclosed section "'+L[1]+'" at '+S)}else"name"===A||"{"===A||"&"===A?_=!0:"="===A&&j(D)}if(k(),L=m.pop())throw new Error('Unclosed section "'+L[1]+'" at '+T.pos);return function(t){for(var e,r=[],n=r,o=[],i=0,a=t.length;i<a;++i)switch((e=t[i])[0]){case"#":case"^":n.push(e),o.push(e),n=e[4]=[];break;case"/":o.pop()[5]=e[2],n=o.length>0?o[o.length-1][4]:r;break;default:n.push(e)}return r}(function(t){for(var e,r,n=[],o=0,i=t.length;o<i;++o)(e=t[o])&&("text"===e[0]&&r&&"text"===r[0]?(r[1]+=e[1],r[3]=e[3]):(n.push(e),r=e));return n}(b))}(t,e),i&&r.set(n,u)),u},b.prototype.render=function(t,e,r,n){var o=this.getConfigTags(n),i=this.parse(t,o),a=e instanceof m?e:new m(e,void 0);return this.renderTokens(i,a,r,t,n)},b.prototype.renderTokens=function(t,e,r,n,o){for(var i,a,u,s="",c=0,l=t.length;c<l;++c)u=void 0,"#"===(a=(i=t[c])[0])?u=this.renderSection(i,e,r,n,o):"^"===a?u=this.renderInverted(i,e,r,n,o):">"===a?u=this.renderPartial(i,e,r,o):"&"===a?u=this.unescapedValue(i,e):"name"===a?u=this.escapedValue(i,e,o):"text"===a&&(u=this.rawValue(i)),void 0!==u&&(s+=u);return s},b.prototype.renderSection=function(t,e,r,n,a){var u=this,s="",c=e.lookup(t[1]);if(c){if(o(c))for(var l=0,f=c.length;l<f;++l)s+=this.renderTokens(t[4],e.push(c[l]),r,n,a);else if("object"==typeof c||"string"==typeof c||"number"==typeof c)s+=this.renderTokens(t[4],e.push(c),r,n,a);else if(i(c)){if("string"!=typeof n)throw new Error("Cannot use higher-order sections without the original template");null!=(c=c.call(e.view,n.slice(t[3],t[5]),(function(t){return u.render(t,e,r,a)})))&&(s+=c)}else s+=this.renderTokens(t[4],e,r,n,a);return s}},b.prototype.renderInverted=function(t,e,r,n,i){var a=e.lookup(t[1]);if(!a||o(a)&&0===a.length)return this.renderTokens(t[4],e,r,n,i)},b.prototype.indentPartial=function(t,e,r){for(var n=e.replace(/[^ \t]/g,""),o=t.split("\n"),i=0;i<o.length;i++)o[i].length&&(i>0||!r)&&(o[i]=n+o[i]);return o.join("\n")},b.prototype.renderPartial=function(t,e,r,n){if(r){var o=this.getConfigTags(n),a=i(r)?r(t[1]):r[t[1]];if(null!=a){var u=t[6],s=t[5],c=t[4],l=a;0==s&&c&&(l=this.indentPartial(a,c,u));var f=this.parse(l,o);return this.renderTokens(f,e,r,l,n)}}},b.prototype.unescapedValue=function(t,e){var r=e.lookup(t[1]);if(null!=r)return r},b.prototype.escapedValue=function(t,e,r){var n=this.getConfigEscape(r)||g.escape,o=e.lookup(t[1]);if(null!=o)return"number"==typeof o&&n===g.escape?String(o):n(o)},b.prototype.rawValue=function(t){return t[1]},b.prototype.getConfigTags=function(t){return o(t)?t:t&&"object"==typeof t?t.tags:void 0},b.prototype.getConfigEscape=function(t){return t&&"object"==typeof t&&!o(t)?t.escape:void 0};var g={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(t){w.templateCache=t},get templateCache(){return w.templateCache}},w=new b;g.clearCache=function(){return w.clearCache()},g.parse=function(t,e){return w.parse(t,e)},g.render=function(t,e,r,n){if("string"!=typeof t)throw new TypeError('Invalid template! Template should be a "string" but "'+(o(i=t)?"array":typeof i)+'" was given as the first argument for mustache#render(template, view, partials)');var i;return w.render(t,e,r,n)},g.escape=function(t){return String(t).replace(/[&<>"'`=\/]/g,(function(t){return l[t]}))},g.Scanner=v,g.Context=m,g.Writer=b;const x=g;function _(){x.escape=function(t){return t}}var E=function(t){for(var e=t.split(""),r=[],n=function(t,r){for(var n=r;n<e.length;n+=1)if(t.includes(e[n]))return n;return-1},o=0;o<e.length;)if("{"===e[o]&&o+1<e.length&&"{"===e[o+1])r.push({type:"literal",text:"{"}),o+=2;else if("}"===e[o]&&o+1<e.length&&"}"===e[o+1])r.push({type:"literal",text:"}"}),o+=2;else if("{"===e[o]){var i=n("}",o);if(i<0)throw new Error("Unclosed '{' in template.");r.push({type:"variable",name:e.slice(o+1,i).join("")}),o=i+1}else{if("}"===e[o])throw new Error("Single '}' in template.");var a=n("{}",o),u=(a<0?e.slice(o):e.slice(o,a)).join("");r.push({type:"literal",text:u}),o=a<0?e.length:a}return r},O=function(t){return _(),function(t){return t.map((function(t){return"name"===t[0]?{type:"variable",name:t[1].includes(".")?t[1].split(".")[0]:t[1]}:["#","&","^",">"].includes(t[0])?{type:"variable",name:t[1]}:{type:"literal",text:t[1]}}))}(x.parse(t))},k={"f-string":function(t,e){return E(t).reduce((function(t,r){if("variable"===r.type){if(r.name in e)return t+e[r.name];throw new Error("(f-string) Missing value for input ".concat(r.name))}return t+r.text}),"")},mustache:function(t,e){return _(),x.render(t,e)}},j={"f-string":E,mustache:O},S=function(t,e,r){return k[e](t,r)},A=function(t,e){return j[e](t)},D=function(t,e,r){if(!(e in k)){var n=Object.keys(k);throw new Error("Invalid template format. Got `".concat(e,"`;\n                         should be one of ").concat(n))}try{var o=r.reduce((function(t,e){return t[e]="foo",t}),{});Array.isArray(t)?t.forEach((function(t){if("text"===t.type)S(t.text,e,o);else{if("image_url"!==t.type)throw new Error("Invalid message template received. ".concat(JSON.stringify(t,null,2)));if("string"==typeof t.image_url)S(t.image_url,e,o);else{var r=t.image_url.url;S(r,e,o)}}})):S(t,e,o)}catch(t){throw new Error("Invalid prompt schema: ".concat(t.message))}}},7889:(t,e,r)=>{"use strict";r.d(e,{YN:()=>ne,B2:()=>he,jY:()=>le,ck:()=>se,zZ:()=>ue});var n=r(4476),o=r(1461),i=r(6963),a=r(8956),u=r(7247),s=r(1041),c=r(4865),l=r(2613),f=r(8589),p=r(1974),h=r(6463);function d(t){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d(t)}function y(){y=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof g?e:g,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:A(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",v="executing",m="completed",b={};function g(){}function w(){}function x(){}var _={};c(_,a,(function(){return this}));var E=Object.getPrototypeOf,O=E&&E(E(T([])));O&&O!==r&&n.call(O,a)&&(_=O);var k=x.prototype=g.prototype=Object.create(_);function j(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,u){var s=f(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==d(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function A(e,r,n){var o=p;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=D(u,n);if(s){if(s===b)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?m:h,c.arg===b)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=m,n.method="throw",n.arg=c.arg)}}}function D(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,D(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,b;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,b):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,b)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(d(e)+" is not iterable")}return w.prototype=x,o(k,"constructor",{value:x,configurable:!0}),o(x,"constructor",{value:w,configurable:!0}),w.displayName=c(x,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,c(t,s,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},j(S.prototype),c(S.prototype,u,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},j(k),c(k,s,"Generator"),c(k,a,(function(){return this})),c(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,b):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),C(r),b}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;C(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),b}},e}function v(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function m(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){v(i,n,o,a,u,"next",t)}function u(t){v(i,n,o,a,u,"throw",t)}a(void 0)}))}}function b(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,g(n.key),n)}}function g(t){var e=function(t){if("object"!=d(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=d(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==d(e)?e:e+""}function w(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(w=function(){return!!t})()}function x(t){return x=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},x(t)}function _(t,e){return _=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_(t,e)}var E=function(t){function e(t){var r,n=t.config,o=t.onStart,i=t.onEnd,a=t.onError;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=function(t,e,r){return e=x(e),function(t,e){if(e&&("object"==d(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,w()?Reflect.construct(e,r||[],x(t).constructor):e.apply(t,r))}(this,e,[{_awaitHandler:!0}]),Object.defineProperty(r,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RootListenersTracer"}),Object.defineProperty(r,"rootId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(r,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(r,"argOnStart",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(r,"argOnEnd",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(r,"argOnError",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),r.config=n,r.argOnStart=o,r.argOnEnd=i,r.argOnError=a,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_(t,e)}(e,t),r=e,n=[{key:"persistRun",value:function(t){return Promise.resolve()}},{key:"onRunCreate",value:(i=m(y().mark((function t(e){return y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.rootId){t.next=2;break}return t.abrupt("return");case 2:if(this.rootId=e.id,!this.argOnStart){t.next=12;break}if(1!==this.argOnStart.length){t.next=9;break}return t.next=7,this.argOnStart(e);case 7:t.next=12;break;case 9:if(2!==this.argOnStart.length){t.next=12;break}return t.next=12,this.argOnStart(e,this.config);case 12:case"end":return t.stop()}}),t,this)}))),function(t){return i.apply(this,arguments)})},{key:"onRunUpdate",value:(o=m(y().mark((function t(e){return y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.id===this.rootId){t.next=2;break}return t.abrupt("return");case 2:if(e.error){t.next=14;break}if(!this.argOnEnd){t.next=12;break}if(1!==this.argOnEnd.length){t.next=9;break}return t.next=7,this.argOnEnd(e);case 7:t.next=12;break;case 9:if(2!==this.argOnEnd.length){t.next=12;break}return t.next=12,this.argOnEnd(e,this.config);case 12:case 18:t.next=23;break;case 14:if(!this.argOnError){t.next=23;break}if(1!==this.argOnError.length){t.next=20;break}return t.next=18,this.argOnError(e);case 20:if(2!==this.argOnError.length){t.next=23;break}return t.next=23,this.argOnError(e,this.config);case 23:case"end":return t.stop()}}),t,this)}))),function(t){return o.apply(this,arguments)})}],n&&b(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o,i}(r(4277).J);function O(t){return O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},O(t)}function k(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,j(n.key),n)}}function j(t){var e=function(t){if("object"!=O(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=O(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==O(e)?e:e+""}function S(t){return!!t&&t.lc_runnable}var A=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.includeNames=e.includeNames,this.includeTypes=e.includeTypes,this.includeTags=e.includeTags,this.excludeNames=e.excludeNames,this.excludeTypes=e.excludeTypes,this.excludeTags=e.excludeTags},(e=[{key:"includeEvent",value:function(t,e){var r,n=this,o=void 0===this.includeNames&&void 0===this.includeTypes&&void 0===this.includeTags,i=null!==(r=t.tags)&&void 0!==r?r:[];return void 0!==this.includeNames&&(o=o||this.includeNames.includes(t.name)),void 0!==this.includeTypes&&(o=o||this.includeTypes.includes(e)),void 0!==this.includeTags&&(o=o||i.some((function(t){var e;return null===(e=n.includeTags)||void 0===e?void 0:e.includes(t)}))),void 0!==this.excludeNames&&(o=o&&!this.excludeNames.includes(t.name)),void 0!==this.excludeTypes&&(o=o&&!this.excludeTypes.includes(e)),void 0!==this.excludeTags&&(o=o&&i.every((function(t){var e;return!(null!==(e=n.excludeTags)&&void 0!==e&&e.includes(t))}))),o}}])&&k(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}(),D=r(2782),P=r(1236),C=r(7622);function L(t){return L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},L(t)}function T(){T=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new P(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function b(){}function g(){}var w={};c(w,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(w=_);var E=g.prototype=m.prototype=Object.create(w);function O(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,i,a,u){var s=f(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==L(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=S(u,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?y:h,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=y,n.method="throw",n.arg=c.arg)}}}function S(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,S(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function C(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(L(e)+" is not iterable")}return b.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=c(g,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,c(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},O(k.prototype),c(k.prototype,u,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(E),c(E,s,"Generator"),c(E,a,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=C,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),D(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;D(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:C(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function F(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function I(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],s=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);s=!0);}catch(t){c=!0,o=t}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(t,e)||N(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function N(t,e){if(t){if("string"==typeof t)return R(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?R(t,e):void 0}}function R(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function M(t){return t.replace(/[^a-zA-Z-_0-9]/g,"_")}function B(t,e){var r,n;return[null!==(r=e[t.source])&&void 0!==r?r:t.source,null!==(n=e[t.target])&&void 0!==n?n:t.target]}function G(t,e,r){var n,o,i,a=null!=r?r:{},u=a.firstNodeLabel,s=a.lastNodeLabel,c=a.nodeColors,l=a.withStyles,f=void 0===l||l,p=a.curveStyle,h=void 0===p?"linear":p,d=a.wrapLabelNWords,y=void 0===d?9:d,v=f?"%%{init: {'flowchart': {'curve': '".concat(h,"'}}}%%\ngraph TD;\n"):"graph TD;\n";if(f){var m="default",b=(n={},i="{0}([{1}]):::otherclass",(o=function(t){var e=function(t){if("object"!=L(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=L(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==L(e)?e:e+""}(o=m))in n?Object.defineProperty(n,o,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[o]=i,n);void 0!==u&&(b[u]="{0}[{0}]:::startclass"),void 0!==s&&(b[s]="{0}[{0}]:::endclass");for(var g=0,w=Object.values(t);g<w.length;g++){var x,_=w[g],E=null!==(x=b[_])&&void 0!==x?x:b[m],O=M(_),k=_.split(":"),j=k[k.length-1];v+="\t".concat(E.replace(/\{0\}/g,O).replace(/\{1\}/g,j),";\n")}}var S,A="",D=function(t){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=N(t))){e&&(t=e);var r=0,n=function(){};return{s:n,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,a=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return i=t.done,t},e:function(t){a=!0,o=t},f:function(){try{i||null==e.return||e.return()}finally{if(a)throw o}}}}(e);try{for(D.s();!(S=D.n()).done;){var P=S.value,C=P.source.includes(":")?P.source.split(":")[0]:void 0,T=P.target.includes(":")?P.target.split(":")[0]:void 0;""===A||A===C&&A===T||(v+="\tend\n",A=""),""===A&&void 0!==C&&C===T&&(v="\tsubgraph ".concat(C,"\n"),A=C);var F=I(B(P,t),2),R=F[0],G=F[1],U="";if(void 0!==P.data){var z=P.data,$=z.split(" ");$.length>y&&(z=$.reduce((function(t,e,r){return r%y==0&&t.push(""),t[t.length-1]+=" ".concat(e),t}),[]).join("<br>")),U=P.conditional?" -. ".concat(z," .-> "):" -- ".concat(z," --\x3e ")}else U=P.conditional?" -.-> ":" --\x3e ";v+="\t".concat(M(R)).concat(U).concat(M(G),";\n")}}catch(t){D.e(t)}finally{D.f()}return""!==A&&(v+="end\n"),f&&void 0!==c&&(v+=function(t){for(var e="",r=0,n=Object.entries(t);r<n.length;r++){var o=I(n[r],2),i=o[0],a=o[1];e+="\tclassDef ".concat(i,"class fill:").concat(a,";\n")}return e}(c)),v}function U(t,e){return z.apply(this,arguments)}function z(){var t;return t=T().mark((function t(e,r){var n,o,i,a,u,s;return T().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=(null!=r?r:{}).backgroundColor,o=void 0===n?"white":n,i=btoa(e),void 0!==o&&(/^#(?:[0-9a-fA-F]{3}){1,2}$/.test(o)||(o="!".concat(o))),a="https://mermaid.ink/img/".concat(i,"?bgColor=").concat(o),t.next=6,fetch(a);case 6:if((u=t.sent).ok){t.next=9;break}throw new Error(["Failed to render the graph using the Mermaid.INK API.","Status code: ".concat(u.status),"Status text: ".concat(u.statusText)].join("\n"));case 9:return t.next=11,u.blob();case 11:return s=t.sent,t.abrupt("return",s);case 13:case"end":return t.stop()}}),t)})),z=function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){F(i,n,o,a,u,"next",t)}function u(t){F(i,n,o,a,u,"throw",t)}a(void 0)}))},z.apply(this,arguments)}function $(t){return $="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$(t)}function q(){q=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new P(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function b(){}function g(){}var w={};c(w,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(w=_);var E=g.prototype=m.prototype=Object.create(w);function O(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,i,a,u){var s=f(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==$(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=S(u,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?y:h,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=y,n.method="throw",n.arg=c.arg)}}}function S(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,S(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function C(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError($(e)+" is not iterable")}return b.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=c(g,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,c(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},O(k.prototype),c(k.prototype,u,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(E),c(E,s,"Generator"),c(E,a,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=C,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),D(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;D(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:C(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function K(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function H(t){return function(t){if(Array.isArray(t))return Y(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Z(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Z(t,e){if(t){if("string"==typeof t)return Y(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Y(t,e):void 0}}function Y(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function V(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Q(n.key),n)}}function W(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function J(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?W(Object(r),!0).forEach((function(e){X(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):W(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function X(t,e,r){return(e=Q(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Q(t){var e=function(t){if("object"!=$(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=$(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==$(e)?e:e+""}function tt(t){if(!(0,C.A)(t.id))return t.id;var e;if(!S(t.data))return null!==(e=t.data.name)&&void 0!==e?e:"UnknownSchema";try{var r=t.data.getName();return(r=r.startsWith("Runnable")?r.slice(8):r).length>42&&(r="".concat(r.substring(0,42),"...")),r}catch(e){return t.data.getName()}}var et=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Object.defineProperty(this,"nodes",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"edges",{enumerable:!0,configurable:!0,writable:!0,value:[]})},e=[{key:"toJSON",value:function(){var t={};return Object.values(this.nodes).forEach((function(e,r){t[e.id]=(0,C.A)(e.id)?r:e.id})),{nodes:Object.values(this.nodes).map((function(e){return J({id:t[e.id]},function(t){return S(t.data)?{type:"runnable",data:{id:t.data.lc_id,name:t.data.getName()}}:{type:"schema",data:J(J({},(0,P.Ik)(t.data.schema)),{},{title:t.data.name})}}(e))})),edges:this.edges.map((function(e){var r={source:t[e.source],target:t[e.target]};return void 0!==e.data&&(r.data=e.data),void 0!==e.conditional&&(r.conditional=e.conditional),r}))}}},{key:"addNode",value:function(t,e){if(void 0!==e&&void 0!==this.nodes[e])throw new Error("Node with id ".concat(e," already exists"));var r=e||(0,i.A)(),n={id:r,data:t};return this.nodes[r]=n,n}},{key:"removeNode",value:function(t){delete this.nodes[t.id],this.edges=this.edges.filter((function(e){return e.source!==t.id&&e.target!==t.id}))}},{key:"addEdge",value:function(t,e,r,n){if(void 0===this.nodes[t.id])throw new Error("Source node ".concat(t.id," not in graph"));if(void 0===this.nodes[e.id])throw new Error("Target node ".concat(e.id," not in graph"));var o={source:t.id,target:e.id,data:r,conditional:n};return this.edges.push(o),o}},{key:"firstNode",value:function(){var t=new Set(this.edges.map((function(t){return t.target}))),e=[];return Object.values(this.nodes).forEach((function(r){t.has(r.id)||e.push(r)})),e[0]}},{key:"lastNode",value:function(){var t=new Set(this.edges.map((function(t){return t.source}))),e=[];return Object.values(this.nodes).forEach((function(r){t.has(r.id)||e.push(r)})),e[0]}},{key:"extend",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";Object.values(t.nodes).map((function(t){return t.id})).every(C.A)&&(r="");var n=function(t){return r?"".concat(r,":").concat(t):t};Object.entries(t.nodes).forEach((function(t){var r=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],s=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);s=!0);}catch(t){c=!0,o=t}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(t,e)||Z(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(t,2),o=r[0],i=r[1];e.nodes[n(o)]=J(J({},i),{},{id:n(o)})}));var o=t.edges.map((function(t){return J(J({},t),{},{source:n(t.source),target:n(t.target)})}));this.edges=[].concat(H(this.edges),H(o));var i=t.firstNode(),a=t.lastNode();return[i?{id:n(i.id),data:i.data}:void 0,a?{id:n(a.id),data:a.data}:void 0]}},{key:"trimFirstNode",value:function(){var t=this.firstNode();if(t){var e=this.edges.filter((function(e){return e.source===t.id}));1!==Object.keys(this.nodes).length&&1!==e.length||this.removeNode(t)}}},{key:"trimLastNode",value:function(){var t=this.lastNode();if(t){var e=this.edges.filter((function(e){return e.target===t.id}));1!==Object.keys(this.nodes).length&&1!==e.length||this.removeNode(t)}}},{key:"drawMermaid",value:function(t){for(var e=null!=t?t:{},r=e.withStyles,n=e.curveStyle,o=e.nodeColors,i=void 0===o?{start:"#ffdfba",end:"#baffc9",other:"#fad7de"}:o,a=e.wrapLabelNWords,u={},s=0,c=Object.values(this.nodes);s<c.length;s++){var l=c[s];u[l.id]=tt(l)}var f=this.firstNode(),p=f?tt(f):void 0,h=this.lastNode(),d=h?tt(h):void 0;return G(u,this.edges,{firstNodeLabel:p,lastNodeLabel:d,withStyles:r,curveStyle:n,nodeColors:i,wrapLabelNWords:a})}},{key:"drawMermaidPng",value:(r=q().mark((function t(e){var r;return q().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.drawMermaid(e),t.abrupt("return",U(r,{backgroundColor:null==e?void 0:e.backgroundColor}));case 2:case"end":return t.stop()}}),t,this)})),n=function(){var t=this,e=arguments;return new Promise((function(n,o){var i=r.apply(t,e);function a(t){K(i,n,o,a,u,"next",t)}function u(t){K(i,n,o,a,u,"throw",t)}a(void 0)}))},function(t){return n.apply(this,arguments)})}],e&&V(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();function rt(t){return rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rt(t)}function nt(){nt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new P(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function b(){}function g(){}var w={};c(w,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(w=_);var E=g.prototype=m.prototype=Object.create(w);function O(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,i,a,u){var s=f(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==rt(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=S(u,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?y:h,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=y,n.method="throw",n.arg=c.arg)}}}function S(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,S(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function C(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(rt(e)+" is not iterable")}return b.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=c(g,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,c(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},O(k.prototype),c(k.prototype,u,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(E),c(E,s,"Generator"),c(E,a,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=C,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),D(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;D(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:C(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function ot(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function it(t){var e,r,n,o=2;for("undefined"!=typeof Symbol&&(r=Symbol.asyncIterator,n=Symbol.iterator);o--;){if(r&&null!=(e=t[r]))return e.call(t);if(n&&null!=(e=t[n]))return new at(e.call(t));r="@@asyncIterator",n="@@iterator"}throw new TypeError("Object is not async iterable")}function at(t){function e(t){if(Object(t)!==t)return Promise.reject(new TypeError(t+" is not an object."));var e=t.done;return Promise.resolve(t.value).then((function(t){return{value:t,done:e}}))}return at=function(t){this.s=t,this.n=t.next},at.prototype={s:null,n:null,next:function(){return e(this.n.apply(this.s,arguments))},return:function(t){var r=this.s.return;return void 0===r?Promise.resolve({value:t,done:!0}):e(r.apply(this.s,arguments))},throw:function(t){var r=this.s.return;return void 0===r?Promise.reject(t):e(r.apply(this.s,arguments))}},new at(t)}function ut(){ut=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new P(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function b(){}function g(){}var w={};c(w,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(w=_);var E=g.prototype=m.prototype=Object.create(w);function O(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,i,a,u){var s=f(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==ct(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=S(u,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?y:h,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=y,n.method="throw",n.arg=c.arg)}}}function S(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,S(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function C(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(ct(e)+" is not iterable")}return b.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=c(g,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,c(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},O(k.prototype),c(k.prototype,u,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(E),c(E,s,"Generator"),c(E,a,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=C,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),D(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;D(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:C(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}var st=ut().mark(dt);function ct(t){return ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ct(t)}function lt(t){var e,r;function n(e,r){try{var i=t[e](r),a=i.value,u=a instanceof ft;Promise.resolve(u?a.v:a).then((function(r){if(u){var s="return"===e?"return":"next";if(!a.k||r.done)return n(s,r);r=t[s](r).value}o(i.done?"return":"normal",r)}),(function(t){n("throw",t)}))}catch(t){o("throw",t)}}function o(t,o){switch(t){case"return":e.resolve({value:o,done:!0});break;case"throw":e.reject(o);break;default:e.resolve({value:o,done:!1})}(e=e.next)?n(e.key,e.arg):r=null}this._invoke=function(t,o){return new Promise((function(i,a){var u={key:t,arg:o,resolve:i,reject:a,next:null};r?r=r.next=u:(e=r=u,n(t,o))}))},"function"!=typeof t.return&&(this.return=void 0)}function ft(t,e){this.v=t,this.k=e}function pt(t){return"object"===ct(t)&&null!==t&&"function"==typeof t[Symbol.iterator]&&"function"==typeof t.next}function ht(t){return"object"===ct(t)&&null!==t&&"function"==typeof t[Symbol.asyncIterator]}function dt(t,e){var r,n;return ut().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(r=D.N.runWithConfig(t,e.next.bind(e),!0),n=r.value,!r.done){o.next=6;break}return o.abrupt("break",10);case 6:return o.next=8,n;case 8:o.next=0;break;case 10:case"end":return o.stop()}}),st)}function yt(t,e){return vt.apply(this,arguments)}function vt(){var t;return t=ut().mark((function t(e,r){var n,o,i;return ut().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=r[Symbol.asyncIterator]();case 1:return t.next=4,new ft(D.N.runWithConfig(e,n.next.bind(r),!0),0);case 4:if(o=t.sent,i=o.value,!o.done){t.next=11;break}return t.abrupt("break",15);case 11:return t.next=13,i;case 13:t.next=1;break;case 15:case"end":return t.stop()}}),t)})),vt=function(){return new lt(t.apply(this,arguments))},vt.apply(this,arguments)}lt.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},lt.prototype.next=function(t){return this._invoke("next",t)},lt.prototype.throw=function(t){return this._invoke("throw",t)},lt.prototype.return=function(t){return this._invoke("return",t)};var mt=r(8662),bt=["runId"],gt=["runId"],wt=["runId"];function xt(t,e){if(null==t)return{};var r,n,o=function(t,e){if(null==t)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.includes(n))continue;r[n]=t[n]}return r}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.includes(r)||{}.propertyIsEnumerable.call(t,r)&&(o[r]=t[r])}return o}function _t(t,e,r,n){var o=Et($t(1&n?t.prototype:t),e,r);return 2&n&&"function"==typeof o?function(t){return o.apply(r,t)}:o}function Et(){return Et="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=$t(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},Et.apply(null,arguments)}function Ot(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=Lt(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}function kt(t){return function(t){if(Array.isArray(t))return Tt(t)}(t)||jt(t)||Lt(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function jt(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function St(){St=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new P(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function b(){}function g(){}var w={};c(w,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(w=_);var E=g.prototype=m.prototype=Object.create(w);function O(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,i,a,u){var s=f(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==Yt(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=S(u,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?y:h,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=y,n.method="throw",n.arg=c.arg)}}}function S(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,S(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function C(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(Yt(e)+" is not iterable")}return b.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=c(g,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,c(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},O(k.prototype),c(k.prototype,u,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(E),c(E,s,"Generator"),c(E,a,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=C,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),D(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;D(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:C(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function At(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function Dt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){At(i,n,o,a,u,"next",t)}function u(t){At(i,n,o,a,u,"throw",t)}a(void 0)}))}}function Pt(t,e){return Ft(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],s=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);s=!0);}catch(t){c=!0,o=t}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(t,e)||Lt(t,e)||Ct()}function Ct(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Lt(t,e){if(t){if("string"==typeof t)return Tt(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Tt(t,e):void 0}}function Tt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Ft(t){if(Array.isArray(t))return t}function It(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Nt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?It(Object(r),!0).forEach((function(e){Ht(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):It(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Rt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Mt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Zt(n.key),n)}}function Bt(t,e,r){return e&&Mt(t.prototype,e),r&&Mt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Gt(t,e,r){return e=$t(e),Ut(t,zt()?Reflect.construct(e,r||[],$t(t).constructor):e.apply(t,r))}function Ut(t,e){if(e&&("object"==Yt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function zt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(zt=function(){return!!t})()}function $t(t){return $t=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},$t(t)}function qt(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Kt(t,e)}function Kt(t,e){return Kt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Kt(t,e)}function Ht(t,e,r){return(e=Zt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Zt(t){var e=function(t){if("object"!=Yt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Yt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Yt(e)?e:e+""}function Yt(t){return Yt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yt(t)}function Vt(t){var e={},r=!1;function n(e,n){return r=!0,n=new Promise((function(r){r(t[e](n))})),{done:!1,value:new ee(n,1)}}return e["undefined"!=typeof Symbol&&Symbol.iterator||"@@iterator"]=function(){return this},e.next=function(t){return r?(r=!1,t):n("next",t)},"function"==typeof t.throw&&(e.throw=function(t){if(r)throw r=!1,t;return n("throw",t)}),"function"==typeof t.return&&(e.return=function(t){return r?(r=!1,t):n("return",t)}),e}function Wt(t){var e,r,n,o=2;for("undefined"!=typeof Symbol&&(r=Symbol.asyncIterator,n=Symbol.iterator);o--;){if(r&&null!=(e=t[r]))return e.call(t);if(n&&null!=(e=t[n]))return new Jt(e.call(t));r="@@asyncIterator",n="@@iterator"}throw new TypeError("Object is not async iterable")}function Jt(t){function e(t){if(Object(t)!==t)return Promise.reject(new TypeError(t+" is not an object."));var e=t.done;return Promise.resolve(t.value).then((function(t){return{value:t,done:e}}))}return Jt=function(t){this.s=t,this.n=t.next},Jt.prototype={s:null,n:null,next:function(){return e(this.n.apply(this.s,arguments))},return:function(t){var r=this.s.return;return void 0===r?Promise.resolve({value:t,done:!0}):e(r.apply(this.s,arguments))},throw:function(t){var r=this.s.return;return void 0===r?Promise.reject(t):e(r.apply(this.s,arguments))}},new Jt(t)}function Xt(t){return new ee(t,0)}function Qt(t){return function(){return new te(t.apply(this,arguments))}}function te(t){var e,r;function n(e,r){try{var i=t[e](r),a=i.value,u=a instanceof ee;Promise.resolve(u?a.v:a).then((function(r){if(u){var s="return"===e?"return":"next";if(!a.k||r.done)return n(s,r);r=t[s](r).value}o(i.done?"return":"normal",r)}),(function(t){n("throw",t)}))}catch(t){o("throw",t)}}function o(t,o){switch(t){case"return":e.resolve({value:o,done:!0});break;case"throw":e.reject(o);break;default:e.resolve({value:o,done:!1})}(e=e.next)?n(e.key,e.arg):r=null}this._invoke=function(t,o){return new Promise((function(i,a){var u={key:t,arg:o,resolve:i,reject:a,next:null};r?r=r.next=u:(e=r=u,n(t,o))}))},"function"!=typeof t.return&&(this.return=void 0)}function ee(t,e){this.v=t,this.k=e}function re(t,e){return!t||Array.isArray(t)||t instanceof Date||"object"!==Yt(t)?Ht({},e,t):t}te.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},te.prototype.next=function(t){return this._invoke("next",t)},te.prototype.throw=function(t){return this._invoke("throw",t)},te.prototype.return=function(t){return this._invoke("return",t)};var ne=function(t){function e(){var t;return Rt(this,e),t=Gt(this,e,arguments),Object.defineProperty(t,"lc_runnable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(t,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),t}return qt(e,t),Bt(e,[{key:"getName",value:function(t){var e,r,n=null!==(e=null!==(r=this.name)&&void 0!==r?r:this.constructor.lc_name())&&void 0!==e?e:this.constructor.name;return t?"".concat(n).concat(t):n}},{key:"bind",value:function(t){return new oe({bound:this,kwargs:t,config:{}})}},{key:"map",value:function(){return new ie({bound:this})}},{key:"withRetry",value:function(t){return new ae(Nt({bound:this,kwargs:{},config:{},maxAttemptNumber:null==t?void 0:t.stopAfterAttempt},t))}},{key:"withConfig",value:function(t){return new oe({bound:this,config:t,kwargs:{}})}},{key:"withFallbacks",value:function(t){var e=Array.isArray(t)?t:t.fallbacks;return new fe({runnable:this,fallbacks:e})}},{key:"_getOptionsList",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(Array.isArray(t)&&t.length!==e)throw new Error('Passed "options" must be an array with the same length as the inputs, but got '.concat(t.length," options for ").concat(e," inputs"));if(Array.isArray(t))return t.map(p.ZI);if(e>1&&!Array.isArray(t)&&t.runId){console.warn("Provided runId will be used only for the first element of the batch.");var r=Object.fromEntries(Object.entries(t).filter((function(t){return"runId"!==Pt(t,1)[0]})));return Array.from({length:e},(function(e,n){return(0,p.ZI)(0===n?t:r)}))}return Array.from({length:e},(function(){return(0,p.ZI)(t)}))}},{key:"batch",value:(c=Dt(St().mark((function t(e,r,n){var o,i,a,u,s,c,l=this;return St().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=this._getOptionsList(null!=r?r:{},e.length),u=null!==(o=null===(i=a[0])||void 0===i?void 0:i.maxConcurrency)&&void 0!==o?o:null==n?void 0:n.maxConcurrency,s=new h.g({maxConcurrency:u,onFailedAttempt:function(t){throw t}}),c=e.map((function(t,e){return s.call(Dt(St().mark((function r(){var o;return St().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,l.invoke(t,a[e]);case 3:return o=r.sent,r.abrupt("return",o);case 7:if(r.prev=7,r.t0=r.catch(0),null==n||!n.returnExceptions){r.next=11;break}return r.abrupt("return",r.t0);case 11:throw r.t0;case 12:case"end":return r.stop()}}),r,null,[[0,7]])}))))})),t.abrupt("return",Promise.all(c));case 5:case"end":return t.stop()}}),t,this)}))),function(t,e,r){return c.apply(this,arguments)})},{key:"_streamIterator",value:function(t,e){var r=this;return Qt(St().mark((function n(){return St().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r.invoke(t,e);case 2:case"end":return n.stop()}}),n)})))()}},{key:"stream",value:(a=Dt(St().mark((function t(e,r){var n,o;return St().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=(0,p.ZI)(r),o=new l.Tr({generator:this._streamIterator(e,n),config:n}),t.next=4,o.setup;case 4:return t.abrupt("return",l.bO.fromAsyncGenerator(o));case 5:case"end":return t.stop()}}),t,this)}))),function(t,e){return a.apply(this,arguments)})},{key:"_separateRunnableConfigFromCallOptions",value:function(t){var e;e=void 0===t?(0,p.ZI)(t):(0,p.ZI)({callbacks:t.callbacks,tags:t.tags,metadata:t.metadata,runName:t.runName,configurable:t.configurable,recursionLimit:t.recursionLimit,maxConcurrency:t.maxConcurrency,runId:t.runId,timeout:t.timeout,signal:t.signal});var r=Nt({},t);return delete r.callbacks,delete r.tags,delete r.metadata,delete r.runName,delete r.configurable,delete r.recursionLimit,delete r.maxConcurrency,delete r.runId,delete r.timeout,delete r.signal,[e,r]}},{key:"_callWithConfig",value:(o=Dt(St().mark((function t(e,r,n){var o,i,a,u,s,c;return St().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=(0,p.ZI)(n),t.next=3,(0,p.kJ)(i);case 3:return a=t.sent,t.next=6,null==a?void 0:a.handleChainStart(this.toJSON(),re(r,"input"),i.runId,null==i?void 0:i.runType,void 0,void 0,null!==(o=null==i?void 0:i.runName)&&void 0!==o?o:this.getName());case 6:return u=t.sent,delete i.runId,t.prev=8,c=e.call(this,r,i,u),t.next=12,(0,f.o)(c,null==n?void 0:n.signal);case 12:s=t.sent,t.next=20;break;case 15:return t.prev=15,t.t0=t.catch(8),t.next=19,null==u?void 0:u.handleChainError(t.t0);case 19:throw t.t0;case 20:return t.next=22,null==u?void 0:u.handleChainEnd(re(s,"output"));case 22:return t.abrupt("return",s);case 23:case"end":return t.stop()}}),t,this,[[8,15]])}))),function(t,e,r){return o.apply(this,arguments)})},{key:"_batchWithConfig",value:(r=Dt(St().mark((function t(e,r,n,o){var i,a,u,s,c,l,h=this;return St().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=this._getOptionsList(null!=n?n:{},r.length),t.next=3,Promise.all(i.map(p.kJ));case 3:return a=t.sent,t.next=6,Promise.all(a.map(function(){var t=Dt(St().mark((function t(e,n){var o,a;return St().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,null==e?void 0:e.handleChainStart(h.toJSON(),re(r[n],"input"),i[n].runId,i[n].runType,void 0,void 0,null!==(o=i[n].runName)&&void 0!==o?o:h.getName());case 2:return a=t.sent,delete i[n].runId,t.abrupt("return",a);case 5:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}()));case 6:return u=t.sent,t.prev=7,l=e.call(this,r,i,u,o),t.next=11,(0,f.o)(l,null==i||null===(c=i[0])||void 0===c?void 0:c.signal);case 11:s=t.sent,t.next=19;break;case 14:return t.prev=14,t.t0=t.catch(7),t.next=18,Promise.all(u.map((function(e){return null==e?void 0:e.handleChainError(t.t0)})));case 18:throw t.t0;case 19:return t.next=21,Promise.all(u.map((function(t){return null==t?void 0:t.handleChainEnd(re(s,"output"))})));case 21:return t.abrupt("return",s);case 22:case"end":return t.stop()}}),t,this,[[7,14]])}))),function(t,e,n,o){return r.apply(this,arguments)})},{key:"_transformStreamWithConfig",value:function(t,e,r){var n=this;return Qt(St().mark((function o(){var i,a,c,f,h,d,y,v,m,b,g,w,x,_,E,O,k,j,S,A,D,P,C,L;return St().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return b=function(){return b=Qt(St().mark((function e(){var r,n,o,i,a,u;return St().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=!1,n=!1,e.prev=2,i=Wt(t);case 4:return e.next=6,Xt(i.next());case 6:if(!(r=!(a=e.sent).done)){e.next=14;break}if(u=a.value,f)if(void 0===c)c=u;else try{c=(0,l.xW)(c,u)}catch(t){c=void 0,f=!1}return e.next=11,u;case 11:r=!1,e.next=4;break;case 14:e.next=20;break;case 16:e.prev=16,e.t0=e.catch(2),n=!0,o=e.t0;case 20:if(e.prev=20,e.prev=21,!r||null==i.return){e.next=25;break}return e.next=25,Xt(i.return());case 25:if(e.prev=25,!n){e.next=28;break}throw o;case 28:return e.finish(25);case 29:return e.finish(20);case 30:case"end":return e.stop()}}),e,null,[[2,16,20,30],[21,,25,29]])}))),b.apply(this,arguments)},m=function(){return b.apply(this,arguments)},f=!0,d=!0,y=(0,p.ZI)(r),o.next=7,Xt((0,p.kJ)(y));case 7:return v=o.sent,o.prev=8,o.next=11,Xt((0,l.DS)(e.bind(n),m(),Dt(St().mark((function t(){var e;return St().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",null==v?void 0:v.handleChainStart(n.toJSON(),{input:""},y.runId,y.runType,void 0,void 0,null!==(e=y.runName)&&void 0!==e?e:n.getName()));case 1:case"end":return t.stop()}}),t)}))),null==r?void 0:r.signal,y));case 11:_=o.sent,delete y.runId,g=_.setup,E=null===(w=g)||void 0===w?void 0:w.handlers.find(s.K),O=_.output,void 0!==E&&void 0!==g&&(O=E.tapOutputIterable(g.runId,O)),void 0!==(k=null===(x=g)||void 0===x?void 0:x.handlers.find(u.l7))&&void 0!==g&&(O=k.tapOutputIterable(g.runId,O)),j=!1,S=!1,o.prev=21,D=Wt(O);case 23:return o.next=25,Xt(D.next());case 25:if(!(j=!(P=o.sent).done)){o.next=33;break}return C=P.value,o.next=29,C;case 29:if(d)if(void 0===h)h=C;else try{h=(0,l.xW)(h,C)}catch(t){h=void 0,d=!1}case 30:j=!1,o.next=23;break;case 33:o.next=39;break;case 35:o.prev=35,o.t0=o.catch(21),S=!0,A=o.t0;case 39:if(o.prev=39,o.prev=40,!j||null==D.return){o.next=44;break}return o.next=44,Xt(D.return());case 44:if(o.prev=44,!S){o.next=47;break}throw A;case 47:return o.finish(44);case 48:return o.finish(39);case 49:o.next=56;break;case 51:return o.prev=51,o.t1=o.catch(8),o.next=55,Xt(null===(L=g)||void 0===L?void 0:L.handleChainError(o.t1,void 0,void 0,void 0,{inputs:re(c,"input")}));case 55:throw o.t1;case 56:return o.next=58,Xt(null===(i=g)||void 0===i?void 0:i.handleChainEnd(null!==(a=h)&&void 0!==a?a:{},void 0,void 0,void 0,{inputs:re(c,"input")}));case 58:case"end":return o.stop()}}),o,null,[[8,51],[21,35,39,49],[40,,44,48]])})))()}},{key:"getGraph",value:function(t){var e=new et,r=e.addNode({name:"".concat(this.getName(),"Input"),schema:n.z.any()}),o=e.addNode(this),i=e.addNode({name:"".concat(this.getName(),"Output"),schema:n.z.any()});return e.addEdge(r,o),e.addEdge(o,i),e}},{key:"pipe",value:function(t){return new ue({first:this,last:pe(t)})}},{key:"pick",value:function(t){return this.pipe(new de(t))}},{key:"assign",value:function(t){return this.pipe(new he(new se({steps:t})))}},{key:"transform",value:function(t,e){var r=this;return Qt(St().mark((function n(){var o,i,a,u,s,c,f;return St().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:i=!1,a=!1,n.prev=2,s=Wt(t);case 4:return n.next=6,Xt(s.next());case 6:if(!(i=!(c=n.sent).done)){n.next=12;break}f=c.value,o=void 0===o?f:(0,l.xW)(o,f);case 9:i=!1,n.next=4;break;case 12:n.next=18;break;case 14:n.prev=14,n.t0=n.catch(2),a=!0,u=n.t0;case 18:if(n.prev=18,n.prev=19,!i||null==s.return){n.next=23;break}return n.next=23,Xt(s.return());case 23:if(n.prev=23,!a){n.next=26;break}throw u;case 26:return n.finish(23);case 27:return n.finish(18);case 28:return n.delegateYield(Vt(Wt(r._streamIterator(o,(0,p.ZI)(e)))),"t1",29);case 29:case"end":return n.stop()}}),n,null,[[2,14,18,28],[19,,23,27]])})))()}},{key:"streamLog",value:function(t,e,r){var n=this;return Qt(St().mark((function o(){var i,a;return St().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return i=new u.y9(Nt(Nt({},r),{},{autoClose:!1,_schemaFormat:"original"})),a=(0,p.ZI)(e),o.delegateYield(Vt(Wt(n._streamLog(t,i,a))),"t0",3);case 3:case"end":return o.stop()}}),o)})))()}},{key:"_streamLog",value:function(t,e,r){var n=this;return Qt(St().mark((function o(){var i,a,s,c,l,f,p,h,d,y,v,m;return St().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:l=function(){return(l=Dt(St().mark((function t(){var r,n,o,i,a,c,l,f;return St().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,s;case 3:r=t.sent,n=!1,o=!1,t.prev=6,a=Wt(r);case 8:return t.next=10,a.next();case 10:if(!(n=!(c=t.sent).done)){t.next=18;break}return l=c.value,f=new u.Od({ops:[{op:"add",path:"/streamed_output/-",value:l}]}),t.next=15,e.writer.write(f);case 15:n=!1,t.next=8;break;case 18:t.next=24;break;case 20:t.prev=20,t.t0=t.catch(6),o=!0,i=t.t0;case 24:if(t.prev=24,t.prev=25,!n||null==a.return){t.next=29;break}return t.next=29,a.return();case 29:if(t.prev=29,!o){t.next=32;break}throw i;case 32:return t.finish(29);case 33:return t.finish(24);case 34:return t.prev=34,t.next=37,e.writer.close();case 37:return t.finish(34);case 38:case"end":return t.stop()}}),t,null,[[0,,34,38],[6,20,24,34],[25,,29,33]])})))).apply(this,arguments)},c=function(){return l.apply(this,arguments)},void 0===(i=r.callbacks)?r.callbacks=[e]:Array.isArray(i)?r.callbacks=i.concat([e]):((a=i.copy()).addHandler(e,!0),r.callbacks=a),s=n.stream(t,r),f=c(),o.prev=6,p=!1,h=!1,o.prev=9,y=Wt(e);case 11:return o.next=13,Xt(y.next());case 13:if(!(p=!(v=o.sent).done)){o.next=20;break}return m=v.value,o.next=17,m;case 17:p=!1,o.next=11;break;case 20:o.next=26;break;case 22:o.prev=22,o.t0=o.catch(9),h=!0,d=o.t0;case 26:if(o.prev=26,o.prev=27,!p||null==y.return){o.next=31;break}return o.next=31,Xt(y.return());case 31:if(o.prev=31,!h){o.next=34;break}throw d;case 34:return o.finish(31);case 35:return o.finish(26);case 36:return o.prev=36,o.next=39,Xt(f);case 39:return o.finish(36);case 40:case"end":return o.stop()}}),o,null,[[6,,36,40],[9,22,26,36],[27,,31,35]])})))()}},{key:"streamEvents",value:function(t,e,r){var n;if("v1"===e.version)n=this._streamEventsV1(t,e,r);else{if("v2"!==e.version)throw new Error('Only versions "v1" and "v2" of the schema are currently supported.');n=this._streamEventsV2(t,e,r)}return"text/event-stream"===e.encoding?function(t){var e=new TextEncoder,r=new ReadableStream({start:function(r){return(n=nt().mark((function n(){var o,i,a,u,s,c;return nt().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:o=!1,i=!1,n.prev=2,u=it(t);case 4:return n.next=6,u.next();case 6:if(!(o=!(s=n.sent).done)){n.next=12;break}c=s.value,r.enqueue(e.encode("event: data\ndata: ".concat(JSON.stringify(c),"\n\n")));case 9:o=!1,n.next=4;break;case 12:n.next=18;break;case 14:n.prev=14,n.t0=n.catch(2),i=!0,a=n.t0;case 18:if(n.prev=18,n.prev=19,!o||null==u.return){n.next=23;break}return n.next=23,u.return();case 23:if(n.prev=23,!i){n.next=26;break}throw a;case 26:return n.finish(23);case 27:return n.finish(18);case 28:r.enqueue(e.encode("event: end\n\n")),r.close();case 30:case"end":return n.stop()}}),n,null,[[2,14,18,28],[19,,23,27]])})),function(){var t=this,e=arguments;return new Promise((function(r,o){var i=n.apply(t,e);function a(t){ot(i,r,o,a,u,"next",t)}function u(t){ot(i,r,o,a,u,"throw",t)}a(void 0)}))})();var n}});return l.bO.fromReadableStream(r)}(n):l.bO.fromAsyncGenerator(n)}},{key:"_streamEventsV2",value:function(t,e,r){var n=this;return Qt(St().mark((function o(){var a,u,c,l,f,h,d,y,v,m,b,g,w,x,_,E,O,k,j;return St().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:v=function(){return(v=Dt(St().mark((function e(){var r,n,o,i,a,s,f;return St().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d.stream(t,c);case 3:r=e.sent,n=u.tapOutputIterable(l,r),o=!1,i=!1,e.prev=7,s=Wt(n);case 9:return e.next=11,s.next();case 11:if(!(o=!(f=e.sent).done)){e.next=16;break}f.value;case 13:o=!1,e.next=9;break;case 16:e.next=22;break;case 18:e.prev=18,e.t0=e.catch(7),i=!0,a=e.t0;case 22:if(e.prev=22,e.prev=23,!o||null==s.return){e.next=27;break}return e.next=27,s.return();case 27:if(e.prev=27,!i){e.next=30;break}throw a;case 30:return e.finish(27);case 31:return e.finish(22);case 32:return e.prev=32,e.next=35,u.finish();case 35:return e.finish(32);case 36:case"end":return e.stop()}}),e,null,[[0,,32,36],[7,18,22,32],[23,,27,31]])})))).apply(this,arguments)},y=function(){return v.apply(this,arguments)},u=new s.s(Nt(Nt({},r),{},{autoClose:!1})),c=(0,p.ZI)(e),l=null!==(a=c.runId)&&void 0!==a?a:(0,i.A)(),c.runId=l,void 0===(f=c.callbacks)?c.callbacks=[u]:Array.isArray(f)?c.callbacks=f.concat(u):((h=f.copy()).addHandler(u,!0),c.callbacks=h),d=n,m=y(),b=!1,o.prev=11,w=!1,x=!1,o.prev=14,E=Wt(u);case 16:return o.next=18,Xt(E.next());case 18:if(!(w=!(O=o.sent).done)){o.next=33;break}if(k=O.value,b){o.next=27;break}return k.data.input=t,b=!0,g=k.run_id,o.next=26,k;case 26:return o.abrupt("continue",30);case 27:return k.run_id===g&&k.event.endsWith("_end")&&null!==(j=k.data)&&void 0!==j&&j.input&&delete k.data.input,o.next=30,k;case 30:w=!1,o.next=16;break;case 33:o.next=39;break;case 35:o.prev=35,o.t0=o.catch(14),x=!0,_=o.t0;case 39:if(o.prev=39,o.prev=40,!w||null==E.return){o.next=44;break}return o.next=44,Xt(E.return());case 44:if(o.prev=44,!x){o.next=47;break}throw _;case 47:return o.finish(44);case 48:return o.finish(39);case 49:return o.prev=49,o.next=52,Xt(m);case 52:return o.finish(49);case 53:case"end":return o.stop()}}),o,null,[[11,,49,53],[14,35,39,49],[40,,44,48]])})))()}},{key:"_streamEventsV1",value:function(t,e,r){var n=this;return Qt(St().mark((function o(){var i,a,s,c,l,f,h,d,y,v,m,b,g,w,x,_,E,O,k,j,S,D,P,C,L,T,F,I,N,R,M,B,G,U,z,$;return St().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:f=!1,h=(0,p.ZI)(e),d=null!==(i=h.tags)&&void 0!==i?i:[],y=null!==(a=h.metadata)&&void 0!==a?a:{},v=null!==(s=h.runName)&&void 0!==s?s:n.getName(),m=new u.y9(Nt(Nt({},r),{},{autoClose:!1,_schemaFormat:"streaming_events"})),b=new A(Nt({},r)),g=n._streamLog(t,m,h),w=!1,x=!1,o.prev=10,E=Wt(g);case 12:return o.next=14,Xt(E.next());case 14:if(!(w=!(O=o.sent).done)){o.next=78;break}if(k=O.value,void 0!==(l=l?l.concat(k):u.sD.fromRunLogPatch(k)).state){o.next=19;break}throw new Error('Internal error: "streamEvents" state is missing. Please open a bug report.');case 19:if(f){o.next=26;break}if(f=!0,j=Nt({},l.state),S={run_id:j.id,event:"on_".concat(j.type,"_start"),name:v,tags:d,metadata:y,data:{input:t}},!b.includeEvent(S,j.type)){o.next=26;break}return o.next=26,S;case 26:D=k.ops.filter((function(t){return t.path.startsWith("/logs/")})).map((function(t){return t.path.split("/")[2]})),P=kt(new Set(D)),C=Ot(P),o.prev=29,C.s();case 31:if((L=C.n()).done){o.next=56;break}if(T=L.value,F=void 0,I={},N=l.state.logs[T],"start"!=(F=void 0===N.end_time?N.streamed_output.length>0?"stream":"start":"end")){o.next=41;break}void 0!==N.inputs&&(I.input=N.inputs),o.next=52;break;case 41:if("end"!==F){o.next=46;break}void 0!==N.inputs&&(I.input=N.inputs),I.output=N.final_output,o.next=52;break;case 46:if("stream"!==F){o.next=52;break}if(1===(R=N.streamed_output.length)){o.next=50;break}throw new Error("Expected exactly one chunk of streamed output, got ".concat(R,' instead. Encountered in: "').concat(N.name,'"'));case 50:I={chunk:N.streamed_output[0]},N.streamed_output=[];case 52:return o.next=54,{event:"on_".concat(N.type,"_").concat(F),name:N.name,run_id:N.id,tags:N.tags,metadata:N.metadata,data:I};case 54:o.next=31;break;case 56:o.next=61;break;case 58:o.prev=58,o.t0=o.catch(29),C.e(o.t0);case 61:return o.prev=61,C.f(),o.finish(61);case 64:if(!((M=l.state).streamed_output.length>0)){o.next=75;break}if(1===(B=M.streamed_output.length)){o.next=69;break}throw new Error("Expected exactly one chunk of streamed output, got ".concat(B,' instead. Encountered in: "').concat(M.name,'"'));case 69:if(G={chunk:M.streamed_output[0]},M.streamed_output=[],U={event:"on_".concat(M.type,"_stream"),run_id:M.id,tags:d,metadata:y,name:v,data:G},!b.includeEvent(U,M.type)){o.next=75;break}return o.next=75,U;case 75:w=!1,o.next=12;break;case 78:o.next=84;break;case 80:o.prev=80,o.t1=o.catch(10),x=!0,_=o.t1;case 84:if(o.prev=84,o.prev=85,!w||null==E.return){o.next=89;break}return o.next=89,Xt(E.return());case 89:if(o.prev=89,!x){o.next=92;break}throw _;case 92:return o.finish(89);case 93:return o.finish(84);case 94:if(void 0===(z=null===(c=l)||void 0===c?void 0:c.state)){o.next=100;break}if($={event:"on_".concat(z.type,"_end"),name:v,run_id:z.id,tags:d,metadata:y,data:{output:z.final_output}},!b.includeEvent($,z.type)){o.next=100;break}return o.next=100,$;case 100:case"end":return o.stop()}}),o,null,[[10,80,84,94],[29,58,61,64],[85,,89,93]])})))()}},{key:"withListeners",value:function(t){var e=t.onStart,r=t.onEnd,n=t.onError;return new oe({bound:this,config:{},configFactories:[function(t){return{callbacks:[new E({config:t,onStart:e,onEnd:r,onError:n})]}}]})}},{key:"asTool",value:function(t){return function(t,e){var r,o,i,a=null!==(r=e.name)&&void 0!==r?r:t.getName(),u=null!==(o=e.description)&&void 0!==o?o:null===(i=e.schema)||void 0===i?void 0:i.description;return e.schema.constructor===n.z.ZodString?new ye({name:a,description:u,schema:n.z.object({input:n.z.string()}).transform((function(t){return t.input})),bound:t}):new ye({name:a,description:u,schema:e.schema,bound:t})}(this,t)}}],[{key:"isRunnable",value:function(t){return S(t)}}]);var r,o,a,c}(c.y),oe=function(t){function e(t){var r;return Rt(this,e),r=Gt(this,e,[t]),Object.defineProperty(r,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(r,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(r,"bound",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(r,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(r,"kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(r,"configFactories",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),r.bound=t.bound,r.kwargs=t.kwargs,r.config=t.config,r.configFactories=t.configFactories,r}return qt(e,t),Bt(e,[{key:"getName",value:function(t){return this.bound.getName(t)}},{key:"_mergeConfig",value:(i=Dt(St().mark((function t(){var e,r,n,o,i=arguments;return St().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(e=i.length,r=new Array(e),n=0;n<e;n++)r[n]=i[n];if(o=p.SV.apply(void 0,[this.config].concat(r)),t.t0=p.SV,t.t1=void 0,t.t2=[o],t.t3=kt,!this.configFactories){t.next=12;break}return t.next=9,Promise.all(this.configFactories.map(function(){var t=Dt(St().mark((function t(e){return St().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e(o);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 9:t.t4=t.sent,t.next=13;break;case 12:t.t4=[];case 13:return t.t5=t.t4,t.t6=(0,t.t3)(t.t5),t.t7=t.t2.concat.call(t.t2,t.t6),t.abrupt("return",t.t0.apply.call(t.t0,t.t1,t.t7));case 17:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"bind",value:function(t){return new this.constructor({bound:this.bound,kwargs:Nt(Nt({},this.kwargs),t),config:this.config})}},{key:"withConfig",value:function(t){return new this.constructor({bound:this.bound,kwargs:this.kwargs,config:Nt(Nt({},this.config),t)})}},{key:"withRetry",value:function(t){return new this.constructor({bound:this.bound.withRetry(t),kwargs:this.kwargs,config:this.config})}},{key:"invoke",value:(o=Dt(St().mark((function t(e,r){return St().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=this.bound,t.t1=e,t.next=4,this._mergeConfig((0,p.ZI)(r),this.kwargs);case 4:return t.t2=t.sent,t.abrupt("return",t.t0.invoke.call(t.t0,t.t1,t.t2));case 6:case"end":return t.stop()}}),t,this)}))),function(t,e){return o.apply(this,arguments)})},{key:"batch",value:(n=Dt(St().mark((function t(e,r,n){var o,i=this;return St().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!Array.isArray(r)){t.next=6;break}return t.next=3,Promise.all(r.map(function(){var t=Dt(St().mark((function t(e){return St().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",i._mergeConfig((0,p.ZI)(e),i.kwargs));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 3:t.t0=t.sent,t.next=9;break;case 6:return t.next=8,this._mergeConfig((0,p.ZI)(r),this.kwargs);case 8:t.t0=t.sent;case 9:return o=t.t0,t.abrupt("return",this.bound.batch(e,o,n));case 11:case"end":return t.stop()}}),t,this)}))),function(t,e,r){return n.apply(this,arguments)})},{key:"_streamIterator",value:function(t,e){var r=this;return Qt(St().mark((function n(){return St().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.t0=Vt,n.t1=Wt,n.t2=r.bound,n.t3=t,n.next=6,Xt(r._mergeConfig((0,p.ZI)(e),r.kwargs));case 6:return n.t4=n.sent,n.t5=n.t2._streamIterator.call(n.t2,n.t3,n.t4),n.t6=(0,n.t1)(n.t5),n.t7=Xt,n.delegateYield((0,n.t0)(n.t6,n.t7),"t8",11);case 11:case"end":return n.stop()}}),n)})))()}},{key:"stream",value:(r=Dt(St().mark((function t(e,r){return St().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=this.bound,t.t1=e,t.next=4,this._mergeConfig((0,p.ZI)(r),this.kwargs);case 4:return t.t2=t.sent,t.abrupt("return",t.t0.stream.call(t.t0,t.t1,t.t2));case 6:case"end":return t.stop()}}),t,this)}))),function(t,e){return r.apply(this,arguments)})},{key:"transform",value:function(t,e){var r=this;return Qt(St().mark((function n(){return St().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.t0=Vt,n.t1=Wt,n.t2=r.bound,n.t3=t,n.next=6,Xt(r._mergeConfig((0,p.ZI)(e),r.kwargs));case 6:return n.t4=n.sent,n.t5=n.t2.transform.call(n.t2,n.t3,n.t4),n.t6=(0,n.t1)(n.t5),n.t7=Xt,n.delegateYield((0,n.t0)(n.t6,n.t7),"t8",11);case 11:case"end":return n.stop()}}),n)})))()}},{key:"streamEvents",value:function(t,e,r){var n=this,o=function(){var o=Qt(St().mark((function o(){return St().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.t0=Vt,o.t1=Wt,o.t2=n.bound,o.t3=t,o.t4=Nt,o.t5=Nt,o.t6={},o.next=9,Xt(n._mergeConfig((0,p.ZI)(e),n.kwargs));case 9:return o.t7=o.sent,o.t8=(0,o.t5)(o.t6,o.t7),o.t9={},o.t10={version:e.version},o.t11=(0,o.t4)(o.t8,o.t9,o.t10),o.t12=r,o.t13=o.t2.streamEvents.call(o.t2,o.t3,o.t11,o.t12),o.t14=(0,o.t1)(o.t13),o.t15=Xt,o.delegateYield((0,o.t0)(o.t14,o.t15),"t16",19);case 19:case"end":return o.stop()}}),o)})));return function(){return o.apply(this,arguments)}}();return l.bO.fromAsyncGenerator(o())}},{key:"withListeners",value:function(t){var r=t.onStart,n=t.onEnd,o=t.onError;return new e({bound:this.bound,kwargs:this.kwargs,config:this.config,configFactories:[function(t){return{callbacks:[new E({config:t,onStart:r,onEnd:n,onError:o})]}}]})}}],[{key:"lc_name",value:function(){return"RunnableBinding"}},{key:"isRunnableBinding",value:function(t){return t.bound&&ne.isRunnable(t.bound)}}]);var r,n,o,i}(ne),ie=function(t){function e(t){var r;return Rt(this,e),r=Gt(this,e,[t]),Object.defineProperty(r,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(r,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(r,"bound",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),r.bound=t.bound,r}return qt(e,t),Bt(e,[{key:"bind",value:function(t){return new e({bound:this.bound.bind(t)})}},{key:"invoke",value:(n=Dt(St().mark((function t(e,r){return St().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this._callWithConfig(this._invoke,e,r));case 1:case"end":return t.stop()}}),t,this)}))),function(t,e){return n.apply(this,arguments)})},{key:"_invoke",value:(r=Dt(St().mark((function t(e,r,n){return St().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.bound.batch(e,(0,p.tn)(r,{callbacks:null==n?void 0:n.getChild()})));case 1:case"end":return t.stop()}}),t,this)}))),function(t,e,n){return r.apply(this,arguments)})},{key:"withListeners",value:function(t){var r=t.onStart,n=t.onEnd,o=t.onError;return new e({bound:this.bound.withListeners({onStart:r,onEnd:n,onError:o})})}}],[{key:"lc_name",value:function(){return"RunnableEach"}}]);var r,n}(ne),ae=function(t){function e(t){var r,n,o;return Rt(this,e),o=Gt(this,e,[t]),Object.defineProperty(o,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(o,"maxAttemptNumber",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(o,"onFailedAttempt",{enumerable:!0,configurable:!0,writable:!0,value:function(){}}),o.maxAttemptNumber=null!==(r=t.maxAttemptNumber)&&void 0!==r?r:o.maxAttemptNumber,o.onFailedAttempt=null!==(n=t.onFailedAttempt)&&void 0!==n?n:o.onFailedAttempt,o}return qt(e,t),Bt(e,[{key:"_patchConfigForRetry",value:function(t,e,r){var n=t>1?"retry:attempt:".concat(t):void 0;return(0,p.tn)(e,{callbacks:null==r?void 0:r.getChild(n)})}},{key:"_invoke",value:(a=Dt(St().mark((function t(r,n,i){var a=this;return St().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",o((function(t){return _t(e,"invoke",a,3)([r,a._patchConfigForRetry(t,n,i)])}),{onFailedAttempt:function(t){return a.onFailedAttempt(t,r)},retries:Math.max(this.maxAttemptNumber-1,0),randomize:!0}));case 1:case"end":return t.stop()}}),t,this)}))),function(t,e,r){return a.apply(this,arguments)})},{key:"invoke",value:(i=Dt(St().mark((function t(e,r){return St().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this._callWithConfig(this._invoke,e,r));case 1:case"end":return t.stop()}}),t,this)}))),function(t,e){return i.apply(this,arguments)})},{key:"_batch",value:(n=Dt(St().mark((function t(r,n,i,a){var u,s=this;return St().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return u={},t.prev=1,t.next=4,o(function(){var t=Dt(St().mark((function t(o){var c,l,f,p,h,d,y,v;return St().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=r.map((function(t,e){return e})).filter((function(t){return void 0===u[t.toString()]||u[t.toString()]instanceof Error})),l=c.map((function(t){return r[t]})),f=c.map((function(t){return s._patchConfigForRetry(o,null==n?void 0:n[t],null==i?void 0:i[t])})),t.next=5,_t(e,"batch",s,3)([l,f,Nt(Nt({},a),{},{returnExceptions:!0})]);case 5:for(p=t.sent,d=0;d<p.length;d+=1)y=p[d],v=c[d],y instanceof Error&&void 0===h&&((h=y).input=l[d]),u[v.toString()]=y;if(!h){t.next=9;break}throw h;case 9:return t.abrupt("return",p);case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),{onFailedAttempt:function(t){return s.onFailedAttempt(t,t.input)},retries:Math.max(this.maxAttemptNumber-1,0),randomize:!0});case 4:t.next=10;break;case 6:if(t.prev=6,t.t0=t.catch(1),!0===(null==a?void 0:a.returnExceptions)){t.next=10;break}throw t.t0;case 10:return t.abrupt("return",Object.keys(u).sort((function(t,e){return parseInt(t,10)-parseInt(e,10)})).map((function(t){return u[parseInt(t,10)]})));case 11:case"end":return t.stop()}}),t,this,[[1,6]])}))),function(t,e,r,o){return n.apply(this,arguments)})},{key:"batch",value:(r=Dt(St().mark((function t(e,r,n){return St().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this._batchWithConfig(this._batch.bind(this),e,r,n));case 1:case"end":return t.stop()}}),t,this)}))),function(t,e,n){return r.apply(this,arguments)})}],[{key:"lc_name",value:function(){return"RunnableRetry"}}]);var r,n,i,a}(oe),ue=function(t){function e(t){var r,n;return Rt(this,e),n=Gt(this,e,[t]),Object.defineProperty(n,"first",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(n,"middle",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(n,"last",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(n,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(n,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),n.first=t.first,n.middle=null!==(r=t.middle)&&void 0!==r?r:n.middle,n.last=t.last,n.name=t.name,n}return qt(e,t),Bt(e,[{key:"steps",get:function(){return[this.first].concat(kt(this.middle),[this.last])}},{key:"invoke",value:(n=Dt(St().mark((function t(e,r){var n,o,i,a,u,s,c,l,h,d;return St().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=(0,p.ZI)(r),t.next=3,(0,p.kJ)(n);case 3:return o=t.sent,t.next=6,null==o?void 0:o.handleChainStart(this.toJSON(),re(e,"input"),n.runId,void 0,void 0,void 0,null==n?void 0:n.runName);case 6:i=t.sent,delete n.runId,a=e,t.prev=9,c=[this.first].concat(kt(this.middle)),l=0;case 12:if(!(l<c.length)){t.next=21;break}return h=c[l],d=h.invoke(a,(0,p.tn)(n,{callbacks:null==i?void 0:i.getChild("seq:step:".concat(l+1))})),t.next=17,(0,f.o)(d,null==r?void 0:r.signal);case 17:a=t.sent;case 18:l+=1,t.next=12;break;case 21:if(null==r||null===(s=r.signal)||void 0===s||!s.aborted){t.next=23;break}throw new Error("Aborted");case 23:return t.next=25,this.last.invoke(a,(0,p.tn)(n,{callbacks:null==i?void 0:i.getChild("seq:step:".concat(this.steps.length))}));case 25:u=t.sent,t.next=33;break;case 28:return t.prev=28,t.t0=t.catch(9),t.next=32,null==i?void 0:i.handleChainError(t.t0);case 32:throw t.t0;case 33:return t.next=35,null==i?void 0:i.handleChainEnd(re(u,"output"));case 35:return t.abrupt("return",u);case 36:case"end":return t.stop()}}),t,this,[[9,28]])}))),function(t,e){return n.apply(this,arguments)})},{key:"batch",value:(r=Dt(St().mark((function t(e,r,n){var o,i,a,u,s,c,l=this;return St().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=this._getOptionsList(null!=r?r:{},e.length),t.next=3,Promise.all(o.map(p.kJ));case 3:return i=t.sent,t.next=6,Promise.all(i.map(function(){var t=Dt(St().mark((function t(r,n){var i;return St().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,null==r?void 0:r.handleChainStart(l.toJSON(),re(e[n],"input"),o[n].runId,void 0,void 0,void 0,o[n].runName);case 2:return i=t.sent,delete o[n].runId,t.abrupt("return",i);case 5:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}()));case 6:a=t.sent,u=e,t.prev=8,s=St().mark((function t(e){var r,i,s;return St().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=l.steps[e],s=i.batch(u,a.map((function(t,r){var n=null==t?void 0:t.getChild("seq:step:".concat(e+1));return(0,p.tn)(o[r],{callbacks:n})})),n),t.next=4,(0,f.o)(s,null===(r=o[0])||void 0===r?void 0:r.signal);case 4:u=t.sent;case 5:case"end":return t.stop()}}),t)})),c=0;case 11:if(!(c<this.steps.length)){t.next=16;break}return t.delegateYield(s(c),"t0",13);case 13:c+=1,t.next=11;break;case 16:t.next=23;break;case 18:return t.prev=18,t.t1=t.catch(8),t.next=22,Promise.all(a.map((function(e){return null==e?void 0:e.handleChainError(t.t1)})));case 22:throw t.t1;case 23:return t.next=25,Promise.all(a.map((function(t){return null==t?void 0:t.handleChainEnd(re(u,"output"))})));case 25:return t.abrupt("return",u);case 26:case"end":return t.stop()}}),t,this,[[8,18]])}))),function(t,e,n){return r.apply(this,arguments)})},{key:"_streamIterator",value:function(t,e){var r=this;return Qt(St().mark((function n(){var o,i,a,u,s,c,f,h,d,y,v,m,b,g,w,x,_,E,O,k;return St().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return y=function(){return(y=Qt(St().mark((function e(){return St().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t;case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)},d=function(){return y.apply(this,arguments)},n.next=4,Xt((0,p.kJ)(e));case 4:return o=n.sent,a=(i=null!=e?e:{}).runId,u=xt(i,bt),n.next=8,Xt(null==o?void 0:o.handleChainStart(r.toJSON(),re(t,"input"),a,void 0,void 0,void 0,null==u?void 0:u.runName));case 8:s=n.sent,c=[r.first].concat(kt(r.middle),[r.last]),f=!0,n.prev=11,v=c[0].transform(d(),(0,p.tn)(u,{callbacks:null==s?void 0:s.getChild("seq:step:1")})),m=1;case 14:if(!(m<c.length)){n.next=22;break}return b=c[m],n.next=18,Xt(b.transform(v,(0,p.tn)(u,{callbacks:null==s?void 0:s.getChild("seq:step:".concat(m+1))})));case 18:v=n.sent;case 19:m+=1,n.next=14;break;case 22:g=!1,w=!1,n.prev=24,_=Wt(v);case 26:return n.next=28,Xt(_.next());case 28:if(!(g=!(E=n.sent).done)){n.next=37;break}return O=E.value,null==e||null===(k=e.signal)||void 0===k||k.throwIfAborted(),n.next=33,O;case 33:if(f)if(void 0===h)h=O;else try{h=(0,l.xW)(h,O)}catch(t){h=void 0,f=!1}case 34:g=!1,n.next=26;break;case 37:n.next=43;break;case 39:n.prev=39,n.t0=n.catch(24),w=!0,x=n.t0;case 43:if(n.prev=43,n.prev=44,!g||null==_.return){n.next=48;break}return n.next=48,Xt(_.return());case 48:if(n.prev=48,!w){n.next=51;break}throw x;case 51:return n.finish(48);case 52:return n.finish(43);case 53:n.next=60;break;case 55:return n.prev=55,n.t1=n.catch(11),n.next=59,Xt(null==s?void 0:s.handleChainError(n.t1));case 59:throw n.t1;case 60:return n.next=62,Xt(null==s?void 0:s.handleChainEnd(re(h,"output")));case 62:case"end":return n.stop()}}),n,null,[[11,55],[24,39,43,53],[44,,48,52]])})))()}},{key:"getGraph",value:function(t){var e=this,r=new et,n=null;return this.steps.forEach((function(o,i){var a=o.getGraph(t);0!==i&&a.trimFirstNode(),i!==e.steps.length-1&&a.trimLastNode(),r.extend(a);var u=a.firstNode();if(!u)throw new Error("Runnable ".concat(o," has no first node"));n&&r.addEdge(n,u),n=a.lastNode()})),r}},{key:"pipe",value:function(t){var r;return e.isRunnableSequence(t)?new e({first:this.first,middle:this.middle.concat([this.last,t.first].concat(kt(t.middle))),last:t.last,name:null!==(r=this.name)&&void 0!==r?r:t.name}):new e({first:this.first,middle:[].concat(kt(this.middle),[this.last]),last:pe(t),name:this.name})}}],[{key:"lc_name",value:function(){return"RunnableSequence"}},{key:"isRunnableSequence",value:function(t){return Array.isArray(t.middle)&&ne.isRunnable(t)}},{key:"from",value:function(t,r){var n,o=Ft(n=t)||jt(n)||Lt(n)||Ct(),i=o[0],a=o.slice(1);return new e({first:pe(i),middle:a.slice(0,-1).map(pe),last:pe(a[a.length-1]),name:r})}}]);var r,n}(ne),se=function(t){function e(t){var r;Rt(this,e),r=Gt(this,e,[t]),Object.defineProperty(r,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(r,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(r,"steps",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),r.steps={};for(var n=0,o=Object.entries(t.steps);n<o.length;n++){var i=Pt(o[n],2),a=i[0],u=i[1];r.steps[a]=pe(u)}return r}return qt(e,t),Bt(e,[{key:"getStepsKeys",value:function(){return Object.keys(this.steps)}},{key:"invoke",value:(n=Dt(St().mark((function t(e,r){var n,o,i,a,u;return St().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=(0,p.ZI)(r),t.next=3,(0,p.kJ)(n);case 3:return o=t.sent,t.next=6,null==o?void 0:o.handleChainStart(this.toJSON(),{input:e},n.runId,void 0,void 0,void 0,null==n?void 0:n.runName);case 6:return i=t.sent,delete n.runId,a={},t.prev=9,u=Object.entries(this.steps).map(function(){var t=Dt(St().mark((function t(r){var o,u,s;return St().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=Pt(r,2),u=o[0],s=o[1],t.next=3,s.invoke(e,(0,p.tn)(n,{callbacks:null==i?void 0:i.getChild("map:key:".concat(u))}));case 3:a[u]=t.sent;case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),t.next=13,(0,f.o)(Promise.all(u),null==r?void 0:r.signal);case 13:t.next=20;break;case 15:return t.prev=15,t.t0=t.catch(9),t.next=19,null==i?void 0:i.handleChainError(t.t0);case 19:throw t.t0;case 20:return t.next=22,null==i?void 0:i.handleChainEnd(a);case 22:return t.abrupt("return",a);case 23:case"end":return t.stop()}}),t,this,[[9,15]])}))),function(t,e){return n.apply(this,arguments)})},{key:"_transform",value:function(t,e,r){var n=this;return Qt(St().mark((function o(){var i,a,u,s;return St().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:i=Nt({},n.steps),a=(0,l.gI)(t,Object.keys(i).length),u=new Map(Object.entries(i).map((function(t,n){var o=Pt(t,2),i=o[0],u=o[1].transform(a[n],(0,p.tn)(r,{callbacks:null==e?void 0:e.getChild("map:key:".concat(i))}));return[i,u.next().then((function(t){return{key:i,gen:u,result:t}}))]}))),s=St().mark((function t(){var e,n,o,i,a;return St().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=Promise.race(u.values()),t.next=3,Xt((0,f.o)(e,null==r?void 0:r.signal));case 3:if(n=t.sent,o=n.key,i=n.result,a=n.gen,u.delete(o),i.done){t.next=12;break}return t.next=11,Ht({},o,i.value);case 11:u.set(o,a.next().then((function(t){return{key:o,gen:a,result:t}})));case 12:case"end":return t.stop()}}),t)}));case 4:if(!u.size){o.next=8;break}return o.delegateYield(s(),"t0",6);case 6:o.next=4;break;case 8:case"end":return o.stop()}}),o)})))()}},{key:"transform",value:function(t,e){return this._transformStreamWithConfig(t,this._transform.bind(this),e)}},{key:"stream",value:(r=Dt(St().mark((function t(e,r){var n,o,i,a;return St().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=function(){return(o=Qt(St().mark((function t(){return St().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e;case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)},n=function(){return o.apply(this,arguments)},i=(0,p.ZI)(r),a=new l.Tr({generator:this.transform(n(),i),config:i}),t.next=6,a.setup;case 6:return t.abrupt("return",l.bO.fromAsyncGenerator(a));case 7:case"end":return t.stop()}}),t,this)}))),function(t,e){return r.apply(this,arguments)})}],[{key:"lc_name",value:function(){return"RunnableMap"}},{key:"from",value:function(t){return new e({steps:t})}}]);var r,n}(ne),ce=function(t){function e(t){var r;if(Rt(this,e),r=Gt(this,e,[t]),Object.defineProperty(r,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(r,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(r,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),!(0,a.GZ)(t.func))throw new Error("RunnableTraceable requires a function that is wrapped in traceable higher-order function");return r.func=t.func,r}return qt(e,t),Bt(e,[{key:"invoke",value:(r=Dt(St().mark((function t(e,r){var n,o,i,a,u;return St().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this._getOptionsList(null!=r?r:{},1),o=Pt(n,1),i=o[0],t.next=3,(0,p.kJ)(i);case 3:return a=t.sent,u=this.func((0,p.tn)(i,{callbacks:a}),e),t.abrupt("return",(0,f.o)(u,null==i?void 0:i.signal));case 6:case"end":return t.stop()}}),t,this)}))),function(t,e){return r.apply(this,arguments)})},{key:"_streamIterator",value:function(t,e){var r=this;return Qt(St().mark((function n(){var o,i,a,u,s,c,l,f,p,h,d,y,v;return St().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=r._getOptionsList(null!=e?e:{},1),i=Pt(o,1),a=i[0],n.next=3,Xt(r.invoke(t,e));case 3:if(!ht(u=n.sent)){n.next=36;break}s=!1,c=!1,n.prev=7,f=Wt(u);case 9:return n.next=11,Xt(f.next());case 11:if(!(s=!(p=n.sent).done)){n.next=19;break}return h=p.value,null==a||null===(d=a.signal)||void 0===d||d.throwIfAborted(),n.next=16,h;case 16:s=!1,n.next=9;break;case 19:n.next=25;break;case 21:n.prev=21,n.t0=n.catch(7),c=!0,l=n.t0;case 25:if(n.prev=25,n.prev=26,!s||null==f.return){n.next=30;break}return n.next=30,Xt(f.return());case 30:if(n.prev=30,!c){n.next=33;break}throw l;case 33:return n.finish(30);case 34:return n.finish(25);case 35:return n.abrupt("return");case 36:if(null==(m=u)||"object"!==ct(m)||!("next"in m)||"function"!=typeof m.next){n.next=47;break}case 37:if(null==a||null===(y=a.signal)||void 0===y||y.throwIfAborted(),!(v=u.next()).done){n.next=42;break}return n.abrupt("break",46);case 42:return n.next=44,v.value;case 44:n.next=37;break;case 46:return n.abrupt("return");case 47:return n.next=49,u;case 49:case"end":return n.stop()}var m}),n,null,[[7,21,25,35],[26,,30,34]])})))()}}],[{key:"from",value:function(t){return new e({func:t})}}]);var r}(ne),le=function(t){function e(t){var r;return Rt(this,e),(0,a.GZ)(t.func)?Ut(r,ce.from(t.func)):(r=Gt(this,e,[t]),Object.defineProperty(r,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(r,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),function(t){if((0,a.GZ)(t))throw new Error("RunnableLambda requires a function that is not wrapped in traceable higher-order function. This shouldn't happen.")}(t.func),r.func=t.func,r)}return qt(e,t),Bt(e,[{key:"_invoke",value:(o=Dt(St().mark((function t(e,r,n){var o=this;return St().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,i){var a,u=(0,p.tn)(r,{callbacks:null==n?void 0:n.getChild(),recursionLimit:(null!==(a=null==r?void 0:r.recursionLimit)&&void 0!==a?a:p.p_)-1});D.N.runWithConfig(u,Dt(St().mark((function n(){var a,s,c,f,h,d,y,v,m,b,g,w,x,_,E;return St().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,o.func(e,Nt(Nt({},u),{},{config:u}));case 3:if(!(a=n.sent)||!ne.isRunnable(a)){n.next=12;break}if(0!==(null==r?void 0:r.recursionLimit)){n.next=7;break}throw new Error("Recursion limit reached.");case 7:return n.next=9,a.invoke(e,Nt(Nt({},u),{},{recursionLimit:(null!==(s=u.recursionLimit)&&void 0!==s?s:p.p_)-1}));case 9:a=n.sent,n.next=46;break;case 12:if(!ht(a)){n.next=45;break}f=!1,h=!1,n.prev=15,y=Wt(yt(u,a));case 17:return n.next=19,y.next();case 19:if(!(f=!(v=n.sent).done)){n.next=26;break}if(m=v.value,null==r||null===(b=r.signal)||void 0===b||b.throwIfAborted(),void 0===c)c=m;else try{c=(0,l.xW)(c,m)}catch(t){c=m}case 23:f=!1,n.next=17;break;case 26:n.next=32;break;case 28:n.prev=28,n.t0=n.catch(15),h=!0,d=n.t0;case 32:if(n.prev=32,n.prev=33,!f||null==y.return){n.next=37;break}return n.next=37,y.return();case 37:if(n.prev=37,!h){n.next=40;break}throw d;case 40:return n.finish(37);case 41:return n.finish(32);case 42:a=c,n.next=46;break;case 45:if(pt(a)){w=Ot(dt(u,a));try{for(w.s();!(x=w.n()).done;)if(E=x.value,null==r||null===(_=r.signal)||void 0===_||_.throwIfAborted(),void 0===g)g=E;else try{g=(0,l.xW)(g,E)}catch(t){g=E}}catch(t){w.e(t)}finally{w.f()}a=g}case 46:t(a),n.next=52;break;case 49:n.prev=49,n.t1=n.catch(0),i(n.t1);case 52:case"end":return n.stop()}}),n,null,[[0,49],[15,28,32,42],[33,,37,41]])}))))})));case 1:case"end":return t.stop()}}),t)}))),function(t,e,r){return o.apply(this,arguments)})},{key:"invoke",value:(n=Dt(St().mark((function t(e,r){return St().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this._callWithConfig(this._invoke,e,r));case 1:case"end":return t.stop()}}),t,this)}))),function(t,e){return n.apply(this,arguments)})},{key:"_transform",value:function(t,e,r){var n=this;return Qt(St().mark((function o(){var i,a,u,s,c,f,h,d,y,v,m,b,g,w,x,_,E,O,k,j,S,A,P,C,L,T,F,I;return St().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:u=!1,s=!1,o.prev=2,f=Wt(t);case 4:return o.next=6,Xt(f.next());case 6:if(!(u=!(h=o.sent).done)){o.next=12;break}if(d=h.value,void 0===a)a=d;else try{a=(0,l.xW)(a,d)}catch(t){a=d}case 9:u=!1,o.next=4;break;case 12:o.next=18;break;case 14:o.prev=14,o.t0=o.catch(2),s=!0,c=o.t0;case 18:if(o.prev=18,o.prev=19,!u||null==f.return){o.next=23;break}return o.next=23,Xt(f.return());case 23:if(o.prev=23,!s){o.next=26;break}throw c;case 26:return o.finish(23);case 27:return o.finish(18);case 28:return y=(0,p.tn)(r,{callbacks:null==e?void 0:e.getChild(),recursionLimit:(null!==(i=null==r?void 0:r.recursionLimit)&&void 0!==i?i:p.p_)-1}),o.next=31,Xt(new Promise((function(t,e){D.N.runWithConfig(y,Dt(St().mark((function r(){var o;return St().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,n.func(a,Nt(Nt({},y),{},{config:y}));case 3:o=r.sent,t(o),r.next=10;break;case 7:r.prev=7,r.t0=r.catch(0),e(r.t0);case 10:case"end":return r.stop()}}),r,null,[[0,7]])}))))})));case 31:if(!(v=o.sent)||!ne.isRunnable(v)){o.next=69;break}if(0!==(null==r?void 0:r.recursionLimit)){o.next=35;break}throw new Error("Recursion limit reached.");case 35:return o.next=37,Xt(v.stream(a,y));case 37:m=o.sent,b=!1,g=!1,o.prev=40,x=Wt(m);case 42:return o.next=44,Xt(x.next());case 44:if(!(b=!(_=o.sent).done)){o.next=51;break}return E=_.value,o.next=48,E;case 48:b=!1,o.next=42;break;case 51:o.next=57;break;case 53:o.prev=53,o.t1=o.catch(40),g=!0,w=o.t1;case 57:if(o.prev=57,o.prev=58,!b||null==x.return){o.next=62;break}return o.next=62,Xt(x.return());case 62:if(o.prev=62,!g){o.next=65;break}throw w;case 65:return o.finish(62);case 66:return o.finish(57);case 67:o.next=125;break;case 69:if(!ht(v)){o.next=102;break}O=!1,k=!1,o.prev=72,S=Wt(yt(y,v));case 74:return o.next=76,Xt(S.next());case 76:if(!(O=!(A=o.sent).done)){o.next=84;break}return P=A.value,null==r||null===(C=r.signal)||void 0===C||C.throwIfAborted(),o.next=81,P;case 81:O=!1,o.next=74;break;case 84:o.next=90;break;case 86:o.prev=86,o.t2=o.catch(72),k=!0,j=o.t2;case 90:if(o.prev=90,o.prev=91,!O||null==S.return){o.next=95;break}return o.next=95,Xt(S.return());case 95:if(o.prev=95,!k){o.next=98;break}throw j;case 98:return o.finish(95);case 99:return o.finish(90);case 100:o.next=125;break;case 102:if(!pt(v)){o.next=123;break}L=Ot(dt(y,v)),o.prev=104,L.s();case 106:if((T=L.n()).done){o.next=113;break}return I=T.value,null==r||null===(F=r.signal)||void 0===F||F.throwIfAborted(),o.next=111,I;case 111:o.next=106;break;case 113:o.next=118;break;case 115:o.prev=115,o.t3=o.catch(104),L.e(o.t3);case 118:return o.prev=118,L.f(),o.finish(118);case 121:o.next=125;break;case 123:return o.next=125,v;case 125:case"end":return o.stop()}}),o,null,[[2,14,18,28],[19,,23,27],[40,53,57,67],[58,,62,66],[72,86,90,100],[91,,95,99],[104,115,118,121]])})))()}},{key:"transform",value:function(t,e){return this._transformStreamWithConfig(t,this._transform.bind(this),e)}},{key:"stream",value:(r=Dt(St().mark((function t(e,r){var n,o,i,a;return St().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=function(){return(o=Qt(St().mark((function t(){return St().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e;case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)},n=function(){return o.apply(this,arguments)},i=(0,p.ZI)(r),a=new l.Tr({generator:this.transform(n(),i),config:i}),t.next=6,a.setup;case 6:return t.abrupt("return",l.bO.fromAsyncGenerator(a));case 7:case"end":return t.stop()}}),t,this)}))),function(t,e){return r.apply(this,arguments)})}],[{key:"lc_name",value:function(){return"RunnableLambda"}},{key:"from",value:function(t){return new e({func:t})}}]);var r,n,o}(ne),fe=function(t){function e(t){var r;return Rt(this,e),r=Gt(this,e,[t]),Object.defineProperty(r,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(r,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(r,"runnable",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(r,"fallbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),r.runnable=t.runnable,r.fallbacks=t.fallbacks,r}return qt(e,t),Bt(e,[{key:"runnables",value:St().mark((function t(){var e,r,n;return St().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.runnable;case 2:e=Ot(this.fallbacks),t.prev=3,e.s();case 5:if((r=e.n()).done){t.next=11;break}return n=r.value,t.next=9,n;case 9:t.next=5;break;case 11:t.next=16;break;case 13:t.prev=13,t.t0=t.catch(3),e.e(t.t0);case 16:return t.prev=16,e.f(),t.finish(16);case 19:case"end":return t.stop()}}),t,this,[[3,13,16,19]])}))},{key:"invoke",value:(n=Dt(St().mark((function t(e,r){var n,o,i,a,u,s,c,l,f,h,d;return St().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=(0,p.ZI)(r),t.next=3,(0,p.kJ)(r);case 3:return o=t.sent,i=n.runId,a=xt(n,gt),t.next=7,null==o?void 0:o.handleChainStart(this.toJSON(),re(e,"input"),i,void 0,void 0,void 0,null==a?void 0:a.runName);case 7:u=t.sent,c=Ot(this.runnables()),t.prev=9,c.s();case 11:if((l=c.n()).done){t.next=28;break}return h=l.value,null==n||null===(f=n.signal)||void 0===f||f.throwIfAborted(),t.prev=14,t.next=17,h.invoke(e,(0,p.tn)(a,{callbacks:null==u?void 0:u.getChild()}));case 17:return d=t.sent,t.next=20,null==u?void 0:u.handleChainEnd(re(d,"output"));case 20:return t.abrupt("return",d);case 23:t.prev=23,t.t0=t.catch(14),void 0===s&&(s=t.t0);case 26:t.next=11;break;case 28:t.next=33;break;case 30:t.prev=30,t.t1=t.catch(9),c.e(t.t1);case 33:return t.prev=33,c.f(),t.finish(33);case 36:if(void 0!==s){t.next=38;break}throw new Error("No error stored at end of fallback.");case 38:return t.next=40,null==u?void 0:u.handleChainError(s);case 40:throw s;case 41:case"end":return t.stop()}}),t,this,[[9,30,33,36],[14,23]])}))),function(t,e){return n.apply(this,arguments)})},{key:"_streamIterator",value:function(t,e){var r=this;return Qt(St().mark((function n(){var o,i,a,u,s,c,f,h,d,y,v,m,b,g,w,x,_,E,O,k,j;return St().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=(0,p.ZI)(e),n.next=3,Xt((0,p.kJ)(e));case 3:return i=n.sent,a=o.runId,u=xt(o,wt),n.next=7,Xt(null==i?void 0:i.handleChainStart(r.toJSON(),re(t,"input"),a,void 0,void 0,void 0,null==u?void 0:u.runName));case 7:s=n.sent,h=Ot(r.runnables()),n.prev=9,h.s();case 11:if((d=h.n()).done){n.next=27;break}return v=d.value,null==o||null===(y=o.signal)||void 0===y||y.throwIfAborted(),m=(0,p.tn)(u,{callbacks:null==s?void 0:s.getChild()}),n.prev=15,n.next=18,Xt(v.stream(t,m));case 18:return f=n.sent,n.abrupt("break",27);case 22:n.prev=22,n.t0=n.catch(15),void 0===c&&(c=n.t0);case 25:n.next=11;break;case 27:n.next=32;break;case 29:n.prev=29,n.t1=n.catch(9),h.e(n.t1);case 32:return n.prev=32,h.f(),n.finish(32);case 35:if(void 0!==f){n.next=40;break}return g=null!==(b=c)&&void 0!==b?b:new Error("No error stored at end of fallback."),n.next=39,Xt(null==s?void 0:s.handleChainError(g));case 39:throw g;case 40:n.prev=40,x=!1,_=!1,n.prev=43,O=Wt(f);case 45:return n.next=47,Xt(O.next());case 47:if(!(x=!(k=n.sent).done)){n.next=55;break}return j=k.value,n.next=51,j;case 51:try{w=void 0===w?w:(0,l.xW)(w,j)}catch(t){w=void 0}case 52:x=!1,n.next=45;break;case 55:n.next=61;break;case 57:n.prev=57,n.t2=n.catch(43),_=!0,E=n.t2;case 61:if(n.prev=61,n.prev=62,!x||null==O.return){n.next=66;break}return n.next=66,Xt(O.return());case 66:if(n.prev=66,!_){n.next=69;break}throw E;case 69:return n.finish(66);case 70:return n.finish(61);case 71:n.next=78;break;case 73:return n.prev=73,n.t3=n.catch(40),n.next=77,Xt(null==s?void 0:s.handleChainError(n.t3));case 77:throw n.t3;case 78:return n.next=80,Xt(null==s?void 0:s.handleChainEnd(re(w,"output")));case 80:case"end":return n.stop()}}),n,null,[[9,29,32,35],[15,22],[40,73],[43,57,61,71],[62,,66,70]])})))()}},{key:"batch",value:(r=Dt(St().mark((function t(e,r,n){var o,i,a,u,s,c,l,f,h=this;return St().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null==n||!n.returnExceptions){t.next=2;break}throw new Error("Not implemented.");case 2:return o=this._getOptionsList(null!=r?r:{},e.length),t.next=5,Promise.all(o.map((function(t){return(0,p.kJ)(t)})));case 5:return i=t.sent,t.next=8,Promise.all(i.map(function(){var t=Dt(St().mark((function t(r,n){var i;return St().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,null==r?void 0:r.handleChainStart(h.toJSON(),re(e[n],"input"),o[n].runId,void 0,void 0,void 0,o[n].runName);case 2:return i=t.sent,delete o[n].runId,t.abrupt("return",i);case 5:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}()));case 8:a=t.sent,s=Ot(this.runnables()),t.prev=10,l=St().mark((function t(){var r,i,s;return St().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=c.value,null===(r=o[0].signal)||void 0===r||r.throwIfAborted(),t.prev=2,t.next=5,i.batch(e,a.map((function(t,e){return(0,p.tn)(o[e],{callbacks:null==t?void 0:t.getChild()})})),n);case 5:return s=t.sent,t.next=8,Promise.all(a.map((function(t,e){return null==t?void 0:t.handleChainEnd(re(s[e],"output"))})));case 8:return t.abrupt("return",{v:s});case 11:t.prev=11,t.t0=t.catch(2),void 0===u&&(u=t.t0);case 14:case"end":return t.stop()}}),t,null,[[2,11]])})),s.s();case 13:if((c=s.n()).done){t.next=20;break}return t.delegateYield(l(),"t0",15);case 15:if(!(f=t.t0)){t.next=18;break}return t.abrupt("return",f.v);case 18:t.next=13;break;case 20:t.next=25;break;case 22:t.prev=22,t.t1=t.catch(10),s.e(t.t1);case 25:return t.prev=25,s.f(),t.finish(25);case 28:if(u){t.next=30;break}throw new Error("No error stored at end of fallbacks.");case 30:return t.next=32,Promise.all(a.map((function(t){return null==t?void 0:t.handleChainError(u)})));case 32:throw u;case 33:case"end":return t.stop()}}),t,this,[[10,22,25,28]])}))),function(t,e,n){return r.apply(this,arguments)})}],[{key:"lc_name",value:function(){return"RunnableWithFallbacks"}}]);var r,n}(ne);function pe(t){if("function"==typeof t)return new le({func:t});if(ne.isRunnable(t))return t;if(Array.isArray(t)||"object"!==Yt(t))throw new Error("Expected a Runnable, function or object.\nInstead got an unsupported type.");for(var e={},r=0,n=Object.entries(t);r<n.length;r++){var o=Pt(n[r],2),i=o[0],a=o[1];e[i]=pe(a)}return new se({steps:e})}var he=function(t){function e(t){var r;return Rt(this,e),t instanceof se&&(t={mapper:t}),r=Gt(this,e,[t]),Object.defineProperty(r,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(r,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(r,"mapper",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),r.mapper=t.mapper,r}return qt(e,t),Bt(e,[{key:"invoke",value:(n=Dt(St().mark((function t(e,r){var n;return St().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.mapper.invoke(e,r);case 2:return n=t.sent,t.abrupt("return",Nt(Nt({},e),n));case 4:case"end":return t.stop()}}),t,this)}))),function(t,e){return n.apply(this,arguments)})},{key:"_transform",value:function(t,e,r){var n=this;return Qt(St().mark((function o(){var i,a,u,s,c,f,h,d,y,v,m,b,g,w,x,_,E,O,k,j;return St().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:i=n.mapper.getStepsKeys(),a=(0,l.gI)(t),u=Pt(a,2),s=u[0],c=u[1],f=n.mapper.transform(c,(0,p.tn)(r,{callbacks:null==e?void 0:e.getChild()})),h=f.next(),d=!1,y=!1,o.prev=6,m=Wt(s);case 8:return o.next=10,Xt(m.next());case 10:if(!(d=!(b=o.sent).done)){o.next=21;break}if("object"===Yt(g=b.value)&&!Array.isArray(g)){o.next=14;break}throw new Error("RunnableAssign can only be used with objects as input, got ".concat(Yt(g)));case 14:if(w=Object.fromEntries(Object.entries(g).filter((function(t){var e=Pt(t,1)[0];return!i.includes(e)}))),!(Object.keys(w).length>0)){o.next=18;break}return o.next=18,w;case 18:d=!1,o.next=8;break;case 21:o.next=27;break;case 23:o.prev=23,o.t0=o.catch(6),y=!0,v=o.t0;case 27:if(o.prev=27,o.prev=28,!d||null==m.return){o.next=32;break}return o.next=32,Xt(m.return());case 32:if(o.prev=32,!y){o.next=35;break}throw v;case 35:return o.finish(32);case 36:return o.finish(27);case 37:return o.next=39,Xt(h);case 39:return o.next=41,o.sent.value;case 41:x=!1,_=!1,o.prev=43,O=Wt(f);case 45:return o.next=47,Xt(O.next());case 47:if(!(x=!(k=o.sent).done)){o.next=54;break}return j=k.value,o.next=51,j;case 51:x=!1,o.next=45;break;case 54:o.next=60;break;case 56:o.prev=56,o.t1=o.catch(43),_=!0,E=o.t1;case 60:if(o.prev=60,o.prev=61,!x||null==O.return){o.next=65;break}return o.next=65,Xt(O.return());case 65:if(o.prev=65,!_){o.next=68;break}throw E;case 68:return o.finish(65);case 69:return o.finish(60);case 70:case"end":return o.stop()}}),o,null,[[6,23,27,37],[28,,32,36],[43,56,60,70],[61,,65,69]])})))()}},{key:"transform",value:function(t,e){return this._transformStreamWithConfig(t,this._transform.bind(this),e)}},{key:"stream",value:(r=Dt(St().mark((function t(e,r){var n,o,i,a;return St().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=function(){return(o=Qt(St().mark((function t(){return St().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e;case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)},n=function(){return o.apply(this,arguments)},i=(0,p.ZI)(r),a=new l.Tr({generator:this.transform(n(),i),config:i}),t.next=6,a.setup;case 6:return t.abrupt("return",l.bO.fromAsyncGenerator(a));case 7:case"end":return t.stop()}}),t,this)}))),function(t,e){return r.apply(this,arguments)})}],[{key:"lc_name",value:function(){return"RunnableAssign"}}]);var r,n}(ne),de=function(t){function e(t){var r;return Rt(this,e),("string"==typeof t||Array.isArray(t))&&(t={keys:t}),r=Gt(this,e,[t]),Object.defineProperty(r,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(r,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(r,"keys",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),r.keys=t.keys,r}return qt(e,t),Bt(e,[{key:"_pick",value:(o=Dt(St().mark((function t(e){var r;return St().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("string"!=typeof this.keys){t.next=4;break}return t.abrupt("return",e[this.keys]);case 4:return r=this.keys.map((function(t){return[t,e[t]]})).filter((function(t){return void 0!==t[1]})),t.abrupt("return",0===r.length?void 0:Object.fromEntries(r));case 6:case"end":return t.stop()}}),t,this)}))),function(t){return o.apply(this,arguments)})},{key:"invoke",value:(n=Dt(St().mark((function t(e,r){return St().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this._callWithConfig(this._pick.bind(this),e,r));case 1:case"end":return t.stop()}}),t,this)}))),function(t,e){return n.apply(this,arguments)})},{key:"_transform",value:function(t){var e=this;return Qt(St().mark((function r(){var n,o,i,a,u,s,c;return St().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:n=!1,o=!1,r.prev=2,a=Wt(t);case 4:return r.next=6,Xt(a.next());case 6:if(!(n=!(u=r.sent).done)){r.next=17;break}return s=u.value,r.next=10,Xt(e._pick(s));case 10:if(void 0===(c=r.sent)){r.next=14;break}return r.next=14,c;case 14:n=!1,r.next=4;break;case 17:r.next=23;break;case 19:r.prev=19,r.t0=r.catch(2),o=!0,i=r.t0;case 23:if(r.prev=23,r.prev=24,!n||null==a.return){r.next=28;break}return r.next=28,Xt(a.return());case 28:if(r.prev=28,!o){r.next=31;break}throw i;case 31:return r.finish(28);case 32:return r.finish(23);case 33:case"end":return r.stop()}}),r,null,[[2,19,23,33],[24,,28,32]])})))()}},{key:"transform",value:function(t,e){return this._transformStreamWithConfig(t,this._transform.bind(this),e)}},{key:"stream",value:(r=Dt(St().mark((function t(e,r){var n,o,i,a;return St().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=function(){return(o=Qt(St().mark((function t(){return St().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e;case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)},n=function(){return o.apply(this,arguments)},i=(0,p.ZI)(r),a=new l.Tr({generator:this.transform(n(),i),config:i}),t.next=6,a.setup;case 6:return t.abrupt("return",l.bO.fromAsyncGenerator(a));case 7:case"end":return t.stop()}}),t,this)}))),function(t,e){return r.apply(this,arguments)})}],[{key:"lc_name",value:function(){return"RunnablePick"}}]);var r,n,o}(ne),ye=function(t){function e(t){var r,n;Rt(this,e);var o=ue.from([le.from(function(){var t=Dt(St().mark((function t(e){var r;return St().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(0,mt.K)(e)){t.next=12;break}return t.prev=1,t.next=4,n.schema.parseAsync(e.args);case 4:r=t.sent,t.next=10;break;case 7:throw t.prev=7,t.t0=t.catch(1),new mt.q("Received tool input did not match expected schema",JSON.stringify(e.args));case 10:t.next=13;break;case 12:r=e;case 13:return t.abrupt("return",r);case 14:case"end":return t.stop()}}),t,null,[[1,7]])})));return function(e){return t.apply(this,arguments)}}()).withConfig({runName:"".concat(t.name,":parse_input")}),t.bound]).withConfig({runName:t.name});return n=Gt(this,e,[{bound:o,config:null!==(r=t.config)&&void 0!==r?r:{}}]),Object.defineProperty(n,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(n,"description",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(n,"schema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),n.name=t.name,n.description=t.description,n.schema=t.schema,n}return qt(e,t),Bt(e,null,[{key:"lc_name",value:function(){return"RunnableToolLike"}}])}(oe)},1974:(t,e,r)=>{"use strict";r.d(e,{SV:()=>g,ZI:()=>x,kJ:()=>m,p_:()=>v,tn:()=>_});var n=r(9126),o=r(2782),i=["runId","runName"];function a(){a=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",l=i.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,r){return t[e]=r}}function p(t,e,r,n){var i=e&&e.prototype instanceof g?e:g,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:A(t,r,u)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=p;var d="suspendedStart",y="suspendedYield",v="executing",m="completed",b={};function g(){}function w(){}function x(){}var _={};f(_,s,(function(){return this}));var E=Object.getPrototypeOf,O=E&&E(E(T([])));O&&O!==r&&n.call(O,s)&&(_=O);var k=x.prototype=g.prototype=Object.create(_);function j(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,s){var c=h(t[o],t,i);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==u(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function A(e,r,n){var o=d;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=D(u,n);if(s){if(s===b)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var c=h(e,r,n);if("normal"===c.type){if(o=n.done?m:y,c.arg===b)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=m,n.method="throw",n.arg=c.arg)}}}function D(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,D(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,b;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,b):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,b)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[s];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(u(e)+" is not iterable")}return w.prototype=x,o(k,"constructor",{value:x,configurable:!0}),o(x,"constructor",{value:w,configurable:!0}),w.displayName=f(x,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,f(t,l,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},j(S.prototype),f(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(p(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},j(k),f(k,l,"Generator"),f(k,s,(function(){return this})),f(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,b):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),C(r),b}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;C(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),b}},e}function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function s(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],s=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);s=!0);}catch(t){c=!0,o=t}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(t,e)||h(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function l(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?c(Object(r),!0).forEach((function(e){f(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function f(t,e,r){return(e=function(t){var e=function(t){if("object"!=u(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==u(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function p(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=h(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}function h(t,e){if(t){if("string"==typeof t)return d(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?d(t,e):void 0}}function d(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function y(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}var v=25;function m(t){return b.apply(this,arguments)}function b(){var t;return t=a().mark((function t(e){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",n.Td._configureSync(null==e?void 0:e.callbacks,void 0,null==e?void 0:e.tags,void 0,null==e?void 0:e.metadata));case 1:case"end":return t.stop()}}),t)})),b=function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){y(i,n,o,a,u,"next",t)}function u(t){y(i,n,o,a,u,"throw",t)}a(void 0)}))},b.apply(this,arguments)}function g(){for(var t={},e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];var i,a,u=p(r.filter((function(t){return!!t})));try{for(u.s();!(i=u.n()).done;)for(var s=i.value,c=0,f=Object.keys(s);c<f.length;c++){var y=f[c];if("metadata"===y)t[y]=l(l({},t[y]),s[y]);else if("tags"===y){var v,m,b=null!==(v=t[y])&&void 0!==v?v:[];t[y]=function(t){if(Array.isArray(t))return d(t)}(a=new Set(b.concat(null!==(m=s[y])&&void 0!==m?m:[])))||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(a)||h(a)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}else if("configurable"===y)t[y]=l(l({},t[y]),s[y]);else if("timeout"===y)void 0===t.timeout?t.timeout=s.timeout:void 0!==s.timeout&&(t.timeout=Math.min(t.timeout,s.timeout));else if("signal"===y)void 0===t.signal?t.signal=s.signal:void 0!==s.signal&&("any"in AbortSignal?t.signal=AbortSignal.any([t.signal,s.signal]):t.signal=s.signal);else if("callbacks"===y){var g=t.callbacks,w=s.callbacks;if(Array.isArray(w))if(g)if(Array.isArray(g))t.callbacks=g.concat(w);else{var x,_=g.copy(),E=p(w);try{for(E.s();!(x=E.n()).done;){var O=x.value;_.addHandler((0,n.tW)(O),!0)}}catch(t){E.e(t)}finally{E.f()}t.callbacks=_}else t.callbacks=w;else if(w)if(g)if(Array.isArray(g)){var k,j=w.copy(),S=p(g);try{for(S.s();!(k=S.n()).done;){var A=k.value;j.addHandler((0,n.tW)(A),!0)}}catch(t){S.e(t)}finally{S.f()}t.callbacks=j}else t.callbacks=new n.Td(w._parentRunId,{handlers:g.handlers.concat(w.handlers),inheritableHandlers:g.inheritableHandlers.concat(w.inheritableHandlers),tags:Array.from(new Set(g.tags.concat(w.tags))),inheritableTags:Array.from(new Set(g.inheritableTags.concat(w.inheritableTags))),metadata:l(l({},g.metadata),w.metadata)});else t.callbacks=w}else{var D,P=y;t[P]=null!==(D=s[P])&&void 0!==D?D:t[P]}}}catch(t){u.e(t)}finally{u.f()}return t}var w=new Set(["string","number","boolean"]);function x(t){var e,r=o.N.getRunnableConfig(),n={tags:[],metadata:{},recursionLimit:25,runId:void 0};if(r){r.runId,r.runName;var a=function(t,e){if(null==t)return{};var r,n,o=function(t,e){if(null==t)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.includes(n))continue;r[n]=t[n]}return r}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.includes(r)||{}.propertyIsEnumerable.call(t,r)&&(o[r]=t[r])}return o}(r,i);n=Object.entries(a).reduce((function(t,e){var r=s(e,2),n=r[0],o=r[1];return void 0!==o&&(t[n]=o),t}),n)}if(t&&(n=Object.entries(t).reduce((function(t,e){var r=s(e,2),n=r[0],o=r[1];return void 0!==o&&(t[n]=o),t}),n)),null!==(e=n)&&void 0!==e&&e.configurable)for(var c=0,l=Object.keys(n.configurable);c<l.length;c++){var f,p=l[c];!w.has(u(n.configurable[p]))||null!==(f=n.metadata)&&void 0!==f&&f[p]||(n.metadata||(n.metadata={}),n.metadata[p]=n.configurable[p])}if(void 0!==n.timeout){if(n.timeout<=0)throw new Error("Timeout must be a positive number");var h=AbortSignal.timeout(n.timeout);void 0!==n.signal?"any"in AbortSignal&&(n.signal=AbortSignal.any([n.signal,h])):n.signal=h,delete n.timeout}return n}function _(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.callbacks,n=e.maxConcurrency,o=e.recursionLimit,i=e.runName,a=e.configurable,u=e.runId,s=x(t);return void 0!==r&&(delete s.runName,s.callbacks=r),void 0!==o&&(s.recursionLimit=o),void 0!==n&&(s.maxConcurrency=n),void 0!==i&&(s.runName=i),void 0!==a&&(s.configurable=l(l({},s.configurable),a)),void 0!==u&&delete s.runId,s}},7258:(t,e,r)=>{"use strict";r.d(e,{YN:()=>n.YN,kI:()=>i.k,zZ:()=>n.zZ,ZI:()=>o.ZI,tn:()=>o.tn});var n=r(7889),o=r(1974),i=r(5520);function a(t){var e,r;function n(e,r){try{var i=t[e](r),a=i.value,s=a instanceof u;Promise.resolve(s?a.v:a).then((function(r){if(s){var u="return"===e?"return":"next";if(!a.k||r.done)return n(u,r);r=t[u](r).value}o(i.done?"return":"normal",r)}),(function(t){n("throw",t)}))}catch(t){o("throw",t)}}function o(t,o){switch(t){case"return":e.resolve({value:o,done:!0});break;case"throw":e.reject(o);break;default:e.resolve({value:o,done:!1})}(e=e.next)?n(e.key,e.arg):r=null}this._invoke=function(t,o){return new Promise((function(i,a){var u={key:t,arg:o,resolve:i,reject:a,next:null};r?r=r.next=u:(e=r=u,n(t,o))}))},"function"!=typeof t.return&&(this.return=void 0)}function u(t,e){this.v=t,this.k=e}r(2613),a.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},a.prototype.next=function(t){return this._invoke("next",t)},a.prototype.throw=function(t){return this._invoke("throw",t)},a.prototype.return=function(t){return this._invoke("return",t)},r(6641)},5520:(t,e,r)=>{"use strict";r.d(e,{k:()=>g});var n=r(2613),o=r(7889),i=r(1974);function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function u(){u=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",l=i.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,r){return t[e]=r}}function p(t,e,r,n){var i=e&&e.prototype instanceof g?e:g,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:A(t,r,u)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=p;var d="suspendedStart",y="suspendedYield",v="executing",m="completed",b={};function g(){}function w(){}function x(){}var _={};f(_,s,(function(){return this}));var E=Object.getPrototypeOf,O=E&&E(E(T([])));O&&O!==r&&n.call(O,s)&&(_=O);var k=x.prototype=g.prototype=Object.create(_);function j(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,u,s){var c=h(t[o],t,i);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==a(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,u,s)}),(function(t){r("throw",t,u,s)})):e.resolve(f).then((function(t){l.value=t,u(l)}),(function(t){return r("throw",t,u,s)}))}s(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function A(e,r,n){var o=d;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=D(u,n);if(s){if(s===b)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var c=h(e,r,n);if("normal"===c.type){if(o=n.done?m:y,c.arg===b)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=m,n.method="throw",n.arg=c.arg)}}}function D(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,D(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,b;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,b):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,b)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[s];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(a(e)+" is not iterable")}return w.prototype=x,o(k,"constructor",{value:x,configurable:!0}),o(x,"constructor",{value:w,configurable:!0}),w.displayName=f(x,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,f(t,l,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},j(S.prototype),f(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(p(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},j(k),f(k,l,"Generator"),f(k,s,(function(){return this})),f(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,b):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),C(r),b}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;C(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),b}},e}function s(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function c(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,l(n.key),n)}}function l(t){var e=function(t){if("object"!=a(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==a(e)?e:e+""}function f(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(f=function(){return!!t})()}function p(t){return p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},p(t)}function h(t,e){return h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},h(t,e)}function d(t){return new v(t,0)}function y(t){var e,r;function n(e,r){try{var i=t[e](r),a=i.value,u=a instanceof v;Promise.resolve(u?a.v:a).then((function(r){if(u){var s="return"===e?"return":"next";if(!a.k||r.done)return n(s,r);r=t[s](r).value}o(i.done?"return":"normal",r)}),(function(t){n("throw",t)}))}catch(t){o("throw",t)}}function o(t,o){switch(t){case"return":e.resolve({value:o,done:!0});break;case"throw":e.reject(o);break;default:e.resolve({value:o,done:!1})}(e=e.next)?n(e.key,e.arg):r=null}this._invoke=function(t,o){return new Promise((function(i,a){var u={key:t,arg:o,resolve:i,reject:a,next:null};r?r=r.next=u:(e=r=u,n(t,o))}))},"function"!=typeof t.return&&(this.return=void 0)}function v(t,e){this.v=t,this.k=e}function m(t){var e,r,n,o=2;for("undefined"!=typeof Symbol&&(r=Symbol.asyncIterator,n=Symbol.iterator);o--;){if(r&&null!=(e=t[r]))return e.call(t);if(n&&null!=(e=t[n]))return new b(e.call(t));r="@@asyncIterator",n="@@iterator"}throw new TypeError("Object is not async iterable")}function b(t){function e(t){if(Object(t)!==t)return Promise.reject(new TypeError(t+" is not an object."));var e=t.done;return Promise.resolve(t.value).then((function(t){return{value:t,done:e}}))}return b=function(t){this.s=t,this.n=t.next},b.prototype={s:null,n:null,next:function(){return e(this.n.apply(this.s,arguments))},return:function(t){var r=this.s.return;return void 0===r?Promise.resolve({value:t,done:!0}):e(r.apply(this.s,arguments))},throw:function(t){var r=this.s.return;return void 0===r?Promise.reject(t):e(r.apply(this.s,arguments))}},new b(t)}y.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},y.prototype.next=function(t){return this._invoke("next",t)},y.prototype.throw=function(t){return this._invoke("throw",t)},y.prototype.return=function(t){return this._invoke("return",t)};var g=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=function(t,e,r){return e=p(e),function(t,e){if(e&&("object"==a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,f()?Reflect.construct(e,r||[],p(t).constructor):e.apply(t,r))}(this,e,[t]),Object.defineProperty(r,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(r,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(r,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),t&&(r.func=t.func),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&h(t,e)}(e,t),r=e,l=[{key:"invoke",value:(b=u().mark((function t(e,r){var n;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=(0,i.ZI)(r),!this.func){t.next=4;break}return t.next=4,this.func(e,n);case 4:return t.abrupt("return",this._callWithConfig((function(t){return Promise.resolve(t)}),e,n));case 5:case"end":return t.stop()}}),t,this)})),g=function(){var t=this,e=arguments;return new Promise((function(r,n){var o=b.apply(t,e);function i(t){s(o,r,n,i,a,"next",t)}function a(t){s(o,r,n,i,a,"throw",t)}i(void 0)}))},function(t,e){return g.apply(this,arguments)})},{key:"transform",value:function(t,e){var r,o=this;return(r=u().mark((function r(){var a,s,c,l,f,p,h,y,v;return u().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:a=(0,i.ZI)(e),c=!0,l=!1,f=!1,r.prev=4,h=m(o._transformStreamWithConfig(t,(function(t){return t}),a));case 6:return r.next=8,d(h.next());case 8:if(!(l=!(y=r.sent).done)){r.next=16;break}return v=y.value,r.next=12,v;case 12:if(c)if(void 0===s)s=v;else try{s=(0,n.xW)(s,v)}catch(t){s=void 0,c=!1}case 13:l=!1,r.next=6;break;case 16:r.next=22;break;case 18:r.prev=18,r.t0=r.catch(4),f=!0,p=r.t0;case 22:if(r.prev=22,r.prev=23,!l||null==h.return){r.next=27;break}return r.next=27,d(h.return());case 27:if(r.prev=27,!f){r.next=30;break}throw p;case 30:return r.finish(27);case 31:return r.finish(22);case 32:if(!o.func||void 0===s){r.next=35;break}return r.next=35,d(o.func(s,a));case 35:case"end":return r.stop()}}),r,null,[[4,18,22,32],[23,,27,31]])})),function(){return new y(r.apply(this,arguments))})()}}],v=[{key:"lc_name",value:function(){return"RunnablePassthrough"}},{key:"assign",value:function(t){return new o.B2(new o.ck({steps:t}))}}],l&&c(r.prototype,l),v&&c(r,v),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,l,v,b,g}(o.YN)},2782:(t,e,r)=>{"use strict";r.d(e,{N:()=>v});var n=r(3836),o=r(9126);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function a(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function u(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?a(Object(r),!0).forEach((function(e){s(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function s(t,e,r){return(e=p(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,p(n.key),n)}}function f(t,e,r){return e&&l(t.prototype,e),r&&l(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function p(t){var e=function(t){if("object"!=i(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==i(e)?e:e+""}var h=new(function(){return f((function t(){c(this,t)}),[{key:"getStore",value:function(){}},{key:"run",value:function(t,e){return e()}}])}()),d=Symbol.for("ls:tracing_async_local_storage"),y=Symbol.for("lc:child_config"),v=new(function(){return f((function t(){c(this,t)}),[{key:"getInstance",value:function(){var t;return null!==(t=globalThis[d])&&void 0!==t?t:h}},{key:"getRunnableConfig",value:function(){var t;return null===(t=this.getInstance().getStore())||void 0===t||null===(t=t.extra)||void 0===t?void 0:t[y]}},{key:"runWithConfig",value:function(t,e,r){var i,a,c=o.Td._configureSync(null==t?void 0:t.callbacks,void 0,null==t?void 0:t.tags,void 0,null==t?void 0:t.metadata),l=this.getInstance(),f=null==c?void 0:c.getParentRunId(),p=null==c||null===(i=c.handlers)||void 0===i?void 0:i.find((function(t){return"langchain_tracer"===(null==t?void 0:t.name)}));return p&&f?a=p.convertToRunTree(f):r||(a=new n.gk({name:"<runnable_lambda>",tracingEnabled:!1})),a&&(a.extra=u(u({},a.extra),{},s({},y,t))),l.run(a,e)}},{key:"initializeGlobalInstance",value:function(t){void 0===globalThis[d]&&(globalThis[d]=t)}}])}())},8662:(t,e,r)=>{"use strict";function n(t){var e="function"==typeof Map?new Map:void 0;return n=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(e){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return function(t,e,r){if(o())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,e);var a=new(t.bind.apply(t,n));return r&&i(a,r.prototype),a}(t,arguments,a(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),i(r,t)},n(t)}function o(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(o=function(){return!!t})()}function i(t,e){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},i(t,e)}function a(t){return a=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},a(t)}function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function s(t){return!(!t||"object"!==u(t)||!("type"in t)||"tool_call"!==t.type)}r.d(e,{K:()=>s,q:()=>c});var c=function(t){function e(t,r){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=function(t,e,r){return e=a(e),function(t,e){if(e&&("object"==u(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,o()?Reflect.construct(e,r||[],a(t).constructor):e.apply(t,r))}(this,e,[t]),Object.defineProperty(n,"output",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),n.output=r,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&i(t,e)}(e,t),r=e,Object.defineProperty(r,"prototype",{writable:!1}),r;var r}(n(Error))},4277:(t,e,r)=>{"use strict";function n(){n=function(){return e};var t,e={},r=Object.prototype,o=r.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},u=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function f(t,e,r,n){var o=e&&e.prototype instanceof g?e:g,a=Object.create(o.prototype),u=new L(n||[]);return i(a,"_invoke",{value:A(t,r,u)}),a}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=f;var h="suspendedStart",y="suspendedYield",v="executing",m="completed",b={};function g(){}function w(){}function x(){}var _={};l(_,u,(function(){return this}));var E=Object.getPrototypeOf,O=E&&E(E(T([])));O&&O!==r&&o.call(O,u)&&(_=O);var k=x.prototype=g.prototype=Object.create(_);function j(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(n,i,a,u){var s=p(t[n],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==d(l)&&o.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var n;i(this,"_invoke",{value:function(t,o){function i(){return new e((function(e,n){r(t,o,e,n)}))}return n=n?n.then(i,i):i()}})}function A(e,r,n){var o=h;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=D(u,n);if(s){if(s===b)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var c=p(e,r,n);if("normal"===c.type){if(o=n.done?m:y,c.arg===b)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=m,n.method="throw",n.arg=c.arg)}}}function D(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,D(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;var i=p(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,b;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,b):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,b)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[u];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function r(){for(;++n<e.length;)if(o.call(e,n))return r.value=e[n],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(d(e)+" is not iterable")}return w.prototype=x,i(k,"constructor",{value:x,configurable:!0}),i(x,"constructor",{value:w,configurable:!0}),w.displayName=l(x,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,l(t,c,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},j(S.prototype),l(S.prototype,s,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(f(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},j(k),l(k,c,"Generator"),l(k,u,(function(){return this})),l(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var s=o.call(a,"catchLoc"),c=o.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,b):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),C(r),b}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;C(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),b}},e}function o(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function i(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var a=t.apply(e,r);function u(t){o(a,n,i,u,s,"next",t)}function s(t){o(a,n,i,u,s,"throw",t)}u(void 0)}))}}function a(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function u(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?a(Object(r),!0).forEach((function(e){p(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,h(n.key),n)}}function c(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(c=function(){return!!t})()}function l(t){return l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},l(t)}function f(t,e){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},f(t,e)}function p(t,e,r){return(e=h(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function h(t){var e=function(t){if("object"!=d(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=d(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==d(e)?e:e+""}function d(t){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d(t)}function y(t,e){return t&&!Array.isArray(t)&&"object"===d(t)?t:p({},e,t)}function v(t){return"function"==typeof t._addRunToRunMap}r.d(e,{J:()=>m,j:()=>v});var m=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=function(t,e,r){return e=l(e),function(t,e){if(e&&("object"==d(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,c()?Reflect.construct(e,r||[],l(t).constructor):e.apply(t,r))}(this,e,arguments),Object.defineProperty(r,"runMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&f(t,e)}(e,t),r=e,o=[{key:"copy",value:function(){return this}},{key:"stringifyError",value:function(t){return t instanceof Error?t.message+(null!=t&&t.stack?"\n\n".concat(t.stack):""):"string"==typeof t?t:"".concat(t)}},{key:"_addChildRun",value:function(t,e){t.child_runs.push(e)}},{key:"_addRunToRunMap",value:function(t){var e,r,n,o=(e=t.start_time,r=t.id,n=t.execution_order.toFixed(0).slice(0,3).padStart(3,"0"),"".concat(new Date(e).toISOString().slice(0,-1)).concat(n,"Z").replace(/[-:.]/g,"")+r),i=u({},t);if(void 0!==i.parent_run_id){var a=this.runMap.get(i.parent_run_id);a&&(this._addChildRun(a,i),a.child_execution_order=Math.max(a.child_execution_order,i.child_execution_order),i.trace_id=a.trace_id,void 0!==a.dotted_order&&(i.dotted_order=[a.dotted_order,o].join(".")))}else i.trace_id=i.id,i.dotted_order=o;return this.runMap.set(i.id,i),i}},{key:"_endTrace",value:(P=i(n().mark((function t(e){var r,o;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(o=void 0!==e.parent_run_id&&this.runMap.get(e.parent_run_id))){t.next=5;break}o.child_execution_order=Math.max(o.child_execution_order,e.child_execution_order),t.next=7;break;case 5:return t.next=7,this.persistRun(e);case 7:return this.runMap.delete(e.id),t.next=10,null===(r=this.onRunUpdate)||void 0===r?void 0:r.call(this,e);case 10:case"end":return t.stop()}}),t,this)}))),function(t){return P.apply(this,arguments)})},{key:"_getExecutionOrder",value:function(t){var e=void 0!==t&&this.runMap.get(t);return e?e.child_execution_order+1:1}},{key:"_createRunForLLMStart",value:function(t,e,r,n,o,i,a,s){var c=this._getExecutionOrder(n),l=Date.now(),f=a?u(u({},o),{},{metadata:a}):o,p={id:r,name:null!=s?s:t.id[t.id.length-1],parent_run_id:n,start_time:l,serialized:t,events:[{name:"start",time:new Date(l).toISOString()}],inputs:{prompts:e},execution_order:c,child_runs:[],child_execution_order:c,run_type:"llm",extra:null!=f?f:{},tags:i||[]};return this._addRunToRunMap(p)}},{key:"handleLLMStart",value:(D=i(n().mark((function t(e,r,o,i,a,u,s,c){var l,f,p,h;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return h=null!==(l=this.runMap.get(o))&&void 0!==l?l:this._createRunForLLMStart(e,r,o,i,a,u,s,c),t.next=3,null===(f=this.onRunCreate)||void 0===f?void 0:f.call(this,h);case 3:return t.next=5,null===(p=this.onLLMStart)||void 0===p?void 0:p.call(this,h);case 5:return t.abrupt("return",h);case 6:case"end":return t.stop()}}),t,this)}))),function(t,e,r,n,o,i,a,u){return D.apply(this,arguments)})},{key:"_createRunForChatModelStart",value:function(t,e,r,n,o,i,a,s){var c=this._getExecutionOrder(n),l=Date.now(),f=a?u(u({},o),{},{metadata:a}):o,p={id:r,name:null!=s?s:t.id[t.id.length-1],parent_run_id:n,start_time:l,serialized:t,events:[{name:"start",time:new Date(l).toISOString()}],inputs:{messages:e},execution_order:c,child_runs:[],child_execution_order:c,run_type:"llm",extra:null!=f?f:{},tags:i||[]};return this._addRunToRunMap(p)}},{key:"handleChatModelStart",value:(A=i(n().mark((function t(e,r,o,i,a,u,s,c){var l,f,p,h;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return h=null!==(l=this.runMap.get(o))&&void 0!==l?l:this._createRunForChatModelStart(e,r,o,i,a,u,s,c),t.next=3,null===(f=this.onRunCreate)||void 0===f?void 0:f.call(this,h);case 3:return t.next=5,null===(p=this.onLLMStart)||void 0===p?void 0:p.call(this,h);case 5:return t.abrupt("return",h);case 6:case"end":return t.stop()}}),t,this)}))),function(t,e,r,n,o,i,a,u){return A.apply(this,arguments)})},{key:"handleLLMEnd",value:(S=i(n().mark((function t(e,r){var o,i;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((i=this.runMap.get(r))&&"llm"===(null==i?void 0:i.run_type)){t.next=3;break}throw new Error("No LLM run to end.");case 3:return i.end_time=Date.now(),i.outputs=e,i.events.push({name:"end",time:new Date(i.end_time).toISOString()}),t.next=8,null===(o=this.onLLMEnd)||void 0===o?void 0:o.call(this,i);case 8:return t.next=10,this._endTrace(i);case 10:return t.abrupt("return",i);case 11:case"end":return t.stop()}}),t,this)}))),function(t,e){return S.apply(this,arguments)})},{key:"handleLLMError",value:(j=i(n().mark((function t(e,r){var o,i;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((i=this.runMap.get(r))&&"llm"===(null==i?void 0:i.run_type)){t.next=3;break}throw new Error("No LLM run to end.");case 3:return i.end_time=Date.now(),i.error=this.stringifyError(e),i.events.push({name:"error",time:new Date(i.end_time).toISOString()}),t.next=8,null===(o=this.onLLMError)||void 0===o?void 0:o.call(this,i);case 8:return t.next=10,this._endTrace(i);case 10:return t.abrupt("return",i);case 11:case"end":return t.stop()}}),t,this)}))),function(t,e){return j.apply(this,arguments)})},{key:"_createRunForChainStart",value:function(t,e,r,n,o,i,a,u){var s=this._getExecutionOrder(n),c=Date.now(),l={id:r,name:null!=u?u:t.id[t.id.length-1],parent_run_id:n,start_time:c,serialized:t,events:[{name:"start",time:new Date(c).toISOString()}],inputs:e,execution_order:s,child_execution_order:s,run_type:null!=a?a:"chain",child_runs:[],extra:i?{metadata:i}:{},tags:o||[]};return this._addRunToRunMap(l)}},{key:"handleChainStart",value:(k=i(n().mark((function t(e,r,o,i,a,u,s,c){var l,f,p,h;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return h=null!==(l=this.runMap.get(o))&&void 0!==l?l:this._createRunForChainStart(e,r,o,i,a,u,s,c),t.next=3,null===(f=this.onRunCreate)||void 0===f?void 0:f.call(this,h);case 3:return t.next=5,null===(p=this.onChainStart)||void 0===p?void 0:p.call(this,h);case 5:return t.abrupt("return",h);case 6:case"end":return t.stop()}}),t,this)}))),function(t,e,r,n,o,i,a,u){return k.apply(this,arguments)})},{key:"handleChainEnd",value:(O=i(n().mark((function t(e,r,o,i,a){var u,s;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s=this.runMap.get(r)){t.next=3;break}throw new Error("No chain run to end.");case 3:return s.end_time=Date.now(),s.outputs=y(e,"output"),s.events.push({name:"end",time:new Date(s.end_time).toISOString()}),void 0!==(null==a?void 0:a.inputs)&&(s.inputs=y(a.inputs,"input")),t.next=9,null===(u=this.onChainEnd)||void 0===u?void 0:u.call(this,s);case 9:return t.next=11,this._endTrace(s);case 11:return t.abrupt("return",s);case 12:case"end":return t.stop()}}),t,this)}))),function(t,e,r,n,o){return O.apply(this,arguments)})},{key:"handleChainError",value:(E=i(n().mark((function t(e,r,o,i,a){var u,s;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s=this.runMap.get(r)){t.next=3;break}throw new Error("No chain run to end.");case 3:return s.end_time=Date.now(),s.error=this.stringifyError(e),s.events.push({name:"error",time:new Date(s.end_time).toISOString()}),void 0!==(null==a?void 0:a.inputs)&&(s.inputs=y(a.inputs,"input")),t.next=9,null===(u=this.onChainError)||void 0===u?void 0:u.call(this,s);case 9:return t.next=11,this._endTrace(s);case 11:return t.abrupt("return",s);case 12:case"end":return t.stop()}}),t,this)}))),function(t,e,r,n,o){return E.apply(this,arguments)})},{key:"_createRunForToolStart",value:function(t,e,r,n,o,i,a){var u=this._getExecutionOrder(n),s=Date.now(),c={id:r,name:null!=a?a:t.id[t.id.length-1],parent_run_id:n,start_time:s,serialized:t,events:[{name:"start",time:new Date(s).toISOString()}],inputs:{input:e},execution_order:u,child_execution_order:u,run_type:"tool",child_runs:[],extra:i?{metadata:i}:{},tags:o||[]};return this._addRunToRunMap(c)}},{key:"handleToolStart",value:(_=i(n().mark((function t(e,r,o,i,a,u,s){var c,l,f,p;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return p=null!==(c=this.runMap.get(o))&&void 0!==c?c:this._createRunForToolStart(e,r,o,i,a,u,s),t.next=3,null===(l=this.onRunCreate)||void 0===l?void 0:l.call(this,p);case 3:return t.next=5,null===(f=this.onToolStart)||void 0===f?void 0:f.call(this,p);case 5:return t.abrupt("return",p);case 6:case"end":return t.stop()}}),t,this)}))),function(t,e,r,n,o,i,a){return _.apply(this,arguments)})},{key:"handleToolEnd",value:(x=i(n().mark((function t(e,r){var o,i;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((i=this.runMap.get(r))&&"tool"===(null==i?void 0:i.run_type)){t.next=3;break}throw new Error("No tool run to end");case 3:return i.end_time=Date.now(),i.outputs={output:e},i.events.push({name:"end",time:new Date(i.end_time).toISOString()}),t.next=8,null===(o=this.onToolEnd)||void 0===o?void 0:o.call(this,i);case 8:return t.next=10,this._endTrace(i);case 10:return t.abrupt("return",i);case 11:case"end":return t.stop()}}),t,this)}))),function(t,e){return x.apply(this,arguments)})},{key:"handleToolError",value:(w=i(n().mark((function t(e,r){var o,i;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((i=this.runMap.get(r))&&"tool"===(null==i?void 0:i.run_type)){t.next=3;break}throw new Error("No tool run to end");case 3:return i.end_time=Date.now(),i.error=this.stringifyError(e),i.events.push({name:"error",time:new Date(i.end_time).toISOString()}),t.next=8,null===(o=this.onToolError)||void 0===o?void 0:o.call(this,i);case 8:return t.next=10,this._endTrace(i);case 10:return t.abrupt("return",i);case 11:case"end":return t.stop()}}),t,this)}))),function(t,e){return w.apply(this,arguments)})},{key:"handleAgentAction",value:(g=i(n().mark((function t(e,r){var o,i,a;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((i=this.runMap.get(r))&&"chain"===(null==i?void 0:i.run_type)){t.next=3;break}return t.abrupt("return");case 3:return(a=i).actions=a.actions||[],a.actions.push(e),a.events.push({name:"agent_action",time:(new Date).toISOString(),kwargs:{action:e}}),t.next=9,null===(o=this.onAgentAction)||void 0===o?void 0:o.call(this,i);case 9:case"end":return t.stop()}}),t,this)}))),function(t,e){return g.apply(this,arguments)})},{key:"handleAgentEnd",value:(b=i(n().mark((function t(e,r){var o,i;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((i=this.runMap.get(r))&&"chain"===(null==i?void 0:i.run_type)){t.next=3;break}return t.abrupt("return");case 3:return i.events.push({name:"agent_end",time:(new Date).toISOString(),kwargs:{action:e}}),t.next=6,null===(o=this.onAgentEnd)||void 0===o?void 0:o.call(this,i);case 6:case"end":return t.stop()}}),t,this)}))),function(t,e){return b.apply(this,arguments)})},{key:"_createRunForRetrieverStart",value:function(t,e,r,n,o,i,a){var u=this._getExecutionOrder(n),s=Date.now(),c={id:r,name:null!=a?a:t.id[t.id.length-1],parent_run_id:n,start_time:s,serialized:t,events:[{name:"start",time:new Date(s).toISOString()}],inputs:{query:e},execution_order:u,child_execution_order:u,run_type:"retriever",child_runs:[],extra:i?{metadata:i}:{},tags:o||[]};return this._addRunToRunMap(c)}},{key:"handleRetrieverStart",value:(m=i(n().mark((function t(e,r,o,i,a,u,s){var c,l,f,p;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return p=null!==(c=this.runMap.get(o))&&void 0!==c?c:this._createRunForRetrieverStart(e,r,o,i,a,u,s),t.next=3,null===(l=this.onRunCreate)||void 0===l?void 0:l.call(this,p);case 3:return t.next=5,null===(f=this.onRetrieverStart)||void 0===f?void 0:f.call(this,p);case 5:return t.abrupt("return",p);case 6:case"end":return t.stop()}}),t,this)}))),function(t,e,r,n,o,i,a){return m.apply(this,arguments)})},{key:"handleRetrieverEnd",value:(v=i(n().mark((function t(e,r){var o,i;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((i=this.runMap.get(r))&&"retriever"===(null==i?void 0:i.run_type)){t.next=3;break}throw new Error("No retriever run to end");case 3:return i.end_time=Date.now(),i.outputs={documents:e},i.events.push({name:"end",time:new Date(i.end_time).toISOString()}),t.next=8,null===(o=this.onRetrieverEnd)||void 0===o?void 0:o.call(this,i);case 8:return t.next=10,this._endTrace(i);case 10:return t.abrupt("return",i);case 11:case"end":return t.stop()}}),t,this)}))),function(t,e){return v.apply(this,arguments)})},{key:"handleRetrieverError",value:(h=i(n().mark((function t(e,r){var o,i;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((i=this.runMap.get(r))&&"retriever"===(null==i?void 0:i.run_type)){t.next=3;break}throw new Error("No retriever run to end");case 3:return i.end_time=Date.now(),i.error=this.stringifyError(e),i.events.push({name:"error",time:new Date(i.end_time).toISOString()}),t.next=8,null===(o=this.onRetrieverError)||void 0===o?void 0:o.call(this,i);case 8:return t.next=10,this._endTrace(i);case 10:return t.abrupt("return",i);case 11:case"end":return t.stop()}}),t,this)}))),function(t,e){return h.apply(this,arguments)})},{key:"handleText",value:(p=i(n().mark((function t(e,r){var o,i;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((i=this.runMap.get(r))&&"chain"===(null==i?void 0:i.run_type)){t.next=3;break}return t.abrupt("return");case 3:return i.events.push({name:"text",time:(new Date).toISOString(),kwargs:{text:e}}),t.next=6,null===(o=this.onText)||void 0===o?void 0:o.call(this,i);case 6:case"end":return t.stop()}}),t,this)}))),function(t,e){return p.apply(this,arguments)})},{key:"handleLLMNewToken",value:(a=i(n().mark((function t(e,r,o,i,a,u){var s,c;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((c=this.runMap.get(o))&&"llm"===(null==c?void 0:c.run_type)){t.next=3;break}throw new Error('Invalid "runId" provided to "handleLLMNewToken" callback.');case 3:return c.events.push({name:"new_token",time:(new Date).toISOString(),kwargs:{token:e,idx:r,chunk:null==u?void 0:u.chunk}}),t.next=6,null===(s=this.onLLMNewToken)||void 0===s?void 0:s.call(this,c,e,{chunk:null==u?void 0:u.chunk});case 6:return t.abrupt("return",c);case 7:case"end":return t.stop()}}),t,this)}))),function(t,e,r,n,o,i){return a.apply(this,arguments)})}],o&&s(r.prototype,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,o,a,p,h,v,m,b,g,w,x,_,E,O,k,j,S,A,D,P}(r(491).N)},1041:(t,e,r)=>{"use strict";r.d(e,{K:()=>D,s:()=>P});var n=r(4277),o=r(2613),i=r(1260),a=r(5681);function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function s(t){return function(t){if(Array.isArray(t))return f(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||l(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=l(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}function l(t,e){if(t){if("string"==typeof t)return f(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?f(t,e):void 0}}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function p(){p=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function f(t,e,r,n){var i=e&&e.prototype instanceof g?e:g,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:A(t,r,u)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=f;var d="suspendedStart",y="suspendedYield",v="executing",m="completed",b={};function g(){}function w(){}function x(){}var _={};l(_,a,(function(){return this}));var E=Object.getPrototypeOf,O=E&&E(E(T([])));O&&O!==r&&n.call(O,a)&&(_=O);var k=x.prototype=g.prototype=Object.create(_);function j(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,s){var c=h(t[o],t,i);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==u(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function A(e,r,n){var o=d;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=D(u,n);if(s){if(s===b)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var c=h(e,r,n);if("normal"===c.type){if(o=n.done?m:y,c.arg===b)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=m,n.method="throw",n.arg=c.arg)}}}function D(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,D(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,b;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,b):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,b)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(u(e)+" is not iterable")}return w.prototype=x,o(k,"constructor",{value:x,configurable:!0}),o(x,"constructor",{value:w,configurable:!0}),w.displayName=l(x,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,l(t,c,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},j(S.prototype),l(S.prototype,s,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(f(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},j(k),l(k,c,"Generator"),l(k,a,(function(){return this})),l(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,b):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),C(r),b}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;C(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),b}},e}function h(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function d(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){h(i,n,o,a,u,"next",t)}function u(t){h(i,n,o,a,u,"throw",t)}a(void 0)}))}}function y(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function v(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?y(Object(r),!0).forEach((function(e){m(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function m(t,e,r){return(e=g(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function b(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,g(n.key),n)}}function g(t){var e=function(t){if("object"!=u(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==u(e)?e:e+""}function w(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(w=function(){return!!t})()}function x(t){return x=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},x(t)}function _(t,e){return _=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_(t,e)}function E(t){return new k(t,0)}function O(t){var e,r;function n(e,r){try{var i=t[e](r),a=i.value,u=a instanceof k;Promise.resolve(u?a.v:a).then((function(r){if(u){var s="return"===e?"return":"next";if(!a.k||r.done)return n(s,r);r=t[s](r).value}o(i.done?"return":"normal",r)}),(function(t){n("throw",t)}))}catch(t){o("throw",t)}}function o(t,o){switch(t){case"return":e.resolve({value:o,done:!0});break;case"throw":e.reject(o);break;default:e.resolve({value:o,done:!1})}(e=e.next)?n(e.key,e.arg):r=null}this._invoke=function(t,o){return new Promise((function(i,a){var u={key:t,arg:o,resolve:i,reject:a,next:null};r?r=r.next=u:(e=r=u,n(t,o))}))},"function"!=typeof t.return&&(this.return=void 0)}function k(t,e){this.v=t,this.k=e}function j(t){var e,r,n,o=2;for("undefined"!=typeof Symbol&&(r=Symbol.asyncIterator,n=Symbol.iterator);o--;){if(r&&null!=(e=t[r]))return e.call(t);if(n&&null!=(e=t[n]))return new S(e.call(t));r="@@asyncIterator",n="@@iterator"}throw new TypeError("Object is not async iterable")}function S(t){function e(t){if(Object(t)!==t)return Promise.reject(new TypeError(t+" is not an object."));var e=t.done;return Promise.resolve(t.value).then((function(t){return{value:t,done:e}}))}return S=function(t){this.s=t,this.n=t.next},S.prototype={s:null,n:null,next:function(){return e(this.n.apply(this.s,arguments))},return:function(t){var r=this.s.return;return void 0===r?Promise.resolve({value:t,done:!0}):e(r.apply(this.s,arguments))},throw:function(t){var r=this.s.return;return void 0===r?Promise.reject(t):e(r.apply(this.s,arguments))}},new S(t)}function A(t){var e=t.name,r=t.serialized;return void 0!==e?e:void 0!==(null==r?void 0:r.name)?r.name:void 0!==(null==r?void 0:r.id)&&Array.isArray(null==r?void 0:r.id)?r.id[r.id.length-1]:"Unnamed"}O.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},O.prototype.next=function(t){return this._invoke("next",t)},O.prototype.throw=function(t){return this._invoke("throw",t)},O.prototype.return=function(t){return this._invoke("return",t)};var D=function(t){return"event_stream_tracer"===t.name},P=function(t){function e(t){var r,n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=function(t,e,r){return e=x(e),function(t,e){if(e&&("object"==u(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,w()?Reflect.construct(e,r||[],x(t).constructor):e.apply(t,r))}(this,e,[v({_awaitHandler:!0},t)]),Object.defineProperty(n,"autoClose",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(n,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(n,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(n,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(n,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(n,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(n,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(n,"runInfoMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(n,"tappedPromises",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(n,"transformStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(n,"writer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(n,"receiveStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(n,"name",{enumerable:!0,configurable:!0,writable:!0,value:"event_stream_tracer"}),n.autoClose=null===(r=null==t?void 0:t.autoClose)||void 0===r||r,n.includeNames=null==t?void 0:t.includeNames,n.includeTypes=null==t?void 0:t.includeTypes,n.includeTags=null==t?void 0:t.includeTags,n.excludeNames=null==t?void 0:t.excludeNames,n.excludeTypes=null==t?void 0:t.excludeTypes,n.excludeTags=null==t?void 0:t.excludeTags,n.transformStream=new TransformStream,n.writer=n.transformStream.writable.getWriter(),n.receiveStream=o.bO.fromReadableStream(n.transformStream.readable),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_(t,e)}(e,t),r=e,n=[{key:Symbol.asyncIterator,value:function(){return this.receiveStream}},{key:"persistRun",value:(F=d(p().mark((function t(e){return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(t){return F.apply(this,arguments)})},{key:"_includeRun",value:function(t){var e,r=this,n=null!==(e=t.tags)&&void 0!==e?e:[],o=void 0===this.includeNames&&void 0===this.includeTags&&void 0===this.includeTypes;return void 0!==this.includeNames&&(o=o||this.includeNames.includes(t.name)),void 0!==this.includeTypes&&(o=o||this.includeTypes.includes(t.runType)),void 0!==this.includeTags&&(o=o||void 0!==n.find((function(t){var e;return null===(e=r.includeTags)||void 0===e?void 0:e.includes(t)}))),void 0!==this.excludeNames&&(o=o&&!this.excludeNames.includes(t.name)),void 0!==this.excludeTypes&&(o=o&&!this.excludeTypes.includes(t.runType)),void 0!==this.excludeTags&&(o=o&&n.every((function(t){var e;return!(null!==(e=r.excludeTags)&&void 0!==e&&e.includes(t))}))),o}},{key:"tapOutputIterable",value:function(t,e){var r,n=this;return(r=p().mark((function r(){var o,i,u,s,c,l,f,h,d,y,m,b,g,w,x,_,O,k;return p().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return u=function(t,e){return"llm"===t&&"string"==typeof e?new a.mu({text:e}):e},r.next=3,E(e.next());case 3:if(!(o=r.sent).done){r.next=6;break}return r.abrupt("return");case 6:if(void 0!==(i=n.runInfoMap.get(t))){r.next=11;break}return r.next=10,o.value;case 10:return r.abrupt("return");case 11:if(void 0!==n.tappedPromises.get(t)){r.next=58;break}return s=new Promise((function(t){c=t})),n.tappedPromises.set(t,s),r.prev=15,l={event:"on_".concat(i.runType,"_stream"),run_id:t,name:i.name,tags:i.tags,metadata:i.metadata,data:{}},r.next=19,E(n.send(v(v({},l),{},{data:{chunk:u(i.runType,o.value)}}),i));case 19:return r.next=21,o.value;case 21:f=!1,h=!1,r.prev=23,y=j(e);case 25:return r.next=27,E(y.next());case 27:if(!(f=!(m=r.sent).done)){r.next=37;break}if(b=m.value,"tool"===i.runType||"retriever"===i.runType){r.next=32;break}return r.next=32,E(n.send(v(v({},l),{},{data:{chunk:u(i.runType,b)}}),i));case 32:return r.next=34,b;case 34:f=!1,r.next=25;break;case 37:r.next=43;break;case 39:r.prev=39,r.t0=r.catch(23),h=!0,d=r.t0;case 43:if(r.prev=43,r.prev=44,!f||null==y.return){r.next=48;break}return r.next=48,E(y.return());case 48:if(r.prev=48,!h){r.next=51;break}throw d;case 51:return r.finish(48);case 52:return r.finish(43);case 53:return r.prev=53,c(),r.finish(53);case 56:r.next=89;break;case 58:return r.next=60,o.value;case 60:g=!1,w=!1,r.prev=62,_=j(e);case 64:return r.next=66,E(_.next());case 66:if(!(g=!(O=r.sent).done)){r.next=73;break}return k=O.value,r.next=70,k;case 70:g=!1,r.next=64;break;case 73:r.next=79;break;case 75:r.prev=75,r.t1=r.catch(62),w=!0,x=r.t1;case 79:if(r.prev=79,r.prev=80,!g||null==_.return){r.next=84;break}return r.next=84,E(_.return());case 84:if(r.prev=84,!w){r.next=87;break}throw x;case 87:return r.finish(84);case 88:return r.finish(79);case 89:case"end":return r.stop()}}),r,null,[[15,,53,56],[23,39,43,53],[44,,48,52],[62,75,79,89],[80,,84,88]])})),function(){return new O(r.apply(this,arguments))})()}},{key:"send",value:(T=d(p().mark((function t(e,r){return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._includeRun(r)){t.next=3;break}return t.next=3,this.writer.write(e);case 3:case"end":return t.stop()}}),t,this)}))),function(t,e){return T.apply(this,arguments)})},{key:"sendEndEvent",value:(L=d(p().mark((function t(e,r){var n,o=this;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===(n=this.tappedPromises.get(e.run_id))){t.next=5;break}n.then((function(){o.send(e,r)})),t.next=7;break;case 5:return t.next=7,this.send(e,r);case 7:case"end":return t.stop()}}),t,this)}))),function(t,e){return L.apply(this,arguments)})},{key:"onLLMStart",value:(C=d(p().mark((function t(e){var r,n,o,i,a,u,s,c,l,f;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=A(e),c=void 0!==e.inputs.messages?"chat_model":"llm",l={tags:null!==(r=e.tags)&&void 0!==r?r:[],metadata:null!==(n=null===(o=e.extra)||void 0===o?void 0:o.metadata)&&void 0!==n?n:{},name:s,runType:c,inputs:e.inputs},this.runInfoMap.set(e.id,l),f="on_".concat(c,"_start"),t.next=7,this.send({event:f,data:{input:e.inputs},name:s,tags:null!==(i=e.tags)&&void 0!==i?i:[],run_id:e.id,metadata:null!==(a=null===(u=e.extra)||void 0===u?void 0:u.metadata)&&void 0!==a?a:{}},l);case 7:case"end":return t.stop()}}),t,this)}))),function(t){return C.apply(this,arguments)})},{key:"onLLMNewToken",value:(P=d(p().mark((function t(e,r,n){var o,u,s;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0!==(o=this.runInfoMap.get(e.id))){t.next=3;break}throw new Error("onLLMNewToken: Run ID ".concat(e.id," not found in run map."));case 3:if(1!==this.runInfoMap.size){t.next=5;break}return t.abrupt("return");case 5:if("chat_model"!==o.runType){t.next=10;break}s="on_chat_model_stream",u=void 0===(null==n?void 0:n.chunk)?new i.H({content:r,id:"run-".concat(e.id)}):n.chunk.message,t.next=16;break;case 10:if("llm"!==o.runType){t.next=15;break}s="on_llm_stream",u=void 0===(null==n?void 0:n.chunk)?new a.mu({text:r}):n.chunk,t.next=16;break;case 15:throw new Error("Unexpected run type ".concat(o.runType));case 16:return t.next=18,this.send({event:s,data:{chunk:u},run_id:e.id,name:o.name,tags:o.tags,metadata:o.metadata},o);case 18:case"end":return t.stop()}}),t,this)}))),function(t,e,r){return P.apply(this,arguments)})},{key:"onLLMEnd",value:(D=d(p().mark((function t(e){var r,n,o,i,a,u,s,l,f,h,d;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.runInfoMap.get(e.id),this.runInfoMap.delete(e.id),void 0!==n){t.next=4;break}throw new Error("onLLMEnd: Run ID ".concat(e.id," not found in run map."));case 4:if(i=null===(r=e.outputs)||void 0===r?void 0:r.generations,"chat_model"!==n.runType){t.next=27;break}u=c(null!=i?i:[]),t.prev=7,u.s();case 9:if((s=u.n()).done){t.next=16;break}if(f=s.value,void 0===a){t.next=13;break}return t.abrupt("break",16);case 13:a=null===(l=f[0])||void 0===l?void 0:l.message;case 14:t.next=9;break;case 16:t.next=21;break;case 18:t.prev=18,t.t0=t.catch(7),u.e(t.t0);case 21:return t.prev=21,u.f(),t.finish(21);case 24:o="on_chat_model_end",t.next=33;break;case 27:if("llm"!==n.runType){t.next=32;break}a={generations:null==i?void 0:i.map((function(t){return t.map((function(t){return{text:t.text,generationInfo:t.generationInfo}}))})),llmOutput:null!==(h=null===(d=e.outputs)||void 0===d?void 0:d.llmOutput)&&void 0!==h?h:{}},o="on_llm_end",t.next=33;break;case 32:throw new Error("onLLMEnd: Unexpected run type: ".concat(n.runType));case 33:return t.next=35,this.sendEndEvent({event:o,data:{output:a,input:n.inputs},run_id:e.id,name:n.name,tags:n.tags,metadata:n.metadata},n);case 35:case"end":return t.stop()}}),t,this,[[7,18,21,24]])}))),function(t){return D.apply(this,arguments)})},{key:"onChainStart",value:(S=d(p().mark((function t(e){var r,n,o,i,a,u,s,c,l,f,h;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=A(e),l=null!==(r=e.run_type)&&void 0!==r?r:"chain",f={tags:null!==(n=e.tags)&&void 0!==n?n:[],metadata:null!==(o=null===(i=e.extra)||void 0===i?void 0:i.metadata)&&void 0!==o?o:{},name:c,runType:e.run_type},h={},""===e.inputs.input&&1===Object.keys(e.inputs).length?(h={},f.inputs={}):void 0!==e.inputs.input?(h.input=e.inputs.input,f.inputs=e.inputs.input):(h.input=e.inputs,f.inputs=e.inputs),this.runInfoMap.set(e.id,f),t.next=8,this.send({event:"on_".concat(l,"_start"),data:h,name:c,tags:null!==(a=e.tags)&&void 0!==a?a:[],run_id:e.id,metadata:null!==(u=null===(s=e.extra)||void 0===s?void 0:s.metadata)&&void 0!==u?u:{}},f);case 8:case"end":return t.stop()}}),t,this)}))),function(t){return S.apply(this,arguments)})},{key:"onChainEnd",value:(k=d(p().mark((function t(e){var r,n,o,i,a,u,s,c,l,f;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(u=this.runInfoMap.get(e.id),this.runInfoMap.delete(e.id),void 0!==u){t.next=4;break}throw new Error("onChainEnd: Run ID ".concat(e.id," not found in run map."));case 4:return s="on_".concat(e.run_type,"_end"),c=null!==(r=null!==(n=e.inputs)&&void 0!==n?n:u.inputs)&&void 0!==r?r:{},l=null!==(o=null===(i=e.outputs)||void 0===i?void 0:i.output)&&void 0!==o?o:e.outputs,f={output:l,input:c},c.input&&1===Object.keys(c).length&&(f.input=c.input,u.inputs=c.input),t.next=11,this.sendEndEvent({event:s,data:f,run_id:e.id,name:u.name,tags:u.tags,metadata:null!==(a=u.metadata)&&void 0!==a?a:{}},u);case 11:case"end":return t.stop()}}),t,this)}))),function(t){return k.apply(this,arguments)})},{key:"onToolStart",value:(g=d(p().mark((function t(e){var r,n,o,i,a,u,s,c,l,f;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return l=A(e),f={tags:null!==(r=e.tags)&&void 0!==r?r:[],metadata:null!==(n=null===(o=e.extra)||void 0===o?void 0:o.metadata)&&void 0!==n?n:{},name:l,runType:"tool",inputs:null!==(i=e.inputs)&&void 0!==i?i:{}},this.runInfoMap.set(e.id,f),t.next=5,this.send({event:"on_tool_start",data:{input:null!==(a=e.inputs)&&void 0!==a?a:{}},name:l,run_id:e.id,tags:null!==(u=e.tags)&&void 0!==u?u:[],metadata:null!==(s=null===(c=e.extra)||void 0===c?void 0:c.metadata)&&void 0!==s?s:{}},f);case 5:case"end":return t.stop()}}),t,this)}))),function(t){return g.apply(this,arguments)})},{key:"onToolEnd",value:(m=d(p().mark((function t(e){var r,n,o;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.runInfoMap.get(e.id),this.runInfoMap.delete(e.id),void 0!==n){t.next=4;break}throw new Error("onToolEnd: Run ID ".concat(e.id," not found in run map."));case 4:if(void 0!==n.inputs){t.next=6;break}throw new Error("onToolEnd: Run ID ".concat(e.id," is a tool call, and is expected to have traced inputs."));case 6:return o=void 0===(null===(r=e.outputs)||void 0===r?void 0:r.output)?e.outputs:e.outputs.output,t.next=9,this.sendEndEvent({event:"on_tool_end",data:{output:o,input:n.inputs},run_id:e.id,name:n.name,tags:n.tags,metadata:n.metadata},n);case 9:case"end":return t.stop()}}),t,this)}))),function(t){return m.apply(this,arguments)})},{key:"onRetrieverStart",value:(y=d(p().mark((function t(e){var r,n,o,i,a,u,s,c;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=A(e),c={tags:null!==(r=e.tags)&&void 0!==r?r:[],metadata:null!==(n=null===(o=e.extra)||void 0===o?void 0:o.metadata)&&void 0!==n?n:{},name:s,runType:"retriever",inputs:{query:e.inputs.query}},this.runInfoMap.set(e.id,c),t.next=6,this.send({event:"on_retriever_start",data:{input:{query:e.inputs.query}},name:s,tags:null!==(i=e.tags)&&void 0!==i?i:[],run_id:e.id,metadata:null!==(a=null===(u=e.extra)||void 0===u?void 0:u.metadata)&&void 0!==a?a:{}},c);case 6:case"end":return t.stop()}}),t,this)}))),function(t){return y.apply(this,arguments)})},{key:"onRetrieverEnd",value:(h=d(p().mark((function t(e){var r,n,o;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=this.runInfoMap.get(e.id),this.runInfoMap.delete(e.id),void 0!==o){t.next=4;break}throw new Error("onRetrieverEnd: Run ID ".concat(e.id," not found in run map."));case 4:return t.next=6,this.sendEndEvent({event:"on_retriever_end",data:{output:null!==(r=null===(n=e.outputs)||void 0===n?void 0:n.documents)&&void 0!==r?r:e.outputs,input:o.inputs},run_id:e.id,name:o.name,tags:o.tags,metadata:o.metadata},o);case 6:case"end":return t.stop()}}),t,this)}))),function(t){return h.apply(this,arguments)})},{key:"handleCustomEvent",value:(f=d(p().mark((function t(e,r,n){var o;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0!==(o=this.runInfoMap.get(n))){t.next=3;break}throw new Error("handleCustomEvent: Run ID ".concat(n," not found in run map."));case 3:return t.next=5,this.send({event:"on_custom_event",run_id:n,name:e,tags:o.tags,metadata:o.metadata,data:r},o);case 5:case"end":return t.stop()}}),t,this)}))),function(t,e,r){return f.apply(this,arguments)})},{key:"finish",value:(l=d(p().mark((function t(){var e,r=this;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=s(this.tappedPromises.values()),Promise.all(e).finally((function(){r.writer.close()}));case 2:case"end":return t.stop()}}),t,this)}))),function(){return l.apply(this,arguments)})}],n&&b(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,l,f,h,y,m,g,k,S,D,P,C,L,T,F}(n.J)},7247:(t,e,r)=>{"use strict";r.d(e,{Od:()=>A,l7:()=>P,sD:()=>D,y9:()=>I});var n=r(8582),o=r(4277),i=r(2613),a=r(1260);function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function s(){s=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",l=i.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,r){return t[e]=r}}function p(t,e,r,n){var i=e&&e.prototype instanceof g?e:g,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:A(t,r,u)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=p;var d="suspendedStart",y="suspendedYield",v="executing",m="completed",b={};function g(){}function w(){}function x(){}var _={};f(_,a,(function(){return this}));var E=Object.getPrototypeOf,O=E&&E(E(T([])));O&&O!==r&&n.call(O,a)&&(_=O);var k=x.prototype=g.prototype=Object.create(_);function j(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,s){var c=h(t[o],t,i);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==u(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function A(e,r,n){var o=d;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=D(u,n);if(s){if(s===b)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var c=h(e,r,n);if("normal"===c.type){if(o=n.done?m:y,c.arg===b)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=m,n.method="throw",n.arg=c.arg)}}}function D(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,D(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,b;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,b):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,b)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(u(e)+" is not iterable")}return w.prototype=x,o(k,"constructor",{value:x,configurable:!0}),o(x,"constructor",{value:w,configurable:!0}),w.displayName=f(x,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,f(t,l,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},j(S.prototype),f(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(p(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},j(k),f(k,l,"Generator"),f(k,a,(function(){return this})),f(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,b):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),C(r),b}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;C(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),b}},e}function c(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function l(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?c(Object(r),!0).forEach((function(e){f(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function f(t,e,r){return(e=_(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function p(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function h(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){p(i,n,o,a,u,"next",t)}function u(t){p(i,n,o,a,u,"throw",t)}a(void 0)}))}}function d(t,e,r){return e=v(e),function(t,e){if(e&&("object"==u(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,y()?Reflect.construct(e,r||[],v(t).constructor):e.apply(t,r))}function y(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(y=function(){return!!t})()}function v(t){return v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},v(t)}function m(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&b(t,e)}function b(t,e){return b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},b(t,e)}function g(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function w(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_(n.key),n)}}function x(t,e,r){return e&&w(t.prototype,e),r&&w(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _(t){var e=function(t){if("object"!=u(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==u(e)?e:e+""}function E(t){return new k(t,0)}function O(t){var e,r;function n(e,r){try{var i=t[e](r),a=i.value,u=a instanceof k;Promise.resolve(u?a.v:a).then((function(r){if(u){var s="return"===e?"return":"next";if(!a.k||r.done)return n(s,r);r=t[s](r).value}o(i.done?"return":"normal",r)}),(function(t){n("throw",t)}))}catch(t){o("throw",t)}}function o(t,o){switch(t){case"return":e.resolve({value:o,done:!0});break;case"throw":e.reject(o);break;default:e.resolve({value:o,done:!1})}(e=e.next)?n(e.key,e.arg):r=null}this._invoke=function(t,o){return new Promise((function(i,a){var u={key:t,arg:o,resolve:i,reject:a,next:null};r?r=r.next=u:(e=r=u,n(t,o))}))},"function"!=typeof t.return&&(this.return=void 0)}function k(t,e){this.v=t,this.k=e}function j(t){var e,r,n,o=2;for("undefined"!=typeof Symbol&&(r=Symbol.asyncIterator,n=Symbol.iterator);o--;){if(r&&null!=(e=t[r]))return e.call(t);if(n&&null!=(e=t[n]))return new S(e.call(t));r="@@asyncIterator",n="@@iterator"}throw new TypeError("Object is not async iterable")}function S(t){function e(t){if(Object(t)!==t)return Promise.reject(new TypeError(t+" is not an object."));var e=t.done;return Promise.resolve(t.value).then((function(t){return{value:t,done:e}}))}return S=function(t){this.s=t,this.n=t.next},S.prototype={s:null,n:null,next:function(){return e(this.n.apply(this.s,arguments))},return:function(t){var r=this.s.return;return void 0===r?Promise.resolve({value:t,done:!0}):e(r.apply(this.s,arguments))},throw:function(t){var r=this.s.return;return void 0===r?Promise.reject(t):e(r.apply(this.s,arguments))}},new S(t)}O.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},O.prototype.next=function(t){return this._invoke("next",t)},O.prototype.throw=function(t){return this._invoke("throw",t)},O.prototype.return=function(t){return this._invoke("return",t)};var A=function(){return x((function t(e){var r;g(this,t),Object.defineProperty(this,"ops",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.ops=null!==(r=e.ops)&&void 0!==r?r:[]}),[{key:"concat",value:function(t){var e=this.ops.concat(t.ops),r=(0,n.X6)({},e);return new D({ops:e,state:r[r.length-1].newDocument})}}])}(),D=function(t){function e(t){var r;return g(this,e),r=d(this,e,[t]),Object.defineProperty(r,"state",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),r.state=t.state,r}return m(e,t),x(e,[{key:"concat",value:function(t){var r=this.ops.concat(t.ops),o=(0,n.X6)(this.state,t.ops);return new e({ops:r,state:o[o.length-1].newDocument})}}],[{key:"fromRunLogPatch",value:function(t){var r=(0,n.X6)({},t.ops);return new e({ops:t.ops,state:r[r.length-1].newDocument})}}])}(A),P=function(t){return"log_stream_tracer"===t.name};function C(t,e){return L.apply(this,arguments)}function L(){return(L=h(s().mark((function t(e,r){var n;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("original"!==r){t.next=2;break}throw new Error("Do not assign inputs with original schema drop the key for now. When inputs are added to streamLog they should be added with standardized schema for streaming events.");case 2:if(n=e.inputs,!["retriever","llm","prompt"].includes(e.run_type)){t.next=5;break}return t.abrupt("return",n);case 5:if(1!==Object.keys(n).length||""!==(null==n?void 0:n.input)){t.next=7;break}return t.abrupt("return",void 0);case 7:return t.abrupt("return",n.input);case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function T(t,e){return F.apply(this,arguments)}function F(){return(F=h(s().mark((function t(e,r){var n;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.outputs,"original"!==r){t.next=3;break}return t.abrupt("return",n);case 3:if(!["retriever","llm","prompt"].includes(e.run_type)){t.next=5;break}return t.abrupt("return",n);case 5:if(void 0===n||1!==Object.keys(n).length||void 0===(null==n?void 0:n.output)){t.next=7;break}return t.abrupt("return",n.output);case 7:return t.abrupt("return",n);case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var I=function(t){function e(t){var r,n,o;return g(this,e),o=d(this,e,[l({_awaitHandler:!0},t)]),Object.defineProperty(o,"autoClose",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(o,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(o,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(o,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(o,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(o,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(o,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(o,"_schemaFormat",{enumerable:!0,configurable:!0,writable:!0,value:"original"}),Object.defineProperty(o,"rootId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(o,"keyMapByRunId",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(o,"counterMapByRunName",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(o,"transformStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(o,"writer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(o,"receiveStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(o,"name",{enumerable:!0,configurable:!0,writable:!0,value:"log_stream_tracer"}),o.autoClose=null===(r=null==t?void 0:t.autoClose)||void 0===r||r,o.includeNames=null==t?void 0:t.includeNames,o.includeTypes=null==t?void 0:t.includeTypes,o.includeTags=null==t?void 0:t.includeTags,o.excludeNames=null==t?void 0:t.excludeNames,o.excludeTypes=null==t?void 0:t.excludeTypes,o.excludeTags=null==t?void 0:t.excludeTags,o._schemaFormat=null!==(n=null==t?void 0:t._schemaFormat)&&void 0!==n?n:o._schemaFormat,o.transformStream=new TransformStream,o.writer=o.transformStream.writable.getWriter(),o.receiveStream=i.bO.fromReadableStream(o.transformStream.readable),o}return m(e,t),x(e,[{key:Symbol.asyncIterator,value:function(){return this.receiveStream}},{key:"persistRun",value:(u=h(s().mark((function t(e){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(t){return u.apply(this,arguments)})},{key:"_includeRun",value:function(t){var e,r=this;if(t.id===this.rootId)return!1;var n=null!==(e=t.tags)&&void 0!==e?e:[],o=void 0===this.includeNames&&void 0===this.includeTags&&void 0===this.includeTypes;return void 0!==this.includeNames&&(o=o||this.includeNames.includes(t.name)),void 0!==this.includeTypes&&(o=o||this.includeTypes.includes(t.run_type)),void 0!==this.includeTags&&(o=o||void 0!==n.find((function(t){var e;return null===(e=r.includeTags)||void 0===e?void 0:e.includes(t)}))),void 0!==this.excludeNames&&(o=o&&!this.excludeNames.includes(t.name)),void 0!==this.excludeTypes&&(o=o&&!this.excludeTypes.includes(t.run_type)),void 0!==this.excludeTags&&(o=o&&n.every((function(t){var e;return!(null!==(e=r.excludeTags)&&void 0!==e&&e.includes(t))}))),o}},{key:"tapOutputIterable",value:function(t,e){var r,n=this;return(r=s().mark((function r(){var o,i,a,u,c,l,f;return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:o=!1,i=!1,r.prev=2,u=j(e);case 4:return r.next=6,E(u.next());case 6:if(!(o=!(c=r.sent).done)){r.next=18;break}if(l=c.value,t===n.rootId){r.next=13;break}if(!(f=n.keyMapByRunId[t])){r.next=13;break}return r.next=13,E(n.writer.write(new A({ops:[{op:"add",path:"/logs/".concat(f,"/streamed_output/-"),value:l}]})));case 13:return r.next=15,l;case 15:o=!1,r.next=4;break;case 18:r.next=24;break;case 20:r.prev=20,r.t0=r.catch(2),i=!0,a=r.t0;case 24:if(r.prev=24,r.prev=25,!o||null==u.return){r.next=29;break}return r.next=29,E(u.return());case 29:if(r.prev=29,!i){r.next=32;break}throw a;case 32:return r.finish(29);case 33:return r.finish(24);case 34:case"end":return r.stop()}}),r,null,[[2,20,24,34],[25,,29,33]])})),function(){return new O(r.apply(this,arguments))})()}},{key:"onRunCreate",value:(o=h(s().mark((function t(e){var r,n,o,i,a;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0!==this.rootId){t.next=4;break}return this.rootId=e.id,t.next=4,this.writer.write(new A({ops:[{op:"replace",path:"",value:{id:e.id,name:e.name,type:e.run_type,streamed_output:[],final_output:void 0,logs:{}}}]}));case 4:if(this._includeRun(e)){t.next=6;break}return t.abrupt("return");case 6:if(void 0===this.counterMapByRunName[e.name]&&(this.counterMapByRunName[e.name]=0),this.counterMapByRunName[e.name]+=1,i=this.counterMapByRunName[e.name],this.keyMapByRunId[e.id]=1===i?e.name:"".concat(e.name,":").concat(i),a={id:e.id,name:e.name,type:e.run_type,tags:null!==(r=e.tags)&&void 0!==r?r:[],metadata:null!==(n=null===(o=e.extra)||void 0===o?void 0:o.metadata)&&void 0!==n?n:{},start_time:new Date(e.start_time).toISOString(),streamed_output:[],streamed_output_str:[],final_output:void 0,end_time:void 0},"streaming_events"!==this._schemaFormat){t.next=15;break}return t.next=14,C(e,this._schemaFormat);case 14:a.inputs=t.sent;case 15:return t.next=17,this.writer.write(new A({ops:[{op:"add",path:"/logs/".concat(this.keyMapByRunId[e.id]),value:a}]}));case 17:case"end":return t.stop()}}),t,this)}))),function(t){return o.apply(this,arguments)})},{key:"onRunUpdate",value:(n=h(s().mark((function t(e){var r,n,o,i;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,void 0!==(r=this.keyMapByRunId[e.id])){t.next=4;break}return t.abrupt("return");case 4:if(n=[],"streaming_events"!==this._schemaFormat){t.next=13;break}return t.t0=n,t.t1="/logs/".concat(r,"/inputs"),t.next=10,C(e,this._schemaFormat);case 10:t.t2=t.sent,t.t3={op:"replace",path:t.t1,value:t.t2},t.t0.push.call(t.t0,t.t3);case 13:return t.t4=n,t.t5="/logs/".concat(r,"/final_output"),t.next=17,T(e,this._schemaFormat);case 17:return t.t6=t.sent,t.t7={op:"add",path:t.t5,value:t.t6},t.t4.push.call(t.t4,t.t7),void 0!==e.end_time&&n.push({op:"add",path:"/logs/".concat(r,"/end_time"),value:new Date(e.end_time).toISOString()}),o=new A({ops:n}),t.next=24,this.writer.write(o);case 24:if(t.prev=24,e.id!==this.rootId){t.next=39;break}return t.t8=A,t.next=29,T(e,this._schemaFormat);case 29:return t.t9=t.sent,t.t10={op:"replace",path:"/final_output",value:t.t9},t.t11=[t.t10],t.t12={ops:t.t11},i=new t.t8(t.t12),t.next=36,this.writer.write(i);case 36:if(!this.autoClose){t.next=39;break}return t.next=39,this.writer.close();case 39:return t.finish(24);case 40:case"end":return t.stop()}}),t,this,[[0,,24,40]])}))),function(t){return n.apply(this,arguments)})},{key:"onLLMNewToken",value:(r=h(s().mark((function t(e,r,n){var o,i,u;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0!==(o=this.keyMapByRunId[e.id])){t.next=3;break}return t.abrupt("return");case 3:return void 0!==e.inputs.messages?(s=null==n?void 0:n.chunk,i=void 0!==s&&void 0!==s.message?null==n?void 0:n.chunk:new a.H({id:"run-".concat(e.id),content:r})):i=r,u=new A({ops:[{op:"add",path:"/logs/".concat(o,"/streamed_output_str/-"),value:r},{op:"add",path:"/logs/".concat(o,"/streamed_output/-"),value:i}]}),t.next=8,this.writer.write(u);case 8:case"end":return t.stop()}var s}),t,this)}))),function(t,e,n){return r.apply(this,arguments)})}]);var r,n,o,u}(o.J)},6463:(t,e,r)=>{"use strict";r.d(e,{g:()=>l});var n=r(1461),o=r(4869);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,u(n.key),n)}}function u(t){var e=function(t){if("object"!=i(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==i(e)?e:e+""}var s=[400,401,402,403,404,405,406,407,409],c=function(t){var e,r,n;if(t.message.startsWith("Cancel")||t.message.startsWith("AbortError")||"AbortError"===t.name)throw t;if("ECONNABORTED"===(null==t?void 0:t.code))throw t;var o=null!==(e=null==t||null===(r=t.response)||void 0===r?void 0:r.status)&&void 0!==e?e:null==t?void 0:t.status;if(o&&s.includes(+o))throw t;if("insufficient_quota"===(null==t||null===(n=t.error)||void 0===n?void 0:n.code)){var i=new Error(null==t?void 0:t.message);throw i.name="InsufficientQuotaError",i}},l=function(){return t=function t(e){var r,n,i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"onFailedAttempt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxConcurrency=null!==(r=e.maxConcurrency)&&void 0!==r?r:1/0,this.maxRetries=null!==(n=e.maxRetries)&&void 0!==n?n:6,this.onFailedAttempt=null!==(i=e.onFailedAttempt)&&void 0!==i?i:c;var a=o.default;this.queue=new a({concurrency:this.maxConcurrency})},e=[{key:"call",value:function(t){for(var e=this,r=arguments.length,o=new Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];return this.queue.add((function(){return n((function(){return t.apply(void 0,o).catch((function(t){throw t instanceof Error?t:new Error(t)}))}),{onFailedAttempt:e.onFailedAttempt,retries:e.maxRetries,randomize:!0})}),{throwOnTimeout:!0})}},{key:"callWithOptions",value:function(t,e){for(var r=arguments.length,n=new Array(r>2?r-2:0),o=2;o<r;o++)n[o-2]=arguments[o];return t.signal?Promise.race([this.call.apply(this,[e].concat(n)),new Promise((function(e,r){var n;null===(n=t.signal)||void 0===n||n.addEventListener("abort",(function(){r(new Error("AbortError"))}))}))]):this.call.apply(this,[e].concat(n))}},{key:"fetch",value:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return this.call((function(){return fetch.apply(void 0,e).then((function(t){return t.ok?t:Promise.reject(t)}))}))}))}],e&&a(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}()},4054:(t,e,r)=>{"use strict";function n(){n=function(){return e};var t,e={},r=Object.prototype,o=r.hasOwnProperty,a=Object.defineProperty||function(t,e,r){t[e]=r.value},u="function"==typeof Symbol?Symbol:{},s=u.iterator||"@@iterator",c=u.asyncIterator||"@@asyncIterator",l=u.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,r){return t[e]=r}}function p(t,e,r,n){var o=e&&e.prototype instanceof g?e:g,i=Object.create(o.prototype),u=new L(n||[]);return a(i,"_invoke",{value:A(t,r,u)}),i}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=p;var d="suspendedStart",y="suspendedYield",v="executing",m="completed",b={};function g(){}function w(){}function x(){}var _={};f(_,s,(function(){return this}));var E=Object.getPrototypeOf,O=E&&E(E(T([])));O&&O!==r&&o.call(O,s)&&(_=O);var k=x.prototype=g.prototype=Object.create(_);function j(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(n,a,u,s){var c=h(t[n],t,a);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==i(f)&&o.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,u,s)}),(function(t){r("throw",t,u,s)})):e.resolve(f).then((function(t){l.value=t,u(l)}),(function(t){return r("throw",t,u,s)}))}s(c.arg)}var n;a(this,"_invoke",{value:function(t,o){function i(){return new e((function(e,n){r(t,o,e,n)}))}return n=n?n.then(i,i):i()}})}function A(e,r,n){var o=d;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=D(u,n);if(s){if(s===b)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var c=h(e,r,n);if("normal"===c.type){if(o=n.done?m:y,c.arg===b)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=m,n.method="throw",n.arg=c.arg)}}}function D(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,D(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,b;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,b):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,b)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[s];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,a=function r(){for(;++n<e.length;)if(o.call(e,n))return r.value=e[n],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(i(e)+" is not iterable")}return w.prototype=x,a(k,"constructor",{value:x,configurable:!0}),a(x,"constructor",{value:w,configurable:!0}),w.displayName=f(x,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,f(t,l,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},j(S.prototype),f(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(p(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},j(k),f(k,l,"Generator"),f(k,s,(function(){return this})),f(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var s=o.call(a,"catchLoc"),c=o.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,b):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),C(r),b}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;C(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),b}},e}function o(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}r.d(e,{Az:()=>l,Ec:()=>s});var a,u=function(){return"undefined"!=typeof Deno};function s(){return c.apply(this,arguments)}function c(){var t;return t=n().mark((function t(){var e;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===a&&(e="undefined"!=typeof window&&void 0!==window.document?"browser":"undefined"==typeof process||void 0===process.versions||void 0===process.versions.node||u()?"object"===("undefined"==typeof globalThis?"undefined":i(globalThis))&&globalThis.constructor&&"DedicatedWorkerGlobalScope"===globalThis.constructor.name?"webworker":"undefined"!=typeof window&&"nodejs"===window.name||"undefined"!=typeof navigator&&(navigator.userAgent.includes("Node.js")||navigator.userAgent.includes("jsdom"))?"jsdom":u()?"deno":"other":"node",a={library:"langchain-js",runtime:e}),t.abrupt("return",a);case 2:case"end":return t.stop()}}),t)})),c=function(){var e=this,r=arguments;return new Promise((function(n,i){var a=t.apply(e,r);function u(t){o(a,n,i,u,s,"next",t)}function s(t){o(a,n,i,u,s,"throw",t)}u(void 0)}))},c.apply(this,arguments)}function l(t){try{var e;return"undefined"!=typeof process?null===(e=process.env)||void 0===e?void 0:e[t]:void 0}catch(t){return}}},8582:(t,e,r)=>{"use strict";r.d(e,{X6:()=>j,UD:()=>T});var n={};function o(t){var e="function"==typeof Map?new Map:void 0;return o=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(e){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return function(t,e,r){if(i())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,e);var o=new(t.bind.apply(t,n));return r&&a(o,r.prototype),o}(t,arguments,u(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),a(r,t)},o(t)}function i(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(i=function(){return!!t})()}function a(t,e){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},a(t,e)}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}r.r(n),r.d(n,{JsonPatchError:()=>w,_areEquals:()=>P,applyOperation:()=>k,applyPatch:()=>j,applyReducer:()=>S,deepClone:()=>x,getValueByPointer:()=>O,validate:()=>D,validator:()=>A});var c=Object.prototype.hasOwnProperty;function l(t,e){return c.call(t,e)}function f(t){if(Array.isArray(t)){for(var e=new Array(t.length),r=0;r<e.length;r++)e[r]=""+r;return e}if(Object.keys)return Object.keys(t);var n=[];for(var o in t)l(t,o)&&n.push(o);return n}function p(t){switch(s(t)){case"object":return JSON.parse(JSON.stringify(t));case"undefined":return null;default:return t}}function h(t){for(var e,r=0,n=t.length;r<n;){if(!((e=t.charCodeAt(r))>=48&&e<=57))return!1;r++}return!0}function d(t){return-1===t.indexOf("/")&&-1===t.indexOf("~")?t:t.replace(/~/g,"~0").replace(/\//g,"~1")}function y(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}function v(t){if(void 0===t)return!0;if(t)if(Array.isArray(t)){for(var e=0,r=t.length;e<r;e++)if(v(t[e]))return!0}else if("object"===s(t))for(var n=f(t),o=n.length,i=0;i<o;i++)if(v(t[n[i]]))return!0;return!1}function m(t,e){var r=[t];for(var n in e){var o="object"===s(e[n])?JSON.stringify(e[n],null,2):e[n];void 0!==o&&r.push("".concat(n,": ").concat(o))}return r.join("\n")}var b=function(t){function e(t,r,n,o,a){var c;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),c=function(t,e,r){return e=u(e),function(t,e){if(e&&("object"==s(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,i()?Reflect.construct(e,r||[],u(t).constructor):e.apply(t,r))}(this,e,[m(t,{name:r,index:n,operation:o,tree:a})]),Object.defineProperty(c,"name",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(c,"index",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(c,"operation",{enumerable:!0,configurable:!0,writable:!0,value:o}),Object.defineProperty(c,"tree",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.setPrototypeOf(c,(this instanceof e?this.constructor:void 0).prototype),c.message=m(t,{name:r,index:n,operation:o,tree:a}),c}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(e,t),r=e,Object.defineProperty(r,"prototype",{writable:!1}),r;var r}(o(Error));function g(t){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},g(t)}var w=b,x=p,_={add:function(t,e,r){return t[e]=this.value,{newDocument:r}},remove:function(t,e,r){var n=t[e];return delete t[e],{newDocument:r,removed:n}},replace:function(t,e,r){var n=t[e];return t[e]=this.value,{newDocument:r,removed:n}},move:function(t,e,r){var n=O(r,this.path);n&&(n=p(n));var o=k(r,{op:"remove",path:this.from}).removed;return k(r,{op:"add",path:this.path,value:o}),{newDocument:r,removed:n}},copy:function(t,e,r){var n=O(r,this.from);return k(r,{op:"add",path:this.path,value:p(n)}),{newDocument:r}},test:function(t,e,r){return{newDocument:r,test:P(t[e],this.value)}},_get:function(t,e,r){return this.value=t[e],{newDocument:r}}},E={add:function(t,e,r){return h(e)?t.splice(e,0,this.value):t[e]=this.value,{newDocument:r,index:e}},remove:function(t,e,r){return{newDocument:r,removed:t.splice(e,1)[0]}},replace:function(t,e,r){var n=t[e];return t[e]=this.value,{newDocument:r,removed:n}},move:_.move,copy:_.copy,test:_.test,_get:_._get};function O(t,e){if(""==e)return t;var r={op:"_get",path:e};return k(t,r),r.value}function k(t,e){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;if(r&&("function"==typeof r?r(e,0,t,e.path):A(e,0)),""===e.path){var a={newDocument:t};if("add"===e.op)return a.newDocument=e.value,a;if("replace"===e.op)return a.newDocument=e.value,a.removed=t,a;if("move"===e.op||"copy"===e.op)return a.newDocument=O(t,e.from),"move"===e.op&&(a.removed=t),a;if("test"===e.op){if(a.test=P(t,e.value),!1===a.test)throw new w("Test operation failed","TEST_OPERATION_FAILED",i,e,t);return a.newDocument=t,a}if("remove"===e.op)return a.removed=t,a.newDocument=null,a;if("_get"===e.op)return e.value=t,a;if(r)throw new w("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",i,e,t);return a}n||(t=p(t));var u,s,c=(e.path||"").split("/"),l=t,f=1,d=c.length,v=void 0;for(s="function"==typeof r?r:A;;){if((u=c[f])&&-1!=u.indexOf("~")&&(u=y(u)),o&&("__proto__"==u||"prototype"==u&&f>0&&"constructor"==c[f-1]))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(r&&void 0===v&&(void 0===l[u]?v=c.slice(0,f).join("/"):f==d-1&&(v=e.path),void 0!==v&&s(e,0,t,v)),f++,Array.isArray(l)){if("-"===u)u=l.length;else{if(r&&!h(u))throw new w("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",i,e,t);h(u)&&(u=~~u)}if(f>=d){if(r&&"add"===e.op&&u>l.length)throw new w("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",i,e,t);var m=E[e.op].call(e,l,u,t);if(!1===m.test)throw new w("Test operation failed","TEST_OPERATION_FAILED",i,e,t);return m}}else if(f>=d){var b=_[e.op].call(e,l,u,t);if(!1===b.test)throw new w("Test operation failed","TEST_OPERATION_FAILED",i,e,t);return b}if(l=l[u],r&&f<d&&(!l||"object"!==g(l)))throw new w("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",i,e,t)}}function j(t,e,r){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(r&&!Array.isArray(e))throw new w("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");n||(t=p(t));for(var i=new Array(e.length),a=0,u=e.length;a<u;a++)i[a]=k(t,e[a],r,!0,o,a),t=i[a].newDocument;return i.newDocument=t,i}function S(t,e,r){var n=k(t,e);if(!1===n.test)throw new w("Test operation failed","TEST_OPERATION_FAILED",r,e,t);return n.newDocument}function A(t,e,r,n){if("object"!==g(t)||null===t||Array.isArray(t))throw new w("Operation is not an object","OPERATION_NOT_AN_OBJECT",e,t,r);if(!_[t.op])throw new w("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",e,t,r);if("string"!=typeof t.path)throw new w("Operation `path` property is not a string","OPERATION_PATH_INVALID",e,t,r);if(0!==t.path.indexOf("/")&&t.path.length>0)throw new w('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",e,t,r);if(("move"===t.op||"copy"===t.op)&&"string"!=typeof t.from)throw new w("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",e,t,r);if(("add"===t.op||"replace"===t.op||"test"===t.op)&&void 0===t.value)throw new w("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",e,t,r);if(("add"===t.op||"replace"===t.op||"test"===t.op)&&v(t.value))throw new w("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",e,t,r);if(r)if("add"==t.op){var o=t.path.split("/").length,i=n.split("/").length;if(o!==i+1&&o!==i)throw new w("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",e,t,r)}else if("replace"===t.op||"remove"===t.op||"_get"===t.op){if(t.path!==n)throw new w("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",e,t,r)}else if("move"===t.op||"copy"===t.op){var a=D([{op:"_get",path:t.from,value:void 0}],r);if(a&&"OPERATION_PATH_UNRESOLVABLE"===a.name)throw new w("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",e,t,r)}}function D(t,e,r){try{if(!Array.isArray(t))throw new w("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(e)j(p(e),p(t),r||!0);else{r=r||A;for(var n=0;n<t.length;n++)r(t[n],n,e,void 0)}}catch(t){if(t instanceof w)return t;throw t}}function P(t,e){if(t===e)return!0;if(t&&e&&"object"==g(t)&&"object"==g(e)){var r,n,o,i=Array.isArray(t),a=Array.isArray(e);if(i&&a){if((n=t.length)!=e.length)return!1;for(r=n;0!=r--;)if(!P(t[r],e[r]))return!1;return!0}if(i!=a)return!1;var u=Object.keys(t);if((n=u.length)!==Object.keys(e).length)return!1;for(r=n;0!=r--;)if(!e.hasOwnProperty(u[r]))return!1;for(r=n;0!=r--;)if(!P(t[o=u[r]],e[o]))return!1;return!0}return t!=t&&e!=e}function C(t){return C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},C(t)}function L(t,e,r,n,o){if(e!==t){"function"==typeof e.toJSON&&(e=e.toJSON());for(var i=f(e),a=f(t),u=!1,s=a.length-1;s>=0;s--){var c=t[y=a[s]];if(!l(e,y)||void 0===e[y]&&void 0!==c&&!1===Array.isArray(e))Array.isArray(t)===Array.isArray(e)?(o&&r.push({op:"test",path:n+"/"+d(y),value:p(c)}),r.push({op:"remove",path:n+"/"+d(y)}),u=!0):(o&&r.push({op:"test",path:n,value:t}),r.push({op:"replace",path:n,value:e}));else{var h=e[y];"object"==C(c)&&null!=c&&"object"==C(h)&&null!=h&&Array.isArray(c)===Array.isArray(h)?L(c,h,r,n+"/"+d(y),o):c!==h&&(o&&r.push({op:"test",path:n+"/"+d(y),value:p(c)}),r.push({op:"replace",path:n+"/"+d(y),value:p(h)}))}}if(u||i.length!=a.length)for(s=0;s<i.length;s++){var y;l(t,y=i[s])||void 0===e[y]||r.push({op:"add",path:n+"/"+d(y),value:p(e[y])})}}}function T(t,e){var r=[];return L(t,e,r,"",arguments.length>2&&void 0!==arguments[2]&&arguments[2]),r}function F(t){return F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},F(t)}function I(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function N(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?I(Object(r),!0).forEach((function(e){R(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):I(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function R(t,e,r){return(e=function(t){var e=function(t){if("object"!=F(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=F(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==F(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}new WeakMap,N(N({},n),{},{JsonPatchError:b,deepClone:p,escapePathComponent:d,unescapePathComponent:y})},6179:(t,e,r)=>{"use strict";function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function o(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i;t=t.trim();var r=/```(json)?([^]*)```/.exec(t);return e(r?r[2]:t)}function i(t){if(void 0===t)return null;try{return JSON.parse(t)}catch(t){}var e,r="",o=[],i=!1,a=!1,u=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return n(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var o=0,i=function(){};return{s:i,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,u=!0,s=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return u=t.done,t},e:function(t){s=!0,a=t},f:function(){try{u||null==r.return||r.return()}finally{if(s)throw a}}}}(t);try{for(u.s();!(e=u.n()).done;){var s=e.value;if(i)'"'!==s||a?"\n"!==s||a?a="\\"===s&&!a:s="\\n":i=!1;else if('"'===s)i=!0,a=!1;else if("{"===s)o.push("}");else if("["===s)o.push("]");else if("}"===s||"]"===s){if(!o||o[o.length-1]!==s)return null;o.pop()}r+=s}}catch(t){u.e(t)}finally{u.f()}i&&(r+='"');for(var c=o.length-1;c>=0;c-=1)r+=o[c];try{return JSON.parse(r)}catch(t){return null}}r.d(e,{D:()=>o,d:()=>i})},2398:(t,e,r)=>{"use strict";r.d(e,{U:()=>n.UD});var n=r(8582)},8589:(t,e,r)=>{"use strict";function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(){o=function(){return e};var t,e={},r=Object.prototype,i=r.hasOwnProperty,a=Object.defineProperty||function(t,e,r){t[e]=r.value},u="function"==typeof Symbol?Symbol:{},s=u.iterator||"@@iterator",c=u.asyncIterator||"@@asyncIterator",l=u.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,r){return t[e]=r}}function p(t,e,r,n){var o=e&&e.prototype instanceof g?e:g,i=Object.create(o.prototype),u=new L(n||[]);return a(i,"_invoke",{value:A(t,r,u)}),i}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=p;var d="suspendedStart",y="suspendedYield",v="executing",m="completed",b={};function g(){}function w(){}function x(){}var _={};f(_,s,(function(){return this}));var E=Object.getPrototypeOf,O=E&&E(E(T([])));O&&O!==r&&i.call(O,s)&&(_=O);var k=x.prototype=g.prototype=Object.create(_);function j(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,a,u,s){var c=h(t[o],t,a);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==n(f)&&i.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,u,s)}),(function(t){r("throw",t,u,s)})):e.resolve(f).then((function(t){l.value=t,u(l)}),(function(t){return r("throw",t,u,s)}))}s(c.arg)}var o;a(this,"_invoke",{value:function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}})}function A(e,r,n){var o=d;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=D(u,n);if(s){if(s===b)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var c=h(e,r,n);if("normal"===c.type){if(o=n.done?m:y,c.arg===b)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=m,n.method="throw",n.arg=c.arg)}}}function D(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,D(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,b;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,b):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,b)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[s];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(i.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(n(e)+" is not iterable")}return w.prototype=x,a(k,"constructor",{value:x,configurable:!0}),a(x,"constructor",{value:w,configurable:!0}),w.displayName=f(x,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,f(t,l,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},j(S.prototype),f(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(p(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},j(k),f(k,l,"Generator"),f(k,s,(function(){return this})),f(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var r in this)"t"===r.charAt(0)&&i.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],u=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var s=i.call(a,"catchLoc"),c=i.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,b):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),C(r),b}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;C(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),b}},e}function i(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function a(t,e){return u.apply(this,arguments)}function u(){var t;return t=o().mark((function t(e,r){var n;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0!==r){t.next=2;break}return t.abrupt("return",e);case 2:return t.abrupt("return",Promise.race([e.catch((function(t){if(null==r||!r.aborted)throw t})),new Promise((function(t,e){n=function(){e(new Error("Aborted"))},r.addEventListener("abort",n),r.aborted&&e(new Error("Aborted"))}))]).finally((function(){return r.removeEventListener("abort",n)})));case 3:case"end":return t.stop()}}),t)})),u=function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function u(t){i(a,n,o,u,s,"next",t)}function s(t){i(a,n,o,u,s,"throw",t)}u(void 0)}))},u.apply(this,arguments)}r.d(e,{o:()=>a})},2613:(t,e,r)=>{"use strict";r.d(e,{DS:()=>j,Tr:()=>k,bO:()=>_,gI:()=>E,xW:()=>O});var n=r(2782),o=r(8589);function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function a(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function u(t,e,r){return(e=y(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function c(){c=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",l=i.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,r){return t[e]=r}}function p(t,e,r,n){var i=e&&e.prototype instanceof g?e:g,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:A(t,r,u)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=p;var d="suspendedStart",y="suspendedYield",v="executing",m="completed",b={};function g(){}function w(){}function x(){}var _={};f(_,a,(function(){return this}));var E=Object.getPrototypeOf,O=E&&E(E(T([])));O&&O!==r&&n.call(O,a)&&(_=O);var k=x.prototype=g.prototype=Object.create(_);function j(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,u){var c=h(t[o],t,i);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==s(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(f).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function A(e,r,n){var o=d;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=D(u,n);if(s){if(s===b)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var c=h(e,r,n);if("normal"===c.type){if(o=n.done?m:y,c.arg===b)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=m,n.method="throw",n.arg=c.arg)}}}function D(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,D(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,b;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,b):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,b)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(s(e)+" is not iterable")}return w.prototype=x,o(k,"constructor",{value:x,configurable:!0}),o(x,"constructor",{value:w,configurable:!0}),w.displayName=f(x,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,f(t,l,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},j(S.prototype),f(S.prototype,u,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(p(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},j(k),f(k,l,"Generator"),f(k,a,(function(){return this})),f(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,b):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),C(r),b}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;C(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),b}},e}function l(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function f(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){l(i,n,o,a,u,"next",t)}function u(t){l(i,n,o,a,u,"throw",t)}a(void 0)}))}}function p(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,y(n.key),n)}}function d(t,e,r){return e&&h(t.prototype,e),r&&h(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function y(t){var e=function(t){if("object"!=s(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==s(e)?e:e+""}function v(t){var e="function"==typeof Map?new Map:void 0;return v=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(e){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return function(t,e,r){if(m())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,e);var o=new(t.bind.apply(t,n));return r&&b(o,r.prototype),o}(t,arguments,g(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),b(r,t)},v(t)}function m(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(m=function(){return!!t})()}function b(t,e){return b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},b(t,e)}function g(t){return g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},g(t)}function w(t){var e,r;function n(e,r){try{var i=t[e](r),a=i.value,u=a instanceof x;Promise.resolve(u?a.v:a).then((function(r){if(u){var s="return"===e?"return":"next";if(!a.k||r.done)return n(s,r);r=t[s](r).value}o(i.done?"return":"normal",r)}),(function(t){n("throw",t)}))}catch(t){o("throw",t)}}function o(t,o){switch(t){case"return":e.resolve({value:o,done:!0});break;case"throw":e.reject(o);break;default:e.resolve({value:o,done:!1})}(e=e.next)?n(e.key,e.arg):r=null}this._invoke=function(t,o){return new Promise((function(i,a){var u={key:t,arg:o,resolve:i,reject:a,next:null};r?r=r.next=u:(e=r=u,n(t,o))}))},"function"!=typeof t.return&&(this.return=void 0)}function x(t,e){this.v=t,this.k=e}w.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},w.prototype.next=function(t){return this._invoke("next",t)},w.prototype.throw=function(t){return this._invoke("throw",t)},w.prototype.return=function(t){return this._invoke("return",t)};var _=function(t){function e(){var t,r,n,o;return p(this,e),r=this,o=arguments,n=g(n=e),t=function(t,e){if(e&&("object"==s(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(r,m()?Reflect.construct(n,o||[],g(r).constructor):n.apply(r,o)),Object.defineProperty(t,"reader",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&b(t,e)}(e,t),d(e,[{key:"ensureReader",value:function(){this.reader||(this.reader=this.getReader())}},{key:"next",value:(i=f(c().mark((function t(){var e;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.ensureReader(),t.prev=1,t.next=4,this.reader.read();case 4:if(!(e=t.sent).done){t.next=10;break}return this.reader.releaseLock(),t.abrupt("return",{done:!0,value:void 0});case 10:return t.abrupt("return",{done:!1,value:e.value});case 11:t.next=17;break;case 13:throw t.prev=13,t.t0=t.catch(1),this.reader.releaseLock(),t.t0;case 17:case"end":return t.stop()}}),t,this,[[1,13]])}))),function(){return i.apply(this,arguments)})},{key:"return",value:(o=f(c().mark((function t(){var e;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.ensureReader(),!this.locked){t.next=6;break}return e=this.reader.cancel(),this.reader.releaseLock(),t.next=6,e;case 6:return t.abrupt("return",{done:!0,value:void 0});case 7:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"throw",value:(n=f(c().mark((function t(e){var r;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.ensureReader(),!this.locked){t.next=6;break}return r=this.reader.cancel(),this.reader.releaseLock(),t.next=6,r;case 6:throw e;case 7:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:Symbol.asyncIterator,value:function(){return this}},{key:Symbol.asyncDispose,value:(r=f(c().mark((function t(){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.return();case 2:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})}],[{key:"fromReadableStream",value:function(t){var r=t.getReader();return new e({start:function(t){return function e(){return r.read().then((function(r){var n=r.done,o=r.value;if(!n)return t.enqueue(o),e();t.close()}))}()},cancel:function(){r.releaseLock()}})}},{key:"fromAsyncGenerator",value:function(t){return new e({pull:function(e){return f(c().mark((function r(){var n,o;return c().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.next();case 2:n=r.sent,o=n.value,n.done&&e.close(),e.enqueue(o);case 7:case"end":return r.stop()}}),r)})))()},cancel:function(e){return f(c().mark((function r(){return c().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.return(e);case 2:case"end":return r.stop()}}),r)})))()}})}}]);var r,n,o,i}(v(ReadableStream));function E(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,r=Array.from({length:e},(function(){return[]}));return r.map(function(){var e,n=(e=c().mark((function e(n){var o,i,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==n.length){e.next=8;break}return e.next=4,new x(t.next(),0);case 4:for(o=e.sent,i=0,a=r;i<a.length;i++)a[i].push(o);e.next=14;break;case 8:if(!n[0].done){e.next=12;break}return e.abrupt("return");case 12:return e.next=14,n.shift().value;case 14:e.next=0;break;case 16:case"end":return e.stop()}}),e)})),function(){return new w(e.apply(this,arguments))});return function(t){return n.apply(this,arguments)}}())}function O(t,e){if(Array.isArray(t)&&Array.isArray(e))return t.concat(e);if("string"==typeof t&&"string"==typeof e)return t+e;if("number"==typeof t&&"number"==typeof e)return t+e;if("concat"in t&&"function"==typeof t.concat)return t.concat(e);if("object"===s(t)&&"object"===s(e)){for(var r=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?a(Object(r),!0).forEach((function(e){u(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},t),n=0,o=Object.entries(e);n<o.length;n++){var c=(p=o[n],h=2,function(t){if(Array.isArray(t))return t}(p)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],s=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);s=!0);}catch(t){c=!0,o=t}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(p,h)||function(t,e){if(t){if("string"==typeof t)return i(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(t,e):void 0}}(p,h)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),l=c[0],f=c[1];l in r&&!Array.isArray(r[l])?r[l]=O(r[l],f):r[l]=f}return r}var p,h;throw new Error("Cannot concat ".concat(s(t)," and ").concat(s(e)))}var k=function(){return d((function t(e){var r,o,i=this;p(this,t),Object.defineProperty(this,"generator",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"setup",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"signal",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"firstResult",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"firstResultUsed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.generator=e.generator,this.config=e.config,this.signal=null!==(r=e.signal)&&void 0!==r?r:null===(o=this.config)||void 0===o?void 0:o.signal,this.setup=new Promise((function(t,r){n.N.runWithConfig(e.config,f(c().mark((function n(){return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:i.firstResult=e.generator.next(),e.startSetup?i.firstResult.then(e.startSetup).then(t,r):i.firstResult.then((function(e){return t(void 0)}),r);case 2:case"end":return n.stop()}}),n)}))),!0)}))}),[{key:"next",value:(i=f(c().mark((function t(){var e,r,i,a,u=this,s=arguments;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(r=s.length,i=new Array(r),a=0;a<r;a++)i[a]=s[a];if(null===(e=this.signal)||void 0===e||e.throwIfAborted(),this.firstResultUsed){t.next=5;break}return this.firstResultUsed=!0,t.abrupt("return",this.firstResult);case 5:return t.abrupt("return",n.N.runWithConfig(this.config,this.signal?f(c().mark((function t(){var e;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,o.o)((e=u.generator).next.apply(e,i),u.signal));case 1:case"end":return t.stop()}}),t)}))):f(c().mark((function t(){var e;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(e=u.generator).next.apply(e,i));case 1:case"end":return t.stop()}}),t)}))),!0));case 6:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"return",value:(r=f(c().mark((function t(e){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.generator.return(e));case 1:case"end":return t.stop()}}),t,this)}))),function(t){return r.apply(this,arguments)})},{key:"throw",value:(e=f(c().mark((function t(e){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.generator.throw(e));case 1:case"end":return t.stop()}}),t,this)}))),function(t){return e.apply(this,arguments)})},{key:Symbol.asyncIterator,value:function(){return this}},{key:Symbol.asyncDispose,value:(t=f(c().mark((function t(){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.return();case 2:case"end":return t.stop()}}),t,this)}))),function(){return t.apply(this,arguments)})}]);var t,e,r,i}();function j(t,e,r,n){return S.apply(this,arguments)}function S(){return S=f(c().mark((function t(e,r,n,o){var i,a,u,s,l,f=arguments;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=new k({generator:r,startSetup:n,signal:o}),t.next=3,i.setup;case 3:for(a=t.sent,u=f.length,s=new Array(u>4?u-4:0),l=4;l<u;l++)s[l-4]=f[l];return t.abrupt("return",{output:e.apply(void 0,[i,a].concat(s)),setup:a});case 6:case"end":return t.stop()}}),t)}))),S.apply(this,arguments)}},5327:(t,e,r)=>{"use strict";r.d(e,{VC:()=>n.VC,ZE:()=>n.ZE,j_:()=>n.j_});var n=r(888)},372:(t,e,r)=>{"use strict";r.d(e,{y:()=>n.y});var n=r(4865)},2743:(t,e,r)=>{"use strict";r.d(e,{vd:()=>n.vd,mJ:()=>n.mJ,hU:()=>b.hU,CC:()=>n.CC,_6:()=>m});var n=r(9445);function o(t){var e,r;function n(e,r){try{var a=t[e](r),u=a.value,s=u instanceof i;Promise.resolve(s?u.v:u).then((function(r){if(s){var i="return"===e?"return":"next";if(!u.k||r.done)return n(i,r);r=t[i](r).value}o(a.done?"return":"normal",r)}),(function(t){n("throw",t)}))}catch(t){o("throw",t)}}function o(t,o){switch(t){case"return":e.resolve({value:o,done:!0});break;case"throw":e.reject(o);break;default:e.resolve({value:o,done:!1})}(e=e.next)?n(e.key,e.arg):r=null}this._invoke=function(t,o){return new Promise((function(i,a){var u={key:t,arg:o,resolve:i,reject:a,next:null};r?r=r.next=u:(e=r=u,n(t,o))}))},"function"!=typeof t.return&&(this.return=void 0)}function i(t,e){this.v=t,this.k=e}r(1176),o.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},o.prototype.next=function(t){return this._invoke("next",t)},o.prototype.throw=function(t){return this._invoke("throw",t)},o.prototype.return=function(t){return this._invoke("return",t)};var a=r(4476),u=r(1236);function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function l(){l=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,r){return t[e]=r}}function p(t,e,r,n){var i=e&&e.prototype instanceof g?e:g,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:A(t,r,u)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=p;var d="suspendedStart",y="suspendedYield",v="executing",m="completed",b={};function g(){}function w(){}function x(){}var _={};f(_,a,(function(){return this}));var E=Object.getPrototypeOf,O=E&&E(E(T([])));O&&O!==r&&n.call(O,a)&&(_=O);var k=x.prototype=g.prototype=Object.create(_);function j(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,u){var c=h(t[o],t,i);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==s(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(f).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function A(e,r,n){var o=d;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=D(u,n);if(s){if(s===b)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var c=h(e,r,n);if("normal"===c.type){if(o=n.done?m:y,c.arg===b)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=m,n.method="throw",n.arg=c.arg)}}}function D(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,D(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,b;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,b):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,b)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(s(e)+" is not iterable")}return w.prototype=x,o(k,"constructor",{value:x,configurable:!0}),o(x,"constructor",{value:w,configurable:!0}),w.displayName=f(x,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,f(t,c,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},j(S.prototype),f(S.prototype,u,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(p(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},j(k),f(k,c,"Generator"),f(k,a,(function(){return this})),f(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,b):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),C(r),b}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;C(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),b}},e}function f(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function p(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,h(n.key),n)}}function h(t){var e=function(t){if("object"!=s(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==s(e)?e:e+""}function d(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(d=function(){return!!t})()}function y(t){return y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},y(t)}function v(t,e){return v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},v(t,e)}var m=function(t){function e(t){var r,n,o,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,i=[t],o=y(o=e),r=function(t,e){if(e&&("object"==s(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(n,d()?Reflect.construct(o,i||[],y(n).constructor):o.apply(n,i)),Object.defineProperty(r,"schema",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(r,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","structured"]}),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&v(t,e)}(e,t),r=e,o=[{key:"toJSON",value:function(){return this.toJSONNotImplemented()}},{key:"getFormatInstructions",value:function(){return'You must format your output as a JSON value that adheres to a given "JSON Schema" instance.\n\n"JSON Schema" is a declarative language that allows you to annotate and validate JSON documents.\n\nFor example, the example "JSON Schema" instance {{"properties": {{"foo": {{"description": "a list of test words", "type": "array", "items": {{"type": "string"}}}}}}, "required": ["foo"]}}}}\nwould match an object with one required property, "foo". The "type" property specifies "foo" must be an "array", and the "description" property semantically describes it as "a list of test words". The items within "foo" must be strings.\nThus, the object {{"foo": ["bar", "baz"]}} is a well-formatted instance of this example "JSON Schema". The object {{"properties": {{"foo": ["bar", "baz"]}}}} is not well-formatted.\n\nYour output will be parsed and type-checked according to the provided schema instance, so make sure all fields in your output match the schema exactly and there are no trailing commas!\n\nHere is the JSON Schema instance your output must adhere to. Include the enclosing markdown codeblock:\n```json\n'.concat(JSON.stringify((0,u.Ik)(this.schema)),"\n```\n")}},{key:"parse",value:(h=l().mark((function t(e){var r,o;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r=e.includes("```")?e.trim().split(/```(?:json)?/)[1]:e.trim(),o=r.replace(/"([^"\\]*(\\.[^"\\]*)*)"/g,(function(t,e){var r=e.replace(/\n/g,"\\n");return'"'.concat(r,'"')})).replace(/\n/g,""),t.next=5,this.schema.parseAsync(JSON.parse(o));case 5:return t.abrupt("return",t.sent);case 8:throw t.prev=8,t.t0=t.catch(0),new n.CC('Failed to parse. Text: "'.concat(e,'". Error: ').concat(t.t0),e);case 11:case"end":return t.stop()}}),t,this,[[0,8]])})),m=function(){var t=this,e=arguments;return new Promise((function(r,n){var o=h.apply(t,e);function i(t){f(o,r,n,i,a,"next",t)}function a(t){f(o,r,n,i,a,"throw",t)}i(void 0)}))},function(t){return m.apply(this,arguments)})}],i=[{key:"lc_name",value:function(){return"StructuredOutputParser"}},{key:"fromZodSchema",value:function(t){return new this(t)}},{key:"fromNamesAndDescriptions",value:function(t){return new this(a.z.object(Object.fromEntries(Object.entries(t).map((function(t){var e,r,n=(r=2,function(t){if(Array.isArray(t))return t}(e=t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],s=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);s=!0);}catch(t){c=!0,o=t}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(e,r)||function(t,e){if(t){if("string"==typeof t)return c(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c(t,e):void 0}}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),o=n[0],i=n[1];return[o,a.z.string().describe(i)]})))))}}],o&&p(r.prototype,o),i&&p(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,o,i,h,m}(n.mJ),b=r(9190);r(2398)},844:(t,e,r)=>{"use strict";r.d(e,{sS:()=>o.sS,m2:()=>n.m,RZ:()=>o.RZ,FS:()=>o.FS,GL:()=>o.GL,Hh:()=>i.PromptTemplate,BJ:()=>o.BJ,Xm:()=>a.Xm});var n=r(6106),o=r(6725);r(7428);var i=r(6917),a=(r(4150),r(1754));r(2610)},5744:(t,e,r)=>{"use strict";r.d(e,{YN:()=>n.YN,ZI:()=>n.ZI,kI:()=>n.kI,tn:()=>n.tn,zZ:()=>n.zZ});var n=r(7258)},7911:(t,e,r)=>{"use strict";r.d(e,{RI:()=>C,RR:()=>T,aZ:()=>L,g6:()=>I,w3:()=>F});var n=r(372),o=r(5744);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function a(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function u(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?a(Object(r),!0).forEach((function(e){s(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function s(t,e,r){return(e=m(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function c(t,e){if(t){if("string"==typeof t)return l(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?l(t,e):void 0}}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function f(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function p(){p=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},u=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function f(t,e,r,n){var i=e&&e.prototype instanceof g?e:g,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:A(t,r,u)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=f;var d="suspendedStart",y="suspendedYield",v="executing",m="completed",b={};function g(){}function w(){}function x(){}var _={};l(_,u,(function(){return this}));var E=Object.getPrototypeOf,O=E&&E(E(T([])));O&&O!==r&&n.call(O,u)&&(_=O);var k=x.prototype=g.prototype=Object.create(_);function j(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,a,u,s){var c=h(t[o],t,a);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==i(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,u,s)}),(function(t){r("throw",t,u,s)})):e.resolve(f).then((function(t){l.value=t,u(l)}),(function(t){return r("throw",t,u,s)}))}s(c.arg)}var a;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function A(e,r,n){var o=d;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=D(u,n);if(s){if(s===b)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var c=h(e,r,n);if("normal"===c.type){if(o=n.done?m:y,c.arg===b)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=m,n.method="throw",n.arg=c.arg)}}}function D(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,D(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,b;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,b):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,b)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[u];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(i(e)+" is not iterable")}return w.prototype=x,o(k,"constructor",{value:x,configurable:!0}),o(x,"constructor",{value:w,configurable:!0}),w.displayName=l(x,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,l(t,c,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},j(S.prototype),l(S.prototype,s,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(f(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},j(k),l(k,c,"Generator"),l(k,u,(function(){return this})),l(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,b):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),C(r),b}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;C(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),b}},e}function h(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function d(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){h(i,n,o,a,u,"next",t)}function u(t){h(i,n,o,a,u,"throw",t)}a(void 0)}))}}function y(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,m(n.key),n)}}function v(t,e,r){return e&&y(t.prototype,e),r&&y(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function m(t){var e=function(t){if("object"!=i(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==i(e)?e:e+""}function b(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function g(t,e,r){return e=O(e),function(t,e){if(e&&("object"==i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,_()?Reflect.construct(e,r||[],O(t).constructor):e.apply(t,r))}function w(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&E(t,e)}function x(t){var e="function"==typeof Map?new Map:void 0;return x=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(e){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return function(t,e,r){if(_())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,e);var o=new(t.bind.apply(t,n));return r&&E(o,r.prototype),o}(t,arguments,O(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),E(r,t)},x(t)}function _(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_=function(){return!!t})()}function E(t,e){return E=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},E(t,e)}function O(t){return O=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},O(t)}function k(t){var e,r,n,o=2;for("undefined"!=typeof Symbol&&(r=Symbol.asyncIterator,n=Symbol.iterator);o--;){if(r&&null!=(e=t[r]))return e.call(t);if(n&&null!=(e=t[n]))return new j(e.call(t));r="@@asyncIterator",n="@@iterator"}throw new TypeError("Object is not async iterable")}function j(t){function e(t){if(Object(t)!==t)return Promise.reject(new TypeError(t+" is not an object."));var e=t.done;return Promise.resolve(t.value).then((function(t){return{value:t,done:e}}))}return j=function(t){this.s=t,this.n=t.next},j.prototype={s:null,n:null,next:function(){return e(this.n.apply(this.s,arguments))},return:function(t){var r=this.s.return;return void 0===r?Promise.resolve({value:t,done:!0}):e(r.apply(this.s,arguments))},throw:function(t){var r=this.s.return;return void 0===r?Promise.reject(t):e(r.apply(this.s,arguments))}},new j(t)}var S=function(t){function e(t,r){var n;return b(this,e),n=g(this,e,[t]),Object.defineProperty(n,"output",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),n.output=r,n}return w(e,t),v(e)}(x(Error)),A=function(t){function e(){return b(this,e),g(this,e,arguments)}return w(e,t),v(e,[{key:"returnValues",get:function(){return["output"]}},{key:"allowedTools",get:function(){}},{key:"_agentType",value:function(){throw new Error("Not implemented")}},{key:"returnStoppedResponse",value:function(t,e,r,n){if("force"===t)return Promise.resolve({returnValues:{output:"Agent stopped due to max iterations."},log:""});throw new Error("Invalid stopping method: ".concat(t))}},{key:"prepareForOutput",value:(r=d(p().mark((function t(e,r){return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",{});case 1:case"end":return t.stop()}}),t)}))),function(t,e){return r.apply(this,arguments)})}]);var r}(n.y),D=function(t){function e(){return b(this,e),g(this,e,arguments)}return w(e,t),v(e,[{key:"_agentActionType",value:function(){return"single"}}])}(A),P=function(t){function e(){return b(this,e),g(this,e,arguments)}return w(e,t),v(e,[{key:"_agentActionType",value:function(){return"multi"}}])}(A);function C(t){return void 0!==t.runnable}var L=function(t){function e(){var t;return b(this,e),t=g(this,e,arguments),Object.defineProperty(t,"streamRunnable",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(t,"singleAction",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),t}return w(e,t),v(e,null,[{key:"fromRunnables",value:function(t,e){var r,n=function(t){if(Array.isArray(t))return t}(r=t)||f(r)||c(r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),i=n[0],a=n.slice(1),u=o.zZ.from([i].concat(function(t){return function(t){if(Array.isArray(t))return l(t)}(t)||f(t)||c(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(a)),e.name);return u.singleAction=e.singleAction,u.streamRunnable=e.streamRunnable,u}},{key:"isAgentRunnableSequence",value:function(t){return"boolean"==typeof t.singleAction}}])}(o.zZ),T=function(t){function e(t){var r,n,o,i;return b(this,e),i=g(this,e,[t]),Object.defineProperty(i,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","agents","runnable"]}),Object.defineProperty(i,"runnable",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(i,"streamRunnable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(i,"defaultRunName",{enumerable:!0,configurable:!0,writable:!0,value:"RunnableAgent"}),i.runnable=t.runnable,i.defaultRunName=null!==(r=null!==(n=t.defaultRunName)&&void 0!==n?n:i.runnable.name)&&void 0!==r?r:i.defaultRunName,i.streamRunnable=null!==(o=t.streamRunnable)&&void 0!==o?o:i.streamRunnable,i}return w(e,t),v(e,[{key:"inputKeys",get:function(){return[]}},{key:"plan",value:(r=d(p().mark((function t(e,r,n,i){var a,s,c,l,f,h,d,y,v,m;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=u(u({},r),{},{steps:e}),s=(0,o.tn)(i,{callbacks:n,runName:this.defaultRunName}),!this.streamRunnable){t.next=43;break}return t.next=5,this.runnable.stream(a,s);case 5:c=t.sent,f=!1,h=!1,t.prev=8,y=k(c);case 10:return t.next=12,y.next();case 12:if(!(f=!(v=t.sent).done)){t.next=22;break}if(m=v.value,void 0!==l){t.next=18;break}l=m,t.next=19;break;case 18:throw new Error(["Multiple agent actions/finishes received in streamed agent output.",'Set "streamRunnable: false" when initializing the agent to invoke this agent in non-streaming mode.'].join("\n"));case 19:f=!1,t.next=10;break;case 22:t.next=28;break;case 24:t.prev=24,t.t0=t.catch(8),h=!0,d=t.t0;case 28:if(t.prev=28,t.prev=29,!f||null==y.return){t.next=33;break}return t.next=33,y.return();case 33:if(t.prev=33,!h){t.next=36;break}throw d;case 36:return t.finish(33);case 37:return t.finish(28);case 38:if(void 0!==l){t.next=40;break}throw new Error(["No streaming output received from underlying runnable.",'Set "streamRunnable: false" when initializing the agent to invoke this agent in non-streaming mode.'].join("\n"));case 40:return t.abrupt("return",l);case 43:return t.abrupt("return",this.runnable.invoke(a,s));case 44:case"end":return t.stop()}}),t,this,[[8,24,28,38],[29,,33,37]])}))),function(t,e,n,o){return r.apply(this,arguments)})}]);var r}(D),F=function(t){function e(t){var r,n,o,i;return b(this,e),i=g(this,e,[t]),Object.defineProperty(i,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","agents","runnable"]}),Object.defineProperty(i,"runnable",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(i,"defaultRunName",{enumerable:!0,configurable:!0,writable:!0,value:"RunnableAgent"}),Object.defineProperty(i,"stop",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(i,"streamRunnable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),i.runnable=t.runnable,i.stop=t.stop,i.defaultRunName=null!==(r=null!==(n=t.defaultRunName)&&void 0!==n?n:i.runnable.name)&&void 0!==r?r:i.defaultRunName,i.streamRunnable=null!==(o=t.streamRunnable)&&void 0!==o?o:i.streamRunnable,i}return w(e,t),v(e,[{key:"inputKeys",get:function(){return[]}},{key:"plan",value:(r=d(p().mark((function t(e,r,n,i){var a,s,c,l,f,h,d,y,v,m,b;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=u(u({},r),{},{steps:e}),s=(0,o.tn)(i,{callbacks:n,runName:this.defaultRunName}),!this.streamRunnable){t.next=43;break}return t.next=5,this.runnable.stream(a,s);case 5:l=t.sent,h=!1,d=!1,t.prev=8,v=k(l);case 10:return t.next=12,v.next();case 12:if(!(h=!(m=t.sent).done)){t.next=22;break}if(b=m.value,void 0!==f){t.next=18;break}f=b,t.next=19;break;case 18:throw new Error(["Multiple agent actions/finishes received in streamed agent output.",'Set "streamRunnable: false" when initializing the agent to invoke this agent in non-streaming mode.'].join("\n"));case 19:h=!1,t.next=10;break;case 22:t.next=28;break;case 24:t.prev=24,t.t0=t.catch(8),d=!0,y=t.t0;case 28:if(t.prev=28,t.prev=29,!h||null==v.return){t.next=33;break}return t.next=33,v.return();case 33:if(t.prev=33,!d){t.next=36;break}throw y;case 36:return t.finish(33);case 37:return t.finish(28);case 38:if(void 0!==f){t.next=40;break}throw new Error(["No streaming output received from underlying runnable.",'Set "streamRunnable: false" when initializing the agent to invoke this agent in non-streaming mode.'].join("\n"));case 40:c=f,t.next=46;break;case 43:return t.next=45,this.runnable.invoke(a,s);case 45:c=t.sent;case 46:if(p=c,Array.isArray(p)||void 0===(null==p?void 0:p.tool)){t.next=48;break}return t.abrupt("return",[c]);case 48:return t.abrupt("return",c);case 49:case"end":return t.stop()}var p}),t,this,[[8,24,28,38],[29,,33,37]])}))),function(t,e,n,o){return r.apply(this,arguments)})}]);var r}(P),I=function(t){function e(t){var r;return b(this,e),r=g(this,e,[t]),Object.defineProperty(r,"llmChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(r,"outputParser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(r,"_allowedTools",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),r.llmChain=t.llmChain,r._allowedTools=t.allowedTools,r.outputParser=t.outputParser,r}return w(e,t),v(e,[{key:"allowedTools",get:function(){return this._allowedTools}},{key:"inputKeys",get:function(){return this.llmChain.inputKeys.filter((function(t){return"agent_scratchpad"!==t}))}},{key:"_stop",value:function(){return["\n".concat(this.observationPrefix())]}},{key:"finishToolName",value:function(){return"Final Answer"}},{key:"constructScratchPad",value:(a=d(p().mark((function t(e){var r=this;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.reduce((function(t,e){var n=e.action,o=e.observation;return t+[n.log,"".concat(r.observationPrefix()).concat(o),r.llmPrefix()].join("\n")}),""));case 1:case"end":return t.stop()}}),t)}))),function(t){return a.apply(this,arguments)})},{key:"_plan",value:(i=d(p().mark((function t(e,r,n,o){var i,a,s;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.constructScratchPad(e);case 2:return i=t.sent,a=u(u({},r),{},{agent_scratchpad:n?"".concat(i).concat(n):i}),0!==this._stop().length&&(a.stop=this._stop()),t.next=7,this.llmChain.predict(a,o);case 7:if(s=t.sent,this.outputParser){t.next=10;break}throw new Error("Output parser not set");case 10:return t.abrupt("return",this.outputParser.parse(s,o));case 11:case"end":return t.stop()}}),t,this)}))),function(t,e,r,n){return i.apply(this,arguments)})},{key:"plan",value:function(t,e,r){return this._plan(t,e,void 0,r)}},{key:"returnStoppedResponse",value:(o=d(p().mark((function t(e,r,n,o){var i;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("force"!==e){t.next=2;break}return t.abrupt("return",{returnValues:{output:"Agent stopped due to max iterations."},log:""});case 2:if("generate"!==e){t.next=17;break}return t.prev=3,t.next=6,this._plan(r,n,"\n\nI now need to return a final answer based on the previous steps:",o);case 6:if(!("returnValues"in(i=t.sent))){t.next=9;break}return t.abrupt("return",i);case 9:return t.abrupt("return",{returnValues:{output:i.log},log:i.log});case 12:if(t.prev=12,t.t0=t.catch(3),t.t0 instanceof S){t.next=16;break}throw t.t0;case 16:return t.abrupt("return",{returnValues:{output:t.t0.output},log:t.t0.output});case 17:throw new Error("Invalid stopping method: ".concat(e));case 18:case"end":return t.stop()}}),t,this,[[3,12]])}))),function(t,e,r,n){return o.apply(this,arguments)})}],[{key:"getDefaultOutputParser",value:function(t){throw new Error("Not implemented")}},{key:"createPrompt",value:function(t,e){throw new Error("Not implemented")}},{key:"fromLLMAndTools",value:function(t,e,r){throw new Error("Not implemented")}},{key:"validateTools",value:function(t){}},{key:"deserialize",value:(n=d(p().mark((function t(e){var n,o;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=e._type,t.next="zero-shot-react-description"===t.t0?3:8;break;case 3:return t.next=5,Promise.resolve().then(r.bind(r,890));case 5:return n=t.sent,o=n.ZeroShotAgent,t.abrupt("return",o.deserialize(e));case 8:throw new Error("Unknown agent type");case 9:case"end":return t.stop()}}),t)}))),function(t){return n.apply(this,arguments)})}]);var n,o,i,a}(D)},890:(t,e,r)=>{"use strict";r.r(e),r.d(e,{ZeroShotAgent:()=>A});var n=r(844),o=r(1931),i=r(7911);function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function u(){u=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",l=i.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,r){return t[e]=r}}function p(t,e,r,n){var i=e&&e.prototype instanceof g?e:g,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:A(t,r,u)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=p;var d="suspendedStart",y="suspendedYield",v="executing",m="completed",b={};function g(){}function w(){}function x(){}var _={};f(_,s,(function(){return this}));var E=Object.getPrototypeOf,O=E&&E(E(T([])));O&&O!==r&&n.call(O,s)&&(_=O);var k=x.prototype=g.prototype=Object.create(_);function j(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,u,s){var c=h(t[o],t,i);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==a(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,u,s)}),(function(t){r("throw",t,u,s)})):e.resolve(f).then((function(t){l.value=t,u(l)}),(function(t){return r("throw",t,u,s)}))}s(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function A(e,r,n){var o=d;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=D(u,n);if(s){if(s===b)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var c=h(e,r,n);if("normal"===c.type){if(o=n.done?m:y,c.arg===b)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=m,n.method="throw",n.arg=c.arg)}}}function D(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,D(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,b;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,b):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,b)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[s];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(a(e)+" is not iterable")}return w.prototype=x,o(k,"constructor",{value:x,configurable:!0}),o(x,"constructor",{value:w,configurable:!0}),w.displayName=f(x,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,f(t,l,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},j(S.prototype),f(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(p(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},j(k),f(k,l,"Generator"),f(k,s,(function(){return this})),f(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,b):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),C(r),b}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;C(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),b}},e}function s(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function c(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?s(Object(r),!0).forEach((function(e){l(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function l(t,e,r){return(e=function(t){var e=function(t){if("object"!=a(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==a(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function f(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}var p=function(){var t,e=(t=u().mark((function t(e,r,n,i,a){var s;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n.load_from_llm_and_tools){t.next=6;break}if(e){t.next=3;break}throw new Error("Loading from llm and tools, llm must be provided.");case 3:if(r){t.next=5;break}throw new Error("Loading from llm and tools, tools must be provided.");case 5:return t.abrupt("return",i(e,r,n));case 6:if(n.llm_chain){t.next=8;break}throw new Error("Loading from constructor, llm_chain must be provided.");case 8:return t.next=10,o.LLMChain.deserialize(n.llm_chain);case 10:return s=t.sent,t.abrupt("return",a(c(c({},n),{},{llmChain:s})));case 12:case"end":return t.stop()}}),t)})),function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){f(i,n,o,a,u,"next",t)}function u(t){f(i,n,o,a,u,"throw",t)}a(void 0)}))});return function(t,r,n,o,i){return e.apply(this,arguments)}}(),h=r(3829),d=r(3529);function y(t){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},y(t)}var v=["llm","tools"];function m(){m=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof g?e:g,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:A(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",v="completed",b={};function g(){}function w(){}function x(){}var _={};c(_,a,(function(){return this}));var E=Object.getPrototypeOf,O=E&&E(E(T([])));O&&O!==r&&n.call(O,a)&&(_=O);var k=x.prototype=g.prototype=Object.create(_);function j(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,u){var s=f(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==y(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function A(e,r,n){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=D(u,n);if(s){if(s===b)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?v:h,c.arg===b)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=v,n.method="throw",n.arg=c.arg)}}}function D(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,D(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,b;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,b):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,b)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(y(e)+" is not iterable")}return w.prototype=x,o(k,"constructor",{value:x,configurable:!0}),o(x,"constructor",{value:w,configurable:!0}),w.displayName=c(x,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,c(t,s,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},j(S.prototype),c(S.prototype,u,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},j(k),c(k,s,"Generator"),c(k,a,(function(){return this})),c(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,b):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),C(r),b}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;C(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),b}},e}function b(t,e){if(null==t)return{};var r,n,o=function(t,e){if(null==t)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.includes(n))continue;r[n]=t[n]}return r}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.includes(r)||{}.propertyIsEnumerable.call(t,r)&&(o[r]=t[r])}return o}function g(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function w(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function x(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?w(Object(r),!0).forEach((function(e){_(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):w(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function _(t,e,r){return(e=O(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function E(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,O(n.key),n)}}function O(t){var e=function(t){if("object"!=y(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=y(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==y(e)?e:e+""}function k(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(k=function(){return!!t})()}function j(t){return j=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},j(t)}function S(t,e){return S=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},S(t,e)}var A=function(t){function e(t){var r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=null!==(r=null==t?void 0:t.outputParser)&&void 0!==r?r:e.getDefaultOutputParser();return n=function(t,e,r){return e=j(e),function(t,e){if(e&&("object"==y(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,k()?Reflect.construct(e,r||[],j(t).constructor):e.apply(t,r))}(this,e,[x(x({},t),{},{outputParser:o})]),Object.defineProperty(n,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","agents","mrkl"]}),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&S(t,e)}(e,t),r=e,i=[{key:"_agentType",value:function(){return"zero-shot-react-description"}},{key:"observationPrefix",value:function(){return"Observation: "}},{key:"llmPrefix",value:function(){return"Thought:"}}],a=[{key:"lc_name",value:function(){return"ZeroShotAgent"}},{key:"getDefaultOutputParser",value:function(t){return new h.W(t)}},{key:"validateTools",value:function(t){var e=t.find((function(t){return!t.description}));if(e){var r="Got a tool ".concat(e.name," without a description.")+" This agent requires descriptions for all tools.";throw new Error(r)}}},{key:"createPrompt",value:function(t,e){var r=null!=e?e:{},o=r.prefix,i=void 0===o?d.H3:o,a=r.suffix,u=void 0===a?d.Er:a,s=r.inputVariables,c=void 0===s?["input","agent_scratchpad"]:s,l=t.map((function(t){return"".concat(t.name,": ").concat(t.description)})).join("\n"),f=t.map((function(t){return t.name})),p=[i,l,(0,n.Xm)(d.OD,"f-string",{tool_names:f}),u].join("\n\n");return new n.Hh({template:p,inputVariables:c})}},{key:"fromLLMAndTools",value:function(t,r,n){var i,a;e.validateTools(r);var u=e.createPrompt(r,n),s=null!==(i=null==n?void 0:n.outputParser)&&void 0!==i?i:e.getDefaultOutputParser();return new e({llmChain:new o.LLMChain({prompt:u,llm:t,callbacks:null!==(a=null==n?void 0:n.callbacks)&&void 0!==a?a:null==n?void 0:n.callbackManager}),allowedTools:r.map((function(t){return t.name})),outputParser:s})}},{key:"deserialize",value:(u=m().mark((function t(r){var n,o,i;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=r.llm,o=r.tools,i=b(r,v),t.abrupt("return",p(n,o,i,(function(t,r,n){return e.fromLLMAndTools(t,r,{prefix:n.prefix,suffix:n.suffix,inputVariables:n.input_variables})}),(function(t){return new e(t)})));case 2:case"end":return t.stop()}}),t)})),s=function(){var t=this,e=arguments;return new Promise((function(r,n){var o=u.apply(t,e);function i(t){g(o,r,n,i,a,"next",t)}function a(t){g(o,r,n,i,a,"throw",t)}i(void 0)}))},function(t){return s.apply(this,arguments)})}],i&&E(r.prototype,i),a&&E(r,a),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,i,a,u,s}(i.g6)},3829:(t,e,r)=>{"use strict";r.d(e,{W:()=>d});var n=r(2743),o=r(4159),i=r(3529);function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function u(){u=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",l=i.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,r){return t[e]=r}}function p(t,e,r,n){var i=e&&e.prototype instanceof g?e:g,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:A(t,r,u)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=p;var d="suspendedStart",y="suspendedYield",v="executing",m="completed",b={};function g(){}function w(){}function x(){}var _={};f(_,s,(function(){return this}));var E=Object.getPrototypeOf,O=E&&E(E(T([])));O&&O!==r&&n.call(O,s)&&(_=O);var k=x.prototype=g.prototype=Object.create(_);function j(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,u,s){var c=h(t[o],t,i);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==a(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,u,s)}),(function(t){r("throw",t,u,s)})):e.resolve(f).then((function(t){l.value=t,u(l)}),(function(t){return r("throw",t,u,s)}))}s(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function A(e,r,n){var o=d;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=D(u,n);if(s){if(s===b)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var c=h(e,r,n);if("normal"===c.type){if(o=n.done?m:y,c.arg===b)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=m,n.method="throw",n.arg=c.arg)}}}function D(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,D(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,b;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,b):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,b)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[s];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(a(e)+" is not iterable")}return w.prototype=x,o(k,"constructor",{value:x,configurable:!0}),o(x,"constructor",{value:w,configurable:!0}),w.displayName=f(x,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,f(t,l,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},j(S.prototype),f(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(p(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},j(k),f(k,l,"Generator"),f(k,s,(function(){return this})),f(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,b):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),C(r),b}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;C(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),b}},e}function s(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function c(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,l(n.key),n)}}function l(t){var e=function(t){if("object"!=a(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==a(e)?e:e+""}function f(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(f=function(){return!!t})()}function p(t){return p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},p(t)}function h(t,e){return h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},h(t,e)}var d=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=function(t,e,r){return e=p(e),function(t,e){if(e&&("object"==a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,f()?Reflect.construct(e,r||[],p(t).constructor):e.apply(t,r))}(this,e,[t]),Object.defineProperty(r,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","agents","mrkl"]}),Object.defineProperty(r,"finishToolName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),r.finishToolName=(null==t?void 0:t.finishToolName)||"Final Answer:",r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&h(t,e)}(e,t),r=e,o=[{key:"parse",value:(l=u().mark((function t(e){var r,o,i;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.includes(this.finishToolName)){t.next=4;break}return r=e.split(this.finishToolName),o=r[r.length-1].trim(),t.abrupt("return",{returnValues:{output:o},log:e});case 4:if(i=/Action:([\s\S]*?)(?:\nAction Input:([\s\S]*?))?$/.exec(e)){t.next=7;break}throw new n.CC("Could not parse LLM output: ".concat(e));case 7:return t.abrupt("return",{tool:i[1].trim(),toolInput:i[2]?i[2].trim().replace(/^("+)(.*?)(\1)$/,"$2"):"",log:e});case 8:case"end":return t.stop()}}),t,this)})),d=function(){var t=this,e=arguments;return new Promise((function(r,n){var o=l.apply(t,e);function i(t){s(o,r,n,i,a,"next",t)}function a(t){s(o,r,n,i,a,"throw",t)}i(void 0)}))},function(t){return d.apply(this,arguments)})},{key:"getFormatInstructions",value:function(){return i.OD}}],o&&c(r.prototype,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,o,l,d}(o.Q)},3529:(t,e,r)=>{"use strict";r.d(e,{Er:()=>i,H3:()=>n,OD:()=>o});var n="Answer the following questions as best you can. You have access to the following tools:",o="Use the following format in your response:\n\nQuestion: the input question you must answer\nThought: you should always think about what to do\nAction: the action to take, should be one of [{tool_names}]\nAction Input: the input to the action\nObservation: the result of the action\n... (this Thought/Action/Action Input/Observation can repeat N times)\nThought: I now know the final answer\nFinal Answer: the final answer to the original input question",i="Begin!\n\nQuestion: {input}\nThought:{agent_scratchpad}"},4159:(t,e,r)=>{"use strict";r.d(e,{$:()=>y,Q:()=>d});var n=r(2743);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function i(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,u(n.key),n)}}function a(t,e,r){return e&&i(t.prototype,e),r&&i(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function u(t){var e=function(t){if("object"!=o(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==o(e)?e:e+""}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e,r){return e=f(e),function(t,e){if(e&&("object"==o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,l()?Reflect.construct(e,r||[],f(t).constructor):e.apply(t,r))}function l(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(l=function(){return!!t})()}function f(t){return f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},f(t)}function p(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&h(t,e)}function h(t,e){return h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},h(t,e)}var d=function(t){function e(){return s(this,e),c(this,e,arguments)}return p(e,t),a(e)}(n.mJ),y=function(t){function e(){return s(this,e),c(this,e,arguments)}return p(e,t),a(e)}(n.mJ)},2561:(t,e,r)=>{"use strict";r.d(e,{r:()=>O});var n=r(5681),o=r(4958),i=r(5744),a=r(5327),u=["memory","callbackManager"];function s(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],s=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);s=!0);}catch(t){c=!0,o=t}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(t,e)||function(t,e){if(t){if("string"==typeof t)return c(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function l(){l=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function f(t,e,r,n){var i=e&&e.prototype instanceof g?e:g,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:A(t,r,u)}),a}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=f;var h="suspendedStart",d="suspendedYield",y="executing",m="completed",b={};function g(){}function w(){}function x(){}var _={};c(_,a,(function(){return this}));var E=Object.getPrototypeOf,O=E&&E(E(T([])));O&&O!==r&&n.call(O,a)&&(_=O);var k=x.prototype=g.prototype=Object.create(_);function j(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,u){var s=p(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==v(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function A(e,r,n){var o=h;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=D(u,n);if(s){if(s===b)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var c=p(e,r,n);if("normal"===c.type){if(o=n.done?m:d,c.arg===b)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=m,n.method="throw",n.arg=c.arg)}}}function D(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,D(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;var i=p(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,b;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,b):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,b)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(v(e)+" is not iterable")}return w.prototype=x,o(k,"constructor",{value:x,configurable:!0}),o(x,"constructor",{value:w,configurable:!0}),w.displayName=c(x,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,c(t,s,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},j(S.prototype),c(S.prototype,u,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(f(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},j(k),c(k,s,"Generator"),c(k,a,(function(){return this})),c(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,b):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),C(r),b}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;C(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),b}},e}function f(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function p(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){f(i,n,o,a,u,"next",t)}function u(t){f(i,n,o,a,u,"throw",t)}a(void 0)}))}}function h(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function d(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?h(Object(r),!0).forEach((function(e){y(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function y(t,e,r){return(e=b(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function v(t){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v(t)}function m(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,b(n.key),n)}}function b(t){var e=function(t){if("object"!=v(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=v(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==v(e)?e:e+""}function g(t,e,r){return e=_(e),function(t,e){if(e&&("object"==v(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return w(t)}(t,x()?Reflect.construct(e,r||[],_(t).constructor):e.apply(t,r))}function w(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function x(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(x=function(){return!!t})()}function _(t){return _=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_(t)}function E(t,e){return E=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},E(t,e)}var O=function(t){function e(t,r,n){var o;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),1!==arguments.length||"object"!==v(t)||"saveContext"in t)(o=g(this,e,[{verbose:r,callbacks:n}])).memory=t;else{var i=t.memory,a=t.callbackManager,s=function(t,e){if(null==t)return{};var r,n,o=function(t,e){if(null==t)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.includes(n))continue;r[n]=t[n]}return r}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.includes(r)||{}.propertyIsEnumerable.call(t,r)&&(o[r]=t[r])}return o}(t,u);(o=g(this,e,[d(d({},s),{},{callbacks:null!=a?a:s.callbacks})])).memory=i}return w(o)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&E(t,e)}(e,t),a=e,c=[{key:"lc_namespace",get:function(){return["langchain","chains",this._chainType()]}},{key:"_selectMemoryInputs",value:function(t){var e=d({},t);return"signal"in e&&delete e.signal,"timeout"in e&&delete e.timeout,e}},{key:"invoke",value:(j=p(l().mark((function t(e,r){var a,u,s,c,f;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=(0,i.ZI)(r),t.next=3,this._formatValues(e);case 3:return u=t.sent,t.next=6,o.Td.configure(null==a?void 0:a.callbacks,this.callbacks,null==a?void 0:a.tags,this.tags,null==a?void 0:a.metadata,this.metadata,{verbose:this.verbose});case 6:return s=t.sent,t.next=9,null==s?void 0:s.handleChainStart(this.toJSON(),u,void 0,void 0,void 0,void 0,null==a?void 0:a.runName);case 9:return c=t.sent,t.prev=10,t.next=13,u.signal?Promise.race([this._call(u,c,a),new Promise((function(t,e){var r;null===(r=u.signal)||void 0===r||r.addEventListener("abort",(function(){e(new Error("AbortError"))}))}))]):this._call(u,c,a);case 13:f=t.sent,t.next=21;break;case 16:return t.prev=16,t.t0=t.catch(10),t.next=20,null==c?void 0:c.handleChainError(t.t0);case 20:throw t.t0;case 21:if(null==this.memory){t.next=24;break}return t.next=24,this.memory.saveContext(this._selectMemoryInputs(e),f);case 24:return t.next=26,null==c?void 0:c.handleChainEnd(f);case 26:return Object.defineProperty(f,n.SP,{value:c?{runId:null==c?void 0:c.runId}:void 0,configurable:!0}),t.abrupt("return",f);case 28:case"end":return t.stop()}}),t,this,[[10,16]])}))),function(t,e){return j.apply(this,arguments)})},{key:"_validateOutputs",value:function(t){var e=this.outputKeys.filter((function(e){return!(e in t)}));if(e.length)throw new Error("Missing output keys: ".concat(e.join(", ")," from chain ").concat(this._chainType()))}},{key:"prepOutputs",value:(k=p(l().mark((function t(e,r){var n,o=arguments;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=o.length>2&&void 0!==o[2]&&o[2],this._validateOutputs(r),!this.memory){t.next=5;break}return t.next=5,this.memory.saveContext(e,r);case 5:if(!n){t.next=7;break}return t.abrupt("return",r);case 7:return t.abrupt("return",d(d({},e),r));case 8:case"end":return t.stop()}}),t,this)}))),function(t,e){return k.apply(this,arguments)})},{key:"serialize",value:function(){throw new Error("Method not implemented.")}},{key:"run",value:(O=p(l().mark((function t(e,r){var n,o,i,a,u=this;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((n=this.inputKeys.filter((function(t){var e,r;return null===(e=!(null!==(r=u.memory)&&void 0!==r&&r.memoryKeys.includes(t)))||void 0===e||e}))).length<=1){t.next=4;break}throw new Error("Chain ".concat(this._chainType()," expects multiple inputs, cannot use 'run' "));case 4:return o=n.length?y({},n[0],e):{},t.next=7,this.call(o,r);case 7:if(i=t.sent,1!==(a=Object.keys(i)).length){t.next=11;break}return t.abrupt("return",i[a[0]]);case 11:throw new Error("return values have multiple keys, `run` only supported when one key currently");case 12:case"end":return t.stop()}}),t,this)}))),function(t,e){return O.apply(this,arguments)})},{key:"_formatValues",value:(_=p(l().mark((function t(e){var r,n,o,i,a,u,c;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((r=d({},e)).timeout&&!r.signal&&(r.signal=AbortSignal.timeout(r.timeout),delete r.timeout),null==this.memory){t.next=7;break}return t.next=5,this.memory.loadMemoryVariables(this._selectMemoryInputs(e));case 5:for(n=t.sent,o=0,i=Object.entries(n);o<i.length;o++)a=s(i[o],2),u=a[0],c=a[1],r[u]=c;case 7:return t.abrupt("return",r);case 8:case"end":return t.stop()}}),t,this)}))),function(t){return _.apply(this,arguments)})},{key:"call",value:(x=p(l().mark((function t(e,r,n){var i;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=d({tags:n},(0,o.H_)(r)),t.abrupt("return",this.invoke(e,i));case 2:case"end":return t.stop()}}),t,this)}))),function(t,e,r){return x.apply(this,arguments)})},{key:"apply",value:(b=p(l().mark((function t(e,r){var n=this;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Promise.all(e.map(function(){var t=p(l().mark((function t(e,o){return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",n.call(e,null==r?void 0:r[o]));case 1:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}())));case 1:case"end":return t.stop()}}),t)}))),function(t,e){return b.apply(this,arguments)})}],f=[{key:"deserialize",value:(h=p(l().mark((function t(e){var n,o,i,a,u,s,c,f,p,h,d,y,v,m,b,g,w,x=arguments;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=x.length>1&&void 0!==x[1]?x[1]:{},t.t0=e._type,t.next="llm_chain"===t.t0?4:"sequential_chain"===t.t0?9:"simple_sequential_chain"===t.t0?14:"stuff_documents_chain"===t.t0?19:"map_reduce_documents_chain"===t.t0?24:"refine_documents_chain"===t.t0?29:"vector_db_qa"===t.t0?34:"api_chain"===t.t0?39:44;break;case 4:return t.next=6,Promise.resolve().then(r.bind(r,1931));case 6:return o=t.sent,i=o.LLMChain,t.abrupt("return",i.deserialize(e));case 9:return t.next=11,r.e(340).then(r.bind(r,4340));case 11:return a=t.sent,u=a.SequentialChain,t.abrupt("return",u.deserialize(e));case 14:return t.next=16,r.e(340).then(r.bind(r,4340));case 16:return s=t.sent,c=s.SimpleSequentialChain,t.abrupt("return",c.deserialize(e));case 19:return t.next=21,Promise.resolve().then(r.bind(r,5119));case 21:return f=t.sent,p=f.StuffDocumentsChain,t.abrupt("return",p.deserialize(e));case 24:return t.next=26,Promise.resolve().then(r.bind(r,5119));case 26:return h=t.sent,d=h.MapReduceDocumentsChain,t.abrupt("return",d.deserialize(e));case 29:return t.next=31,Promise.resolve().then(r.bind(r,5119));case 31:return y=t.sent,v=y.RefineDocumentsChain,t.abrupt("return",v.deserialize(e));case 34:return t.next=36,Promise.resolve().then(r.bind(r,8440));case 36:return m=t.sent,b=m.VectorDBQAChain,t.abrupt("return",b.deserialize(e,n));case 39:return t.next=41,r.e(391).then(r.bind(r,3391));case 41:return g=t.sent,w=g.APIChain,t.abrupt("return",w.deserialize(e));case 44:throw new Error("Invalid prompt type in config: ".concat(e._type));case 45:case"end":return t.stop()}}),t)}))),function(t){return h.apply(this,arguments)})}],c&&m(a.prototype,c),f&&m(a,f),Object.defineProperty(a,"prototype",{writable:!1}),a;var a,c,f,h,b,x,_,O,k,j}(a.ZE)},5119:(t,e,r)=>{"use strict";r.r(e),r.d(e,{MapReduceDocumentsChain:()=>j,RefineDocumentsChain:()=>S,StuffDocumentsChain:()=>k});var n=r(844),o=r(2561),i=r(1931);function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function u(){u=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",l=i.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,r){return t[e]=r}}function p(t,e,r,n){var i=e&&e.prototype instanceof g?e:g,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:A(t,r,u)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=p;var d="suspendedStart",y="suspendedYield",v="executing",m="completed",b={};function g(){}function w(){}function x(){}var _={};f(_,s,(function(){return this}));var E=Object.getPrototypeOf,O=E&&E(E(T([])));O&&O!==r&&n.call(O,s)&&(_=O);var k=x.prototype=g.prototype=Object.create(_);function j(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,u,s){var c=h(t[o],t,i);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==a(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,u,s)}),(function(t){r("throw",t,u,s)})):e.resolve(f).then((function(t){l.value=t,u(l)}),(function(t){return r("throw",t,u,s)}))}s(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function A(e,r,n){var o=d;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=D(u,n);if(s){if(s===b)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var c=h(e,r,n);if("normal"===c.type){if(o=n.done?m:y,c.arg===b)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=m,n.method="throw",n.arg=c.arg)}}}function D(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,D(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,b;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,b):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,b)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[s];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(a(e)+" is not iterable")}return w.prototype=x,o(k,"constructor",{value:x,configurable:!0}),o(x,"constructor",{value:w,configurable:!0}),w.displayName=f(x,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,f(t,l,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},j(S.prototype),f(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(p(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},j(k),f(k,l,"Generator"),f(k,s,(function(){return this})),f(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,b):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),C(r),b}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;C(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),b}},e}function s(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function c(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){s(i,n,o,a,u,"next",t)}function u(t){s(i,n,o,a,u,"throw",t)}a(void 0)}))}}function l(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function f(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?l(Object(r),!0).forEach((function(e){p(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function p(t,e,r){return(e=g(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function h(t,e){if(null==t)return{};var r,n,o=function(t,e){if(null==t)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.includes(n))continue;r[n]=t[n]}return r}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.includes(r)||{}.propertyIsEnumerable.call(t,r)&&(o[r]=t[r])}return o}function d(t){return function(t){if(Array.isArray(t))return y(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return y(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?y(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function v(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function m(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,g(n.key),n)}}function b(t,e,r){return e&&m(t.prototype,e),r&&m(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function g(t){var e=function(t){if("object"!=a(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==a(e)?e:e+""}function w(t,e,r){return e=_(e),function(t,e){if(e&&("object"==a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,x()?Reflect.construct(e,r||[],_(t).constructor):e.apply(t,r))}function x(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(x=function(){return!!t})()}function _(t){return _=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_(t)}function E(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&O(t,e)}function O(t,e){return O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},O(t,e)}var k=function(t){function e(t){var r,n,o;return v(this,e),o=w(this,e,[t]),Object.defineProperty(o,"llmChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(o,"inputKey",{enumerable:!0,configurable:!0,writable:!0,value:"input_documents"}),Object.defineProperty(o,"documentVariableName",{enumerable:!0,configurable:!0,writable:!0,value:"context"}),o.llmChain=t.llmChain,o.documentVariableName=null!==(r=t.documentVariableName)&&void 0!==r?r:o.documentVariableName,o.inputKey=null!==(n=t.inputKey)&&void 0!==n?n:o.inputKey,o}return E(e,t),b(e,[{key:"inputKeys",get:function(){var t=this;return[this.inputKey].concat(d(this.llmChain.inputKeys)).filter((function(e){return e!==t.documentVariableName}))}},{key:"outputKeys",get:function(){return this.llmChain.outputKeys}},{key:"_prepInputs",value:function(t){if(!(this.inputKey in t))throw new Error("Document key ".concat(this.inputKey," not found."));var e=this.inputKey,r=t[e],n=h(t,[e].map(g)),o=r.map((function(t){return t.pageContent})).join("\n\n");return f(f({},n),{},p({},this.documentVariableName,o))}},{key:"_call",value:(n=c(u().mark((function t(e,r){var n;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.llmChain.call(this._prepInputs(e),null==r?void 0:r.getChild("combine_documents"));case 2:return n=t.sent,t.abrupt("return",n);case 4:case"end":return t.stop()}}),t,this)}))),function(t,e){return n.apply(this,arguments)})},{key:"_chainType",value:function(){return"stuff_documents_chain"}},{key:"serialize",value:function(){return{_type:this._chainType(),llm_chain:this.llmChain.serialize()}}}],[{key:"lc_name",value:function(){return"StuffDocumentsChain"}},{key:"deserialize",value:(r=c(u().mark((function t(r){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r.llm_chain){t.next=2;break}throw new Error("Missing llm_chain");case 2:return t.t0=e,t.next=5,i.LLMChain.deserialize(r.llm_chain);case 5:return t.t1=t.sent,t.t2={llmChain:t.t1},t.abrupt("return",new t.t0(t.t2));case 8:case"end":return t.stop()}}),t)}))),function(t){return r.apply(this,arguments)})}]);var r,n}(o.r),j=function(t){function e(t){var r,n,o,i,a,u,s;return v(this,e),s=w(this,e,[t]),Object.defineProperty(s,"llmChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(s,"inputKey",{enumerable:!0,configurable:!0,writable:!0,value:"input_documents"}),Object.defineProperty(s,"documentVariableName",{enumerable:!0,configurable:!0,writable:!0,value:"context"}),Object.defineProperty(s,"returnIntermediateSteps",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(s,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:3e3}),Object.defineProperty(s,"maxIterations",{enumerable:!0,configurable:!0,writable:!0,value:10}),Object.defineProperty(s,"ensureMapStep",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(s,"combineDocumentChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),s.llmChain=t.llmChain,s.combineDocumentChain=t.combineDocumentChain,s.documentVariableName=null!==(r=t.documentVariableName)&&void 0!==r?r:s.documentVariableName,s.ensureMapStep=null!==(n=t.ensureMapStep)&&void 0!==n?n:s.ensureMapStep,s.inputKey=null!==(o=t.inputKey)&&void 0!==o?o:s.inputKey,s.maxTokens=null!==(i=t.maxTokens)&&void 0!==i?i:s.maxTokens,s.maxIterations=null!==(a=t.maxIterations)&&void 0!==a?a:s.maxIterations,s.returnIntermediateSteps=null!==(u=t.returnIntermediateSteps)&&void 0!==u&&u,s}return E(e,t),b(e,[{key:"inputKeys",get:function(){return[this.inputKey].concat(d(this.combineDocumentChain.inputKeys))}},{key:"outputKeys",get:function(){return this.combineDocumentChain.outputKeys}},{key:"_call",value:(n=c(u().mark((function t(e,r){var n,o,i,a,s,c,l,d,y,v=this;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.inputKey in e){t.next=2;break}throw new Error("Document key ".concat(this.inputKey," not found."));case 2:n=this.inputKey,o=e[n],i=h(e,[n].map(g)),a=o,s=[],c=u().mark((function t(){var e,n,o,c;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=a.map((function(t){return f(p({},v.documentVariableName,t.pageContent),i)})),0===l&&v.ensureMapStep){t.next=12;break}return t.next=5,v.combineDocumentChain.llmChain.prompt.format(v.combineDocumentChain._prepInputs(f(p({},v.combineDocumentChain.inputKey,a),i)));case 5:return n=t.sent,t.next=8,v.combineDocumentChain.llmChain._getNumTokens(n);case 8:if(!(t.sent<v.maxTokens)){t.next=12;break}return t.abrupt("return",1);case 12:return t.next=14,v.llmChain.apply(e,r?Array.from({length:e.length},(function(t,e){return r.getChild("map_".concat(e+1))})):void 0);case 14:o=t.sent,c=v.llmChain.outputKey,v.returnIntermediateSteps&&(s=s.concat(o.map((function(t){return t[c]})))),a=o.map((function(t){return{pageContent:t[c],metadata:{}}}));case 18:case"end":return t.stop()}}),t)})),l=0;case 7:if(!(l<this.maxIterations)){t.next=14;break}return t.delegateYield(c(),"t0",9);case 9:if(!t.t0){t.next=11;break}return t.abrupt("break",14);case 11:l+=1,t.next=7;break;case 14:return d=f(p({},this.combineDocumentChain.inputKey,a),i),t.next=17,this.combineDocumentChain.call(d,null==r?void 0:r.getChild("combine_documents"));case 17:if(y=t.sent,!this.returnIntermediateSteps){t.next=20;break}return t.abrupt("return",f(f({},y),{},{intermediateSteps:s}));case 20:return t.abrupt("return",y);case 21:case"end":return t.stop()}}),t,this)}))),function(t,e){return n.apply(this,arguments)})},{key:"_chainType",value:function(){return"map_reduce_documents_chain"}},{key:"serialize",value:function(){return{_type:this._chainType(),llm_chain:this.llmChain.serialize(),combine_document_chain:this.combineDocumentChain.serialize()}}}],[{key:"lc_name",value:function(){return"MapReduceDocumentsChain"}},{key:"deserialize",value:(r=c(u().mark((function t(r){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r.llm_chain){t.next=2;break}throw new Error("Missing llm_chain");case 2:if(r.combine_document_chain){t.next=4;break}throw new Error("Missing combine_document_chain");case 4:return t.t0=e,t.next=7,i.LLMChain.deserialize(r.llm_chain);case 7:return t.t1=t.sent,t.next=10,k.deserialize(r.combine_document_chain);case 10:return t.t2=t.sent,t.t3={llmChain:t.t1,combineDocumentChain:t.t2},t.abrupt("return",new t.t0(t.t3));case 13:case"end":return t.stop()}}),t)}))),function(t){return r.apply(this,arguments)})}]);var r,n}(o.r),S=function(t){function e(t){var r,n,o,i,a,u;return v(this,e),u=w(this,e,[t]),Object.defineProperty(u,"llmChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(u,"inputKey",{enumerable:!0,configurable:!0,writable:!0,value:"input_documents"}),Object.defineProperty(u,"outputKey",{enumerable:!0,configurable:!0,writable:!0,value:"output_text"}),Object.defineProperty(u,"documentVariableName",{enumerable:!0,configurable:!0,writable:!0,value:"context"}),Object.defineProperty(u,"initialResponseName",{enumerable:!0,configurable:!0,writable:!0,value:"existing_answer"}),Object.defineProperty(u,"refineLLMChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(u,"documentPrompt",{enumerable:!0,configurable:!0,writable:!0,value:u.defaultDocumentPrompt}),u.llmChain=t.llmChain,u.refineLLMChain=t.refineLLMChain,u.documentVariableName=null!==(r=t.documentVariableName)&&void 0!==r?r:u.documentVariableName,u.inputKey=null!==(n=t.inputKey)&&void 0!==n?n:u.inputKey,u.outputKey=null!==(o=t.outputKey)&&void 0!==o?o:u.outputKey,u.documentPrompt=null!==(i=t.documentPrompt)&&void 0!==i?i:u.documentPrompt,u.initialResponseName=null!==(a=t.initialResponseName)&&void 0!==a?a:u.initialResponseName,u}return E(e,t),b(e,[{key:"defaultDocumentPrompt",get:function(){return new n.Hh({inputVariables:["page_content"],template:"{page_content}"})}},{key:"inputKeys",get:function(){var t=this;return d(new Set([this.inputKey].concat(d(this.llmChain.inputKeys),d(this.refineLLMChain.inputKeys)))).filter((function(e){return e!==t.documentVariableName&&e!==t.initialResponseName}))}},{key:"outputKeys",get:function(){return[this.outputKey]}},{key:"_constructInitialInputs",value:(s=c(u().mark((function t(e,r){var n,o,i,a;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=f({page_content:e.pageContent},e.metadata),o={},this.documentPrompt.inputVariables.forEach((function(t){o[t]=n[t]})),t.t0=p,t.t1={},t.t2=this.documentVariableName,t.next=8,this.documentPrompt.format(f({},o));case 8:return t.t3=t.sent,i=(0,t.t0)(t.t1,t.t2,t.t3),a=f(f({},i),r),t.abrupt("return",a);case 12:case"end":return t.stop()}}),t,this)}))),function(t,e){return s.apply(this,arguments)})},{key:"_constructRefineInputs",value:(a=c(u().mark((function t(e,r){var n,o,i,a;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=f({page_content:e.pageContent},e.metadata),o={},this.documentPrompt.inputVariables.forEach((function(t){o[t]=n[t]})),t.t0=p,t.t1={},t.t2=this.documentVariableName,t.next=8,this.documentPrompt.format(f({},o));case 8:return t.t3=t.sent,i=(0,t.t0)(t.t1,t.t2,t.t3),a=f(p({},this.initialResponseName,r),i),t.abrupt("return",a);case 12:case"end":return t.stop()}}),t,this)}))),function(t,e){return a.apply(this,arguments)})},{key:"_call",value:(o=c(u().mark((function t(e,r){var n,o,i,a,s,c,l,d,y,v;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.inputKey in e){t.next=2;break}throw new Error("Document key ".concat(this.inputKey," not found."));case 2:return n=this.inputKey,o=e[n],i=h(e,[n].map(g)),a=o,t.next=6,this._constructInitialInputs(a[0],i);case 6:return s=t.sent,t.next=9,this.llmChain.predict(f({},s),null==r?void 0:r.getChild("answer"));case 9:c=t.sent,l=[c],d=1;case 12:if(!(d<a.length)){t.next=24;break}return t.next=15,this._constructRefineInputs(a[d],c);case 15:return y=t.sent,v=f(f({},y),i),t.next=19,this.refineLLMChain.predict(f({},v),null==r?void 0:r.getChild("refine"));case 19:c=t.sent,l.push(c);case 21:d+=1,t.next=12;break;case 24:return t.abrupt("return",p({},this.outputKey,c));case 25:case"end":return t.stop()}}),t,this)}))),function(t,e){return o.apply(this,arguments)})},{key:"_chainType",value:function(){return"refine_documents_chain"}},{key:"serialize",value:function(){return{_type:this._chainType(),llm_chain:this.llmChain.serialize(),refine_llm_chain:this.refineLLMChain.serialize()}}}],[{key:"lc_name",value:function(){return"RefineDocumentsChain"}},{key:"deserialize",value:(r=c(u().mark((function t(r){var n,o;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=r.llm_chain){t.next=3;break}throw new Error("Missing llm_chain");case 3:if(o=r.refine_llm_chain){t.next=6;break}throw new Error("Missing refine_llm_chain");case 6:return t.t0=e,t.next=9,i.LLMChain.deserialize(n);case 9:return t.t1=t.sent,t.next=12,i.LLMChain.deserialize(o);case 12:return t.t2=t.sent,t.t3={llmChain:t.t1,refineLLMChain:t.t2},t.abrupt("return",new t.t0(t.t3));case 15:case"end":return t.stop()}}),t)}))),function(t){return r.apply(this,arguments)})}]);var r,o,a,s}(o.r)},1931:(t,e,r)=>{"use strict";r.r(e),r.d(e,{LLMChain:()=>C});var n=r(5327),o=r(844),i=r(5744),a=r(2561);function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,c(n.key),n)}}function c(t){var e=function(t){if("object"!=u(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==u(e)?e:e+""}function l(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(l=function(){return!!t})()}function f(t){return f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},f(t)}function p(t,e){return p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},p(t,e)}var h=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t=function(t,e,r){return e=f(e),function(t,e){if(e&&("object"==u(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,l()?Reflect.construct(e,r||[],f(t).constructor):e.apply(t,r))}(this,e,arguments),Object.defineProperty(t,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","default"]}),Object.defineProperty(t,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&p(t,e)}(e,t),r=e,o=[{key:"lc_name",value:function(){return"NoOpOutputParser"}}],(n=[{key:"parse",value:function(t){return Promise.resolve(t)}},{key:"getFormatInstructions",value:function(){return""}}])&&s(r.prototype,n),o&&s(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(r(2743).mJ);function d(t){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d(t)}function y(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function v(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?y(Object(r),!0).forEach((function(e){m(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function m(t,e,r){return(e=O(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function b(){b=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof g?e:g,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:A(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",y="executing",v="completed",m={};function g(){}function w(){}function x(){}var _={};c(_,a,(function(){return this}));var E=Object.getPrototypeOf,O=E&&E(E(T([])));O&&O!==r&&n.call(O,a)&&(_=O);var k=x.prototype=g.prototype=Object.create(_);function j(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,u){var s=f(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==d(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function A(e,r,n){var o=p;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=D(u,n);if(s){if(s===m)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?v:h,c.arg===m)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=v,n.method="throw",n.arg=c.arg)}}}function D(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,D(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,m;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(d(e)+" is not iterable")}return w.prototype=x,o(k,"constructor",{value:x,configurable:!0}),o(x,"constructor",{value:w,configurable:!0}),w.displayName=c(x,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,c(t,s,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},j(S.prototype),c(S.prototype,u,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},j(k),c(k,s,"Generator"),c(k,a,(function(){return this})),c(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),C(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;C(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}function g(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function w(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){g(i,n,o,a,u,"next",t)}function u(t){g(i,n,o,a,u,"throw",t)}a(void 0)}))}}function x(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return _(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}function _(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function E(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,O(n.key),n)}}function O(t){var e=function(t){if("object"!=d(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=d(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==d(e)?e:e+""}function k(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(k=function(){return!!t})()}function j(t,e,r,n){var o=S(A(1&n?t.prototype:t),e,r);return 2&n&&"function"==typeof o?function(t){return o.apply(r,t)}:o}function S(){return S="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=A(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},S.apply(null,arguments)}function A(t){return A=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},A(t)}function D(t,e){return D=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},D(t,e)}function P(t){if(function(t){return"function"==typeof t._llmType}(t))return t;if("bound"in t&&i.YN.isRunnable(t.bound))return P(t.bound);if("runnable"in t&&"fallbacks"in t&&i.YN.isRunnable(t.runnable))return P(t.runnable);if("default"in t&&i.YN.isRunnable(t.default))return P(t.default);throw new Error("Unable to extract BaseLanguageModel from llmLike object.")}var C=function(t){function e(t){var r,n,o;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=function(t,e,r){return e=A(e),function(t,e){if(e&&("object"==d(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,k()?Reflect.construct(e,r||[],A(t).constructor):e.apply(t,r))}(this,e,[t]),Object.defineProperty(o,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(o,"prompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(o,"llm",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(o,"llmKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(o,"outputKey",{enumerable:!0,configurable:!0,writable:!0,value:"text"}),Object.defineProperty(o,"outputParser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),o.prompt=t.prompt,o.llm=t.llm,o.llmKwargs=t.llmKwargs,o.outputKey=null!==(r=t.outputKey)&&void 0!==r?r:o.outputKey,o.outputParser=null!==(n=t.outputParser)&&void 0!==n?n:new h,o.prompt.outputParser){if(t.outputParser)throw new Error("Cannot set both outputParser and prompt.outputParser");o.outputParser=o.prompt.outputParser}return o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&D(t,e)}(e,t),r=e,i=[{key:"inputKeys",get:function(){return this.prompt.inputVariables}},{key:"outputKeys",get:function(){return[this.outputKey]}},{key:"getCallKeys",value:function(){return"callKeys"in this.llm?this.llm.callKeys:[]}},{key:"_selectMemoryInputs",value:function(t){var r,n=j(e,"_selectMemoryInputs",this,3)([t]),o=x(this.getCallKeys());try{for(o.s();!(r=o.n()).done;){var i=r.value;i in t&&delete n[i]}}catch(t){o.e(t)}finally{o.f()}return n}},{key:"_getFinalOutput",value:(l=w(b().mark((function t(e,r,n){var o;return b().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.outputParser){t.next=6;break}return t.next=3,this.outputParser.parseResultWithPrompt(e,r,null==n?void 0:n.getChild());case 3:o=t.sent,t.next=7;break;case 6:o=e[0].text;case 7:return t.abrupt("return",o);case 8:case"end":return t.stop()}}),t,this)}))),function(t,e,r){return l.apply(this,arguments)})},{key:"call",value:function(t,r){return j(e,"call",this,3)([t,r])}},{key:"_call",value:(c=w(b().mark((function t(e,r){var n,o,i,a,u,s,c,l,f,p,h;return b().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=v({},e),o=v({},this.llmKwargs),i=this.getCallKeys(),a=x(i);try{for(a.s();!(u=a.n()).done;)(s=u.value)in e&&o&&(o[s]=e[s],delete n[s])}catch(t){a.e(t)}finally{a.f()}return t.next=7,this.prompt.formatPromptValue(n);case 7:if(c=t.sent,!("generatePrompt"in this.llm)){t.next=20;break}return t.next=11,this.llm.generatePrompt([c],o,null==r?void 0:r.getChild());case 11:return l=t.sent,f=l.generations,t.t0=m,t.t1={},t.t2=this.outputKey,t.next=18,this._getFinalOutput(f[0],c,r);case 18:return t.t3=t.sent,t.abrupt("return",(0,t.t0)(t.t1,t.t2,t.t3));case 20:return p=this.outputParser?this.llm.pipe(this.outputParser):this.llm,t.next=23,p.invoke(c,null==r?void 0:r.getChild());case 23:return h=t.sent,t.abrupt("return",m({},this.outputKey,h));case 25:case"end":return t.stop()}}),t,this)}))),function(t,e){return c.apply(this,arguments)})},{key:"predict",value:(s=w(b().mark((function t(e,r){var n;return b().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.call(e,r);case 2:return n=t.sent,t.abrupt("return",n[this.outputKey]);case 4:case"end":return t.stop()}}),t,this)}))),function(t,e){return s.apply(this,arguments)})},{key:"_chainType",value:function(){return"llm"}},{key:"serialize",value:function(){var t="serialize"in this.llm?this.llm.serialize():void 0;return{_type:"".concat(this._chainType(),"_chain"),llm:t,prompt:this.prompt.serialize()}}},{key:"_getNumTokens",value:function(t){return P(this.llm).getNumTokens(t)}}],a=[{key:"lc_name",value:function(){return"LLMChain"}},{key:"deserialize",value:(u=w(b().mark((function t(r){var i,a;return b().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=r.llm,a=r.prompt,i){t.next=3;break}throw new Error("LLMChain must have llm");case 3:if(a){t.next=5;break}throw new Error("LLMChain must have prompt");case 5:return t.t0=e,t.next=8,n.j_.deserialize(i);case 8:return t.t1=t.sent,t.next=11,o.m2.deserialize(a);case 11:return t.t2=t.sent,t.t3={llm:t.t1,prompt:t.t2},t.abrupt("return",new t.t0(t.t3));case 14:case"end":return t.stop()}}),t)}))),function(t){return u.apply(this,arguments)})}],i&&E(r.prototype,i),a&&E(r,a),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,i,a,u,s,c,l}(a.r)},8440:(t,e,r)=>{"use strict";r.r(e),r.d(e,{VectorDBQAChain:()=>N});var n=r(2561),o=r(1931),i=r(5119),a=r(844);function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function s(t,e){if(t){if("string"==typeof t)return c(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c(t,e):void 0}}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function l(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(l=function(){return!!t})()}function f(t){return f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},f(t)}function p(t,e){return p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},p(t,e)}function h(){h=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function f(t,e,r,n){var i=e&&e.prototype instanceof g?e:g,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:A(t,r,u)}),a}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=f;var d="suspendedStart",y="suspendedYield",v="executing",m="completed",b={};function g(){}function w(){}function x(){}var _={};l(_,a,(function(){return this}));var E=Object.getPrototypeOf,O=E&&E(E(T([])));O&&O!==r&&n.call(O,a)&&(_=O);var k=x.prototype=g.prototype=Object.create(_);function j(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,s){var c=p(t[o],t,i);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==u(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function A(e,r,n){var o=d;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=D(u,n);if(s){if(s===b)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var c=p(e,r,n);if("normal"===c.type){if(o=n.done?m:y,c.arg===b)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=m,n.method="throw",n.arg=c.arg)}}}function D(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,D(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;var i=p(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,b;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,b):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,b)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(u(e)+" is not iterable")}return w.prototype=x,o(k,"constructor",{value:x,configurable:!0}),o(x,"constructor",{value:w,configurable:!0}),w.displayName=l(x,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,l(t,c,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},j(S.prototype),l(S.prototype,s,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(f(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},j(k),l(k,c,"Generator"),l(k,a,(function(){return this})),l(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,b):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),C(r),b}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;C(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),b}},e}function d(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function y(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function v(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,b(n.key),n)}}function m(t,e,r){return e&&v(t.prototype,e),r&&v(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function b(t){var e=function(t){if("object"!=u(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==u(e)?e:e+""}r(4865);var g=function(t){function e(t){var r,n,o,i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return y(this,e),n=this,o=f(o=e),r=function(t,e){if(e&&("object"==u(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(n,l()?Reflect.construct(o,i||[],f(n).constructor):o.apply(n,i)),Object.defineProperty(r,"defaultPrompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(r,"conditionals",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),r.defaultPrompt=t,r.conditionals=a,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&p(t,e)}(e,t),m(e,[{key:"getPrompt",value:function(t){var e,r,n,o=function(t){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=s(t))){e&&(t=e);var r=0,n=function(){};return{s:n,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,a=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return i=t.done,t},e:function(t){a=!0,o=t},f:function(){try{i||null==e.return||e.return()}finally{if(a)throw o}}}}(this.conditionals);try{for(o.s();!(e=o.n()).done;){var i=(r=e.value,n=2,function(t){if(Array.isArray(t))return t}(r)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],s=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);s=!0);}catch(t){c=!0,o=t}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(r,n)||s(r,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),a=i[0],u=i[1];if(a(t))return u}}catch(t){o.e(t)}finally{o.f()}return this.defaultPrompt}}])}(function(){return m((function t(){y(this,t)}),[{key:"getPromptAsync",value:(t=h().mark((function t(e,r){var n,o;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=this.getPrompt(e),t.abrupt("return",o.partial(null!==(n=null==r?void 0:r.partialVariables)&&void 0!==n?n:{}));case 2:case"end":return t.stop()}}),t,this)})),e=function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){d(i,n,o,a,u,"next",t)}function u(t){d(i,n,o,a,u,"throw",t)}a(void 0)}))},function(t,r){return e.apply(this,arguments)})}]);var t,e}());var w=new a.Hh({template:"Use the following pieces of context to answer the question at the end. If you don't know the answer, just say that you don't know, don't try to make up an answer.\n\n{context}\n\nQuestion: {question}\nHelpful Answer:",inputVariables:["context","question"]}),x=[a.BJ.fromTemplate("Use the following pieces of context to answer the users question. \nIf you don't know the answer, just say that you don't know, don't try to make up an answer.\n----------------\n{context}"),a.FS.fromTemplate("{question}")],_=new g(w,[[function(t){return"base_chat_model"===t._modelType()},a.RZ.fromMessages(x)]]);function E(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.prompt,n=void 0===r?_.getPrompt(t):r,a=e.verbose,u=new o.LLMChain({prompt:n,llm:t,verbose:a});return new i.StuffDocumentsChain({llmChain:u,verbose:a})}function O(t){return O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},O(t)}function k(){k=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:A(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function b(){}function g(){}var w={};c(w,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(T([])));_&&_!==r&&n.call(_,a)&&(w=_);var E=g.prototype=m.prototype=Object.create(w);function j(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,u){var s=f(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==O(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function A(e,r,n){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=D(u,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?y:h,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=y,n.method="throw",n.arg=c.arg)}}}function D(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,D(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(O(e)+" is not iterable")}return b.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=c(g,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,c(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},j(S.prototype),c(S.prototype,u,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},j(E),c(E,s,"Generator"),c(E,a,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),C(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;C(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function j(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function S(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?j(Object(r),!0).forEach((function(e){A(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):j(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function A(t,e,r){return(e=L(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function D(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function P(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){D(i,n,o,a,u,"next",t)}function u(t){D(i,n,o,a,u,"throw",t)}a(void 0)}))}}function C(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,L(n.key),n)}}function L(t){var e=function(t){if("object"!=O(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=O(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==O(e)?e:e+""}function T(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(T=function(){return!!t})()}function F(t){return F=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},F(t)}function I(t,e){return I=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},I(t,e)}var N=function(t){function e(t){var r,n,o,i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),i=function(t,e,r){return e=F(e),function(t,e){if(e&&("object"==O(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,T()?Reflect.construct(e,r||[],F(t).constructor):e.apply(t,r))}(this,e,[t]),Object.defineProperty(i,"k",{enumerable:!0,configurable:!0,writable:!0,value:4}),Object.defineProperty(i,"inputKey",{enumerable:!0,configurable:!0,writable:!0,value:"query"}),Object.defineProperty(i,"vectorstore",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(i,"combineDocumentsChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(i,"returnSourceDocuments",{enumerable:!0,configurable:!0,writable:!0,value:!1}),i.vectorstore=t.vectorstore,i.combineDocumentsChain=t.combineDocumentsChain,i.inputKey=null!==(r=t.inputKey)&&void 0!==r?r:i.inputKey,i.k=null!==(n=t.k)&&void 0!==n?n:i.k,i.returnSourceDocuments=null!==(o=t.returnSourceDocuments)&&void 0!==o?o:i.returnSourceDocuments,i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&I(t,e)}(e,t),r=e,o=[{key:"inputKeys",get:function(){return[this.inputKey]}},{key:"outputKeys",get:function(){return this.combineDocumentsChain.outputKeys.concat(this.returnSourceDocuments?["sourceDocuments"]:[])}},{key:"_call",value:(u=P(k().mark((function t(e,r){var n,o,i,a;return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.inputKey in e){t.next=2;break}throw new Error("Question key ".concat(this.inputKey," not found."));case 2:return n=e[this.inputKey],t.next=5,this.vectorstore.similaritySearch(n,this.k,e.filter,null==r?void 0:r.getChild("vectorstore"));case 5:return o=t.sent,i={question:n,input_documents:o},t.next=9,this.combineDocumentsChain.call(i,null==r?void 0:r.getChild("combine_documents"));case 9:if(a=t.sent,!this.returnSourceDocuments){t.next=12;break}return t.abrupt("return",S(S({},a),{},{sourceDocuments:o}));case 12:return t.abrupt("return",a);case 13:case"end":return t.stop()}}),t,this)}))),function(t,e){return u.apply(this,arguments)})},{key:"_chainType",value:function(){return"vector_db_qa"}},{key:"serialize",value:function(){return{_type:this._chainType(),combine_documents_chain:this.combineDocumentsChain.serialize(),k:this.k}}}],i=[{key:"lc_name",value:function(){return"VectorDBQAChain"}},{key:"deserialize",value:(a=P(k().mark((function t(r,o){var i;return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("vectorstore"in o){t.next=2;break}throw new Error("Need to pass in a vectorstore to deserialize VectorDBQAChain");case 2:if(i=o.vectorstore,r.combine_documents_chain){t.next=5;break}throw new Error("VectorDBQAChain must have combine_documents_chain in serialized data");case 5:return t.t0=e,t.next=8,n.r.deserialize(r.combine_documents_chain);case 8:return t.t1=t.sent,t.t2=r.k,t.t3=i,t.t4={combineDocumentsChain:t.t1,k:t.t2,vectorstore:t.t3},t.abrupt("return",new t.t0(t.t4));case 13:case"end":return t.stop()}}),t)}))),function(t,e){return a.apply(this,arguments)})},{key:"fromLLM",value:function(t,e,r){return new this(S({vectorstore:e,combineDocumentsChain:E(t)},r))}}],o&&C(r.prototype,o),i&&C(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,o,i,a,u}(n.r)},7912:(t,e,r)=>{"use strict";r.d(e,{Kj:()=>jt});var n=r(6963),o=r(1461),i=r(4869),a=r(3180);function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function s(){s=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",l=i.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,r){return t[e]=r}}function p(t,e,r,n){var i=e&&e.prototype instanceof g?e:g,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:A(t,r,u)}),a}function h(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=p;var d="suspendedStart",y="suspendedYield",v="executing",m="completed",b={};function g(){}function w(){}function x(){}var _={};f(_,a,(function(){return this}));var E=Object.getPrototypeOf,O=E&&E(E(T([])));O&&O!==r&&n.call(O,a)&&(_=O);var k=x.prototype=g.prototype=Object.create(_);function j(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,s){var c=h(t[o],t,i);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==u(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(f).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function A(e,r,n){var o=d;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=D(u,n);if(s){if(s===b)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var c=h(e,r,n);if("normal"===c.type){if(o=n.done?m:y,c.arg===b)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=m,n.method="throw",n.arg=c.arg)}}}function D(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,D(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;var i=h(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,b;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,b):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,b)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(u(e)+" is not iterable")}return w.prototype=x,o(k,"constructor",{value:x,configurable:!0}),o(x,"constructor",{value:w,configurable:!0}),w.displayName=f(x,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,f(t,l,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},j(S.prototype),f(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(p(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},j(k),f(k,l,"Generator"),f(k,a,(function(){return this})),f(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,b):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),C(r),b}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;C(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),b}},e}function c(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function l(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,f(n.key),n)}}function f(t){var e=function(t){if("object"!=u(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==u(e)?e:e+""}var p=[400,401,403,404,405,406,407,408],h=[409],d=function(){return t=function t(e){var r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"onFailedResponseHook",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxConcurrency=null!==(r=e.maxConcurrency)&&void 0!==r?r:1/0,this.maxRetries=null!==(n=e.maxRetries)&&void 0!==n?n:6,this.queue=new i.default({concurrency:this.maxConcurrency}),this.onFailedResponseHook=null==e?void 0:e.onFailedResponseHook},e=[{key:"call",value:function(t){for(var e=this,r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];var a=this.onFailedResponseHook;return this.queue.add((function(){return o((function(){return t.apply(void 0,n).catch((function(t){throw t instanceof Error?t:new Error(t)}))}),{onFailedAttempt:function(t){return(e=s().mark((function e(){var r,n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.message.startsWith("Cancel")||t.message.startsWith("TimeoutError")||t.message.startsWith("AbortError"))){e.next=2;break}throw t;case 2:if("ECONNABORTED"!==(null==t?void 0:t.code)){e.next=4;break}throw t;case 4:if(r=null==t?void 0:t.response,!(n=null==r?void 0:r.status)){e.next=16;break}if(!p.includes(+n)){e.next=11;break}throw t;case 11:if(!h.includes(+n)){e.next=13;break}return e.abrupt("return");case 13:if(!a){e.next=16;break}return e.next=16,a(r);case 16:case"end":return e.stop()}}),e)})),function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(t){c(i,n,o,a,u,"next",t)}function u(t){c(i,n,o,a,u,"throw",t)}a(void 0)}))})();var e},retries:e.maxRetries,randomize:!0})}),{throwOnTimeout:!0})}},{key:"callWithOptions",value:function(t,e){for(var r=arguments.length,n=new Array(r>2?r-2:0),o=2;o<r;o++)n[o-2]=arguments[o];return t.signal?Promise.race([this.call.apply(this,[e].concat(n)),new Promise((function(e,r){var n;null===(n=t.signal)||void 0===n||n.addEventListener("abort",(function(){r(new Error("AbortError"))}))}))]):this.call.apply(this,[e].concat(n))}},{key:"fetch",value:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return this.call((function(){return(0,a.Y)().apply(void 0,e).then((function(t){return t.ok?t:Promise.reject(t)}))}))}}],e&&l(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function y(t){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},y(t)}function v(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function m(t,e,r){return(e=function(t){var e=function(t){if("object"!=y(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=y(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==y(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function b(t){return"function"==typeof(null==t?void 0:t._getType)}function g(t){var e={type:t._getType(),data:{content:t.content}};return null!=t&&t.additional_kwargs&&Object.keys(t.additional_kwargs).length>0&&(e.data.additional_kwargs=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?v(Object(r),!0).forEach((function(e){m(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},t.additional_kwargs)),e}var w=r(5704),x=r(4797),_=r(7622);function E(t,e){if(!_.A(t)){var r=void 0!==e?"Invalid UUID for ".concat(e,": ").concat(t):"Invalid UUID: ".concat(t);throw new Error(r)}return t}var O=r(6991),k=r(3961);function j(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],s=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);s=!0);}catch(t){c=!0,o=t}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(t,e)||function(t,e){if(t){if("string"==typeof t)return S(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?S(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function A(t,e){var r=(0,k.parse)(t),n=(0,k.parse)(e);if(!r||!n)throw new Error("Invalid version format.");return r.compare(n)>=0}function D(t){if(!t||t.split("/").length>2||t.startsWith("/")||t.endsWith("/")||t.split(":").length>2)throw new Error("Invalid identifier format: ".concat(t));var e=j(t.split(":"),2),r=e[0],n=e[1]||"latest";if(r.includes("/")){var o=j(r.split("/",2),2),i=o[0],a=o[1];if(!i||!a)throw new Error("Invalid identifier format: ".concat(t));return[i,a,n]}if(!r)throw new Error("Invalid identifier format: ".concat(t));return["-",r,n]}function P(){P=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new C(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function b(){}function g(){}var w={};c(w,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(L([])));_&&_!==r&&n.call(_,a)&&(w=_);var E=g.prototype=m.prototype=Object.create(w);function O(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,i,a,u){var s=f(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==N(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=S(u,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?y:h,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=y,n.method="throw",n.arg=c.arg)}}}function S(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,S(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function L(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(N(e)+" is not iterable")}return b.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=c(g,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,c(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},O(k.prototype),c(k.prototype,u,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(E),c(E,s,"Generator"),c(E,a,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=L,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),D(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;D(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:L(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function C(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function L(t){var e="function"==typeof Map?new Map:void 0;return L=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(e){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return function(t,e,r){if(T())return Reflect.construct.apply(null,arguments);var n=[null];n.push.apply(n,e);var o=new(t.bind.apply(t,n));return r&&F(o,r.prototype),o}(t,arguments,I(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),F(r,t)},L(t)}function T(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(T=function(){return!!t})()}function F(t,e){return F=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},F(t,e)}function I(t){return I=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},I(t)}function N(t){return N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},N(t)}var R=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),(r=function(t,e,r){return e=I(e),function(t,e){if(e&&("object"==N(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,T()?Reflect.construct(e,r||[],I(t).constructor):e.apply(t,r))}(this,e,[t])).name="LangSmithConflictError",r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&F(t,e)}(e,t),r=e,Object.defineProperty(r,"prototype",{writable:!1}),r;var r}(L(Error));function M(t,e,r){return B.apply(this,arguments)}function B(){var t;return t=P().mark((function t(e,r,n){var o,i;return P().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.ok){t.next=6;break}if(!n){t.next=5;break}return t.next=4,e.text();case 4:o=t.sent;case 5:return t.abrupt("return");case 6:return t.next=8,e.text();case 8:if(o=t.sent,i="Failed to ".concat(r,". Received status [").concat(e.status,"]: ").concat(e.statusText,". Server response: ").concat(o),409!==e.status){t.next=12;break}throw new R(i);case 12:throw new Error(i);case 13:case"end":return t.stop()}}),t)})),B=function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){C(i,n,o,a,u,"next",t)}function u(t){C(i,n,o,a,u,"throw",t)}a(void 0)}))},B.apply(this,arguments)}function G(t){return G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},G(t)}var U="[...]",z={result:"[Circular]"},$=[],q=[];function K(t,e,r,n){try{return JSON.stringify(t,e,r)}catch(u){var o,i;if(null===(o=u.message)||void 0===o||!o.includes("Converting circular structure to JSON"))return console.warn("[WARNING]: LangSmith received unserializable value."),"[Unserializable]";console.warn("[WARNING]: LangSmith received circular JSON. This will decrease tracer performance."),void 0===n&&(n={depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}),Z(t,"",0,[],void 0,0,n);try{i=0===q.length?JSON.stringify(t,e,r):JSON.stringify(t,function(t){return t=void 0!==t?t:function(t,e){return e},function(e,r){if(q.length>0)for(var n=0;n<q.length;n++){var o=q[n];if(o[1]===e&&o[0]===r){r=o[2],q.splice(n,1);break}}return t.call(this,e,r)}}(e),r)}catch(t){return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;0!==$.length;){var a=$.pop();4===a.length?Object.defineProperty(a[0],a[1],a[3]):a[0][a[1]]=a[2]}}return i}}function H(t,e,r,n){var o=Object.getOwnPropertyDescriptor(n,r);void 0!==o.get?o.configurable?(Object.defineProperty(n,r,{value:t}),$.push([n,r,e,o])):q.push([e,r,t]):(n[r]=t,$.push([n,r,e]))}function Z(t,e,r,n,o,i,a){var u;if(i+=1,"object"===G(t)&&null!==t){for(u=0;u<n.length;u++)if(n[u]===t)return void H(z,t,e,o);if(void 0!==a.depthLimit&&i>a.depthLimit)return void H(U,t,e,o);if(void 0!==a.edgesLimit&&r+1>a.edgesLimit)return void H(U,t,e,o);if(n.push(t),Array.isArray(t))for(u=0;u<t.length;u++)Z(t[u],u,u,n,t,i,a);else{var s=Object.keys(t);for(u=0;u<s.length;u++){var c=s[u];Z(t[c],c,u,n,t,i,a)}}n.pop()}}var Y=["inputs","outputs","events"],V=["datasetId","datasetName"];function W(t){return W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},W(t)}function J(t){return function(t){if(Array.isArray(t))return rt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||et(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function X(t,e){if(null==t)return{};var r,n,o=function(t,e){if(null==t)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.includes(n))continue;r[n]=t[n]}return r}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.includes(r)||{}.propertyIsEnumerable.call(t,r)&&(o[r]=t[r])}return o}function Q(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],s=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);s=!0);}catch(t){c=!0,o=t}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(t,e)||et(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function tt(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=et(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}function et(t,e){if(t){if("string"==typeof t)return rt(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?rt(t,e):void 0}}function rt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function nt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ot(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,pt(n.key),n)}}function it(t,e,r){return e&&ot(t.prototype,e),r&&ot(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function at(){at=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new P(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function b(){}function g(){}var w={};c(w,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(w=_);var E=g.prototype=m.prototype=Object.create(w);function O(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,i,a,u){var s=f(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==W(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=S(u,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?y:h,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=y,n.method="throw",n.arg=c.arg)}}}function S(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,S(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function C(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(W(e)+" is not iterable")}return b.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=c(g,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,c(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},O(k.prototype),c(k.prototype,u,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(E),c(E,s,"Generator"),c(E,a,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=C,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),D(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;D(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:C(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function ut(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function st(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){ut(i,n,o,a,u,"next",t)}function u(t){ut(i,n,o,a,u,"throw",t)}a(void 0)}))}}function ct(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function lt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ct(Object(r),!0).forEach((function(e){ft(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ct(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function ft(t,e,r){return(e=pt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pt(t){var e=function(t){if("object"!=W(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=W(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==W(e)?e:e+""}function ht(t){var e={},r=!1;function n(e,n){return r=!0,n=new Promise((function(r){r(t[e](n))})),{done:!1,value:new mt(n,1)}}return e["undefined"!=typeof Symbol&&Symbol.iterator||"@@iterator"]=function(){return this},e.next=function(t){return r?(r=!1,t):n("next",t)},"function"==typeof t.throw&&(e.throw=function(t){if(r)throw r=!1,t;return n("throw",t)}),"function"==typeof t.return&&(e.return=function(t){return r?(r=!1,t):n("return",t)}),e}function dt(t){return new mt(t,0)}function yt(t){return function(){return new vt(t.apply(this,arguments))}}function vt(t){var e,r;function n(e,r){try{var i=t[e](r),a=i.value,u=a instanceof mt;Promise.resolve(u?a.v:a).then((function(r){if(u){var s="return"===e?"return":"next";if(!a.k||r.done)return n(s,r);r=t[s](r).value}o(i.done?"return":"normal",r)}),(function(t){n("throw",t)}))}catch(t){o("throw",t)}}function o(t,o){switch(t){case"return":e.resolve({value:o,done:!0});break;case"throw":e.reject(o);break;default:e.resolve({value:o,done:!1})}(e=e.next)?n(e.key,e.arg):r=null}this._invoke=function(t,o){return new Promise((function(i,a){var u={key:t,arg:o,resolve:i,reject:a,next:null};r?r=r.next=u:(e=r=u,n(t,o))}))},"function"!=typeof t.return&&(this.return=void 0)}function mt(t,e){this.v=t,this.k=e}function bt(t){var e,r,n,o=2;for("undefined"!=typeof Symbol&&(r=Symbol.asyncIterator,n=Symbol.iterator);o--;){if(r&&null!=(e=t[r]))return e.call(t);if(n&&null!=(e=t[n]))return new gt(e.call(t));r="@@asyncIterator",n="@@iterator"}throw new TypeError("Object is not async iterable")}function gt(t){function e(t){if(Object(t)!==t)return Promise.reject(new TypeError(t+" is not an object."));var e=t.done;return Promise.resolve(t.value).then((function(t){return{value:t,done:e}}))}return gt=function(t){this.s=t,this.n=t.next},gt.prototype={s:null,n:null,next:function(){return e(this.n.apply(this.s,arguments))},return:function(t){var r=this.s.return;return void 0===r?Promise.resolve({value:t,done:!0}):e(r.apply(this.s,arguments))},throw:function(t){var r=this.s.return;return void 0===r?Promise.reject(t):e(r.apply(this.s,arguments))}},new gt(t)}function wt(t){var e,r,n=(0,w.Ec)(),o=(0,w.yk)(),i=null!==(e=t.extra)&&void 0!==e?e:{},a=i.metadata;return t.extra=lt(lt({},i),{},{runtime:lt(lt({},n),null==i?void 0:i.runtime),metadata:lt(lt(lt({},o),o.revision_id||t.revision_id?{revision_id:null!==(r=t.revision_id)&&void 0!==r?r:o.revision_id}:{}),a)}),t}function xt(t){return _t.apply(this,arguments)}function _t(){return(_t=st(at().mark((function t(e){var r,n,o,i,a,u,s;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=[],n=!1,o=!1,t.prev=3,a=bt(e);case 5:return t.next=7,a.next();case 7:if(!(n=!(u=t.sent).done)){t.next=13;break}s=u.value,r.push(s);case 10:n=!1,t.next=5;break;case 13:t.next=19;break;case 15:t.prev=15,t.t0=t.catch(3),o=!0,i=t.t0;case 19:if(t.prev=19,t.prev=20,!n||null==a.return){t.next=24;break}return t.next=24,a.return();case 24:if(t.prev=24,!o){t.next=27;break}throw i;case 27:return t.finish(24);case 28:return t.finish(19);case 29:return t.abrupt("return",r);case 30:case"end":return t.stop()}}),t,null,[[3,15,19,29],[20,,24,28]])})))).apply(this,arguments)}function Et(t){if(void 0!==t)return t.trim().replace(/^"(.*)"$/,"$1").replace(/^'(.*)'$/,"$1")}vt.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},vt.prototype.next=function(t){return this._invoke("next",t)},vt.prototype.throw=function(t){return this._invoke("throw",t)},vt.prototype.return=function(t){return this._invoke("return",t)};var Ot=function(){var t=st(at().mark((function t(e){var r,n;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(429!==(null==e?void 0:e.status)){t.next=6;break}if(!((n=1e3*parseInt(null!==(r=e.headers.get("retry-after"))&&void 0!==r?r:"30",10))>0)){t.next=6;break}return t.next=5,new Promise((function(t){return setTimeout(t,n)}));case 5:return t.abrupt("return",!0);case 6:return t.abrupt("return",!1);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),kt=function(){return it((function t(){nt(this,t),Object.defineProperty(this,"items",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"sizeBytes",{enumerable:!0,configurable:!0,writable:!0,value:0})}),[{key:"peek",value:function(){return this.items[0]}},{key:"push",value:function(t){var e,r=new Promise((function(t){e=t})),n=K(t.item).length;return this.items.push({action:t.action,payload:t.item,itemPromiseResolve:e,itemPromise:r,size:n}),this.sizeBytes+=n,r}},{key:"pop",value:function(t){if(t<1)throw new Error("Number of bytes to pop off may not be less than 1.");for(var e=[],r=0;r+(null!==(n=null===(o=this.peek())||void 0===o?void 0:o.size)&&void 0!==n?n:0)<t&&this.items.length>0;){var n,o,i=this.items.shift();i&&(e.push(i),r+=i.size,this.sizeBytes-=i.size)}if(0===e.length&&this.items.length>0){var a=this.items.shift();e.push(a),r+=a.size,this.sizeBytes-=a.size}return[e.map((function(t){return{action:t.action,item:t.payload}})),function(){return e.forEach((function(t){return t.itemPromiseResolve()}))}]}}])}(),jt=function(){function t(){var e,r,n,o,i,a,u,s,c,l,f,p,h,y,v=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};nt(this,t),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"webUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"batchIngestCaller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout_ms",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tenantId",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"hideInputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"hideOutputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tracingSampleRate",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"filteredPostUuids",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"autoBatchTracing",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"autoBatchQueue",{enumerable:!0,configurable:!0,writable:!0,value:new kt}),Object.defineProperty(this,"autoBatchTimeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"autoBatchInitialDelayMs",{enumerable:!0,configurable:!0,writable:!0,value:250}),Object.defineProperty(this,"autoBatchAggregationDelayMs",{enumerable:!0,configurable:!0,writable:!0,value:50}),Object.defineProperty(this,"batchSizeBytesLimit",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fetchOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"settings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"blockOnRootRunFinalization",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"_serverInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_getServerInfoPromise",{enumerable:!0,configurable:!0,writable:!0,value:void 0});var m=t.getDefaultClientConfig();this.tracingSampleRate=function(){var t=(0,w.Jz)("TRACING_SAMPLING_RATE");if(void 0!==t){var e=parseFloat(t);if(e<0||e>1)throw new Error("LANGSMITH_TRACING_SAMPLING_RATE must be between 0 and 1 if set. Got: ".concat(e));return e}}(),this.apiUrl=null!==(e=Et(null!==(r=v.apiUrl)&&void 0!==r?r:m.apiUrl))&&void 0!==e?e:"",this.apiUrl.endsWith("/")&&(this.apiUrl=this.apiUrl.slice(0,-1)),this.apiKey=Et(null!==(n=v.apiKey)&&void 0!==n?n:m.apiKey),this.webUrl=Et(null!==(o=v.webUrl)&&void 0!==o?o:m.webUrl),null!==(i=this.webUrl)&&void 0!==i&&i.endsWith("/")&&(this.webUrl=this.webUrl.slice(0,-1)),this.timeout_ms=null!==(a=v.timeout_ms)&&void 0!==a?a:12e3,this.caller=new d(null!==(u=v.callerOptions)&&void 0!==u?u:{}),this.batchIngestCaller=new d(lt(lt({},null!==(s=v.callerOptions)&&void 0!==s?s:{}),{},{onFailedResponseHook:Ot})),this.hideInputs=null!==(c=null!==(l=v.hideInputs)&&void 0!==l?l:v.anonymizer)&&void 0!==c?c:m.hideInputs,this.hideOutputs=null!==(f=null!==(p=v.hideOutputs)&&void 0!==p?p:v.anonymizer)&&void 0!==f?f:m.hideOutputs,this.autoBatchTracing=null!==(h=v.autoBatchTracing)&&void 0!==h?h:this.autoBatchTracing,this.blockOnRootRunFinalization=null!==(y=v.blockOnRootRunFinalization)&&void 0!==y?y:this.blockOnRootRunFinalization,this.batchSizeBytesLimit=v.batchSizeBytesLimit,this.fetchOptions=v.fetchOptions||{}}return it(t,[{key:"getHostUrl",value:function(){return this.webUrl?this.webUrl:"localhost"===(t=this.apiUrl.replace("http://","").replace("https://","").split("/")[0].split(":")[0])||"127.0.0.1"===t||"::1"===t?(this.webUrl="http://localhost:3000",this.webUrl):this.apiUrl.includes("/api")&&!this.apiUrl.split(".",1)[0].endsWith("api")?(this.webUrl=this.apiUrl.replace("/api",""),this.webUrl):this.apiUrl.split(".",1)[0].includes("dev")?(this.webUrl="https://dev.smith.langchain.com",this.webUrl):this.apiUrl.split(".",1)[0].includes("eu")?(this.webUrl="https://eu.smith.langchain.com",this.webUrl):(this.webUrl="https://smith.langchain.com",this.webUrl);var t}},{key:"headers",get:function(){var t={"User-Agent":"langsmith-js/".concat(x.Ls)};return this.apiKey&&(t["x-api-key"]="".concat(this.apiKey)),t}},{key:"processInputs",value:function(t){return!1===this.hideInputs?t:!0===this.hideInputs?{}:"function"==typeof this.hideInputs?this.hideInputs(t):t}},{key:"processOutputs",value:function(t){return!1===this.hideOutputs?t:!0===this.hideOutputs?{}:"function"==typeof this.hideOutputs?this.hideOutputs(t):t}},{key:"prepareRunCreateOrUpdateInputs",value:function(t){var e=lt({},t);return void 0!==e.inputs&&(e.inputs=this.processInputs(e.inputs)),void 0!==e.outputs&&(e.outputs=this.processOutputs(e.outputs)),e}},{key:"_getResponse",value:(he=st(at().mark((function t(e,r){var n,o,i,u;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=null!==(n=null==r?void 0:r.toString())&&void 0!==n?n:"",i="".concat(this.apiUrl).concat(e,"?").concat(o),t.next=4,this.caller.call((0,a.Y)(),i,lt({method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 4:return u=t.sent,t.next=7,M(u,"Failed to fetch ".concat(e));case 7:return t.abrupt("return",u);case 8:case"end":return t.stop()}}),t,this)}))),function(t,e){return he.apply(this,arguments)})},{key:"_get",value:(pe=st(at().mark((function t(e,r){var n;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._getResponse(e,r);case 2:return n=t.sent,t.abrupt("return",n.json());case 4:case"end":return t.stop()}}),t,this)}))),function(t,e){return pe.apply(this,arguments)})},{key:"_getPaginated",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new URLSearchParams,n=arguments.length>2?arguments[2]:void 0;return yt(at().mark((function o(){var i,u,s,c,l;return at().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:i=Number(r.get("offset"))||0,u=Number(r.get("limit"))||100;case 2:return r.set("offset",String(i)),r.set("limit",String(u)),s="".concat(e.apiUrl).concat(t,"?").concat(r),o.next=8,dt(e.caller.call((0,a.Y)(),s,lt({method:"GET",headers:e.headers,signal:AbortSignal.timeout(e.timeout_ms)},e.fetchOptions)));case 8:return c=o.sent,o.next=11,dt(M(c,"Failed to fetch ".concat(t)));case 11:if(!n){o.next=19;break}return o.t1=n,o.next=15,dt(c.json());case 15:o.t2=o.sent,o.t0=(0,o.t1)(o.t2),o.next=22;break;case 19:return o.next=21,dt(c.json());case 21:o.t0=o.sent;case 22:if(0!==(l=o.t0).length){o.next=25;break}return o.abrupt("break",32);case 25:return o.next=27,l;case 27:if(!(l.length<u)){o.next=29;break}return o.abrupt("break",32);case 29:i+=l.length,o.next=2;break;case 32:case"end":return o.stop()}}),o)})))()}},{key:"_getCursorPaginatedList",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"POST",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"runs";return yt(at().mark((function i(){var u,s,c,l;return at().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:u=r?lt({},r):{};case 1:return i.next=4,dt(e.caller.call((0,a.Y)(),"".concat(e.apiUrl).concat(t),lt(lt({method:n,headers:lt(lt({},e.headers),{},{"Content-Type":"application/json"}),signal:AbortSignal.timeout(e.timeout_ms)},e.fetchOptions),{},{body:JSON.stringify(u)})));case 4:return s=i.sent,i.next=7,dt(s.json());case 7:if(c=i.sent){i.next=10;break}return i.abrupt("break",22);case 10:if(c[o]){i.next=12;break}return i.abrupt("break",22);case 12:return i.next=14,c[o];case 14:if(l=c.cursors){i.next=17;break}return i.abrupt("break",22);case 17:if(l.next){i.next=19;break}return i.abrupt("break",22);case 19:u.cursor=l.next,i.next=1;break;case 22:case"end":return i.stop()}}),i)})))()}},{key:"_filterForSampling",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(void 0===this.tracingSampleRate)return t;if(e){var r,n=[],o=tt(t);try{for(o.s();!(r=o.n()).done;){var i=r.value;this.filteredPostUuids.has(i.id)?this.filteredPostUuids.delete(i.id):n.push(i)}}catch(t){o.e(t)}finally{o.f()}return n}var a,u=[],s=tt(t);try{for(s.s();!(a=s.n()).done;){var c=a.value;c.id!==c.trace_id&&!this.filteredPostUuids.has(c.trace_id)||Math.random()<this.tracingSampleRate?u.push(c):this.filteredPostUuids.add(c.id)}}catch(t){s.e(t)}finally{s.f()}return u}},{key:"_getBatchSizeLimitBytes",value:(fe=st(at().mark((function t(){var e,r,n,o;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._ensureServerInfo();case 2:return o=t.sent,t.abrupt("return",null!==(e=null!==(r=this.batchSizeBytesLimit)&&void 0!==r?r:null===(n=o.batch_ingest_config)||void 0===n?void 0:n.size_limit_bytes)&&void 0!==e?e:20971520);case 4:case"end":return t.stop()}}),t,this)}))),function(){return fe.apply(this,arguments)})},{key:"drainAutoBatchQueue",value:(le=st(at().mark((function t(){var e,r,n,o,i,a,u;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(this.autoBatchQueue.items.length>=0)){t.next=29;break}return t.t0=this.autoBatchQueue,t.next=4,this._getBatchSizeLimitBytes();case 4:if(t.t1=t.sent,e=t.t0.pop.call(t.t0,t.t1),r=Q(e,2),n=r[0],o=r[1],n.length){t.next=12;break}return o(),t.abrupt("return");case 12:return t.prev=12,a={runCreates:n.filter((function(t){return"create"===t.action})).map((function(t){return t.item})),runUpdates:n.filter((function(t){return"update"===t.action})).map((function(t){return t.item}))},t.next=16,this._ensureServerInfo();case 16:if(null==(u=t.sent)||null===(i=u.batch_ingest_config)||void 0===i||!i.use_multipart_endpoint){t.next=22;break}return t.next=20,this.multipartIngestRuns(a);case 20:t.next=24;break;case 22:return t.next=24,this.batchIngestRuns(a);case 24:return t.prev=24,o(),t.finish(24);case 27:t.next=0;break;case 29:case"end":return t.stop()}}),t,this,[[12,,24,27]])}))),function(){return le.apply(this,arguments)})},{key:"processRunOperation",value:(ce=st(at().mark((function t(e,r){var n,o,i,a=this;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.autoBatchTimeout,clearTimeout(this.autoBatchTimeout),this.autoBatchTimeout=void 0,"create"===e.action&&(e.item=wt(e.item)),o=this.autoBatchQueue.push(e),t.next=7,this._getBatchSizeLimitBytes();case 7:if(i=t.sent,!(r||this.autoBatchQueue.sizeBytes>i)){t.next=11;break}return t.next=11,this.drainAutoBatchQueue().catch(console.error);case 11:return this.autoBatchQueue.items.length>0&&(this.autoBatchTimeout=setTimeout((function(){a.autoBatchTimeout=void 0,a.drainAutoBatchQueue().catch(console.error)}),n?this.autoBatchAggregationDelayMs:this.autoBatchInitialDelayMs)),t.abrupt("return",o);case 13:case"end":return t.stop()}}),t,this)}))),function(t,e){return ce.apply(this,arguments)})},{key:"_getServerInfo",value:(se=st(at().mark((function t(){var e;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,a.Y)()("".concat(this.apiUrl,"/info"),lt({method:"GET",headers:{Accept:"application/json"},signal:AbortSignal.timeout(1e3)},this.fetchOptions));case 2:return e=t.sent,t.next=5,M(e,"get server info");case 5:return t.abrupt("return",e.json());case 6:case"end":return t.stop()}}),t,this)}))),function(){return se.apply(this,arguments)})},{key:"_ensureServerInfo",value:(ue=st(at().mark((function t(){var e=this;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===this._getServerInfoPromise&&(this._getServerInfoPromise=st(at().mark((function t(){var r;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0!==e._serverInfo){t.next=10;break}return t.prev=1,t.next=4,e._getServerInfo();case 4:e._serverInfo=t.sent,t.next=10;break;case 7:t.prev=7,t.t0=t.catch(1),console.warn("[WARNING]: LangSmith failed to fetch info on supported operations. Falling back to single calls and default limits.");case 10:return t.abrupt("return",null!==(r=e._serverInfo)&&void 0!==r?r:{});case 11:case"end":return t.stop()}}),t,null,[[1,7]])})))()),t.abrupt("return",this._getServerInfoPromise.then((function(t){return void 0===e._serverInfo&&(e._getServerInfoPromise=void 0),t})));case 2:case"end":return t.stop()}}),t,this)}))),function(){return ue.apply(this,arguments)})},{key:"_getSettings",value:(ae=st(at().mark((function t(){return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.settings||(this.settings=this._get("/settings")),t.next=3,this.settings;case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t,this)}))),function(){return ae.apply(this,arguments)})},{key:"createRun",value:(ie=st(at().mark((function t(e){var r,n,o,i,u,s;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._filterForSampling([e]).length){t.next=2;break}return t.abrupt("return");case 2:if(n=lt(lt({},this.headers),{},{"Content-Type":"application/json"}),o=e.project_name,delete e.project_name,i=this.prepareRunCreateOrUpdateInputs(lt(lt({session_name:o},e),{},{start_time:null!==(r=e.start_time)&&void 0!==r?r:Date.now()})),!this.autoBatchTracing||void 0===i.trace_id||void 0===i.dotted_order){t.next=9;break}return this.processRunOperation({action:"create",item:i}).catch(console.error),t.abrupt("return");case 9:return u=wt(i),t.next=12,this.caller.call((0,a.Y)(),"".concat(this.apiUrl,"/runs"),lt({method:"POST",headers:n,body:K(u),signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 12:return s=t.sent,t.next=15,M(s,"create run",!0);case 15:case"end":return t.stop()}}),t,this)}))),function(t){return ie.apply(this,arguments)})},{key:"batchIngestRuns",value:(oe=st(at().mark((function t(e){var r,n,o,i,a,u,s,c,l,f,p,h,d,y,v,m,b,g,w,x,_,E,O,k,j=this;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=e.runCreates,i=e.runUpdates,void 0!==o||void 0!==i){t.next=3;break}return t.abrupt("return");case 3:if(a=null!==(r=null==o?void 0:o.map((function(t){return j.prepareRunCreateOrUpdateInputs(t)})))&&void 0!==r?r:[],u=null!==(n=null==i?void 0:i.map((function(t){return j.prepareRunCreateOrUpdateInputs(t)})))&&void 0!==n?n:[],a.length>0&&u.length>0){s=a.reduce((function(t,e){return e.id?(t[e.id]=e,t):t}),{}),c=[],l=tt(u);try{for(l.s();!(f=l.n()).done;)void 0!==(p=f.value).id&&s[p.id]?s[p.id]=lt(lt({},s[p.id]),p):c.push(p)}catch(t){l.e(t)}finally{l.f()}a=Object.values(s),u=c}if((h={post:this._filterForSampling(a),patch:this._filterForSampling(u,!0)}).post.length||h.patch.length){t.next=9;break}return t.abrupt("return");case 9:return t.next=11,this._ensureServerInfo();case 11:if(void 0!==t.sent.version){t.next=50;break}this.autoBatchTracing=!1,d=tt(h.post),t.prev=15,d.s();case 17:if((y=d.n()).done){t.next=23;break}return v=y.value,t.next=21,this.createRun(v);case 21:t.next=17;break;case 23:t.next=28;break;case 25:t.prev=25,t.t0=t.catch(15),d.e(t.t0);case 28:return t.prev=28,d.f(),t.finish(28);case 31:m=tt(h.patch),t.prev=32,m.s();case 34:if((b=m.n()).done){t.next=41;break}if(void 0===(g=b.value).id){t.next=39;break}return t.next=39,this.updateRun(g.id,g);case 39:t.next=34;break;case 41:t.next=46;break;case 43:t.prev=43,t.t1=t.catch(32),m.e(t.t1);case 46:return t.prev=46,m.f(),t.finish(46);case 49:return t.abrupt("return");case 50:for(w={post:[],patch:[]},x=0,_=["post","patch"];x<_.length;x++)for(O=h[E=_[x]].reverse(),k=O.pop();void 0!==k;)w[E].push(k),k=O.pop();if(!(w.post.length>0||w.patch.length>0)){t.next=55;break}return t.next=55,this._postBatchIngestRuns(K(w));case 55:case"end":return t.stop()}}),t,this,[[15,25,28,31],[32,43,46,49]])}))),function(t){return oe.apply(this,arguments)})},{key:"_postBatchIngestRuns",value:(ne=st(at().mark((function t(e){var r,n;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=lt(lt({},this.headers),{},{"Content-Type":"application/json",Accept:"application/json"}),t.next=3,this.batchIngestCaller.call((0,a.Y)(),"".concat(this.apiUrl,"/runs/batch"),lt({method:"POST",headers:r,body:e,signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 3:return n=t.sent,t.next=6,M(n,"batch create run",!0);case 6:case"end":return t.stop()}}),t,this)}))),function(t){return ne.apply(this,arguments)})},{key:"multipartIngestRuns",value:(re=st(at().mark((function t(e){var r,n,o,i,a,u,s,c,l,f,p,h,d,y,v,m,b,g,w,x,_,E,O,k,j,S,A,D,P,C,L,T,F,I,N,R,M,B,G,U,z,$,q,H,Z,V,W;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.runCreates,n=e.runUpdates,void 0!==r||void 0!==n){t.next=3;break}return t.abrupt("return");case 3:o={},i=[],a=tt(null!=r?r:[]);try{for(a.s();!(u=a.n()).done;)s=u.value,void 0!==(c=this.prepareRunCreateOrUpdateInputs(s)).id&&void 0!==c.attachments&&(o[c.id]=c.attachments),delete c.attachments,i.push(c)}catch(t){a.e(t)}finally{a.f()}l=[],f=tt(null!=n?n:[]);try{for(f.s();!(p=f.n()).done;)h=p.value,l.push(this.prepareRunCreateOrUpdateInputs(h))}catch(t){f.e(t)}finally{f.f()}if(void 0===i.find((function(t){return void 0===t.trace_id||void 0===t.dotted_order}))){t.next=13;break}throw new Error('Multipart ingest requires "trace_id" and "dotted_order" to be set when creating a run');case 13:if(void 0===l.find((function(t){return void 0===t.trace_id||void 0===t.dotted_order}))){t.next=16;break}throw new Error('Multipart ingest requires "trace_id" and "dotted_order" to be set when updating a run');case 16:if(i.length>0&&l.length>0){d=i.reduce((function(t,e){return e.id?(t[e.id]=e,t):t}),{}),y=[],v=tt(l);try{for(v.s();!(m=v.n()).done;)void 0!==(b=m.value).id&&d[b.id]?d[b.id]=lt(lt({},d[b.id]),b):y.push(b)}catch(t){v.e(t)}finally{v.f()}i=Object.values(d),l=y}if(0!==i.length||0!==l.length){t.next=19;break}return t.abrupt("return");case 19:g=[],w=[],x=0,_=[["post",i],["patch",l]];case 22:if(!(x<_.length)){t.next=58;break}E=Q(_[x],2),O=E[0],k=E[1],j=tt(k),t.prev=25,j.s();case 27:if((S=j.n()).done){t.next=47;break}A=S.value,D=A.inputs,P=A.outputs,C=A.events,L=X(A,Y),T={inputs:D,outputs:P,events:C},F=K(L),w.push({name:"".concat(O,".").concat(L.id),payload:new Blob([F],{type:"application/json; length=".concat(F.length)})}),I=0,N=Object.entries(T);case 34:if(!(I<N.length)){t.next=43;break}if(R=Q(N[I],2),M=R[0],void 0!==(B=R[1])){t.next=38;break}return t.abrupt("continue",40);case 38:G=K(B),w.push({name:"".concat(O,".").concat(L.id,".").concat(M),payload:new Blob([G],{type:"application/json; length=".concat(G.length)})});case 40:I++,t.next=34;break;case 43:if(void 0!==L.id&&(U=o[L.id]))for(delete o[L.id],z=0,$=Object.entries(U);z<$.length;z++)q=Q($[z],2),H=q[0],Z=Q(q[1],2),V=Z[0],W=Z[1],w.push({name:"attachment.".concat(L.id,".").concat(H),payload:new Blob([W],{type:"".concat(V,"; length=").concat(W.length)})});g.push("trace=".concat(L.trace_id,",id=").concat(L.id));case 45:t.next=27;break;case 47:t.next=52;break;case 49:t.prev=49,t.t0=t.catch(25),j.e(t.t0);case 52:return t.prev=52,j.f(),t.finish(52);case 55:x++,t.next=22;break;case 58:return t.next=60,this._sendMultipartRequest(w,g.join("; "));case 60:case"end":return t.stop()}}),t,this,[[25,49,52,55]])}))),function(t){return re.apply(this,arguments)})},{key:"_sendMultipartRequest",value:(ee=st(at().mark((function t(e,r){var n,o,i,u,s;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0,n=new FormData,o=tt(e);try{for(o.s();!(i=o.n()).done;)u=i.value,n.append(u.name,u.payload)}catch(t){o.e(t)}finally{o.f()}return t.next=6,this.batchIngestCaller.call((0,a.Y)(),"".concat(this.apiUrl,"/runs/multipart"),lt({method:"POST",headers:lt({},this.headers),body:n,signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 6:t.next=13;break;case 8:t.prev=8,t.t0=t.catch(0),s="Failed to multipart ingest runs",t.t0 instanceof Error?s+=": ".concat(t.t0.stack||t.t0.message):s+=": ".concat(String(t.t0)),console.warn("".concat(s.trim(),"\n\nContext: ").concat(r));case 13:case"end":return t.stop()}}),t,this,[[0,8]])}))),function(t,e){return ee.apply(this,arguments)})},{key:"updateRun",value:(te=st(at().mark((function t(e,r){var n,o,i;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(E(e),r.inputs&&(r.inputs=this.processInputs(r.inputs)),r.outputs&&(r.outputs=this.processOutputs(r.outputs)),n=lt(lt({},r),{},{id:e}),this._filterForSampling([n],!0).length){t.next=6;break}return t.abrupt("return");case 6:if(!this.autoBatchTracing||void 0===n.trace_id||void 0===n.dotted_order){t.next=15;break}if(void 0===r.end_time||void 0!==n.parent_run_id||!this.blockOnRootRunFinalization){t.next=13;break}return t.next=10,this.processRunOperation({action:"update",item:n},!0);case 10:return t.abrupt("return");case 13:this.processRunOperation({action:"update",item:n}).catch(console.error);case 14:return t.abrupt("return");case 15:return o=lt(lt({},this.headers),{},{"Content-Type":"application/json"}),t.next=18,this.caller.call((0,a.Y)(),"".concat(this.apiUrl,"/runs/").concat(e),lt({method:"PATCH",headers:o,body:K(r),signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 18:return i=t.sent,t.next=21,M(i,"update run",!0);case 21:case"end":return t.stop()}}),t,this)}))),function(t,e){return te.apply(this,arguments)})},{key:"readRun",value:(Qt=st(at().mark((function t(e){var r,n,o=arguments;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=(o.length>1&&void 0!==o[1]?o[1]:{loadChildRuns:!1}).loadChildRuns,E(e),t.next=4,this._get("/runs/".concat(e));case 4:if(n=t.sent,!r||!n.child_run_ids){t.next=9;break}return t.next=8,this._loadChildRuns(n);case 8:n=t.sent;case 9:return t.abrupt("return",n);case 10:case"end":return t.stop()}}),t,this)}))),function(t){return Qt.apply(this,arguments)})},{key:"getRunUrl",value:(Xt=st(at().mark((function t(e){var r,n,o,i,a,u,s,c;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.runId,n=e.run,o=e.projectOpts,void 0===n){t.next=26;break}if(!n.session_id){t.next=6;break}i=n.session_id,t.next=20;break;case 6:if(null==o||!o.projectName){t.next=12;break}return t.next=9,this.readProject({projectName:null==o?void 0:o.projectName});case 9:i=t.sent.id,t.next=20;break;case 12:if(null==o||!o.projectId){t.next=16;break}i=null==o?void 0:o.projectId,t.next=20;break;case 16:return t.next=18,this.readProject({projectName:(0,w.Jz)("PROJECT")||"default"});case 18:a=t.sent,i=a.id;case 20:return t.next=22,this._getTenantId();case 22:return u=t.sent,t.abrupt("return","".concat(this.getHostUrl(),"/o/").concat(u,"/projects/p/").concat(i,"/r/").concat(n.id,"?poll=true"));case 26:if(void 0===r){t.next=36;break}return t.next=29,this.readRun(r);case 29:if((s=t.sent).app_path){t.next=32;break}throw new Error("Run ".concat(r," has no app_path"));case 32:return c=this.getHostUrl(),t.abrupt("return","".concat(c).concat(s.app_path));case 36:throw new Error("Must provide either runId or run");case 37:case"end":return t.stop()}}),t,this)}))),function(t){return Xt.apply(this,arguments)})},{key:"_loadChildRuns",value:(Jt=st(at().mark((function t(e){var r,n,o,i,a,u,s;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,xt(this.listRuns({id:e.child_run_ids}));case 2:r=t.sent,n={},o={},r.sort((function(t,e){var r,n;return(null!==(r=null==t?void 0:t.dotted_order)&&void 0!==r?r:"").localeCompare(null!==(n=null==e?void 0:e.dotted_order)&&void 0!==n?n:"")})),i=tt(r),t.prev=7,i.s();case 9:if((a=i.n()).done){t.next=18;break}if(null!==(u=a.value).parent_run_id&&void 0!==u.parent_run_id){t.next=13;break}throw new Error("Child run ".concat(u.id," has no parent"));case 13:u.parent_run_id in n||(n[u.parent_run_id]=[]),n[u.parent_run_id].push(u),o[u.id]=u;case 16:t.next=9;break;case 18:t.next=23;break;case 20:t.prev=20,t.t0=t.catch(7),i.e(t.t0);case 23:return t.prev=23,i.f(),t.finish(23);case 26:for(s in e.child_runs=n[e.id]||[],n)s!==e.id&&(o[s].child_runs=n[s]);return t.abrupt("return",e);case 29:case"end":return t.stop()}}),t,this,[[7,20,23,26]])}))),function(t){return Jt.apply(this,arguments)})},{key:"listRuns",value:function(t){var e=this;return yt(at().mark((function r(){var n,o,i,a,u,s,c,l,f,p,h,d,y,v,m,b,g,w,x,_,E,O,k,j,S,A,D,P,C,L,T;return at().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=t.projectId,o=t.projectName,i=t.parentRunId,a=t.traceId,u=t.referenceExampleId,s=t.startTime,c=t.executionOrder,l=t.isRoot,f=t.runType,p=t.error,h=t.id,d=t.query,y=t.filter,v=t.traceFilter,m=t.treeFilter,b=t.limit,g=t.select,w=[],n&&(w=Array.isArray(n)?n:[n]),!o){r.next=9;break}return _=Array.isArray(o)?o:[o],r.next=7,dt(Promise.all(_.map((function(t){return e.readProject({projectName:t}).then((function(t){return t.id}))}))));case 7:E=r.sent,(x=w).push.apply(x,J(E));case 9:O=["app_path","child_run_ids","completion_cost","completion_tokens","dotted_order","end_time","error","events","extra","feedback_stats","first_token_time","id","inputs","name","outputs","parent_run_id","parent_run_ids","prompt_cost","prompt_tokens","reference_example_id","run_type","session_id","start_time","status","tags","total_cost","total_tokens","trace_id"],k={session:w.length?w:null,run_type:f,reference_example:u,query:d,filter:y,trace_filter:v,tree_filter:m,execution_order:c,parent_run:i,start_time:s?s.toISOString():null,error:p,id:h,limit:b,trace:a,select:g||O,is_root:l},j=0,S=!1,A=!1,r.prev=14,P=bt(e._getCursorPaginatedList("/runs/query",k));case 16:return r.next=18,dt(P.next());case 18:if(!(S=!(C=r.sent).done)){r.next=35;break}if(L=C.value,!b){r.next=31;break}if(!(j>=b)){r.next=23;break}return r.abrupt("break",35);case 23:if(!(L.length+j>b)){r.next=27;break}return T=L.slice(0,b-j),r.delegateYield(ht(bt(T)),"t0",26);case 26:return r.abrupt("break",35);case 27:return j+=L.length,r.delegateYield(ht(bt(L)),"t1",29);case 29:r.next=32;break;case 31:return r.delegateYield(ht(bt(L)),"t2",32);case 32:S=!1,r.next=16;break;case 35:r.next=41;break;case 37:r.prev=37,r.t3=r.catch(14),A=!0,D=r.t3;case 41:if(r.prev=41,r.prev=42,!S||null==P.return){r.next=46;break}return r.next=46,dt(P.return());case 46:if(r.prev=46,!A){r.next=49;break}throw D;case 49:return r.finish(46);case 50:return r.finish(41);case 51:case"end":return r.stop()}}),r,null,[[14,37,41,51],[42,,46,50]])})))()}},{key:"getRunStats",value:(Wt=st(at().mark((function t(e){var r,n,o,i,u,s,c,l,f,p,h,d,y,v,m,b,g,w,x,_,E,O=this;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.id,n=e.trace,o=e.parentRun,i=e.runType,u=e.projectNames,s=e.projectIds,c=e.referenceExampleIds,l=e.startTime,f=e.endTime,p=e.error,h=e.query,d=e.filter,y=e.traceFilter,v=e.treeFilter,m=e.isRoot,b=e.dataSourceType,g=s||[],!u){t.next=11;break}return t.t0=[],t.t1=J(s||[]),t.t2=J,t.next=8,Promise.all(u.map((function(t){return O.readProject({projectName:t}).then((function(t){return t.id}))})));case 8:t.t3=t.sent,t.t4=(0,t.t2)(t.t3),g=t.t0.concat.call(t.t0,t.t1,t.t4);case 11:return w={id:r,trace:n,parent_run:o,run_type:i,session:g,reference_example:c,start_time:l,end_time:f,error:p,query:h,filter:d,trace_filter:y,tree_filter:v,is_root:m,data_source_type:b},x=Object.fromEntries(Object.entries(w).filter((function(t){var e=Q(t,2);return e[0],void 0!==e[1]}))),t.next=15,this.caller.call((0,a.Y)(),"".concat(this.apiUrl,"/runs/stats"),lt({method:"POST",headers:this.headers,body:JSON.stringify(x),signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 15:return _=t.sent,t.next=18,_.json();case 18:return E=t.sent,t.abrupt("return",E);case 20:case"end":return t.stop()}}),t,this)}))),function(t){return Wt.apply(this,arguments)})},{key:"shareRun",value:(Vt=st(at().mark((function t(e){var r,o,i,u,s=arguments;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=(s.length>1&&void 0!==s[1]?s[1]:{}).shareId,o={run_id:e,share_token:r||n.A()},E(e),t.next=5,this.caller.call((0,a.Y)(),"".concat(this.apiUrl,"/runs/").concat(e,"/share"),lt({method:"PUT",headers:this.headers,body:JSON.stringify(o),signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 5:return i=t.sent,t.next=8,i.json();case 8:if(null!==(u=t.sent)&&"share_token"in u){t.next=11;break}throw new Error("Invalid response from server");case 11:return t.abrupt("return","".concat(this.getHostUrl(),"/public/").concat(u.share_token,"/r"));case 12:case"end":return t.stop()}}),t,this)}))),function(t){return Vt.apply(this,arguments)})},{key:"unshareRun",value:(Yt=st(at().mark((function t(e){var r;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return E(e),t.next=3,this.caller.call((0,a.Y)(),"".concat(this.apiUrl,"/runs/").concat(e,"/share"),lt({method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 3:return r=t.sent,t.next=6,M(r,"unshare run",!0);case 6:case"end":return t.stop()}}),t,this)}))),function(t){return Yt.apply(this,arguments)})},{key:"readRunSharedLink",value:(Zt=st(at().mark((function t(e){var r,n;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return E(e),t.next=3,this.caller.call((0,a.Y)(),"".concat(this.apiUrl,"/runs/").concat(e,"/share"),lt({method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 3:return r=t.sent,t.next=6,r.json();case 6:if(null!==(n=t.sent)&&"share_token"in n){t.next=9;break}return t.abrupt("return",void 0);case 9:return t.abrupt("return","".concat(this.getHostUrl(),"/public/").concat(n.share_token,"/r"));case 10:case"end":return t.stop()}}),t,this)}))),function(t){return Zt.apply(this,arguments)})},{key:"listSharedRuns",value:(Ht=st(at().mark((function t(e){var r,n,o,i,u,s,c,l=arguments;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=(l.length>1&&void 0!==l[1]?l[1]:{}).runIds,n=new URLSearchParams({share_token:e}),void 0!==r){o=tt(r);try{for(o.s();!(i=o.n()).done;)u=i.value,n.append("id",u)}catch(t){o.e(t)}finally{o.f()}}return E(e),t.next=6,this.caller.call((0,a.Y)(),"".concat(this.apiUrl,"/public/").concat(e,"/runs").concat(n),lt({method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 6:return s=t.sent,t.next=9,s.json();case 9:return c=t.sent,t.abrupt("return",c);case 11:case"end":return t.stop()}}),t,this)}))),function(t){return Ht.apply(this,arguments)})},{key:"readDatasetSharedSchema",value:(Kt=st(at().mark((function t(e,r){var n,o,i;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e||r){t.next=2;break}throw new Error("Either datasetId or datasetName must be given");case 2:if(e){t.next=7;break}return t.next=5,this.readDataset({datasetName:r});case 5:n=t.sent,e=n.id;case 7:return E(e),t.next=10,this.caller.call((0,a.Y)(),"".concat(this.apiUrl,"/datasets/").concat(e,"/share"),lt({method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 10:return o=t.sent,t.next=13,o.json();case 13:return(i=t.sent).url="".concat(this.getHostUrl(),"/public/").concat(i.share_token,"/d"),t.abrupt("return",i);case 16:case"end":return t.stop()}}),t,this)}))),function(t,e){return Kt.apply(this,arguments)})},{key:"shareDataset",value:(qt=st(at().mark((function t(e,r){var n,o,i,u;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e||r){t.next=2;break}throw new Error("Either datasetId or datasetName must be given");case 2:if(e){t.next=7;break}return t.next=5,this.readDataset({datasetName:r});case 5:n=t.sent,e=n.id;case 7:return o={dataset_id:e},E(e),t.next=11,this.caller.call((0,a.Y)(),"".concat(this.apiUrl,"/datasets/").concat(e,"/share"),lt({method:"PUT",headers:this.headers,body:JSON.stringify(o),signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 11:return i=t.sent,t.next=14,i.json();case 14:return(u=t.sent).url="".concat(this.getHostUrl(),"/public/").concat(u.share_token,"/d"),t.abrupt("return",u);case 17:case"end":return t.stop()}}),t,this)}))),function(t,e){return qt.apply(this,arguments)})},{key:"unshareDataset",value:($t=st(at().mark((function t(e){var r;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return E(e),t.next=3,this.caller.call((0,a.Y)(),"".concat(this.apiUrl,"/datasets/").concat(e,"/share"),lt({method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 3:return r=t.sent,t.next=6,M(r,"unshare dataset",!0);case 6:case"end":return t.stop()}}),t,this)}))),function(t){return $t.apply(this,arguments)})},{key:"readSharedDataset",value:(zt=st(at().mark((function t(e){var r,n;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return E(e),t.next=3,this.caller.call((0,a.Y)(),"".concat(this.apiUrl,"/public/").concat(e,"/datasets"),lt({method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 3:return r=t.sent,t.next=6,r.json();case 6:return n=t.sent,t.abrupt("return",n);case 8:case"end":return t.stop()}}),t,this)}))),function(t){return zt.apply(this,arguments)})},{key:"listSharedExamples",value:(Ut=st(at().mark((function t(e,r){var n,o,i,u,s=this;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={},null!=r&&r.exampleIds&&(n.id=r.exampleIds),o=new URLSearchParams,Object.entries(n).forEach((function(t){var e=Q(t,2),r=e[0],n=e[1];Array.isArray(n)?n.forEach((function(t){return o.append(r,t)})):o.append(r,n)})),t.next=6,this.caller.call((0,a.Y)(),"".concat(this.apiUrl,"/public/").concat(e,"/examples?").concat(o.toString()),lt({method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 6:return i=t.sent,t.next=9,i.json();case 9:if(u=t.sent,i.ok){t.next=14;break}if(!("detail"in u)){t.next=13;break}throw new Error("Failed to list shared examples.\nStatus: ".concat(i.status,"\nMessage: ").concat(u.detail.join("\n")));case 13:throw new Error("Failed to list shared examples: ".concat(i.status," ").concat(i.statusText));case 14:return t.abrupt("return",u.map((function(t){return lt(lt({},t),{},{_hostUrl:s.getHostUrl()})})));case 15:case"end":return t.stop()}}),t,this)}))),function(t,e){return Ut.apply(this,arguments)})},{key:"createProject",value:(Gt=st(at().mark((function t(e){var r,n,o,i,u,s,c,l,f,p,h,d,y,v,m,b,g;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.projectName,n=e.description,o=void 0===n?null:n,i=e.metadata,u=void 0===i?null:i,s=e.upsert,c=void 0!==s&&s,l=e.projectExtra,f=void 0===l?null:l,p=e.referenceDatasetId,h=void 0===p?null:p,d=c?"?upsert=true":"",y="".concat(this.apiUrl,"/sessions").concat(d),v=f||{},u&&(v.metadata=u),m={name:r,extra:v,description:o},null!==h&&(m.reference_dataset_id=h),t.next=9,this.caller.call((0,a.Y)(),y,lt({method:"POST",headers:lt(lt({},this.headers),{},{"Content-Type":"application/json"}),body:JSON.stringify(m),signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 9:return b=t.sent,t.next=12,M(b,"create project");case 12:return t.next=14,b.json();case 14:return g=t.sent,t.abrupt("return",g);case 16:case"end":return t.stop()}}),t,this)}))),function(t){return Gt.apply(this,arguments)})},{key:"updateProject",value:(Bt=st(at().mark((function t(e,r){var n,o,i,u,s,c,l,f,p,h,d,y,v,m,b;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=r.name,o=void 0===n?null:n,i=r.description,u=void 0===i?null:i,s=r.metadata,c=void 0===s?null:s,l=r.projectExtra,f=void 0===l?null:l,p=r.endTime,h=void 0===p?null:p,d="".concat(this.apiUrl,"/sessions/").concat(e),y=f,c&&(y=lt(lt({},y||{}),{},{metadata:c})),v={name:o,extra:y,description:u,end_time:h?new Date(h).toISOString():null},t.next=7,this.caller.call((0,a.Y)(),d,lt({method:"PATCH",headers:lt(lt({},this.headers),{},{"Content-Type":"application/json"}),body:JSON.stringify(v),signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 7:return m=t.sent,t.next=10,M(m,"update project");case 10:return t.next=12,m.json();case 12:return b=t.sent,t.abrupt("return",b);case 14:case"end":return t.stop()}}),t,this)}))),function(t,e){return Bt.apply(this,arguments)})},{key:"hasProject",value:(Mt=st(at().mark((function t(e){var r,n,o,i,u,s;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.projectId,n=e.projectName,o="/sessions",i=new URLSearchParams,void 0===r||void 0===n){t.next=7;break}throw new Error("Must provide either projectName or projectId, not both");case 7:if(void 0===r){t.next=12;break}E(r),o+="/".concat(r),t.next=17;break;case 12:if(void 0===n){t.next=16;break}i.append("name",n),t.next=17;break;case 16:throw new Error("Must provide projectName or projectId");case 17:return t.next=19,this.caller.call((0,a.Y)(),"".concat(this.apiUrl).concat(o,"?").concat(i),lt({method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 19:return u=t.sent,t.prev=20,t.next=23,u.json();case 23:if(s=t.sent,u.ok){t.next=26;break}return t.abrupt("return",!1);case 26:if(!Array.isArray(s)){t.next=28;break}return t.abrupt("return",s.length>0);case 28:return t.abrupt("return",!0);case 31:return t.prev=31,t.t0=t.catch(20),t.abrupt("return",!1);case 34:case"end":return t.stop()}}),t,this,[[20,31]])}))),function(t){return Mt.apply(this,arguments)})},{key:"readProject",value:(Rt=st(at().mark((function t(e){var r,n,o,i,a,u,s;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.projectId,n=e.projectName,o=e.includeStats,i="/sessions",a=new URLSearchParams,void 0===r||void 0===n){t.next=7;break}throw new Error("Must provide either projectName or projectId, not both");case 7:if(void 0===r){t.next=12;break}E(r),i+="/".concat(r),t.next=17;break;case 12:if(void 0===n){t.next=16;break}a.append("name",n),t.next=17;break;case 16:throw new Error("Must provide projectName or projectId");case 17:return void 0!==o&&a.append("include_stats",o.toString()),t.next=20,this._get(i,a);case 20:if(u=t.sent,!Array.isArray(u)){t.next=27;break}if(0!==u.length){t.next=24;break}throw new Error("Project[id=".concat(r,", name=").concat(n,"] not found"));case 24:s=u[0],t.next=28;break;case 27:s=u;case 28:return t.abrupt("return",s);case 29:case"end":return t.stop()}}),t,this)}))),function(t){return Rt.apply(this,arguments)})},{key:"getProjectUrl",value:(Nt=st(at().mark((function t(e){var r,n,o,i;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.projectId,n=e.projectName,void 0!==r||void 0!==n){t.next=3;break}throw new Error("Must provide either projectName or projectId");case 3:return t.next=5,this.readProject({projectId:r,projectName:n});case 5:return o=t.sent,t.next=8,this._getTenantId();case 8:return i=t.sent,t.abrupt("return","".concat(this.getHostUrl(),"/o/").concat(i,"/projects/p/").concat(o.id));case 10:case"end":return t.stop()}}),t,this)}))),function(t){return Nt.apply(this,arguments)})},{key:"getDatasetUrl",value:(It=st(at().mark((function t(e){var r,n,o,i;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.datasetId,n=e.datasetName,void 0!==r||void 0!==n){t.next=3;break}throw new Error("Must provide either datasetName or datasetId");case 3:return t.next=5,this.readDataset({datasetId:r,datasetName:n});case 5:return o=t.sent,t.next=8,this._getTenantId();case 8:return i=t.sent,t.abrupt("return","".concat(this.getHostUrl(),"/o/").concat(i,"/datasets/").concat(o.id));case 10:case"end":return t.stop()}}),t,this)}))),function(t){return It.apply(this,arguments)})},{key:"_getTenantId",value:(Ft=st(at().mark((function t(){var e,r,n,o,i,a,u;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null===this._tenantId){t.next=2;break}return t.abrupt("return",this._tenantId);case 2:e=new URLSearchParams({limit:"1"}),r=!1,n=!1,t.prev=5,i=bt(this._getPaginated("/sessions",e));case 7:return t.next=9,i.next();case 9:if(!(r=!(a=t.sent).done)){t.next=16;break}return u=a.value,this._tenantId=u[0].tenant_id,t.abrupt("return",u[0].tenant_id);case 13:r=!1,t.next=7;break;case 16:t.next=22;break;case 18:t.prev=18,t.t0=t.catch(5),n=!0,o=t.t0;case 22:if(t.prev=22,t.prev=23,!r||null==i.return){t.next=27;break}return t.next=27,i.return();case 27:if(t.prev=27,!n){t.next=30;break}throw o;case 30:return t.finish(27);case 31:return t.finish(22);case 32:throw new Error("No projects found to resolve tenant.");case 33:case"end":return t.stop()}}),t,this,[[5,18,22,32],[23,,27,31]])}))),function(){return Ft.apply(this,arguments)})},{key:"listProjects",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.projectIds,n=e.name,o=e.nameContains,i=e.referenceDatasetId,a=e.referenceDatasetName,u=e.referenceFree,s=e.metadata;return yt(at().mark((function e(){var c,l,f,p,h,d,y,v,m,b,g;return at().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=new URLSearchParams,void 0!==r){l=tt(r);try{for(l.s();!(f=l.n()).done;)p=f.value,c.append("id",p)}catch(t){l.e(t)}finally{l.f()}}if(void 0!==n&&c.append("name",n),void 0!==o&&c.append("name_contains",o),void 0===i){e.next=8;break}c.append("reference_dataset",i),e.next=13;break;case 8:if(void 0===a){e.next=13;break}return e.next=11,dt(t.readDataset({datasetName:a}));case 11:h=e.sent,c.append("reference_dataset",h.id);case 13:void 0!==u&&c.append("reference_free",u.toString()),void 0!==s&&c.append("metadata",JSON.stringify(s)),d=!1,y=!1,e.prev=17,m=bt(t._getPaginated("/sessions",c));case 19:return e.next=21,dt(m.next());case 21:if(!(d=!(b=e.sent).done)){e.next=27;break}return g=b.value,e.delegateYield(ht(bt(g)),"t0",24);case 24:d=!1,e.next=19;break;case 27:e.next=33;break;case 29:e.prev=29,e.t1=e.catch(17),y=!0,v=e.t1;case 33:if(e.prev=33,e.prev=34,!d||null==m.return){e.next=38;break}return e.next=38,dt(m.return());case 38:if(e.prev=38,!y){e.next=41;break}throw v;case 41:return e.finish(38);case 42:return e.finish(33);case 43:case"end":return e.stop()}}),e,null,[[17,29,33,43],[34,,38,42]])})))()}},{key:"deleteProject",value:(Tt=st(at().mark((function t(e){var r,n,o,i;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.projectId,n=e.projectName,void 0!==r||void 0!==n){t.next=5;break}throw new Error("Must provide projectName or projectId");case 5:if(void 0===r||void 0===n){t.next=9;break}throw new Error("Must provide either projectName or projectId, not both");case 9:if(void 0!==r){t.next=15;break}return t.next=12,this.readProject({projectName:n});case 12:o=t.sent.id,t.next=16;break;case 15:o=r;case 16:return E(o),t.next=19,this.caller.call((0,a.Y)(),"".concat(this.apiUrl,"/sessions/").concat(o),lt({method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 19:return i=t.sent,t.next=22,M(i,"delete session ".concat(o," (").concat(n,")"),!0);case 22:case"end":return t.stop()}}),t,this)}))),function(t){return Tt.apply(this,arguments)})},{key:"uploadCsv",value:(Lt=st(at().mark((function t(e){var r,n,o,i,u,s,c,l,f,p,h;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.csvFile,n=e.fileName,o=e.inputKeys,i=e.outputKeys,u=e.description,s=e.dataType,c=e.name,l="".concat(this.apiUrl,"/datasets/upload"),(f=new FormData).append("file",r,n),o.forEach((function(t){f.append("input_keys",t)})),i.forEach((function(t){f.append("output_keys",t)})),u&&f.append("description",u),s&&f.append("data_type",s),c&&f.append("name",c),t.next=11,this.caller.call((0,a.Y)(),l,lt({method:"POST",headers:this.headers,body:f,signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 11:return p=t.sent,t.next=14,M(p,"upload CSV");case 14:return t.next=16,p.json();case 16:return h=t.sent,t.abrupt("return",h);case 18:case"end":return t.stop()}}),t,this)}))),function(t){return Lt.apply(this,arguments)})},{key:"createDataset",value:(Ct=st(at().mark((function t(e){var r,n,o,i,u,s,c,l,f,p=arguments;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=(r=p.length>1&&void 0!==p[1]?p[1]:{}).description,o=r.dataType,i=r.inputsSchema,u=r.outputsSchema,s=r.metadata,c={name:e,description:n,extra:s?{metadata:s}:void 0},o&&(c.data_type=o),i&&(c.inputs_schema_definition=i),u&&(c.outputs_schema_definition=u),t.next=7,this.caller.call((0,a.Y)(),"".concat(this.apiUrl,"/datasets"),lt({method:"POST",headers:lt(lt({},this.headers),{},{"Content-Type":"application/json"}),body:JSON.stringify(c),signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 7:return l=t.sent,t.next=10,M(l,"create dataset");case 10:return t.next=12,l.json();case 12:return f=t.sent,t.abrupt("return",f);case 14:case"end":return t.stop()}}),t,this)}))),function(t){return Ct.apply(this,arguments)})},{key:"readDataset",value:(Pt=st(at().mark((function t(e){var r,n,o,i,a,u;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.datasetId,n=e.datasetName,o="/datasets",i=new URLSearchParams({limit:"1"}),void 0===r||void 0===n){t.next=7;break}throw new Error("Must provide either datasetName or datasetId, not both");case 7:if(void 0===r){t.next=12;break}E(r),o+="/".concat(r),t.next=17;break;case 12:if(void 0===n){t.next=16;break}i.append("name",n),t.next=17;break;case 16:throw new Error("Must provide datasetName or datasetId");case 17:return t.next=19,this._get(o,i);case 19:if(a=t.sent,!Array.isArray(a)){t.next=26;break}if(0!==a.length){t.next=23;break}throw new Error("Dataset[id=".concat(r,", name=").concat(n,"] not found"));case 23:u=a[0],t.next=27;break;case 26:u=a;case 27:return t.abrupt("return",u);case 28:case"end":return t.stop()}}),t,this)}))),function(t){return Pt.apply(this,arguments)})},{key:"hasDataset",value:(Dt=st(at().mark((function t(e){var r,n;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.datasetId,n=e.datasetName,t.prev=1,t.next=4,this.readDataset({datasetId:r,datasetName:n});case 4:return t.abrupt("return",!0);case 7:if(t.prev=7,t.t0=t.catch(1),!(t.t0 instanceof Error&&t.t0.message.toLocaleLowerCase().includes("not found"))){t.next=11;break}return t.abrupt("return",!1);case 11:throw t.t0;case 12:case"end":return t.stop()}}),t,this,[[1,7]])}))),function(t){return Dt.apply(this,arguments)})},{key:"diffDatasetVersions",value:(At=st(at().mark((function t(e){var r,n,o,i,a,u,s,c;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.datasetId,n=e.datasetName,o=e.fromVersion,i=e.toVersion,void 0!==(a=r)||void 0!==n){t.next=6;break}throw new Error("Must provide either datasetName or datasetId");case 6:if(void 0===a||void 0===n){t.next=10;break}throw new Error("Must provide either datasetName or datasetId, not both");case 10:if(void 0!==a){t.next=15;break}return t.next=13,this.readDataset({datasetName:n});case 13:u=t.sent,a=u.id;case 15:return s=new URLSearchParams({from_version:"string"==typeof o?o:o.toISOString(),to_version:"string"==typeof i?i:i.toISOString()}),t.next=18,this._get("/datasets/".concat(a,"/versions/diff"),s);case 18:return c=t.sent,t.abrupt("return",c);case 20:case"end":return t.stop()}}),t,this)}))),function(t){return At.apply(this,arguments)})},{key:"readDatasetOpenaiFinetuning",value:(St=st(at().mark((function t(e){var r,n,o,i,a,u;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.datasetId,n=e.datasetName,o="/datasets",void 0===r){t.next=5;break}t.next=12;break;case 5:if(void 0===n){t.next=11;break}return t.next=8,this.readDataset({datasetName:n});case 8:r=t.sent.id,t.next=12;break;case 11:throw new Error("Must provide datasetName or datasetId");case 12:return t.next=14,this._getResponse("".concat(o,"/").concat(r,"/openai_ft"));case 14:return i=t.sent,t.next=17,i.text();case 17:return a=t.sent,u=a.trim().split("\n").map((function(t){return JSON.parse(t)})),t.abrupt("return",u);case 20:case"end":return t.stop()}}),t,this)}))),function(t){return St.apply(this,arguments)})},{key:"listDatasets",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.limit,n=void 0===r?100:r,o=e.offset,i=void 0===o?0:o,a=e.datasetIds,u=e.datasetName,s=e.datasetNameContains,c=e.metadata;return yt(at().mark((function e(){var r,o,l,f,p,h,d,y,v,m;return at().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=new URLSearchParams({limit:n.toString(),offset:i.toString()}),void 0!==a){o=tt(a);try{for(o.s();!(l=o.n()).done;)f=l.value,r.append("id",f)}catch(t){o.e(t)}finally{o.f()}}void 0!==u&&r.append("name",u),void 0!==s&&r.append("name_contains",s),void 0!==c&&r.append("metadata",JSON.stringify(c)),p=!1,h=!1,e.prev=8,y=bt(t._getPaginated("/datasets",r));case 10:return e.next=12,dt(y.next());case 12:if(!(p=!(v=e.sent).done)){e.next=18;break}return m=v.value,e.delegateYield(ht(bt(m)),"t0",15);case 15:p=!1,e.next=10;break;case 18:e.next=24;break;case 20:e.prev=20,e.t1=e.catch(8),h=!0,d=e.t1;case 24:if(e.prev=24,e.prev=25,!p||null==y.return){e.next=29;break}return e.next=29,dt(y.return());case 29:if(e.prev=29,!h){e.next=32;break}throw d;case 32:return e.finish(29);case 33:return e.finish(24);case 34:case"end":return e.stop()}}),e,null,[[8,20,24,34],[25,,29,33]])})))()}},{key:"updateDataset",value:(jt=st(at().mark((function t(e){var r,n,o,i,u;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.datasetId,n=e.datasetName,o=X(e,V),r||n){t.next=3;break}throw new Error("Must provide either datasetName or datasetId");case 3:if(null==r){t.next=7;break}t.t0=r,t.next=10;break;case 7:return t.next=9,this.readDataset({datasetName:n});case 9:t.t0=t.sent.id;case 10:return E(i=t.t0),t.next=14,this.caller.call((0,a.Y)(),"".concat(this.apiUrl,"/datasets/").concat(i),lt({method:"PATCH",headers:lt(lt({},this.headers),{},{"Content-Type":"application/json"}),body:JSON.stringify(o),signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 14:return u=t.sent,t.next=17,M(u,"update dataset");case 17:return t.next=19,u.json();case 19:return t.abrupt("return",t.sent);case 20:case"end":return t.stop()}}),t,this)}))),function(t){return jt.apply(this,arguments)})},{key:"deleteDataset",value:(_t=st(at().mark((function t(e){var r,n,o,i,u,s;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.datasetId,n=e.datasetName,o="/datasets",i=r,void 0===r||void 0===n){t.next=7;break}throw new Error("Must provide either datasetName or datasetId, not both");case 7:if(void 0===n){t.next=12;break}return t.next=10,this.readDataset({datasetName:n});case 10:u=t.sent,i=u.id;case 12:if(void 0===i){t.next=17;break}E(i),o+="/".concat(i),t.next=18;break;case 17:throw new Error("Must provide datasetName or datasetId");case 18:return t.next=20,this.caller.call((0,a.Y)(),this.apiUrl+o,lt({method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 20:return s=t.sent,t.next=23,M(s,"delete ".concat(o));case 23:return t.next=25,s.json();case 25:case"end":return t.stop()}}),t,this)}))),function(t){return _t.apply(this,arguments)})},{key:"indexDataset",value:(gt=st(at().mark((function t(e){var r,n,o,i,u,s,c;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.datasetId,n=e.datasetName,o=e.tag,(i=r)||n){t.next=6;break}throw new Error("Must provide either datasetName or datasetId");case 6:if(!i||!n){t.next=10;break}throw new Error("Must provide either datasetName or datasetId, not both");case 10:if(i){t.next=15;break}return t.next=13,this.readDataset({datasetName:n});case 13:u=t.sent,i=u.id;case 15:return E(i),s={tag:o},t.next=19,this.caller.call((0,a.Y)(),"".concat(this.apiUrl,"/datasets/").concat(i,"/index"),lt({method:"POST",headers:lt(lt({},this.headers),{},{"Content-Type":"application/json"}),body:JSON.stringify(s),signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 19:return c=t.sent,t.next=22,M(c,"index dataset");case 22:return t.next=24,c.json();case 24:case"end":return t.stop()}}),t,this)}))),function(t){return gt.apply(this,arguments)})},{key:"similarExamples",value:(mt=st(at().mark((function t(e,r,n){var o,i,u,s,c=arguments;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=(c.length>3&&void 0!==c[3]?c[3]:{}).filter,i={limit:n,inputs:e},void 0!==o&&(i.filter=o),E(r),t.next=6,this.caller.call((0,a.Y)(),"".concat(this.apiUrl,"/datasets/").concat(r,"/search"),lt({method:"POST",headers:lt(lt({},this.headers),{},{"Content-Type":"application/json"}),body:JSON.stringify(i),signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 6:return u=t.sent,t.next=9,M(u,"fetch similar examples");case 9:return t.next=11,u.json();case 11:return s=t.sent,t.abrupt("return",s.examples);case 13:case"end":return t.stop()}}),t,this)}))),function(t,e,r){return mt.apply(this,arguments)})},{key:"createExample",value:(vt=st(at().mark((function t(e,r,n){var o,i,u,s,c,l,f,p,h,d,y,v,m;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=n.datasetId,i=n.datasetName,u=n.createdAt,s=n.exampleId,c=n.metadata,l=n.split,f=n.sourceRunId,void 0!==(p=o)||void 0!==i){t.next=6;break}throw new Error("Must provide either datasetName or datasetId");case 6:if(void 0===p||void 0===i){t.next=10;break}throw new Error("Must provide either datasetName or datasetId, not both");case 10:if(void 0!==p){t.next=15;break}return t.next=13,this.readDataset({datasetName:i});case 13:h=t.sent,p=h.id;case 15:return d=u||new Date,y={dataset_id:p,inputs:e,outputs:r,created_at:null==d?void 0:d.toISOString(),id:s,metadata:c,split:l,source_run_id:f},t.next=19,this.caller.call((0,a.Y)(),"".concat(this.apiUrl,"/examples"),lt({method:"POST",headers:lt(lt({},this.headers),{},{"Content-Type":"application/json"}),body:JSON.stringify(y),signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 19:return v=t.sent,t.next=22,M(v,"create example");case 22:return t.next=24,v.json();case 24:return m=t.sent,t.abrupt("return",m);case 26:case"end":return t.stop()}}),t,this)}))),function(t,e,r){return vt.apply(this,arguments)})},{key:"createExamples",value:(pt=st(at().mark((function t(e){var r,n,o,i,u,s,c,l,f,p,h,d;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.inputs,n=e.outputs,o=e.metadata,i=e.sourceRunIds,u=e.exampleIds,s=e.datasetId,c=e.datasetName,void 0!==(l=s)||void 0!==c){t.next=6;break}throw new Error("Must provide either datasetName or datasetId");case 6:if(void 0===l||void 0===c){t.next=10;break}throw new Error("Must provide either datasetName or datasetId, not both");case 10:if(void 0!==l){t.next=15;break}return t.next=13,this.readDataset({datasetName:c});case 13:f=t.sent,l=f.id;case 15:return p=r.map((function(t,r){return{dataset_id:l,inputs:t,outputs:n?n[r]:void 0,metadata:o?o[r]:void 0,split:e.splits?e.splits[r]:void 0,id:u?u[r]:void 0,source_run_id:i?i[r]:void 0}})),t.next=18,this.caller.call((0,a.Y)(),"".concat(this.apiUrl,"/examples/bulk"),lt({method:"POST",headers:lt(lt({},this.headers),{},{"Content-Type":"application/json"}),body:JSON.stringify(p),signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 18:return h=t.sent,t.next=21,M(h,"create examples");case 21:return t.next=23,h.json();case 23:return d=t.sent,t.abrupt("return",d);case 25:case"end":return t.stop()}}),t,this)}))),function(t){return pt.apply(this,arguments)})},{key:"createLLMExample",value:(ft=st(at().mark((function t(e,r,n){return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.createExample({input:e},{output:r},n));case 1:case"end":return t.stop()}}),t,this)}))),function(t,e,r){return ft.apply(this,arguments)})},{key:"createChatExample",value:(ct=st(at().mark((function t(e,r,n){var o,i;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=e.map((function(t){return b(t)?g(t):t})),i=b(r)?g(r):r,t.abrupt("return",this.createExample({input:o},{output:i},n));case 3:case"end":return t.stop()}}),t,this)}))),function(t,e,r){return ct.apply(this,arguments)})},{key:"readExample",value:(ut=st(at().mark((function t(e){var r;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return E(e),r="/examples/".concat(e),t.next=4,this._get(r);case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t,this)}))),function(t){return ut.apply(this,arguments)})},{key:"listExamples",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.datasetId,n=e.datasetName,o=e.exampleIds,i=e.asOf,a=e.splits,u=e.inlineS3Urls,s=e.metadata,c=e.limit,l=e.offset,f=e.filter;return yt(at().mark((function e(){var p,h,d,y,v,m,b,g,w,x,_,E,O,k,j,S,A,D,P,C,L,T;return at().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===r||void 0===n){e.next=4;break}throw new Error("Must provide either datasetName or datasetId, not both");case 4:if(void 0===r){e.next=8;break}p=r,e.next=16;break;case 8:if(void 0===n){e.next=15;break}return e.next=11,dt(t.readDataset({datasetName:n}));case 11:h=e.sent,p=h.id,e.next=16;break;case 15:throw new Error("Must provide a datasetName or datasetId");case 16:if(d=new URLSearchParams({dataset:p}),(y=i?"string"==typeof i?i:null==i?void 0:i.toISOString():void 0)&&d.append("as_of",y),v=null==u||u,d.append("inline_s3_urls",v.toString()),void 0!==o){m=tt(o);try{for(m.s();!(b=m.n()).done;)g=b.value,d.append("id",g)}catch(t){m.e(t)}finally{m.f()}}if(void 0!==a){w=tt(a);try{for(w.s();!(x=w.n()).done;)_=x.value,d.append("splits",_)}catch(t){w.e(t)}finally{w.f()}}void 0!==s&&(E=JSON.stringify(s),d.append("metadata",E)),void 0!==c&&d.append("limit",c.toString()),void 0!==l&&d.append("offset",l.toString()),void 0!==f&&d.append("filter",f),O=0,k=!1,j=!1,e.prev=30,A=bt(t._getPaginated("/examples",d));case 32:return e.next=34,dt(A.next());case 34:if(!(k=!(D=e.sent).done)){e.next=59;break}P=D.value,C=tt(P),e.prev=37,C.s();case 39:if((L=C.n()).done){e.next=46;break}return T=L.value,e.next=43,T;case 43:O++;case 44:e.next=39;break;case 46:e.next=51;break;case 48:e.prev=48,e.t0=e.catch(37),C.e(e.t0);case 51:return e.prev=51,C.f(),e.finish(51);case 54:if(!(void 0!==c&&O>=c)){e.next=56;break}return e.abrupt("break",59);case 56:k=!1,e.next=32;break;case 59:e.next=65;break;case 61:e.prev=61,e.t1=e.catch(30),j=!0,S=e.t1;case 65:if(e.prev=65,e.prev=66,!k||null==A.return){e.next=70;break}return e.next=70,dt(A.return());case 70:if(e.prev=70,!j){e.next=73;break}throw S;case 73:return e.finish(70);case 74:return e.finish(65);case 75:case"end":return e.stop()}}),e,null,[[30,61,65,75],[37,48,51,54],[66,,70,74]])})))()}},{key:"deleteExample",value:(ot=st(at().mark((function t(e){var r,n;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return E(e),r="/examples/".concat(e),t.next=4,this.caller.call((0,a.Y)(),this.apiUrl+r,lt({method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 4:return n=t.sent,t.next=7,M(n,"delete ".concat(r));case 7:return t.next=9,n.json();case 9:case"end":return t.stop()}}),t,this)}))),function(t){return ot.apply(this,arguments)})},{key:"updateExample",value:(rt=st(at().mark((function t(e,r){var n,o;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return E(e),t.next=3,this.caller.call((0,a.Y)(),"".concat(this.apiUrl,"/examples/").concat(e),lt({method:"PATCH",headers:lt(lt({},this.headers),{},{"Content-Type":"application/json"}),body:JSON.stringify(r),signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 3:return n=t.sent,t.next=6,M(n,"update example");case 6:return t.next=8,n.json();case 8:return o=t.sent,t.abrupt("return",o);case 10:case"end":return t.stop()}}),t,this)}))),function(t,e){return rt.apply(this,arguments)})},{key:"updateExamples",value:(et=st(at().mark((function t(e){var r,n;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.caller.call((0,a.Y)(),"".concat(this.apiUrl,"/examples/bulk"),lt({method:"PATCH",headers:lt(lt({},this.headers),{},{"Content-Type":"application/json"}),body:JSON.stringify(e),signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 2:return r=t.sent,t.next=5,M(r,"update examples");case 5:return t.next=7,r.json();case 7:return n=t.sent,t.abrupt("return",n);case 9:case"end":return t.stop()}}),t,this)}))),function(t){return et.apply(this,arguments)})},{key:"listDatasetSplits",value:(Z=st(at().mark((function t(e){var r,n,o,i,a,u,s,c;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.datasetId,n=e.datasetName,o=e.asOf,void 0!==r||void 0!==n){t.next=5;break}throw new Error("Must provide dataset name or ID");case 5:if(void 0===r||void 0===n){t.next=9;break}throw new Error("Must provide either datasetName or datasetId, not both");case 9:if(void 0!==r){t.next=16;break}return t.next=12,this.readDataset({datasetName:n});case 12:a=t.sent,i=a.id,t.next=17;break;case 16:i=r;case 17:return E(i),u=new URLSearchParams,(s=o?"string"==typeof o?o:null==o?void 0:o.toISOString():void 0)&&u.append("as_of",s),t.next=23,this._get("/datasets/".concat(i,"/splits"),u);case 23:return c=t.sent,t.abrupt("return",c);case 25:case"end":return t.stop()}}),t,this)}))),function(t){return Z.apply(this,arguments)})},{key:"updateDatasetSplits",value:(H=st(at().mark((function t(e){var r,n,o,i,u,s,c,l,f,p;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.datasetId,n=e.datasetName,o=e.splitName,i=e.exampleIds,u=e.remove,s=void 0!==u&&u,void 0!==r||void 0!==n){t.next=5;break}throw new Error("Must provide dataset name or ID");case 5:if(void 0===r||void 0===n){t.next=9;break}throw new Error("Must provide either datasetName or datasetId, not both");case 9:if(void 0!==r){t.next=16;break}return t.next=12,this.readDataset({datasetName:n});case 12:l=t.sent,c=l.id,t.next=17;break;case 16:c=r;case 17:return E(c),f={split_name:o,examples:i.map((function(t){return E(t),t})),remove:s},t.next=21,this.caller.call((0,a.Y)(),"".concat(this.apiUrl,"/datasets/").concat(c,"/splits"),lt({method:"PUT",headers:lt(lt({},this.headers),{},{"Content-Type":"application/json"}),body:JSON.stringify(f),signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 21:return p=t.sent,t.next=24,M(p,"update dataset splits",!0);case 24:case"end":return t.stop()}}),t,this)}))),function(t){return H.apply(this,arguments)})},{key:"evaluateRun",value:(q=st(at().mark((function t(e,r){var n,o,i,a,u,s,c,l,f,p=arguments;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=(n=p.length>2&&void 0!==p[2]?p[2]:{loadChildRuns:!1}).sourceInfo,i=n.loadChildRuns,a=n.referenceExample,(0,O.m)("This method is deprecated and will be removed in future LangSmith versions, use `evaluate` from `langsmith/evaluation` instead."),"string"!=typeof e){t.next=8;break}return t.next=5,this.readRun(e,{loadChildRuns:i});case 5:u=t.sent,t.next=13;break;case 8:if("object"!==W(e)||!("id"in e)){t.next=12;break}u=e,t.next=13;break;case 12:throw new Error("Invalid run type: ".concat(W(e)));case 13:if(null===u.reference_example_id||void 0===u.reference_example_id){t.next=17;break}return t.next=16,this.readExample(u.reference_example_id);case 16:a=t.sent;case 17:return t.next=19,r.evaluateRun(u,a);case 19:return s=t.sent,t.next=22,this._logEvaluationFeedback(s,u,o);case 22:return c=t.sent,(l=Q(c,2))[0],f=l[1],t.abrupt("return",f[0]);case 27:case"end":return t.stop()}}),t,this)}))),function(t,e){return q.apply(this,arguments)})},{key:"createFeedback",value:($=st(at().mark((function t(e,r,o){var i,u,s,c,l,f,p,h,d,y,v,m,b,g,w,x,_;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(u=o.score,s=o.value,c=o.correction,l=o.comment,f=o.sourceInfo,p=o.feedbackSourceType,h=void 0===p?"api":p,d=o.sourceRunId,y=o.feedbackId,v=o.feedbackConfig,m=o.projectId,b=o.comparativeExperimentId,e||m){t.next=3;break}throw new Error("One of runId or projectId must be provided");case 3:if(!e||!m){t.next=5;break}throw new Error("Only one of runId or projectId can be provided");case 5:return g={type:null!=h?h:"api",metadata:null!=f?f:{}},void 0===d||void 0===(null==g?void 0:g.metadata)||g.metadata.__run||(g.metadata.__run={run_id:d}),void 0!==(null==g?void 0:g.metadata)&&void 0!==(null===(i=g.metadata.__run)||void 0===i?void 0:i.run_id)&&E(g.metadata.__run.run_id),w={id:null!=y?y:n.A(),run_id:e,key:r,score:u,value:s,correction:c,comment:l,feedback_source:g,comparative_experiment_id:b,feedbackConfig:v,session_id:m},x="".concat(this.apiUrl,"/feedback"),t.next=12,this.caller.call((0,a.Y)(),x,lt({method:"POST",headers:lt(lt({},this.headers),{},{"Content-Type":"application/json"}),body:JSON.stringify(w),signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 12:return _=t.sent,t.next=15,M(_,"create feedback",!0);case 15:return t.abrupt("return",w);case 16:case"end":return t.stop()}}),t,this)}))),function(t,e,r){return $.apply(this,arguments)})},{key:"updateFeedback",value:(z=st(at().mark((function t(e,r){var n,o,i,u,s,c;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=r.score,o=r.value,i=r.correction,u=r.comment,s={},null!=n&&(s.score=n),null!=o&&(s.value=o),null!=i&&(s.correction=i),null!=u&&(s.comment=u),E(e),t.next=9,this.caller.call((0,a.Y)(),"".concat(this.apiUrl,"/feedback/").concat(e),lt({method:"PATCH",headers:lt(lt({},this.headers),{},{"Content-Type":"application/json"}),body:JSON.stringify(s),signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 9:return c=t.sent,t.next=12,M(c,"update feedback",!0);case 12:case"end":return t.stop()}}),t,this)}))),function(t,e){return z.apply(this,arguments)})},{key:"readFeedback",value:(U=st(at().mark((function t(e){var r,n;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return E(e),r="/feedback/".concat(e),t.next=4,this._get(r);case 4:return n=t.sent,t.abrupt("return",n);case 6:case"end":return t.stop()}}),t,this)}))),function(t){return U.apply(this,arguments)})},{key:"deleteFeedback",value:(G=st(at().mark((function t(e){var r,n;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return E(e),r="/feedback/".concat(e),t.next=4,this.caller.call((0,a.Y)(),this.apiUrl+r,lt({method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 4:return n=t.sent,t.next=7,M(n,"delete ".concat(r));case 7:return t.next=9,n.json();case 9:case"end":return t.stop()}}),t,this)}))),function(t){return G.apply(this,arguments)})},{key:"listFeedback",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.runIds,n=e.feedbackKeys,o=e.feedbackSourceTypes;return yt(at().mark((function e(){var i,a,u,s,c,l,f,p,h,d,y,v,m;return at().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=new URLSearchParams,r&&i.append("run",r.join(",")),n){a=tt(n);try{for(a.s();!(u=a.n()).done;)s=u.value,i.append("key",s)}catch(t){a.e(t)}finally{a.f()}}if(o){c=tt(o);try{for(c.s();!(l=c.n()).done;)f=l.value,i.append("source",f)}catch(t){c.e(t)}finally{c.f()}}p=!1,h=!1,e.prev=6,y=bt(t._getPaginated("/feedback",i));case 8:return e.next=10,dt(y.next());case 10:if(!(p=!(v=e.sent).done)){e.next=16;break}return m=v.value,e.delegateYield(ht(bt(m)),"t0",13);case 13:p=!1,e.next=8;break;case 16:e.next=22;break;case 18:e.prev=18,e.t1=e.catch(6),h=!0,d=e.t1;case 22:if(e.prev=22,e.prev=23,!p||null==y.return){e.next=27;break}return e.next=27,dt(y.return());case 27:if(e.prev=27,!h){e.next=30;break}throw d;case 30:return e.finish(27);case 31:return e.finish(22);case 32:case"end":return e.stop()}}),e,null,[[6,18,22,32],[23,,27,31]])})))()}},{key:"createPresignedFeedbackToken",value:(B=st(at().mark((function t(e,r){var n,o,i,u,s,c,l=arguments;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=(n=l.length>2&&void 0!==l[2]?l[2]:{}).expiration,i=n.feedbackConfig,u={run_id:e,feedback_key:r,feedback_config:i},o?"string"==typeof o?u.expires_at=o:(null!=o&&o.hours||null!=o&&o.minutes||null!=o&&o.days)&&(u.expires_in=o):u.expires_in={hours:3},t.next=5,this.caller.call((0,a.Y)(),"".concat(this.apiUrl,"/feedback/tokens"),lt({method:"POST",headers:lt(lt({},this.headers),{},{"Content-Type":"application/json"}),body:JSON.stringify(u),signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 5:return s=t.sent,t.next=8,s.json();case 8:return c=t.sent,t.abrupt("return",c);case 10:case"end":return t.stop()}}),t,this)}))),function(t,e){return B.apply(this,arguments)})},{key:"createComparativeExperiment",value:(R=st(at().mark((function t(e){var r,n,o,i,u,s,c,l,f,p;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.name,o=e.experimentIds,i=e.referenceDatasetId,u=e.createdAt,s=e.description,c=e.metadata,l=e.id,0!==o.length){t.next=3;break}throw new Error("At least one experiment is required");case 3:if(i){t.next=7;break}return t.next=6,this.readProject({projectId:o[0]});case 6:i=t.sent.reference_dataset_id;case 7:if(null!=!i){t.next=9;break}throw new Error("A reference dataset is required");case 9:return f={id:l,name:n,experiment_ids:o,reference_dataset_id:i,description:s,created_at:null===(r=null!=u?u:new Date)||void 0===r?void 0:r.toISOString(),extra:{}},c&&(f.extra.metadata=c),t.next=13,this.caller.call((0,a.Y)(),"".concat(this.apiUrl,"/datasets/comparative"),lt({method:"POST",headers:lt(lt({},this.headers),{},{"Content-Type":"application/json"}),body:JSON.stringify(f),signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 13:return p=t.sent,t.next=16,p.json();case 16:return t.abrupt("return",t.sent);case 17:case"end":return t.stop()}}),t,this)}))),function(t){return R.apply(this,arguments)})},{key:"listPresignedFeedbackTokens",value:function(t){var e=this;return yt(at().mark((function r(){var n,o,i,a,u,s,c;return at().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:E(t),n=new URLSearchParams({run_id:t}),o=!1,i=!1,r.prev=4,u=bt(e._getPaginated("/feedback/tokens",n));case 6:return r.next=8,dt(u.next());case 8:if(!(o=!(s=r.sent).done)){r.next=14;break}return c=s.value,r.delegateYield(ht(bt(c)),"t0",11);case 11:o=!1,r.next=6;break;case 14:r.next=20;break;case 16:r.prev=16,r.t1=r.catch(4),i=!0,a=r.t1;case 20:if(r.prev=20,r.prev=21,!o||null==u.return){r.next=25;break}return r.next=25,dt(u.return());case 25:if(r.prev=25,!i){r.next=28;break}throw a;case 28:return r.finish(25);case 29:return r.finish(20);case 30:case"end":return r.stop()}}),r,null,[[4,16,20,30],[21,,25,29]])})))()}},{key:"_selectEvalResults",value:function(t){return"results"in t?t.results:[t]}},{key:"_logEvaluationFeedback",value:(N=st(at().mark((function t(e,r,n){var o,i,a,u,s,c,l;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:o=this._selectEvalResults(e),i=[],a=tt(o),t.prev=3,a.s();case 5:if((u=a.n()).done){t.next=18;break}return s=u.value,c=n||{},s.evaluatorInfo&&(c=lt(lt({},s.evaluatorInfo),c)),l=null,s.targetRunId?l=s.targetRunId:r&&(l=r.id),t.t0=i,t.next=14,this.createFeedback(l,s.key,{score:s.score,value:s.value,comment:s.comment,correction:s.correction,sourceInfo:c,sourceRunId:s.sourceRunId,feedbackConfig:s.feedbackConfig,feedbackSourceType:"model"});case 14:t.t1=t.sent,t.t0.push.call(t.t0,t.t1);case 16:t.next=5;break;case 18:t.next=23;break;case 20:t.prev=20,t.t2=t.catch(3),a.e(t.t2);case 23:return t.prev=23,a.f(),t.finish(23);case 26:return t.abrupt("return",[o,i]);case 27:case"end":return t.stop()}}),t,this,[[3,20,23,26]])}))),function(t,e,r){return N.apply(this,arguments)})},{key:"logEvaluationFeedback",value:(I=st(at().mark((function t(e,r,n){var o,i,a;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._logEvaluationFeedback(e,r,n);case 2:return o=t.sent,i=Q(o,1),a=i[0],t.abrupt("return",a);case 6:case"end":return t.stop()}}),t,this)}))),function(t,e,r){return I.apply(this,arguments)})},{key:"listAnnotationQueues",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return yt(at().mark((function r(){var n,o,i,a,u,s,c,l,f,p,h,d;return at().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:n=e.queueIds,o=e.name,i=e.nameContains,a=e.limit,u=new URLSearchParams,n&&n.forEach((function(t,e){E(t,"queueIds[".concat(e,"]")),u.append("ids",t)})),o&&u.append("name",o),i&&u.append("name_contains",i),u.append("limit",(void 0!==a?Math.min(a,100):100).toString()),s=0,c=!1,l=!1,r.prev=9,p=bt(t._getPaginated("/annotation-queues",u));case 11:return r.next=13,dt(p.next());case 13:if(!(c=!(h=r.sent).done)){r.next=22;break}return d=h.value,r.delegateYield(ht(bt(d)),"t0",16);case 16:if(s++,!(void 0!==a&&s>=a)){r.next=19;break}return r.abrupt("break",22);case 19:c=!1,r.next=11;break;case 22:r.next=28;break;case 24:r.prev=24,r.t1=r.catch(9),l=!0,f=r.t1;case 28:if(r.prev=28,r.prev=29,!c||null==p.return){r.next=33;break}return r.next=33,dt(p.return());case 33:if(r.prev=33,!l){r.next=36;break}throw f;case 36:return r.finish(33);case 37:return r.finish(28);case 38:case"end":return r.stop()}}),r,null,[[9,24,28,38],[29,,33,37]])})))()}},{key:"createAnnotationQueue",value:(F=st(at().mark((function t(e){var r,o,i,u,s,c;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.name,o=e.description,i=e.queueId,u={name:r,description:o,id:i||n.A()},t.next=4,this.caller.call((0,a.Y)(),"".concat(this.apiUrl,"/annotation-queues"),lt({method:"POST",headers:lt(lt({},this.headers),{},{"Content-Type":"application/json"}),body:JSON.stringify(Object.fromEntries(Object.entries(u).filter((function(t){var e=Q(t,2);return e[0],void 0!==e[1]})))),signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 4:return s=t.sent,t.next=7,M(s,"create annotation queue");case 7:return t.next=9,s.json();case 9:return c=t.sent,t.abrupt("return",c);case 11:case"end":return t.stop()}}),t,this)}))),function(t){return F.apply(this,arguments)})},{key:"readAnnotationQueue",value:(T=st(at().mark((function t(e){var r;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.listAnnotationQueues({queueIds:[e]}).next();case 2:if(!(r=t.sent).done){t.next=5;break}throw new Error("Annotation queue with ID ".concat(e," not found"));case 5:return t.abrupt("return",r.value);case 6:case"end":return t.stop()}}),t,this)}))),function(t){return T.apply(this,arguments)})},{key:"updateAnnotationQueue",value:(L=st(at().mark((function t(e,r){var n,o,i;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=r.name,o=r.description,t.next=3,this.caller.call((0,a.Y)(),"".concat(this.apiUrl,"/annotation-queues/").concat(E(e,"queueId")),lt({method:"PATCH",headers:lt(lt({},this.headers),{},{"Content-Type":"application/json"}),body:JSON.stringify({name:n,description:o}),signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 3:return i=t.sent,t.next=6,M(i,"update annotation queue");case 6:case"end":return t.stop()}}),t,this)}))),function(t,e){return L.apply(this,arguments)})},{key:"deleteAnnotationQueue",value:(C=st(at().mark((function t(e){var r;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.caller.call((0,a.Y)(),"".concat(this.apiUrl,"/annotation-queues/").concat(E(e,"queueId")),lt({method:"DELETE",headers:lt(lt({},this.headers),{},{Accept:"application/json"}),signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 2:return r=t.sent,t.next=5,M(r,"delete annotation queue");case 5:case"end":return t.stop()}}),t,this)}))),function(t){return C.apply(this,arguments)})},{key:"addRunsToAnnotationQueue",value:(P=st(at().mark((function t(e,r){var n;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.caller.call((0,a.Y)(),"".concat(this.apiUrl,"/annotation-queues/").concat(E(e,"queueId"),"/runs"),lt({method:"POST",headers:lt(lt({},this.headers),{},{"Content-Type":"application/json"}),body:JSON.stringify(r.map((function(t,e){return E(t,"runIds[".concat(e,"]")).toString()}))),signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 2:return n=t.sent,t.next=5,M(n,"add runs to annotation queue");case 5:case"end":return t.stop()}}),t,this)}))),function(t,e){return P.apply(this,arguments)})},{key:"getRunFromAnnotationQueue",value:(S=st(at().mark((function t(e,r){var n,o;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n="/annotation-queues/".concat(E(e,"queueId"),"/run"),t.next=3,this.caller.call((0,a.Y)(),"".concat(this.apiUrl).concat(n,"/").concat(r),lt({method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 3:return o=t.sent,t.next=6,M(o,"get run from annotation queue");case 6:return t.next=8,o.json();case 8:return t.abrupt("return",t.sent);case 9:case"end":return t.stop()}}),t,this)}))),function(t,e){return S.apply(this,arguments)})},{key:"_currentTenantIsOwner",value:(j=st(at().mark((function t(e){var r;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._getSettings();case 2:return r=t.sent,t.abrupt("return","-"==e||r.tenant_handle===e);case 4:case"end":return t.stop()}}),t,this)}))),function(t){return j.apply(this,arguments)})},{key:"_ownerConflictError",value:(k=st(at().mark((function t(e,r){var n;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._getSettings();case 2:return n=t.sent,t.abrupt("return",new Error("Cannot ".concat(e," for another tenant.\n\n      Current tenant: ").concat(n.tenant_handle,"\n\n      Requested tenant: ").concat(r)));case 4:case"end":return t.stop()}}),t,this)}))),function(t,e){return k.apply(this,arguments)})},{key:"_getLatestCommitHash",value:(_=st(at().mark((function t(e){var r,n,o,i;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.caller.call((0,a.Y)(),"".concat(this.apiUrl,"/commits/").concat(e,"/?limit=",1,"&offset=",0),lt({method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 2:return r=t.sent,t.next=5,r.json();case 5:if(n=t.sent,r.ok){t.next=11;break}throw o="string"==typeof n.detail?n.detail:JSON.stringify(n.detail),(i=new Error("Error ".concat(r.status,": ").concat(r.statusText,"\n").concat(o))).statusCode=r.status,i;case 11:if(0!==n.commits.length){t.next=13;break}return t.abrupt("return",void 0);case 13:return t.abrupt("return",n.commits[0].commit_hash);case 14:case"end":return t.stop()}}),t,this)}))),function(t){return _.apply(this,arguments)})},{key:"_likeOrUnlikePrompt",value:(m=st(at().mark((function t(e,r){var n,o,i,u,s;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=D(e),o=Q(n,3),i=o[0],u=o[1],o[2],t.next=3,this.caller.call((0,a.Y)(),"".concat(this.apiUrl,"/likes/").concat(i,"/").concat(u),lt({method:"POST",body:JSON.stringify({like:r}),headers:lt(lt({},this.headers),{},{"Content-Type":"application/json"}),signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 3:return s=t.sent,t.next=6,M(s,"".concat(r?"like":"unlike"," prompt"));case 6:return t.next=8,s.json();case 8:return t.abrupt("return",t.sent);case 9:case"end":return t.stop()}}),t,this)}))),function(t,e){return m.apply(this,arguments)})},{key:"_getPromptUrl",value:(v=st(at().mark((function t(e){var r,n,o,i,a,u;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=D(e),n=Q(r,3),o=n[0],i=n[1],a=n[2],t.next=3,this._currentTenantIsOwner(o);case 3:if(t.sent){t.next=11;break}if("latest"===a){t.next=8;break}return t.abrupt("return","".concat(this.getHostUrl(),"/hub/").concat(o,"/").concat(i,"/").concat(a.substring(0,8)));case 8:return t.abrupt("return","".concat(this.getHostUrl(),"/hub/").concat(o,"/").concat(i));case 9:t.next=19;break;case 11:return t.next=13,this._getSettings();case 13:if(u=t.sent,"latest"===a){t.next=18;break}return t.abrupt("return","".concat(this.getHostUrl(),"/prompts/").concat(i,"/").concat(a.substring(0,8),"?organizationId=").concat(u.id));case 18:return t.abrupt("return","".concat(this.getHostUrl(),"/prompts/").concat(i,"?organizationId=").concat(u.id));case 19:case"end":return t.stop()}}),t,this)}))),function(t){return v.apply(this,arguments)})},{key:"promptExists",value:(y=st(at().mark((function t(e){var r;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getPrompt(e);case 2:return r=t.sent,t.abrupt("return",!!r);case 4:case"end":return t.stop()}}),t,this)}))),function(t){return y.apply(this,arguments)})},{key:"likePrompt",value:(h=st(at().mark((function t(e){return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this._likeOrUnlikePrompt(e,!0));case 1:case"end":return t.stop()}}),t,this)}))),function(t){return h.apply(this,arguments)})},{key:"unlikePrompt",value:(p=st(at().mark((function t(e){return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this._likeOrUnlikePrompt(e,!1));case 1:case"end":return t.stop()}}),t,this)}))),function(t){return p.apply(this,arguments)})},{key:"listCommits",value:function(t){var e=this;return yt(at().mark((function r(){var n,o,i,a,u,s;return at().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:n=!1,o=!1,r.prev=2,a=bt(e._getPaginated("/commits/".concat(t,"/"),new URLSearchParams,(function(t){return t.commits})));case 4:return r.next=6,dt(a.next());case 6:if(!(n=!(u=r.sent).done)){r.next=12;break}return s=u.value,r.delegateYield(ht(bt(s)),"t0",9);case 9:n=!1,r.next=4;break;case 12:r.next=18;break;case 14:r.prev=14,r.t1=r.catch(2),o=!0,i=r.t1;case 18:if(r.prev=18,r.prev=19,!n||null==a.return){r.next=23;break}return r.next=23,dt(a.return());case 23:if(r.prev=23,!o){r.next=26;break}throw i;case 26:return r.finish(23);case 27:return r.finish(18);case 28:case"end":return r.stop()}}),r,null,[[2,14,18,28],[19,,23,27]])})))()}},{key:"listPrompts",value:function(t){var e=this;return yt(at().mark((function r(){var n,o,i,a,u,s,c,l;return at().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:(o=new URLSearchParams).append("sort_field",null!==(n=null==t?void 0:t.sortField)&&void 0!==n?n:"updated_at"),o.append("sort_direction","desc"),o.append("is_archived",(!(null==t||!t.isArchived)).toString()),void 0!==(null==t?void 0:t.isPublic)&&o.append("is_public",t.isPublic.toString()),null!=t&&t.query&&o.append("query",t.query),i=!1,a=!1,r.prev=8,s=bt(e._getPaginated("/repos",o,(function(t){return t.repos})));case 10:return r.next=12,dt(s.next());case 12:if(!(i=!(c=r.sent).done)){r.next=18;break}return l=c.value,r.delegateYield(ht(bt(l)),"t0",15);case 15:i=!1,r.next=10;break;case 18:r.next=24;break;case 20:r.prev=20,r.t1=r.catch(8),a=!0,u=r.t1;case 24:if(r.prev=24,r.prev=25,!i||null==s.return){r.next=29;break}return r.next=29,dt(s.return());case 29:if(r.prev=29,!a){r.next=32;break}throw u;case 32:return r.finish(29);case 33:return r.finish(24);case 34:case"end":return r.stop()}}),r,null,[[8,20,24,34],[25,,29,33]])})))()}},{key:"getPrompt",value:(f=st(at().mark((function t(e){var r,n,o,i,u,s;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=D(e),n=Q(r,3),o=n[0],i=n[1],n[2],t.next=3,this.caller.call((0,a.Y)(),"".concat(this.apiUrl,"/repos/").concat(o,"/").concat(i),lt({method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 3:if(404!==(u=t.sent).status){t.next=6;break}return t.abrupt("return",null);case 6:return t.next=8,M(u,"get prompt");case 8:return t.next=10,u.json();case 10:if(!(s=t.sent).repo){t.next=15;break}return t.abrupt("return",s.repo);case 15:return t.abrupt("return",null);case 16:case"end":return t.stop()}}),t,this)}))),function(t){return f.apply(this,arguments)})},{key:"createPrompt",value:(l=st(at().mark((function t(e,r){var n,o,i,u,s,c,l,f,p;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._getSettings();case 2:if(n=t.sent,null==r||!r.isPublic||n.tenant_handle){t.next=5;break}throw new Error("Cannot create a public prompt without first\n\n        creating a LangChain Hub handle. \n        You can add a handle by creating a public prompt at:\n\n        https://smith.langchain.com/prompts");case 5:return o=D(e),i=Q(o,3),u=i[0],s=i[1],i[2],t.next=8,this._currentTenantIsOwner(u);case 8:if(t.sent){t.next=12;break}return t.next=11,this._ownerConflictError("create a prompt",u);case 11:throw t.sent;case 12:return c=lt(lt(lt(lt({repo_handle:s},(null==r?void 0:r.description)&&{description:r.description}),(null==r?void 0:r.readme)&&{readme:r.readme}),(null==r?void 0:r.tags)&&{tags:r.tags}),{},{is_public:!(null==r||!r.isPublic)}),t.next=15,this.caller.call((0,a.Y)(),"".concat(this.apiUrl,"/repos/"),lt({method:"POST",headers:lt(lt({},this.headers),{},{"Content-Type":"application/json"}),body:JSON.stringify(c),signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 15:return l=t.sent,t.next=18,M(l,"create prompt");case 18:return t.next=20,l.json();case 20:return f=t.sent,p=f.repo,t.abrupt("return",p);case 23:case"end":return t.stop()}}),t,this)}))),function(t,e){return l.apply(this,arguments)})},{key:"createCommit",value:(c=st(at().mark((function t(e,r,n){var o,i,u,s,c,l,f,p;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.promptExists(e);case 2:if(t.sent){t.next=4;break}throw new Error("Prompt does not exist, you must create it first.");case 4:if(o=D(e),i=Q(o,3),u=i[0],s=i[1],i[2],"latest"!==(null==n?void 0:n.parentCommitHash)&&null!=n&&n.parentCommitHash){t.next=11;break}return t.next=8,this._getLatestCommitHash("".concat(u,"/").concat(s));case 8:t.t0=t.sent,t.next=12;break;case 11:t.t0=null==n?void 0:n.parentCommitHash;case 12:return c=t.t0,l={manifest:JSON.parse(JSON.stringify(r)),parent_commit:c},t.next=16,this.caller.call((0,a.Y)(),"".concat(this.apiUrl,"/commits/").concat(u,"/").concat(s),lt({method:"POST",headers:lt(lt({},this.headers),{},{"Content-Type":"application/json"}),body:JSON.stringify(l),signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 16:return f=t.sent,t.next=19,M(f,"create commit");case 19:return t.next=21,f.json();case 21:return p=t.sent,t.abrupt("return",this._getPromptUrl("".concat(u,"/").concat(s).concat(p.commit_hash?":".concat(p.commit_hash):"")));case 23:case"end":return t.stop()}}),t,this)}))),function(t,e,r){return c.apply(this,arguments)})},{key:"updatePrompt",value:(s=st(at().mark((function t(e,r){var n,o,i,u,s,c;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.promptExists(e);case 2:if(t.sent){t.next=4;break}throw new Error("Prompt does not exist, you must create it first.");case 4:return n=D(e),o=Q(n,2),i=o[0],u=o[1],t.next=7,this._currentTenantIsOwner(i);case 7:if(t.sent){t.next=11;break}return t.next=10,this._ownerConflictError("update a prompt",i);case 10:throw t.sent;case 11:if(s={},void 0!==(null==r?void 0:r.description)&&(s.description=r.description),void 0!==(null==r?void 0:r.readme)&&(s.readme=r.readme),void 0!==(null==r?void 0:r.tags)&&(s.tags=r.tags),void 0!==(null==r?void 0:r.isPublic)&&(s.is_public=r.isPublic),void 0!==(null==r?void 0:r.isArchived)&&(s.is_archived=r.isArchived),0!==Object.keys(s).length){t.next=19;break}throw new Error("No valid update options provided");case 19:return t.next=21,this.caller.call((0,a.Y)(),"".concat(this.apiUrl,"/repos/").concat(i,"/").concat(u),lt({method:"PATCH",body:JSON.stringify(s),headers:lt(lt({},this.headers),{},{"Content-Type":"application/json"}),signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 21:return c=t.sent,t.next=24,M(c,"update prompt");case 24:return t.abrupt("return",c.json());case 25:case"end":return t.stop()}}),t,this)}))),function(t,e){return s.apply(this,arguments)})},{key:"deletePrompt",value:(u=st(at().mark((function t(e){var r,n,o,i,u;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.promptExists(e);case 2:if(t.sent){t.next=4;break}throw new Error("Prompt does not exist, you must create it first.");case 4:return r=D(e),n=Q(r,3),o=n[0],i=n[1],n[2],t.next=7,this._currentTenantIsOwner(o);case 7:if(t.sent){t.next=11;break}return t.next=10,this._ownerConflictError("delete a prompt",o);case 10:throw t.sent;case 11:return t.next=13,this.caller.call((0,a.Y)(),"".concat(this.apiUrl,"/repos/").concat(o,"/").concat(i),lt({method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 13:return u=t.sent,t.next=16,u.json();case 16:return t.abrupt("return",t.sent);case 17:case"end":return t.stop()}}),t,this)}))),function(t){return u.apply(this,arguments)})},{key:"pullPromptCommit",value:(i=st(at().mark((function t(e,r){var n,o,i,u,s,c,l,f,p,h,d;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=D(e),o=Q(n,3),i=o[0],u=o[1],s=o[2],t.next=3,this._getServerInfo();case 3:if(c=t.sent,l=A(c.version,"0.5.23"),f=s,l||"latest"!==s){t.next=15;break}return t.next=9,this._getLatestCommitHash("".concat(i,"/").concat(u));case 9:if(p=t.sent){t.next=14;break}throw new Error("No commits found");case 14:f=p;case 15:return t.next=17,this.caller.call((0,a.Y)(),"".concat(this.apiUrl,"/commits/").concat(i,"/").concat(u,"/").concat(f).concat(null!=r&&r.includeModel?"?include_model=true":""),lt({method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)},this.fetchOptions));case 17:return h=t.sent,t.next=20,M(h,"pull prompt commit");case 20:return t.next=22,h.json();case 22:return d=t.sent,t.abrupt("return",{owner:i,repo:u,commit_hash:d.commit_hash,manifest:d.manifest,examples:d.examples});case 24:case"end":return t.stop()}}),t,this)}))),function(t,e){return i.apply(this,arguments)})},{key:"_pullPrompt",value:(o=st(at().mark((function t(e,r){var n,o;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.pullPromptCommit(e,{includeModel:null==r?void 0:r.includeModel});case 2:return n=t.sent,o=JSON.stringify(n.manifest),t.abrupt("return",o);case 5:case"end":return t.stop()}}),t,this)}))),function(t,e){return o.apply(this,arguments)})},{key:"pushPrompt",value:(r=st(at().mark((function t(e,r){var n;return at().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.promptExists(e);case 2:if(!t.sent){t.next=8;break}if(!r||!Object.keys(r).some((function(t){return"object"!==t}))){t.next=6;break}return t.next=6,this.updatePrompt(e,{description:null==r?void 0:r.description,readme:null==r?void 0:r.readme,tags:null==r?void 0:r.tags,isPublic:null==r?void 0:r.isPublic});case 6:t.next=10;break;case 8:return t.next=10,this.createPrompt(e,{description:null==r?void 0:r.description,readme:null==r?void 0:r.readme,tags:null==r?void 0:r.tags,isPublic:null==r?void 0:r.isPublic});case 10:if(null!=r&&r.object){t.next=14;break}return t.next=13,this._getPromptUrl(e);case 13:return t.abrupt("return",t.sent);case 14:return t.next=16,this.createCommit(e,null==r?void 0:r.object,{parentCommitHash:null==r?void 0:r.parentCommitHash});case 16:return n=t.sent,t.abrupt("return",n);case 18:case"end":return t.stop()}}),t,this)}))),function(t,e){return r.apply(this,arguments)})},{key:"clonePublicDataset",value:(e=st(at().mark((function e(r){var n,o,i,a,u,s,c,l,f,p,h,d,y,v,m,b=arguments;return at().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=(i=b.length>1&&void 0!==b[1]?b[1]:{}).sourceApiUrl,u=void 0===a?this.apiUrl:a,s=i.datasetName,c=this.parseTokenOrUrl(r,u),l=Q(c,2),f=l[0],p=l[1],h=new t({apiUrl:f,apiKey:"placeholder"}),e.next=6,h.readSharedDataset(p);case 6:return d=e.sent,y=s||d.name,e.prev=8,e.next=11,this.hasDataset({datasetId:y});case 11:if(!e.sent){e.next=14;break}return console.log("Dataset ".concat(y," already exists in your tenant. Skipping.")),e.abrupt("return");case 14:e.next=18;break;case 16:e.prev=16,e.t0=e.catch(8);case 18:return e.next=20,h.listSharedExamples(p);case 20:return v=e.sent,e.next=23,this.createDataset(y,{description:d.description,dataType:d.data_type||"kv",inputsSchema:null!==(n=d.inputs_schema_definition)&&void 0!==n?n:void 0,outputsSchema:null!==(o=d.outputs_schema_definition)&&void 0!==o?o:void 0});case 23:return m=e.sent,e.prev=24,e.next=27,this.createExamples({inputs:v.map((function(t){return t.inputs})),outputs:v.flatMap((function(t){return t.outputs?[t.outputs]:[]})),datasetId:m.id});case 27:e.next=33;break;case 29:throw e.prev=29,e.t1=e.catch(24),console.error("An error occurred while creating dataset ".concat(y,". ")+"You should delete it manually."),e.t1;case 33:case"end":return e.stop()}}),e,this,[[8,16],[24,29]])}))),function(t){return e.apply(this,arguments)})},{key:"parseTokenOrUrl",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"dataset";try{return E(t),[e,t]}catch(t){}try{var o=new URL(t).pathname.split("/").filter((function(t){return""!==t}));if(o.length>=r)return[e,o[o.length-r]];throw new Error("Invalid public ".concat(n," URL: ").concat(t))}catch(e){throw new Error("Invalid public ".concat(n," URL or token: ").concat(t))}}},{key:"awaitPendingTraceBatches",value:function(){return Promise.all(this.autoBatchQueue.items.map((function(t){return t.itemPromise})))}}],[{key:"getDefaultClientConfig",value:function(){var t,e=(0,w.Jz)("API_KEY");return{apiUrl:null!==(t=(0,w.Jz)("ENDPOINT"))&&void 0!==t?t:"https://api.smith.langchain.com",apiKey:e,webUrl:void 0,hideInputs:"true"===(0,w.Jz)("HIDE_INPUTS"),hideOutputs:"true"===(0,w.Jz)("HIDE_OUTPUTS")}}}]);var e,r,o,i,u,s,c,l,f,p,h,y,v,m,_,k,j,S,P,C,L,T,F,I,N,R,B,G,U,z,$,q,H,Z,et,rt,ot,ut,ct,ft,pt,vt,mt,gt,_t,jt,St,At,Dt,Pt,Ct,Lt,Tt,Ft,It,Nt,Rt,Mt,Bt,Gt,Ut,zt,$t,qt,Kt,Ht,Zt,Yt,Vt,Wt,Jt,Xt,Qt,te,ee,re,ne,oe,ie,ae,ue,se,ce,le,fe,pe,he}()},4797:(t,e,r)=>{"use strict";r.d(e,{Kj:()=>n.Kj,Ls:()=>i,gk:()=>o.gk});var n=r(7912),o=r(2877),i=(r(3180),"0.1.68")},2877:(t,e,r)=>{"use strict";r.d(e,{gk:()=>k,m5:()=>j});var n=r(6963),o=r(5704),i=r(7912),a=r(6991),u=Symbol.for("lc:context_variables"),s=["metadata"];function c(){c=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,r){return t[e]=r}}function f(t,e,r,n){var i=e&&e.prototype instanceof g?e:g,a=Object.create(i.prototype),u=new L(n||[]);return o(a,"_invoke",{value:A(t,r,u)}),a}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=f;var h="suspendedStart",d="suspendedYield",v="executing",m="completed",b={};function g(){}function w(){}function x(){}var _={};l(_,a,(function(){return this}));var E=Object.getPrototypeOf,O=E&&E(E(T([])));O&&O!==r&&n.call(O,a)&&(_=O);var k=x.prototype=g.prototype=Object.create(_);function j(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(o,i,a,u){var s=p(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==y(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function A(e,r,n){var o=h;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=D(u,n);if(s){if(s===b)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=v;var c=p(e,r,n);if("normal"===c.type){if(o=n.done?m:d,c.arg===b)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=m,n.method="throw",n.arg=c.arg)}}}function D(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,D(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;var i=p(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,b;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,b):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,b)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(y(e)+" is not iterable")}return w.prototype=x,o(k,"constructor",{value:x,configurable:!0}),o(x,"constructor",{value:w,configurable:!0}),w.displayName=l(x,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,l(t,s,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},j(S.prototype),l(S.prototype,u,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new S(f(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},j(k),l(k,s,"Generator"),l(k,a,(function(){return this})),l(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,b):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),C(r),b}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;C(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),b}},e}function l(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function f(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){l(i,n,o,a,u,"next",t)}function u(t){l(i,n,o,a,u,"throw",t)}a(void 0)}))}}function p(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function h(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?p(Object(r),!0).forEach((function(e){d(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function d(t,e,r){return(e=E(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function y(t){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},y(t)}function v(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],s=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);s=!0);}catch(t){c=!0,o=t}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(t,e)||b(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=b(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}function b(t,e){if(t){if("string"==typeof t)return g(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?g(t,e):void 0}}function g(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function w(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function x(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,E(n.key),n)}}function _(t,e,r){return e&&x(t.prototype,e),r&&x(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function E(t){var e=function(t){if("object"!=y(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=y(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==y(e)?e:e+""}var O=function(){function t(e,r){w(this,t),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.metadata=e,this.tags=r}return _(t,[{key:"toHeader",value:function(){var t=[];return this.metadata&&Object.keys(this.metadata).length>0&&t.push("langsmith-metadata=".concat(encodeURIComponent(JSON.stringify(this.metadata)))),this.tags&&this.tags.length>0&&t.push("langsmith-tags=".concat(encodeURIComponent(this.tags.join(",")))),t.join(",")}}],[{key:"fromHeader",value:function(e){var r,n={},o=[],i=m(e.split(","));try{for(i.s();!(r=i.n()).done;){var a=v(r.value.split("="),2),u=a[0],s=a[1],c=decodeURIComponent(s);"langsmith-metadata"===u?n=JSON.parse(c):"langsmith-tags"===u&&(o=c.split(","))}}catch(t){i.e(t)}finally{i.f()}return new t(n,o)}}])}(),k=function(){function t(e){var r,n,o,i;if(w(this,t),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"run_type",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"project_name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"parent_run",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"child_runs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"start_time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"end_time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"extra",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"error",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"serialized",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"reference_example_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"trace_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"dotted_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tracingEnabled",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"execution_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"child_execution_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),j(e))Object.assign(this,h({},e));else{var a,u=t.getDefaultConfig(),c=e.metadata,l=function(t,e){if(null==t)return{};var r,n,o=function(t,e){if(null==t)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.includes(n))continue;r[n]=t[n]}return r}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.includes(r)||{}.propertyIsEnumerable.call(t,r)&&(o[r]=t[r])}return o}(e,s),f=null!==(r=l.client)&&void 0!==r?r:t.getSharedClient(),p=h(h({},c),null==l||null===(n=l.extra)||void 0===n?void 0:n.metadata);if(l.extra=h(h({},l.extra),{},{metadata:p}),Object.assign(this,h(h(h({},u),l),{},{client:f})),this.trace_id||(this.parent_run?this.trace_id=null!==(a=this.parent_run.trace_id)&&void 0!==a?a:this.id:this.trace_id=this.id),null!==(o=this.execution_order)&&void 0!==o||(this.execution_order=1),null!==(i=this.child_execution_order)&&void 0!==i||(this.child_execution_order=1),!this.dotted_order){var d=function(t,e){var r=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:1).toFixed(0).slice(0,3).padStart(3,"0");return"".concat(new Date(t).toISOString().slice(0,-1)).concat(r,"Z").replace(/[-:.]/g,"")+e}(this.start_time,this.id,this.execution_order);this.parent_run?this.dotted_order=this.parent_run.dotted_order+"."+d:this.dotted_order=d}}}return _(t,[{key:"createChild",value:function(e){var r,n,o=this.child_execution_order+1,i=new t(h(h({},e),{},{parent_run:this,project_name:this.project_name,client:this.client,tracingEnabled:this.tracingEnabled,execution_order:o,child_execution_order:o}));u in this&&(i[u]=this[u]);var a,s,c=Symbol.for("lc:child_config"),l=null!==(r=null===(n=e.extra)||void 0===n?void 0:n[c])&&void 0!==r?r:this.extra[c];if(void 0!==(a=l)&&"object"===y(a.callbacks)&&(A(null===(s=a.callbacks)||void 0===s?void 0:s.handlers)||A(a.callbacks))){var f,p,d,v,m=h({},l),b=function(t){return"object"===y(t)&&null!=t&&Array.isArray(t.handlers)}(m.callbacks)?null===(f=(p=m.callbacks).copy)||void 0===f?void 0:f.call(p):void 0;b&&(Object.assign(b,{_parentRunId:i.id}),null===(d=b.handlers)||void 0===d||null===(d=d.find(S))||void 0===d||null===(v=d.updateFromRunTree)||void 0===v||v.call(d,i),m.callbacks=b),i.extra[c]=m}for(var g=new Set,w=this;null!=w&&!g.has(w.id);)g.add(w.id),w.child_execution_order=Math.max(w.child_execution_order,o),w=w.parent_run;return this.child_runs.push(i),i}},{key:"end",value:(l=f(c().mark((function t(e,r){var n,o,i,a,u,s=arguments;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=s.length>2&&void 0!==s[2]?s[2]:Date.now(),u=s.length>3?s[3]:void 0,this.outputs=null!==(n=this.outputs)&&void 0!==n?n:e,this.error=null!==(o=this.error)&&void 0!==o?o:r,this.end_time=null!==(i=this.end_time)&&void 0!==i?i:a,u&&Object.keys(u).length>0&&(this.extra=this.extra?h(h({},this.extra),{},{metadata:h(h({},this.extra.metadata),u)}):{metadata:u});case 6:case"end":return t.stop()}}),t,this)}))),function(t,e){return l.apply(this,arguments)})},{key:"_convertToCreate",value:function(t,e){var r,n,o,i,a=this,u=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],s=null!==(r=t.extra)&&void 0!==r?r:{};if(s.runtime||(s.runtime={}),e)for(var c=0,l=Object.entries(e);c<l.length;c++){var f=v(l[c],2),p=f[0],h=f[1];s.runtime[p]||(s.runtime[p]=h)}return u?(o=null===(i=t.parent_run)||void 0===i?void 0:i.id,n=[]):(n=t.child_runs.map((function(t){return a._convertToCreate(t,e,u)})),o=void 0),{id:t.id,name:t.name,start_time:t.start_time,end_time:t.end_time,run_type:t.run_type,reference_example_id:t.reference_example_id,extra:s,serialized:t.serialized,error:t.error,inputs:t.inputs,outputs:t.outputs,session_name:t.project_name,child_runs:n,parent_run_id:o,trace_id:t.trace_id,dotted_order:t.dotted_order,tags:t.tags}}},{key:"postRun",value:(r=f(c().mark((function t(){var e,r,n,i,u,s,l=arguments;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=!(l.length>0&&void 0!==l[0])||l[0],t.prev=1,r=(0,o.Ec)(),t.next=5,this._convertToCreate(this,r,!0);case 5:return n=t.sent,t.next=8,this.client.createRun(n);case 8:if(e){t.next=27;break}(0,a.m)("Posting with excludeChildRuns=false is deprecated and will be removed in a future version."),i=m(this.child_runs),t.prev=11,i.s();case 13:if((u=i.n()).done){t.next=19;break}return s=u.value,t.next=17,s.postRun(!1);case 17:t.next=13;break;case 19:t.next=24;break;case 21:t.prev=21,t.t0=t.catch(11),i.e(t.t0);case 24:return t.prev=24,i.f(),t.finish(24);case 27:t.next=32;break;case 29:t.prev=29,t.t1=t.catch(1),console.error("Error in postRun for run ".concat(this.id,":"),t.t1);case 32:case"end":return t.stop()}}),t,this,[[1,29],[11,21,24,27]])}))),function(){return r.apply(this,arguments)})},{key:"patchRun",value:(e=f(c().mark((function t(){var e,r;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r={end_time:this.end_time,error:this.error,inputs:this.inputs,outputs:this.outputs,parent_run_id:null===(e=this.parent_run)||void 0===e?void 0:e.id,reference_example_id:this.reference_example_id,extra:this.extra,events:this.events,dotted_order:this.dotted_order,trace_id:this.trace_id,tags:this.tags},t.next=4,this.client.updateRun(this.id,r);case 4:t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),console.error("Error in patchRun for run ".concat(this.id),t.t0);case 9:case"end":return t.stop()}}),t,this,[[0,6]])}))),function(){return e.apply(this,arguments)})},{key:"toJSON",value:function(){return this._convertToCreate(this,void 0,!1)}},{key:"toHeaders",value:function(t){var e,r={"langsmith-trace":this.dotted_order,baggage:new O(null===(e=this.extra)||void 0===e?void 0:e.metadata,this.tags).toHeader()};if(t)for(var n=0,o=Object.entries(r);n<o.length;n++){var i=v(o[n],2),a=i[0],u=i[1];t.set(a,u)}return r}}],[{key:"getDefaultConfig",value:function(){var t,e,r;return{id:n.A(),run_type:"chain",project_name:null!==(t=null!==(e=(0,o.Az)("LANGCHAIN_PROJECT"))&&void 0!==e?e:(0,o.Az)("LANGCHAIN_SESSION"))&&void 0!==t?t:"default",child_runs:[],api_url:null!==(r=(0,o.Az)("LANGCHAIN_ENDPOINT"))&&void 0!==r?r:"http://localhost:1984",api_key:(0,o.Az)("LANGCHAIN_API_KEY"),caller_options:{},start_time:Date.now(),serialized:{},inputs:{},extra:{}}}},{key:"getSharedClient",value:function(){return t.sharedClient||(t.sharedClient=new i.Kj),t.sharedClient}},{key:"fromRunnableConfig",value:function(e,r){var n,i,a,u,s,c,l,f,p=null==e?void 0:e.callbacks,d=!!["TRACING_V2","TRACING"].find((function(t){return"true"===(0,o.Jz)(t)}));if(p){var y,v,m,w,x=null!==(y=null==p||null===(v=p.getParentRunId)||void 0===v?void 0:v.call(p))&&void 0!==y?y:"",_=null==p||null===(m=p.handlers)||void 0===m?void 0:m.find((function(t){return"langchain_tracer"==(null==t?void 0:t.name)}));s=null==_||null===(w=_.getRun)||void 0===w?void 0:w.call(_,x),c=null==_?void 0:_.projectName,l=null==_?void 0:_.client,d=d||!!_}return s?new t({name:s.name,id:s.id,trace_id:s.trace_id,dotted_order:s.dotted_order,client:l,tracingEnabled:d,project_name:c,tags:(f=new Set((null!==(n=null===(i=s)||void 0===i?void 0:i.tags)&&void 0!==n?n:[]).concat(null!==(a=null==e?void 0:e.tags)&&void 0!==a?a:[])),function(t){if(Array.isArray(t))return g(t)}(f)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(f)||b(f)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),extra:{metadata:h(h({},null===(u=s)||void 0===u||null===(u=u.extra)||void 0===u?void 0:u.metadata),null==e?void 0:e.metadata)}}).createChild(r):new t(h(h({},r),{},{client:l,tracingEnabled:d,project_name:c}))}},{key:"fromDottedOrder",value:function(t){return this.fromHeaders({"langsmith-trace":t})}},{key:"fromHeaders",value:function(e,r){var n,o,i,a,u="get"in e&&"function"==typeof e.get?{"langsmith-trace":e.get("langsmith-trace"),baggage:e.get("baggage")}:e,s=u["langsmith-trace"];if(s&&"string"==typeof s){var c=s.trim(),l=c.split(".").map((function(t){var e=v(t.split("Z"),2),r=e[0],n=e[1];return{strTime:r,time:Date.parse(r+"Z"),uuid:n}})),f=l[0].uuid,p=h(h({},r),{},{name:null!==(n=null==r?void 0:r.name)&&void 0!==n?n:"parent",run_type:null!==(o=null==r?void 0:r.run_type)&&void 0!==o?o:"chain",start_time:null!==(i=null==r?void 0:r.start_time)&&void 0!==i?i:Date.now(),id:null===(a=l.at(-1))||void 0===a?void 0:a.uuid,trace_id:f,dotted_order:c});if(u.baggage&&"string"==typeof u.baggage){var d=O.fromHeader(u.baggage);p.metadata=d.metadata,p.tags=d.tags}return new t(p)}}}]);var e,r,l}();function j(t){return void 0!==t&&"function"==typeof t.createChild&&"function"==typeof t.postRun}function S(t){return"object"===y(t)&&null!=t&&"string"==typeof t.name&&"langchain_tracer"===t.name}function A(t){return Array.isArray(t)&&t.some((function(t){return S(t)}))}Object.defineProperty(k,"sharedClient",{enumerable:!0,configurable:!0,writable:!0,value:null})},3180:(t,e,r)=>{"use strict";r.d(e,{Y:()=>i});var n=function(){return fetch.apply(void 0,arguments)},o=Symbol.for("ls:fetch_implementation"),i=function(){var t;return null!==(t=globalThis[o])&&void 0!==t?t:n}},5704:(t,e,r)=>{"use strict";r.d(e,{Az:()=>v,Ec:()=>d,Jz:()=>m,yk:()=>y});var n,o=r(4797);function i(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],s=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);s=!0);}catch(t){c=!0,o=t}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(t,e)||function(t,e){if(t){if("string"==typeof t)return a(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function u(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function s(t,e,r){return(e=function(t){var e=function(t){if("object"!=c(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=c(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==c(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}var l,f,p=function(){return"undefined"!=typeof Deno},h=function(){return n||(n="undefined"!=typeof window&&void 0!==window.document?"browser":"undefined"==typeof process||void 0===process.versions||void 0===process.versions.node||p()?"object"===("undefined"==typeof globalThis?"undefined":c(globalThis))&&globalThis.constructor&&"DedicatedWorkerGlobalScope"===globalThis.constructor.name?"webworker":"undefined"!=typeof window&&"nodejs"===window.name||"undefined"!=typeof navigator&&(navigator.userAgent.includes("Node.js")||navigator.userAgent.includes("jsdom"))?"jsdom":p()?"deno":"other":"node")};function d(){if(void 0===l){var t=h(),e=function(){if(void 0!==f)return f;for(var t={},e=0,r=["VERCEL_GIT_COMMIT_SHA","NEXT_PUBLIC_VERCEL_GIT_COMMIT_SHA","COMMIT_REF","RENDER_GIT_COMMIT","CI_COMMIT_SHA","CIRCLE_SHA1","CF_PAGES_COMMIT_SHA","REACT_APP_GIT_SHA","SOURCE_VERSION","GITHUB_SHA","TRAVIS_COMMIT","GIT_COMMIT","BUILD_VCS_NUMBER","bamboo_planRepository_revision","Build.SourceVersion","BITBUCKET_COMMIT","DRONE_COMMIT_SHA","SEMAPHORE_GIT_SHA","BUILDKITE_COMMIT"];e<r.length;e++){var n=r[e],o=v(n);void 0!==o&&(t[n]=o)}return f=t,t}();l=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?u(Object(r),!0).forEach((function(e){s(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({library:"langsmith",runtime:t,sdk:"langsmith-js",sdk_version:o.Ls},e)}return l}function y(){for(var t=function(){try{return"undefined"!=typeof process&&process.env?Object.entries(process.env).reduce((function(t,e){var r=i(e,2),n=r[0],o=r[1];return t[n]=String(o),t}),{}):void 0}catch(t){return}}()||{},e={},r=["LANGCHAIN_API_KEY","LANGCHAIN_ENDPOINT","LANGCHAIN_TRACING_V2","LANGCHAIN_PROJECT","LANGCHAIN_SESSION"],n=0,o=Object.entries(t);n<o.length;n++){var a=i(o[n],2),u=a[0],s=a[1];!u.startsWith("LANGCHAIN_")||"string"!=typeof s||r.includes(u)||u.toLowerCase().includes("key")||u.toLowerCase().includes("secret")||u.toLowerCase().includes("token")||("LANGCHAIN_REVISION_ID"===u?e.revision_id=s:e[u]=s)}return e}function v(t){try{var e;return"undefined"!=typeof process?null===(e=process.env)||void 0===e?void 0:e[t]:void 0}catch(t){return}}function m(t){return v("LANGSMITH_".concat(t))||v("LANGCHAIN_".concat(t))}},6991:(t,e,r)=>{"use strict";r.d(e,{m:()=>o});var n={};function o(t){n[t]||(console.warn(t),n[t]=!0)}},3836:(t,e,r)=>{"use strict";r.d(e,{Kj:()=>n.Kj,gk:()=>n.gk});var n=r(4797)},8956:(t,e,r)=>{"use strict";r.d(e,{vR:()=>h,GZ:()=>d});var n=r(2877);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,s(n.key),n)}}function u(t,e,r){return e&&a(t.prototype,e),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function s(t){var e=function(t){if("object"!=o(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==o(e)?e:e+""}var c=function(){return u((function t(){i(this,t)}),[{key:"getStore",value:function(){}},{key:"run",value:function(t,e){return e()}}])}(),l=Symbol.for("ls:tracing_async_local_storage"),f=new c,p=new(function(){return u((function t(){i(this,t)}),[{key:"getInstance",value:function(){var t;return null!==(t=globalThis[l])&&void 0!==t?t:f}},{key:"initializeGlobalInstance",value:function(t){void 0===globalThis[l]&&(globalThis[l]=t)}}])}()),h=function(){var t=p.getInstance().getStore();if(!(0,n.m5)(t))throw new Error(["Could not get the current run tree.","","Please make sure you are calling this method within a traceable function or the tracing is enabled."].join("\n"));return t};function d(t){return"function"==typeof t&&"langsmith:traceable"in t}Symbol.for("langsmith:traceable:root")},1236:(t,e,r)=>{"use strict";function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function i(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?o(Object(r),!0).forEach((function(e){a(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function a(t,e,r){return(e=function(t){var e=function(t){if("object"!=n(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==n(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}r.d(e,{Ik:()=>Ce});var u=Symbol("Let zodToJsonSchema decide on which parser to use"),s={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"};function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function l(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function f(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?l(Object(r),!0).forEach((function(e){p(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function p(t,e,r){return(e=function(t){var e=function(t){if("object"!=c(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=c(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==c(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function h(t){return function(t){if(Array.isArray(t))return y(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||d(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(t,e){if(t){if("string"==typeof t)return y(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?y(t,e):void 0}}function y(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var v=function(t){var e=function(t){return"string"==typeof t?i(i({},s),{},{name:t}):i(i({},s),t)}(t),r=void 0!==e.name?[].concat(h(e.basePath),[e.definitionPath,e.name]):e.basePath;return f(f({},e),{},{currentPath:r,propertyPath:void 0,seen:new Map(Object.entries(e.definitions).map((function(t){var r,n,o=(n=2,function(t){if(Array.isArray(t))return t}(r=t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],s=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);s=!0);}catch(t){c=!0,o=t}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(r,n)||d(r,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=o[0],a=o[1];return[a._def,{def:a._def,path:[].concat(h(e.basePath),[e.definitionPath,i]),jsonSchema:void 0}]})))})},m=r(4476);function b(t){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b(t)}function g(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function w(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?g(Object(r),!0).forEach((function(e){x(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function x(t,e,r){return(e=function(t){var e=function(t){if("object"!=b(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=b(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==b(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _(t,e,r,n){null!=n&&n.errorMessages&&r&&(t.errorMessage=w(w({},t.errorMessage),{},x({},e,r)))}function E(t,e,r,n,o){t[e]=r,_(t,e,n,o)}function O(t){return O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},O(t)}function k(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function j(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function S(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?j(Object(r),!0).forEach((function(e){A(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):j(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function A(t,e,r){return(e=function(t){var e=function(t){if("object"!=O(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=O(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==O(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function D(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function P(t,e){return ge(t.type._def,e)}function C(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function L(t,e,r){var n=null!=r?r:e.dateStrategy;if(Array.isArray(n))return{anyOf:n.map((function(r,n){return L(t,e,r)}))};switch(n){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return T(t,e)}}var T=function(t,e){var r={type:"integer",format:"unix-time"};if("openApi3"===e.target)return r;var n,o=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return C(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?C(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}(t.checks);try{for(o.s();!(n=o.n()).done;){var i=n.value;switch(i.kind){case"min":E(r,"minimum",i.value,i.message,e);break;case"max":E(r,"maximum",i.value,i.message,e)}}}catch(t){o.e(t)}finally{o.f()}return r};function F(t){return F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},F(t)}function I(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function N(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?I(Object(r),!0).forEach((function(e){R(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):I(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function R(t,e,r){return(e=function(t){var e=function(t){if("object"!=F(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=F(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==F(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var M,B=["additionalProperties"];function G(t){return G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},G(t)}function U(t){return function(t){if(Array.isArray(t))return z(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return z(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?z(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function z(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function $(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function q(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?$(Object(r),!0).forEach((function(e){K(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):$(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function K(t,e,r){return(e=function(t){var e=function(t){if("object"!=G(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=G(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==G(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function H(t){return H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},H(t)}function Z(t){return Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Z(t)}function Y(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function V(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Y(Object(r),!0).forEach((function(e){W(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Y(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function W(t,e,r){return(e=function(t){var e=function(t){if("object"!=Z(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Z(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Z(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function J(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var X=/^[cC][^\s-]{8,}$/,Q=/^[0-9a-z]+$/,tt=/^[0-9A-HJKMNP-TV-Z]{26}$/,et=/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,rt=function(){return void 0===M&&(M=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),M},nt=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,ot=/^[a-zA-Z0-9_-]{21}$/;function it(t,e){var r={type:"string"};function n(t){return"escape"===e.patternStrategy?at(t):t}if(t.checks){var o,i=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return J(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?J(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}(t.checks);try{for(i.s();!(o=i.n()).done;){var a=o.value;switch(a.kind){case"min":E(r,"minLength","number"==typeof r.minLength?Math.max(r.minLength,a.value):a.value,a.message,e);break;case"max":E(r,"maxLength","number"==typeof r.maxLength?Math.min(r.maxLength,a.value):a.value,a.message,e);break;case"email":switch(e.emailStrategy){case"format:email":ut(r,"email",a.message,e);break;case"format:idn-email":ut(r,"idn-email",a.message,e);break;case"pattern:zod":st(r,et,a.message,e)}break;case"url":ut(r,"uri",a.message,e);break;case"uuid":ut(r,"uuid",a.message,e);break;case"regex":st(r,a.regex,a.message,e);break;case"cuid":st(r,X,a.message,e);break;case"cuid2":st(r,Q,a.message,e);break;case"startsWith":st(r,RegExp("^".concat(n(a.value))),a.message,e);break;case"endsWith":st(r,RegExp("".concat(n(a.value),"$")),a.message,e);break;case"datetime":ut(r,"date-time",a.message,e);break;case"date":ut(r,"date",a.message,e);break;case"time":ut(r,"time",a.message,e);break;case"duration":ut(r,"duration",a.message,e);break;case"length":E(r,"minLength","number"==typeof r.minLength?Math.max(r.minLength,a.value):a.value,a.message,e),E(r,"maxLength","number"==typeof r.maxLength?Math.min(r.maxLength,a.value):a.value,a.message,e);break;case"includes":st(r,RegExp(n(a.value)),a.message,e);break;case"ip":"v6"!==a.version&&ut(r,"ipv4",a.message,e),"v4"!==a.version&&ut(r,"ipv6",a.message,e);break;case"emoji":st(r,rt,a.message,e);break;case"ulid":st(r,tt,a.message,e);break;case"base64":switch(e.base64Strategy){case"format:binary":ut(r,"binary",a.message,e);break;case"contentEncoding:base64":E(r,"contentEncoding","base64",a.message,e);break;case"pattern:zod":st(r,nt,a.message,e)}break;case"nanoid":st(r,ot,a.message,e)}}}catch(t){i.e(t)}finally{i.f()}}return r}var at=function(t){return Array.from(t).map((function(t){return/[a-zA-Z0-9]/.test(t)?t:"\\".concat(t)})).join("")},ut=function(t,e,r,n){var o;t.format||null!==(o=t.anyOf)&&void 0!==o&&o.some((function(t){return t.format}))?(t.anyOf||(t.anyOf=[]),t.format&&(t.anyOf.push(V({format:t.format},t.errorMessage&&n.errorMessages&&{errorMessage:{format:t.errorMessage.format}})),delete t.format,t.errorMessage&&(delete t.errorMessage.format,0===Object.keys(t.errorMessage).length&&delete t.errorMessage)),t.anyOf.push(V({format:e},r&&n.errorMessages&&{errorMessage:{format:r}}))):E(t,"format",e,r,n)},st=function(t,e,r,n){var o;t.pattern||null!==(o=t.allOf)&&void 0!==o&&o.some((function(t){return t.pattern}))?(t.allOf||(t.allOf=[]),t.pattern&&(t.allOf.push(V({pattern:t.pattern},t.errorMessage&&n.errorMessages&&{errorMessage:{pattern:t.errorMessage.pattern}})),delete t.pattern,t.errorMessage&&(delete t.errorMessage.pattern,0===Object.keys(t.errorMessage).length&&delete t.errorMessage)),t.allOf.push(V({pattern:ct(e,n)},r&&n.errorMessages&&{errorMessage:{pattern:r}}))):E(t,"pattern",ct(e,n),r,n)},ct=function(t,e){var r="function"==typeof t?t():t;if(!e.applyRegexFlags||!r.flags)return r.source;for(var n=r.flags.includes("i"),o=r.flags.includes("m"),i=r.flags.includes("s"),a=n?r.source.toLowerCase():r.source,u="",s=!1,c=!1,l=!1,f=0;f<a.length;f++)if(s)u+=a[f],s=!1;else{if(n)if(c){if(a[f].match(/[a-z]/)){var p;l?(u+=a[f],u+="".concat(a[f-2],"-").concat(a[f]).toUpperCase(),l=!1):"-"===a[f+1]&&null!==(p=a[f+2])&&void 0!==p&&p.match(/[a-z]/)?(u+=a[f],l=!0):u+="".concat(a[f]).concat(a[f].toUpperCase());continue}}else if(a[f].match(/[a-z]/)){u+="[".concat(a[f]).concat(a[f].toUpperCase(),"]");continue}if(o){if("^"===a[f]){u+="(^|(?<=[\r\n]))";continue}if("$"===a[f]){u+="($|(?=[\r\n]))";continue}}i&&"."===a[f]?u+=c?"".concat(a[f],"\r\n"):"[".concat(a[f],"\r\n]"):(u+=a[f],"\\"===a[f]?s=!0:c&&"]"===a[f]?c=!1:c||"["!==a[f]||(c=!0))}try{new RegExp(u)}catch(t){return console.warn("Could not convert regex pattern at ".concat(e.currentPath.join("/")," to a flag-independent form! Falling back to the flag-ignorant source")),r.source}return u},lt=["type"],ft=["type"];function pt(t){return pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pt(t)}function ht(t,e){if(null==t)return{};var r,n,o=function(t,e){if(null==t)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.includes(n))continue;r[n]=t[n]}return r}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.includes(r)||{}.propertyIsEnumerable.call(t,r)&&(o[r]=t[r])}return o}function dt(t){return function(t){if(Array.isArray(t))return yt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return yt(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?yt(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function yt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function vt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function mt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?vt(Object(r),!0).forEach((function(e){bt(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):vt(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function bt(t,e,r){return(e=function(t){var e=function(t){if("object"!=pt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=pt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==pt(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function gt(t,e){var r,n,o,i,a,u,s;if("openApi3"===e.target&&(null===(r=t.keyType)||void 0===r?void 0:r._def.typeName)===m.kY.ZodEnum)return{type:"object",required:t.keyType._def.values,properties:t.keyType._def.values.reduce((function(r,n){var o;return mt(mt({},r),{},bt({},n,null!==(o=ge(t.valueType._def,mt(mt({},e),{},{currentPath:[].concat(dt(e.currentPath),["properties",n])})))&&void 0!==o?o:{}))}),{}),additionalProperties:!1};var c={type:"object",additionalProperties:null!==(n=ge(t.valueType._def,mt(mt({},e),{},{currentPath:[].concat(dt(e.currentPath),["additionalProperties"])})))&&void 0!==n?n:{}};if("openApi3"===e.target)return c;if((null===(o=t.keyType)||void 0===o?void 0:o._def.typeName)===m.kY.ZodString&&null!==(i=t.keyType._def.checks)&&void 0!==i&&i.length){var l=it(t.keyType._def,e),f=(l.type,ht(l,lt));return mt(mt({},c),{},{propertyNames:f})}if((null===(a=t.keyType)||void 0===a?void 0:a._def.typeName)===m.kY.ZodEnum)return mt(mt({},c),{},{propertyNames:{enum:t.keyType._def.values}});if((null===(u=t.keyType)||void 0===u?void 0:u._def.typeName)===m.kY.ZodBranded&&t.keyType._def.type._def.typeName===m.kY.ZodString&&null!==(s=t.keyType._def.type._def.checks)&&void 0!==s&&s.length){var p=P(t.keyType._def,e),h=(p.type,ht(p,ft));return mt(mt({},c),{},{propertyNames:h})}return c}function wt(t){return wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wt(t)}function xt(t){return function(t){if(Array.isArray(t))return _t(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return _t(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_t(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _t(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Et(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Ot(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Et(Object(r),!0).forEach((function(e){kt(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Et(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function kt(t,e,r){return(e=function(t){var e=function(t){if("object"!=wt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=wt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==wt(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function jt(t){return jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jt(t)}function St(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function At(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?St(Object(r),!0).forEach((function(e){Dt(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):St(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Dt(t,e,r){return(e=function(t){var e=function(t){if("object"!=Pt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Pt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Pt(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Pt(t){return Pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pt(t)}function Ct(t){return function(t){if(Array.isArray(t))return Lt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Lt(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Lt(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Lt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var Tt={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"},Ft=function(t,e){var r=(t.options instanceof Map?Array.from(t.options.values()):t.options).map((function(t,r){return ge(t._def,At(At({},e),{},{currentPath:[].concat(Ct(e.currentPath),["anyOf","".concat(r)])}))})).filter((function(t){return!!t&&(!e.strictUnions||"object"===Pt(t)&&Object.keys(t).length>0)}));return r.length?{anyOf:r}:void 0};function It(t){return It="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},It(t)}function Nt(t){return function(t){if(Array.isArray(t))return Rt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Rt(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Rt(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Rt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Mt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Bt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Mt(Object(r),!0).forEach((function(e){Gt(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Mt(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Gt(t,e,r){return(e=function(t){var e=function(t){if("object"!=It(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=It(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==It(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ut(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function zt(t){return zt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zt(t)}function $t(t){return function(t){if(Array.isArray(t))return Kt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||qt(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function qt(t,e){if(t){if("string"==typeof t)return Kt(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Kt(t,e):void 0}}function Kt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Ht(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Zt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Ht(Object(r),!0).forEach((function(e){Yt(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ht(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Yt(t,e,r){return(e=function(t){var e=function(t){if("object"!=zt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=zt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==zt(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Vt(t,e){var r,n;return"strict"===e.removeAdditionalStrategy?"ZodNever"===t.catchall._def.typeName?"strict"!==t.unknownKeys:null===(r=ge(t.catchall._def,Zt(Zt({},e),{},{currentPath:[].concat($t(e.currentPath),["additionalProperties"])})))||void 0===r||r:"ZodNever"===t.catchall._def.typeName?"passthrough"===t.unknownKeys:null===(n=ge(t.catchall._def,Zt(Zt({},e),{},{currentPath:[].concat($t(e.currentPath),["additionalProperties"])})))||void 0===n||n}function Wt(t){return Wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wt(t)}function Jt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Xt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Qt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Xt(Object(r),!0).forEach((function(e){te(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Xt(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function te(t,e,r){return(e=function(t){var e=function(t){if("object"!=Wt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Wt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Wt(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ee(t){return ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ee(t)}function re(t){return function(t){if(Array.isArray(t))return ne(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return ne(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ne(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ne(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function oe(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function ie(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?oe(Object(r),!0).forEach((function(e){ae(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):oe(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function ae(t,e,r){return(e=function(t){var e=function(t){if("object"!=ee(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=ee(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ee(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ue(t){return ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ue(t)}function se(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function ce(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function le(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ce(Object(r),!0).forEach((function(e){fe(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ce(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function fe(t,e,r){return(e=function(t){var e=function(t){if("object"!=ue(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=ue(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ue(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pe(t){return pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pe(t)}function he(t){return function(t){if(Array.isArray(t))return de(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return de(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?de(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function de(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function ye(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function ve(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ye(Object(r),!0).forEach((function(e){me(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ye(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function me(t,e,r){return(e=function(t){var e=function(t){if("object"!=pe(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=pe(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==pe(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function be(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function ge(t,e){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=e.seen.get(t);if(e.override){var o,i=null===(o=e.override)||void 0===o?void 0:o.call(e,t,e,n,r);if(i!==u)return i}if(n&&!r){var a=we(n,e);if(void 0!==a)return a}var s={def:t,path:e.currentPath,jsonSchema:void 0};e.seen.set(t,s);var c=_e(t,t.typeName,e);return c&&Ee(t,e,c),s.jsonSchema=c,c}var we=function(t,e){switch(e.$refStrategy){case"root":return{$ref:t.path.join("/")};case"relative":return{$ref:xe(e.currentPath,t.path)};case"none":case"seen":return t.path.length<e.currentPath.length&&t.path.every((function(t,r){return e.currentPath[r]===t}))?(console.warn("Recursive reference detected at ".concat(e.currentPath.join("/"),"! Defaulting to any")),{}):"seen"===e.$refStrategy?{}:void 0}},xe=function(t,e){for(var r=0;r<t.length&&r<e.length&&t[r]===e[r];r++);return[(t.length-r).toString()].concat((n=e.slice(r),function(t){if(Array.isArray(t))return be(t)}(n)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(n)||function(t,e){if(t){if("string"==typeof t)return be(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?be(t,e):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())).join("/");var n},_e=function(t,e,r){switch(e){case m.kY.ZodString:return it(t,r);case m.kY.ZodNumber:return function(t,e){var r={type:"number"};if(!t.checks)return r;var n,o=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return Ut(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ut(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}(t.checks);try{for(o.s();!(n=o.n()).done;){var i=n.value;switch(i.kind){case"int":r.type="integer",_(r,"type",i.message,e);break;case"min":"jsonSchema7"===e.target?i.inclusive?E(r,"minimum",i.value,i.message,e):E(r,"exclusiveMinimum",i.value,i.message,e):(i.inclusive||(r.exclusiveMinimum=!0),E(r,"minimum",i.value,i.message,e));break;case"max":"jsonSchema7"===e.target?i.inclusive?E(r,"maximum",i.value,i.message,e):E(r,"exclusiveMaximum",i.value,i.message,e):(i.inclusive||(r.exclusiveMaximum=!0),E(r,"maximum",i.value,i.message,e));break;case"multipleOf":E(r,"multipleOf",i.value,i.message,e)}}}catch(t){o.e(t)}finally{o.f()}return r}(t,r);case m.kY.ZodObject:return function(t,e){var r=Zt(Zt({type:"object"},Object.entries(t.shape()).reduce((function(t,r){var n,o,i=(o=2,function(t){if(Array.isArray(t))return t}(n=r)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],s=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);s=!0);}catch(t){c=!0,o=t}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(n,o)||qt(n,o)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),a=i[0],u=i[1];if(void 0===u||void 0===u._def)return t;var s=ge(u._def,Zt(Zt({},e),{},{currentPath:[].concat($t(e.currentPath),["properties",a]),propertyPath:[].concat($t(e.currentPath),["properties",a])}));return void 0===s?t:{properties:Zt(Zt({},t.properties),{},Yt({},a,s)),required:u.isOptional()?t.required:[].concat($t(t.required),[a])}}),{properties:{},required:[]})),{},{additionalProperties:Vt(t,e)});return r.required.length||delete r.required,r}(t,r);case m.kY.ZodBigInt:return function(t,e){var r={type:"integer",format:"int64"};if(!t.checks)return r;var n,o=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return D(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?D(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}(t.checks);try{for(o.s();!(n=o.n()).done;){var i=n.value;switch(i.kind){case"min":"jsonSchema7"===e.target?i.inclusive?E(r,"minimum",i.value,i.message,e):E(r,"exclusiveMinimum",i.value,i.message,e):(i.inclusive||(r.exclusiveMinimum=!0),E(r,"minimum",i.value,i.message,e));break;case"max":"jsonSchema7"===e.target?i.inclusive?E(r,"maximum",i.value,i.message,e):E(r,"exclusiveMaximum",i.value,i.message,e):(i.inclusive||(r.exclusiveMaximum=!0),E(r,"maximum",i.value,i.message,e));break;case"multipleOf":E(r,"multipleOf",i.value,i.message,e)}}}catch(t){o.e(t)}finally{o.f()}return r}(t,r);case m.kY.ZodBoolean:return{type:"boolean"};case m.kY.ZodDate:return L(t,r);case m.kY.ZodUndefined:return{not:{}};case m.kY.ZodNull:return function(t){return"openApi3"===t.target?{enum:["null"],nullable:!0}:{type:"null"}}(r);case m.kY.ZodArray:return function(t,e){var r,n,o,i={type:"array"};return null!==(r=t.type)&&void 0!==r&&r._def&&(null===(n=t.type)||void 0===n||null===(n=n._def)||void 0===n?void 0:n.typeName)!==m.kY.ZodAny&&(i.items=ge(t.type._def,S(S({},e),{},{currentPath:[].concat((o=e.currentPath,function(t){if(Array.isArray(t))return k(t)}(o)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(o)||function(t,e){if(t){if("string"==typeof t)return k(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?k(t,e):void 0}}(o)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),["items"])}))),t.minLength&&E(i,"minItems",t.minLength.value,t.minLength.message,e),t.maxLength&&E(i,"maxItems",t.maxLength.value,t.maxLength.message,e),t.exactLength&&(E(i,"minItems",t.exactLength.value,t.exactLength.message,e),E(i,"maxItems",t.exactLength.value,t.exactLength.message,e)),i}(t,r);case m.kY.ZodUnion:case m.kY.ZodDiscriminatedUnion:return function(t,e){if("openApi3"===e.target)return Ft(t,e);var r=t.options instanceof Map?Array.from(t.options.values()):t.options;if(r.every((function(t){return t._def.typeName in Tt&&(!t._def.checks||!t._def.checks.length)}))){var n=r.reduce((function(t,e){var r=Tt[e._def.typeName];return r&&!t.includes(r)?[].concat(Ct(t),[r]):t}),[]);return{type:n.length>1?n:n[0]}}if(r.every((function(t){return"ZodLiteral"===t._def.typeName&&!t.description}))){var o=r.reduce((function(t,e){var r=Pt(e._def.value);switch(r){case"string":case"number":case"boolean":return[].concat(Ct(t),[r]);case"bigint":return[].concat(Ct(t),["integer"]);case"object":if(null===e._def.value)return[].concat(Ct(t),["null"]);default:return t}}),[]);if(o.length===r.length){var i=o.filter((function(t,e,r){return r.indexOf(t)===e}));return{type:i.length>1?i:i[0],enum:r.reduce((function(t,e){return t.includes(e._def.value)?t:[].concat(Ct(t),[e._def.value])}),[])}}}else if(r.every((function(t){return"ZodEnum"===t._def.typeName})))return{type:"string",enum:r.reduce((function(t,e){return[].concat(Ct(t),Ct(e._def.values.filter((function(e){return!t.includes(e)}))))}),[])};return Ft(t,e)}(t,r);case m.kY.ZodIntersection:return function(t,e){var r=[ge(t.left._def,q(q({},e),{},{currentPath:[].concat(U(e.currentPath),["allOf","0"])})),ge(t.right._def,q(q({},e),{},{currentPath:[].concat(U(e.currentPath),["allOf","1"])}))].filter((function(t){return!!t})),n="jsonSchema2019-09"===e.target?{unevaluatedProperties:!1}:void 0,o=[];return r.forEach((function(t){if("type"in(r=t)&&"string"===r.type||!("allOf"in r)){var e=t;"additionalProperties"in t&&!1===t.additionalProperties?(t.additionalProperties,e=function(t,e){if(null==t)return{};var r,n,o=function(t,e){if(null==t)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.includes(n))continue;r[n]=t[n]}return r}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.includes(r)||{}.propertyIsEnumerable.call(t,r)&&(o[r]=t[r])}return o}(t,B)):n=void 0,o.push(e)}else o.push.apply(o,U(t.allOf)),void 0===t.unevaluatedProperties&&(n=void 0);var r})),o.length?q({allOf:o},n):void 0}(t,r);case m.kY.ZodTuple:return function(t,e){return t.rest?{type:"array",minItems:t.items.length,items:t.items.map((function(t,r){return ge(t._def,ve(ve({},e),{},{currentPath:[].concat(he(e.currentPath),["items","".concat(r)])}))})).reduce((function(t,e){return void 0===e?t:[].concat(he(t),[e])}),[]),additionalItems:ge(t.rest._def,ve(ve({},e),{},{currentPath:[].concat(he(e.currentPath),["additionalItems"])}))}:{type:"array",minItems:t.items.length,maxItems:t.items.length,items:t.items.map((function(t,r){return ge(t._def,ve(ve({},e),{},{currentPath:[].concat(he(e.currentPath),["items","".concat(r)])}))})).reduce((function(t,e){return void 0===e?t:[].concat(he(t),[e])}),[])}}(t,r);case m.kY.ZodRecord:return gt(t,r);case m.kY.ZodLiteral:return function(t,e){var r=H(t.value);return"bigint"!==r&&"number"!==r&&"boolean"!==r&&"string"!==r?{type:Array.isArray(t.value)?"array":"object"}:"openApi3"===e.target?{type:"bigint"===r?"integer":r,enum:[t.value]}:{type:"bigint"===r?"integer":r,const:t.value}}(t,r);case m.kY.ZodEnum:return function(t){return{type:"string",enum:t.values}}(t);case m.kY.ZodNativeEnum:return function(t){var e=t.values,r=Object.keys(t.values).filter((function(t){return"number"!=typeof e[e[t]]})).map((function(t){return e[t]})),n=Array.from(new Set(r.map((function(t){return jt(t)}))));return{type:1===n.length?"string"===n[0]?"string":"number":["string","number"],enum:r}}(t);case m.kY.ZodNullable:return function(t,e){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(t.innerType._def.typeName)&&(!t.innerType._def.checks||!t.innerType._def.checks.length))return"openApi3"===e.target?{type:Tt[t.innerType._def.typeName],nullable:!0}:{type:[Tt[t.innerType._def.typeName],"null"]};if("openApi3"===e.target){var r=ge(t.innerType._def,Bt(Bt({},e),{},{currentPath:Nt(e.currentPath)}));return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&Bt(Bt({},r),{},{nullable:!0})}var n=ge(t.innerType._def,Bt(Bt({},e),{},{currentPath:[].concat(Nt(e.currentPath),["anyOf","0"])}));return n&&{anyOf:[n,{type:"null"}]}}(t,r);case m.kY.ZodOptional:return function(t,e){var r;if(e.currentPath.toString()===(null===(r=e.propertyPath)||void 0===r?void 0:r.toString()))return ge(t.innerType._def,e);var n,o=ge(t.innerType._def,Qt(Qt({},e),{},{currentPath:[].concat((n=e.currentPath,function(t){if(Array.isArray(t))return Jt(t)}(n)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(n)||function(t,e){if(t){if("string"==typeof t)return Jt(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Jt(t,e):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),["anyOf","1"])}));return o?{anyOf:[{not:{}},o]}:{}}(t,r);case m.kY.ZodMap:return function(t,e){return"record"===e.mapStrategy?gt(t,e):{type:"array",maxItems:125,items:{type:"array",items:[ge(t.keyType._def,Ot(Ot({},e),{},{currentPath:[].concat(xt(e.currentPath),["items","items","0"])}))||{},ge(t.valueType._def,Ot(Ot({},e),{},{currentPath:[].concat(xt(e.currentPath),["items","items","1"])}))||{}],minItems:2,maxItems:2}}}(t,r);case m.kY.ZodSet:return function(t,e){var r,n={type:"array",uniqueItems:!0,items:ge(t.valueType._def,le(le({},e),{},{currentPath:[].concat((r=e.currentPath,function(t){if(Array.isArray(t))return se(t)}(r)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(r)||function(t,e){if(t){if("string"==typeof t)return se(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?se(t,e):void 0}}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),["items"])}))};return t.minSize&&E(n,"minItems",t.minSize.value,t.minSize.message,e),t.maxSize&&E(n,"maxItems",t.maxSize.value,t.maxSize.message,e),n}(t,r);case m.kY.ZodLazy:return ge(t.getter()._def,r);case m.kY.ZodPromise:return function(t,e){return ge(t.type._def,e)}(t,r);case m.kY.ZodNaN:case m.kY.ZodNever:return{not:{}};case m.kY.ZodEffects:return function(t,e){return"input"===e.effectStrategy?ge(t.schema._def,e):{}}(t,r);case m.kY.ZodAny:case m.kY.ZodUnknown:return{};case m.kY.ZodDefault:return function(t,e){return N(N({},ge(t.innerType._def,e)),{},{default:t.defaultValue()})}(t,r);case m.kY.ZodBranded:return P(t,r);case m.kY.ZodReadonly:case m.kY.ZodCatch:return function(t,e){return ge(t.innerType._def,e)}(t,r);case m.kY.ZodPipeline:return function(t,e){if("input"===e.pipeStrategy)return ge(t.in._def,e);if("output"===e.pipeStrategy)return ge(t.out._def,e);var r=ge(t.in._def,ie(ie({},e),{},{currentPath:[].concat(re(e.currentPath),["allOf","0"])}));return{allOf:[r,ge(t.out._def,ie(ie({},e),{},{currentPath:[].concat(re(e.currentPath),["allOf",r?"1":"0"])}))].filter((function(t){return void 0!==t}))}}(t,r);case m.kY.ZodFunction:case m.kY.ZodVoid:case m.kY.ZodSymbol:default:return}},Ee=function(t,e,r){return t.description&&(r.description=t.description,e.markdownDescription&&(r.markdownDescription=t.description)),r};function Oe(t){return function(t){if(Array.isArray(t))return De(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Ae(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ke(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function je(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ke(Object(r),!0).forEach((function(e){Se(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ke(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Se(t,e,r){return(e=function(t){var e=function(t){if("object"!=Pe(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Pe(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Pe(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ae(t,e){if(t){if("string"==typeof t)return De(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?De(t,e):void 0}}function De(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Pe(t){return Pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pe(t)}var Ce=function(t,e){var r,n=v(e),o="object"===Pe(e)&&e.definitions?Object.entries(e.definitions).reduce((function(t,e){var r,o,i,a=(i=2,function(t){if(Array.isArray(t))return t}(o=e)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],s=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);s=!0);}catch(t){c=!0,o=t}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(o,i)||Ae(o,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),u=a[0],s=a[1];return je(je({},t),{},Se({},u,null!==(r=ge(s._def,je(je({},n),{},{currentPath:[].concat(Oe(n.basePath),[n.definitionPath,u])}),!0))&&void 0!==r?r:{}))}),{}):void 0,i="string"==typeof e?e:"title"===(null==e?void 0:e.nameStrategy)||null==e?void 0:e.name,a=null!==(r=ge(t._def,void 0===i?n:je(je({},n),{},{currentPath:[].concat(Oe(n.basePath),[n.definitionPath,i])}),!1))&&void 0!==r?r:{},u="object"===Pe(e)&&void 0!==e.name&&"title"===e.nameStrategy?e.name:void 0;void 0!==u&&(a.title=u);var s=void 0===i?o?je(je({},a),{},Se({},n.definitionPath,o)):a:Se({$ref:[].concat(Oe("relative"===n.$refStrategy?[]:n.basePath),[n.definitionPath,i]).join("/")},n.definitionPath,je(je({},o),{},Se({},i,a)));return"jsonSchema7"===n.target?s.$schema="http://json-schema.org/draft-07/schema#":"jsonSchema2019-09"===n.target&&(s.$schema="https://json-schema.org/draft/2019-09/schema#"),s}},4476:(t,e,r)=>{"use strict";var n,o;r.d(e,{kY:()=>Nt,z:()=>ge}),function(t){t.assertEqual=t=>t,t.assertIs=function(t){},t.assertNever=function(t){throw new Error},t.arrayToEnum=t=>{const e={};for(const r of t)e[r]=r;return e},t.getValidEnumValues=e=>{const r=t.objectKeys(e).filter((t=>"number"!=typeof e[e[t]])),n={};for(const t of r)n[t]=e[t];return t.objectValues(n)},t.objectValues=e=>t.objectKeys(e).map((function(t){return e[t]})),t.objectKeys="function"==typeof Object.keys?t=>Object.keys(t):t=>{const e=[];for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.push(r);return e},t.find=(t,e)=>{for(const r of t)if(e(r))return r},t.isInteger="function"==typeof Number.isInteger?t=>Number.isInteger(t):t=>"number"==typeof t&&isFinite(t)&&Math.floor(t)===t,t.joinValues=function(t,e=" | "){return t.map((t=>"string"==typeof t?`'${t}'`:t)).join(e)},t.jsonStringifyReplacer=(t,e)=>"bigint"==typeof e?e.toString():e}(n||(n={})),function(t){t.mergeShapes=(t,e)=>({...t,...e})}(o||(o={}));const i=n.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),a=t=>{switch(typeof t){case"undefined":return i.undefined;case"string":return i.string;case"number":return isNaN(t)?i.nan:i.number;case"boolean":return i.boolean;case"function":return i.function;case"bigint":return i.bigint;case"symbol":return i.symbol;case"object":return Array.isArray(t)?i.array:null===t?i.null:t.then&&"function"==typeof t.then&&t.catch&&"function"==typeof t.catch?i.promise:"undefined"!=typeof Map&&t instanceof Map?i.map:"undefined"!=typeof Set&&t instanceof Set?i.set:"undefined"!=typeof Date&&t instanceof Date?i.date:i.object;default:return i.unknown}},u=n.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class s extends Error{constructor(t){super(),this.issues=[],this.addIssue=t=>{this.issues=[...this.issues,t]},this.addIssues=(t=[])=>{this.issues=[...this.issues,...t]};const e=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,e):this.__proto__=e,this.name="ZodError",this.issues=t}get errors(){return this.issues}format(t){const e=t||function(t){return t.message},r={_errors:[]},n=t=>{for(const o of t.issues)if("invalid_union"===o.code)o.unionErrors.map(n);else if("invalid_return_type"===o.code)n(o.returnTypeError);else if("invalid_arguments"===o.code)n(o.argumentsError);else if(0===o.path.length)r._errors.push(e(o));else{let t=r,n=0;for(;n<o.path.length;){const r=o.path[n];n===o.path.length-1?(t[r]=t[r]||{_errors:[]},t[r]._errors.push(e(o))):t[r]=t[r]||{_errors:[]},t=t[r],n++}}};return n(this),r}static assert(t){if(!(t instanceof s))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,n.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(t=t=>t.message){const e={},r=[];for(const n of this.issues)n.path.length>0?(e[n.path[0]]=e[n.path[0]]||[],e[n.path[0]].push(t(n))):r.push(t(n));return{formErrors:r,fieldErrors:e}}get formErrors(){return this.flatten()}}s.create=t=>new s(t);const c=(t,e)=>{let r;switch(t.code){case u.invalid_type:r=t.received===i.undefined?"Required":`Expected ${t.expected}, received ${t.received}`;break;case u.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(t.expected,n.jsonStringifyReplacer)}`;break;case u.unrecognized_keys:r=`Unrecognized key(s) in object: ${n.joinValues(t.keys,", ")}`;break;case u.invalid_union:r="Invalid input";break;case u.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${n.joinValues(t.options)}`;break;case u.invalid_enum_value:r=`Invalid enum value. Expected ${n.joinValues(t.options)}, received '${t.received}'`;break;case u.invalid_arguments:r="Invalid function arguments";break;case u.invalid_return_type:r="Invalid function return type";break;case u.invalid_date:r="Invalid date";break;case u.invalid_string:"object"==typeof t.validation?"includes"in t.validation?(r=`Invalid input: must include "${t.validation.includes}"`,"number"==typeof t.validation.position&&(r=`${r} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?r=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?r=`Invalid input: must end with "${t.validation.endsWith}"`:n.assertNever(t.validation):r="regex"!==t.validation?`Invalid ${t.validation}`:"Invalid";break;case u.too_small:r="array"===t.type?`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:"string"===t.type?`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:"number"===t.type?`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:"date"===t.type?`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:"Invalid input";break;case u.too_big:r="array"===t.type?`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:"string"===t.type?`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:"number"===t.type?`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:"bigint"===t.type?`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:"date"===t.type?`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:"Invalid input";break;case u.custom:r="Invalid input";break;case u.invalid_intersection_types:r="Intersection results could not be merged";break;case u.not_multiple_of:r=`Number must be a multiple of ${t.multipleOf}`;break;case u.not_finite:r="Number must be finite";break;default:r=e.defaultError,n.assertNever(t)}return{message:r}};let l=c;function f(){return l}const p=t=>{const{data:e,path:r,errorMaps:n,issueData:o}=t,i=[...r,...o.path||[]],a={...o,path:i};if(void 0!==o.message)return{...o,path:i,message:o.message};let u="";const s=n.filter((t=>!!t)).slice().reverse();for(const t of s)u=t(a,{data:e,defaultError:u}).message;return{...o,path:i,message:u}};function h(t,e){const r=f(),n=p({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,r,r===c?void 0:c].filter((t=>!!t))});t.common.issues.push(n)}class d{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(t,e){const r=[];for(const n of e){if("aborted"===n.status)return y;"dirty"===n.status&&t.dirty(),r.push(n.value)}return{status:t.value,value:r}}static async mergeObjectAsync(t,e){const r=[];for(const t of e){const e=await t.key,n=await t.value;r.push({key:e,value:n})}return d.mergeObjectSync(t,r)}static mergeObjectSync(t,e){const r={};for(const n of e){const{key:e,value:o}=n;if("aborted"===e.status)return y;if("aborted"===o.status)return y;"dirty"===e.status&&t.dirty(),"dirty"===o.status&&t.dirty(),"__proto__"===e.value||void 0===o.value&&!n.alwaysSet||(r[e.value]=o.value)}return{status:t.value,value:r}}}const y=Object.freeze({status:"aborted"}),v=t=>({status:"dirty",value:t}),m=t=>({status:"valid",value:t}),b=t=>"aborted"===t.status,g=t=>"dirty"===t.status,w=t=>"valid"===t.status,x=t=>"undefined"!=typeof Promise&&t instanceof Promise;function _(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)}function E(t,e,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!o:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(t,r):o?o.value=r:e.set(t,r),r}var O,k,j;"function"==typeof SuppressedError&&SuppressedError,function(t){t.errToObj=t=>"string"==typeof t?{message:t}:t||{},t.toString=t=>"string"==typeof t?t:null==t?void 0:t.message}(O||(O={}));class S{constructor(t,e,r,n){this._cachedPath=[],this.parent=t,this.data=e,this._path=r,this._key=n}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const A=(t,e)=>{if(w(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const e=new s(t.common.issues);return this._error=e,this._error}}};function D(t){if(!t)return{};const{errorMap:e,invalid_type_error:r,required_error:n,description:o}=t;if(e&&(r||n))throw new Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');return e?{errorMap:e,description:o}:{errorMap:(e,o)=>{var i,a;const{message:u}=t;return"invalid_enum_value"===e.code?{message:null!=u?u:o.defaultError}:void 0===o.data?{message:null!==(i=null!=u?u:n)&&void 0!==i?i:o.defaultError}:"invalid_type"!==e.code?{message:o.defaultError}:{message:null!==(a=null!=u?u:r)&&void 0!==a?a:o.defaultError}},description:o}}class P{constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(t){return a(t.data)}_getOrReturnCtx(t,e){return e||{common:t.parent.common,data:t.data,parsedType:a(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new d,ctx:{common:t.parent.common,data:t.data,parsedType:a(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const e=this._parse(t);if(x(e))throw new Error("Synchronous parse encountered promise.");return e}_parseAsync(t){const e=this._parse(t);return Promise.resolve(e)}parse(t,e){const r=this.safeParse(t,e);if(r.success)return r.data;throw r.error}safeParse(t,e){var r;const n={common:{issues:[],async:null!==(r=null==e?void 0:e.async)&&void 0!==r&&r,contextualErrorMap:null==e?void 0:e.errorMap},path:(null==e?void 0:e.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:a(t)},o=this._parseSync({data:t,path:n.path,parent:n});return A(n,o)}async parseAsync(t,e){const r=await this.safeParseAsync(t,e);if(r.success)return r.data;throw r.error}async safeParseAsync(t,e){const r={common:{issues:[],contextualErrorMap:null==e?void 0:e.errorMap,async:!0},path:(null==e?void 0:e.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:a(t)},n=this._parse({data:t,path:r.path,parent:r}),o=await(x(n)?n:Promise.resolve(n));return A(r,o)}refine(t,e){const r=t=>"string"==typeof e||void 0===e?{message:e}:"function"==typeof e?e(t):e;return this._refinement(((e,n)=>{const o=t(e),i=()=>n.addIssue({code:u.custom,...r(e)});return"undefined"!=typeof Promise&&o instanceof Promise?o.then((t=>!!t||(i(),!1))):!!o||(i(),!1)}))}refinement(t,e){return this._refinement(((r,n)=>!!t(r)||(n.addIssue("function"==typeof e?e(r,n):e),!1)))}_refinement(t){return new Ot({schema:this,typeName:Nt.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}optional(){return kt.create(this,this._def)}nullable(){return jt.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return it.create(this,this._def)}promise(){return Et.create(this,this._def)}or(t){return st.create([this,t],this._def)}and(t){return pt.create(this,t,this._def)}transform(t){return new Ot({...D(this._def),schema:this,typeName:Nt.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const e="function"==typeof t?t:()=>t;return new St({...D(this._def),innerType:this,defaultValue:e,typeName:Nt.ZodDefault})}brand(){return new Ct({typeName:Nt.ZodBranded,type:this,...D(this._def)})}catch(t){const e="function"==typeof t?t:()=>t;return new At({...D(this._def),innerType:this,catchValue:e,typeName:Nt.ZodCatch})}describe(t){return new(0,this.constructor)({...this._def,description:t})}pipe(t){return Lt.create(this,t)}readonly(){return Tt.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const C=/^c[^\s-]{8,}$/i,L=/^[0-9a-z]+$/,T=/^[0-9A-HJKMNP-TV-Z]{26}$/,F=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,I=/^[a-z0-9_-]{21}$/i,N=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,R=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i;let M;const B=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,G=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,U=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,z="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",$=new RegExp(`^${z}$`);function q(t){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return t.precision?e=`${e}\\.\\d{${t.precision}}`:null==t.precision&&(e=`${e}(\\.\\d+)?`),e}function K(t){let e=`${z}T${q(t)}`;const r=[];return r.push(t.local?"Z?":"Z"),t.offset&&r.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${r.join("|")})`,new RegExp(`^${e}$`)}class H extends P{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==i.string){const e=this._getOrReturnCtx(t);return h(e,{code:u.invalid_type,expected:i.string,received:e.parsedType}),y}const e=new d;let r;for(const i of this._def.checks)if("min"===i.kind)t.data.length<i.value&&(r=this._getOrReturnCtx(t,r),h(r,{code:u.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),e.dirty());else if("max"===i.kind)t.data.length>i.value&&(r=this._getOrReturnCtx(t,r),h(r,{code:u.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),e.dirty());else if("length"===i.kind){const n=t.data.length>i.value,o=t.data.length<i.value;(n||o)&&(r=this._getOrReturnCtx(t,r),n?h(r,{code:u.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):o&&h(r,{code:u.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),e.dirty())}else if("email"===i.kind)R.test(t.data)||(r=this._getOrReturnCtx(t,r),h(r,{validation:"email",code:u.invalid_string,message:i.message}),e.dirty());else if("emoji"===i.kind)M||(M=new RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),M.test(t.data)||(r=this._getOrReturnCtx(t,r),h(r,{validation:"emoji",code:u.invalid_string,message:i.message}),e.dirty());else if("uuid"===i.kind)F.test(t.data)||(r=this._getOrReturnCtx(t,r),h(r,{validation:"uuid",code:u.invalid_string,message:i.message}),e.dirty());else if("nanoid"===i.kind)I.test(t.data)||(r=this._getOrReturnCtx(t,r),h(r,{validation:"nanoid",code:u.invalid_string,message:i.message}),e.dirty());else if("cuid"===i.kind)C.test(t.data)||(r=this._getOrReturnCtx(t,r),h(r,{validation:"cuid",code:u.invalid_string,message:i.message}),e.dirty());else if("cuid2"===i.kind)L.test(t.data)||(r=this._getOrReturnCtx(t,r),h(r,{validation:"cuid2",code:u.invalid_string,message:i.message}),e.dirty());else if("ulid"===i.kind)T.test(t.data)||(r=this._getOrReturnCtx(t,r),h(r,{validation:"ulid",code:u.invalid_string,message:i.message}),e.dirty());else if("url"===i.kind)try{new URL(t.data)}catch(n){r=this._getOrReturnCtx(t,r),h(r,{validation:"url",code:u.invalid_string,message:i.message}),e.dirty()}else"regex"===i.kind?(i.regex.lastIndex=0,i.regex.test(t.data)||(r=this._getOrReturnCtx(t,r),h(r,{validation:"regex",code:u.invalid_string,message:i.message}),e.dirty())):"trim"===i.kind?t.data=t.data.trim():"includes"===i.kind?t.data.includes(i.value,i.position)||(r=this._getOrReturnCtx(t,r),h(r,{code:u.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),e.dirty()):"toLowerCase"===i.kind?t.data=t.data.toLowerCase():"toUpperCase"===i.kind?t.data=t.data.toUpperCase():"startsWith"===i.kind?t.data.startsWith(i.value)||(r=this._getOrReturnCtx(t,r),h(r,{code:u.invalid_string,validation:{startsWith:i.value},message:i.message}),e.dirty()):"endsWith"===i.kind?t.data.endsWith(i.value)||(r=this._getOrReturnCtx(t,r),h(r,{code:u.invalid_string,validation:{endsWith:i.value},message:i.message}),e.dirty()):"datetime"===i.kind?K(i).test(t.data)||(r=this._getOrReturnCtx(t,r),h(r,{code:u.invalid_string,validation:"datetime",message:i.message}),e.dirty()):"date"===i.kind?$.test(t.data)||(r=this._getOrReturnCtx(t,r),h(r,{code:u.invalid_string,validation:"date",message:i.message}),e.dirty()):"time"===i.kind?new RegExp(`^${q(i)}$`).test(t.data)||(r=this._getOrReturnCtx(t,r),h(r,{code:u.invalid_string,validation:"time",message:i.message}),e.dirty()):"duration"===i.kind?N.test(t.data)||(r=this._getOrReturnCtx(t,r),h(r,{validation:"duration",code:u.invalid_string,message:i.message}),e.dirty()):"ip"===i.kind?(o=t.data,("v4"!==(a=i.version)&&a||!B.test(o))&&("v6"!==a&&a||!G.test(o))&&(r=this._getOrReturnCtx(t,r),h(r,{validation:"ip",code:u.invalid_string,message:i.message}),e.dirty())):"base64"===i.kind?U.test(t.data)||(r=this._getOrReturnCtx(t,r),h(r,{validation:"base64",code:u.invalid_string,message:i.message}),e.dirty()):n.assertNever(i);var o,a;return{status:e.value,value:t.data}}_regex(t,e,r){return this.refinement((e=>t.test(e)),{validation:e,code:u.invalid_string,...O.errToObj(r)})}_addCheck(t){return new H({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...O.errToObj(t)})}url(t){return this._addCheck({kind:"url",...O.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...O.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...O.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...O.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...O.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...O.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...O.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...O.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...O.errToObj(t)})}datetime(t){var e,r;return"string"==typeof t?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:void 0===(null==t?void 0:t.precision)?null:null==t?void 0:t.precision,offset:null!==(e=null==t?void 0:t.offset)&&void 0!==e&&e,local:null!==(r=null==t?void 0:t.local)&&void 0!==r&&r,...O.errToObj(null==t?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return"string"==typeof t?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:void 0===(null==t?void 0:t.precision)?null:null==t?void 0:t.precision,...O.errToObj(null==t?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...O.errToObj(t)})}regex(t,e){return this._addCheck({kind:"regex",regex:t,...O.errToObj(e)})}includes(t,e){return this._addCheck({kind:"includes",value:t,position:null==e?void 0:e.position,...O.errToObj(null==e?void 0:e.message)})}startsWith(t,e){return this._addCheck({kind:"startsWith",value:t,...O.errToObj(e)})}endsWith(t,e){return this._addCheck({kind:"endsWith",value:t,...O.errToObj(e)})}min(t,e){return this._addCheck({kind:"min",value:t,...O.errToObj(e)})}max(t,e){return this._addCheck({kind:"max",value:t,...O.errToObj(e)})}length(t,e){return this._addCheck({kind:"length",value:t,...O.errToObj(e)})}nonempty(t){return this.min(1,O.errToObj(t))}trim(){return new H({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new H({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new H({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find((t=>"datetime"===t.kind))}get isDate(){return!!this._def.checks.find((t=>"date"===t.kind))}get isTime(){return!!this._def.checks.find((t=>"time"===t.kind))}get isDuration(){return!!this._def.checks.find((t=>"duration"===t.kind))}get isEmail(){return!!this._def.checks.find((t=>"email"===t.kind))}get isURL(){return!!this._def.checks.find((t=>"url"===t.kind))}get isEmoji(){return!!this._def.checks.find((t=>"emoji"===t.kind))}get isUUID(){return!!this._def.checks.find((t=>"uuid"===t.kind))}get isNANOID(){return!!this._def.checks.find((t=>"nanoid"===t.kind))}get isCUID(){return!!this._def.checks.find((t=>"cuid"===t.kind))}get isCUID2(){return!!this._def.checks.find((t=>"cuid2"===t.kind))}get isULID(){return!!this._def.checks.find((t=>"ulid"===t.kind))}get isIP(){return!!this._def.checks.find((t=>"ip"===t.kind))}get isBase64(){return!!this._def.checks.find((t=>"base64"===t.kind))}get minLength(){let t=null;for(const e of this._def.checks)"min"===e.kind&&(null===t||e.value>t)&&(t=e.value);return t}get maxLength(){let t=null;for(const e of this._def.checks)"max"===e.kind&&(null===t||e.value<t)&&(t=e.value);return t}}function Z(t,e){const r=(t.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,o=r>n?r:n;return parseInt(t.toFixed(o).replace(".",""))%parseInt(e.toFixed(o).replace(".",""))/Math.pow(10,o)}H.create=t=>{var e;return new H({checks:[],typeName:Nt.ZodString,coerce:null!==(e=null==t?void 0:t.coerce)&&void 0!==e&&e,...D(t)})};class Y extends P{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==i.number){const e=this._getOrReturnCtx(t);return h(e,{code:u.invalid_type,expected:i.number,received:e.parsedType}),y}let e;const r=new d;for(const o of this._def.checks)"int"===o.kind?n.isInteger(t.data)||(e=this._getOrReturnCtx(t,e),h(e,{code:u.invalid_type,expected:"integer",received:"float",message:o.message}),r.dirty()):"min"===o.kind?(o.inclusive?t.data<o.value:t.data<=o.value)&&(e=this._getOrReturnCtx(t,e),h(e,{code:u.too_small,minimum:o.value,type:"number",inclusive:o.inclusive,exact:!1,message:o.message}),r.dirty()):"max"===o.kind?(o.inclusive?t.data>o.value:t.data>=o.value)&&(e=this._getOrReturnCtx(t,e),h(e,{code:u.too_big,maximum:o.value,type:"number",inclusive:o.inclusive,exact:!1,message:o.message}),r.dirty()):"multipleOf"===o.kind?0!==Z(t.data,o.value)&&(e=this._getOrReturnCtx(t,e),h(e,{code:u.not_multiple_of,multipleOf:o.value,message:o.message}),r.dirty()):"finite"===o.kind?Number.isFinite(t.data)||(e=this._getOrReturnCtx(t,e),h(e,{code:u.not_finite,message:o.message}),r.dirty()):n.assertNever(o);return{status:r.value,value:t.data}}gte(t,e){return this.setLimit("min",t,!0,O.toString(e))}gt(t,e){return this.setLimit("min",t,!1,O.toString(e))}lte(t,e){return this.setLimit("max",t,!0,O.toString(e))}lt(t,e){return this.setLimit("max",t,!1,O.toString(e))}setLimit(t,e,r,n){return new Y({...this._def,checks:[...this._def.checks,{kind:t,value:e,inclusive:r,message:O.toString(n)}]})}_addCheck(t){return new Y({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:O.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:O.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:O.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:O.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:O.toString(t)})}multipleOf(t,e){return this._addCheck({kind:"multipleOf",value:t,message:O.toString(e)})}finite(t){return this._addCheck({kind:"finite",message:O.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:O.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:O.toString(t)})}get minValue(){let t=null;for(const e of this._def.checks)"min"===e.kind&&(null===t||e.value>t)&&(t=e.value);return t}get maxValue(){let t=null;for(const e of this._def.checks)"max"===e.kind&&(null===t||e.value<t)&&(t=e.value);return t}get isInt(){return!!this._def.checks.find((t=>"int"===t.kind||"multipleOf"===t.kind&&n.isInteger(t.value)))}get isFinite(){let t=null,e=null;for(const r of this._def.checks){if("finite"===r.kind||"int"===r.kind||"multipleOf"===r.kind)return!0;"min"===r.kind?(null===e||r.value>e)&&(e=r.value):"max"===r.kind&&(null===t||r.value<t)&&(t=r.value)}return Number.isFinite(e)&&Number.isFinite(t)}}Y.create=t=>new Y({checks:[],typeName:Nt.ZodNumber,coerce:(null==t?void 0:t.coerce)||!1,...D(t)});class V extends P{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce&&(t.data=BigInt(t.data)),this._getType(t)!==i.bigint){const e=this._getOrReturnCtx(t);return h(e,{code:u.invalid_type,expected:i.bigint,received:e.parsedType}),y}let e;const r=new d;for(const o of this._def.checks)"min"===o.kind?(o.inclusive?t.data<o.value:t.data<=o.value)&&(e=this._getOrReturnCtx(t,e),h(e,{code:u.too_small,type:"bigint",minimum:o.value,inclusive:o.inclusive,message:o.message}),r.dirty()):"max"===o.kind?(o.inclusive?t.data>o.value:t.data>=o.value)&&(e=this._getOrReturnCtx(t,e),h(e,{code:u.too_big,type:"bigint",maximum:o.value,inclusive:o.inclusive,message:o.message}),r.dirty()):"multipleOf"===o.kind?t.data%o.value!==BigInt(0)&&(e=this._getOrReturnCtx(t,e),h(e,{code:u.not_multiple_of,multipleOf:o.value,message:o.message}),r.dirty()):n.assertNever(o);return{status:r.value,value:t.data}}gte(t,e){return this.setLimit("min",t,!0,O.toString(e))}gt(t,e){return this.setLimit("min",t,!1,O.toString(e))}lte(t,e){return this.setLimit("max",t,!0,O.toString(e))}lt(t,e){return this.setLimit("max",t,!1,O.toString(e))}setLimit(t,e,r,n){return new V({...this._def,checks:[...this._def.checks,{kind:t,value:e,inclusive:r,message:O.toString(n)}]})}_addCheck(t){return new V({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:O.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:O.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:O.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:O.toString(t)})}multipleOf(t,e){return this._addCheck({kind:"multipleOf",value:t,message:O.toString(e)})}get minValue(){let t=null;for(const e of this._def.checks)"min"===e.kind&&(null===t||e.value>t)&&(t=e.value);return t}get maxValue(){let t=null;for(const e of this._def.checks)"max"===e.kind&&(null===t||e.value<t)&&(t=e.value);return t}}V.create=t=>{var e;return new V({checks:[],typeName:Nt.ZodBigInt,coerce:null!==(e=null==t?void 0:t.coerce)&&void 0!==e&&e,...D(t)})};class W extends P{_parse(t){if(this._def.coerce&&(t.data=Boolean(t.data)),this._getType(t)!==i.boolean){const e=this._getOrReturnCtx(t);return h(e,{code:u.invalid_type,expected:i.boolean,received:e.parsedType}),y}return m(t.data)}}W.create=t=>new W({typeName:Nt.ZodBoolean,coerce:(null==t?void 0:t.coerce)||!1,...D(t)});class J extends P{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==i.date){const e=this._getOrReturnCtx(t);return h(e,{code:u.invalid_type,expected:i.date,received:e.parsedType}),y}if(isNaN(t.data.getTime()))return h(this._getOrReturnCtx(t),{code:u.invalid_date}),y;const e=new d;let r;for(const o of this._def.checks)"min"===o.kind?t.data.getTime()<o.value&&(r=this._getOrReturnCtx(t,r),h(r,{code:u.too_small,message:o.message,inclusive:!0,exact:!1,minimum:o.value,type:"date"}),e.dirty()):"max"===o.kind?t.data.getTime()>o.value&&(r=this._getOrReturnCtx(t,r),h(r,{code:u.too_big,message:o.message,inclusive:!0,exact:!1,maximum:o.value,type:"date"}),e.dirty()):n.assertNever(o);return{status:e.value,value:new Date(t.data.getTime())}}_addCheck(t){return new J({...this._def,checks:[...this._def.checks,t]})}min(t,e){return this._addCheck({kind:"min",value:t.getTime(),message:O.toString(e)})}max(t,e){return this._addCheck({kind:"max",value:t.getTime(),message:O.toString(e)})}get minDate(){let t=null;for(const e of this._def.checks)"min"===e.kind&&(null===t||e.value>t)&&(t=e.value);return null!=t?new Date(t):null}get maxDate(){let t=null;for(const e of this._def.checks)"max"===e.kind&&(null===t||e.value<t)&&(t=e.value);return null!=t?new Date(t):null}}J.create=t=>new J({checks:[],coerce:(null==t?void 0:t.coerce)||!1,typeName:Nt.ZodDate,...D(t)});class X extends P{_parse(t){if(this._getType(t)!==i.symbol){const e=this._getOrReturnCtx(t);return h(e,{code:u.invalid_type,expected:i.symbol,received:e.parsedType}),y}return m(t.data)}}X.create=t=>new X({typeName:Nt.ZodSymbol,...D(t)});class Q extends P{_parse(t){if(this._getType(t)!==i.undefined){const e=this._getOrReturnCtx(t);return h(e,{code:u.invalid_type,expected:i.undefined,received:e.parsedType}),y}return m(t.data)}}Q.create=t=>new Q({typeName:Nt.ZodUndefined,...D(t)});class tt extends P{_parse(t){if(this._getType(t)!==i.null){const e=this._getOrReturnCtx(t);return h(e,{code:u.invalid_type,expected:i.null,received:e.parsedType}),y}return m(t.data)}}tt.create=t=>new tt({typeName:Nt.ZodNull,...D(t)});class et extends P{constructor(){super(...arguments),this._any=!0}_parse(t){return m(t.data)}}et.create=t=>new et({typeName:Nt.ZodAny,...D(t)});class rt extends P{constructor(){super(...arguments),this._unknown=!0}_parse(t){return m(t.data)}}rt.create=t=>new rt({typeName:Nt.ZodUnknown,...D(t)});class nt extends P{_parse(t){const e=this._getOrReturnCtx(t);return h(e,{code:u.invalid_type,expected:i.never,received:e.parsedType}),y}}nt.create=t=>new nt({typeName:Nt.ZodNever,...D(t)});class ot extends P{_parse(t){if(this._getType(t)!==i.undefined){const e=this._getOrReturnCtx(t);return h(e,{code:u.invalid_type,expected:i.void,received:e.parsedType}),y}return m(t.data)}}ot.create=t=>new ot({typeName:Nt.ZodVoid,...D(t)});class it extends P{_parse(t){const{ctx:e,status:r}=this._processInputParams(t),n=this._def;if(e.parsedType!==i.array)return h(e,{code:u.invalid_type,expected:i.array,received:e.parsedType}),y;if(null!==n.exactLength){const t=e.data.length>n.exactLength.value,o=e.data.length<n.exactLength.value;(t||o)&&(h(e,{code:t?u.too_big:u.too_small,minimum:o?n.exactLength.value:void 0,maximum:t?n.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:n.exactLength.message}),r.dirty())}if(null!==n.minLength&&e.data.length<n.minLength.value&&(h(e,{code:u.too_small,minimum:n.minLength.value,type:"array",inclusive:!0,exact:!1,message:n.minLength.message}),r.dirty()),null!==n.maxLength&&e.data.length>n.maxLength.value&&(h(e,{code:u.too_big,maximum:n.maxLength.value,type:"array",inclusive:!0,exact:!1,message:n.maxLength.message}),r.dirty()),e.common.async)return Promise.all([...e.data].map(((t,r)=>n.type._parseAsync(new S(e,t,e.path,r))))).then((t=>d.mergeArray(r,t)));const o=[...e.data].map(((t,r)=>n.type._parseSync(new S(e,t,e.path,r))));return d.mergeArray(r,o)}get element(){return this._def.type}min(t,e){return new it({...this._def,minLength:{value:t,message:O.toString(e)}})}max(t,e){return new it({...this._def,maxLength:{value:t,message:O.toString(e)}})}length(t,e){return new it({...this._def,exactLength:{value:t,message:O.toString(e)}})}nonempty(t){return this.min(1,t)}}function at(t){if(t instanceof ut){const e={};for(const r in t.shape){const n=t.shape[r];e[r]=kt.create(at(n))}return new ut({...t._def,shape:()=>e})}return t instanceof it?new it({...t._def,type:at(t.element)}):t instanceof kt?kt.create(at(t.unwrap())):t instanceof jt?jt.create(at(t.unwrap())):t instanceof ht?ht.create(t.items.map((t=>at(t)))):t}it.create=(t,e)=>new it({type:t,minLength:null,maxLength:null,exactLength:null,typeName:Nt.ZodArray,...D(e)});class ut extends P{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;const t=this._def.shape(),e=n.objectKeys(t);return this._cached={shape:t,keys:e}}_parse(t){if(this._getType(t)!==i.object){const e=this._getOrReturnCtx(t);return h(e,{code:u.invalid_type,expected:i.object,received:e.parsedType}),y}const{status:e,ctx:r}=this._processInputParams(t),{shape:n,keys:o}=this._getCached(),a=[];if(!(this._def.catchall instanceof nt&&"strip"===this._def.unknownKeys))for(const t in r.data)o.includes(t)||a.push(t);const s=[];for(const t of o){const e=n[t],o=r.data[t];s.push({key:{status:"valid",value:t},value:e._parse(new S(r,o,r.path,t)),alwaysSet:t in r.data})}if(this._def.catchall instanceof nt){const t=this._def.unknownKeys;if("passthrough"===t)for(const t of a)s.push({key:{status:"valid",value:t},value:{status:"valid",value:r.data[t]}});else if("strict"===t)a.length>0&&(h(r,{code:u.unrecognized_keys,keys:a}),e.dirty());else if("strip"!==t)throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const t=this._def.catchall;for(const e of a){const n=r.data[e];s.push({key:{status:"valid",value:e},value:t._parse(new S(r,n,r.path,e)),alwaysSet:e in r.data})}}return r.common.async?Promise.resolve().then((async()=>{const t=[];for(const e of s){const r=await e.key,n=await e.value;t.push({key:r,value:n,alwaysSet:e.alwaysSet})}return t})).then((t=>d.mergeObjectSync(e,t))):d.mergeObjectSync(e,s)}get shape(){return this._def.shape()}strict(t){return O.errToObj,new ut({...this._def,unknownKeys:"strict",...void 0!==t?{errorMap:(e,r)=>{var n,o,i,a;const u=null!==(i=null===(o=(n=this._def).errorMap)||void 0===o?void 0:o.call(n,e,r).message)&&void 0!==i?i:r.defaultError;return"unrecognized_keys"===e.code?{message:null!==(a=O.errToObj(t).message)&&void 0!==a?a:u}:{message:u}}}:{}})}strip(){return new ut({...this._def,unknownKeys:"strip"})}passthrough(){return new ut({...this._def,unknownKeys:"passthrough"})}extend(t){return new ut({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new ut({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:Nt.ZodObject})}setKey(t,e){return this.augment({[t]:e})}catchall(t){return new ut({...this._def,catchall:t})}pick(t){const e={};return n.objectKeys(t).forEach((r=>{t[r]&&this.shape[r]&&(e[r]=this.shape[r])})),new ut({...this._def,shape:()=>e})}omit(t){const e={};return n.objectKeys(this.shape).forEach((r=>{t[r]||(e[r]=this.shape[r])})),new ut({...this._def,shape:()=>e})}deepPartial(){return at(this)}partial(t){const e={};return n.objectKeys(this.shape).forEach((r=>{const n=this.shape[r];t&&!t[r]?e[r]=n:e[r]=n.optional()})),new ut({...this._def,shape:()=>e})}required(t){const e={};return n.objectKeys(this.shape).forEach((r=>{if(t&&!t[r])e[r]=this.shape[r];else{let t=this.shape[r];for(;t instanceof kt;)t=t._def.innerType;e[r]=t}})),new ut({...this._def,shape:()=>e})}keyof(){return wt(n.objectKeys(this.shape))}}ut.create=(t,e)=>new ut({shape:()=>t,unknownKeys:"strip",catchall:nt.create(),typeName:Nt.ZodObject,...D(e)}),ut.strictCreate=(t,e)=>new ut({shape:()=>t,unknownKeys:"strict",catchall:nt.create(),typeName:Nt.ZodObject,...D(e)}),ut.lazycreate=(t,e)=>new ut({shape:t,unknownKeys:"strip",catchall:nt.create(),typeName:Nt.ZodObject,...D(e)});class st extends P{_parse(t){const{ctx:e}=this._processInputParams(t),r=this._def.options;if(e.common.async)return Promise.all(r.map((async t=>{const r={...e,common:{...e.common,issues:[]},parent:null};return{result:await t._parseAsync({data:e.data,path:e.path,parent:r}),ctx:r}}))).then((function(t){for(const e of t)if("valid"===e.result.status)return e.result;for(const r of t)if("dirty"===r.result.status)return e.common.issues.push(...r.ctx.common.issues),r.result;const r=t.map((t=>new s(t.ctx.common.issues)));return h(e,{code:u.invalid_union,unionErrors:r}),y}));{let t;const n=[];for(const o of r){const r={...e,common:{...e.common,issues:[]},parent:null},i=o._parseSync({data:e.data,path:e.path,parent:r});if("valid"===i.status)return i;"dirty"!==i.status||t||(t={result:i,ctx:r}),r.common.issues.length&&n.push(r.common.issues)}if(t)return e.common.issues.push(...t.ctx.common.issues),t.result;const o=n.map((t=>new s(t)));return h(e,{code:u.invalid_union,unionErrors:o}),y}}get options(){return this._def.options}}st.create=(t,e)=>new st({options:t,typeName:Nt.ZodUnion,...D(e)});const ct=t=>t instanceof bt?ct(t.schema):t instanceof Ot?ct(t.innerType()):t instanceof gt?[t.value]:t instanceof xt?t.options:t instanceof _t?n.objectValues(t.enum):t instanceof St?ct(t._def.innerType):t instanceof Q?[void 0]:t instanceof tt?[null]:t instanceof kt?[void 0,...ct(t.unwrap())]:t instanceof jt?[null,...ct(t.unwrap())]:t instanceof Ct||t instanceof Tt?ct(t.unwrap()):t instanceof At?ct(t._def.innerType):[];class lt extends P{_parse(t){const{ctx:e}=this._processInputParams(t);if(e.parsedType!==i.object)return h(e,{code:u.invalid_type,expected:i.object,received:e.parsedType}),y;const r=this.discriminator,n=e.data[r],o=this.optionsMap.get(n);return o?e.common.async?o._parseAsync({data:e.data,path:e.path,parent:e}):o._parseSync({data:e.data,path:e.path,parent:e}):(h(e,{code:u.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),y)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(t,e,r){const n=new Map;for(const r of e){const e=ct(r.shape[t]);if(!e.length)throw new Error(`A discriminator value for key \`${t}\` could not be extracted from all schema options`);for(const o of e){if(n.has(o))throw new Error(`Discriminator property ${String(t)} has duplicate value ${String(o)}`);n.set(o,r)}}return new lt({typeName:Nt.ZodDiscriminatedUnion,discriminator:t,options:e,optionsMap:n,...D(r)})}}function ft(t,e){const r=a(t),o=a(e);if(t===e)return{valid:!0,data:t};if(r===i.object&&o===i.object){const r=n.objectKeys(e),o=n.objectKeys(t).filter((t=>-1!==r.indexOf(t))),i={...t,...e};for(const r of o){const n=ft(t[r],e[r]);if(!n.valid)return{valid:!1};i[r]=n.data}return{valid:!0,data:i}}if(r===i.array&&o===i.array){if(t.length!==e.length)return{valid:!1};const r=[];for(let n=0;n<t.length;n++){const o=ft(t[n],e[n]);if(!o.valid)return{valid:!1};r.push(o.data)}return{valid:!0,data:r}}return r===i.date&&o===i.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class pt extends P{_parse(t){const{status:e,ctx:r}=this._processInputParams(t),n=(t,n)=>{if(b(t)||b(n))return y;const o=ft(t.value,n.value);return o.valid?((g(t)||g(n))&&e.dirty(),{status:e.value,value:o.data}):(h(r,{code:u.invalid_intersection_types}),y)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then((([t,e])=>n(t,e))):n(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}pt.create=(t,e,r)=>new pt({left:t,right:e,typeName:Nt.ZodIntersection,...D(r)});class ht extends P{_parse(t){const{status:e,ctx:r}=this._processInputParams(t);if(r.parsedType!==i.array)return h(r,{code:u.invalid_type,expected:i.array,received:r.parsedType}),y;if(r.data.length<this._def.items.length)return h(r,{code:u.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),y;!this._def.rest&&r.data.length>this._def.items.length&&(h(r,{code:u.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),e.dirty());const n=[...r.data].map(((t,e)=>{const n=this._def.items[e]||this._def.rest;return n?n._parse(new S(r,t,r.path,e)):null})).filter((t=>!!t));return r.common.async?Promise.all(n).then((t=>d.mergeArray(e,t))):d.mergeArray(e,n)}get items(){return this._def.items}rest(t){return new ht({...this._def,rest:t})}}ht.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new ht({items:t,typeName:Nt.ZodTuple,rest:null,...D(e)})};class dt extends P{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:e,ctx:r}=this._processInputParams(t);if(r.parsedType!==i.object)return h(r,{code:u.invalid_type,expected:i.object,received:r.parsedType}),y;const n=[],o=this._def.keyType,a=this._def.valueType;for(const t in r.data)n.push({key:o._parse(new S(r,t,r.path,t)),value:a._parse(new S(r,r.data[t],r.path,t)),alwaysSet:t in r.data});return r.common.async?d.mergeObjectAsync(e,n):d.mergeObjectSync(e,n)}get element(){return this._def.valueType}static create(t,e,r){return new dt(e instanceof P?{keyType:t,valueType:e,typeName:Nt.ZodRecord,...D(r)}:{keyType:H.create(),valueType:t,typeName:Nt.ZodRecord,...D(e)})}}class yt extends P{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:e,ctx:r}=this._processInputParams(t);if(r.parsedType!==i.map)return h(r,{code:u.invalid_type,expected:i.map,received:r.parsedType}),y;const n=this._def.keyType,o=this._def.valueType,a=[...r.data.entries()].map((([t,e],i)=>({key:n._parse(new S(r,t,r.path,[i,"key"])),value:o._parse(new S(r,e,r.path,[i,"value"]))})));if(r.common.async){const t=new Map;return Promise.resolve().then((async()=>{for(const r of a){const n=await r.key,o=await r.value;if("aborted"===n.status||"aborted"===o.status)return y;"dirty"!==n.status&&"dirty"!==o.status||e.dirty(),t.set(n.value,o.value)}return{status:e.value,value:t}}))}{const t=new Map;for(const r of a){const n=r.key,o=r.value;if("aborted"===n.status||"aborted"===o.status)return y;"dirty"!==n.status&&"dirty"!==o.status||e.dirty(),t.set(n.value,o.value)}return{status:e.value,value:t}}}}yt.create=(t,e,r)=>new yt({valueType:e,keyType:t,typeName:Nt.ZodMap,...D(r)});class vt extends P{_parse(t){const{status:e,ctx:r}=this._processInputParams(t);if(r.parsedType!==i.set)return h(r,{code:u.invalid_type,expected:i.set,received:r.parsedType}),y;const n=this._def;null!==n.minSize&&r.data.size<n.minSize.value&&(h(r,{code:u.too_small,minimum:n.minSize.value,type:"set",inclusive:!0,exact:!1,message:n.minSize.message}),e.dirty()),null!==n.maxSize&&r.data.size>n.maxSize.value&&(h(r,{code:u.too_big,maximum:n.maxSize.value,type:"set",inclusive:!0,exact:!1,message:n.maxSize.message}),e.dirty());const o=this._def.valueType;function a(t){const r=new Set;for(const n of t){if("aborted"===n.status)return y;"dirty"===n.status&&e.dirty(),r.add(n.value)}return{status:e.value,value:r}}const s=[...r.data.values()].map(((t,e)=>o._parse(new S(r,t,r.path,e))));return r.common.async?Promise.all(s).then((t=>a(t))):a(s)}min(t,e){return new vt({...this._def,minSize:{value:t,message:O.toString(e)}})}max(t,e){return new vt({...this._def,maxSize:{value:t,message:O.toString(e)}})}size(t,e){return this.min(t,e).max(t,e)}nonempty(t){return this.min(1,t)}}vt.create=(t,e)=>new vt({valueType:t,minSize:null,maxSize:null,typeName:Nt.ZodSet,...D(e)});class mt extends P{constructor(){super(...arguments),this.validate=this.implement}_parse(t){const{ctx:e}=this._processInputParams(t);if(e.parsedType!==i.function)return h(e,{code:u.invalid_type,expected:i.function,received:e.parsedType}),y;function r(t,r){return p({data:t,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,f(),c].filter((t=>!!t)),issueData:{code:u.invalid_arguments,argumentsError:r}})}function n(t,r){return p({data:t,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,f(),c].filter((t=>!!t)),issueData:{code:u.invalid_return_type,returnTypeError:r}})}const o={errorMap:e.common.contextualErrorMap},a=e.data;if(this._def.returns instanceof Et){const t=this;return m((async function(...e){const i=new s([]),u=await t._def.args.parseAsync(e,o).catch((t=>{throw i.addIssue(r(e,t)),i})),c=await Reflect.apply(a,this,u);return await t._def.returns._def.type.parseAsync(c,o).catch((t=>{throw i.addIssue(n(c,t)),i}))}))}{const t=this;return m((function(...e){const i=t._def.args.safeParse(e,o);if(!i.success)throw new s([r(e,i.error)]);const u=Reflect.apply(a,this,i.data),c=t._def.returns.safeParse(u,o);if(!c.success)throw new s([n(u,c.error)]);return c.data}))}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...t){return new mt({...this._def,args:ht.create(t).rest(rt.create())})}returns(t){return new mt({...this._def,returns:t})}implement(t){return this.parse(t)}strictImplement(t){return this.parse(t)}static create(t,e,r){return new mt({args:t||ht.create([]).rest(rt.create()),returns:e||rt.create(),typeName:Nt.ZodFunction,...D(r)})}}class bt extends P{get schema(){return this._def.getter()}_parse(t){const{ctx:e}=this._processInputParams(t);return this._def.getter()._parse({data:e.data,path:e.path,parent:e})}}bt.create=(t,e)=>new bt({getter:t,typeName:Nt.ZodLazy,...D(e)});class gt extends P{_parse(t){if(t.data!==this._def.value){const e=this._getOrReturnCtx(t);return h(e,{received:e.data,code:u.invalid_literal,expected:this._def.value}),y}return{status:"valid",value:t.data}}get value(){return this._def.value}}function wt(t,e){return new xt({values:t,typeName:Nt.ZodEnum,...D(e)})}gt.create=(t,e)=>new gt({value:t,typeName:Nt.ZodLiteral,...D(e)});class xt extends P{constructor(){super(...arguments),k.set(this,void 0)}_parse(t){if("string"!=typeof t.data){const e=this._getOrReturnCtx(t),r=this._def.values;return h(e,{expected:n.joinValues(r),received:e.parsedType,code:u.invalid_type}),y}if(_(this,k,"f")||E(this,k,new Set(this._def.values),"f"),!_(this,k,"f").has(t.data)){const e=this._getOrReturnCtx(t),r=this._def.values;return h(e,{received:e.data,code:u.invalid_enum_value,options:r}),y}return m(t.data)}get options(){return this._def.values}get enum(){const t={};for(const e of this._def.values)t[e]=e;return t}get Values(){const t={};for(const e of this._def.values)t[e]=e;return t}get Enum(){const t={};for(const e of this._def.values)t[e]=e;return t}extract(t,e=this._def){return xt.create(t,{...this._def,...e})}exclude(t,e=this._def){return xt.create(this.options.filter((e=>!t.includes(e))),{...this._def,...e})}}k=new WeakMap,xt.create=wt;class _t extends P{constructor(){super(...arguments),j.set(this,void 0)}_parse(t){const e=n.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(t);if(r.parsedType!==i.string&&r.parsedType!==i.number){const t=n.objectValues(e);return h(r,{expected:n.joinValues(t),received:r.parsedType,code:u.invalid_type}),y}if(_(this,j,"f")||E(this,j,new Set(n.getValidEnumValues(this._def.values)),"f"),!_(this,j,"f").has(t.data)){const t=n.objectValues(e);return h(r,{received:r.data,code:u.invalid_enum_value,options:t}),y}return m(t.data)}get enum(){return this._def.values}}j=new WeakMap,_t.create=(t,e)=>new _t({values:t,typeName:Nt.ZodNativeEnum,...D(e)});class Et extends P{unwrap(){return this._def.type}_parse(t){const{ctx:e}=this._processInputParams(t);if(e.parsedType!==i.promise&&!1===e.common.async)return h(e,{code:u.invalid_type,expected:i.promise,received:e.parsedType}),y;const r=e.parsedType===i.promise?e.data:Promise.resolve(e.data);return m(r.then((t=>this._def.type.parseAsync(t,{path:e.path,errorMap:e.common.contextualErrorMap}))))}}Et.create=(t,e)=>new Et({type:t,typeName:Nt.ZodPromise,...D(e)});class Ot extends P{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Nt.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:e,ctx:r}=this._processInputParams(t),o=this._def.effect||null,i={addIssue:t=>{h(r,t),t.fatal?e.abort():e.dirty()},get path(){return r.path}};if(i.addIssue=i.addIssue.bind(i),"preprocess"===o.type){const t=o.transform(r.data,i);if(r.common.async)return Promise.resolve(t).then((async t=>{if("aborted"===e.value)return y;const n=await this._def.schema._parseAsync({data:t,path:r.path,parent:r});return"aborted"===n.status?y:"dirty"===n.status||"dirty"===e.value?v(n.value):n}));{if("aborted"===e.value)return y;const n=this._def.schema._parseSync({data:t,path:r.path,parent:r});return"aborted"===n.status?y:"dirty"===n.status||"dirty"===e.value?v(n.value):n}}if("refinement"===o.type){const t=t=>{const e=o.refinement(t,i);if(r.common.async)return Promise.resolve(e);if(e instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return t};if(!1===r.common.async){const n=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===n.status?y:("dirty"===n.status&&e.dirty(),t(n.value),{status:e.value,value:n.value})}return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then((r=>"aborted"===r.status?y:("dirty"===r.status&&e.dirty(),t(r.value).then((()=>({status:e.value,value:r.value}))))))}if("transform"===o.type){if(!1===r.common.async){const t=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!w(t))return t;const n=o.transform(t.value,i);if(n instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:e.value,value:n}}return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then((t=>w(t)?Promise.resolve(o.transform(t.value,i)).then((t=>({status:e.value,value:t}))):t))}n.assertNever(o)}}Ot.create=(t,e,r)=>new Ot({schema:t,typeName:Nt.ZodEffects,effect:e,...D(r)}),Ot.createWithPreprocess=(t,e,r)=>new Ot({schema:e,effect:{type:"preprocess",transform:t},typeName:Nt.ZodEffects,...D(r)});class kt extends P{_parse(t){return this._getType(t)===i.undefined?m(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}kt.create=(t,e)=>new kt({innerType:t,typeName:Nt.ZodOptional,...D(e)});class jt extends P{_parse(t){return this._getType(t)===i.null?m(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}jt.create=(t,e)=>new jt({innerType:t,typeName:Nt.ZodNullable,...D(e)});class St extends P{_parse(t){const{ctx:e}=this._processInputParams(t);let r=e.data;return e.parsedType===i.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:e.path,parent:e})}removeDefault(){return this._def.innerType}}St.create=(t,e)=>new St({innerType:t,typeName:Nt.ZodDefault,defaultValue:"function"==typeof e.default?e.default:()=>e.default,...D(e)});class At extends P{_parse(t){const{ctx:e}=this._processInputParams(t),r={...e,common:{...e.common,issues:[]}},n=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return x(n)?n.then((t=>({status:"valid",value:"valid"===t.status?t.value:this._def.catchValue({get error(){return new s(r.common.issues)},input:r.data})}))):{status:"valid",value:"valid"===n.status?n.value:this._def.catchValue({get error(){return new s(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}At.create=(t,e)=>new At({innerType:t,typeName:Nt.ZodCatch,catchValue:"function"==typeof e.catch?e.catch:()=>e.catch,...D(e)});class Dt extends P{_parse(t){if(this._getType(t)!==i.nan){const e=this._getOrReturnCtx(t);return h(e,{code:u.invalid_type,expected:i.nan,received:e.parsedType}),y}return{status:"valid",value:t.data}}}Dt.create=t=>new Dt({typeName:Nt.ZodNaN,...D(t)});const Pt=Symbol("zod_brand");class Ct extends P{_parse(t){const{ctx:e}=this._processInputParams(t),r=e.data;return this._def.type._parse({data:r,path:e.path,parent:e})}unwrap(){return this._def.type}}class Lt extends P{_parse(t){const{status:e,ctx:r}=this._processInputParams(t);if(r.common.async)return(async()=>{const t=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return"aborted"===t.status?y:"dirty"===t.status?(e.dirty(),v(t.value)):this._def.out._parseAsync({data:t.value,path:r.path,parent:r})})();{const t=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===t.status?y:"dirty"===t.status?(e.dirty(),{status:"dirty",value:t.value}):this._def.out._parseSync({data:t.value,path:r.path,parent:r})}}static create(t,e){return new Lt({in:t,out:e,typeName:Nt.ZodPipeline})}}class Tt extends P{_parse(t){const e=this._def.innerType._parse(t),r=t=>(w(t)&&(t.value=Object.freeze(t.value)),t);return x(e)?e.then((t=>r(t))):r(e)}unwrap(){return this._def.innerType}}function Ft(t,e={},r){return t?et.create().superRefine(((n,o)=>{var i,a;if(!t(n)){const t="function"==typeof e?e(n):"string"==typeof e?{message:e}:e,u=null===(a=null!==(i=t.fatal)&&void 0!==i?i:r)||void 0===a||a,s="string"==typeof t?{message:t}:t;o.addIssue({code:"custom",...s,fatal:u})}})):et.create()}Tt.create=(t,e)=>new Tt({innerType:t,typeName:Nt.ZodReadonly,...D(e)});const It={object:ut.lazycreate};var Nt;!function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"}(Nt||(Nt={}));const Rt=H.create,Mt=Y.create,Bt=Dt.create,Gt=V.create,Ut=W.create,zt=J.create,$t=X.create,qt=Q.create,Kt=tt.create,Ht=et.create,Zt=rt.create,Yt=nt.create,Vt=ot.create,Wt=it.create,Jt=ut.create,Xt=ut.strictCreate,Qt=st.create,te=lt.create,ee=pt.create,re=ht.create,ne=dt.create,oe=yt.create,ie=vt.create,ae=mt.create,ue=bt.create,se=gt.create,ce=xt.create,le=_t.create,fe=Et.create,pe=Ot.create,he=kt.create,de=jt.create,ye=Ot.createWithPreprocess,ve=Lt.create,me={string:t=>H.create({...t,coerce:!0}),number:t=>Y.create({...t,coerce:!0}),boolean:t=>W.create({...t,coerce:!0}),bigint:t=>V.create({...t,coerce:!0}),date:t=>J.create({...t,coerce:!0})},be=y;var ge=Object.freeze({__proto__:null,defaultErrorMap:c,setErrorMap:function(t){l=t},getErrorMap:f,makeIssue:p,EMPTY_PATH:[],addIssueToContext:h,ParseStatus:d,INVALID:y,DIRTY:v,OK:m,isAborted:b,isDirty:g,isValid:w,isAsync:x,get util(){return n},get objectUtil(){return o},ZodParsedType:i,getParsedType:a,ZodType:P,datetimeRegex:K,ZodString:H,ZodNumber:Y,ZodBigInt:V,ZodBoolean:W,ZodDate:J,ZodSymbol:X,ZodUndefined:Q,ZodNull:tt,ZodAny:et,ZodUnknown:rt,ZodNever:nt,ZodVoid:ot,ZodArray:it,ZodObject:ut,ZodUnion:st,ZodDiscriminatedUnion:lt,ZodIntersection:pt,ZodTuple:ht,ZodRecord:dt,ZodMap:yt,ZodSet:vt,ZodFunction:mt,ZodLazy:bt,ZodLiteral:gt,ZodEnum:xt,ZodNativeEnum:_t,ZodPromise:Et,ZodEffects:Ot,ZodTransformer:Ot,ZodOptional:kt,ZodNullable:jt,ZodDefault:St,ZodCatch:At,ZodNaN:Dt,BRAND:Pt,ZodBranded:Ct,ZodPipeline:Lt,ZodReadonly:Tt,custom:Ft,Schema:P,ZodSchema:P,late:It,get ZodFirstPartyTypeKind(){return Nt},coerce:me,any:Ht,array:Wt,bigint:Gt,boolean:Ut,date:zt,discriminatedUnion:te,effect:pe,enum:ce,function:ae,instanceof:(t,e={message:`Input not instance of ${t.name}`})=>Ft((e=>e instanceof t),e),intersection:ee,lazy:ue,literal:se,map:oe,nan:Bt,nativeEnum:le,never:Yt,null:Kt,nullable:de,number:Mt,object:Jt,oboolean:()=>Ut().optional(),onumber:()=>Mt().optional(),optional:he,ostring:()=>Rt().optional(),pipeline:ve,preprocess:ye,promise:fe,record:ne,set:ie,strictObject:Xt,string:Rt,symbol:$t,transformer:pe,tuple:re,undefined:qt,union:Qt,unknown:Zt,void:Vt,NEVER:be,ZodIssueCode:u,quotelessJson:t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:"),ZodError:s})}},n={};function o(t){var e=n[t];if(void 0!==e)return e.exports;var i=n[t]={id:t,loaded:!1,exports:{}};return r[t].call(i.exports,i,i.exports,o),i.loaded=!0,i.exports}o.m=r,o.amdO={},o.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return o.d(e,{a:e}),e},o.d=(t,e)=>{for(var r in e)o.o(e,r)&&!o.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},o.f={},o.e=t=>Promise.all(Object.keys(o.f).reduce(((e,r)=>(o.f[r](t,e),e)),[])),o.u=t=>""+t,o.miniCssF=t=>{},o.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),t={},e="chatpowerbi_ai:",o.l=(r,n,i,a)=>{if(t[r])t[r].push(n);else{var u,s;if(void 0!==i)for(var c=document.getElementsByTagName("script"),l=0;l<c.length;l++){var f=c[l];if(f.getAttribute("src")==r||f.getAttribute("data-webpack")==e+i){u=f;break}}u||(s=!0,(u=document.createElement("script")).charset="utf-8",u.timeout=120,o.nc&&u.setAttribute("nonce",o.nc),u.setAttribute("data-webpack",e+i),u.src=r),t[r]=[n];var p=(e,n)=>{u.onerror=u.onload=null,clearTimeout(h);var o=t[r];if(delete t[r],u.parentNode&&u.parentNode.removeChild(u),o&&o.forEach((t=>t(n))),e)return e(n)},h=setTimeout(p.bind(null,void 0,{type:"timeout",target:u}),12e4);u.onerror=p.bind(null,u.onerror),u.onload=p.bind(null,u.onload),s&&document.head.appendChild(u)}},o.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),o.p="assets",(()=>{var t={262:0};o.f.j=(e,r)=>{var n=o.o(t,e)?t[e]:void 0;if(0!==n)if(n)r.push(n[2]);else{var i=new Promise(((r,o)=>n=t[e]=[r,o]));r.push(n[2]=i);var a=o.p+o.u(e),u=new Error;o.l(a,(r=>{if(o.o(t,e)&&(0!==(n=t[e])&&(t[e]=void 0),n)){var i=r&&("load"===r.type?"missing":r.type),a=r&&r.target&&r.target.src;u.message="Loading chunk "+e+" failed.\n("+i+": "+a+")",u.name="ChunkLoadError",u.type=i,u.request=a,n[1](u)}}),"chunk-"+e,e)}};var e=(e,r)=>{var n,i,[a,u,s]=r,c=0;if(a.some((e=>0!==t[e]))){for(n in u)o.o(u,n)&&(o.m[n]=u[n]);s&&s(o)}for(e&&e(r);c<a.length;c++)i=a[c],o.o(t,i)&&t[i]&&t[i][0](),t[i]=0},r=self.webpackChunkchatpowerbi_ai=self.webpackChunkchatpowerbi_ai||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))})();var i={};(()=>{"use strict";o.r(i),o.d(i,{default:()=>jx});var t={};function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}function r(t,e){return{objectName:t,propertyName:e.name,selector:e.selector,altConstantValueSelector:e.altConstantSelector,instanceKind:e.instanceKind}}function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function a(t,e,r,n){var o=u(l(1&n?t.prototype:t),e,r);return 2&n&&"function"==typeof o?function(t){return o.apply(r,t)}:o}function u(){return u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=l(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},u.apply(null,arguments)}function s(t,e,r){return e=l(e),function(t,e){if(e&&("object"==n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,c()?Reflect.construct(e,r||[],l(t).constructor):e.apply(t,r))}function c(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(c=function(){return!!t})()}function l(t){return l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},l(t)}function f(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&p(t,e)}function p(t,e){return p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},p(t,e)}function h(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,y(n.key),n)}}function d(t,e,r){return e&&h(t.prototype,e),r&&h(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function y(t){var e=function(t){if("object"!=n(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==n(e)?e:e+""}function v(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}o.r(t),o.d(t,{xX:()=>Mv,qA:()=>Bv,LG:()=>Nv,cH:()=>Rv,pJ:()=>Iv,v3:()=>Uv,v7:()=>Gv,fK:()=>qv,PO:()=>Zv,m_:()=>$v,Ll:()=>zv,OE:()=>Hv,Is:()=>Kv});var m=d((function t(){v(this,t)})),b=function(t){function e(){return v(this,e),s(this,e,arguments)}return f(e,t),d(e)}(m),g=d((function t(){v(this,t)})),w=function(t){function e(){return v(this,e),s(this,e,arguments)}return f(e,t),d(e)}(m),x=function(t){function e(t){var r;return v(this,e),r=s(this,e),Object.assign(r,t),r}return f(e,t),d(e)}(b),_=function(t){function e(){return v(this,e),s(this,e,arguments)}return f(e,t),d(e)}(b),E=function(t){function n(t){var e;return v(this,n),e=s(this,n),Object.assign(e,t),e}return f(n,t),d(n,[{key:"getFormattingSlice",value:function(t,e){var r=this.type,n=this.name,o={displayName:e&&this.displayNameKey?e.getDisplayName(this.displayNameKey):this.displayName,description:e&&this.descriptionKey?e.getDisplayName(this.descriptionKey):this.description,uid:t+"-"+n};return Object.assign(Object.assign({},o),{control:{type:r,properties:this.getFormattingComponent(t,e)}})}},{key:"getFormattingComponent",value:function(t,e){return{descriptor:r(t,this),value:this.value}}},{key:"getRevertToDefaultDescriptor",value:function(t){return[{objectName:t,propertyName:this.name}]}},{key:"setPropertiesValues",value:function(t,r){var n,o,i,a,u=null===(n=null==t?void 0:t[r])||void 0===n?void 0:n[this.name];this.value=(o=this,i=u,a=this.value,null==i||"object"===e(i)&&!i.solid?a:i.solid?{value:null==i?void 0:i.solid.color}:"Dropdown"===(null==o?void 0:o.type)&&o.items?o.items.find((function(t){return t.value==i})):i)}}])}(m),O=function(t){function e(t){var r;return v(this,e),(r=s(this,e,[t])).type="ToggleSwitch",r}return f(e,t),d(e)}(E),k=function(t){function e(t){var r;return v(this,e),(r=s(this,e,[t])).type="ColorPicker",r}return f(e,t),d(e,[{key:"getFormattingComponent",value:function(t){return Object.assign(Object.assign({},a(e,"getFormattingComponent",this,3)([t])),{defaultColor:this.defaultColor,isNoFillItemSupported:this.isNoFillItemSupported})}}])}(E),j=function(t){function e(t){var r;return v(this,e),(r=s(this,e,[t])).type="NumUpDown",r}return f(e,t),d(e,[{key:"getFormattingComponent",value:function(t){return Object.assign(Object.assign({},a(e,"getFormattingComponent",this,3)([t])),{options:this.options})}}])}(E),S=function(t){function e(t){var r;return v(this,e),(r=s(this,e,[t])).type="Dropdown",r}return f(e,t),d(e,[{key:"getFormattingComponent",value:function(t){return Object.assign(Object.assign({},a(e,"getFormattingComponent",this,3)([t])),{items:this.items})}}])}(E),A=function(t){function e(t){var r;return v(this,e),(r=s(this,e,[t])).type="TextInput",r}return f(e,t),d(e,[{key:"getFormattingComponent",value:function(t){return Object.assign(Object.assign({},a(e,"getFormattingComponent",this,3)([t])),{placeholder:this.placeholder})}}])}(E),D=function(t){function e(){var t;return v(this,e),(t=s(this,e,arguments)).type="TextArea",t}return f(e,t),d(e)}(A),P=function(t){function e(){var t;return v(this,e),(t=s(this,e,arguments)).type="FontPicker",t}return f(e,t),d(e)}(E);function C(t){return C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},C(t)}function L(t){return function(t){if(Array.isArray(t))return T(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return T(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?T(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function T(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function F(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,I(n.key),n)}}function I(t){var e=function(t){if("object"!=C(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=C(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==C(e)?e:e+""}var N=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.localizationManager=e},e=[{key:"populateFormattingSettingsModel",value:function(t,e){var r,n,o=new t,i=null===(r=null==e?void 0:e.metadata)||void 0===r?void 0:r.objects;return i&&(null===(n=o.cards)||void 0===n||n.forEach((function(t){var e;t instanceof w&&(null===(e=t.topLevelSlice)||void 0===e||e.setPropertiesValues(i,t.name)),(t instanceof _?[t]:t.groups).forEach((function(e){var r,n,o,a;null===(r=e.topLevelSlice)||void 0===r||r.setPropertiesValues(i,t.name),null===(n=null==e?void 0:e.slices)||void 0===n||n.forEach((function(e){null==e||e.setPropertiesValues(i,t.name)})),null===(a=null===(o=null==e?void 0:e.container)||void 0===o?void 0:o.containerItems)||void 0===a||a.forEach((function(e){var r;null===(r=null==e?void 0:e.slices)||void 0===r||r.forEach((function(e){null==e||e.setPropertiesValues(i,t.name)}))}))}))}))),o}},{key:"buildFormattingModel",value:function(t){var e=this,r={cards:[]};return t.cards.filter((function(t){var e=t.visible;return void 0===e||e})).forEach((function(t){var n,o={displayName:e.localizationManager&&t.displayNameKey?e.localizationManager.getDisplayName(t.displayNameKey):t.displayName,description:e.localizationManager&&t.descriptionKey?e.localizationManager.getDisplayName(t.descriptionKey):t.description,groups:[],uid:t.name+"-card",analyticsPane:t.analyticsPane},i=t.name;if(t.topLevelSlice){var a=t.topLevelSlice.getFormattingSlice(i,e.localizationManager);a.suppressDisplayName=!0,o.topLevelToggle=a}null===(n=t.onPreProcess)||void 0===n||n.call(t);var u=t instanceof _;(u?[t].filter((function(t){var e=t.visible;return void 0===e||e})):t.groups.filter((function(t){var e=t.visible;return void 0===e||e}))).forEach((function(t){var r=t.name+"-group",n={displayName:u?void 0:e.localizationManager&&t.displayNameKey?e.localizationManager.getDisplayName(t.displayNameKey):t.displayName,description:u?void 0:e.localizationManager&&t.descriptionKey?e.localizationManager.getDisplayName(t.descriptionKey):t.description,slices:[],uid:r,collapsible:t.collapsible,delaySaveSlices:t.delaySaveSlices,disabled:t.disabled,disabledReason:t.disabledReason};o.groups.push(n);var a={};if(t.container){var s=t.container,c=r+"-container",l={displayName:e.localizationManager&&s.displayNameKey?e.localizationManager.getDisplayName(s.displayNameKey):s.displayName,description:e.localizationManager&&s.descriptionKey?e.localizationManager.getDisplayName(s.descriptionKey):s.description,containerItems:[],uid:c};s.containerItems.forEach((function(t){var r=t.displayNameKey?t.displayNameKey:t.displayName,n=c+r,o={displayName:e.localizationManager&&t.displayNameKey?e.localizationManager.getDisplayName(t.displayNameKey):t.displayName,slices:[],uid:n};e.buildFormattingSlices({slices:t.slices,objectName:i,sliceNames:a,formattingSlices:o.slices}),l.containerItems.push(o)})),n.container=l}if(t.slices){if(t.topLevelSlice){var f=t.topLevelSlice.getFormattingSlice(i,e.localizationManager);f.suppressDisplayName=!0,(null==n.displayName?o:n).topLevelToggle=f}e.buildFormattingSlices({slices:t.slices,objectName:i,sliceNames:a,formattingSlices:n.slices})}})),o.revertToDefaultDescriptors=e.getRevertToDefaultDescriptor(t),r.cards.push(o)})),r}},{key:"buildFormattingSlices",value:function(t){var e=this,r=t.slices,n=t.objectName,o=t.sliceNames,i=t.formattingSlices;null==r||r.filter((function(t){var e=t.visible;return void 0===e||e})).forEach((function(t){var r=null==t?void 0:t.getFormattingSlice(n,e.localizationManager);r&&(void 0===o[t.name]?o[t.name]=0:(o[t.name]++,r.uid="".concat(r.uid,"-").concat(o[t.name])),i.push(r))}))}},{key:"getRevertToDefaultDescriptor",value:function(t){var e,r,n=this,o={},i=[],a=[];return t instanceof w&&t.topLevelSlice&&i.push.apply(i,L(null===(e=t.topLevelSlice)||void 0===e?void 0:e.getRevertToDefaultDescriptor(t.name))),(t instanceof _?[t].filter((function(t){var e=t.visible;return void 0===e||e})):t.groups.filter((function(t){var e=t.visible;return void 0===e||e}))).forEach((function(e){var u,s;r=n.getSlicesRevertToDefaultDescriptor(t.name,e.slices,o,e.topLevelSlice),null===(s=null===(u=e.container)||void 0===u?void 0:u.containerItems)||void 0===s||s.forEach((function(e){a=a.concat(n.getSlicesRevertToDefaultDescriptor(t.name,e.slices,o))})),i.push.apply(i,L(r.concat(a)))})),i}},{key:"getSlicesRevertToDefaultDescriptor",value:function(t,e,r,n){var o=[];return n&&(r[n.name]=!0,o=o.concat(n.getRevertToDefaultDescriptor(t))),null==e||e.forEach((function(e){e&&!r[e.name]&&(r[e.name]=!0,o=o.concat(e.getRevertToDefaultDescriptor(t)))})),o}}],e&&F(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();const R=N;function M(t){return M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},M(t)}function B(){var t=["Qoxba","SKLkt","UjyaJ","a-zA-Z_$][","ooExO","kKUHK","FiboV","rNLbi","call","while (tru","dFrME","CxYVS","counter","ZuFiq","now","dUoNs","8129114qDJfIb","RZhcF","gger","test","GZrWJ","constructo","ogJLh","171tDUkXo","qfcxk","sMbkq","4512800bRoBhY","HdRLx","$]*)","toFixed","debu","\\+\\+ *(?:[","gGwMZ","input","8VOlTIu","BpAVp","RTNqD","1308290QGmwzN","action","VkTuS","ooXrQ","apply","bEbbf","5168466QlNHtK","kooGH","XwrxN","xddlT","string","jOWdA","zaIxl","OzTyu","HJLpB","lVGJz","Eifdx","5001FhRNWo","mhFJh","vsrbt","uxsyY","34uSVfrk","NAqMf","fromCharCo","KZwXk","XKpsH","ZfFyC","\\( *\\)","ivIYR","loxha","chain","HwDDg","hcOrH","WMSvx","DXAqk","cWcCi","1543439iOGlTB","BtPXh","tBuUe","928045CaqkXN"];return(B=function(){return t})()}!function(t){for(var e=U,r=t();;)try{if(863642==-parseInt(e(341))/1+-parseInt(e(326))/2*(-parseInt(e(322))/3)+parseInt(e(379))/4*(-parseInt(e(344))/5)+parseInt(e(388))/6+-parseInt(e(361))/7+parseInt(e(371))/8+parseInt(e(368))/9*(parseInt(e(382))/10))break;r.push(r.shift())}catch(t){r.push(r.shift())}}(B);var G=function(t){return function(t){var e=U,r={NAqMf:function(t,e){return t(e)},pwxhI:function(t,e){return t===e},kKUHK:e(321),qMQvA:function(t){return t()},xddlT:e(363),FiboV:function(t,e){return t+e},WMSvx:e(335),sMbkq:function(t,e){return t+e},ivIYR:e(378),rNLbi:e(342),kUXkh:function(t,e){return t!==e},Qoxba:e(393),SKLkt:function(t,e){return t+e},jEtBy:function(t,e){return t+e},sDeLH:function(t,e){return t+e}},n=function(){var t=e;if(!r.pwxhI(r[t(350)],t(317))){var n=!0;return function(t,e){var r=n?function(){if(e){var r=e[U(386)](t,arguments);return e=null,r}}:function(){};return n=!1,r}}EadiwS.POCDq(_0x40967a,"0")}();!function(){var t=e,o={ooXrQ:function(t,e){return t+e},qfcxk:r[t(391)],ZuFiq:t(376)+t(348)+"0-9a-zA-Z_"+t(373),BpAVp:"init",qCkhK:function(t,e){return r.FiboV(t,e)},jKsnb:r[t(338)],cWcCi:function(e,n){return r[t(370)](e,n)},lVGJz:r[t(333)],gGwMZ:r[t(352)],KZwXk:function(e,n){return r[t(327)](e,n)},HwDDg:function(t){return r.qMQvA(t)}};r.kUXkh(r[t(345)],"jOWdA")?haefgs.qMQvA(_0x53c2b9):n(this,(function(){var e=t,r=new RegExp("function *"+e(332)),n=new RegExp(o[e(358)],"i"),i=z(o[e(380)]);r[e(364)](o.qCkhK(i,o.jKsnb))&&n[e(364)](o[e(340)](i,o[e(320)]))?o[e(336)](z):e(381)===o[e(377)]?function(){return!1}[e(366)+"r"](fdOdVk[e(385)](e(375),fdOdVk[e(369)])).apply("stateObject"):o[e(329)](i,"0")}))()}();var o,i=Math.random(),a=r.jEtBy(i,1-i);return function(){var n,i,u,s,c,l,f,p,h,d,y,v,m,b,g,w,x=e;return t[r[x(370)](r.sMbkq(r[x(351)](r[x(370)](r[x(346)]((w=Date[x(359)](),("r"+(o+Date[x(359)]()[x(374)]())[2]+o+"Y"+w)[a]+(g=Date[x(359)],("m"+(o+Date[x(359)]().toFixed())[0]+String.fromCharCode(111)+g+"`r"+g)[a+1])),(b=Date.now,("a"+String.fromCharCode(99)+(o+Date.now()[x(374)]())[2]+b+""+b)[a])),(m=Date[x(359)],(o+m+Date[x(359)]().toFixed())[0][a-1])),(v=Date[x(359)],("m"+v+(o+Date[x(359)]()[x(374)]())[0]+"C"+v)[a-1]))+(y=Date[x(359)],("#C"+(o+Date.now()[x(374)]())[3]+y)[a+2]),(d=Date.now,(""+(o+Date[x(359)]()[x(374)]())[1]+d+"w"+d)[a+2])),(h=Date[x(359)],("t"+o+h)[a-1]))][r.jEtBy(r.sDeLH(r[x(370)]((p=Date[x(359)],("r"+p+(o+Date[x(359)]()[x(374)]())+p+(o+Date[x(359)]()[x(374)]())+"")[a-1]+(f=Date[x(359)],(""+o+(o+Date[x(359)]()[x(374)]())[3]+"p"+f)[a+9])),(l=Date[x(359)],((o+l+Date.now()[x(374)]())[4]+""+o+l)[2*a-2]))+(c=Date.now,("P"+o+""+(o+Date[x(359)]()[x(374)]())[3]+c)[10+a]),(s=Date[x(359)],(String[x(328)+"de"](114)+String.fromCharCode(114)+s+"w"+s)[a-1]))+(u=Date.now,("Gw"+o+""+String[x(328)+"de"](114)+u)[a+11])+(i=Date.now,(o+(o+Date[x(359)]().toFixed())[3]+""+i)[8+a]),(n=Date[x(359)],("wr"+n+o+n)[a+1]))]}}(t)};function U(t,e){var r=B();return(U=function(t,e){return r[t-=317]})(t,e)}function z(t){var e=U,r={ZfFyC:function(t,e){return t+e},YHZIU:function(t,e){return t+e},VkTuS:function(t,e){return t+e},bEbbf:function(t,e){return t+e},OzTyu:function(t,e){return t+e},uxsyY:function(t,e){return t+e},mhFJh:function(t,e){return t+e},loxha:function(t,e){return t!==e},HJLpB:e(343),DXAqk:e(337),vsrbt:e(392),GZrWJ:e(354)+"e) {}",CxYVS:e(357),kooGH:function(t,e){return t/e},HdRLx:function(t,e){return t%e},RZhcF:"gger",ooExO:e(383),dFrME:e(330),ogJLh:e(347),CRtky:e(375),dUoNs:function(t,e){return t(e)}};function n(t){var o,i,a,u,s,c,l,f,p,h,d,y,v,m,b,g,w=e,x={XwrxN:function(t,e){return r[U(334)](t,e)},Lnxud:r[w(319)],TrpZN:r[w(339)]};if(M(t)===r[w(324)])return function(t){}.constructor(r[w(365)])[w(386)](r[w(356)]);if(1!==r.YHZIU("",r[w(389)](t,t)).length||0===r[w(372)](t,20))(function(){return!0})[w(366)+"r"](w(375)+r[w(362)])[w(353)](r[w(349)]);else{if(r[w(355)]===r[w(367)])return _0x671a90[r[w(331)](r.YHZIU(r[w(384)](r[w(387)]((g=_0x4ba767[w(359)](),("r"+(_0x4a1266+_0x378e45[w(359)]()[w(374)]())[2]+_0x270961+"Y"+g)[_0x1a0a5b]),(b=_0x142bc4[w(359)],("m"+(_0x395ef3+_0x19a420[w(359)]()[w(374)]())[0]+_0x2b479d[w(328)+"de"](111)+b+"`r"+b)[_0xd73395+1]))+(m=_0x25984c[w(359)],("a"+_0x5972a8[w(328)+"de"](99)+(_0x25734b+_0x2f545e.now()[w(374)]())[2]+m+""+m)[_0x400a57])+(v=_0x2297cd.now,(_0x471d64+v+_0x2a785c[w(359)]()[w(374)]())[0][_0x2dcb06-1]),(y=_0x838679[w(359)],("m"+y+(_0x4e7693+_0x576990[w(359)]()[w(374)]())[0]+"C"+y)[_0x19bc2b-1]))+(d=_0x348bb9.now,("#C"+(_0xba9386+_0x13e317[w(359)]()[w(374)]())[3]+d)[_0x124642+2]),(h=_0xf8c4f8[w(359)],(""+(_0x539184+_0xbd18c2.now()[w(374)]())[1]+h+"w"+h)[_0x3a9617+2])),(p=_0xdb8754.now,("t"+_0x11237c+p)[_0x441e03-1]))][r[w(387)](r[w(318)](r.uxsyY(r[w(325)](r[w(323)]((f=_0x40cd02.now,("r"+f+(_0x43bb6d+_0xa26dcf[w(359)]()[w(374)]())+f+(_0x588f29+_0x4bac6e.now()[w(374)]())+"")[_0x14d2c3-1]+(l=_0x507ac9.now,(""+_0x1b21f0+(_0x26ed79+_0x6bdf41.now()[w(374)]())[3]+"p"+l)[_0x16c96d+9])),(c=_0x1c6133[w(359)],((_0xb78c9e+c+_0x169f83[w(359)]()[w(374)]())[4]+""+_0x3f7414+c)[2*_0x178ae4-2])),(s=_0x13af09.now,("P"+_0xb8f9f2+""+(_0x29e3dc+_0xefb5ec[w(359)]()[w(374)]())[3]+s)[10+_0x5a8a23])),(u=_0x43d225[w(359)],(_0x2614fc[w(328)+"de"](114)+_0x133445.fromCharCode(114)+u+"w"+u)[_0x52adfa-1]))+(a=_0x2e11b7.now,("Gw"+_0x1d4f8f+""+_0x583b5c[w(328)+"de"](114)+a)[_0x1ff38c+11]),(i=_0xe1d2b[w(359)],(_0x440985+(_0x31f34c+_0x3210f3[w(359)]()[w(374)]())[3]+""+i)[8+_0x2294af])),(o=_0x239ca6.now,("wr"+o+_0x4a2382+o)[_0x44d5a0+1]))];(function(){return!x[w(390)](x.Lnxud,x.TrpZN)}).constructor(r.CRtky+r[w(362)])[w(386)]("stateObject")}r[w(360)](n,++t)}try{if(t)return n;r[e(360)](n,0)}catch(t){}}var $="undefined"==typeof arguments?void 0:arguments;function q(t){return q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},q(t)}!function(t){for(var e=Y,r=t();;)try{if(747436==parseInt(e(246))/1+-parseInt(e(253))/2*(-parseInt(e(219))/3)+parseInt(e(247))/4+-parseInt(e(235))/5*(-parseInt(e(198))/6)+-parseInt(e(184))/7+parseInt(e(212))/8*(parseInt(e(230))/9)+-parseInt(e(233))/10)break;r.push(r.shift())}catch(t){r.push(r.shift())}}(H);var K=function(){var t=Y,e={};e[t(189)]=t(223);var r=e,n=!0;return function(e,o){var i=t,a={};a[i(239)]=function(t,e){return t!==e},a[i(185)]=r.PcPPc;var u=a,s=n?function(){var t=i;if(o){if(u[t(239)](u[t(185)],t(257))){var r=o.apply(e,arguments);return o=null,r}return!0}}:function(){};return n=!1,s}}();function H(){var t=["yuGDU","SVJYY","MOwSO","awxWr","EDzWw","coHkZ","split","oQyWD","lSnMl","init","jnwyq","fromCharCo","\\+\\+ *(?:[","SKpLD","mXYmV","embeddedCo","fwyJy","ORKuU","BORvs","substring","6768146WZGzBZ","XtxQf","length","e) {}","while (tru","PcPPc","SbgRA","ayaxf","HqwVz","ioxqA","aKBpP","apply","kIweR","HqAmI","6sSlMGH","yGEFt","sHMeh","ujDAn","HuSxB","random","counter","qcgyi","lPSVP","\\( *\\)","ZKIKe","necoD","test","dUgfe","7256nEypjl","nFlKX","gger","rPzzF","rcogV","input","PokBc","622704yHLiPJ","charCodeAt","QVJog","AfLfI","WeAFu","LNTCR","function *","EzQlM","XoLaC","floor","call","8775LkjGJz","0-9a-zA-Z_","atob","14208260owouiu","referrer","2089745OuvxRo","GCsUQ","ahKCw","chain","XDxII","btoa","$]*)","MeoCp","JRxBp","QThXL","constructo","647407iMpEBm","590476kxLsZE","LlsVT","gzCZk","MLlUi","jokBq","Clnvy","10hjMWFF","wsVrD","ArJiJ"];return(H=function(){return t})()}!function(){var t=Y,e={EzQlM:function(t,e){return t+e},awxWr:t(268)+"a-zA-Z_$][0-9a-zA-Z_$]*)",MOwSO:function(t,e){return t(e)},yGEFt:function(t,e){return t+e},AfLfI:t(238),ahKCw:t(217),MeoCp:function(t,e){return t===e},qcgyi:"kRMrz",FMKTT:function(t){return t()}};K(this,(function(){var r=t,n={Clnvy:function(t,r){return e[Y(226)](t,r)}},o=new RegExp(r(225)+"\\( *\\)"),i=new RegExp(e[r(259)],"i"),a=e[r(258)](V,r(265));o[r(210)](e[r(199)](a,e[r(222)]))&&i.test(a+e[r(237)])?e.FMKTT(V):e[r(242)](e[r(205)],e.qcgyi)?e[r(258)](a,"0"):_0xcd1504+=_0x5489e1.fromCharCode(n[r(252)](n[r(252)](_0x3daecb[r(220)](_0x575d02),_0x23bbc5),11))}))()}();var Z=function(t,e,r,n){var o=Y,i={};i[o(269)]=function(t,e){return t*e},i[o(251)]=function(t,e){return t<e},i.SbgRA=function(t,e){return t+e},i.KOykp=function(t,e){return t===e},i.lPSVP=o(196),i[o(260)]=o(208);for(var a=i,u=Math[o(228)](a.SKpLD(Math.random(),10)),s=Math.floor(10*Math.random()),c=t+"||"+e+"||"+r+"||"+n,l="",f=0;a[o(251)](f,c[o(186)]);f++)l+=String[o(267)+"de"](a.SbgRA(a.SbgRA(c[o(220)](f),u),11));for(var p=window.btoa(l),h="",d=0;a[o(251)](d,p.length);d++)if(a.KOykp(a[o(206)],a[o(260)])){if(_0x1ae35b){var y=_0x437c9d[o(195)](_0x4b511b,$);return _0x100057=null,y}}else h+=String[o(267)+"de"](a.SbgRA(a[o(190)](p[o(220)](d),s),4));return""+u+s+window[o(240)](h)};function Y(t,e){var r=H();return(Y=function(t,e){return r[t-=183]})(t,e)}function V(t){var e=Y,r={LlsVT:function(t,e){return t===e},ioxqA:e(211),nxmIv:e(268)+"a-zA-Z_$]["+e(231)+e(241),gzCZk:e(265),MLlUi:function(t,e){return t+e},HqAmI:function(t){return t()},XoLaC:"string",lSnMl:e(204),aKBpP:function(t,e){return t/e},QMDKo:e(186),ORKuU:function(t,e){return t%e},GCsUQ:e(221),ayaxf:"debu",HqwVz:e(214),ujDAn:"action",JRxBp:"stateObject",jnwyq:function(t,e){return t-e},yuGDU:function(t,e){return t-e},sHMeh:function(t,e){return t*e},HxvHh:function(t,e){return t*e},rcogV:function(t,e){return t<e},HJjpU:function(t,e){return t+e},fwyJy:e(274),mXYmV:function(t,e){return t!==e},ArJiJ:"nnYHN",oQyWD:function(t,e){return t(e)}};function n(t){var o=e,i={necoD:function(t,e){return t(e)},HuSxB:o(225)+o(207),wsVrD:r.nxmIv,xCTSo:r[o(249)],PokBc:function(t,e){return r[o(250)](t,e)},nFlKX:function(t){return r[o(197)](t)}};if(r.LlsVT(q(t),r[o(227)]))return function(t){}[o(245)+"r"](o(188)+o(187))[o(195)](r[o(264)]);if(1!==r[o(250)]("",r[o(194)](t,t))[r.QMDKo]||0===r[o(273)](t,20))if("QVJog"===r[o(236)])(function(){return!0})[o(245)+"r"](r[o(250)](r[o(191)],r[o(192)]))[o(229)](r[o(201)]);else{if(_0x1971d3)return _0x1a469b;i[o(209)](_0x85df67,0)}else(function(){var t=o;if(r.LlsVT(r[t(193)],r[t(193)]))return!1;var e=new _0x3e7ec7(i[t(202)]),n=new _0x1ad8c6(i[t(254)],"i"),a=_0xd21e32(i.xCTSo);e[t(210)](a+t(238))&&n[t(210)](i[t(218)](a,"input"))?i[t(213)](_0x249e80):a("0")})[o(245)+"r"](r[o(250)]("debu",r.HqwVz))[o(195)](r[o(243)]);n(++t)}try{if(!r[e(248)](r[e(272)],r.fwyJy)){for(var o=_0x7a8e79[e(228)](r[e(200)](_0x533498[e(203)](),10)),i=_0x1acfb9.floor(r.HxvHh(_0x55eb86[e(203)](),10)),a=_0x268e4e+"||"+_0x43b9ec+"||"+_0x511a3e+"||"+_0xf272ac,u="",s=0;r[e(216)](s,a.length);s++)u+=_0x137d66[e(267)+"de"](r.MLlUi(a[e(220)](s),o)+11);for(var c=_0x1dad1e[e(240)](u),l="",f=0;f<c.length;f++)l+=_0x1e4a20[e(267)+"de"](r.MLlUi(r.HJjpU(c.charCodeAt(f),i),4));return""+o+i+_0x7abc6[e(240)](l)}if(t)return n;r[e(270)](r[e(255)],r[e(255)])?_0x143ce8+=_0x848ce[e(267)+"de"](r[e(266)](r[e(256)](_0x5d2fc7[e(220)](_0xf9e7a0),_0x2deb53),4)):r[e(263)](n,0)}catch(t){}}function W(t){return W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},W(t)}function J(){var t=["cmXOh","call","FcWXV","debu","EkFzB","kvAlS","$]*)","rzaSG","851382pphKmx","MxZwX","TcIfV","LxAzO","KzlLw","faliG","init","kEOLn","ICXWb","xbShq","31634yYSiYh","dXsWe","WJAnh","Rcxcd","kPLHL","ioCFH","nPgQD","mePZi","xwOry","FHXsx","IHyfU","nbkjH","124nJbyrT","wlNlH","\\( *\\)","nGGwX","cimzd","gger","a-zA-Z_$][","WaQSo","PSIYH","3148710vIcJsr","\\+\\+ *(?:[","KZBRd","KQPzG","13745RZSRpg","input","zoNUf","CppJk","xLGYX","clooy","length","TCDYl","ztoVu","aBqKh","XwQRC","GFVqQ","24qiRkfm","e) {}","11dQdzVx","apply","fOapn","function *","uVjdF","VLPCK","1154394EjFrZX","IIzEJ","UXrAX","test","GnYnz","counter","jeuFg","chain","oQcwl","while (tru","stateObjec","action","IwXaf","1365868xbhLaO","pZUdX","jvruS","TVJsr","constructo","aVHBD","XynXb","JAzgi","276975zaEWyv"];return(J=function(){return t})()}!function(t){for(var e=Q,r=t();;)try{if(195767==parseInt(e(177))/1*(-parseInt(e(223))/2)+parseInt(e(204))/3+-parseInt(e(235))/4*(parseInt(e(163))/5)+-parseInt(e(213))/6+-parseInt(e(196))/7+-parseInt(e(175))/8*(-parseInt(e(183))/9)+parseInt(e(244))/10)break;r.push(r.shift())}catch(t){r.push(r.shift())}}(J);var X=function(){var t=Q,e={};e[t(215)]=function(t,e){return t!==e},e.ghPXs=t(202),e[t(185)]=t(221),e.DtGGq=function(t,e){return t===e},e[t(220)]=t(198);var r=e,n=!0;return function(e,o){var i=t;if(r.DtGGq(r[i(220)],"QuXCW"))return!0;var a=n?function(){var t=i;if(o){if(r.TcIfV(r.ghPXs,r.UXrAX)){var n=o.apply(e,arguments);return o=null,n}return function(t){}.constructor(t(192)+t(176)).apply(t(188))}}:function(){};return n=!1,a}}();function Q(t,e){var r=J();return(Q=function(t,e){return r[t-=162]})(t,e)}function tt(t){var e=Q,r={XwQRC:e(208),Ynkwf:e(194),xLGYX:function(t,e){return t!==e},xwOry:e(230),rzaSG:"string",KzlLw:e(192)+"e) {}",xujpn:e(188),fOapn:function(t,e){return t/e},kSQeo:e(169),cmXOh:function(t,e){return t%e},cimzd:function(t,e){return t+e},ztoVu:e(240),MxZwX:function(t,e){return t!==e},GnYnz:e(210),uVjdF:e(195),nbkjH:function(t,e){return t+e},CppJk:e(193)+"t",TVJsr:function(t,e){return t(e)},GFVqQ:e(180)+e(237),faliG:e(245)+"a-zA-Z_$][0-9a-zA-Z_"+e(211),wlNlH:e(219),FcWXV:function(t,e){return t+e},nPgQD:e(190),LxAzO:e(164),oQcwl:function(t){return t()},TCDYl:function(t,e){return t===e},RZIcP:e(197),DXNAZ:e(203),WaQSo:e(243)};function n(t){var o=e,i={};i[o(168)]=r[o(231)];var a=i;if(W(t)===r[o(212)])return function(t){}[o(200)+"r"](r[o(217)])[o(178)](r.xujpn);1!==(""+r[o(179)](t,t))[r.kSQeo]||0===r[o(205)](t,20)?function(){var t=o;return a[t(168)]==a[t(168)]}.constructor(r[o(239)](r[o(173)],r[o(171)]))[o(206)](r.Ynkwf):r[o(214)](r[o(187)],r[o(181)])?function(){var t=o,e={fxigm:function(t,e){return t+e}};e[t(233)]=r[t(173)],e[t(162)]=r.Ynkwf;var n=e;if(!r[t(167)](t(189),t(189)))return!1;(function(){return!0})[t(200)+"r"](n.fxigm(n[t(233)],t(240))).call(n[t(162)])}[o(200)+"r"](r[o(234)](o(208),r[o(171)]))[o(178)](r[o(166)]):_0x1e8286(),r[o(199)](n,++t)}try{if(r[e(170)](r.RZIcP,r.DXNAZ)){var o=new _0x86d93a(r[e(174)]),i=new _0x355450(r[e(218)],"i"),a=r[e(199)](_0x4ad330,r[e(236)]);o.test(r[e(207)](a,r[e(229)]))&&i.test(r.FcWXV(a,r[e(216)]))?r[e(191)](_0x33c48e):r[e(199)](a,"0")}else{if(t){if(r[e(170)](e(182),r[e(242)])){var u=_0x850f96?function(){if(_0x2a3144){var t=_0x466e6f[e(178)](_0x29b770,arguments);return _0x4c005a=null,t}}:function(){};return _0x632ed9=!1,u}return n}r.TVJsr(n,0)}}catch(t){}}function et(t){return et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},et(t)}function rt(){rt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new P(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function b(){}function g(){}var w={};c(w,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(w=_);var E=g.prototype=m.prototype=Object.create(w);function O(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,i,a,u){var s=f(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==et(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=S(u,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?y:h,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=y,n.method="throw",n.arg=c.arg)}}}function S(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,S(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function C(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(et(e)+" is not iterable")}return b.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=c(g,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,c(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},O(k.prototype),c(k.prototype,u,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(E),c(E,s,"Generator"),c(E,a,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=C,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),D(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;D(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:C(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function nt(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}!function(){var t=Q,e={ihMeu:"\\+\\+ *(?:["+t(241)+"0-9a-zA-Z_"+t(211),nGGwX:function(t,e){return t(e)},FHXsx:"init",KZBRd:function(t,e){return t+e},EkFzB:function(t,e){return t+e},zoNUf:t(164),kPLHL:t(184),ioCFH:"irJaD",Rcxcd:function(t,e){return t(e)},dXsWe:function(t,e){return t===e},WJAnh:"xbShq",aVHBD:function(t,e,r){return t(e,r)}};e[t(201)](X,this,(function(){var r=t,n=new RegExp(r(180)+"\\( *\\)"),o=new RegExp(e.ihMeu,"i"),i=e[r(238)](tt,e[r(232)]);if(n.test(e[r(246)](i,"chain"))&&o[r(186)](e[r(209)](i,e[r(165)]))){if(!e[r(224)](r(222),e[r(225)])){var a=_0x57353c[r(178)](_0x13902d,arguments);return _0x9f53da=null,a}tt()}else e[r(227)]!==e[r(228)]?e[r(226)](i,"0"):_0x336d3e(0)}))()}();var ot=function(){var t,e=(t=rt().mark((function t(e){var r,n,o,i,a,u,s,c,l,f;return rt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.licenseKey,n=e.chatId,o=e.basePath,i=e.suffix,a=e.eCode,p=r,h=n,d=a,y=void 0,v=void 0,void 0,y=Q,m=(v={eIqHK:function(t,e){return t(e)},aBqKh:function(t,e,r,n,o){return t(e,r,n,o)}}).eIqHK(G,window)(),u=v[y(172)](Z,p,h,m,d),(s=new URL("".concat((null!=i?i:"").replace(/\/+$/,""),"/getSession"),o)).searchParams.append("ref",u),t.prev=3,t.next=6,fetch(s);case 6:return c=t.sent,t.next=9,c.json();case 9:if(l=t.sent,c.ok){t.next=12;break}throw new Error([401,403,426].includes(c.status)?l.error:"Unable to obtain a valid session. To get a new session click on the settings icon and clear the chat. Make sure your internet connection is working.");case 12:return f=null==l?void 0:l.byollmUrl,t.abrupt("return",f?{token:null==l?void 0:l.token,provider:null==l?void 0:l.provider,ref:u,byollmHeaders:null==l?void 0:l.byollmHeaders,byollmUrl:null==l?void 0:l.byollmUrl,byollmModel:null==l?void 0:l.byollmModel,byollmInst:JSON.parse(atob(null==l?void 0:l.byollmInst))}:{token:null==l?void 0:l.token,provider:null==l?void 0:l.provider,ref:u});case 16:return t.prev=16,t.t0=t.catch(3),console.error(t.t0),t.abrupt("return",{sessionErrorMsg:t.t0 instanceof TypeError?"Unable to obtain a valid session. To get a new session click on the settings icon and clear the chat. Make sure your internet connection is working.":t.t0.message});case 20:case"end":return t.stop()}var p,h,d,y,v,m}),t,null,[[3,16]])})),function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){nt(i,n,o,a,u,"next",t)}function u(t){nt(i,n,o,a,u,"throw",t)}a(void 0)}))});return function(t){return e.apply(this,arguments)}}();function it(t){return it="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},it(t)}function at(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,st(n.key),n)}}function ut(t,e,r){return(e=st(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function st(t){var e=function(t){if("object"!=it(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=it(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==it(e)?e:e+""}var ct="closeSettings",lt=function(){return t=function t(e,r){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),ut(this,"eventEmitter",void 0),ut(this,"elSettingsMenu",void 0),ut(this,"elSettingsButton",void 0),ut(this,"elClearIcon",void 0),ut(this,"elOverlayMenu",void 0),ut(this,"menuItems",[]),ut(this,"isOpened",!1),ut(this,"_toggleSettings",(function(){n.isOpened=!n.isOpened,n.elOverlayMenu.classList[n.isOpened?"remove":"add"]("close")})),ut(this,"_clearChatHistory",(function(){n.eventEmitter.emit(Mw,!0),n._toggleSettings()})),this.elSettingsMenu=e,this.eventEmitter=r,this.elSettingsButton=document.createElement("button"),Object.assign(this.elSettingsButton,{title:"Settings",type:"button"}),this.elSettingsButton.classList.add("settings-button"),this.elSettingsButton.innerHTML='<svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 50 50" width="50px" height="50px"><path d="M 32.21875 2.0625 L 27.84375 3.78125 L 28.625 7.5625 C 28.320313 7.867188 27.996094 8.21875 27.65625 8.59375 L 23.90625 7.75 L 22.0625 12.0625 L 25.25 14.1875 C 25.214844 14.714844 25.214844 15.253906 25.25 15.78125 L 21.96875 17.78125 L 23.6875 22.15625 L 27.375 21.40625 C 27.707031 21.804688 28.070313 22.167969 28.46875 22.5 L 27.625 26.1875 L 31.96875 28.03125 L 34.09375 24.84375 C 34.625 24.878906 35.125 24.878906 35.65625 24.84375 L 37.6875 28.125 L 42.0625 26.40625 L 41.21875 22.40625 C 41.613281 22.078125 41.953125 21.703125 42.28125 21.3125 L 46.09375 22.28125 L 47.96875 17.90625 L 44.65625 15.875 C 44.6875 15.355469 44.6875 14.863281 44.65625 14.34375 L 47.9375 12.3125 L 46.21875 7.9375 L 42.40625 8.78125 C 42.078125 8.386719 41.707031 8.015625 41.3125 7.6875 L 42.15625 4 L 37.8125 2.15625 L 35.78125 5.34375 C 35.257813 5.292969 34.730469 5.265625 34.21875 5.3125 Z M 35 11 C 37.210938 11 39 12.789063 39 15 C 39 17.210938 37.210938 19 35 19 C 32.789063 19 31 17.210938 31 15 C 31 12.789063 32.789063 11 35 11 Z M 13.53125 20 L 12.90625 24 C 12.355469 24.175781 11.796875 24.425781 11.25 24.71875 L 7.90625 22.28125 L 4.40625 25.78125 L 6.71875 29.15625 C 6.441406 29.703125 6.222656 30.253906 6.03125 30.8125 L 2 31.5625 L 2 36.4375 L 6 37.15625 C 6.175781 37.710938 6.421875 38.292969 6.71875 38.84375 L 4.28125 42.09375 L 7.78125 45.59375 L 11.15625 43.28125 C 11.699219 43.558594 12.257813 43.777344 12.8125 43.96875 L 13.4375 48 L 18.34375 48 L 19.0625 44 C 19.621094 43.824219 20.199219 43.578125 20.75 43.28125 L 24.09375 45.71875 L 27.59375 42.21875 L 25.1875 38.84375 C 25.460938 38.300781 25.652344 37.742188 25.84375 37.1875 L 30 36.4375 L 30 31.53125 L 25.90625 30.90625 C 25.730469 30.355469 25.480469 29.792969 25.1875 29.25 L 27.59375 25.90625 L 24.125 22.28125 L 20.71875 24.71875 C 20.183594 24.445313 19.644531 24.222656 19.09375 24.03125 L 18.46875 20 Z M 16 30 C 18.199219 30 20 31.800781 20 34 C 20 36.199219 18.199219 38 16 38 C 13.800781 38 12 36.199219 12 34 C 12 31.800781 13.800781 30 16 30 Z"/></svg>',this.elSettingsMenu.append(this.elSettingsButton),this.elClearIcon=document.createElement("span"),this.elClearIcon.innerHTML='<?xml version="1.0"?><svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 24 24" width="24px" height="24px">    <path d="M 10 2 L 9 3 L 4 3 L 4 5 L 20 5 L 20 3 L 15 3 L 14 2 L 10 2 z M 5 7 L 5 22 L 19 22 L 19 7 L 5 7 z M 8 9 L 10 9 L 10 20 L 8 20 L 8 9 z M 14 9 L 16 9 L 16 20 L 14 20 L 14 9 z"/></svg>',this.menuItems.push({name:"Clear chat",icon:this.elClearIcon,func:this._clearChatHistory}),this.elOverlayMenu=document.createElement("div"),this.elOverlayMenu.classList.add("overlay-menu","close");var o=document.createElement("ul");o.classList.add("overlay-menu-list");var i=document.createElement("li");i.classList.add("menuitem-title"),i.innerHTML="Settings",o.append(i),this.menuItems.forEach((function(t){var e=document.createElement("li"),r=document.createElement("a"),n=document.createElement("span");r.classList.add("menuitem-link"),e.addEventListener("click",t.func),n.classList.add("menuitem-text"),n.innerText=t.name,t.icon.classList.add("menuitem-icon"),r.append(t.icon,n),e.append(r),o.append(e)})),this.elOverlayMenu.append(o),this.elSettingsMenu.append(this.elOverlayMenu),this.elSettingsButton.addEventListener("click",this._toggleSettings),this.eventEmitter.on(ct,(function(t){return n._handleClickOutside(t)}))},e=[{key:"_handleClickOutside",value:function(t){this.isOpened&&!t.target.closest(".settings-menu")&&this._toggleSettings()}}],e&&at(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();const ft='<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M5.69362 11.9997L2.29933 3.2715C2.0631 2.66403 2.65544 2.08309 3.2414 2.28959L3.33375 2.32885L21.3337 11.3288C21.852 11.588 21.8844 12.2975 21.4309 12.6129L21.3337 12.6705L3.33375 21.6705C2.75077 21.962 2.11746 21.426 2.2688 20.8234L2.29933 20.7278L5.69362 11.9997L2.29933 3.2715L5.69362 11.9997ZM4.4021 4.54007L7.01109 11.2491L13.6387 11.2497C14.0184 11.2497 14.3322 11.5318 14.3818 11.8979L14.3887 11.9997C14.3887 12.3794 14.1065 12.6932 13.7404 12.7428L13.6387 12.7497L7.01109 12.7491L4.4021 19.4593L19.3213 11.9997L4.4021 4.54007Z"></path></svg>';function pt(t){return pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pt(t)}function ht(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,vt(n.key),n)}}function dt(t,e,r){return e&&ht(t.prototype,e),r&&ht(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function yt(t,e,r){return(e=vt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vt(t){var e=function(t){if("object"!=pt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=pt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==pt(e)?e:e+""}var mt="updateButtonState",bt="clickButton",gt=dt((function t(e,r,n){var o=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),yt(this,"eventEmitter",void 0),yt(this,"elButton",void 0),yt(this,"elStop",void 0),yt(this,"arrowColor","#704ae8"),yt(this,"arrowColorDisable","rgb(201 201 207)"),yt(this,"isEnable",!1),yt(this,"isLoading",!1),yt(this,"updateState",(function(t,e){o.isEnable=t,o.isLoading=e,o.updateStyle()})),yt(this,"updateStyle",(function(){o.elStop.classList[o.isLoading?"remove":"add"]("hidden"),o.elButton.classList[o.isLoading?"add":"remove"]("hidden"),o.elButton.classList[o.isEnable?"remove":"add"]("disable"),o.elButton.tabIndex=o.isEnable?0:-1,o.isEnable?(o.elButton.innerHTML='<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12.8147 12.1969L5.28344 13.4521C5.10705 13.4815 4.95979 13.6029 4.89723 13.7704L2.29933 20.7278C2.05066 21.3673 2.72008 21.9773 3.33375 21.6705L21.3337 12.6705C21.8865 12.3941 21.8865 11.6052 21.3337 11.3288L3.33375 2.32885C2.72008 2.02201 2.05066 2.63206 2.29933 3.2715L4.89723 10.2289C4.95979 10.3964 5.10705 10.5178 5.28344 10.5472L12.8147 11.8024C12.9236 11.8205 12.9972 11.9236 12.9791 12.0325C12.965 12.1168 12.899 12.1829 12.8147 12.1969Z"></path></svg>',o.elButton.children&&o.elButton.children[0]&&(o.elButton.children[0].style.fill=o.arrowColor)):(o.elButton.innerHTML=ft,o.elButton.children&&o.elButton.children[0]&&(o.elButton.children[0].style.fill=o.arrowColorDisable))})),yt(this,"_sendMessage",(function(){o.eventEmitter.emit(bt,!1)})),yt(this,"_stopStream",(function(){o.eventEmitter.emit(bt,!0)})),this.elButton=e,this.elStop=r,this.eventEmitter=n,this.elButton.innerHTML=ft,this.elStop.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="h-2 w-2 text-token-text-primary" height="16" width="16"><path d="M0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2z" stroke-width="0"></path></svg>',this.elButton.addEventListener("click",this._sendMessage),this.elStop.addEventListener("click",this._stopStream),this.updateStyle()}));function wt(t){return wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wt(t)}function xt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Et(n.key),n)}}function _t(t,e,r){return(e=Et(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Et(t){var e=function(t){if("object"!=wt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=wt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==wt(e)?e:e+""}var Ot=function(){return t=function t(e,r,n){var o=this;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),_t(this,"elTextarea",void 0),_t(this,"placeholder",void 0),_t(this,"eventEmitter",void 0),_t(this,"elCount",void 0),_t(this,"currChar",0),_t(this,"maxChar",2e3),_t(this,"sendMessage",(function(){o.eventEmitter.emit(Rw,o.elTextarea.value)})),_t(this,"clear",(function(){o.elTextarea.value="",o.currChar=0,o._resize(),o._updateButtonState(),o._renderCountChar()})),_t(this,"_resize",(function(){o.elTextarea.style.height="auto";var t=o.elTextarea.closest(".footer-chat"),e=getComputedStyle(t);if(t&&"none"!==e.display){var r=getComputedStyle(o.elTextarea),n=parseInt(r.lineHeight),i=o.elTextarea.scrollHeight-parseInt(r.paddingTop)-parseInt(r.paddingBottom),a=Math.min(4*n,i);o.elTextarea.style.height="".concat(a,"px"),o.elTextarea.style.marginBottom="".concat(a-n,"px")}})),_t(this,"_updateButtonState",(function(){o.eventEmitter.emit(mt,0!==o.elTextarea.value.length)})),_t(this,"_checkEnterKey",(function(t){if("Enter"===t.key&&!t.shiftKey)return o.sendMessage(),t.preventDefault(),!1})),_t(this,"_countChar",(function(t){o.currChar=o.elTextarea.value.length,o._renderCountChar()})),_t(this,"_renderCountChar",(function(){o.elCount.innerText="".concat(o.currChar,"/").concat(o.maxChar)})),this.elTextarea=e,this.eventEmitter=n,this.elCount=r,this.elTextarea.addEventListener("input",this._resize),this.elTextarea.addEventListener("input",this._updateButtonState),this.elTextarea.addEventListener("keydown",this._checkEnterKey),this.elTextarea.addEventListener("input",this._countChar),this._renderCountChar(),this.elTextarea.maxLength=this.maxChar,new Proxy(this,{set:function(t,e,r,n){return"placeholder"===e&&t._updatePlaceholder(r),Reflect.set(t,e,r,n)}})},(e=[{key:"_updatePlaceholder",value:function(t){this.elTextarea.placeholder=t}}])&&xt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function kt(t){return kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kt(t)}function jt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,St(n.key),n)}}function St(t){var e=function(t){if("object"!=kt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=kt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==kt(e)?e:e+""}var At=function(){return t=function t(){var e,r,n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e=this,n=void 0,(r=St(r="_events"))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,this._events={}},e=[{key:"on",value:function(t,e){this._events[t]||(this._events[t]=[]),this._events[t].push(e)}},{key:"removeListener",value:function(t,e){if(!this._events[t])throw new Error("Can't remove a listener. Event \"".concat(t,"\" doesn't exits."));this._events[t]=this._events[t].filter((function(t){return t!==e}))}},{key:"emit",value:function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];if(!this._events[t])throw new Error("Can't emit an event. Event \"".concat(t,"\" doesn't exits."));this._events[t].forEach((function(t){t.apply(void 0,r)}))}}],e&&jt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function Dt(t){return Dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dt(t)}function Pt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Tt(n.key),n)}}function Ct(t,e,r){return e&&Pt(t.prototype,e),r&&Pt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Lt(t,e,r){return(e=Tt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Tt(t){var e=function(t){if("object"!=Dt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Dt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Dt(e)?e:e+""}var Ft=Ct((function t(e){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Lt(this,"elContainer",void 0),Lt(this,"_using",(function(t){"mouse"===t?(r.elContainer.classList.remove("using-keyboard"),r.elContainer.classList.add("using-mouse")):(r.elContainer.classList.remove("using-mouse"),r.elContainer.classList.add("using-keyboard"))})),this.elContainer=e,this.elContainer.addEventListener("mousedown",(function(){return r._using("mouse")})),this.elContainer.addEventListener("keydown",(function(){return r._using("keyboard")}))}));function It(t){return It="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},It(t)}function Nt(t,e,r){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}function Rt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Mt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Rt(Object(r),!0).forEach((function(e){qt(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Rt(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Bt(t){return function(t){if(Array.isArray(t))return Zt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Ht(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Gt(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=Ht(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}function Ut(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function zt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Kt(n.key),n)}}function $t(t,e,r){return e&&zt(t.prototype,e),r&&zt(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function qt(t,e,r){return(e=Kt(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Kt(t){var e=function(t){if("object"!=It(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=It(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==It(e)?e:e+""}function Ht(t,e){if(t){if("string"==typeof t)return Zt(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Zt(t,e):void 0}}function Zt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}var Yt={async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null};function Vt(t){Yt=t}var Wt=/[&<>"']/,Jt=new RegExp(Wt.source,"g"),Xt=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,Qt=new RegExp(Xt.source,"g"),te={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},ee=function(t){return te[t]};function re(t,e){if(e){if(Wt.test(t))return t.replace(Jt,ee)}else if(Xt.test(t))return t.replace(Qt,ee);return t}var ne=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi;function oe(t){return t.replace(ne,(function(t,e){return"colon"===(e=e.toLowerCase())?":":"#"===e.charAt(0)?"x"===e.charAt(1)?String.fromCharCode(parseInt(e.substring(2),16)):String.fromCharCode(+e.substring(1)):""}))}var ie=/(^|[^\[])\^/g;function ae(t,e){var r="string"==typeof t?t:t.source;e=e||"";var n={replace:function(t,e){var o="string"==typeof e?e:e.source;return o=o.replace(ie,"$1"),r=r.replace(t,o),n},getRegex:function(){return new RegExp(r,e)}};return n}function ue(t){try{t=encodeURI(t).replace(/%25/g,"%")}catch(t){return null}return t}var se={exec:function(){return null}};function ce(t,e){var r=t.replace(/\|/g,(function(t,e,r){for(var n=!1,o=e;--o>=0&&"\\"===r[o];)n=!n;return n?"|":" |"})),n=r.split(/ \|/),o=0;if(n[0].trim()||n.shift(),n.length>0&&!n[n.length-1].trim()&&n.pop(),e)if(n.length>e)n.splice(e);else for(;n.length<e;)n.push("");for(;o<n.length;o++)n[o]=n[o].trim().replace(/\\\|/g,"|");return n}function le(t,e,r){var n=t.length;if(0===n)return"";for(var o=0;o<n;){var i=t.charAt(n-o-1);if(i!==e||r){if(i===e||!r)break;o++}else o++}return t.slice(0,n-o)}function fe(t,e,r,n){var o=e.href,i=e.title?re(e.title):null,a=t[1].replace(/\\([\[\]])/g,"$1");if("!"!==t[0].charAt(0)){n.state.inLink=!0;var u={type:"link",raw:r,href:o,title:i,text:a,tokens:n.inlineTokens(a)};return n.state.inLink=!1,u}return{type:"image",raw:r,href:o,title:i,text:re(a)}}var pe=function(){return $t((function t(e){Ut(this,t),qt(this,"options",void 0),qt(this,"rules",void 0),qt(this,"lexer",void 0),this.options=e||Yt}),[{key:"space",value:function(t){var e=this.rules.block.newline.exec(t);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}},{key:"code",value:function(t){var e=this.rules.block.code.exec(t);if(e){var r=e[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?r:le(r,"\n")}}}},{key:"fences",value:function(t){var e=this.rules.block.fences.exec(t);if(e){var r=e[0],n=function(t,e){var r=t.match(/^(\s+)(?:```)/);if(null===r)return e;var n=r[1];return e.split("\n").map((function(t){var e,r,o=t.match(/^\s+/);return null===o?t:(e=o,r=1,function(t){if(Array.isArray(t))return t}(e)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],s=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);s=!0);}catch(t){c=!0,o=t}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(e,r)||Ht(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0].length>=n.length?t.slice(n.length):t})).join("\n")}(r,e[3]||"");return{type:"code",raw:r,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:n}}}},{key:"heading",value:function(t){var e=this.rules.block.heading.exec(t);if(e){var r=e[2].trim();if(/#$/.test(r)){var n=le(r,"#");this.options.pedantic?r=n.trim():n&&!/ $/.test(n)||(r=n.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:r,tokens:this.lexer.inline(r)}}}},{key:"hr",value:function(t){var e=this.rules.block.hr.exec(t);if(e)return{type:"hr",raw:e[0]}}},{key:"blockquote",value:function(t){var e=this.rules.block.blockquote.exec(t);if(e){var r=e[0].replace(/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,"\n    $1");r=le(r.replace(/^ *>[ \t]?/gm,""),"\n");var n=this.lexer.state.top;this.lexer.state.top=!0;var o=this.lexer.blockTokens(r);return this.lexer.state.top=n,{type:"blockquote",raw:e[0],tokens:o,text:r}}}},{key:"list",value:function(t){var e=this.rules.block.list.exec(t);if(e){var r=e[1].trim(),n=r.length>1,o={type:"list",raw:"",ordered:n,start:n?+r.slice(0,-1):"",loose:!1,items:[]};r=n?"\\d{1,9}\\".concat(r.slice(-1)):"\\".concat(r),this.options.pedantic&&(r=n?r:"[*+-]");for(var i=new RegExp("^( {0,3}".concat(r,")((?:[\t ][^\\n]*)?(?:\\n|$))")),a="",u="",s=!1;t;){var c=!1;if(!(e=i.exec(t)))break;if(this.rules.block.hr.test(t))break;a=e[0],t=t.substring(a.length);var l=e[2].split("\n",1)[0].replace(/^\t+/,(function(t){return" ".repeat(3*t.length)})),f=t.split("\n",1)[0],p=0;this.options.pedantic?(p=2,u=l.trimStart()):(p=(p=e[2].search(/[^ ]/))>4?1:p,u=l.slice(p),p+=e[1].length);var h=!1;if(!l&&/^ *$/.test(f)&&(a+=f+"\n",t=t.substring(f.length+1),c=!0),!c)for(var d=new RegExp("^ {0,".concat(Math.min(3,p-1),"}(?:[*+-]|\\d{1,9}[.)])((?:[ \t][^\\n]*)?(?:\\n|$))")),y=new RegExp("^ {0,".concat(Math.min(3,p-1),"}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)")),v=new RegExp("^ {0,".concat(Math.min(3,p-1),"}(?:```|~~~)")),m=new RegExp("^ {0,".concat(Math.min(3,p-1),"}#"));t;){var b=t.split("\n",1)[0];if(f=b,this.options.pedantic&&(f=f.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),v.test(f))break;if(m.test(f))break;if(d.test(f))break;if(y.test(t))break;if(f.search(/[^ ]/)>=p||!f.trim())u+="\n"+f.slice(p);else{if(h)break;if(l.search(/[^ ]/)>=4)break;if(v.test(l))break;if(m.test(l))break;if(y.test(l))break;u+="\n"+f}h||f.trim()||(h=!0),a+=b+"\n",t=t.substring(b.length+1),l=f.slice(p)}o.loose||(s?o.loose=!0:/\n *\n *$/.test(a)&&(s=!0));var g=null,w=void 0;this.options.gfm&&(g=/^\[[ xX]\] /.exec(u))&&(w="[ ] "!==g[0],u=u.replace(/^\[[ xX]\] +/,"")),o.items.push({type:"list_item",raw:a,task:!!g,checked:w,loose:!1,text:u,tokens:[]}),o.raw+=a}o.items[o.items.length-1].raw=a.trimEnd(),o.items[o.items.length-1].text=u.trimEnd(),o.raw=o.raw.trimEnd();for(var x=0;x<o.items.length;x++)if(this.lexer.state.top=!1,o.items[x].tokens=this.lexer.blockTokens(o.items[x].text,[]),!o.loose){var _=o.items[x].tokens.filter((function(t){return"space"===t.type})),E=_.length>0&&_.some((function(t){return/\n.*\n/.test(t.raw)}));o.loose=E}if(o.loose)for(var O=0;O<o.items.length;O++)o.items[O].loose=!0;return o}}},{key:"html",value:function(t){var e=this.rules.block.html.exec(t);if(e)return{type:"html",block:!0,raw:e[0],pre:"pre"===e[1]||"script"===e[1]||"style"===e[1],text:e[0]}}},{key:"def",value:function(t){var e=this.rules.block.def.exec(t);if(e){var r=e[1].toLowerCase().replace(/\s+/g," "),n=e[2]?e[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",o=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:r,raw:e[0],href:n,title:o}}}},{key:"table",value:function(t){var e=this,r=this.rules.block.table.exec(t);if(r&&/[:|]/.test(r[2])){var n=ce(r[1]),o=r[2].replace(/^\||\| *$/g,"").split("|"),i=r[3]&&r[3].trim()?r[3].replace(/\n[ \t]*$/,"").split("\n"):[],a={type:"table",raw:r[0],header:[],align:[],rows:[]};if(n.length===o.length){var u,s=Gt(o);try{for(s.s();!(u=s.n()).done;){var c=u.value;/^ *-+: *$/.test(c)?a.align.push("right"):/^ *:-+: *$/.test(c)?a.align.push("center"):/^ *:-+ *$/.test(c)?a.align.push("left"):a.align.push(null)}}catch(t){s.e(t)}finally{s.f()}var l,f=Gt(n);try{for(f.s();!(l=f.n()).done;){var p=l.value;a.header.push({text:p,tokens:this.lexer.inline(p)})}}catch(t){f.e(t)}finally{f.f()}var h,d=Gt(i);try{for(d.s();!(h=d.n()).done;){var y=h.value;a.rows.push(ce(y,a.header.length).map((function(t){return{text:t,tokens:e.lexer.inline(t)}})))}}catch(t){d.e(t)}finally{d.f()}return a}}}},{key:"lheading",value:function(t){var e=this.rules.block.lheading.exec(t);if(e)return{type:"heading",raw:e[0],depth:"="===e[2].charAt(0)?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}},{key:"paragraph",value:function(t){var e=this.rules.block.paragraph.exec(t);if(e){var r="\n"===e[1].charAt(e[1].length-1)?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:r,tokens:this.lexer.inline(r)}}}},{key:"text",value:function(t){var e=this.rules.block.text.exec(t);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}},{key:"escape",value:function(t){var e=this.rules.inline.escape.exec(t);if(e)return{type:"escape",raw:e[0],text:re(e[1])}}},{key:"tag",value:function(t){var e=this.rules.inline.tag.exec(t);if(e)return!this.lexer.state.inLink&&/^<a /i.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}},{key:"link",value:function(t){var e=this.rules.inline.link.exec(t);if(e){var r=e[2].trim();if(!this.options.pedantic&&/^</.test(r)){if(!/>$/.test(r))return;var n=le(r.slice(0,-1),"\\");if((r.length-n.length)%2==0)return}else{var o=function(t,e){if(-1===t.indexOf(e[1]))return-1;for(var r=0,n=0;n<t.length;n++)if("\\"===t[n])n++;else if(t[n]===e[0])r++;else if(t[n]===e[1]&&--r<0)return n;return-1}(e[2],"()");if(o>-1){var i=(0===e[0].indexOf("!")?5:4)+e[1].length+o;e[2]=e[2].substring(0,o),e[0]=e[0].substring(0,i).trim(),e[3]=""}}var a=e[2],u="";if(this.options.pedantic){var s=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(a);s&&(a=s[1],u=s[3])}else u=e[3]?e[3].slice(1,-1):"";return a=a.trim(),/^</.test(a)&&(a=this.options.pedantic&&!/>$/.test(r)?a.slice(1):a.slice(1,-1)),fe(e,{href:a?a.replace(this.rules.inline.anyPunctuation,"$1"):a,title:u?u.replace(this.rules.inline.anyPunctuation,"$1"):u},e[0],this.lexer)}}},{key:"reflink",value:function(t,e){var r;if((r=this.rules.inline.reflink.exec(t))||(r=this.rules.inline.nolink.exec(t))){var n=e[(r[2]||r[1]).replace(/\s+/g," ").toLowerCase()];if(!n){var o=r[0].charAt(0);return{type:"text",raw:o,text:o}}return fe(r,n,r[0],this.lexer)}}},{key:"emStrong",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=this.rules.inline.emStrongLDelim.exec(t);if(n&&(!n[3]||!r.match(/(?:[0-9A-Za-z\xAA\xB2\xB3\xB5\xB9\xBA\xBC-\xBE\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u0660-\u0669\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07C0-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0966-\u096F\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09E6-\u09F1\u09F4-\u09F9\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A66-\u0A6F\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AE6-\u0AEF\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B66-\u0B6F\u0B71-\u0B77\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0BE6-\u0BF2\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C66-\u0C6F\u0C78-\u0C7E\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CE6-\u0CEF\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D58-\u0D61\u0D66-\u0D78\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DE6-\u0DEF\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F20-\u0F33\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F-\u1049\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u1090-\u1099\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1369-\u137C\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u17E0-\u17E9\u17F0-\u17F9\u1810-\u1819\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A16\u1A20-\u1A54\u1A80-\u1A89\u1A90-\u1A99\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B50-\u1B59\u1B83-\u1BA0\u1BAE-\u1BE5\u1C00-\u1C23\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2070\u2071\u2074-\u2079\u207F-\u2089\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2150-\u2189\u2460-\u249B\u24EA-\u24FF\u2776-\u2793\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2CFD\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u3192-\u3195\u31A0-\u31BF\u31F0-\u31FF\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CD\uA7D0\uA7D1\uA7D3\uA7D5-\uA7DC\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA830-\uA835\uA840-\uA873\uA882-\uA8B3\uA8D0-\uA8D9\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA900-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF-\uA9D9\uA9E0-\uA9E4\uA9E6-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA50-\uAA59\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD07-\uDD33\uDD40-\uDD78\uDD8A\uDD8B\uDE80-\uDE9C\uDEA0-\uDED0\uDEE1-\uDEFB\uDF00-\uDF23\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDDC0-\uDDF3\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC58-\uDC76\uDC79-\uDC9E\uDCA7-\uDCAF\uDCE0-\uDCF2\uDCF4\uDCF5\uDCFB-\uDD1B\uDD20-\uDD39\uDD80-\uDDB7\uDDBC-\uDDCF\uDDD2-\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE40-\uDE48\uDE60-\uDE7E\uDE80-\uDE9F\uDEC0-\uDEC7\uDEC9-\uDEE4\uDEEB-\uDEEF\uDF00-\uDF35\uDF40-\uDF55\uDF58-\uDF72\uDF78-\uDF91\uDFA9-\uDFAF]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDCFA-\uDD23\uDD30-\uDD39\uDD40-\uDD65\uDD6F-\uDD85\uDE60-\uDE7E\uDE80-\uDEA9\uDEB0\uDEB1\uDEC2-\uDEC4\uDF00-\uDF27\uDF30-\uDF45\uDF51-\uDF54\uDF70-\uDF81\uDFB0-\uDFCB\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC52-\uDC6F\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD03-\uDD26\uDD36-\uDD3F\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDD0-\uDDDA\uDDDC\uDDE1-\uDDF4\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDEF0-\uDEF9\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61\uDF80-\uDF89\uDF8B\uDF8E\uDF90-\uDFB5\uDFB7\uDFD1\uDFD3]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC50-\uDC59\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE50-\uDE59\uDE80-\uDEAA\uDEB8\uDEC0-\uDEC9\uDED0-\uDEE3\uDF00-\uDF1A\uDF30-\uDF3B\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCF2\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDD50-\uDD59\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8\uDFC0-\uDFE0\uDFF0-\uDFF9]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC50-\uDC6C\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD50-\uDD59\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDDA0-\uDDA9\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDF50-\uDF59\uDFB0\uDFC0-\uDFD4]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD80E\uD80F\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46\uDC60-\uDFFF]|\uD810[\uDC00-\uDFFA]|\uD811[\uDC00-\uDE46]|\uD818[\uDD00-\uDD1D\uDD30-\uDD39]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDE70-\uDEBE\uDEC0-\uDEC9\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF50-\uDF59\uDF5B-\uDF61\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDD40-\uDD6C\uDD70-\uDD79\uDE40-\uDE96\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD833[\uDCF0-\uDCF9]|\uD834[\uDEC0-\uDED3\uDEE0-\uDEF3\uDF60-\uDF78]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD40-\uDD49\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB\uDEF0-\uDEF9]|\uD839[\uDCD0-\uDCEB\uDCF0-\uDCF9\uDDD0-\uDDED\uDDF0-\uDDFA\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDCC7-\uDCCF\uDD00-\uDD43\uDD4B\uDD50-\uDD59]|\uD83B[\uDC71-\uDCAB\uDCAD-\uDCAF\uDCB1-\uDCB4\uDD01-\uDD2D\uDD2F-\uDD3D\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD83C[\uDD00-\uDD0C]|\uD83E[\uDFF0-\uDFF9]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])/))&&(!n[1]&&!n[2]||!r||this.rules.inline.punctuation.exec(r))){var o,i,a=Bt(n[0]).length-1,u=a,s=0,c="*"===n[0][0]?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(c.lastIndex=0,e=e.slice(-1*t.length+a);null!=(n=c.exec(e));)if(o=n[1]||n[2]||n[3]||n[4]||n[5]||n[6])if(i=Bt(o).length,n[3]||n[4])u+=i;else if(!((n[5]||n[6])&&a%3)||(a+i)%3){if(!((u-=i)>0)){i=Math.min(i,i+u+s);var l=Bt(n[0])[0].length,f=t.slice(0,a+n.index+l+i);if(Math.min(a,i)%2){var p=f.slice(1,-1);return{type:"em",raw:f,text:p,tokens:this.lexer.inlineTokens(p)}}var h=f.slice(2,-2);return{type:"strong",raw:f,text:h,tokens:this.lexer.inlineTokens(h)}}}else s+=i}}},{key:"codespan",value:function(t){var e=this.rules.inline.code.exec(t);if(e){var r=e[2].replace(/\n/g," "),n=/[^ ]/.test(r),o=/^ /.test(r)&&/ $/.test(r);return n&&o&&(r=r.substring(1,r.length-1)),r=re(r,!0),{type:"codespan",raw:e[0],text:r}}}},{key:"br",value:function(t){var e=this.rules.inline.br.exec(t);if(e)return{type:"br",raw:e[0]}}},{key:"del",value:function(t){var e=this.rules.inline.del.exec(t);if(e)return{type:"del",raw:e[0],text:e[2],tokens:this.lexer.inlineTokens(e[2])}}},{key:"autolink",value:function(t){var e,r,n=this.rules.inline.autolink.exec(t);if(n)return r="@"===n[2]?"mailto:"+(e=re(n[1])):e=re(n[1]),{type:"link",raw:n[0],text:e,href:r,tokens:[{type:"text",raw:e,text:e}]}}},{key:"url",value:function(t){var e;if(e=this.rules.inline.url.exec(t)){var r,n;if("@"===e[2])n="mailto:"+(r=re(e[0]));else{var o;do{var i,a;o=e[0],e[0]=null!==(i=null===(a=this.rules.inline._backpedal.exec(e[0]))||void 0===a?void 0:a[0])&&void 0!==i?i:""}while(o!==e[0]);r=re(e[0]),n="www."===e[1]?"http://"+e[0]:e[0]}return{type:"link",raw:e[0],text:r,href:n,tokens:[{type:"text",raw:r,text:r}]}}}},{key:"inlineText",value:function(t){var e,r=this.rules.inline.text.exec(t);if(r)return e=this.lexer.state.inRawBlock?r[0]:re(r[0]),{type:"text",raw:r[0],text:e}}}])}(),he=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,de=/(?:[*+-]|\d{1,9}[.)])/,ye=ae(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,de).replace(/blockCode/g,/ {4}/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),ve=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,me=/(?!\s*\])(?:\\.|[^\[\]\\])+/,be=ae(/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/).replace("label",me).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),ge=ae(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,de).getRegex(),we="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",xe=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,_e=ae("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))","i").replace("comment",xe).replace("tag",we).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Ee=ae(ve).replace("hr",he).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",we).getRegex(),Oe={blockquote:ae(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Ee).getRegex(),code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,def:be,fences:/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,hr:he,html:_e,lheading:ye,list:ge,newline:/^(?: *(?:\n|$))+/,paragraph:Ee,table:se,text:/^[^\n]+/},ke=ae("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",he).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",we).getRegex(),je=Mt(Mt({},Oe),{},{table:ke,paragraph:ae(ve).replace("hr",he).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",ke).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",we).getRegex()}),Se=Mt(Mt({},Oe),{},{html:ae("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",xe).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:se,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:ae(ve).replace("hr",he).replace("heading"," *#{1,6} *[^\n]").replace("lheading",ye).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()}),Ae=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,De=/^( {2,}|\\)\n(?!\s*$)/,Pe="\\p{P}\\p{S}",Ce=ae(/^((?![*_])[\spunctuation])/,"u").replace(/punctuation/g,Pe).getRegex(),Le=ae(/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,"u").replace(/punct/g,Pe).getRegex(),Te=ae("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)[punct](\\*+)(?=[\\s]|$)|[^punct\\s](\\*+)(?!\\*)(?=[punct\\s]|$)|(?!\\*)[punct\\s](\\*+)(?=[^punct\\s])|[\\s](\\*+)(?!\\*)(?=[punct])|(?!\\*)[punct](\\*+)(?!\\*)(?=[punct])|[^punct\\s](\\*+)(?=[^punct\\s])","gu").replace(/punct/g,Pe).getRegex(),Fe=ae("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\\s]|$)|[^punct\\s](_+)(?!_)(?=[punct\\s]|$)|(?!_)[punct\\s](_+)(?=[^punct\\s])|[\\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])","gu").replace(/punct/g,Pe).getRegex(),Ie=ae(/\\([punct])/,"gu").replace(/punct/g,Pe).getRegex(),Ne=ae(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),Re=ae(xe).replace("(?:--\x3e|$)","--\x3e").getRegex(),Me=ae("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",Re).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),Be=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,Ge=ae(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",Be).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Ue=ae(/^!?\[(label)\]\[(ref)\]/).replace("label",Be).replace("ref",me).getRegex(),ze=ae(/^!?\[(ref)\](?:\[\])?/).replace("ref",me).getRegex(),$e={_backpedal:se,anyPunctuation:Ie,autolink:Ne,blockSkip:/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g,br:De,code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,del:se,emStrongLDelim:Le,emStrongRDelimAst:Te,emStrongRDelimUnd:Fe,escape:Ae,link:Ge,nolink:ze,punctuation:Ce,reflink:Ue,reflinkSearch:ae("reflink|nolink(?!\\()","g").replace("reflink",Ue).replace("nolink",ze).getRegex(),tag:Me,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,url:se},qe=Mt(Mt({},$e),{},{link:ae(/^!?\[(label)\]\((.*?)\)/).replace("label",Be).getRegex(),reflink:ae(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Be).getRegex()}),Ke=Mt(Mt({},$e),{},{escape:ae(Ae).replace("])","~|])").getRegex(),url:ae(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/}),He=Mt(Mt({},Ke),{},{br:ae(De).replace("{2,}","*").getRegex(),text:ae(Ke.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()}),Ze={normal:Oe,gfm:je,pedantic:Se},Ye={normal:$e,gfm:Ke,breaks:He,pedantic:qe},Ve=function(){function t(e){Ut(this,t),qt(this,"tokens",void 0),qt(this,"options",void 0),qt(this,"state",void 0),qt(this,"tokenizer",void 0),qt(this,"inlineQueue",void 0),this.tokens=[],this.tokens.links=Object.create(null),this.options=e||Yt,this.options.tokenizer=this.options.tokenizer||new pe,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};var r={block:Ze.normal,inline:Ye.normal};this.options.pedantic?(r.block=Ze.pedantic,r.inline=Ye.pedantic):this.options.gfm&&(r.block=Ze.gfm,this.options.breaks?r.inline=Ye.breaks:r.inline=Ye.gfm),this.tokenizer.rules=r}return $t(t,[{key:"lex",value:function(t){t=t.replace(/\r\n|\r/g,"\n"),this.blockTokens(t,this.tokens);for(var e=0;e<this.inlineQueue.length;e++){var r=this.inlineQueue[e];this.inlineTokens(r.src,r.tokens)}return this.inlineQueue=[],this.tokens}},{key:"blockTokens",value:function(t){var e,r,n,o,i=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];t=this.options.pedantic?t.replace(/\t/g,"    ").replace(/^ +$/gm,""):t.replace(/^( *)(\t+)/gm,(function(t,e,r){return e+"    ".repeat(r.length)}));for(var u,s=function(){if(i.options.extensions&&i.options.extensions.block&&i.options.extensions.block.some((function(r){return!!(e=r.call({lexer:i},t,a))&&(t=t.substring(e.raw.length),a.push(e),!0)})))return 0;if(e=i.tokenizer.space(t))return t=t.substring(e.raw.length),1===e.raw.length&&a.length>0?a[a.length-1].raw+="\n":a.push(e),0;if(e=i.tokenizer.code(t))return t=t.substring(e.raw.length),!(r=a[a.length-1])||"paragraph"!==r.type&&"text"!==r.type?a.push(e):(r.raw+="\n"+e.raw,r.text+="\n"+e.text,i.inlineQueue[i.inlineQueue.length-1].src=r.text),0;if(e=i.tokenizer.fences(t))return t=t.substring(e.raw.length),a.push(e),0;if(e=i.tokenizer.heading(t))return t=t.substring(e.raw.length),a.push(e),0;if(e=i.tokenizer.hr(t))return t=t.substring(e.raw.length),a.push(e),0;if(e=i.tokenizer.blockquote(t))return t=t.substring(e.raw.length),a.push(e),0;if(e=i.tokenizer.list(t))return t=t.substring(e.raw.length),a.push(e),0;if(e=i.tokenizer.html(t))return t=t.substring(e.raw.length),a.push(e),0;if(e=i.tokenizer.def(t))return t=t.substring(e.raw.length),!(r=a[a.length-1])||"paragraph"!==r.type&&"text"!==r.type?i.tokens.links[e.tag]||(i.tokens.links[e.tag]={href:e.href,title:e.title}):(r.raw+="\n"+e.raw,r.text+="\n"+e.raw,i.inlineQueue[i.inlineQueue.length-1].src=r.text),0;if(e=i.tokenizer.table(t))return t=t.substring(e.raw.length),a.push(e),0;if(e=i.tokenizer.lheading(t))return t=t.substring(e.raw.length),a.push(e),0;if(n=t,i.options.extensions&&i.options.extensions.startBlock){var u,s=1/0,c=t.slice(1);i.options.extensions.startBlock.forEach((function(t){"number"==typeof(u=t.call({lexer:i},c))&&u>=0&&(s=Math.min(s,u))})),s<1/0&&s>=0&&(n=t.substring(0,s+1))}if(i.state.top&&(e=i.tokenizer.paragraph(n)))return r=a[a.length-1],o&&"paragraph"===r.type?(r.raw+="\n"+e.raw,r.text+="\n"+e.text,i.inlineQueue.pop(),i.inlineQueue[i.inlineQueue.length-1].src=r.text):a.push(e),o=n.length!==t.length,t=t.substring(e.raw.length),0;if(e=i.tokenizer.text(t))return t=t.substring(e.raw.length),(r=a[a.length-1])&&"text"===r.type?(r.raw+="\n"+e.raw,r.text+="\n"+e.text,i.inlineQueue.pop(),i.inlineQueue[i.inlineQueue.length-1].src=r.text):a.push(e),0;if(t){var l="Infinite loop on byte: "+t.charCodeAt(0);if(i.options.silent)return console.error(l),1;throw new Error(l)}};t&&(0===(u=s())||1!==u););return this.state.top=!0,a}},{key:"inline",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return this.inlineQueue.push({src:t,tokens:e}),e}},{key:"inlineTokens",value:function(t){var e,r,n,o,i,a,u=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],c=t;if(this.tokens.links){var l=Object.keys(this.tokens.links);if(l.length>0)for(;null!=(o=this.tokenizer.rules.inline.reflinkSearch.exec(c));)l.includes(o[0].slice(o[0].lastIndexOf("[")+1,-1))&&(c=c.slice(0,o.index)+"["+"a".repeat(o[0].length-2)+"]"+c.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;null!=(o=this.tokenizer.rules.inline.blockSkip.exec(c));)c=c.slice(0,o.index)+"["+"a".repeat(o[0].length-2)+"]"+c.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;null!=(o=this.tokenizer.rules.inline.anyPunctuation.exec(c));)c=c.slice(0,o.index)+"++"+c.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(var f,p=function(){if(i||(a=""),i=!1,u.options.extensions&&u.options.extensions.inline&&u.options.extensions.inline.some((function(r){return!!(e=r.call({lexer:u},t,s))&&(t=t.substring(e.raw.length),s.push(e),!0)})))return 0;if(e=u.tokenizer.escape(t))return t=t.substring(e.raw.length),s.push(e),0;if(e=u.tokenizer.tag(t))return t=t.substring(e.raw.length),(r=s[s.length-1])&&"text"===e.type&&"text"===r.type?(r.raw+=e.raw,r.text+=e.text):s.push(e),0;if(e=u.tokenizer.link(t))return t=t.substring(e.raw.length),s.push(e),0;if(e=u.tokenizer.reflink(t,u.tokens.links))return t=t.substring(e.raw.length),(r=s[s.length-1])&&"text"===e.type&&"text"===r.type?(r.raw+=e.raw,r.text+=e.text):s.push(e),0;if(e=u.tokenizer.emStrong(t,c,a))return t=t.substring(e.raw.length),s.push(e),0;if(e=u.tokenizer.codespan(t))return t=t.substring(e.raw.length),s.push(e),0;if(e=u.tokenizer.br(t))return t=t.substring(e.raw.length),s.push(e),0;if(e=u.tokenizer.del(t))return t=t.substring(e.raw.length),s.push(e),0;if(e=u.tokenizer.autolink(t))return t=t.substring(e.raw.length),s.push(e),0;if(!u.state.inLink&&(e=u.tokenizer.url(t)))return t=t.substring(e.raw.length),s.push(e),0;if(n=t,u.options.extensions&&u.options.extensions.startInline){var o,l=1/0,f=t.slice(1);u.options.extensions.startInline.forEach((function(t){"number"==typeof(o=t.call({lexer:u},f))&&o>=0&&(l=Math.min(l,o))})),l<1/0&&l>=0&&(n=t.substring(0,l+1))}if(e=u.tokenizer.inlineText(n))return t=t.substring(e.raw.length),"_"!==e.raw.slice(-1)&&(a=e.raw.slice(-1)),i=!0,(r=s[s.length-1])&&"text"===r.type?(r.raw+=e.raw,r.text+=e.text):s.push(e),0;if(t){var p="Infinite loop on byte: "+t.charCodeAt(0);if(u.options.silent)return console.error(p),1;throw new Error(p)}};t&&(0===(f=p())||1!==f););return s}}],[{key:"rules",get:function(){return{block:Ze,inline:Ye}}},{key:"lex",value:function(e,r){return new t(r).lex(e)}},{key:"lexInline",value:function(e,r){return new t(r).inlineTokens(e)}}])}(),We=function(){return $t((function t(e){Ut(this,t),qt(this,"options",void 0),this.options=e||Yt}),[{key:"code",value:function(t,e,r){var n,o=null===(n=(e||"").match(/^\S*/))||void 0===n?void 0:n[0];return t=t.replace(/\n$/,"")+"\n",o?'<pre><code class="language-'+re(o)+'">'+(r?t:re(t,!0))+"</code></pre>\n":"<pre><code>"+(r?t:re(t,!0))+"</code></pre>\n"}},{key:"blockquote",value:function(t){return"<blockquote>\n".concat(t,"</blockquote>\n")}},{key:"html",value:function(t,e){return t}},{key:"heading",value:function(t,e,r){return"<h".concat(e,">").concat(t,"</h").concat(e,">\n")}},{key:"hr",value:function(){return"<hr>\n"}},{key:"list",value:function(t,e,r){var n=e?"ol":"ul";return"<"+n+(e&&1!==r?' start="'+r+'"':"")+">\n"+t+"</"+n+">\n"}},{key:"listitem",value:function(t,e,r){return"<li>".concat(t,"</li>\n")}},{key:"checkbox",value:function(t){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox">'}},{key:"paragraph",value:function(t){return"<p>".concat(t,"</p>\n")}},{key:"table",value:function(t,e){return e&&(e="<tbody>".concat(e,"</tbody>")),"<table>\n<thead>\n"+t+"</thead>\n"+e+"</table>\n"}},{key:"tablerow",value:function(t){return"<tr>\n".concat(t,"</tr>\n")}},{key:"tablecell",value:function(t,e){var r=e.header?"th":"td";return(e.align?"<".concat(r,' align="').concat(e.align,'">'):"<".concat(r,">"))+t+"</".concat(r,">\n")}},{key:"strong",value:function(t){return"<strong>".concat(t,"</strong>")}},{key:"em",value:function(t){return"<em>".concat(t,"</em>")}},{key:"codespan",value:function(t){return"<code>".concat(t,"</code>")}},{key:"br",value:function(){return"<br>"}},{key:"del",value:function(t){return"<del>".concat(t,"</del>")}},{key:"link",value:function(t,e,r){var n=ue(t);if(null===n)return r;var o='<a href="'+(t=n)+'"';return e&&(o+=' title="'+e+'"'),o+">"+r+"</a>"}},{key:"image",value:function(t,e,r){var n=ue(t);if(null===n)return r;var o='<img src="'.concat(t=n,'" alt="').concat(r,'"');return e&&(o+=' title="'.concat(e,'"')),o+">"}},{key:"text",value:function(t){return t}}])}(),Je=function(){return $t((function t(){Ut(this,t)}),[{key:"strong",value:function(t){return t}},{key:"em",value:function(t){return t}},{key:"codespan",value:function(t){return t}},{key:"del",value:function(t){return t}},{key:"html",value:function(t){return t}},{key:"text",value:function(t){return t}},{key:"link",value:function(t,e,r){return""+r}},{key:"image",value:function(t,e,r){return""+r}},{key:"br",value:function(){return""}}])}(),Xe=function(){function t(e){Ut(this,t),qt(this,"options",void 0),qt(this,"renderer",void 0),qt(this,"textRenderer",void 0),this.options=e||Yt,this.options.renderer=this.options.renderer||new We,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new Je}return $t(t,[{key:"parse",value:function(t){for(var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r="",n=0;n<t.length;n++){var o=t[n];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[o.type]){var i=o,a=this.options.extensions.renderers[i.type].call({parser:this},i);if(!1!==a||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(i.type)){r+=a||"";continue}}switch(o.type){case"space":continue;case"hr":r+=this.renderer.hr();continue;case"heading":var u=o;r+=this.renderer.heading(this.parseInline(u.tokens),u.depth,oe(this.parseInline(u.tokens,this.textRenderer)));continue;case"code":var s=o;r+=this.renderer.code(s.text,s.lang,!!s.escaped);continue;case"table":for(var c=o,l="",f="",p=0;p<c.header.length;p++)f+=this.renderer.tablecell(this.parseInline(c.header[p].tokens),{header:!0,align:c.align[p]});l+=this.renderer.tablerow(f);for(var h="",d=0;d<c.rows.length;d++){var y=c.rows[d];f="";for(var v=0;v<y.length;v++)f+=this.renderer.tablecell(this.parseInline(y[v].tokens),{header:!1,align:c.align[v]});h+=this.renderer.tablerow(f)}r+=this.renderer.table(l,h);continue;case"blockquote":var m=o,b=this.parse(m.tokens);r+=this.renderer.blockquote(b);continue;case"list":for(var g=o,w=g.ordered,x=g.start,_=g.loose,E="",O=0;O<g.items.length;O++){var k=g.items[O],j=k.checked,S=k.task,A="";if(k.task){var D=this.renderer.checkbox(!!j);_?k.tokens.length>0&&"paragraph"===k.tokens[0].type?(k.tokens[0].text=D+" "+k.tokens[0].text,k.tokens[0].tokens&&k.tokens[0].tokens.length>0&&"text"===k.tokens[0].tokens[0].type&&(k.tokens[0].tokens[0].text=D+" "+k.tokens[0].tokens[0].text)):k.tokens.unshift({type:"text",text:D+" "}):A+=D+" "}A+=this.parse(k.tokens,_),E+=this.renderer.listitem(A,S,!!j)}r+=this.renderer.list(E,w,x);continue;case"html":var P=o;r+=this.renderer.html(P.text,P.block);continue;case"paragraph":var C=o;r+=this.renderer.paragraph(this.parseInline(C.tokens));continue;case"text":for(var L=o,T=L.tokens?this.parseInline(L.tokens):L.text;n+1<t.length&&"text"===t[n+1].type;)T+="\n"+((L=t[++n]).tokens?this.parseInline(L.tokens):L.text);r+=e?this.renderer.paragraph(T):T;continue;default:var F='Token with "'+o.type+'" type was not found.';if(this.options.silent)return console.error(F),"";throw new Error(F)}}return r}},{key:"parseInline",value:function(t,e){e=e||this.renderer;for(var r="",n=0;n<t.length;n++){var o=t[n];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[o.type]){var i=this.options.extensions.renderers[o.type].call({parser:this},o);if(!1!==i||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(o.type)){r+=i||"";continue}}switch(o.type){case"escape":var a=o;r+=e.text(a.text);break;case"html":var u=o;r+=e.html(u.text);break;case"link":var s=o;r+=e.link(s.href,s.title,this.parseInline(s.tokens,e));break;case"image":var c=o;r+=e.image(c.href,c.title,c.text);break;case"strong":var l=o;r+=e.strong(this.parseInline(l.tokens,e));break;case"em":var f=o;r+=e.em(this.parseInline(f.tokens,e));break;case"codespan":var p=o;r+=e.codespan(p.text);break;case"br":r+=e.br();break;case"del":var h=o;r+=e.del(this.parseInline(h.tokens,e));break;case"text":var d=o;r+=e.text(d.text);break;default:var y='Token with "'+o.type+'" type was not found.';if(this.options.silent)return console.error(y),"";throw new Error(y)}}return r}}],[{key:"parse",value:function(e,r){return new t(r).parse(e)}},{key:"parseInline",value:function(e,r){return new t(r).parseInline(e)}}])}(),Qe=function(){return $t((function t(e){Ut(this,t),qt(this,"options",void 0),this.options=e||Yt}),[{key:"preprocess",value:function(t){return t}},{key:"postprocess",value:function(t){return t}},{key:"processAllTokens",value:function(t){return t}}])}();qt(Qe,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"]));var tr=new WeakSet;function er(t,e){var r=this;return function(n,o){var i=Mt({},o),a=Mt(Mt({},r.defaults),i);!0===r.defaults.async&&!1===i.async&&(a.silent||console.warn("marked(): The async option was set to true by an extension. The async: false option sent to parse will be ignored."),a.async=!0);var u=Nt(tr,r,rr).call(r,!!a.silent,!!a.async);if(null==n)return u(new Error("marked(): input parameter is undefined or null"));if("string"!=typeof n)return u(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(n)+", string expected"));if(a.hooks&&(a.hooks.options=a),a.async)return Promise.resolve(a.hooks?a.hooks.preprocess(n):n).then((function(e){return t(e,a)})).then((function(t){return a.hooks?a.hooks.processAllTokens(t):t})).then((function(t){return a.walkTokens?Promise.all(r.walkTokens(t,a.walkTokens)).then((function(){return t})):t})).then((function(t){return e(t,a)})).then((function(t){return a.hooks?a.hooks.postprocess(t):t})).catch(u);try{a.hooks&&(n=a.hooks.preprocess(n));var s=t(n,a);a.hooks&&(s=a.hooks.processAllTokens(s)),a.walkTokens&&r.walkTokens(s,a.walkTokens);var c=e(s,a);return a.hooks&&(c=a.hooks.postprocess(c)),c}catch(t){return u(t)}}}function rr(t,e){return function(r){if(r.message+="\nPlease report this to https://github.com/markedjs/marked.",t){var n="<p>An error occurred:</p><pre>"+re(r.message+"",!0)+"</pre>";return e?Promise.resolve(n):n}if(e)return Promise.reject(r);throw r}}var nr=new(function(){return $t((function t(){var e,r;Ut(this,t),function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e=this,r=tr),r.add(e),qt(this,"defaults",{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}),qt(this,"options",this.setOptions),qt(this,"parse",Nt(tr,this,er).call(this,Ve.lex,Xe.parse)),qt(this,"parseInline",Nt(tr,this,er).call(this,Ve.lexInline,Xe.parseInline)),qt(this,"Parser",Xe),qt(this,"Renderer",We),qt(this,"TextRenderer",Je),qt(this,"Lexer",Ve),qt(this,"Tokenizer",pe),qt(this,"Hooks",Qe),this.use.apply(this,arguments)}),[{key:"walkTokens",value:function(t,e){var r,n=this,o=[],i=Gt(t);try{var a=function(){var t=r.value;switch(o=o.concat(e.call(n,t)),t.type){case"table":var i,a=t,u=Gt(a.header);try{for(u.s();!(i=u.n()).done;){var s=i.value;o=o.concat(n.walkTokens(s.tokens,e))}}catch(t){u.e(t)}finally{u.f()}var c,l=Gt(a.rows);try{for(l.s();!(c=l.n()).done;){var f,p=Gt(c.value);try{for(p.s();!(f=p.n()).done;){var h=f.value;o=o.concat(n.walkTokens(h.tokens,e))}}catch(t){p.e(t)}finally{p.f()}}}catch(t){l.e(t)}finally{l.f()}break;case"list":var d=t;o=o.concat(n.walkTokens(d.items,e));break;default:var y,v=t;null!==(y=n.defaults.extensions)&&void 0!==y&&null!==(y=y.childTokens)&&void 0!==y&&y[v.type]?n.defaults.extensions.childTokens[v.type].forEach((function(t){var r=v[t].flat(1/0);o=o.concat(n.walkTokens(r,e))})):v.tokens&&(o=o.concat(n.walkTokens(v.tokens,e)))}};for(i.s();!(r=i.n()).done;)a()}catch(t){i.e(t)}finally{i.f()}return o}},{key:"use",value:function(){for(var t=this,e=this.defaults.extensions||{renderers:{},childTokens:{}},r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return n.forEach((function(r){var n=Mt({},r);if(n.async=t.defaults.async||n.async||!1,r.extensions&&(r.extensions.forEach((function(t){if(!t.name)throw new Error("extension name required");if("renderer"in t){var r=e.renderers[t.name];e.renderers[t.name]=r?function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];var i=t.renderer.apply(this,n);return!1===i&&(i=r.apply(this,n)),i}:t.renderer}if("tokenizer"in t){if(!t.level||"block"!==t.level&&"inline"!==t.level)throw new Error("extension level must be 'block' or 'inline'");var n=e[t.level];n?n.unshift(t.tokenizer):e[t.level]=[t.tokenizer],t.start&&("block"===t.level?e.startBlock?e.startBlock.push(t.start):e.startBlock=[t.start]:"inline"===t.level&&(e.startInline?e.startInline.push(t.start):e.startInline=[t.start]))}"childTokens"in t&&t.childTokens&&(e.childTokens[t.name]=t.childTokens)})),n.extensions=e),r.renderer){var o=t.defaults.renderer||new We(t.defaults),i=function(){if(!(a in o))throw new Error("renderer '".concat(a,"' does not exist"));if("options"===a)return 1;var t=a,e=r.renderer[t],n=o[t];o[t]=function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];var a=e.apply(o,r);return!1===a&&(a=n.apply(o,r)),a||""}};for(var a in r.renderer)i();n.renderer=o}if(r.tokenizer){var u=t.defaults.tokenizer||new pe(t.defaults),s=function(){if(!(c in u))throw new Error("tokenizer '".concat(c,"' does not exist"));if(["options","rules","lexer"].includes(c))return 1;var t=c,e=r.tokenizer[t],n=u[t];u[t]=function(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];var i=e.apply(u,r);return!1===i&&(i=n.apply(u,r)),i}};for(var c in r.tokenizer)s();n.tokenizer=u}if(r.hooks){var l=t.defaults.hooks||new Qe,f=function(){if(!(p in l))throw new Error("hook '".concat(p,"' does not exist"));if("options"===p)return 1;var e=p,n=r.hooks[e],o=l[e];Qe.passThroughHooks.has(p)?l[e]=function(e){if(t.defaults.async)return Promise.resolve(n.call(l,e)).then((function(t){return o.call(l,t)}));var r=n.call(l,e);return o.call(l,r)}:l[e]=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var i=n.apply(l,e);return!1===i&&(i=o.apply(l,e)),i}};for(var p in r.hooks)f();n.hooks=l}if(r.walkTokens){var h=t.defaults.walkTokens,d=r.walkTokens;n.walkTokens=function(t){var e=[];return e.push(d.call(this,t)),h&&(e=e.concat(h.call(this,t))),e}}t.defaults=Mt(Mt({},t.defaults),n)})),this}},{key:"setOptions",value:function(t){return this.defaults=Mt(Mt({},this.defaults),t),this}},{key:"lexer",value:function(t,e){return Ve.lex(t,null!=e?e:this.defaults)}},{key:"parser",value:function(t,e){return Xe.parse(t,null!=e?e:this.defaults)}}])}());function or(t,e){return nr.parse(t,e)}or.options=or.setOptions=function(t){return nr.setOptions(t),or.defaults=nr.defaults,Vt(or.defaults),or},or.getDefaults=function(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}},or.defaults=Yt,or.use=function(){return nr.use.apply(nr,arguments),or.defaults=nr.defaults,Vt(or.defaults),or},or.walkTokens=function(t,e){return nr.walkTokens(t,e)},or.parseInline=nr.parseInline,or.Parser=Xe,or.parser=Xe.parse,or.Renderer=We,or.TextRenderer=Je,or.Lexer=Ve,or.lexer=Ve.lex,or.Tokenizer=pe,or.Hooks=Qe,or.parse=or,or.options,or.setOptions,or.use,or.walkTokens,or.parseInline,Xe.parse,Ve.lex;var ir=o(7551);function ar(t){return ar="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ar(t)}function ur(){ur=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new P(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function b(){}function g(){}var w={};c(w,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(w=_);var E=g.prototype=m.prototype=Object.create(w);function O(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,i,a,u){var s=f(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==ar(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=S(u,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?y:h,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=y,n.method="throw",n.arg=c.arg)}}}function S(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,S(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function C(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(ar(e)+" is not iterable")}return b.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=c(g,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,c(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},O(k.prototype),c(k.prototype,u,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(E),c(E,s,"Generator"),c(E,a,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=C,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),D(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;D(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:C(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function sr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function cr(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?sr(Object(r),!0).forEach((function(e){hr(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):sr(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function lr(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function fr(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){lr(i,n,o,a,u,"next",t)}function u(t){lr(i,n,o,a,u,"throw",t)}a(void 0)}))}}function pr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,dr(n.key),n)}}function hr(t,e,r){return(e=dr(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function dr(t){var e=function(t){if("object"!=ar(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=ar(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ar(e)?e:e+""}var yr=function(){return t=function t(e){var r=this,n=e.elMessagesChat,o=e.goBottom,i=e.eventEmitter,a=e.host;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),hr(this,"elMessagesChat",void 0),hr(this,"eventEmitter",void 0),hr(this,"goBottom",void 0),hr(this,"messages",[]),hr(this,"idxNextMessage",0),hr(this,"stopListenScroll",!1),hr(this,"dompurify",ir),hr(this,"host",void 0),hr(this,"addMessage",fr(ur().mark((function t(){var e,n,o,i,a,u=arguments;return ur().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(e=u.length,n=new Array(e),o=0;o<e;o++)n[o]=u[o];return i=[],a=n.length>1,n.forEach((function(t){var e=r._createMessage(t);a&&e.classList.add("ignore-animation"),i.push(r.messages.push(cr(cr({},t),{},{ref:e}))-1)})),t.next=5,r._updateStyle();case 5:return t.abrupt("return",i);case 6:case"end":return t.stop()}}),t)})))),hr(this,"streamMessage",function(){var t=fr(ur().mark((function t(e,n,o){var i,a,u,s,c,l,f;return ur().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=r._isAtBottom(),a=r.messages[e]){t.next=3;break}return t.abrupt("return");case 3:if(u=a.ref,0===(s=u.children[u.childElementCount-1]).childElementCount?(c=document.createTextNode(n),(l=document.createElement("span")).classList.add("typing"),s.append(c,l)):s.childNodes[0].textContent+=n,o&&(a.content=s.childNodes[0].textContent,f=s.childNodes[0].textContent,s.replaceChildren(),s.appendChild(r._parseMarkdown(f))),!i){t.next=11;break}return t.next=9,r.scrollToBottom(!1);case 9:t.next=12;break;case 11:r._scrollHandler();case 12:case"end":return t.stop()}}),t)})));return function(e,r,n){return t.apply(this,arguments)}}()),hr(this,"_updateStyle",fr(ur().mark((function t(){var e,n;return ur().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(e=r._isAtBottom(),n=r.idxNextMessage;n<r.messages.length;n++)r.elMessagesChat.append(r.messages[n].ref),r.idxNextMessage+=1;if(!e){t.next=7;break}return t.next=5,r.scrollToBottom();case 5:t.next=8;break;case 7:r._scrollHandler();case 8:case"end":return t.stop()}}),t)})))),hr(this,"_createMessage",(function(t){var e=document.createElement("div");e.classList.add("message");var n=document.createElement("p");if(n.classList.add("text"),n.appendChild(r._parseMarkdown("user"===t.role?t.content.replace(/\n/g,"<br>"):t.content)),"ai"===t.role){e.classList.add("ai");var o=document.createElement("div");o.classList.add("photo"),e.append(o,n)}else"user"===t.role&&(e.classList.add("user"),e.append(n));return e})),hr(this,"clearAllMessages",(function(){r.idxNextMessage=0,r.messages=[],r.elMessagesChat.replaceChildren(),r._scrollHandler()})),hr(this,"_scrollHandler",(function(){r.stopListenScroll||(r._isAtBottom()?r.goBottom.hide():r.goBottom.show())})),hr(this,"_isAtBottom",(function(){return r.elMessagesChat.scrollTop+r.elMessagesChat.clientHeight+3>=r.elMessagesChat.scrollHeight})),hr(this,"scrollToBottom",fr(ur().mark((function t(){var e,n=arguments;return ur().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=!(n.length>0&&void 0!==n[0])||n[0],r.stopListenScroll=!0,r.elMessagesChat.scroll({top:r.elMessagesChat.scrollHeight,behavior:e?"smooth":"instant"}),t.next=5,new Promise((function(t){requestAnimationFrame((function(){return r._checkPos(t)}))}));case 5:case"end":return t.stop()}}),t)})))),hr(this,"_checkPos",(function(t){r._isAtBottom()?(r.stopListenScroll=!1,t()):requestAnimationFrame((function(){return r._checkPos(t)}))})),this.elMessagesChat=n,this.goBottom=o,this.eventEmitter=i,this.host=a;var u=this;this.dompurify.addHook("afterSanitizeElements",(function(t){t instanceof HTMLAnchorElement&&""!==t.href.trim()&&t.addEventListener("click",(function(e){e.preventDefault(),u._launchUrl(t.href)}))})),this.elMessagesChat.addEventListener("scroll",this._scrollHandler)},(e=[{key:"_parseMarkdown",value:function(t){return this.dompurify.sanitize(or.parse(t.replace(/^[\u200B\u200C\u200D\u200E\u200F\uFEFF]/,""),{async:!1}),{RETURN_DOM_FRAGMENT:!0})}},{key:"_launchUrl",value:function(t){this.host&&this.host.launchUrl(t)}}])&&pr(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function vr(t){return vr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vr(t)}function mr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,wr(n.key),n)}}function br(t,e,r){return e&&mr(t.prototype,e),r&&mr(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function gr(t,e,r){return(e=wr(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function wr(t){var e=function(t){if("object"!=vr(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=vr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==vr(e)?e:e+""}var xr="goBottom",_r=br((function t(e,r){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),gr(this,"elButton",void 0),gr(this,"eventEmitter",void 0),gr(this,"hide",(function(){n.elButton.style.visibility="hidden"})),gr(this,"show",(function(){n.elButton.style.visibility="visible"})),gr(this,"_goBottom",(function(){n.eventEmitter.emit(xr,!0)})),this.elButton=e,this.eventEmitter=r,this.elButton.innerHTML='<svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="icon-sm m-1" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><line x1="12" y1="5" x2="12" y2="19"></line><polyline points="19 12 12 19 5 12"></polyline></svg>',this.hide(),this.elButton.addEventListener("click",this._goBottom)}));const Er='<svg xmlns="http://www.w3.org/2000/svg" fill="#000000" width="800px" height="800px" viewBox="0 0 16 16" id="chat-bubble-16px">\r\n  <path id="Path_148" data-name="Path 148" d="M-20.5,16a.5.5,0,0,1-.354-.146.5.5,0,0,1-.131-.475l.912-3.648A8,8,0,0,1-21,8a8.009,8.009,0,0,1,8-8A8.009,8.009,0,0,1-5,8a8.009,8.009,0,0,1-8,8,7.993,7.993,0,0,1-3.731-.927l-3.648.912A.5.5,0,0,1-20.5,16Zm3.836-1.959a.506.506,0,0,1,.245.064A7.007,7.007,0,0,0-13,15,7.008,7.008,0,0,0-6,8a7.008,7.008,0,0,0-7-7,7.008,7.008,0,0,0-7,7,7.01,7.01,0,0,0,.9,3.419.5.5,0,0,1,.049.366l-.757,3.028,3.028-.757A.5.5,0,0,1-16.664,14.041Z" transform="translate(21)"/>\r\n</svg>';function Or(t){return Or="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Or(t)}function kr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Sr(n.key),n)}}function jr(t,e,r){return(e=Sr(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Sr(t){var e=function(t){if("object"!=Or(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Or(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Or(e)?e:e+""}var Ar="conversationStarter",Dr="closeConversationStartersDropdown",Pr=function(){return t=function t(e){var r=this,n=e.elMessagesChat,o=e.elConversationStartersContainer,i=e.eventEmitter;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),jr(this,"elConversationStartersContainer",void 0),jr(this,"eventEmitter",void 0),jr(this,"conversationStarters",void 0),jr(this,"isDropdown",void 0),jr(this,"isFixedQuestions",void 0),jr(this,"topicsLabel",void 0),jr(this,"isOpened",void 0),jr(this,"maxHeightDropdown","100%"),jr(this,"_sendQuestion",(function(t){r.eventEmitter.emit(Ar,t)})),jr(this,"setConversationStarters",(function(t){if(r.elConversationStartersContainer.replaceChildren(),t){if(r.conversationStarters=t.split(";").map((function(t){return t.trim()})).filter((function(t){return t})),r.isDropdown){var e=document.createElement("div");e.classList.add("dropdown");var n=document.createElement("div");n.classList.add("dropdown-menu"),r.conversationStarters.forEach((function(t){var e=document.createElement("div");e.classList.add("menu-item"),e.addEventListener("click",(function(){return r._sendQuestion(t)}));var o=document.createElement("div");o.classList.add("icon"),o.innerHTML=Er,e.append(o);var i=document.createElement("span");i.classList.add("label"),i.innerText=t,e.append(i),n.append(e)})),e.append(n);var o=document.createElement("button");o.classList.add("topics-button"),o.setAttribute("title",r.topicsLabel||"Topics"),o.addEventListener("click",r.toggleDropdown);var i=document.createElement("div");i.classList.add("topics-title"),o.append(i);var a=document.createElement("span");a.classList.add("star"),i.append(a);var u=document.createElement("div");u.classList.add("topics-label"),u.innerText=o.title,i.append(u);var s=document.createElement("span");s.classList.add("chevron"),o.append(s),e.append(o),r.elConversationStartersContainer.append(e)}else{var c=document.createElement("div");c.classList.add("grid-conversation-starters"),r.elConversationStartersContainer.append(c),r.conversationStarters.forEach((function(t){var e=document.createElement("button");e.classList.add("btn-conversation-starter"),e.setAttribute("title",t),e.addEventListener("click",(function(){return r._sendQuestion(t)}));var n=document.createElement("div");n.classList.add("icon"),n.innerHTML=Er;var o=document.createElement("span");o.classList.add("label"),o.innerText=t,e.append(n),e.append(o),c.append(e),r.isFixedQuestions&&r.elConversationStartersContainer.classList.add("fixed-questions"),r.elConversationStartersContainer.append(c)}))}r.show()}else r.hide()})),jr(this,"hide",(function(){(void 0===r.isOpened||r.isOpened)&&(r.elConversationStartersContainer.style.opacity="0",r.elConversationStartersContainer.style.pointerEvents="none"),r.isOpened=!1,r.closeDropdown()})),jr(this,"show",(function(){void 0!==r.isOpened&&r.isOpened||(r.elConversationStartersContainer.style.opacity="1",r.elConversationStartersContainer.style.pointerEvents="auto"),r.isOpened=!0})),jr(this,"toggleDropdown",(function(){r.elConversationStartersContainer.classList.toggle("active-dropdown")})),jr(this,"closeDropdown",(function(){r.elConversationStartersContainer.classList.remove("active-dropdown")})),this.elConversationStartersContainer=o,this.elConversationStartersContainer.classList.add("container-conversation-starters"),this.hide(),this.elConversationStartersContainer.style.setProperty("--conversation-starters-dropdown-max-height","100%"),new ResizeObserver((function(){var t=n.offsetHeight,e="".concat(.5*t,"px");r.elConversationStartersContainer.style.setProperty("--conversation-starters-dropdown-max-height",e)})).observe(n),this.eventEmitter=i,this.eventEmitter.on(Dr,(function(t){return r._handleClickOutside(t)}))},e=[{key:"setConfigs",value:function(t){var e=t.isDropdown,r=t.isFixedQuestions,n=t.topicsLabel;this.isDropdown=e,this.isFixedQuestions=r,this.topicsLabel=n}},{key:"_handleClickOutside",value:function(t){if(this.isOpened&&this.isDropdown){var e=t.target,r=!e.closest(".container-conversation-starters .topics-button"),n=e.closest(".container-conversation-starters .dropdown-menu");r&&!n&&this.closeDropdown()}}}],e&&kr(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}(),Cr=o(4633),Lr=o.n(Cr);function Tr(t){return Tr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tr(t)}function Fr(){Fr=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new P(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function b(){}function g(){}var w={};c(w,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(w=_);var E=g.prototype=m.prototype=Object.create(w);function O(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,i,a,u){var s=f(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==Tr(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=S(u,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?y:h,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=y,n.method="throw",n.arg=c.arg)}}}function S(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,S(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function C(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(Tr(e)+" is not iterable")}return b.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=c(g,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,c(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},O(k.prototype),c(k.prototype,u,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(E),c(E,s,"Generator"),c(E,a,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=C,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),D(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;D(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:C(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function Ir(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function Nr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Mr(n.key),n)}}function Rr(t,e,r){return(e=Mr(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Mr(t){var e=function(t){if("object"!=Tr(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Tr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Tr(e)?e:e+""}var Br=function(){return t=function t(e,r,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Rr(this,"sqlJs",void 0),Rr(this,"db",void 0),Rr(this,"pbiData",void 0),Rr(this,"TABLENAME","report"),Rr(this,"DESCRIPTION",void 0),Rr(this,"CHUNKSIZE",3600),Rr(this,"columnsDecimal",{}),Rr(this,"decimalAsInteger",void 0),Rr(this,"dateFormat","TEXT"),this.pbiData=e,this.DESCRIPTION=r,this.decimalAsInteger=n},e=[{key:"init",value:(r=Fr().mark((function t(){return Fr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0!==Object.keys(this.pbiData).length){t.next=3;break}return t.abrupt("return");case 3:t.next=10;break;case 7:this.sqlJs=t.sent,t.next=13;break;case 10:return t.next=12,Lr()({locateFile:function(){return"https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.8.0/sql-wasm.wasm"}});case 12:this.sqlJs=t.sent;case 13:this.db=new this.sqlJs.Database,this._mapDecimalPlates(),this._createTable(this.TABLENAME),this._populateDb();case 17:case"end":return t.stop()}}),t,this)})),n=function(){var t=this,e=arguments;return new Promise((function(n,o){var i=r.apply(t,e);function a(t){Ir(i,n,o,a,u,"next",t)}function u(t){Ir(i,n,o,a,u,"throw",t)}a(void 0)}))},function(){return n.apply(this,arguments)})},{key:"_populateDb",value:function(){var t=this;this._checkInit();for(var e=this.getStringSchema(!1,!1),r=this.pbiData[Object.keys(this.pbiData)[0]].values.length,n=Object.keys(this.pbiData),o="INSERT INTO ".concat(this.TABLENAME," (").concat(e,") VALUES (").concat(Array(n.length).fill("?").join(", "),")"),i=this.db.prepare(o),a=function(e){var r=[];n.forEach((function(n){var o,i=t.pbiData[n],a=i.values[e];o=t.decimalAsInteger&&t.columnsDecimal[n]?null===a?a:Math.round(a*Math.pow(10,t.columnsDecimal[n])):"DATE"===i.type?t._adjustTimezone(a):a,r.push(o)})),i.run(r)},u=0;u<r;u++)a(u);i.free()}},{key:"_createTable",value:function(t){this.db.run("CREATE TABLE ".concat(t," (").concat(this.getStringSchema(!0),");"))}},{key:"_mapDecimalPlates",value:function(){var t=this;Object.keys(this.pbiData).forEach((function(e){var r=t.pbiData[e];if(["NUMERIC","REAL"].includes(r.type)){for(var n=0,o=0;o<r.values.length;o++){var i=r.values[o];if(!Number.isInteger(i)&&null!=i){var a=i.toString().split(".")[1];a.length>n&&(n=a.length)}}n>0&&n<=5&&(t.columnsDecimal[e]=n)}}))}},{key:"getStringSchema",value:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[];return Object.keys(this.pbiData).forEach((function(o){var i=t.pbiData[o],a=t._getDecimalAsIntegerType(i.type,o),u=e?r?t._getOriginTypeDefinition(a):t._getSQLiteTypeDefinition(a):"",s='"'+o.replace(/"/g,'""')+'"';n.push(u?"".concat(s," ").concat(u):s)})),"".concat(n.join(", "))}},{key:"_getDecimalAsIntegerType",value:function(t,e){return this.decimalAsInteger&&["REAL","NUMBER"].includes(t)&&Object.keys(this.columnsDecimal).includes(e)?"INTEGER":t}},{key:"_getSQLiteTypeDefinition",value:function(t){var e;return null!==(e={DATE:this.dateFormat,BOOLEAN:"INTEGER",TIME:this.dateFormat}[t])&&void 0!==e?e:t}},{key:"_getOriginTypeDefinition",value:function(t){var e;return null!==(e={DATE:"DATE (string ISO-8601)",BOOLEAN:"BOOLEAN (0 or 1 INTEGER)",TIME:"TIME (string ISO-8601)"}[t])&&void 0!==e?e:t}},{key:"_checkInit",value:function(){if(!this.db)throw new Error("Database was not initiated!")}},{key:"_adjustTimezone",value:function(t){var e=new Date(t),r=e.getTimezoneOffset();return e.setMinutes(e.getMinutes()-r),e.toISOString()}},{key:"runSql",value:function(t){return this._checkInit(),this.db.exec(t)}}],e&&Nr(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}(),Gr=o(7911),Ur=o(4476),zr=o(9126),$r=o(888),qr=o(1974),Kr=o(2372),Hr=(o(2782),o(8662));function Zr(t){return"function"==typeof(null==t?void 0:t.parse)}function Yr(t){return Yr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yr(t)}function Vr(t,e,r,n){var o=Wr(fn(1&n?t.prototype:t),e,r);return 2&n&&"function"==typeof o?function(t){return o.apply(r,t)}:o}function Wr(){return Wr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=fn(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},Wr.apply(null,arguments)}function Jr(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Xr(){Xr=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new P(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function b(){}function g(){}var w={};c(w,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(w=_);var E=g.prototype=m.prototype=Object.create(w);function O(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,i,a,u){var s=f(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==Yr(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=S(u,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?y:h,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=y,n.method="throw",n.arg=c.arg)}}}function S(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,S(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function C(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(Yr(e)+" is not iterable")}return b.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=c(g,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,c(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},O(k.prototype),c(k.prototype,u,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(E),c(E,s,"Generator"),c(E,a,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=C,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),D(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;D(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:C(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function Qr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function tn(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Qr(Object(r),!0).forEach((function(e){en(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Qr(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function en(t,e,r){return(e=sn(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rn(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function nn(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){rn(i,n,o,a,u,"next",t)}function u(t){rn(i,n,o,a,u,"throw",t)}a(void 0)}))}}function on(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function an(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,sn(n.key),n)}}function un(t,e,r){return e&&an(t.prototype,e),r&&an(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function sn(t){var e=function(t){if("object"!=Yr(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Yr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Yr(e)?e:e+""}function cn(t,e,r){return e=fn(e),function(t,e){if(e&&("object"==Yr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,ln()?Reflect.construct(e,r||[],fn(t).constructor):e.apply(t,r))}function ln(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(ln=function(){return!!t})()}function fn(t){return fn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},fn(t)}function pn(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&hn(t,e)}function hn(t,e){return hn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},hn(t,e)}var dn=function(t){function e(t){var r,n,o;return on(this,e),o=cn(this,e,[null!=t?t:{}]),Object.defineProperty(o,"returnDirect",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(o,"verboseParsingErrors",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(o,"responseFormat",{enumerable:!0,configurable:!0,writable:!0,value:"content"}),o.verboseParsingErrors=null!==(r=null==t?void 0:t.verboseParsingErrors)&&void 0!==r?r:o.verboseParsingErrors,o.responseFormat=null!==(n=null==t?void 0:t.responseFormat)&&void 0!==n?n:o.responseFormat,o}return pn(e,t),un(e,[{key:"lc_namespace",get:function(){return["langchain","tools"]}},{key:"invoke",value:(n=nn(Xr().mark((function t(e,r){var n,o,i;return Xr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(0,Hr.K)(e)?(n=e.id,o=e.args):o=e,i=(0,qr.ZI)(r),t.abrupt("return",this.call(o,tn(tn({},i),{},{configurable:tn(tn({},i.configurable),{},{tool_call_id:n})})));case 3:case"end":return t.stop()}}),t,this)}))),function(t,e){return n.apply(this,arguments)})},{key:"call",value:(r=nn(Xr().mark((function t(e,r,n){var o,i,a,u,s,c,l,f,p,h,d;return Xr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.schema.parseAsync(e);case 3:o=t.sent,t.next=11;break;case 6:throw t.prev=6,t.t0=t.catch(0),i="Received tool input did not match expected schema",this.verboseParsingErrors&&(i="".concat(i,"\nDetails: ").concat(t.t0.message)),new Hr.q(i,JSON.stringify(e));case 11:return a=(0,zr.H_)(r),t.next=14,zr.Td.configure(a.callbacks,this.callbacks,a.tags||n,this.tags,a.metadata,this.metadata,{verbose:this.verbose});case 14:return u=t.sent,t.next=17,null==u?void 0:u.handleToolStart(this.toJSON(),"string"==typeof o?o:JSON.stringify(o),a.runId,void 0,void 0,void 0,a.runName);case 17:return s=t.sent,delete a.runId,t.prev=19,t.next=22,this._call(o,s,a);case 22:c=t.sent,t.next=30;break;case 25:return t.prev=25,t.t1=t.catch(19),t.next=29,null==s?void 0:s.handleToolError(t.t1);case 29:throw t.t1;case 30:if("content_and_artifact"!==this.responseFormat){t.next=41;break}if(!Array.isArray(c)||2!==c.length){t.next=38;break}v=2,p=function(t){if(Array.isArray(t))return t}(y=c)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],s=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);s=!0);}catch(t){c=!0,o=t}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(y,v)||function(t,e){if(t){if("string"==typeof t)return Jr(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Jr(t,e):void 0}}(y,v)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),l=p[0],f=p[1],t.next=39;break;case 38:throw new Error('Tool response format is "content_and_artifact" but the output was not a two-tuple.\nResult: '.concat(JSON.stringify(c)));case 39:t.next=42;break;case 41:l=c;case 42:return a&&"configurable"in a&&(h=a.configurable.tool_call_id),d=bn({content:l,artifact:f,toolCallId:h,name:this.name}),t.next=46,null==s?void 0:s.handleToolEnd(d);case 46:return t.abrupt("return",d);case 47:case"end":return t.stop()}var y,v}),t,this,[[0,6],[19,25]])}))),function(t,e,n){return r.apply(this,arguments)})}]);var r,n}($r.ZE),yn=function(t){function e(t){var r;return on(this,e),r=cn(this,e,[t]),Object.defineProperty(r,"schema",{enumerable:!0,configurable:!0,writable:!0,value:Ur.z.object({input:Ur.z.string().optional()}).transform((function(t){return t.input}))}),r}return pn(e,t),un(e,[{key:"call",value:function(t,r){return Vr(e,"call",this,3)(["string"!=typeof t&&t?t:{input:t},r])}}])}(dn),vn=function(t){function e(t){var r,n;return on(this,e),n=cn(this,e,[t]),Object.defineProperty(n,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(n,"description",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(n,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),n.name=t.name,n.description=t.description,n.func=t.func,n.returnDirect=null!==(r=t.returnDirect)&&void 0!==r?r:n.returnDirect,n}return pn(e,t),un(e,[{key:"call",value:(n=nn(Xr().mark((function t(r,n){var o;return Xr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===(o=(0,zr.H_)(n)).runName&&(o.runName=this.name),t.abrupt("return",Vr(e,"call",this,3)([r,o]));case 3:case"end":return t.stop()}}),t,this)}))),function(t,e){return n.apply(this,arguments)})},{key:"_call",value:(r=nn(Xr().mark((function t(e,r,n){return Xr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.func(e,r,n));case 1:case"end":return t.stop()}}),t,this)}))),function(t,e,n){return r.apply(this,arguments)})}],[{key:"lc_name",value:function(){return"DynamicTool"}}]);var r,n}(yn),mn=function(t){function e(t){var r,n;return on(this,e),n=cn(this,e,[t]),Object.defineProperty(n,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(n,"description",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(n,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(n,"schema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),n.name=t.name,n.description=t.description,n.func=t.func,n.returnDirect=null!==(r=t.returnDirect)&&void 0!==r?r:n.returnDirect,n.schema=Zr(t.schema)?t.schema:Ur.z.object({}).passthrough(),n}return pn(e,t),un(e,[{key:"call",value:(r=nn(Xr().mark((function t(r,n,o){var i;return Xr().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===(i=(0,zr.H_)(n)).runName&&(i.runName=this.name),t.abrupt("return",Vr(e,"call",this,3)([r,i,o]));case 3:case"end":return t.stop()}}),t,this)}))),function(t,e,n){return r.apply(this,arguments)})},{key:"_call",value:function(t,e,r){return this.func(t,e,r)}}],[{key:"lc_name",value:function(){return"DynamicStructuredTool"}}]);var r}(dn);function bn(t){var e=t.content,r=t.artifact,n=t.toolCallId;return n?"string"==typeof e||Array.isArray(e)&&e.every((function(t){return"object"===Yr(t)}))?new Kr.uf({content:e,artifact:r,tool_call_id:n,name:t.name}):new Kr.uf({content:gn(e),artifact:r,tool_call_id:n,name:t.name}):e}function gn(t){try{return JSON.stringify(t,null,2)}catch(e){return"".concat(t)}}o(650);var wn=o(372);o(1931),o(890);var xn=o(5744),_n=o(4958),En=o(2743),On=o(2561);function kn(t){return kn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kn(t)}function jn(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Sn(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?jn(Object(r),!0).forEach((function(e){Ln(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):jn(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function An(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=Pn(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}function Dn(t){return function(t){if(Array.isArray(t))return Cn(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Pn(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pn(t,e){if(t){if("string"==typeof t)return Cn(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Cn(t,e):void 0}}function Cn(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Ln(t,e,r){return(e=Bn(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Tn(){Tn=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new P(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function b(){}function g(){}var w={};c(w,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(w=_);var E=g.prototype=m.prototype=Object.create(w);function O(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,i,a,u){var s=f(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==kn(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=S(u,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?y:h,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=y,n.method="throw",n.arg=c.arg)}}}function S(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,S(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function C(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(kn(e)+" is not iterable")}return b.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=c(g,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,c(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},O(k.prototype),c(k.prototype,u,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(E),c(E,s,"Generator"),c(E,a,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=C,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),D(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;D(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:C(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function Fn(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function In(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Fn(i,n,o,a,u,"next",t)}function u(t){Fn(i,n,o,a,u,"throw",t)}a(void 0)}))}}function Nn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Rn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Bn(n.key),n)}}function Mn(t,e,r){return e&&Rn(t.prototype,e),r&&Rn(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Bn(t){var e=function(t){if("object"!=kn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=kn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==kn(e)?e:e+""}function Gn(t,e,r){return e=zn(e),function(t,e){if(e&&("object"==kn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Un()?Reflect.construct(e,r||[],zn(t).constructor):e.apply(t,r))}function Un(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Un=function(){return!!t})()}function zn(t){return zn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},zn(t)}function $n(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&qn(t,e)}function qn(t,e){return qn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},qn(t,e)}function Kn(t){var e,r,n,o=2;for("undefined"!=typeof Symbol&&(r=Symbol.asyncIterator,n=Symbol.iterator);o--;){if(r&&null!=(e=t[r]))return e.call(t);if(n&&null!=(e=t[n]))return new Hn(e.call(t));r="@@asyncIterator",n="@@iterator"}throw new TypeError("Object is not async iterable")}function Hn(t){function e(t){if(Object(t)!==t)return Promise.reject(new TypeError(t+" is not an object."));var e=t.done;return Promise.resolve(t.value).then((function(t){return{value:t,done:e}}))}return Hn=function(t){this.s=t,this.n=t.next},Hn.prototype={s:null,n:null,next:function(){return e(this.n.apply(this.s,arguments))},return:function(t){var r=this.s.return;return void 0===r?Promise.resolve({value:t,done:!0}):e(r.apply(this.s,arguments))},throw:function(t){var r=this.s.return;return void 0===r?Promise.reject(t):e(r.apply(this.s,arguments))}},new Hn(t)}function Zn(t){return new Wn(t,0)}function Yn(t){return function(){return new Vn(t.apply(this,arguments))}}function Vn(t){var e,r;function n(e,r){try{var i=t[e](r),a=i.value,u=a instanceof Wn;Promise.resolve(u?a.v:a).then((function(r){if(u){var s="return"===e?"return":"next";if(!a.k||r.done)return n(s,r);r=t[s](r).value}o(i.done?"return":"normal",r)}),(function(t){n("throw",t)}))}catch(t){o("throw",t)}}function o(t,o){switch(t){case"return":e.resolve({value:o,done:!0});break;case"throw":e.reject(o);break;default:e.resolve({value:o,done:!1})}(e=e.next)?n(e.key,e.arg):r=null}this._invoke=function(t,o){return new Promise((function(i,a){var u={key:t,arg:o,resolve:i,reject:a,next:null};r?r=r.next=u:(e=r=u,n(t,o))}))},"function"!=typeof t.return&&(this.return=void 0)}function Wn(t,e){this.v=t,this.k=e}Vn.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},Vn.prototype.next=function(t){return this._invoke("next",t)},Vn.prototype.throw=function(t){return this._invoke("throw",t)},Vn.prototype.return=function(t){return this._invoke("return",t)};var Jn=function(t){function e(t){var r;return Nn(this,e),r=Gn(this,e,[t]),Object.defineProperty(r,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","agents","executor_iterator"]}),Object.defineProperty(r,"agentExecutor",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(r,"inputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(r,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(r,"callbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(r,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(r,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(r,"runName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(r,"_finalOutputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(r,"runManager",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(r,"intermediateSteps",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(r,"iterations",{enumerable:!0,configurable:!0,writable:!0,value:0}),r.agentExecutor=t.agentExecutor,r.inputs=t.inputs,r.callbacks=t.callbacks,r.tags=t.tags,r.metadata=t.metadata,r.runName=t.runName,r.runManager=t.runManager,r.config=t.config,r}return $n(e,t),Mn(e,[{key:"finalOutputs",get:function(){return this._finalOutputs}},{key:"setFinalOutputs",value:(u=In(Tn().mark((function t(e){var r;return Tn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._finalOutputs=void 0,!e){t.next=6;break}return t.next=4,this.agentExecutor.prepOutputs(this.inputs,e,!0);case 4:r=t.sent,this._finalOutputs=r;case 6:case"end":return t.stop()}}),t,this)}))),function(t){return u.apply(this,arguments)})},{key:"nameToToolMap",get:function(){var t=this.agentExecutor.tools.map((function(t){return Ln({},t.name,t)}));return Object.assign.apply(Object,[{}].concat(Dn(t)))}},{key:"reset",value:function(){this.intermediateSteps=[],this.iterations=0,this._finalOutputs=void 0}},{key:"updateIterations",value:function(){this.iterations+=1}},{key:"streamIterator",value:function(){var t=this;return Yn(Tn().mark((function e(){var r;return Tn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.reset();case 1:if(e.prev=2,0!==t.iterations){e.next=6;break}return e.next=6,Zn(t.onFirstStep());case 6:return e.next=8,Zn(t._callNext());case 8:return r=e.sent,e.next=11,r;case 11:e.next=23;break;case 13:if(e.prev=13,e.t0=e.catch(2),!("message"in e.t0)||!e.t0.message.startsWith("Final outputs already reached: ")){e.next=19;break}if(t.finalOutputs){e.next=18;break}throw e.t0;case 18:return e.abrupt("return",t.finalOutputs);case 19:if(!t.runManager){e.next=22;break}return e.next=22,Zn(t.runManager.handleChainError(e.t0));case 22:throw e.t0;case 23:e.next=1;break;case 25:case"end":return e.stop()}}),e,null,[[2,13]])})))()}},{key:"onFirstStep",value:(a=In(Tn().mark((function t(){var e,r,n,o,i,a,u,s,c,l,f,p,h,d;return Tn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0!==this.iterations){t.next=8;break}return t.next=3,_n.Td.configure(null!==(e=this.callbacks)&&void 0!==e?e:null===(r=this.config)||void 0===r?void 0:r.callbacks,this.agentExecutor.callbacks,null!==(n=this.tags)&&void 0!==n?n:null===(o=this.config)||void 0===o?void 0:o.tags,this.agentExecutor.tags,null!==(i=this.metadata)&&void 0!==i?i:null===(a=this.config)||void 0===a?void 0:a.metadata,this.agentExecutor.metadata,{verbose:this.agentExecutor.verbose});case 3:return d=t.sent,t.next=6,null==d?void 0:d.handleChainStart(this.agentExecutor.toJSON(),this.inputs,null===(u=this.config)||void 0===u?void 0:u.runId,void 0,null!==(s=this.tags)&&void 0!==s?s:null===(c=this.config)||void 0===c?void 0:c.tags,null!==(l=this.metadata)&&void 0!==l?l:null===(f=this.config)||void 0===f?void 0:f.metadata,null!==(p=this.runName)&&void 0!==p?p:null===(h=this.config)||void 0===h?void 0:h.runName);case 6:this.runManager=t.sent,void 0!==this.config&&delete this.config.runId;case 8:case"end":return t.stop()}}),t,this)}))),function(){return a.apply(this,arguments)})},{key:"_executeNextStep",value:(i=In(Tn().mark((function t(e){return Tn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.agentExecutor._takeNextStep(this.nameToToolMap,this.inputs,this.intermediateSteps,e,this.config));case 1:case"end":return t.stop()}}),t,this)}))),function(t){return i.apply(this,arguments)})},{key:"_processNextStepOutput",value:(o=In(Tn().mark((function t(e,r){var n,o,i,a,u;return Tn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!("returnValues"in e)){t.next=10;break}return t.next=3,this.agentExecutor._return(e,this.intermediateSteps,r);case 3:if(n=t.sent,!this.runManager){t.next=7;break}return t.next=7,this.runManager.handleChainEnd(n);case 7:return t.next=9,this.setFinalOutputs(n);case 9:return t.abrupt("return",n);case 10:if(this.intermediateSteps=this.intermediateSteps.concat(e),o={},!Array.isArray(e)||1!==e.length){t.next=25;break}return i=e[0],t.next=16,this.agentExecutor._getToolReturn(i);case 16:if(!(a=t.sent)){t.next=25;break}return t.next=20,this.agentExecutor._return(a,this.intermediateSteps,r);case 20:return o=t.sent,t.next=23,null===(u=this.runManager)||void 0===u?void 0:u.handleChainEnd(o);case 23:return t.next=25,this.setFinalOutputs(o);case 25:return o={intermediateSteps:e},t.abrupt("return",o);case 27:case"end":return t.stop()}}),t,this)}))),function(t,e){return o.apply(this,arguments)})},{key:"_stop",value:(n=In(Tn().mark((function t(){var e,r,n;return Tn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.agentExecutor.agent.returnStoppedResponse(this.agentExecutor.earlyStoppingMethod,this.intermediateSteps,this.inputs);case 2:return r=t.sent,t.next=5,this.agentExecutor._return(r,this.intermediateSteps,this.runManager);case 5:return n=t.sent,t.next=8,this.setFinalOutputs(n);case 8:return t.next=10,null===(e=this.runManager)||void 0===e?void 0:e.handleChainEnd(n);case 10:return t.abrupt("return",n);case 11:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"_callNext",value:(r=In(Tn().mark((function t(){var e,r;return Tn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.finalOutputs){t.next=2;break}throw new Error("Final outputs already reached: ".concat(JSON.stringify(this.finalOutputs,null,2)));case 2:if(this.agentExecutor.shouldContinueGetter(this.iterations)){t.next=4;break}return t.abrupt("return",this._stop());case 4:return t.next=6,this._executeNextStep(this.runManager);case 6:return e=t.sent,t.next=9,this._processNextStepOutput(e,this.runManager);case 9:return r=t.sent,this.updateIterations(),t.abrupt("return",r);case 12:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})}]);var r,n,o,i,a,u}(wn.y),Xn=function(t){function e(){var t;return Nn(this,e),t=Gn(this,e,arguments),Object.defineProperty(t,"name",{enumerable:!0,configurable:!0,writable:!0,value:"_Exception"}),Object.defineProperty(t,"description",{enumerable:!0,configurable:!0,writable:!0,value:"Exception tool"}),t}return $n(e,t),Mn(e,[{key:"_call",value:(r=In(Tn().mark((function t(e){return Tn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e);case 1:case"end":return t.stop()}}),t)}))),function(t){return r.apply(this,arguments)})}]);var r}(yn),Qn=function(t){function e(t){var r,n,o,i,a,u;Nn(this,e);var s=!0;if(xn.YN.isRunnable(t.agent)?(u=Gr.aZ.isAgentRunnableSequence(t.agent)?t.agent.singleAction?new Gr.RR({runnable:t.agent,streamRunnable:t.agent.streamRunnable}):new Gr.w3({runnable:t.agent,streamRunnable:t.agent.streamRunnable}):new Gr.w3({runnable:t.agent}),s=!1):((0,Gr.RI)(t.agent)&&(s=!1),u=t.agent),a=Gn(this,e,[t]),Object.defineProperty(a,"agent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(a,"tools",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(a,"returnIntermediateSteps",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(a,"maxIterations",{enumerable:!0,configurable:!0,writable:!0,value:15}),Object.defineProperty(a,"earlyStoppingMethod",{enumerable:!0,configurable:!0,writable:!0,value:"force"}),Object.defineProperty(a,"returnOnlyOutputs",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(a,"handleParsingErrors",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(a,"handleToolRuntimeErrors",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),a.agent=u,a.tools=t.tools,a.handleParsingErrors=null!==(r=t.handleParsingErrors)&&void 0!==r?r:a.handleParsingErrors,a.handleToolRuntimeErrors=t.handleToolRuntimeErrors,a.returnOnlyOutputs=s,"multi"===a.agent._agentActionType()){var c,l=An(a.tools);try{for(l.s();!(c=l.n()).done;){var f=c.value;if(f.returnDirect)throw new Error("Tool with return direct ".concat(f.name," not supported for multi-action agent."))}}catch(t){l.e(t)}finally{l.f()}}return a.returnIntermediateSteps=null!==(n=t.returnIntermediateSteps)&&void 0!==n?n:a.returnIntermediateSteps,a.maxIterations=null!==(o=t.maxIterations)&&void 0!==o?o:a.maxIterations,a.earlyStoppingMethod=null!==(i=t.earlyStoppingMethod)&&void 0!==i?i:a.earlyStoppingMethod,a}return $n(e,t),Mn(e,[{key:"lc_namespace",get:function(){return["langchain","agents","executor"]}},{key:"inputKeys",get:function(){return this.agent.inputKeys}},{key:"outputKeys",get:function(){return this.agent.returnValues}},{key:"shouldContinueGetter",get:function(){return this.shouldContinue.bind(this)}},{key:"shouldContinue",value:function(t){return void 0===this.maxIterations||t<this.maxIterations}},{key:"_call",value:(i=In(Tn().mark((function t(e,r,n){var o,i,a,u,s,c,l,f,p,h,d,y,v,m,b=this;return Tn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:o=Object.fromEntries(this.tools.map((function(t){return[t.name.toLowerCase(),t]}))),i=[],a=0,u=function(){var t=In(Tn().mark((function t(n){var o,a,u;return Tn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=n.returnValues,t.next=3,b.agent.prepareForOutput(o,i);case 3:return a=t.sent,t.next=6,null==r?void 0:r.handleAgentEnd(n);case 6:return u=b.returnIntermediateSteps?Sn(Sn({},o),{},{intermediateSteps:i},a):Sn(Sn({},o),a),b.returnOnlyOutputs||(u=Sn(Sn({},e),u)),t.abrupt("return",u);case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();case 4:if(!this.shouldContinue(a)){t.next=49;break}return c=void 0,t.prev=6,t.next=9,this.agent.plan(i,e,null==r?void 0:r.getChild(),n);case 9:c=t.sent,t.next=34;break;case 12:if(t.prev=12,t.t0=t.catch(6),!(t.t0 instanceof En.CC)){t.next=33;break}if(l=void 0,f=t.t0.message,!0!==this.handleParsingErrors){t.next=21;break}t.t0.sendToLLM?(l=t.t0.observation,f=null!==(p=t.t0.llmOutput)&&void 0!==p?p:""):l="Invalid or incomplete response",t.next=30;break;case 21:if("string"!=typeof this.handleParsingErrors){t.next=25;break}l=this.handleParsingErrors,t.next=30;break;case 25:if("function"!=typeof this.handleParsingErrors){t.next=29;break}l=this.handleParsingErrors(t.t0),t.next=30;break;case 29:throw t.t0;case 30:c={tool:"_Exception",toolInput:l,log:f},t.next=34;break;case 33:throw t.t0;case 34:if(!("returnValues"in c)){t.next=36;break}return t.abrupt("return",u(c));case 36:return h=void 0,h=Array.isArray(c)?c:[c],t.next=40,Promise.all(h.map(function(){var t=In(Tn().mark((function t(e){var i,a,u,s,c;return Tn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,null==r?void 0:r.handleAgentAction(e);case 2:if(u="_Exception"===e.tool?new Xn:o[null===(i=e.tool)||void 0===i?void 0:i.toLowerCase()],t.prev=3,!u){t.next=10;break}return t.next=7,u.invoke(e.toolInput,(0,xn.tn)(n,{callbacks:null==r?void 0:r.getChild()}));case 7:t.t0=t.sent,t.next=11;break;case 10:t.t0="".concat(e.tool," is not a valid tool, try another one.");case 11:if("string"==typeof(s=t.t0)){t.next=14;break}throw new Error("Received unsupported non-string response from tool call.");case 14:t.next=39;break;case 16:if(t.prev=16,t.t1=t.catch(3),!(t.t1 instanceof Hr.q)){t.next=38;break}if(!0!==b.handleParsingErrors){t.next=23;break}s="Invalid or incomplete tool input. Please try again.",t.next=32;break;case 23:if("string"!=typeof b.handleParsingErrors){t.next=27;break}s=b.handleParsingErrors,t.next=32;break;case 27:if("function"!=typeof b.handleParsingErrors){t.next=31;break}s=b.handleParsingErrors(t.t1),t.next=32;break;case 31:throw t.t1;case 32:return t.next=34,(new Xn).call(s,null==r?void 0:r.getChild());case 34:return s=t.sent,t.abrupt("return",{action:e,observation:null!==(c=s)&&void 0!==c?c:""});case 38:void 0!==b.handleToolRuntimeErrors&&(s=b.handleToolRuntimeErrors(t.t1));case 39:return t.abrupt("return",{action:e,observation:null!==(a=s)&&void 0!==a?a:""});case 40:case"end":return t.stop()}}),t,null,[[3,16]])})));return function(e){return t.apply(this,arguments)}}()));case 40:if(d=t.sent,i.push.apply(i,Dn(d)),y=i[i.length-1],null==(v=o[null===(s=y.action.tool)||void 0===s?void 0:s.toLowerCase()])||!v.returnDirect){t.next=46;break}return t.abrupt("return",u({returnValues:Ln({},this.agent.returnValues[0],y.observation),log:""}));case 46:a+=1,t.next=4;break;case 49:return t.next=51,this.agent.returnStoppedResponse(this.earlyStoppingMethod,i,e);case 51:return m=t.sent,t.abrupt("return",u(m));case 53:case"end":return t.stop()}}),t,this,[[6,12]])}))),function(t,e,r){return i.apply(this,arguments)})},{key:"_takeNextStep",value:(o=In(Tn().mark((function t(e,r,n,o,i){var a,u,s,c,l,f,p,h,d,y,v;return Tn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.agent.plan(n,r,null==o?void 0:o.getChild(),i);case 3:a=t.sent,t.next=27;break;case 6:if(t.prev=6,t.t0=t.catch(0),!(t.t0 instanceof En.CC)){t.next=26;break}if(s=t.t0.message,!0!==this.handleParsingErrors){t.next=14;break}t.t0.sendToLLM?(u=t.t0.observation,s=null!==(c=t.t0.llmOutput)&&void 0!==c?c:""):u="Invalid or incomplete response",t.next=23;break;case 14:if("string"!=typeof this.handleParsingErrors){t.next=18;break}u=this.handleParsingErrors,t.next=23;break;case 18:if("function"!=typeof this.handleParsingErrors){t.next=22;break}u=this.handleParsingErrors(t.t0),t.next=23;break;case 22:throw t.t0;case 23:a={tool:"_Exception",toolInput:u,log:s},t.next=27;break;case 26:throw t.t0;case 27:if(!("returnValues"in a)){t.next=29;break}return t.abrupt("return",a);case 29:l=Array.isArray(a)?a:[a],f=[],p=An(l),t.prev=32,p.s();case 34:if((h=p.n()).done){t.next=75;break}if(d=h.value,y="",!o){t.next=40;break}return t.next=40,null==o?void 0:o.handleAgentAction(d);case 40:if(!(d.tool in e)){t.next=71;break}return v=e[d.tool],t.prev=42,t.next=45,v.call(d.toolInput,null==o?void 0:o.getChild());case 45:if("string"==typeof(y=t.sent)){t.next=48;break}throw new Error("Received unsupported non-string response from tool call.");case 48:t.next=69;break;case 50:if(t.prev=50,t.t1=t.catch(42),!(t.t1 instanceof Hr.q)){t.next=69;break}if(!0!==this.handleParsingErrors){t.next=57;break}y="Invalid or incomplete tool input. Please try again.",t.next=66;break;case 57:if("string"!=typeof this.handleParsingErrors){t.next=61;break}y=this.handleParsingErrors,t.next=66;break;case 61:if("function"!=typeof this.handleParsingErrors){t.next=65;break}y=this.handleParsingErrors(t.t1),t.next=66;break;case 65:throw t.t1;case 66:return t.next=68,(new Xn).call(y,null==o?void 0:o.getChild());case 68:y=t.sent;case 69:t.next=72;break;case 71:y="".concat(d.tool," is not a valid tool, try another available tool: ").concat(Object.keys(e).join(", "));case 72:f.push({action:d,observation:y});case 73:t.next=34;break;case 75:t.next=80;break;case 77:t.prev=77,t.t2=t.catch(32),p.e(t.t2);case 80:return t.prev=80,p.f(),t.finish(80);case 83:return t.abrupt("return",f);case 84:case"end":return t.stop()}}),t,this,[[0,6],[32,77,80,83],[42,50]])}))),function(t,e,r,n,i){return o.apply(this,arguments)})},{key:"_return",value:(n=In(Tn().mark((function t(e,r,n){var o;return Tn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=3;break}return t.next=3,n.handleAgentEnd(e);case 3:return o=e.returnValues,this.returnIntermediateSteps&&(o.intermediateSteps=r),t.abrupt("return",o);case 6:case"end":return t.stop()}}),t,this)}))),function(t,e,r){return n.apply(this,arguments)})},{key:"_getToolReturn",value:(r=In(Tn().mark((function t(e){var r,n,o,i,a,u;return Tn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.action,n=e.observation,o=Object.fromEntries(this.tools.map((function(t){return[t.name.toLowerCase(),t]}))),s=this.agent.returnValues,c=1,i=function(t){if(Array.isArray(t))return t}(s)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],s=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);s=!0);}catch(t){c=!0,o=t}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(s,c)||Pn(s,c)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),a=i[0],u=void 0===a?"output":a,!(r.tool in o)){t.next=6;break}if(!o[r.tool].returnDirect){t.next=6;break}return t.abrupt("return",{returnValues:Ln({},u,n),log:""});case 6:return t.abrupt("return",null);case 7:case"end":return t.stop()}var s,c}),t,this)}))),function(t){return r.apply(this,arguments)})},{key:"_returnStoppedResponse",value:function(t){if("force"===t)return{returnValues:{output:"Agent stopped due to iteration limit or time limit."},log:""};throw new Error("Got unsupported early_stopping_method: ".concat(t))}},{key:"_streamIterator",value:function(t,e){var r=this;return Yn(Tn().mark((function n(){var o,i,a,u,s,c,l,f;return Tn().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:o=new Jn({inputs:t,agentExecutor:r,config:e,metadata:null==e?void 0:e.metadata,tags:null==e?void 0:e.tags,callbacks:null==e?void 0:e.callbacks}),i=o.streamIterator(),a=!1,u=!1,n.prev=4,c=Kn(i);case 6:return n.next=8,Zn(c.next());case 8:if(!(a=!(l=n.sent).done)){n.next=17;break}if(f=l.value){n.next=12;break}return n.abrupt("continue",14);case 12:return n.next=14,f;case 14:a=!1,n.next=6;break;case 17:n.next=23;break;case 19:n.prev=19,n.t0=n.catch(4),u=!0,s=n.t0;case 23:if(n.prev=23,n.prev=24,!a||null==c.return){n.next=28;break}return n.next=28,Zn(c.return());case 28:if(n.prev=28,!u){n.next=31;break}throw s;case 31:return n.finish(28);case 32:return n.finish(23);case 33:case"end":return n.stop()}}),n,null,[[4,19,23,33],[24,,28,32]])})))()}},{key:"_chainType",value:function(){return"agent_executor"}},{key:"serialize",value:function(){throw new Error("Cannot serialize an AgentExecutor")}}],[{key:"lc_name",value:function(){return"AgentExecutor"}},{key:"fromAgentAndTools",value:function(t){return new e(t)}}]);var r,n,o,i}(On.r);o(8440);var to=o(6641),eo=o(844);function ro(t){return ro="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ro(t)}function no(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,io(n.key),n)}}function oo(t,e,r){return e&&no(t.prototype,e),r&&no(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function io(t){var e=function(t){if("object"!=ro(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=ro(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ro(e)?e:e+""}var ao=oo((function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)})),uo=function(t,e){if(void 0!==e)return t[e];var r=Object.keys(t);return 1===r.length?t[r[0]]:void 0},so=function(t,e){var r=uo(t,e);if(!r){var n=Object.keys(t);throw new Error("input values have ".concat(n.length," keys, you must specify an input key or pass only 1 key as input"))}return r},co=function(t,e){var r=uo(t,e);if(!r){var n=Object.keys(t);throw new Error("output values have ".concat(n.length," keys, you must specify an output key or pass only 1 key as output"))}return r};function lo(t){return lo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lo(t)}function fo(){fo=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new P(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function b(){}function g(){}var w={};c(w,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(w=_);var E=g.prototype=m.prototype=Object.create(w);function O(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,i,a,u){var s=f(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==lo(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=S(u,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?y:h,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=y,n.method="throw",n.arg=c.arg)}}}function S(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,S(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function C(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(lo(e)+" is not iterable")}return b.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=c(g,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,c(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},O(k.prototype),c(k.prototype,u,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(E),c(E,s,"Generator"),c(E,a,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=C,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),D(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;D(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:C(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function po(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return ho(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ho(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}function ho(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function yo(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function vo(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){yo(i,n,o,a,u,"next",t)}function u(t){yo(i,n,o,a,u,"throw",t)}a(void 0)}))}}function mo(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function bo(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,wo(n.key),n)}}function go(t,e,r){return e&&bo(t.prototype,e),r&&bo(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function wo(t){var e=function(t){if("object"!=lo(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=lo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==lo(e)?e:e+""}function xo(t,e,r){return e=Eo(e),function(t,e){if(e&&("object"==lo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,_o()?Reflect.construct(e,r||[],Eo(t).constructor):e.apply(t,r))}function _o(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_o=function(){return!!t})()}function Eo(t){return Eo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Eo(t)}function Oo(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ko(t,e)}function ko(t,e){return ko=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ko(t,e)}var jo=function(t){function e(t){var r;return mo(this,e),r=xo(this,e,arguments),Object.defineProperty(r,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","stores","message","in_memory"]}),Object.defineProperty(r,"messages",{enumerable:!0,configurable:!0,writable:!0,value:[]}),r.messages=null!=t?t:[],r}return Oo(e,t),go(e,[{key:"getMessages",value:(o=vo(fo().mark((function t(){return fo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.messages);case 1:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"addMessage",value:(n=vo(fo().mark((function t(e){return fo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.messages.push(e);case 1:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"clear",value:(r=vo(fo().mark((function t(){return fo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.messages=[];case 1:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})}]);var r,n,o}(function(t){function e(){return mo(this,e),xo(this,e,arguments)}return Oo(e,t),go(e,[{key:"addUserMessage",value:function(t){return this.addMessage(new to.xc(t))}},{key:"addAIChatMessage",value:function(t){return this.addMessage(new to.Od(t))}},{key:"addAIMessage",value:function(t){return this.addMessage(new to.Od(t))}},{key:"addMessages",value:(r=vo(fo().mark((function t(e){var r,n,o;return fo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=po(e),t.prev=1,r.s();case 3:if((n=r.n()).done){t.next=9;break}return o=n.value,t.next=7,this.addMessage(o);case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),r.e(t.t0);case 14:return t.prev=14,r.f(),t.finish(14);case 17:case"end":return t.stop()}}),t,this,[[1,11,14,17]])}))),function(t){return r.apply(this,arguments)})},{key:"clear",value:function(){throw new Error("Not implemented.")}}]);var r}(o(4865).y));function So(t){return So="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},So(t)}function Ao(){Ao=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new P(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function b(){}function g(){}var w={};c(w,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(w=_);var E=g.prototype=m.prototype=Object.create(w);function O(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,i,a,u){var s=f(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==So(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=S(u,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?y:h,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=y,n.method="throw",n.arg=c.arg)}}}function S(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,S(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function C(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(So(e)+" is not iterable")}return b.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=c(g,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,c(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},O(k.prototype),c(k.prototype,u,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(E),c(E,s,"Generator"),c(E,a,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=C,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),D(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;D(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:C(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function Do(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function Po(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Do(i,n,o,a,u,"next",t)}function u(t){Do(i,n,o,a,u,"throw",t)}a(void 0)}))}}function Co(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Lo(n.key),n)}}function Lo(t){var e=function(t){if("object"!=So(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=So(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==So(e)?e:e+""}function To(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(To=function(){return!!t})()}function Fo(t){return Fo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Fo(t)}function Io(t,e){return Io=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Io(t,e)}var No=function(t){function e(t){var r,n,o,i,a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),a=function(t,e,r){return e=Fo(e),function(t,e){if(e&&("object"==So(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,To()?Reflect.construct(e,r||[],Fo(t).constructor):e.apply(t,r))}(this,e),Object.defineProperty(a,"chatHistory",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(a,"returnMessages",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(a,"inputKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(a,"outputKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),a.chatHistory=null!==(r=null==t?void 0:t.chatHistory)&&void 0!==r?r:new jo,a.returnMessages=null!==(n=null==t?void 0:t.returnMessages)&&void 0!==n?n:a.returnMessages,a.inputKey=null!==(o=null==t?void 0:t.inputKey)&&void 0!==o?o:a.inputKey,a.outputKey=null!==(i=null==t?void 0:t.outputKey)&&void 0!==i?i:a.outputKey,a}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Io(t,e)}(e,t),r=e,n=[{key:"saveContext",value:(i=Po(Ao().mark((function t(e,r){return Ao().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.chatHistory.addUserMessage(so(e,this.inputKey));case 2:return t.next=4,this.chatHistory.addAIChatMessage(co(r,this.outputKey));case 4:case"end":return t.stop()}}),t,this)}))),function(t,e){return i.apply(this,arguments)})},{key:"clear",value:(o=Po(Ao().mark((function t(){return Ao().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.chatHistory.clear();case 2:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})}],n&&Co(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o,i}(ao),Ro=o(4159),Mo=o(1236),Bo=o(5327),Go=o(7889);function Uo(t){return Uo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uo(t)}function zo(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function $o(t,e,r){return(e=function(t){var e=function(t){if("object"!=Uo(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Uo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Uo(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qo(t,e){var r="number"==typeof e?void 0:e;return function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?zo(Object(r),!0).forEach((function(e){$o(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):zo(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({name:t.name,description:t.description,parameters:(0,Mo.Ik)(t.schema)},void 0!==(null==r?void 0:r.strict)?{strict:r.strict}:{})}function Ko(t){return function(t){return!!t&&"object"===Uo(t)&&"name"in t&&"schema"in t&&Zr(t.schema)}(t)||function(t){return void 0!==t&&Go.YN.isRunnable(t)&&"lc_name"in t.constructor&&"function"==typeof t.constructor.lc_name&&"RunnableToolLike"===t.constructor.lc_name()}(t)||function(t){return void 0!==t&&Array.isArray(t.lc_namespace)}(t)}function Ho(t){return Ho="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ho(t)}function Zo(){Zo=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new P(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function b(){}function g(){}var w={};c(w,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(w=_);var E=g.prototype=m.prototype=Object.create(w);function O(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,i,a,u){var s=f(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==Ho(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=S(u,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?y:h,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=y,n.method="throw",n.arg=c.arg)}}}function S(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,S(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function C(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(Ho(e)+" is not iterable")}return b.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=c(g,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,c(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},O(k.prototype),c(k.prototype,u,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(E),c(E,s,"Generator"),c(E,a,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=C,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),D(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;D(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:C(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function Yo(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function Vo(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Yo(i,n,o,a,u,"next",t)}function u(t){Yo(i,n,o,a,u,"throw",t)}a(void 0)}))}}function Wo(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Jo(n.key),n)}}function Jo(t){var e=function(t){if("object"!=Ho(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Ho(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ho(e)?e:e+""}function Xo(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Xo=function(){return!!t})()}function Qo(t){return Qo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Qo(t)}function ti(t,e){return ti=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ti(t,e)}function ei(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function ri(t){var e="string"==typeof t.content?t.content:JSON.stringify(t.content),r=[];if(void 0!==t.tool_calls&&t.tool_calls.length>0)r=t.tool_calls;else{var n;if(void 0===t.additional_kwargs.tool_calls||0===t.additional_kwargs.tool_calls.length)return{returnValues:{output:t.content},log:e};var o,i=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return ei(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ei(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}(null!==(n=t.additional_kwargs.tool_calls)&&void 0!==n?n:[]);try{for(i.s();!(o=i.n()).done;){var a,u=o.value,s=null===(a=u.function)||void 0===a?void 0:a.name;try{var c=JSON.parse(u.function.arguments);r.push({name:s,args:c,id:u.id})}catch(t){throw new En.CC('Failed to parse tool arguments from chat model response. Text: "'.concat(JSON.stringify(r),'". ').concat(t))}}}catch(t){i.e(t)}finally{i.f()}}return r.map((function(r,n){var o,i,a=0===n?[t]:[],u='Invoking "'.concat(r.name,'" with ').concat(JSON.stringify(null!==(o=r.args)&&void 0!==o?o:{}),"\n").concat(e);return{tool:r.name,toolInput:r.args,toolCallId:null!==(i=r.id)&&void 0!==i?i:"",log:u,messageLog:a}}))}'You have access to the following tools.\nYou must format your inputs to these tools to match their "JSON schema" definitions below.\n\n"JSON Schema" is a declarative language that allows you to annotate and validate JSON documents.\n\nFor example, the example "JSON Schema" instance {{"properties": {{"foo": {{"description": "a list of test words", "type": "array", "items": {{"type": "string"}}}}}}, "required": ["foo"]}}}}\nwould match an object with one required property, "foo". The "type" property specifies "foo" must be an "array", and the "description" property semantically describes it as "a list of test words". The items within "foo" must be strings.\nThus, the object {{"foo": ["bar", "baz"]}} is a well-formatted instance of this example "JSON Schema". The object {{"properties": {{"foo": ["bar", "baz"]}}}} is not well-formatted.\n\nHere are the JSON Schema instances for the tools you have access to:\n\n{tool_schemas}\n\nThe way you use the tools is as follows:\n\n------------------------\n\n'.concat('Output a JSON markdown code snippet containing a valid JSON blob (denoted below by $JSON_BLOB).\nThis $JSON_BLOB must have a "action" key (with the name of the tool to use) and an "action_input" key (tool input).\n\nValid "action" values: "Final Answer" (which you must use when giving your final response to the user), or one of [{tool_names}].\n\nThe $JSON_BLOB must be valid, parseable JSON and only contain a SINGLE action. Here is an example of an acceptable output:\n\n```json\n{{\n  "action": $TOOL_NAME,\n  "action_input": $INPUT\n}}\n```\n\nRemember to include the surrounding markdown code snippet delimiters (begin with "```" json and close with "```")!\n','\n\nIf you are using a tool, "action_input" must adhere to the tool\'s input schema, given above.\n\n------------------------\n\nALWAYS use the following format:\n\nQuestion: the input question you must answer\nThought: you should always think about what to do\nAction:\n```json\n$JSON_BLOB\n```\nObservation: the result of the action\n... (this Thought/Action/Observation can repeat N times)\nThought: I now know the final answer\nAction:\n```json\n{{\n  "action": "Final Answer",\n  "action_input": "Final response to human"\n}}\n```'),o(3829);var ni=function(t){function e(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),t=function(t,e,r){return e=Qo(e),function(t,e){if(e&&("object"==Ho(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Xo()?Reflect.construct(e,r||[],Qo(t).constructor):e.apply(t,r))}(this,e,arguments),Object.defineProperty(t,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","agents","tool_calling"]}),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ti(t,e)}(e,t),r=e,n=[{key:"parse",value:(a=Vo(Zo().mark((function t(e){return Zo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:throw new Error("ToolCallingAgentOutputParser can only parse messages.\nPassed input: ".concat(e));case 1:case"end":return t.stop()}}),t)}))),function(t){return a.apply(this,arguments)})},{key:"parseResult",value:(i=Vo(Zo().mark((function t(e){return Zo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!("message"in e[0])||!(0,to.ny)(e[0].message)){t.next=2;break}return t.abrupt("return",ri(e[0].message));case 2:throw new Error("parseResult on ToolCallingAgentOutputParser only works on ChatGeneration output");case 3:case"end":return t.stop()}}),t)}))),function(t){return i.apply(this,arguments)})},{key:"getFormatInstructions",value:function(){throw new Error("getFormatInstructions not implemented inside ToolCallingAgentOutputParser.")}}],o=[{key:"lc_name",value:function(){return"ToolCallingAgentOutputParser"}}],n&&Wo(r.prototype,n),o&&Wo(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o,i,a}(Ro.$);function oi(t){var e,r,n=t.llm,o=t.tools,i=t.prompt,a=t.streamRunnable;if(!i.inputVariables.includes("agent_scratchpad"))throw new Error(['Prompt must have an input variable named "agent_scratchpad".',"Found ".concat(JSON.stringify(i.inputVariables)," instead.")].join("\n"));if("function"==typeof(r=n)._modelType&&"base_chat_model"===r._modelType()){if(void 0===n.bindTools)throw new Error('This agent requires that the "bind_tools()" method be implemented on the input model.');e=n.bindTools(o)}else e=n;return Gr.aZ.fromRunnables([xn.kI.assign({agent_scratchpad:function(t){return t.steps.flatMap((function(t){var e,r=t.action,n=t.observation;return"messageLog"in r&&void 0!==r.messageLog?r.messageLog.concat((e={action:r,observation:n},new to.uf({tool_call_id:e.action.toolCallId,content:e.observation,additional_kwargs:{name:e.action.tool}}))):[new to.Od(r.log)]}))}}),i,e,new ni],{name:"ToolCallingAgent",streamRunnable:a,singleAction:!1})}function ii(t){return ii="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ii(t)}function ai(){ai=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new P(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function b(){}function g(){}var w={};c(w,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(w=_);var E=g.prototype=m.prototype=Object.create(w);function O(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,i,a,u){var s=f(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==ii(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=S(u,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?y:h,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=y,n.method="throw",n.arg=c.arg)}}}function S(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,S(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function C(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(ii(e)+" is not iterable")}return b.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=c(g,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,c(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},O(k.prototype),c(k.prototype,u,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(E),c(E,s,"Generator"),c(E,a,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=C,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),D(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;D(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:C(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function ui(t,e,r){return(e=li(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function si(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function ci(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,li(n.key),n)}}function li(t){var e=function(t){if("object"!=ii(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=ii(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ii(e)?e:e+""}function fi(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(fi=function(){return!!t})()}function pi(t){return pi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},pi(t)}function hi(t,e){return hi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},hi(t,e)}var di=function(t){function e(t){var r,n,o,i,a,u;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),u=function(t,e,r){return e=pi(e),function(t,e){if(e&&("object"==ii(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,fi()?Reflect.construct(e,r||[],pi(t).constructor):e.apply(t,r))}(this,e,[{returnMessages:null!==(r=null==t?void 0:t.returnMessages)&&void 0!==r&&r,chatHistory:null==t?void 0:t.chatHistory,inputKey:null==t?void 0:t.inputKey,outputKey:null==t?void 0:t.outputKey}]),Object.defineProperty(u,"humanPrefix",{enumerable:!0,configurable:!0,writable:!0,value:"Human"}),Object.defineProperty(u,"aiPrefix",{enumerable:!0,configurable:!0,writable:!0,value:"AI"}),Object.defineProperty(u,"memoryKey",{enumerable:!0,configurable:!0,writable:!0,value:"history"}),Object.defineProperty(u,"k",{enumerable:!0,configurable:!0,writable:!0,value:5}),u.humanPrefix=null!==(n=null==t?void 0:t.humanPrefix)&&void 0!==n?n:u.humanPrefix,u.aiPrefix=null!==(o=null==t?void 0:t.aiPrefix)&&void 0!==o?o:u.aiPrefix,u.memoryKey=null!==(i=null==t?void 0:t.memoryKey)&&void 0!==i?i:u.memoryKey,u.k=null!==(a=null==t?void 0:t.k)&&void 0!==a?a:u.k,u}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&hi(t,e)}(e,t),r=e,n=[{key:"memoryKeys",get:function(){return[this.memoryKey]}},{key:"loadMemoryVariables",value:(o=ai().mark((function t(e){var r,n,o;return ai().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.chatHistory.getMessages();case 2:if(r=t.sent,!this.returnMessages){t.next=6;break}return n=ui({},this.memoryKey,r.slice(2*-this.k)),t.abrupt("return",n);case 6:return o=ui({},this.memoryKey,(0,to.Sw)(r.slice(2*-this.k),this.humanPrefix,this.aiPrefix)),t.abrupt("return",o);case 8:case"end":return t.stop()}}),t,this)})),i=function(){var t=this,e=arguments;return new Promise((function(r,n){var i=o.apply(t,e);function a(t){si(i,r,n,a,u,"next",t)}function u(t){si(i,r,n,a,u,"throw",t)}a(void 0)}))},function(t){return i.apply(this,arguments)})}],n&&ci(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o,i}(No);function yi(t){return yi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yi(t)}function vi(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function mi(){mi=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new P(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function b(){}function g(){}var w={};c(w,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(w=_);var E=g.prototype=m.prototype=Object.create(w);function O(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,i,a,u){var s=f(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==yi(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=S(u,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?y:h,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=y,n.method="throw",n.arg=c.arg)}}}function S(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,S(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function C(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(yi(e)+" is not iterable")}return b.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=c(g,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,c(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},O(k.prototype),c(k.prototype,u,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(E),c(E,s,"Generator"),c(E,a,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=C,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),D(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;D(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:C(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function bi(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function gi(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){bi(i,n,o,a,u,"next",t)}function u(t){bi(i,n,o,a,u,"throw",t)}a(void 0)}))}}function wi(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ei(n.key),n)}}function xi(t,e,r){return e&&wi(t.prototype,e),r&&wi(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _i(t,e,r){return(e=Ei(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ei(t){var e=function(t){if("object"!=yi(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=yi(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==yi(e)?e:e+""}var Oi=o(2926),ki=xi((function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),_i(this,"tools",void 0),_i(this,"db",void 0),_i(this,"dialect","sqlite"),this.db=e,this.tools=[ji(this.db,r)]})),ji=function(t,e){return new vn({name:"query-sql",description:"descFunc1",func:(r=gi(mi().mark((function e(r){var n,o;return mi().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n=Si(Ai(r)),!((null==(o=t.runSql(n))?void 0:o.length)>0)){e.next=8;break}return o[0].values=o[0].values.map((function(t){return t.map((function(t){return"number"==typeof t&&t%1>0?(String(t).split(".")[1].length>4&&(t=Number(t.toFixed(4))),t):t}))})),e.abrupt("return",JSON.stringify(o[0]));case 8:return e.abrupt("return","0 rows returned.");case 9:e.next=14;break;case 11:return e.prev=11,e.t0=e.catch(0),e.abrupt("return","error: ".concat(e.t0.message));case 14:case"end":return e.stop()}}),e,null,[[0,11]])}))),function(t){return r.apply(this,arguments)})});var r};function Si(t){try{var e=Oi.parse(t),r=[];function i(t){var e,n;t&&("="===t.operator&&("Identifier"===t.left.type&&r.push(t.left.value),"Identifier"===t.right.type&&r.push(t.right.value),null!==(e=t.left)&&void 0!==e&&e.left&&i(t.left.left),null!==(n=t.right)&&void 0!==n&&n.right&&i(t.right.right)),t.left&&i(t.left),t.right&&i(t.right),"SimpleExprParentheses"===t.type&&i(t.value),"ExpressionList"===t.type&&t.value.map((function(t){return i(t)})))}i(e.value.where);for(var n=0;n<(null===(o=e.value)||void 0===o||null===(o=o.groupBy)||void 0===o?void 0:o.value.length);n++){var o;r.includes(e.value.groupBy.value[n].value.value)||(e.value.groupBy.value[n].value.value+=" COLLATE NOCASE")}return Oi.stringify(e).trim()}catch(a){return console.error(a.message),t}}function Ai(t){try{var e,r=Oi.parse(t);if(null!==(e=r.value)&&void 0!==e&&null!==(e=e.selectItems)&&void 0!==e&&e.value){function n(t){["left","right"].forEach((function(e){var r;t[e]&&"SimpleExprParentheses"===t[e].type&&(null===(r=t[e].value)||void 0===r||null===(r=r.value)||void 0===r||r.map((function(t){return a(t)})))}))}function o(t,e){Object.keys(t).forEach((function(r){e.includes(r)||(t[r]=void 0)}))}function i(t,e){t.expr=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?vi(Object(r),!0).forEach((function(e){_i(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):vi(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},t),t.type="Cast",t.castTo=e,o(t,["type","expr","castTo"])}function a(t){t&&(["left","right"].forEach((function(e){t[e]&&"FunctionCall"==t[e].type&&t[e].params.map((function(t){return a(t)}))})),["left","right"].forEach((function(e){t[e]&&"Cast"!==t[e].type&&i(t[e],"REAL")})))}r.value.selectItems.value.forEach((function(t){"/"===t.operator?a(t):n(t)}))}return Oi.stringify(r).trim()}catch(u){return console.error(u.message),t}}function Di(t,e){var r=new RegExp("'''".concat(e,"\n(.*?)\n'''"),"s").exec(t);return r&&r[1]?r[1].trim():null}function Pi(t,e){var r=new RegExp("'''".concat(e,"\n(.*?)'''\n"),"s");return t.replace(r,"")}function Ci(t,e,r){return e=Ti(e),function(t,e){if(e&&("object"==Ki(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Li()?Reflect.construct(e,r||[],Ti(t).constructor):e.apply(t,r))}function Li(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Li=function(){return!!t})()}function Ti(t){return Ti=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ti(t)}function Fi(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ii(t,e)}function Ii(t,e){return Ii=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ii(t,e)}function Ni(t){return function(t){if(Array.isArray(t))return Ri(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Ri(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ri(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ri(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Mi(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Bi(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Mi(Object(r),!0).forEach((function(e){Gi(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Mi(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Gi(t,e,r){return(e=qi(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ui(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function zi(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,qi(n.key),n)}}function $i(t,e,r){return e&&zi(t.prototype,e),r&&zi(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function qi(t){var e=function(t){if("object"!=Ki(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Ki(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ki(e)?e:e+""}function Ki(t){return Ki="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ki(t)}function Hi(t){return Array.isArray?Array.isArray(t):"[object Array]"===Xi(t)}function Zi(t){return"string"==typeof t}function Yi(t){return"number"==typeof t}function Vi(t){return"object"===Ki(t)}function Wi(t){return null!=t}function Ji(t){return!t.trim().length}function Xi(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}var Qi=Object.prototype.hasOwnProperty,ta=function(){return $i((function t(e){var r=this;Ui(this,t),this._keys=[],this._keyMap={};var n=0;e.forEach((function(t){var e=ea(t);n+=e.weight,r._keys.push(e),r._keyMap[e.id]=e,n+=e.weight})),this._keys.forEach((function(t){t.weight/=n}))}),[{key:"get",value:function(t){return this._keyMap[t]}},{key:"keys",value:function(){return this._keys}},{key:"toJSON",value:function(){return JSON.stringify(this._keys)}}])}();function ea(t){var e=null,r=null,n=null,o=1,i=null;if(Zi(t)||Hi(t))n=t,e=ra(t),r=na(t);else{if(!Qi.call(t,"name"))throw new Error("Missing ".concat("name"," property in key"));var a=t.name;if(n=a,Qi.call(t,"weight")&&(o=t.weight)<=0)throw new Error(function(t){return"Property 'weight' in key '".concat(t,"' must be a positive integer")}(a));e=ra(a),r=na(a),i=t.getFn}return{path:e,id:r,weight:o,src:n,getFn:i}}function ra(t){return Hi(t)?t:t.split(".")}function na(t){return Hi(t)?t.join("."):t}var oa={useExtendedSearch:!1,getFn:function(t,e){var r=[],n=!1,o=function(t,e,i){if(Wi(t))if(e[i]){var a=t[e[i]];if(!Wi(a))return;if(i===e.length-1&&(Zi(a)||Yi(a)||function(t){return!0===t||!1===t||function(t){return Vi(t)&&null!==t}(t)&&"[object Boolean]"==Xi(t)}(a)))r.push(function(t){return null==t?"":function(t){if("string"==typeof t)return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}(t)}(a));else if(Hi(a)){n=!0;for(var u=0,s=a.length;u<s;u+=1)o(a[u],e,i+1)}else e.length&&o(a,e,i+1)}else r.push(t)};return o(t,Zi(e)?e.split("."):e,0),n?r:r[0]},ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1},ia=Bi(Bi(Bi(Bi({},{isCaseSensitive:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:function(t,e){return t.score===e.score?t.idx<e.idx?-1:1:t.score<e.score?-1:1}}),{includeMatches:!1,findAllMatches:!1,minMatchCharLength:1}),{location:0,threshold:.6,distance:100}),oa),aa=/[^ ]+/g,ua=function(){return $i((function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.getFn,n=void 0===r?ia.getFn:r,o=e.fieldNormWeight,i=void 0===o?ia.fieldNormWeight:o;Ui(this,t),this.norm=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,r=new Map,n=Math.pow(10,e);return{get:function(e){var o=e.match(aa).length;if(r.has(o))return r.get(o);var i=1/Math.pow(o,.5*t),a=parseFloat(Math.round(i*n)/n);return r.set(o,a),a},clear:function(){r.clear()}}}(i,3),this.getFn=n,this.isCreated=!1,this.setIndexRecords()}),[{key:"setSources",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.docs=t}},{key:"setIndexRecords",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.records=t}},{key:"setKeys",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.keys=e,this._keysMap={},e.forEach((function(e,r){t._keysMap[e.id]=r}))}},{key:"create",value:function(){var t=this;!this.isCreated&&this.docs.length&&(this.isCreated=!0,Zi(this.docs[0])?this.docs.forEach((function(e,r){t._addString(e,r)})):this.docs.forEach((function(e,r){t._addObject(e,r)})),this.norm.clear())}},{key:"add",value:function(t){var e=this.size();Zi(t)?this._addString(t,e):this._addObject(t,e)}},{key:"removeAt",value:function(t){this.records.splice(t,1);for(var e=t,r=this.size();e<r;e+=1)this.records[e].i-=1}},{key:"getValueForItemAtKeyId",value:function(t,e){return t[this._keysMap[e]]}},{key:"size",value:function(){return this.records.length}},{key:"_addString",value:function(t,e){if(Wi(t)&&!Ji(t)){var r={v:t,i:e,n:this.norm.get(t)};this.records.push(r)}}},{key:"_addObject",value:function(t,e){var r=this,n={i:e,$:{}};this.keys.forEach((function(e,o){var i=e.getFn?e.getFn(t):r.getFn(t,e.path);if(Wi(i))if(Hi(i)){for(var a=[],u=[{nestedArrIndex:-1,value:i}];u.length;){var s=u.pop(),c=s.nestedArrIndex,l=s.value;if(Wi(l))if(Zi(l)&&!Ji(l)){var f={v:l,i:c,n:r.norm.get(l)};a.push(f)}else Hi(l)&&l.forEach((function(t,e){u.push({nestedArrIndex:e,value:t})}))}n.$[o]=a}else if(Zi(i)&&!Ji(i)){var p={v:i,n:r.norm.get(i)};n.$[o]=p}})),this.records.push(n)}},{key:"toJSON",value:function(){return{keys:this.keys,records:this.records}}}])}();function sa(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.getFn,o=void 0===n?ia.getFn:n,i=r.fieldNormWeight,a=void 0===i?ia.fieldNormWeight:i,u=new ua({getFn:o,fieldNormWeight:a});return u.setKeys(t.map(ea)),u.setSources(e),u.create(),u}function ca(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.errors,n=void 0===r?0:r,o=e.currentLocation,i=void 0===o?0:o,a=e.expectedLocation,u=void 0===a?0:a,s=e.distance,c=void 0===s?ia.distance:s,l=e.ignoreLocation,f=void 0===l?ia.ignoreLocation:l,p=n/t.length;if(f)return p;var h=Math.abs(u-i);return c?p+h/c:h?1:p}var la=32;function fa(t){for(var e={},r=0,n=t.length;r<n;r+=1){var o=t.charAt(r);e[o]=(e[o]||0)|1<<n-r-1}return e}var pa=function(){return $i((function t(e){var r=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=n.location,i=void 0===o?ia.location:o,a=n.threshold,u=void 0===a?ia.threshold:a,s=n.distance,c=void 0===s?ia.distance:s,l=n.includeMatches,f=void 0===l?ia.includeMatches:l,p=n.findAllMatches,h=void 0===p?ia.findAllMatches:p,d=n.minMatchCharLength,y=void 0===d?ia.minMatchCharLength:d,v=n.isCaseSensitive,m=void 0===v?ia.isCaseSensitive:v,b=n.ignoreLocation,g=void 0===b?ia.ignoreLocation:b;if(Ui(this,t),this.options={location:i,threshold:u,distance:c,includeMatches:f,findAllMatches:h,minMatchCharLength:y,isCaseSensitive:m,ignoreLocation:g},this.pattern=m?e:e.toLowerCase(),this.chunks=[],this.pattern.length){var w=function(t,e){r.chunks.push({pattern:t,alphabet:fa(t),startIndex:e})},x=this.pattern.length;if(x>la){for(var _=0,E=x%la,O=x-E;_<O;)w(this.pattern.substr(_,la),_),_+=la;if(E){var k=x-la;w(this.pattern.substr(k),k)}}else w(this.pattern,0)}}),[{key:"searchIn",value:function(t){var e=this.options,r=e.isCaseSensitive,n=e.includeMatches;if(r||(t=t.toLowerCase()),this.pattern===t){var o={isMatch:!0,score:0};return n&&(o.indices=[[0,t.length-1]]),o}var i=this.options,a=i.location,u=i.distance,s=i.threshold,c=i.findAllMatches,l=i.minMatchCharLength,f=i.ignoreLocation,p=[],h=0,d=!1;this.chunks.forEach((function(e){var r=e.pattern,o=e.alphabet,i=e.startIndex,y=function(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=n.location,i=void 0===o?ia.location:o,a=n.distance,u=void 0===a?ia.distance:a,s=n.threshold,c=void 0===s?ia.threshold:s,l=n.findAllMatches,f=void 0===l?ia.findAllMatches:l,p=n.minMatchCharLength,h=void 0===p?ia.minMatchCharLength:p,d=n.includeMatches,y=void 0===d?ia.includeMatches:d,v=n.ignoreLocation,m=void 0===v?ia.ignoreLocation:v;if(e.length>la)throw new Error("Pattern length exceeds max of ".concat(32,"."));for(var b,g=e.length,w=t.length,x=Math.max(0,Math.min(i,w)),_=c,E=x,O=h>1||y,k=O?Array(w):[];(b=t.indexOf(e,E))>-1;){var j=ca(e,{currentLocation:b,expectedLocation:x,distance:u,ignoreLocation:m});if(_=Math.min(j,_),E=b+g,O)for(var S=0;S<g;)k[b+S]=1,S+=1}E=-1;for(var A=[],D=1,P=g+w,C=1<<g-1,L=0;L<g;L+=1){for(var T=0,F=P;T<F;)ca(e,{errors:L,currentLocation:x+F,expectedLocation:x,distance:u,ignoreLocation:m})<=_?T=F:P=F,F=Math.floor((P-T)/2+T);P=F;var I=Math.max(1,x-F+1),N=f?w:Math.min(x+F,w)+g,R=Array(N+2);R[N+1]=(1<<L)-1;for(var M=N;M>=I;M-=1){var B=M-1,G=r[t.charAt(B)];if(O&&(k[B]=+!!G),R[M]=(R[M+1]<<1|1)&G,L&&(R[M]|=(A[M+1]|A[M])<<1|1|A[M+1]),R[M]&C&&(D=ca(e,{errors:L,currentLocation:B,expectedLocation:x,distance:u,ignoreLocation:m}))<=_){if(_=D,(E=B)<=x)break;I=Math.max(1,2*x-E)}}if(ca(e,{errors:L+1,currentLocation:x,expectedLocation:x,distance:u,ignoreLocation:m})>_)break;A=R}var U={isMatch:E>=0,score:Math.max(.001,D)};if(O){var z=function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ia.minMatchCharLength,r=[],n=-1,o=-1,i=0,a=t.length;i<a;i+=1){var u=t[i];u&&-1===n?n=i:u||-1===n||((o=i-1)-n+1>=e&&r.push([n,o]),n=-1)}return t[i-1]&&i-n>=e&&r.push([n,i-1]),r}(k,h);z.length?y&&(U.indices=z):U.isMatch=!1}return U}(t,r,o,{location:a+i,distance:u,threshold:s,findAllMatches:c,minMatchCharLength:l,includeMatches:n,ignoreLocation:f}),v=y.isMatch,m=y.score,b=y.indices;v&&(d=!0),h+=m,v&&b&&(p=[].concat(Ni(p),Ni(b)))}));var y={isMatch:d,score:d?h/this.chunks.length:1};return d&&n&&(y.indices=p),y}}])}(),ha=function(){return $i((function t(e){Ui(this,t),this.pattern=e}),[{key:"search",value:function(){}}],[{key:"isMultiMatch",value:function(t){return da(t,this.multiRegex)}},{key:"isSingleMatch",value:function(t){return da(t,this.singleRegex)}}])}();function da(t,e){var r=t.match(e);return r?r[1]:null}var ya=function(t){function e(t){return Ui(this,e),Ci(this,e,[t])}return Fi(e,t),$i(e,[{key:"search",value:function(t){var e=t===this.pattern;return{isMatch:e,score:e?0:1,indices:[0,this.pattern.length-1]}}}],[{key:"type",get:function(){return"exact"}},{key:"multiRegex",get:function(){return/^="(.*)"$/}},{key:"singleRegex",get:function(){return/^=(.*)$/}}])}(ha),va=function(t){function e(t){return Ui(this,e),Ci(this,e,[t])}return Fi(e,t),$i(e,[{key:"search",value:function(t){var e=-1===t.indexOf(this.pattern);return{isMatch:e,score:e?0:1,indices:[0,t.length-1]}}}],[{key:"type",get:function(){return"inverse-exact"}},{key:"multiRegex",get:function(){return/^!"(.*)"$/}},{key:"singleRegex",get:function(){return/^!(.*)$/}}])}(ha),ma=function(t){function e(t){return Ui(this,e),Ci(this,e,[t])}return Fi(e,t),$i(e,[{key:"search",value:function(t){var e=t.startsWith(this.pattern);return{isMatch:e,score:e?0:1,indices:[0,this.pattern.length-1]}}}],[{key:"type",get:function(){return"prefix-exact"}},{key:"multiRegex",get:function(){return/^\^"(.*)"$/}},{key:"singleRegex",get:function(){return/^\^(.*)$/}}])}(ha),ba=function(t){function e(t){return Ui(this,e),Ci(this,e,[t])}return Fi(e,t),$i(e,[{key:"search",value:function(t){var e=!t.startsWith(this.pattern);return{isMatch:e,score:e?0:1,indices:[0,t.length-1]}}}],[{key:"type",get:function(){return"inverse-prefix-exact"}},{key:"multiRegex",get:function(){return/^!\^"(.*)"$/}},{key:"singleRegex",get:function(){return/^!\^(.*)$/}}])}(ha),ga=function(t){function e(t){return Ui(this,e),Ci(this,e,[t])}return Fi(e,t),$i(e,[{key:"search",value:function(t){var e=t.endsWith(this.pattern);return{isMatch:e,score:e?0:1,indices:[t.length-this.pattern.length,t.length-1]}}}],[{key:"type",get:function(){return"suffix-exact"}},{key:"multiRegex",get:function(){return/^"(.*)"\$$/}},{key:"singleRegex",get:function(){return/^(.*)\$$/}}])}(ha),wa=function(t){function e(t){return Ui(this,e),Ci(this,e,[t])}return Fi(e,t),$i(e,[{key:"search",value:function(t){var e=!t.endsWith(this.pattern);return{isMatch:e,score:e?0:1,indices:[0,t.length-1]}}}],[{key:"type",get:function(){return"inverse-suffix-exact"}},{key:"multiRegex",get:function(){return/^!"(.*)"\$$/}},{key:"singleRegex",get:function(){return/^!(.*)\$$/}}])}(ha),xa=function(t){function e(t){var r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=n.location,i=void 0===o?ia.location:o,a=n.threshold,u=void 0===a?ia.threshold:a,s=n.distance,c=void 0===s?ia.distance:s,l=n.includeMatches,f=void 0===l?ia.includeMatches:l,p=n.findAllMatches,h=void 0===p?ia.findAllMatches:p,d=n.minMatchCharLength,y=void 0===d?ia.minMatchCharLength:d,v=n.isCaseSensitive,m=void 0===v?ia.isCaseSensitive:v,b=n.ignoreLocation,g=void 0===b?ia.ignoreLocation:b;return Ui(this,e),(r=Ci(this,e,[t]))._bitapSearch=new pa(t,{location:i,threshold:u,distance:c,includeMatches:f,findAllMatches:h,minMatchCharLength:y,isCaseSensitive:m,ignoreLocation:g}),r}return Fi(e,t),$i(e,[{key:"search",value:function(t){return this._bitapSearch.searchIn(t)}}],[{key:"type",get:function(){return"fuzzy"}},{key:"multiRegex",get:function(){return/^"(.*)"$/}},{key:"singleRegex",get:function(){return/^(.*)$/}}])}(ha),_a=function(t){function e(t){return Ui(this,e),Ci(this,e,[t])}return Fi(e,t),$i(e,[{key:"search",value:function(t){for(var e,r=0,n=[],o=this.pattern.length;(e=t.indexOf(this.pattern,r))>-1;)r=e+o,n.push([e,r-1]);var i=!!n.length;return{isMatch:i,score:i?0:1,indices:n}}}],[{key:"type",get:function(){return"include"}},{key:"multiRegex",get:function(){return/^'"(.*)"$/}},{key:"singleRegex",get:function(){return/^'(.*)$/}}])}(ha),Ea=[ya,_a,ma,ba,wa,ga,va,xa],Oa=Ea.length,ka=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,ja=new Set([xa.type,_a.type]),Sa=function(){return $i((function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.isCaseSensitive,o=void 0===n?ia.isCaseSensitive:n,i=r.includeMatches,a=void 0===i?ia.includeMatches:i,u=r.minMatchCharLength,s=void 0===u?ia.minMatchCharLength:u,c=r.ignoreLocation,l=void 0===c?ia.ignoreLocation:c,f=r.findAllMatches,p=void 0===f?ia.findAllMatches:f,h=r.location,d=void 0===h?ia.location:h,y=r.threshold,v=void 0===y?ia.threshold:y,m=r.distance,b=void 0===m?ia.distance:m;Ui(this,t),this.query=null,this.options={isCaseSensitive:o,includeMatches:a,minMatchCharLength:s,findAllMatches:p,ignoreLocation:l,location:d,threshold:v,distance:b},this.pattern=o?e:e.toLowerCase(),this.query=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.split("|").map((function(t){for(var r=t.trim().split(ka).filter((function(t){return t&&!!t.trim()})),n=[],o=0,i=r.length;o<i;o+=1){for(var a=r[o],u=!1,s=-1;!u&&++s<Oa;){var c=Ea[s],l=c.isMultiMatch(a);l&&(n.push(new c(l,e)),u=!0)}if(!u)for(s=-1;++s<Oa;){var f=Ea[s],p=f.isSingleMatch(a);if(p){n.push(new f(p,e));break}}}return n}))}(this.pattern,this.options)}),[{key:"searchIn",value:function(t){var e=this.query;if(!e)return{isMatch:!1,score:1};var r=this.options,n=r.includeMatches;t=r.isCaseSensitive?t:t.toLowerCase();for(var o=0,i=[],a=0,u=0,s=e.length;u<s;u+=1){var c=e[u];i.length=0,o=0;for(var l=0,f=c.length;l<f;l+=1){var p=c[l],h=p.search(t),d=h.isMatch,y=h.indices,v=h.score;if(!d){a=0,o=0,i.length=0;break}if(o+=1,a+=v,n){var m=p.constructor.type;ja.has(m)?i=[].concat(Ni(i),Ni(y)):i.push(y)}}if(o){var b={isMatch:!0,score:a/o};return n&&(b.indices=i),b}}return{isMatch:!1,score:1}}}],[{key:"condition",value:function(t,e){return e.useExtendedSearch}}])}(),Aa=[];function Da(t,e){for(var r=0,n=Aa.length;r<n;r+=1){var o=Aa[r];if(o.condition(t,e))return new o(t,e)}return new pa(t,e)}var Pa="$and",Ca="$path",La=function(t){return!(!t[Pa]&&!t.$or)},Ta=function(t){return Gi({},Pa,Object.keys(t).map((function(e){return Gi({},e,t[e])})))};function Fa(t,e){var r=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).auto,n=void 0===r||r,o=function(t){var r=Object.keys(t),i=function(t){return!!t[Ca]}(t);if(!i&&r.length>1&&!La(t))return o(Ta(t));if(function(t){return!Hi(t)&&Vi(t)&&!La(t)}(t)){var a=i?t[Ca]:r[0],u=i?t.$val:t[a];if(!Zi(u))throw new Error(function(t){return"Invalid value for key ".concat(t)}(a));var s={keyId:na(a),pattern:u};return n&&(s.searcher=Da(u,e)),s}var c={children:[],operator:r[0]};return r.forEach((function(e){var r=t[e];Hi(r)&&r.forEach((function(t){c.children.push(o(t))}))})),c};return La(t)||(t=Ta(t)),o(t)}function Ia(t,e){var r=t.matches;e.matches=[],Wi(r)&&r.forEach((function(t){if(Wi(t.indices)&&t.indices.length){var r={indices:t.indices,value:t.value};t.key&&(r.key=t.key.src),t.idx>-1&&(r.refIndex=t.idx),e.matches.push(r)}}))}function Na(t,e){e.score=t.score}var Ra=function(){return $i((function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;Ui(this,t),this.options=Bi(Bi({},ia),r),this.options.useExtendedSearch,this._keyStore=new ta(this.options.keys),this.setCollection(e,n)}),[{key:"setCollection",value:function(t,e){if(this._docs=t,e&&!(e instanceof ua))throw new Error("Incorrect 'index' type");this._myIndex=e||sa(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}},{key:"add",value:function(t){Wi(t)&&(this._docs.push(t),this._myIndex.add(t))}},{key:"remove",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){return!1},e=[],r=0,n=this._docs.length;r<n;r+=1){var o=this._docs[r];t(o,r)&&(this.removeAt(r),r-=1,n-=1,e.push(o))}return e}},{key:"removeAt",value:function(t){this._docs.splice(t,1),this._myIndex.removeAt(t)}},{key:"getIndex",value:function(){return this._myIndex}},{key:"search",value:function(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).limit,r=void 0===e?-1:e,n=this.options,o=n.includeMatches,i=n.includeScore,a=n.shouldSort,u=n.sortFn,s=n.ignoreFieldNorm,c=Zi(t)?Zi(this._docs[0])?this._searchStringList(t):this._searchObjectList(t):this._searchLogical(t);return function(t,e){var r=e.ignoreFieldNorm,n=void 0===r?ia.ignoreFieldNorm:r;t.forEach((function(t){var e=1;t.matches.forEach((function(t){var r=t.key,o=t.norm,i=t.score,a=r?r.weight:null;e*=Math.pow(0===i&&a?Number.EPSILON:i,(a||1)*(n?1:o))})),t.score=e}))}(c,{ignoreFieldNorm:s}),a&&c.sort(u),Yi(r)&&r>-1&&(c=c.slice(0,r)),function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.includeMatches,o=void 0===n?ia.includeMatches:n,i=r.includeScore,a=void 0===i?ia.includeScore:i,u=[];return o&&u.push(Ia),a&&u.push(Na),t.map((function(t){var r=t.idx,n={item:e[r],refIndex:r};return u.length&&u.forEach((function(e){e(t,n)})),n}))}(c,this._docs,{includeMatches:o,includeScore:i})}},{key:"_searchStringList",value:function(t){var e=Da(t,this.options),r=this._myIndex.records,n=[];return r.forEach((function(t){var r=t.v,o=t.i,i=t.n;if(Wi(r)){var a=e.searchIn(r),u=a.isMatch,s=a.score,c=a.indices;u&&n.push({item:r,idx:o,matches:[{score:s,value:r,norm:i,indices:c}]})}})),n}},{key:"_searchLogical",value:function(t){var e=this,r=Fa(t,this.options),n=function(t,r,o){if(!t.children){var i=t.keyId,a=t.searcher,u=e._findMatches({key:e._keyStore.get(i),value:e._myIndex.getValueForItemAtKeyId(r,i),searcher:a});return u&&u.length?[{idx:o,item:r,matches:u}]:[]}for(var s=[],c=0,l=t.children.length;c<l;c+=1){var f=t.children[c],p=n(f,r,o);if(p.length)s.push.apply(s,Ni(p));else if(t.operator===Pa)return[]}return s},o=this._myIndex.records,i={},a=[];return o.forEach((function(t){var e=t.$,o=t.i;if(Wi(e)){var u=n(r,e,o);u.length&&(i[o]||(i[o]={idx:o,item:e,matches:[]},a.push(i[o])),u.forEach((function(t){var e,r=t.matches;(e=i[o].matches).push.apply(e,Ni(r))})))}})),a}},{key:"_searchObjectList",value:function(t){var e=this,r=Da(t,this.options),n=this._myIndex,o=n.keys,i=n.records,a=[];return i.forEach((function(t){var n=t.$,i=t.i;if(Wi(n)){var u=[];o.forEach((function(t,o){u.push.apply(u,Ni(e._findMatches({key:t,value:n[o],searcher:r})))})),u.length&&a.push({idx:i,item:n,matches:u})}})),a}},{key:"_findMatches",value:function(t){var e=t.key,r=t.value,n=t.searcher;if(!Wi(r))return[];var o=[];if(Hi(r))r.forEach((function(t){var r=t.v,i=t.i,a=t.n;if(Wi(r)){var u=n.searchIn(r),s=u.isMatch,c=u.score,l=u.indices;s&&o.push({score:c,key:e,value:r,idx:i,norm:a,indices:l})}}));else{var i=r.v,a=r.n,u=n.searchIn(i),s=u.isMatch,c=u.score,l=u.indices;s&&o.push({score:c,key:e,value:i,norm:a,indices:l})}return o}}])}();function Ma(t){return Ma="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ma(t)}function Ba(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Ga(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Ba(Object(r),!0).forEach((function(e){za(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ba(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Ua(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,$a(n.key),n)}}function za(t,e,r){return(e=$a(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $a(t){var e=function(t){if("object"!=Ma(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Ma(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ma(e)?e:e+""}Ra.version="6.6.2",Ra.createIndex=sa,Ra.parseIndex=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.getFn,n=void 0===r?ia.getFn:r,o=e.fieldNormWeight,i=void 0===o?ia.fieldNormWeight:o,a=t.keys,u=t.records,s=new ua({getFn:n,fieldNormWeight:i});return s.setKeys(a),s.setIndexRecords(u),s},Ra.config=ia,Ra.parseQuery=Fa,function(){Aa.push.apply(Aa,arguments)}(Sa);var qa=function(){return t=function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),za(this,"data",void 0),za(this,"fuseOptions",{shouldSort:!0,threshold:.1,keys:["value"]}),za(this,"fuse",void 0),this.data=this.mapData(e),this.fuse=new Ra(this.data,Ga(Ga({},this.fuseOptions),r))},(e=[{key:"mapData",value:function(t){var e=[];return Object.keys(t).forEach((function(r){var n=t[r];if("categorical"===n.origin){var o=new Set;n.values.forEach((function(t){var n=String(t);o.has(n)||(o.add(n),e.push({column:r,value:n}))}))}})),e}},{key:"search",value:function(t){return this.fuse.search(t,{limit:3}).reduce((function(t,e){return t.push(e.item),t}),[])}}])&&Ua(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function Ka(t){return Ka="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ka(t)}function Ha(){Ha=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new P(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function b(){}function g(){}var w={};c(w,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(w=_);var E=g.prototype=m.prototype=Object.create(w);function O(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,i,a,u){var s=f(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==Ka(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=S(u,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?y:h,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=y,n.method="throw",n.arg=c.arg)}}}function S(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,S(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function C(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(Ka(e)+" is not iterable")}return b.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=c(g,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,c(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},O(k.prototype),c(k.prototype,u,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(E),c(E,s,"Generator"),c(E,a,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=C,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),D(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;D(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:C(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function Za(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}var Ya="INUMBER",Va="IOP1",Wa="IOP2",Ja="IOP3",Xa="IVAR",Qa="IVARNAME",tu="IFUNCALL",eu="IFUNDEF",ru="IEXPR",nu="IEXPREVAL",ou="IMEMBER",iu="IENDSTATEMENT",au="IARRAY";function uu(t,e){this.type=t,this.value=null!=e?e:0}function su(t){return new uu(Va,t)}function cu(t){return new uu(Wa,t)}function lu(t){return new uu(Ja,t)}function fu(t,e,r,n,o){for(var i,a,u,s,c=[],l=[],f=0;f<t.length;f++){var p=t[f],h=p.type;if(h===Ya||h===Qa)Array.isArray(p.value)?c.push.apply(c,fu(p.value.map((function(t){return new uu(Ya,t)})).concat(new uu(au,p.value.length)),e,r,n,o)):c.push(p);else if(h===Xa&&o.hasOwnProperty(p.value))p=new uu(Ya,o[p.value]),c.push(p);else if(h===Wa&&c.length>1)a=c.pop(),i=c.pop(),s=r[p.value],p=new uu(Ya,s(i.value,a.value)),c.push(p);else if(h===Ja&&c.length>2)u=c.pop(),a=c.pop(),i=c.pop(),"?"===p.value?c.push(i.value?a.value:u.value):(s=n[p.value],p=new uu(Ya,s(i.value,a.value,u.value)),c.push(p));else if(h===Va&&c.length>0)i=c.pop(),s=e[p.value],p=new uu(Ya,s(i.value)),c.push(p);else if(h===ru){for(;c.length>0;)l.push(c.shift());l.push(new uu(ru,fu(p.value,e,r,n,o)))}else if(h===ou&&c.length>0)i=c.pop(),c.push(new uu(Ya,i.value[p.value]));else{for(;c.length>0;)l.push(c.shift());l.push(p)}}for(;c.length>0;)l.push(c.shift());return l}function pu(t,e,r){for(var n=[],o=0;o<t.length;o++){var i=t[o],a=i.type;if(a===Xa&&i.value===e)for(var u=0;u<r.tokens.length;u++){var s,c=r.tokens[u];s=c.type===Va?su(c.value):c.type===Wa?cu(c.value):c.type===Ja?lu(c.value):new uu(c.type,c.value),n.push(s)}else a===ru?n.push(new uu(ru,pu(i.value,e,r))):n.push(i)}return n}function hu(t,e,r){var n,o,i,a,u,s,c=[];if(yu(t))return vu(t,r);for(var l=t.length,f=0;f<l;f++){var p=t[f],h=p.type;if(h===Ya||h===Qa)c.push(p.value);else if(h===Wa)o=c.pop(),n=c.pop(),"and"===p.value?c.push(!!n&&!!hu(o,e,r)):"or"===p.value?c.push(!!n||!!hu(o,e,r)):"="===p.value?(a=e.binaryOps[p.value],c.push(a(n,hu(o,e,r),r))):(a=e.binaryOps[p.value],c.push(a(vu(n,r),vu(o,r))));else if(h===Ja)i=c.pop(),o=c.pop(),n=c.pop(),"?"===p.value?c.push(hu(n?o:i,e,r)):(a=e.ternaryOps[p.value],c.push(a(vu(n,r),vu(o,r),vu(i,r))));else if(h===Xa)if(p.value in e.functions)c.push(e.functions[p.value]);else if(p.value in e.unaryOps&&e.parser.isOperatorEnabled(p.value))c.push(e.unaryOps[p.value]);else{var d=r[p.value];if(void 0===d)throw new Error("undefined variable: "+p.value);c.push(d)}else if(h===Va)n=c.pop(),a=e.unaryOps[p.value],c.push(a(vu(n,r)));else if(h===tu){for(s=p.value,u=[];s-- >0;)u.unshift(vu(c.pop(),r));if(!(a=c.pop()).apply||!a.call)throw new Error(a+" is not a function");c.push(a.apply(void 0,u))}else if(h===eu)c.push(function(){for(var t=c.pop(),n=[],o=p.value;o-- >0;)n.unshift(c.pop());var i=c.pop(),a=function(){for(var o=Object.assign({},r),i=0,a=n.length;i<a;i++)o[n[i]]=arguments[i];return hu(t,e,o)};return Object.defineProperty(a,"name",{value:i,writable:!1}),r[i]=a,a}());else if(h===ru)c.push(du(p,e));else if(h===nu)c.push(p);else if(h===ou)n=c.pop(),c.push(n[p.value]);else if(h===iu)c.pop();else{if(h!==au)throw new Error("invalid Expression");for(s=p.value,u=[];s-- >0;)u.unshift(c.pop());c.push(u)}}if(c.length>1)throw new Error("invalid Expression (parity)");return 0===c[0]?0:vu(c[0],r)}function du(t,e,r){return yu(t)?t:{type:nu,value:function(r){return hu(t.value,e,r)}}}function yu(t){return t&&t.type===nu}function vu(t,e){return yu(t)?t.value(e):t}function mu(t,e){for(var r,n,o,i,a,u,s=[],c=0;c<t.length;c++){var l=t[c],f=l.type;if(f===Ya)"number"==typeof l.value&&l.value<0?s.push("("+l.value+")"):Array.isArray(l.value)?s.push("["+l.value.map(bu).join(", ")+"]"):s.push(bu(l.value));else if(f===Wa)n=s.pop(),r=s.pop(),i=l.value,e?"^"===i?s.push("Math.pow("+r+", "+n+")"):"and"===i?s.push("(!!"+r+" && !!"+n+")"):"or"===i?s.push("(!!"+r+" || !!"+n+")"):"||"===i?s.push("(function(a,b){ return Array.isArray(a) && Array.isArray(b) ? a.concat(b) : String(a) + String(b); }(("+r+"),("+n+")))"):"=="===i?s.push("("+r+" === "+n+")"):"!="===i?s.push("("+r+" !== "+n+")"):"["===i?s.push(r+"[("+n+") | 0]"):s.push("("+r+" "+i+" "+n+")"):"["===i?s.push(r+"["+n+"]"):s.push("("+r+" "+i+" "+n+")");else if(f===Ja){if(o=s.pop(),n=s.pop(),r=s.pop(),"?"!==(i=l.value))throw new Error("invalid Expression");s.push("("+r+" ? "+n+" : "+o+")")}else if(f===Xa||f===Qa)s.push(l.value);else if(f===Va)r=s.pop(),"-"===(i=l.value)||"+"===i?s.push("("+i+r+")"):e?"not"===i?s.push("(!"+r+")"):"!"===i?s.push("fac("+r+")"):s.push(i+"("+r+")"):"!"===i?s.push("("+r+"!)"):s.push("("+i+" "+r+")");else if(f===tu){for(u=l.value,a=[];u-- >0;)a.unshift(s.pop());i=s.pop(),s.push(i+"("+a.join(", ")+")")}else if(f===eu){for(n=s.pop(),u=l.value,a=[];u-- >0;)a.unshift(s.pop());r=s.pop(),e?s.push("("+r+" = function("+a.join(", ")+") { return "+n+" })"):s.push("("+r+"("+a.join(", ")+") = "+n+")")}else if(f===ou)r=s.pop(),s.push(r+"."+l.value);else if(f===au){for(u=l.value,a=[];u-- >0;)a.unshift(s.pop());s.push("["+a.join(", ")+"]")}else if(f===ru)s.push("("+mu(l.value,e)+")");else if(f!==iu)throw new Error("invalid Expression")}return s.length>1&&(s=e?[s.join(",")]:[s.join(";")]),String(s[0])}function bu(t){return"string"==typeof t?JSON.stringify(t).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029"):t}function gu(t,e){for(var r=0;r<t.length;r++)if(t[r]===e)return!0;return!1}function wu(t,e,r){for(var n=!!(r=r||{}).withMembers,o=null,i=0;i<t.length;i++){var a=t[i];a.type===Xa||a.type===Qa?n||gu(e,a.value)?null!==o?(gu(e,o)||e.push(o),o=a.value):o=a.value:e.push(a.value):a.type===ou&&n&&null!==o?o+="."+a.value:a.type===ru?wu(a.value,e,r):null!==o&&(gu(e,o)||e.push(o),o=null)}null===o||gu(e,o)||e.push(o)}function xu(t,e){this.tokens=t,this.parser=e,this.unaryOps=e.unaryOps,this.binaryOps=e.binaryOps,this.ternaryOps=e.ternaryOps,this.functions=e.functions}uu.prototype.toString=function(){switch(this.type){case Ya:case Va:case Wa:case Ja:case Xa:case Qa:case iu:return this.value;case tu:return"CALL "+this.value;case eu:return"DEF "+this.value;case au:return"ARRAY "+this.value;case ou:return"."+this.value;default:return"Invalid Instruction"}},xu.prototype.simplify=function(t){return t=t||{},new xu(fu(this.tokens,this.unaryOps,this.binaryOps,this.ternaryOps,t),this.parser)},xu.prototype.substitute=function(t,e){return e instanceof xu||(e=this.parser.parse(String(e))),new xu(pu(this.tokens,t,e),this.parser)},xu.prototype.evaluate=function(t){return t=t||{},hu(this.tokens,this,t)},xu.prototype.toString=function(){return mu(this.tokens,!1)},xu.prototype.symbols=function(t){t=t||{};var e=[];return wu(this.tokens,e,t),e},xu.prototype.variables=function(t){t=t||{};var e=[];wu(this.tokens,e,t);var r=this.functions;return e.filter((function(t){return!(t in r)}))},xu.prototype.toJSFunction=function(t,e){var r=this,n=new Function(t,"with(this.functions) with (this.ternaryOps) with (this.binaryOps) with (this.unaryOps) { return "+mu(this.simplify(e).tokens,!0)+"; }");return function(){return n.apply(r,arguments)}};var _u="TEOF",Eu="TOP",Ou="TNUMBER",ku="TSTRING",ju="TPAREN",Su="TBRACKET",Au="TCOMMA",Du="TNAME",Pu="TSEMICOLON";function Cu(t,e,r){this.type=t,this.value=e,this.index=r}function Lu(t,e){this.pos=0,this.current=null,this.unaryOps=t.unaryOps,this.binaryOps=t.binaryOps,this.ternaryOps=t.ternaryOps,this.consts=t.consts,this.expression=e,this.savedPosition=0,this.savedCurrent=null,this.options=t.options,this.parser=t}Cu.prototype.toString=function(){return this.type+": "+this.value},Lu.prototype.newToken=function(t,e,r){return new Cu(t,e,null!=r?r:this.pos)},Lu.prototype.save=function(){this.savedPosition=this.pos,this.savedCurrent=this.current},Lu.prototype.restore=function(){this.pos=this.savedPosition,this.current=this.savedCurrent},Lu.prototype.next=function(){return this.pos>=this.expression.length?this.newToken(_u,"EOF"):this.isWhitespace()||this.isComment()?this.next():this.isRadixInteger()||this.isNumber()||this.isOperator()||this.isString()||this.isParen()||this.isBracket()||this.isComma()||this.isSemicolon()||this.isNamedOp()||this.isConst()||this.isName()?this.current:void this.parseError('Unknown character "'+this.expression.charAt(this.pos)+'"')},Lu.prototype.isString=function(){var t=!1,e=this.pos,r=this.expression.charAt(e);if("'"===r||'"'===r)for(var n=this.expression.indexOf(r,e+1);n>=0&&this.pos<this.expression.length;){if(this.pos=n+1,"\\"!==this.expression.charAt(n-1)){var o=this.expression.substring(e+1,n);this.current=this.newToken(ku,this.unescape(o),e),t=!0;break}n=this.expression.indexOf(r,n+1)}return t},Lu.prototype.isParen=function(){var t=this.expression.charAt(this.pos);return("("===t||")"===t)&&(this.current=this.newToken(ju,t),this.pos++,!0)},Lu.prototype.isBracket=function(){var t=this.expression.charAt(this.pos);return!("["!==t&&"]"!==t||!this.isOperatorEnabled("[")||(this.current=this.newToken(Su,t),this.pos++,0))},Lu.prototype.isComma=function(){return","===this.expression.charAt(this.pos)&&(this.current=this.newToken(Au,","),this.pos++,!0)},Lu.prototype.isSemicolon=function(){return";"===this.expression.charAt(this.pos)&&(this.current=this.newToken(Pu,";"),this.pos++,!0)},Lu.prototype.isConst=function(){for(var t=this.pos,e=t;e<this.expression.length;e++){var r=this.expression.charAt(e);if(r.toUpperCase()===r.toLowerCase()&&(e===this.pos||"_"!==r&&"."!==r&&(r<"0"||r>"9")))break}if(e>t){var n=this.expression.substring(t,e);if(n in this.consts)return this.current=this.newToken(Ou,this.consts[n]),this.pos+=n.length,!0}return!1},Lu.prototype.isNamedOp=function(){for(var t=this.pos,e=t;e<this.expression.length;e++){var r=this.expression.charAt(e);if(r.toUpperCase()===r.toLowerCase()&&(e===this.pos||"_"!==r&&(r<"0"||r>"9")))break}if(e>t){var n=this.expression.substring(t,e);if(this.isOperatorEnabled(n)&&(n in this.binaryOps||n in this.unaryOps||n in this.ternaryOps))return this.current=this.newToken(Eu,n),this.pos+=n.length,!0}return!1},Lu.prototype.isName=function(){for(var t=this.pos,e=t,r=!1;e<this.expression.length;e++){var n=this.expression.charAt(e);if(n.toUpperCase()===n.toLowerCase()){if(e===this.pos&&("$"===n||"_"===n)){"_"===n&&(r=!0);continue}if(e===this.pos||!r||"_"!==n&&(n<"0"||n>"9"))break}else r=!0}if(r){var o=this.expression.substring(t,e);return this.current=this.newToken(Du,o),this.pos+=o.length,!0}return!1},Lu.prototype.isWhitespace=function(){for(var t=!1,e=this.expression.charAt(this.pos);!(" "!==e&&"\t"!==e&&"\n"!==e&&"\r"!==e||(t=!0,this.pos++,this.pos>=this.expression.length));)e=this.expression.charAt(this.pos);return t};var Tu=/^[0-9a-f]{4}$/i;function Fu(t,e,r){this.parser=t,this.tokens=e,this.current=null,this.nextToken=null,this.next(),this.savedCurrent=null,this.savedNextToken=null,this.allowMemberAccess=!1!==r.allowMemberAccess}Lu.prototype.unescape=function(t){var e=t.indexOf("\\");if(e<0)return t;for(var r=t.substring(0,e);e>=0;){var n=t.charAt(++e);switch(n){case"'":r+="'";break;case'"':r+='"';break;case"\\":r+="\\";break;case"/":r+="/";break;case"b":r+="\b";break;case"f":r+="\f";break;case"n":r+="\n";break;case"r":r+="\r";break;case"t":r+="\t";break;case"u":var o=t.substring(e+1,e+5);Tu.test(o)||this.parseError("Illegal escape sequence: \\u"+o),r+=String.fromCharCode(parseInt(o,16)),e+=4;break;default:throw this.parseError('Illegal escape sequence: "\\'+n+'"')}++e;var i=t.indexOf("\\",e);r+=t.substring(e,i<0?t.length:i),e=i}return r},Lu.prototype.isComment=function(){return"/"===this.expression.charAt(this.pos)&&"*"===this.expression.charAt(this.pos+1)&&(this.pos=this.expression.indexOf("*/",this.pos)+2,1===this.pos&&(this.pos=this.expression.length),!0)},Lu.prototype.isRadixInteger=function(){var t,e,r=this.pos;if(r>=this.expression.length-2||"0"!==this.expression.charAt(r))return!1;if(++r,"x"===this.expression.charAt(r))t=16,e=/^[0-9a-f]$/i,++r;else{if("b"!==this.expression.charAt(r))return!1;t=2,e=/^[01]$/i,++r}for(var n=!1,o=r;r<this.expression.length;){var i=this.expression.charAt(r);if(!e.test(i))break;r++,n=!0}return n&&(this.current=this.newToken(Ou,parseInt(this.expression.substring(o,r),t)),this.pos=r),n},Lu.prototype.isNumber=function(){for(var t,e=!1,r=this.pos,n=r,o=r,i=!1,a=!1;r<this.expression.length&&((t=this.expression.charAt(r))>="0"&&t<="9"||!i&&"."===t);)"."===t?i=!0:a=!0,r++,e=a;if(e&&(o=r),"e"===t||"E"===t){r++;for(var u=!0,s=!1;r<this.expression.length;){if(t=this.expression.charAt(r),!u||"+"!==t&&"-"!==t){if(!(t>="0"&&t<="9"))break;s=!0,u=!1}else u=!1;r++}s||(r=o)}return e?(this.current=this.newToken(Ou,parseFloat(this.expression.substring(n,r))),this.pos=r):this.pos=o,e},Lu.prototype.isOperator=function(){var t=this.pos,e=this.expression.charAt(this.pos);if("+"===e||"-"===e||"*"===e||"/"===e||"%"===e||"^"===e||"?"===e||":"===e||"."===e)this.current=this.newToken(Eu,e);else if("∙"===e||"•"===e)this.current=this.newToken(Eu,"*");else if(">"===e)"="===this.expression.charAt(this.pos+1)?(this.current=this.newToken(Eu,">="),this.pos++):this.current=this.newToken(Eu,">");else if("<"===e)"="===this.expression.charAt(this.pos+1)?(this.current=this.newToken(Eu,"<="),this.pos++):this.current=this.newToken(Eu,"<");else if("|"===e){if("|"!==this.expression.charAt(this.pos+1))return!1;this.current=this.newToken(Eu,"||"),this.pos++}else if("="===e)"="===this.expression.charAt(this.pos+1)?(this.current=this.newToken(Eu,"=="),this.pos++):this.current=this.newToken(Eu,e);else{if("!"!==e)return!1;"="===this.expression.charAt(this.pos+1)?(this.current=this.newToken(Eu,"!="),this.pos++):this.current=this.newToken(Eu,e)}return this.pos++,!!this.isOperatorEnabled(this.current.value)||(this.pos=t,!1)},Lu.prototype.isOperatorEnabled=function(t){return this.parser.isOperatorEnabled(t)},Lu.prototype.getCoordinates=function(){var t,e=0,r=-1;do{e++,t=this.pos-r,r=this.expression.indexOf("\n",r+1)}while(r>=0&&r<this.pos);return{line:e,column:t}},Lu.prototype.parseError=function(t){var e=this.getCoordinates();throw new Error("parse error ["+e.line+":"+e.column+"]: "+t)},Fu.prototype.next=function(){return this.current=this.nextToken,this.nextToken=this.tokens.next()},Fu.prototype.tokenMatches=function(t,e){return void 0===e||(Array.isArray(e)?gu(e,t.value):"function"==typeof e?e(t):t.value===e)},Fu.prototype.save=function(){this.savedCurrent=this.current,this.savedNextToken=this.nextToken,this.tokens.save()},Fu.prototype.restore=function(){this.tokens.restore(),this.current=this.savedCurrent,this.nextToken=this.savedNextToken},Fu.prototype.accept=function(t,e){return!(this.nextToken.type!==t||!this.tokenMatches(this.nextToken,e)||(this.next(),0))},Fu.prototype.expect=function(t,e){if(!this.accept(t,e)){var r=this.tokens.getCoordinates();throw new Error("parse error ["+r.line+":"+r.column+"]: Expected "+(e||t))}},Fu.prototype.parseAtom=function(t){var e=this.tokens.unaryOps;if(this.accept(Du)||this.accept(Eu,(function(t){return t.value in e})))t.push(new uu(Xa,this.current.value));else if(this.accept(Ou))t.push(new uu(Ya,this.current.value));else if(this.accept(ku))t.push(new uu(Ya,this.current.value));else if(this.accept(ju,"("))this.parseExpression(t),this.expect(ju,")");else{if(!this.accept(Su,"["))throw new Error("unexpected "+this.nextToken);if(this.accept(Su,"]"))t.push(new uu(au,0));else{var r=this.parseArrayList(t);t.push(new uu(au,r))}}},Fu.prototype.parseExpression=function(t){var e=[];this.parseUntilEndStatement(t,e)||(this.parseVariableAssignmentExpression(e),this.parseUntilEndStatement(t,e)||this.pushExpression(t,e))},Fu.prototype.pushExpression=function(t,e){for(var r=0,n=e.length;r<n;r++)t.push(e[r])},Fu.prototype.parseUntilEndStatement=function(t,e){return!!this.accept(Pu)&&(!this.nextToken||this.nextToken.type===_u||this.nextToken.type===ju&&")"===this.nextToken.value||e.push(new uu(iu)),this.nextToken.type!==_u&&this.parseExpression(e),t.push(new uu(ru,e)),!0)},Fu.prototype.parseArrayList=function(t){for(var e=0;!this.accept(Su,"]");)for(this.parseExpression(t),++e;this.accept(Au);)this.parseExpression(t),++e;return e},Fu.prototype.parseVariableAssignmentExpression=function(t){for(this.parseConditionalExpression(t);this.accept(Eu,"=");){var e=t.pop(),r=[],n=t.length-1;if(e.type!==tu){if(e.type!==Xa&&e.type!==ou)throw new Error("expected variable for assignment");this.parseVariableAssignmentExpression(r),t.push(new uu(Qa,e.value)),t.push(new uu(ru,r)),t.push(cu("="))}else{if(!this.tokens.isOperatorEnabled("()="))throw new Error("function definition is not permitted");for(var o=0,i=e.value+1;o<i;o++){var a=n-o;t[a].type===Xa&&(t[a]=new uu(Qa,t[a].value))}this.parseVariableAssignmentExpression(r),t.push(new uu(ru,r)),t.push(new uu(eu,e.value))}}},Fu.prototype.parseConditionalExpression=function(t){for(this.parseOrExpression(t);this.accept(Eu,"?");){var e=[],r=[];this.parseConditionalExpression(e),this.expect(Eu,":"),this.parseConditionalExpression(r),t.push(new uu(ru,e)),t.push(new uu(ru,r)),t.push(lu("?"))}},Fu.prototype.parseOrExpression=function(t){for(this.parseAndExpression(t);this.accept(Eu,"or");){var e=[];this.parseAndExpression(e),t.push(new uu(ru,e)),t.push(cu("or"))}},Fu.prototype.parseAndExpression=function(t){for(this.parseComparison(t);this.accept(Eu,"and");){var e=[];this.parseComparison(e),t.push(new uu(ru,e)),t.push(cu("and"))}};var Iu=["==","!=","<","<=",">=",">","in"];Fu.prototype.parseComparison=function(t){for(this.parseAddSub(t);this.accept(Eu,Iu);){var e=this.current;this.parseAddSub(t),t.push(cu(e.value))}};var Nu=["+","-","||"];Fu.prototype.parseAddSub=function(t){for(this.parseTerm(t);this.accept(Eu,Nu);){var e=this.current;this.parseTerm(t),t.push(cu(e.value))}};var Ru=["*","/","%"];function Mu(t,e){return Number(t)+Number(e)}function Bu(t,e){return t-e}function Gu(t,e){return t*e}function Uu(t,e){return t/e}function zu(t,e){return t%e}function $u(t,e){return Array.isArray(t)&&Array.isArray(e)?t.concat(e):""+t+e}function qu(t,e){return t===e}function Ku(t,e){return t!==e}function Hu(t,e){return t>e}function Zu(t,e){return t<e}function Yu(t,e){return t>=e}function Vu(t,e){return t<=e}function Wu(t,e){return Boolean(t&&e)}function Ju(t,e){return Boolean(t||e)}function Xu(t,e){return gu(e,t)}function Qu(t){return(Math.exp(t)-Math.exp(-t))/2}function ts(t){return(Math.exp(t)+Math.exp(-t))/2}function es(t){return t===1/0?1:t===-1/0?-1:(Math.exp(t)-Math.exp(-t))/(Math.exp(t)+Math.exp(-t))}function rs(t){return t===-1/0?t:Math.log(t+Math.sqrt(t*t+1))}function ns(t){return Math.log(t+Math.sqrt(t*t-1))}function os(t){return Math.log((1+t)/(1-t))/2}function is(t){return Math.log(t)*Math.LOG10E}function as(t){return-t}function us(t){return!t}function ss(t){return t<0?Math.ceil(t):Math.floor(t)}function cs(t){return Math.random()*(t||1)}function ls(t){return hs(t+1)}Fu.prototype.parseTerm=function(t){for(this.parseFactor(t);this.accept(Eu,Ru);){var e=this.current;this.parseFactor(t),t.push(cu(e.value))}},Fu.prototype.parseFactor=function(t){var e=this.tokens.unaryOps;if(this.save(),this.accept(Eu,(function(t){return t.value in e}))){if("-"!==this.current.value&&"+"!==this.current.value){if(this.nextToken.type===ju&&"("===this.nextToken.value)return this.restore(),void this.parseExponential(t);if(this.nextToken.type===Pu||this.nextToken.type===Au||this.nextToken.type===_u||this.nextToken.type===ju&&")"===this.nextToken.value)return this.restore(),void this.parseAtom(t)}var r=this.current;this.parseFactor(t),t.push(su(r.value))}else this.parseExponential(t)},Fu.prototype.parseExponential=function(t){for(this.parsePostfixExpression(t);this.accept(Eu,"^");)this.parseFactor(t),t.push(cu("^"))},Fu.prototype.parsePostfixExpression=function(t){for(this.parseFunctionCall(t);this.accept(Eu,"!");)t.push(su("!"))},Fu.prototype.parseFunctionCall=function(t){var e=this.tokens.unaryOps;if(this.accept(Eu,(function(t){return t.value in e}))){var r=this.current;this.parseAtom(t),t.push(su(r.value))}else for(this.parseMemberExpression(t);this.accept(ju,"(");)if(this.accept(ju,")"))t.push(new uu(tu,0));else{var n=this.parseArgumentList(t);t.push(new uu(tu,n))}},Fu.prototype.parseArgumentList=function(t){for(var e=0;!this.accept(ju,")");)for(this.parseExpression(t),++e;this.accept(Au);)this.parseExpression(t),++e;return e},Fu.prototype.parseMemberExpression=function(t){for(this.parseAtom(t);this.accept(Eu,".")||this.accept(Su,"[");){var e=this.current;if("."===e.value){if(!this.allowMemberAccess)throw new Error('unexpected ".", member access is not permitted');this.expect(Du),t.push(new uu(ou,this.current.value))}else{if("["!==e.value)throw new Error("unexpected symbol: "+e.value);if(!this.tokens.isOperatorEnabled("["))throw new Error('unexpected "[]", arrays are disabled');this.parseExpression(t),this.expect(Su,"]"),t.push(cu("["))}}};var fs=4.7421875,ps=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22];function hs(t){var e,r;if(function(t){return isFinite(t)&&t===Math.round(t)}(t)){if(t<=0)return isFinite(t)?1/0:NaN;if(t>171)return 1/0;for(var n=t-2,o=t-1;n>1;)o*=n,n--;return 0===o&&(o=1),o}if(t<.5)return Math.PI/(Math.sin(Math.PI*t)*hs(1-t));if(t>=171.35)return 1/0;if(t>85){var i=t*t,a=i*t,u=a*t,s=u*t;return Math.sqrt(2*Math.PI/t)*Math.pow(t/Math.E,t)*(1+1/(12*t)+1/(288*i)-139/(51840*a)-571/(2488320*u)+163879/(209018880*s)+5246819/(75246796800*s*t))}--t,r=ps[0];for(var c=1;c<ps.length;++c)r+=ps[c]/(t+c);return e=t+fs+.5,Math.sqrt(2*Math.PI)*Math.pow(e,t+.5)*Math.exp(-e)*r}function ds(t){return Array.isArray(t)?t.length:String(t).length}function ys(){for(var t=0,e=0,r=0;r<arguments.length;r++){var n,o=Math.abs(arguments[r]);e<o?(t=t*(n=e/o)*n+1,e=o):t+=o>0?(n=o/e)*n:o}return e===1/0?1/0:e*Math.sqrt(t)}function vs(t,e,r){return t?e:r}function ms(t,e){return void 0===e||0==+e?Math.round(t):(t=+t,e=-+e,isNaN(t)||"number"!=typeof e||e%1!=0?NaN:(t=t.toString().split("e"),+((t=(t=Math.round(+(t[0]+"e"+(t[1]?+t[1]-e:-e)))).toString().split("e"))[0]+"e"+(t[1]?+t[1]+e:e))))}function bs(t,e,r){return r&&(r[t]=e),e}function gs(t,e){return t[0|e]}function ws(t){return 1===arguments.length&&Array.isArray(t)?Math.max.apply(Math,t):Math.max.apply(Math,arguments)}function xs(t){return 1===arguments.length&&Array.isArray(t)?Math.min.apply(Math,t):Math.min.apply(Math,arguments)}function _s(t,e){if("function"!=typeof t)throw new Error("First argument to map is not a function");if(!Array.isArray(e))throw new Error("Second argument to map is not an array");return e.map((function(e,r){return t(e,r)}))}function Es(t,e,r){if("function"!=typeof t)throw new Error("First argument to fold is not a function");if(!Array.isArray(r))throw new Error("Second argument to fold is not an array");return r.reduce((function(e,r,n){return t(e,r,n)}),e)}function Os(t,e){if("function"!=typeof t)throw new Error("First argument to filter is not a function");if(!Array.isArray(e))throw new Error("Second argument to filter is not an array");return e.filter((function(e,r){return t(e,r)}))}function ks(t,e){if(!Array.isArray(e)&&"string"!=typeof e)throw new Error("Second argument to indexOf is not a string or array");return e.indexOf(t)}function js(t,e){if(!Array.isArray(e))throw new Error("Second argument to join is not an array");return e.join(t)}function Ss(t){return(t>0)-(t<0)||+t}var As=1/3;function Ds(t){return t<0?-Math.pow(-t,As):Math.pow(t,As)}function Ps(t){return Math.exp(t)-1}function Cs(t){return Math.log(1+t)}function Ls(t){return Math.log(t)/Math.LN2}function Ts(t){this.options=t||{},this.unaryOps={sin:Math.sin,cos:Math.cos,tan:Math.tan,asin:Math.asin,acos:Math.acos,atan:Math.atan,sinh:Math.sinh||Qu,cosh:Math.cosh||ts,tanh:Math.tanh||es,asinh:Math.asinh||rs,acosh:Math.acosh||ns,atanh:Math.atanh||os,sqrt:Math.sqrt,cbrt:Math.cbrt||Ds,log:Math.log,log2:Math.log2||Ls,ln:Math.log,lg:Math.log10||is,log10:Math.log10||is,expm1:Math.expm1||Ps,log1p:Math.log1p||Cs,abs:Math.abs,ceil:Math.ceil,floor:Math.floor,round:Math.round,trunc:Math.trunc||ss,"-":as,"+":Number,exp:Math.exp,not:us,length:ds,"!":ls,sign:Math.sign||Ss},this.binaryOps={"+":Mu,"-":Bu,"*":Gu,"/":Uu,"%":zu,"^":Math.pow,"||":$u,"==":qu,"!=":Ku,">":Hu,"<":Zu,">=":Yu,"<=":Vu,and:Wu,or:Ju,in:Xu,"=":bs,"[":gs},this.ternaryOps={"?":vs},this.functions={random:cs,fac:ls,min:xs,max:ws,hypot:Math.hypot||ys,pyt:Math.hypot||ys,pow:Math.pow,atan2:Math.atan2,if:vs,gamma:hs,roundTo:ms,map:_s,fold:Es,filter:Os,indexOf:ks,join:js},this.consts={E:Math.E,PI:Math.PI,true:!0,false:!1}}Ts.prototype.parse=function(t){var e=[],r=new Fu(this,new Lu(this,t),{allowMemberAccess:this.options.allowMemberAccess});return r.parseExpression(e),r.expect(_u,"EOF"),new xu(e,this)},Ts.prototype.evaluate=function(t,e){return this.parse(t).evaluate(e)};var Fs=new Ts;Ts.parse=function(t){return Fs.parse(t)},Ts.evaluate=function(t,e){return Fs.parse(t).evaluate(e)};var Is={"+":"add","-":"subtract","*":"multiply","/":"divide","%":"remainder","^":"power","!":"factorial","<":"comparison",">":"comparison","<=":"comparison",">=":"comparison","==":"comparison","!=":"comparison","||":"concatenate",and:"logical",or:"logical",not:"logical","?":"conditional",":":"conditional","=":"assignment","[":"array","()=":"fndef"};function Ns(t){return Ns="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ns(t)}function Rs(){Rs=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new P(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function b(){}function g(){}var w={};c(w,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(w=_);var E=g.prototype=m.prototype=Object.create(w);function O(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,i,a,u){var s=f(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==Ns(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=S(u,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?y:h,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=y,n.method="throw",n.arg=c.arg)}}}function S(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,S(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function C(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(Ns(e)+" is not iterable")}return b.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=c(g,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,c(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},O(k.prototype),c(k.prototype,u,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(E),c(E,s,"Generator"),c(E,a,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=C,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),D(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;D(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:C(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function Ms(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}Ts.prototype.isOperatorEnabled=function(t){var e=function(t){return Is.hasOwnProperty(t)?Is[t]:t}(t),r=this.options.operators||{};return!(e in r)||!!r[e]};var Bs,Gs,Us=new mn({name:"multiple-calculator",description:"descFunc2",schema:Ur.z.object({mathExpressions:Ur.z.array(Ur.z.string()).describe("desc")}),func:(Bs=Rs().mark((function t(e){var r;return Rs().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.mathExpressions,t.abrupt("return",JSON.stringify(r.map(zs)));case 2:case"end":return t.stop()}}),t)})),Gs=function(){var t=this,e=arguments;return new Promise((function(r,n){var o=Bs.apply(t,e);function i(t){Ms(o,r,n,i,a,"next",t)}function a(t){Ms(o,r,n,i,a,"throw",t)}i(void 0)}))},function(t){return Gs.apply(this,arguments)})});function zs(t){try{return Ts.evaluate(t).toString()}catch(t){return"I don't know how to do that."}}function $s(t){return $s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$s(t)}function qs(){qs=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new P(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function b(){}function g(){}var w={};c(w,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(w=_);var E=g.prototype=m.prototype=Object.create(w);function O(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,i,a,u){var s=f(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==$s(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=S(u,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?y:h,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=y,n.method="throw",n.arg=c.arg)}}}function S(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,S(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function C(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError($s(e)+" is not iterable")}return b.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=c(g,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,c(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},O(k.prototype),c(k.prototype,u,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(E),c(E,s,"Generator"),c(E,a,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=C,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),D(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;D(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:C(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function Ks(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}var Hs=new mn({name:"python",description:"descFunc4",schema:Ur.z.object({}),func:function(){var t=function(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Ks(i,n,o,a,u,"next",t)}function u(t){Ks(i,n,o,a,u,"throw",t)}a(void 0)}))}}(qs().mark((function t(){return qs().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return","");case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()});function Zs(t){return Zs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zs(t)}function Ys(){Ys=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new P(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function b(){}function g(){}var w={};c(w,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(w=_);var E=g.prototype=m.prototype=Object.create(w);function O(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,i,a,u){var s=f(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==Zs(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=S(u,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?y:h,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=y,n.method="throw",n.arg=c.arg)}}}function S(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,S(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function C(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(Zs(e)+" is not iterable")}return b.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=c(g,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,c(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},O(k.prototype),c(k.prototype,u,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(E),c(E,s,"Generator"),c(E,a,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=C,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),D(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;D(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:C(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function Vs(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}var Ws="convert-to-time",Js=new mn({name:Ws,description:"descFunc5",schema:Ur.z.object({datetimes:Ur.z.array(Ur.z.string().datetime()).describe("desc")}),func:function(){var t=function(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Vs(i,n,o,a,u,"next",t)}function u(t){Vs(i,n,o,a,u,"throw",t)}a(void 0)}))}}(Ys().mark((function t(e){var r,n,o;return Ys().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.datetimes,t.prev=1,o=null!==(n=Intl.DateTimeFormat().resolvedOptions().locale)&&void 0!==n?n:"en-US",t.abrupt("return",JSON.stringify(r.map((function(t){return new Date(t).toLocaleTimeString(o,{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0,hourCycle:"h11"})}))));case 6:return t.prev=6,t.t0=t.catch(1),t.abrupt("return","error: ".concat(t.t0.message));case 9:case"end":return t.stop()}}),t,null,[[1,6]])})));return function(e){return t.apply(this,arguments)}}()});function Xs(t){return Xs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xs(t)}function Qs(){Qs=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new P(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function b(){}function g(){}var w={};c(w,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(w=_);var E=g.prototype=m.prototype=Object.create(w);function O(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,i,a,u){var s=f(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==Xs(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=S(u,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?y:h,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=y,n.method="throw",n.arg=c.arg)}}}function S(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,S(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function C(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(Xs(e)+" is not iterable")}return b.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=c(g,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,c(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},O(k.prototype),c(k.prototype,u,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(E),c(E,s,"Generator"),c(E,a,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=C,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),D(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;D(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:C(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function tc(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function ec(t){return/^-?\d+\.\d$/.test(String(t))}const rc="RFC3986",nc={RFC1738:t=>String(t).replace(/%20/g,"+"),RFC3986:t=>String(t)},oc=(Object.prototype.hasOwnProperty,Array.isArray),ic=(()=>{const t=[];for(let e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t})(),ac=1024;function uc(t,e){if(oc(t)){const r=[];for(let n=0;n<t.length;n+=1)r.push(e(t[n]));return r}return e(t)}const sc=Object.prototype.hasOwnProperty,cc={brackets:t=>String(t)+"[]",comma:"comma",indices:(t,e)=>String(t)+"["+e+"]",repeat:t=>String(t)},lc=Array.isArray,fc=Array.prototype.push,pc=function(t,e){fc.apply(t,lc(e)?e:[e])},hc=Date.prototype.toISOString,dc={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:(t,e,r,n,o)=>{if(0===t.length)return t;let i=t;if("symbol"==typeof t?i=Symbol.prototype.toString.call(t):"string"!=typeof t&&(i=String(t)),"iso-8859-1"===r)return escape(i).replace(/%u[0-9a-f]{4}/gi,(function(t){return"%26%23"+parseInt(t.slice(2),16)+"%3B"}));let a="";for(let t=0;t<i.length;t+=ac){const e=i.length>=ac?i.slice(t,t+ac):i,r=[];for(let t=0;t<e.length;++t){let n=e.charCodeAt(t);45===n||46===n||95===n||126===n||n>=48&&n<=57||n>=65&&n<=90||n>=97&&n<=122||"RFC1738"===o&&(40===n||41===n)?r[r.length]=e.charAt(t):n<128?r[r.length]=ic[n]:n<2048?r[r.length]=ic[192|n>>6]+ic[128|63&n]:n<55296||n>=57344?r[r.length]=ic[224|n>>12]+ic[128|n>>6&63]+ic[128|63&n]:(t+=1,n=65536+((1023&n)<<10|1023&e.charCodeAt(t)),r[r.length]=ic[240|n>>18]+ic[128|n>>12&63]+ic[128|n>>6&63]+ic[128|63&n])}a+=r.join("")}return a},encodeValuesOnly:!1,format:rc,formatter:nc[rc],indices:!1,serializeDate:t=>hc.call(t),skipNulls:!1,strictNullHandling:!1},yc={};function vc(t,e,r,n,o,i,a,u,s,c,l,f,p,h,d,y,v,m){let b=t,g=m,w=0,x=!1;for(;void 0!==(g=g.get(yc))&&!x;){const e=g.get(t);if(w+=1,void 0!==e){if(e===w)throw new RangeError("Cyclic object value");x=!0}void 0===g.get(yc)&&(w=0)}if("function"==typeof c?b=c(e,b):b instanceof Date?b=p?.(b):"comma"===r&&lc(b)&&(b=uc(b,(function(t){return t instanceof Date?p?.(t):t}))),null===b){if(i)return s&&!y?s(e,dc.encoder,v,"key",h):e;b=""}if("string"==typeof(_=b)||"number"==typeof _||"boolean"==typeof _||"symbol"==typeof _||"bigint"==typeof _||function(t){return!(!t||"object"!=typeof t||!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t)))}(b)){if(s){const t=y?e:s(e,dc.encoder,v,"key",h);return[d?.(t)+"="+d?.(s(b,dc.encoder,v,"value",h))]}return[d?.(e)+"="+d?.(String(b))]}var _;const E=[];if(void 0===b)return E;let O;if("comma"===r&&lc(b))y&&s&&(b=uc(b,s)),O=[{value:b.length>0?b.join(",")||null:void 0}];else if(lc(c))O=c;else{const t=Object.keys(b);O=l?t.sort(l):t}const k=u?String(e).replace(/\./g,"%2E"):String(e),j=n&&lc(b)&&1===b.length?k+"[]":k;if(o&&lc(b)&&0===b.length)return j+"[]";for(let e=0;e<O.length;++e){const g=O[e],x="object"==typeof g&&void 0!==g.value?g.value:b[g];if(a&&null===x)continue;const _=f&&u?g.replace(/\./g,"%2E"):g,k=lc(b)?"function"==typeof r?r(j,_):j:j+(f?"."+_:"["+_+"]");m.set(t,w);const S=new WeakMap;S.set(yc,m),pc(E,vc(x,k,r,n,o,i,a,u,"comma"===r&&y&&lc(b)?null:s,c,l,f,p,h,d,y,v,S))}return E}const mc="4.73.0";let bc,gc,wc,xc,_c,Ec,Oc,kc,jc,Sc=!1,Ac=null,Dc=null,Pc=null,Cc=null;class Lc{constructor(t){this.body=t}get[Symbol.toStringTag](){return"MultipartBody"}}bc||function(t,e={auto:!1}){if(Sc)throw new Error(`you must \`import 'openai/shims/${t.kind}'\` before importing anything else from openai`);if(bc)throw new Error(`can't \`import 'openai/shims/${t.kind}'\` after \`import 'openai/shims/${bc}'\``);Sc=e.auto,bc=t.kind,gc=t.fetch,Ac=t.Request,Dc=t.Response,Pc=t.Headers,wc=t.FormData,Cc=t.Blob,xc=t.File,_c=t.ReadableStream,Ec=t.getMultipartRequestOptions,Oc=t.getDefaultAgent,kc=t.fileFromPath,jc=t.isFsReadStream}(function({manuallyImported:t}={}){const e=t?"You may need to use polyfills":"Add one of these imports before your first `import … from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let r,n,o,i;try{r=fetch,n=Request,o=Response,i=Headers}catch(t){throw new Error(`this environment is missing the following Web Fetch API type: ${t.message}. ${e}`)}return{kind:"web",fetch:r,Request:n,Response:o,Headers:i,FormData:"undefined"!=typeof FormData?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:"undefined"!=typeof Blob?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:"undefined"!=typeof File?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:"undefined"!=typeof ReadableStream?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(t,e)=>({...e,body:new Lc(t)}),getDefaultAgent:t=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:t=>!1}}(),{auto:!0});class Tc extends Error{}class Fc extends Tc{constructor(t,e,r,n){super(`${Fc.makeMessage(t,e,r)}`),this.status=t,this.headers=n,this.request_id=n?.["x-request-id"];const o=e;this.error=o,this.code=o?.code,this.param=o?.param,this.type=o?.type}static makeMessage(t,e,r){const n=e?.message?"string"==typeof e.message?e.message:JSON.stringify(e.message):e?JSON.stringify(e):r;return t&&n?`${t} ${n}`:t?`${t} status code (no body)`:n||"(no status code or body)"}static generate(t,e,r,n){if(!t)return new Nc({message:r,cause:Al(e)});const o=e?.error;return 400===t?new Mc(t,o,r,n):401===t?new Bc(t,o,r,n):403===t?new Gc(t,o,r,n):404===t?new Uc(t,o,r,n):409===t?new zc(t,o,r,n):422===t?new $c(t,o,r,n):429===t?new qc(t,o,r,n):t>=500?new Kc(t,o,r,n):new Fc(t,o,r,n)}}class Ic extends Fc{constructor({message:t}={}){super(void 0,void 0,t||"Request was aborted.",void 0),this.status=void 0}}class Nc extends Fc{constructor({message:t,cause:e}){super(void 0,void 0,t||"Connection error.",void 0),this.status=void 0,e&&(this.cause=e)}}class Rc extends Nc{constructor({message:t}={}){super({message:t??"Request timed out."})}}class Mc extends Fc{constructor(){super(...arguments),this.status=400}}class Bc extends Fc{constructor(){super(...arguments),this.status=401}}class Gc extends Fc{constructor(){super(...arguments),this.status=403}}class Uc extends Fc{constructor(){super(...arguments),this.status=404}}class zc extends Fc{constructor(){super(...arguments),this.status=409}}class $c extends Fc{constructor(){super(...arguments),this.status=422}}class qc extends Fc{constructor(){super(...arguments),this.status=429}}class Kc extends Fc{}class Hc extends Tc{constructor(){super("Could not parse response content as the length limit was reached")}}class Zc extends Tc{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}class Yc{constructor(){this.buffer=[],this.trailingCR=!1}decode(t){let e=this.decodeText(t);if(this.trailingCR&&(e="\r"+e,this.trailingCR=!1),e.endsWith("\r")&&(this.trailingCR=!0,e=e.slice(0,-1)),!e)return[];const r=Yc.NEWLINE_CHARS.has(e[e.length-1]||"");let n=e.split(Yc.NEWLINE_REGEXP);return r&&n.pop(),1!==n.length||r?(this.buffer.length>0&&(n=[this.buffer.join("")+n[0],...n.slice(1)],this.buffer=[]),r||(this.buffer=[n.pop()||""]),n):(this.buffer.push(n[0]),[])}decodeText(t){if(null==t)return"";if("string"==typeof t)return t;if("undefined"!=typeof Buffer){if(t instanceof Buffer)return t.toString();if(t instanceof Uint8Array)return Buffer.from(t).toString();throw new Tc(`Unexpected: received non-Uint8Array (${t.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if("undefined"!=typeof TextDecoder){if(t instanceof Uint8Array||t instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(t);throw new Tc(`Unexpected: received non-Uint8Array/ArrayBuffer (${t.constructor.name}) in a web platform. Please report this error.`)}throw new Tc("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const t=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,t}}Yc.NEWLINE_CHARS=new Set(["\n","\r"]),Yc.NEWLINE_REGEXP=/\r\n|[\n\r]/g;class Vc{constructor(t,e){this.iterator=t,this.controller=e}static fromSSEResponse(t,e){let r=!1;return new Vc((async function*(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let n=!1;try{for await(const r of async function*(t,e){if(!t.body)throw e.abort(),new Tc("Attempted to iterate over a response with no body");const r=new Jc,n=new Yc,o=Xc(t.body);for await(const t of async function*(t){let e=new Uint8Array;for await(const r of t){if(null==r)continue;const t=r instanceof ArrayBuffer?new Uint8Array(r):"string"==typeof r?(new TextEncoder).encode(r):r;let n,o=new Uint8Array(e.length+t.length);for(o.set(e),o.set(t,e.length),e=o;-1!==(n=Wc(e));)yield e.slice(0,n),e=e.slice(n)}e.length>0&&(yield e)}(o))for(const e of n.decode(t)){const t=r.decode(e);t&&(yield t)}for(const t of n.flush()){const e=r.decode(t);e&&(yield e)}}(t,e))if(!n)if(r.data.startsWith("[DONE]"))n=!0;else if(null===r.event){let t;try{t=JSON.parse(r.data)}catch(t){throw console.error("Could not parse message into JSON:",r.data),console.error("From chunk:",r.raw),t}if(t&&t.error)throw new Fc(void 0,t.error,void 0,void 0);yield t}else{let t;try{t=JSON.parse(r.data)}catch(t){throw console.error("Could not parse message into JSON:",r.data),console.error("From chunk:",r.raw),t}if("error"==r.event)throw new Fc(void 0,t.error,t.message,void 0);yield{event:r.event,data:t}}n=!0}catch(t){if(t instanceof Error&&"AbortError"===t.name)return;throw t}finally{n||e.abort()}}),e)}static fromReadableStream(t,e){let r=!1;return new Vc((async function*(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let n=!1;try{for await(const e of async function*(){const e=new Yc,r=Xc(t);for await(const t of r)for(const r of e.decode(t))yield r;for(const t of e.flush())yield t}())n||e&&(yield JSON.parse(e));n=!0}catch(t){if(t instanceof Error&&"AbortError"===t.name)return;throw t}finally{n||e.abort()}}),e)}[Symbol.asyncIterator](){return this.iterator()}tee(){const t=[],e=[],r=this.iterator(),n=n=>({next:()=>{if(0===n.length){const n=r.next();t.push(n),e.push(n)}return n.shift()}});return[new Vc((()=>n(t)),this.controller),new Vc((()=>n(e)),this.controller)]}toReadableStream(){const t=this;let e;const r=new TextEncoder;return new _c({async start(){e=t[Symbol.asyncIterator]()},async pull(t){try{const{value:n,done:o}=await e.next();if(o)return t.close();const i=r.encode(JSON.stringify(n)+"\n");t.enqueue(i)}catch(e){t.error(e)}},async cancel(){await(e.return?.())}})}}function Wc(t){for(let e=0;e<t.length-2;e++){if(10===t[e]&&10===t[e+1])return e+2;if(13===t[e]&&13===t[e+1])return e+2;if(13===t[e]&&10===t[e+1]&&e+3<t.length&&13===t[e+2]&&10===t[e+3])return e+4}return-1}class Jc{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(t){if(t.endsWith("\r")&&(t=t.substring(0,t.length-1)),!t){if(!this.event&&!this.data.length)return null;const t={event:this.event,data:this.data.join("\n"),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],t}if(this.chunks.push(t),t.startsWith(":"))return null;let[e,r,n]=function(t){const e=t.indexOf(":");return-1!==e?[t.substring(0,e),":",t.substring(e+1)]:[t,"",""]}(t);return n.startsWith(" ")&&(n=n.substring(1)),"event"===e?this.event=n:"data"===e&&this.data.push(n),null}}function Xc(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const t=await e.read();return t?.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}const Qc=t=>null!=t&&"object"==typeof t&&"string"==typeof t.url&&"function"==typeof t.blob,tl=t=>null!=t&&"object"==typeof t&&"string"==typeof t.name&&"number"==typeof t.lastModified&&el(t),el=t=>null!=t&&"object"==typeof t&&"number"==typeof t.size&&"string"==typeof t.type&&"function"==typeof t.text&&"function"==typeof t.slice&&"function"==typeof t.arrayBuffer;async function rl(t,e,r){if(t=await t,tl(t))return t;if(Qc(t)){const n=await t.blob();e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()??"unknown_file");const o=el(n)?[await n.arrayBuffer()]:[n];return new xc(o,e,r)}const n=await async function(t){let e=[];if("string"==typeof t||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)e.push(t);else if(el(t))e.push(await t.arrayBuffer());else{if(!ol(t))throw new Error(`Unexpected data type: ${typeof t}; constructor: ${t?.constructor?.name}; props: ${function(t){return`[${Object.getOwnPropertyNames(t).map((t=>`"${t}"`)).join(", ")}]`}(t)}`);for await(const r of t)e.push(r)}return e}(t);if(e||(e=function(t){return nl(t.name)||nl(t.filename)||nl(t.path)?.split(/[\\/]/).pop()}(t)??"unknown_file"),!r?.type){const t=n[0]?.type;"string"==typeof t&&(r={...r,type:t})}return new xc(n,e,r)}const nl=t=>"string"==typeof t?t:"undefined"!=typeof Buffer&&t instanceof Buffer?String(t):void 0,ol=t=>null!=t&&"object"==typeof t&&"function"==typeof t[Symbol.asyncIterator],il=t=>t&&"object"==typeof t&&t.body&&"MultipartBody"===t[Symbol.toStringTag],al=async t=>{const e=await ul(t.body);return Ec(e,t)},ul=async t=>{const e=new wc;return await Promise.all(Object.entries(t||{}).map((([t,r])=>sl(e,t,r)))),e},sl=async(t,e,r)=>{if(void 0!==r){if(null==r)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if("string"==typeof r||"number"==typeof r||"boolean"==typeof r)t.append(e,String(r));else if((t=>tl(t)||Qc(t)||jc(t))(r)){const n=await rl(r);t.append(e,n)}else if(Array.isArray(r))await Promise.all(r.map((r=>sl(t,e+"[]",r))));else{if("object"!=typeof r)throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${r} instead`);await Promise.all(Object.entries(r).map((([r,n])=>sl(t,`${e}[${r}]`,n))))}}};var cl;async function ll(t){const{response:e}=t;if(t.options.stream)return Tl("response",e.status,e.url,e.headers,e.body),t.options.__streamClass?t.options.__streamClass.fromSSEResponse(e,t.controller):Vc.fromSSEResponse(e,t.controller);if(204===e.status)return null;if(t.options.__binaryResponse)return e;const r=e.headers.get("content-type");if(r?.includes("application/json")||r?.includes("application/vnd.api+json")){const t=await e.json();return Tl("response",e.status,e.url,e.headers,t),fl(t,e)}const n=await e.text();return Tl("response",e.status,e.url,e.headers,n),n}function fl(t,e){return!t||"object"!=typeof t||Array.isArray(t)?t:Object.defineProperty(t,"_request_id",{value:e.headers.get("x-request-id"),enumerable:!1})}class pl extends Promise{constructor(t,e=ll){super((t=>{t(null)})),this.responsePromise=t,this.parseResponse=e}_thenUnwrap(t){return new pl(this.responsePromise,(async e=>fl(t(await this.parseResponse(e),e),e.response)))}asResponse(){return this.responsePromise.then((t=>t.response))}async withResponse(){const[t,e]=await Promise.all([this.parse(),this.asResponse()]);return{data:t,response:e,request_id:e.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(t,e){return this.parse().then(t,e)}catch(t){return this.parse().catch(t)}finally(t){return this.parse().finally(t)}}class hl{constructor({baseURL:t,maxRetries:e=2,timeout:r=6e5,httpAgent:n,fetch:o}){this.baseURL=t,this.maxRetries=Sl("maxRetries",e),this.timeout=Sl("timeout",r),this.httpAgent=n,this.fetch=o??gc}authHeaders(t){return{}}defaultHeaders(t){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),..._l(),...this.authHeaders(t)}}validateHeaders(t,e){}defaultIdempotencyKey(){return`stainless-node-retry-${Fl()}`}get(t,e){return this.methodRequest("get",t,e)}post(t,e){return this.methodRequest("post",t,e)}patch(t,e){return this.methodRequest("patch",t,e)}put(t,e){return this.methodRequest("put",t,e)}delete(t,e){return this.methodRequest("delete",t,e)}methodRequest(t,e,r){return this.request(Promise.resolve(r).then((async r=>{const n=r&&el(r?.body)?new DataView(await r.body.arrayBuffer()):r?.body instanceof DataView?r.body:r?.body instanceof ArrayBuffer?new DataView(r.body):r&&ArrayBuffer.isView(r?.body)?new DataView(r.body.buffer):r?.body;return{method:t,path:e,...r,body:n}})))}getAPIList(t,e,r){return this.requestAPIList(e,{method:"get",path:t,...r})}calculateContentLength(t){if("string"==typeof t){if("undefined"!=typeof Buffer)return Buffer.byteLength(t,"utf8").toString();if("undefined"!=typeof TextEncoder)return(new TextEncoder).encode(t).length.toString()}else if(ArrayBuffer.isView(t))return t.byteLength.toString();return null}buildRequest(t,{retryCount:e=0}={}){const{method:r,path:n,query:o,headers:i={}}=t,a=ArrayBuffer.isView(t.body)||t.__binaryRequest&&"string"==typeof t.body?t.body:il(t.body)?t.body.body:t.body?JSON.stringify(t.body,null,2):null,u=this.calculateContentLength(a),s=this.buildURL(n,o);"timeout"in t&&Sl("timeout",t.timeout);const c=t.timeout??this.timeout,l=t.httpAgent??this.httpAgent??Oc(s),f=c+1e3;return"number"==typeof l?.options?.timeout&&f>(l.options.timeout??0)&&(l.options.timeout=f),this.idempotencyHeader&&"get"!==r&&(t.idempotencyKey||(t.idempotencyKey=this.defaultIdempotencyKey()),i[this.idempotencyHeader]=t.idempotencyKey),{req:{method:r,...a&&{body:a},headers:this.buildHeaders({options:t,headers:i,contentLength:u,retryCount:e}),...l&&{agent:l},signal:t.signal??null},url:s,timeout:c}}buildHeaders({options:t,headers:e,contentLength:r,retryCount:n}){const o={};r&&(o["content-length"]=r);const i=this.defaultHeaders(t);return Ll(o,i),Ll(o,e),il(t.body)&&"node"!==bc&&delete o["content-type"],void 0===Il(i,"x-stainless-retry-count")&&void 0===Il(e,"x-stainless-retry-count")&&(o["x-stainless-retry-count"]=String(n)),this.validateHeaders(o,e),o}async prepareOptions(t){}async prepareRequest(t,{url:e,options:r}){}parseHeaders(t){return t?Symbol.iterator in t?Object.fromEntries(Array.from(t).map((t=>[...t]))):{...t}:{}}makeStatusError(t,e,r,n){return Fc.generate(t,e,r,n)}request(t,e=null){return new pl(this.makeRequest(t,e))}async makeRequest(t,e){const r=await t,n=r.maxRetries??this.maxRetries;null==e&&(e=n),await this.prepareOptions(r);const{req:o,url:i,timeout:a}=this.buildRequest(r,{retryCount:n-e});if(await this.prepareRequest(o,{url:i,options:r}),Tl("request",i,r,o.headers),r.signal?.aborted)throw new Ic;const u=new AbortController,s=await this.fetchWithTimeout(i,o,a,u).catch(Al);if(s instanceof Error){if(r.signal?.aborted)throw new Ic;if(e)return this.retryRequest(r,e);if("AbortError"===s.name)throw new Rc;throw new Nc({cause:s})}const c=vl(s.headers);if(!s.ok){if(e&&this.shouldRetry(s))return Tl(`response (error; retrying, ${e} attempts remaining)`,s.status,i,c),this.retryRequest(r,e,c);const t=await s.text().catch((t=>Al(t).message)),n=El(t),o=n?void 0:t;throw Tl(`response (error; ${e?"(error; no more retries left)":"(error; not retryable)"})`,s.status,i,c,o),this.makeStatusError(s.status,n,o,c)}return{response:s,options:r,controller:u}}requestAPIList(t,e){const r=this.makeRequest(e,null);return new yl(this,r,t)}buildURL(t,e){const r=kl(t)?new URL(t):new URL(this.baseURL+(this.baseURL.endsWith("/")&&t.startsWith("/")?t.slice(1):t)),n=this.defaultQuery();return Pl(n)||(e={...n,...e}),"object"==typeof e&&e&&!Array.isArray(e)&&(r.search=this.stringifyQuery(e)),r.toString()}stringifyQuery(t){return Object.entries(t).filter((([t,e])=>void 0!==e)).map((([t,e])=>{if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return`${encodeURIComponent(t)}=${encodeURIComponent(e)}`;if(null===e)return`${encodeURIComponent(t)}=`;throw new Tc(`Cannot stringify type ${typeof e}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)})).join("&")}async fetchWithTimeout(t,e,r,n){const{signal:o,...i}=e||{};o&&o.addEventListener("abort",(()=>n.abort()));const a=setTimeout((()=>n.abort()),r);return this.getRequestClient().fetch.call(void 0,t,{signal:n.signal,...i}).finally((()=>{clearTimeout(a)}))}getRequestClient(){return{fetch:this.fetch}}shouldRetry(t){const e=t.headers.get("x-should-retry");return"true"===e||"false"!==e&&(408===t.status||409===t.status||429===t.status||t.status>=500)}async retryRequest(t,e,r){let n;const o=r?.["retry-after-ms"];if(o){const t=parseFloat(o);Number.isNaN(t)||(n=t)}const i=r?.["retry-after"];if(i&&!n){const t=parseFloat(i);n=Number.isNaN(t)?Date.parse(i)-Date.now():1e3*t}if(!(n&&0<=n&&n<6e4)){const r=t.maxRetries??this.maxRetries;n=this.calculateDefaultRetryTimeoutMillis(e,r)}return await jl(n),this.makeRequest(t,e-1)}calculateDefaultRetryTimeoutMillis(t,e){const r=e-t;return Math.min(.5*Math.pow(2,r),8)*(1-.25*Math.random())*1e3}getUserAgent(){return`${this.constructor.name}/JS ${mc}`}}class dl{constructor(t,e,r,n){cl.set(this,void 0),function(t,e,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!o:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");"a"===n?o.call(t,r):o?o.value=r:e.set(t,r)}(this,cl,t,"f"),this.options=n,this.response=e,this.body=r}hasNextPage(){return!!this.getPaginatedItems().length&&null!=this.nextPageInfo()}async getNextPage(){const t=this.nextPageInfo();if(!t)throw new Tc("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const e={...this.options};if("params"in t&&"object"==typeof e.query)e.query={...e.query,...t.params};else if("url"in t){const r=[...Object.entries(e.query||{}),...t.url.searchParams.entries()];for(const[e,n]of r)t.url.searchParams.set(e,n);e.query=void 0,e.path=t.url.toString()}return await function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)}(this,cl,"f").requestAPIList(this.constructor,e)}async*iterPages(){let t=this;for(yield t;t.hasNextPage();)t=await t.getNextPage(),yield t}async*[(cl=new WeakMap,Symbol.asyncIterator)](){for await(const t of this.iterPages())for(const e of t.getPaginatedItems())yield e}}class yl extends pl{constructor(t,e,r){super(e,(async e=>new r(t,e.response,await ll(e),e.options)))}async*[Symbol.asyncIterator](){const t=await(this);for await(const e of t)yield e}}const vl=t=>new Proxy(Object.fromEntries(t.entries()),{get(t,e){const r=e.toString();return t[r.toLowerCase()]||t[r]}}),ml={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},bl=t=>"object"==typeof t&&null!==t&&!Pl(t)&&Object.keys(t).every((t=>Cl(ml,t))),gl=t=>"x32"===t?"x32":"x86_64"===t||"x64"===t?"x64":"arm"===t?"arm":"aarch64"===t||"arm64"===t?"arm64":t?`other:${t}`:"unknown",wl=t=>(t=t.toLowerCase()).includes("ios")?"iOS":"android"===t?"Android":"darwin"===t?"MacOS":"win32"===t?"Windows":"freebsd"===t?"FreeBSD":"openbsd"===t?"OpenBSD":"linux"===t?"Linux":t?`Other:${t}`:"Unknown";let xl;const _l=()=>xl??(xl=(()=>{if("undefined"!=typeof Deno&&null!=Deno.build)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":mc,"X-Stainless-OS":wl(Deno.build.os),"X-Stainless-Arch":gl(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":"string"==typeof Deno.version?Deno.version:Deno.version?.deno??"unknown"};if("undefined"!=typeof EdgeRuntime)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":mc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if("[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0))return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":mc,"X-Stainless-OS":wl(process.platform),"X-Stainless-Arch":gl(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const t=function(){if("undefined"==typeof navigator||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:r}of t){const t=r.exec(navigator.userAgent);if(t)return{browser:e,version:`${t[1]||0}.${t[2]||0}.${t[3]||0}`}}return null}();return t?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":mc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${t.browser}`,"X-Stainless-Runtime-Version":t.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":mc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}})()),El=t=>{try{return JSON.parse(t)}catch(t){return}},Ol=new RegExp("^(?:[a-z]+:)?//","i"),kl=t=>Ol.test(t),jl=t=>new Promise((e=>setTimeout(e,t))),Sl=(t,e)=>{if("number"!=typeof e||!Number.isInteger(e))throw new Tc(`${t} must be an integer`);if(e<0)throw new Tc(`${t} must be a positive integer`);return e},Al=t=>{if(t instanceof Error)return t;if("object"==typeof t&&null!==t)try{return new Error(JSON.stringify(t))}catch{}return new Error(t)},Dl=t=>"undefined"!=typeof process?process.env?.[t]?.trim()??void 0:"undefined"!=typeof Deno?Deno.env?.get?.(t)?.trim():void 0;function Pl(t){if(!t)return!0;for(const e in t)return!1;return!0}function Cl(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Ll(t,e){for(const r in e){if(!Cl(e,r))continue;const n=r.toLowerCase();if(!n)continue;const o=e[r];null===o?delete t[n]:void 0!==o&&(t[n]=o)}}function Tl(t,...e){"undefined"!=typeof process&&"true"===process?.env?.DEBUG&&console.log(`OpenAI:DEBUG:${t}`,...e)}const Fl=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})),Il=(t,e)=>{const r=e.toLowerCase();if((t=>"function"==typeof t?.get)(t)){const n=e[0]?.toUpperCase()+e.substring(1).replace(/([^\w])(\w)/g,((t,e,r)=>e+r.toUpperCase()));for(const o of[e,r,e.toUpperCase(),n]){const e=t.get(o);if(e)return e}}for(const[n,o]of Object.entries(t))if(n.toLowerCase()===r)return Array.isArray(o)?(o.length<=1||console.warn(`Received ${o.length} entries for the ${e} header, using the first entry.`),o[0]):o};function Nl(t){return null!=t&&"object"==typeof t&&!Array.isArray(t)}class Rl{constructor(t){this._client=t}}class Ml extends Rl{create(t,e){return this._client.post("/completions",{body:t,...e,stream:t.stream??!1})}}class Bl extends Rl{create(t,e){return this._client.post("/chat/completions",{body:t,...e,stream:t.stream??!1})}}class Gl extends Rl{constructor(){super(...arguments),this.completions=new Bl(this._client)}}Gl.Completions=Bl;class Ul extends Rl{create(t,e){return this._client.post("/embeddings",{body:t,...e})}}class zl extends dl{constructor(t,e,r,n){super(t,e,r,n),this.data=r.data||[],this.object=r.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class $l extends dl{constructor(t,e,r,n){super(t,e,r,n),this.data=r.data||[]}getPaginatedItems(){return this.data??[]}nextPageParams(){const t=this.nextPageInfo();if(!t)return null;if("params"in t)return t.params;const e=Object.fromEntries(t.url.searchParams);return Object.keys(e).length?e:null}nextPageInfo(){const t=this.getPaginatedItems();if(!t.length)return null;const e=t[t.length-1]?.id;return e?{params:{after:e}}:null}}class ql extends Rl{create(t,e){return this._client.post("/files",al({body:t,...e}))}retrieve(t,e){return this._client.get(`/files/${t}`,e)}list(t={},e){return bl(t)?this.list({},t):this._client.getAPIList("/files",Kl,{query:t,...e})}del(t,e){return this._client.delete(`/files/${t}`,e)}content(t,e){return this._client.get(`/files/${t}/content`,{...e,__binaryResponse:!0})}retrieveContent(t,e){return this._client.get(`/files/${t}/content`,{...e,headers:{Accept:"application/json",...e?.headers}})}async waitForProcessing(t,{pollInterval:e=5e3,maxWait:r=18e5}={}){const n=new Set(["processed","error","deleted"]),o=Date.now();let i=await this.retrieve(t);for(;!i.status||!n.has(i.status);)if(await jl(e),i=await this.retrieve(t),Date.now()-o>r)throw new Rc({message:`Giving up on waiting for file ${t} to finish processing after ${r} milliseconds.`});return i}}class Kl extends $l{}ql.FileObjectsPage=Kl;class Hl extends Rl{createVariation(t,e){return this._client.post("/images/variations",al({body:t,...e}))}edit(t,e){return this._client.post("/images/edits",al({body:t,...e}))}generate(t,e){return this._client.post("/images/generations",{body:t,...e})}}class Zl extends Rl{create(t,e){return this._client.post("/audio/speech",{body:t,...e,__binaryResponse:!0})}}class Yl extends Rl{create(t,e){return this._client.post("/audio/transcriptions",al({body:t,...e}))}}class Vl extends Rl{create(t,e){return this._client.post("/audio/translations",al({body:t,...e}))}}class Wl extends Rl{constructor(){super(...arguments),this.transcriptions=new Yl(this._client),this.translations=new Vl(this._client),this.speech=new Zl(this._client)}}Wl.Transcriptions=Yl,Wl.Translations=Vl,Wl.Speech=Zl;class Jl extends Rl{create(t,e){return this._client.post("/moderations",{body:t,...e})}}class Xl extends Rl{retrieve(t,e){return this._client.get(`/models/${t}`,e)}list(t){return this._client.getAPIList("/models",Ql,t)}del(t,e){return this._client.delete(`/models/${t}`,e)}}class Ql extends zl{}Xl.ModelsPage=Ql;class tf extends Rl{list(t,e={},r){return bl(e)?this.list(t,{},e):this._client.getAPIList(`/fine_tuning/jobs/${t}/checkpoints`,ef,{query:e,...r})}}class ef extends $l{}tf.FineTuningJobCheckpointsPage=ef;class rf extends Rl{constructor(){super(...arguments),this.checkpoints=new tf(this._client)}create(t,e){return this._client.post("/fine_tuning/jobs",{body:t,...e})}retrieve(t,e){return this._client.get(`/fine_tuning/jobs/${t}`,e)}list(t={},e){return bl(t)?this.list({},t):this._client.getAPIList("/fine_tuning/jobs",nf,{query:t,...e})}cancel(t,e){return this._client.post(`/fine_tuning/jobs/${t}/cancel`,e)}listEvents(t,e={},r){return bl(e)?this.listEvents(t,{},e):this._client.getAPIList(`/fine_tuning/jobs/${t}/events`,of,{query:e,...r})}}class nf extends $l{}class of extends $l{}rf.FineTuningJobsPage=nf,rf.FineTuningJobEventsPage=of,rf.Checkpoints=tf,rf.FineTuningJobCheckpointsPage=ef;class af extends Rl{constructor(){super(...arguments),this.jobs=new rf(this._client)}}af.Jobs=rf,af.FineTuningJobsPage=nf,af.FineTuningJobEventsPage=of;class uf extends Rl{create(t,e){return this._client.post("/assistants",{body:t,...e,headers:{"OpenAI-Beta":"assistants=v2",...e?.headers}})}retrieve(t,e){return this._client.get(`/assistants/${t}`,{...e,headers:{"OpenAI-Beta":"assistants=v2",...e?.headers}})}update(t,e,r){return this._client.post(`/assistants/${t}`,{body:e,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}list(t={},e){return bl(t)?this.list({},t):this._client.getAPIList("/assistants",sf,{query:t,...e,headers:{"OpenAI-Beta":"assistants=v2",...e?.headers}})}del(t,e){return this._client.delete(`/assistants/${t}`,{...e,headers:{"OpenAI-Beta":"assistants=v2",...e?.headers}})}}class sf extends $l{}function cf(t){return"function"==typeof t.parse}uf.AssistantsPage=sf;const lf=t=>"assistant"===t?.role,ff=t=>"function"===t?.role,pf=t=>"tool"===t?.role;var hf,df,yf,vf,mf,bf,gf,wf,xf,_f,Ef,Of,kf,jf=function(t,e,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!o:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(t,r):o?o.value=r:e.set(t,r),r},Sf=function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)};class Af{constructor(){hf.add(this),this.controller=new AbortController,df.set(this,void 0),yf.set(this,(()=>{})),vf.set(this,(()=>{})),mf.set(this,void 0),bf.set(this,(()=>{})),gf.set(this,(()=>{})),wf.set(this,{}),xf.set(this,!1),_f.set(this,!1),Ef.set(this,!1),Of.set(this,!1),jf(this,df,new Promise(((t,e)=>{jf(this,yf,t,"f"),jf(this,vf,e,"f")})),"f"),jf(this,mf,new Promise(((t,e)=>{jf(this,bf,t,"f"),jf(this,gf,e,"f")})),"f"),Sf(this,df,"f").catch((()=>{})),Sf(this,mf,"f").catch((()=>{}))}_run(t){setTimeout((()=>{t().then((()=>{this._emitFinal(),this._emit("end")}),Sf(this,hf,"m",kf).bind(this))}),0)}_connected(){this.ended||(Sf(this,yf,"f").call(this),this._emit("connect"))}get ended(){return Sf(this,xf,"f")}get errored(){return Sf(this,_f,"f")}get aborted(){return Sf(this,Ef,"f")}abort(){this.controller.abort()}on(t,e){return(Sf(this,wf,"f")[t]||(Sf(this,wf,"f")[t]=[])).push({listener:e}),this}off(t,e){const r=Sf(this,wf,"f")[t];if(!r)return this;const n=r.findIndex((t=>t.listener===e));return n>=0&&r.splice(n,1),this}once(t,e){return(Sf(this,wf,"f")[t]||(Sf(this,wf,"f")[t]=[])).push({listener:e,once:!0}),this}emitted(t){return new Promise(((e,r)=>{jf(this,Of,!0,"f"),"error"!==t&&this.once("error",r),this.once(t,e)}))}async done(){jf(this,Of,!0,"f"),await Sf(this,mf,"f")}_emit(t,...e){if(Sf(this,xf,"f"))return;"end"===t&&(jf(this,xf,!0,"f"),Sf(this,bf,"f").call(this));const r=Sf(this,wf,"f")[t];if(r&&(Sf(this,wf,"f")[t]=r.filter((t=>!t.once)),r.forEach((({listener:t})=>t(...e)))),"abort"===t){const t=e[0];return Sf(this,Of,"f")||r?.length||Promise.reject(t),Sf(this,vf,"f").call(this,t),Sf(this,gf,"f").call(this,t),void this._emit("end")}if("error"===t){const t=e[0];Sf(this,Of,"f")||r?.length||Promise.reject(t),Sf(this,vf,"f").call(this,t),Sf(this,gf,"f").call(this,t),this._emit("end")}}_emitFinal(){}}function Df(t){return"auto-parseable-response-format"===t?.$brand}function Pf(t){return"auto-parseable-tool"===t?.$brand}function Cf(t,e){const r=t.choices.map((t=>{if("length"===t.finish_reason)throw new Hc;if("content_filter"===t.finish_reason)throw new Zc;return{...t,message:{...t.message,tool_calls:t.message.tool_calls?.map((t=>function(t,e){const r=t.tools?.find((t=>t.function?.name===e.function.name));return{...e,function:{...e.function,parsed_arguments:Pf(r)?r.$parseRaw(e.function.arguments):r?.function.strict?JSON.parse(e.function.arguments):null}}}(e,t)))??[],parsed:t.message.content&&!t.message.refusal?Lf(e,t.message.content):null}}}));return{...t,choices:r}}function Lf(t,e){return"json_schema"!==t.response_format?.type?null:"json_schema"===t.response_format?.type?"$parseRaw"in t.response_format?t.response_format.$parseRaw(e):JSON.parse(e):null}function Tf(t,e){if(!t)return!1;const r=t.tools?.find((t=>t.function?.name===e.function.name));return Pf(r)||r?.function.strict||!1}function Ff(t){return!!Df(t.response_format)||(t.tools?.some((t=>Pf(t)||"function"===t.type&&!0===t.function.strict))??!1)}df=new WeakMap,yf=new WeakMap,vf=new WeakMap,mf=new WeakMap,bf=new WeakMap,gf=new WeakMap,wf=new WeakMap,xf=new WeakMap,_f=new WeakMap,Ef=new WeakMap,Of=new WeakMap,hf=new WeakSet,kf=function(t){if(jf(this,_f,!0,"f"),t instanceof Error&&"AbortError"===t.name&&(t=new Ic),t instanceof Ic)return jf(this,Ef,!0,"f"),this._emit("abort",t);if(t instanceof Tc)return this._emit("error",t);if(t instanceof Error){const e=new Tc(t.message);return e.cause=t,this._emit("error",e)}return this._emit("error",new Tc(String(t)))};var If,Nf,Rf,Mf,Bf,Gf,Uf,zf,$f=function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)};const qf=10;class Kf extends Af{constructor(){super(...arguments),If.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(t){this._chatCompletions.push(t),this._emit("chatCompletion",t);const e=t.choices[0]?.message;return e&&this._addMessage(e),t}_addMessage(t,e=!0){if("content"in t||(t.content=null),this.messages.push(t),e)if(this._emit("message",t),(ff(t)||pf(t))&&t.content)this._emit("functionCallResult",t.content);else if(lf(t)&&t.function_call)this._emit("functionCall",t.function_call);else if(lf(t)&&t.tool_calls)for(const e of t.tool_calls)"function"===e.type&&this._emit("functionCall",e.function)}async finalChatCompletion(){await this.done();const t=this._chatCompletions[this._chatCompletions.length-1];if(!t)throw new Tc("stream ended without producing a ChatCompletion");return t}async finalContent(){return await this.done(),$f(this,If,"m",Nf).call(this)}async finalMessage(){return await this.done(),$f(this,If,"m",Rf).call(this)}async finalFunctionCall(){return await this.done(),$f(this,If,"m",Mf).call(this)}async finalFunctionCallResult(){return await this.done(),$f(this,If,"m",Bf).call(this)}async totalUsage(){return await this.done(),$f(this,If,"m",Gf).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const t=this._chatCompletions[this._chatCompletions.length-1];t&&this._emit("finalChatCompletion",t);const e=$f(this,If,"m",Rf).call(this);e&&this._emit("finalMessage",e);const r=$f(this,If,"m",Nf).call(this);r&&this._emit("finalContent",r);const n=$f(this,If,"m",Mf).call(this);n&&this._emit("finalFunctionCall",n);const o=$f(this,If,"m",Bf).call(this);null!=o&&this._emit("finalFunctionCallResult",o),this._chatCompletions.some((t=>t.usage))&&this._emit("totalUsage",$f(this,If,"m",Gf).call(this))}async _createChatCompletion(t,e,r){const n=r?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",(()=>this.controller.abort()))),$f(this,If,"m",Uf).call(this,e);const o=await t.chat.completions.create({...e,stream:!1},{...r,signal:this.controller.signal});return this._connected(),this._addChatCompletion(Cf(o,e))}async _runChatCompletion(t,e,r){for(const t of e.messages)this._addMessage(t,!1);return await this._createChatCompletion(t,e,r)}async _runFunctions(t,e,r){const n="function",{function_call:o="auto",stream:i,...a}=e,u="string"!=typeof o&&o?.name,{maxChatCompletions:s=qf}=r||{},c={};for(const t of e.functions)c[t.name||t.function.name]=t;const l=e.functions.map((t=>({name:t.name||t.function.name,parameters:t.parameters,description:t.description})));for(const t of e.messages)this._addMessage(t,!1);for(let e=0;e<s;++e){const e=await this._createChatCompletion(t,{...a,function_call:o,functions:l,messages:[...this.messages]},r),i=e.choices[0]?.message;if(!i)throw new Tc("missing message in ChatCompletion response");if(!i.function_call)return;const{name:s,arguments:f}=i.function_call,p=c[s];if(!p){const t=`Invalid function_call: ${JSON.stringify(s)}. Available options are: ${l.map((t=>JSON.stringify(t.name))).join(", ")}. Please try again`;this._addMessage({role:n,name:s,content:t});continue}if(u&&u!==s){const t=`Invalid function_call: ${JSON.stringify(s)}. ${JSON.stringify(u)} requested. Please try again`;this._addMessage({role:n,name:s,content:t});continue}let h;try{h=cf(p)?await p.parse(f):f}catch(t){this._addMessage({role:n,name:s,content:t instanceof Error?t.message:String(t)});continue}const d=await p.function(h,this),y=$f(this,If,"m",zf).call(this,d);if(this._addMessage({role:n,name:s,content:y}),u)return}}async _runTools(t,e,r){const n="tool",{tool_choice:o="auto",stream:i,...a}=e,u="string"!=typeof o&&o?.function?.name,{maxChatCompletions:s=qf}=r||{},c=e.tools.map((t=>{if(Pf(t)){if(!t.$callback)throw new Tc("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:t.$callback,name:t.function.name,description:t.function.description||"",parameters:t.function.parameters,parse:t.$parseRaw,strict:!0}}}return t})),l={};for(const t of c)"function"===t.type&&(l[t.function.name||t.function.function.name]=t.function);const f="tools"in e?c.map((t=>"function"===t.type?{type:"function",function:{name:t.function.name||t.function.function.name,parameters:t.function.parameters,description:t.function.description,strict:t.function.strict}}:t)):void 0;for(const t of e.messages)this._addMessage(t,!1);for(let e=0;e<s;++e){const e=await this._createChatCompletion(t,{...a,tool_choice:o,tools:f,messages:[...this.messages]},r),i=e.choices[0]?.message;if(!i)throw new Tc("missing message in ChatCompletion response");if(!i.tool_calls?.length)return;for(const t of i.tool_calls){if("function"!==t.type)continue;const e=t.id,{name:r,arguments:o}=t.function,i=l[r];if(!i){const t=`Invalid tool_call: ${JSON.stringify(r)}. Available options are: ${Object.keys(l).map((t=>JSON.stringify(t))).join(", ")}. Please try again`;this._addMessage({role:n,tool_call_id:e,content:t});continue}if(u&&u!==r){const t=`Invalid tool_call: ${JSON.stringify(r)}. ${JSON.stringify(u)} requested. Please try again`;this._addMessage({role:n,tool_call_id:e,content:t});continue}let a;try{a=cf(i)?await i.parse(o):o}catch(t){const r=t instanceof Error?t.message:String(t);this._addMessage({role:n,tool_call_id:e,content:r});continue}const s=await i.function(a,this),c=$f(this,If,"m",zf).call(this,s);if(this._addMessage({role:n,tool_call_id:e,content:c}),u)return}}}}If=new WeakSet,Nf=function(){return $f(this,If,"m",Rf).call(this).content??null},Rf=function(){let t=this.messages.length;for(;t-- >0;){const e=this.messages[t];if(lf(e)){const{function_call:t,...r}=e,n={...r,content:e.content??null,refusal:e.refusal??null};return t&&(n.function_call=t),n}}throw new Tc("stream ended without producing a ChatCompletionMessage with role=assistant")},Mf=function(){for(let t=this.messages.length-1;t>=0;t--){const e=this.messages[t];if(lf(e)&&e?.function_call)return e.function_call;if(lf(e)&&e?.tool_calls?.length)return e.tool_calls.at(-1)?.function}},Bf=function(){for(let t=this.messages.length-1;t>=0;t--){const e=this.messages[t];if(ff(e)&&null!=e.content)return e.content;if(pf(e)&&null!=e.content&&"string"==typeof e.content&&this.messages.some((t=>"assistant"===t.role&&t.tool_calls?.some((t=>"function"===t.type&&t.id===e.tool_call_id)))))return e.content}},Gf=function(){const t={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:e}of this._chatCompletions)e&&(t.completion_tokens+=e.completion_tokens,t.prompt_tokens+=e.prompt_tokens,t.total_tokens+=e.total_tokens);return t},Uf=function(t){if(null!=t.n&&t.n>1)throw new Tc("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},zf=function(t){return"string"==typeof t?t:void 0===t?"undefined":JSON.stringify(t)};class Hf extends Kf{static runFunctions(t,e,r){const n=new Hf,o={...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"runFunctions"}};return n._run((()=>n._runFunctions(t,e,o))),n}static runTools(t,e,r){const n=new Hf,o={...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"runTools"}};return n._run((()=>n._runTools(t,e,o))),n}_addMessage(t,e=!0){super._addMessage(t,e),lf(t)&&t.content&&this._emit("content",t.content)}}class Zf extends Error{}class Yf extends Error{}const Vf=t=>function(t,e=511){if("string"!=typeof t)throw new TypeError("expecting str, got "+typeof t);if(!t.trim())throw new Error(`${t} is empty`);return((t,e)=>{const r=t.length;let n=0;const o=t=>{throw new Zf(`${t} at position ${n}`)},i=t=>{throw new Yf(`${t} at position ${n}`)},a=()=>(f(),n>=r&&o("Unexpected end of input"),'"'===t[n]?u():"{"===t[n]?s():"["===t[n]?c():"null"===t.substring(n,n+4)||16&e&&r-n<4&&"null".startsWith(t.substring(n))?(n+=4,null):"true"===t.substring(n,n+4)||32&e&&r-n<4&&"true".startsWith(t.substring(n))?(n+=4,!0):"false"===t.substring(n,n+5)||32&e&&r-n<5&&"false".startsWith(t.substring(n))?(n+=5,!1):"Infinity"===t.substring(n,n+8)||128&e&&r-n<8&&"Infinity".startsWith(t.substring(n))?(n+=8,1/0):"-Infinity"===t.substring(n,n+9)||256&e&&1<r-n&&r-n<9&&"-Infinity".startsWith(t.substring(n))?(n+=9,-1/0):"NaN"===t.substring(n,n+3)||64&e&&r-n<3&&"NaN".startsWith(t.substring(n))?(n+=3,NaN):l()),u=()=>{const a=n;let u=!1;for(n++;n<r&&('"'!==t[n]||u&&"\\"===t[n-1]);)u="\\"===t[n]&&!u,n++;if('"'==t.charAt(n))try{return JSON.parse(t.substring(a,++n-Number(u)))}catch(t){i(String(t))}else if(1&e)try{return JSON.parse(t.substring(a,n-Number(u))+'"')}catch(e){return JSON.parse(t.substring(a,t.lastIndexOf("\\"))+'"')}o("Unterminated string literal")},s=()=>{n++,f();const i={};try{for(;"}"!==t[n];){if(f(),n>=r&&8&e)return i;const o=u();f(),n++;try{const t=a();Object.defineProperty(i,o,{value:t,writable:!0,enumerable:!0,configurable:!0})}catch(t){if(8&e)return i;throw t}f(),","===t[n]&&n++}}catch(t){if(8&e)return i;o("Expected '}' at end of object")}return n++,i},c=()=>{n++;const r=[];try{for(;"]"!==t[n];)r.push(a()),f(),","===t[n]&&n++}catch(t){if(4&e)return r;o("Expected ']' at end of array")}return n++,r},l=()=>{if(0===n){"-"===t&&2&e&&o("Not sure what '-' is");try{return JSON.parse(t)}catch(r){if(2&e)try{return"."===t[t.length-1]?JSON.parse(t.substring(0,t.lastIndexOf("."))):JSON.parse(t.substring(0,t.lastIndexOf("e")))}catch(t){}i(String(r))}}const a=n;for("-"===t[n]&&n++;t[n]&&!",]}".includes(t[n]);)n++;n!=r||2&e||o("Unterminated number literal");try{return JSON.parse(t.substring(a,n))}catch(r){"-"===t.substring(a,n)&&2&e&&o("Not sure what '-' is");try{return JSON.parse(t.substring(a,t.lastIndexOf("e")))}catch(t){i(String(t))}}},f=()=>{for(;n<r&&" \n\r\t".includes(t[n]);)n++};return a()})(t.trim(),e)}(t,509);var Wf,Jf,Xf,Qf,tp,ep,rp,np,op,ip,ap,up,sp=function(t,e,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!o:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(t,r):o?o.value=r:e.set(t,r),r},cp=function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)};class lp extends Kf{constructor(t){super(),Wf.add(this),Jf.set(this,void 0),Xf.set(this,void 0),Qf.set(this,void 0),sp(this,Jf,t,"f"),sp(this,Xf,[],"f")}get currentChatCompletionSnapshot(){return cp(this,Qf,"f")}static fromReadableStream(t){const e=new lp(null);return e._run((()=>e._fromReadableStream(t))),e}static createChatCompletion(t,e,r){const n=new lp(e);return n._run((()=>n._runChatCompletion(t,{...e,stream:!0},{...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"stream"}}))),n}async _createChatCompletion(t,e,r){super._createChatCompletion;const n=r?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",(()=>this.controller.abort()))),cp(this,Wf,"m",tp).call(this);const o=await t.chat.completions.create({...e,stream:!0},{...r,signal:this.controller.signal});this._connected();for await(const t of o)cp(this,Wf,"m",rp).call(this,t);if(o.controller.signal?.aborted)throw new Ic;return this._addChatCompletion(cp(this,Wf,"m",ip).call(this))}async _fromReadableStream(t,e){const r=e?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",(()=>this.controller.abort()))),cp(this,Wf,"m",tp).call(this),this._connected();const n=Vc.fromReadableStream(t,this.controller);let o;for await(const t of n)o&&o!==t.id&&this._addChatCompletion(cp(this,Wf,"m",ip).call(this)),cp(this,Wf,"m",rp).call(this,t),o=t.id;if(n.controller.signal?.aborted)throw new Ic;return this._addChatCompletion(cp(this,Wf,"m",ip).call(this))}[(Jf=new WeakMap,Xf=new WeakMap,Qf=new WeakMap,Wf=new WeakSet,tp=function(){this.ended||sp(this,Qf,void 0,"f")},ep=function(t){let e=cp(this,Xf,"f")[t.index];return e||(e={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},cp(this,Xf,"f")[t.index]=e,e)},rp=function(t){if(this.ended)return;const e=cp(this,Wf,"m",up).call(this,t);this._emit("chunk",t,e);for(const r of t.choices){const t=e.choices[r.index];null!=r.delta.content&&"assistant"===t.message?.role&&t.message?.content&&(this._emit("content",r.delta.content,t.message.content),this._emit("content.delta",{delta:r.delta.content,snapshot:t.message.content,parsed:t.message.parsed})),null!=r.delta.refusal&&"assistant"===t.message?.role&&t.message?.refusal&&this._emit("refusal.delta",{delta:r.delta.refusal,snapshot:t.message.refusal}),null!=r.logprobs?.content&&"assistant"===t.message?.role&&this._emit("logprobs.content.delta",{content:r.logprobs?.content,snapshot:t.logprobs?.content??[]}),null!=r.logprobs?.refusal&&"assistant"===t.message?.role&&this._emit("logprobs.refusal.delta",{refusal:r.logprobs?.refusal,snapshot:t.logprobs?.refusal??[]});const n=cp(this,Wf,"m",ep).call(this,t);t.finish_reason&&(cp(this,Wf,"m",op).call(this,t),null!=n.current_tool_call_index&&cp(this,Wf,"m",np).call(this,t,n.current_tool_call_index));for(const e of r.delta.tool_calls??[])n.current_tool_call_index!==e.index&&(cp(this,Wf,"m",op).call(this,t),null!=n.current_tool_call_index&&cp(this,Wf,"m",np).call(this,t,n.current_tool_call_index)),n.current_tool_call_index=e.index;for(const e of r.delta.tool_calls??[]){const r=t.message.tool_calls?.[e.index];r?.type&&"function"===r?.type&&this._emit("tool_calls.function.arguments.delta",{name:r.function?.name,index:e.index,arguments:r.function.arguments,parsed_arguments:r.function.parsed_arguments,arguments_delta:e.function?.arguments??""})}}},np=function(t,e){if(cp(this,Wf,"m",ep).call(this,t).done_tool_calls.has(e))return;const r=t.message.tool_calls?.[e];if(!r)throw new Error("no tool call snapshot");if(!r.type)throw new Error("tool call snapshot missing `type`");if("function"===r.type){const t=cp(this,Jf,"f")?.tools?.find((t=>"function"===t.type&&t.function.name===r.function.name));this._emit("tool_calls.function.arguments.done",{name:r.function.name,index:e,arguments:r.function.arguments,parsed_arguments:Pf(t)?t.$parseRaw(r.function.arguments):t?.function.strict?JSON.parse(r.function.arguments):null})}else r.type},op=function(t){const e=cp(this,Wf,"m",ep).call(this,t);if(t.message.content&&!e.content_done){e.content_done=!0;const r=cp(this,Wf,"m",ap).call(this);this._emit("content.done",{content:t.message.content,parsed:r?r.$parseRaw(t.message.content):null})}t.message.refusal&&!e.refusal_done&&(e.refusal_done=!0,this._emit("refusal.done",{refusal:t.message.refusal})),t.logprobs?.content&&!e.logprobs_content_done&&(e.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:t.logprobs.content})),t.logprobs?.refusal&&!e.logprobs_refusal_done&&(e.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:t.logprobs.refusal}))},ip=function(){if(this.ended)throw new Tc("stream has ended, this shouldn't happen");const t=cp(this,Qf,"f");if(!t)throw new Tc("request ended without sending any chunks");return sp(this,Qf,void 0,"f"),sp(this,Xf,[],"f"),function(t,e){const{id:r,choices:n,created:o,model:i,system_fingerprint:a,...u}=t,s={...u,id:r,choices:n.map((({message:e,finish_reason:r,index:n,logprobs:o,...i})=>{if(!r)throw new Tc(`missing finish_reason for choice ${n}`);const{content:a=null,function_call:u,tool_calls:s,...c}=e,l=e.role;if(!l)throw new Tc(`missing role for choice ${n}`);if(u){const{arguments:t,name:s}=u;if(null==t)throw new Tc(`missing function_call.arguments for choice ${n}`);if(!s)throw new Tc(`missing function_call.name for choice ${n}`);return{...i,message:{content:a,function_call:{arguments:t,name:s},role:l,refusal:e.refusal??null},finish_reason:r,index:n,logprobs:o}}return s?{...i,index:n,finish_reason:r,logprobs:o,message:{...c,role:l,content:a,refusal:e.refusal??null,tool_calls:s.map(((e,r)=>{const{function:o,type:i,id:a,...u}=e,{arguments:s,name:c,...l}=o||{};if(null==a)throw new Tc(`missing choices[${n}].tool_calls[${r}].id\n${fp(t)}`);if(null==i)throw new Tc(`missing choices[${n}].tool_calls[${r}].type\n${fp(t)}`);if(null==c)throw new Tc(`missing choices[${n}].tool_calls[${r}].function.name\n${fp(t)}`);if(null==s)throw new Tc(`missing choices[${n}].tool_calls[${r}].function.arguments\n${fp(t)}`);return{...u,id:a,type:i,function:{...l,name:c,arguments:s}}}))}}:{...i,message:{...c,content:a,role:l,refusal:e.refusal??null},finish_reason:r,index:n,logprobs:o}})),created:o,model:i,object:"chat.completion",...a?{system_fingerprint:a}:{}};return function(t,e){return e&&Ff(e)?Cf(t,e):{...t,choices:t.choices.map((t=>({...t,message:{...t.message,parsed:null,tool_calls:t.message.tool_calls??[]}})))}}(s,e)}(t,cp(this,Jf,"f"))},ap=function(){const t=cp(this,Jf,"f")?.response_format;return Df(t)?t:null},up=function(t){var e,r,n,o;let i=cp(this,Qf,"f");const{choices:a,...u}=t;i?Object.assign(i,u):i=sp(this,Qf,{...u,choices:[]},"f");for(const{delta:a,finish_reason:u,index:s,logprobs:c=null,...l}of t.choices){let t=i.choices[s];if(t||(t=i.choices[s]={finish_reason:u,index:s,message:{},logprobs:c,...l}),c)if(t.logprobs){const{content:n,refusal:o,...i}=c;Object.assign(t.logprobs,i),n&&((e=t.logprobs).content??(e.content=[]),t.logprobs.content.push(...n)),o&&((r=t.logprobs).refusal??(r.refusal=[]),t.logprobs.refusal.push(...o))}else t.logprobs=Object.assign({},c);if(u&&(t.finish_reason=u,cp(this,Jf,"f")&&Ff(cp(this,Jf,"f")))){if("length"===u)throw new Hc;if("content_filter"===u)throw new Zc}if(Object.assign(t,l),!a)continue;const{content:f,refusal:p,function_call:h,role:d,tool_calls:y,...v}=a;if(Object.assign(t.message,v),p&&(t.message.refusal=(t.message.refusal||"")+p),d&&(t.message.role=d),h&&(t.message.function_call?(h.name&&(t.message.function_call.name=h.name),h.arguments&&((n=t.message.function_call).arguments??(n.arguments=""),t.message.function_call.arguments+=h.arguments)):t.message.function_call=h),f&&(t.message.content=(t.message.content||"")+f,!t.message.refusal&&cp(this,Wf,"m",ap).call(this)&&(t.message.parsed=Vf(t.message.content))),y){t.message.tool_calls||(t.message.tool_calls=[]);for(const{index:e,id:r,type:n,function:i,...a}of y){const u=(o=t.message.tool_calls)[e]??(o[e]={});Object.assign(u,a),r&&(u.id=r),n&&(u.type=n),i&&(u.function??(u.function={name:i.name??"",arguments:""})),i?.name&&(u.function.name=i.name),i?.arguments&&(u.function.arguments+=i.arguments,Tf(cp(this,Jf,"f"),u)&&(u.function.parsed_arguments=Vf(u.function.arguments)))}}}return i},Symbol.asyncIterator)](){const t=[],e=[];let r=!1;return this.on("chunk",(r=>{const n=e.shift();n?n.resolve(r):t.push(r)})),this.on("end",(()=>{r=!0;for(const t of e)t.resolve(void 0);e.length=0})),this.on("abort",(t=>{r=!0;for(const r of e)r.reject(t);e.length=0})),this.on("error",(t=>{r=!0;for(const r of e)r.reject(t);e.length=0})),{next:async()=>t.length?{value:t.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise(((t,r)=>e.push({resolve:t,reject:r}))).then((t=>t?{value:t,done:!1}:{value:void 0,done:!0})),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new Vc(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function fp(t){return JSON.stringify(t)}class pp extends lp{static fromReadableStream(t){const e=new pp(null);return e._run((()=>e._fromReadableStream(t))),e}static runFunctions(t,e,r){const n=new pp(null),o={...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"runFunctions"}};return n._run((()=>n._runFunctions(t,e,o))),n}static runTools(t,e,r){const n=new pp(e),o={...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"runTools"}};return n._run((()=>n._runTools(t,e,o))),n}}class hp extends Rl{parse(t,e){return function(t){for(const e of t??[]){if("function"!==e.type)throw new Tc(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(!0!==e.function.strict)throw new Tc(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}(t.tools),this._client.chat.completions.create(t,{...e,headers:{...e?.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap((e=>Cf(e,t)))}runFunctions(t,e){return t.stream?pp.runFunctions(this._client,t,e):Hf.runFunctions(this._client,t,e)}runTools(t,e){return t.stream?pp.runTools(this._client,t,e):Hf.runTools(this._client,t,e)}stream(t,e){return lp.createChatCompletion(this._client,t,e)}}class dp extends Rl{constructor(){super(...arguments),this.completions=new hp(this._client)}}!function(t){t.Completions=hp}(dp||(dp={}));var yp,vp,mp,bp,gp,wp,xp,_p,Ep,Op,kp,jp,Sp,Ap,Dp,Pp,Cp,Lp,Tp,Fp,Ip,Np,Rp,Mp=function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)},Bp=function(t,e,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!o:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(t,r):o?o.value=r:e.set(t,r),r};class Gp extends Af{constructor(){super(...arguments),yp.add(this),vp.set(this,[]),mp.set(this,{}),bp.set(this,{}),gp.set(this,void 0),wp.set(this,void 0),xp.set(this,void 0),_p.set(this,void 0),Ep.set(this,void 0),Op.set(this,void 0),kp.set(this,void 0),jp.set(this,void 0),Sp.set(this,void 0)}[(vp=new WeakMap,mp=new WeakMap,bp=new WeakMap,gp=new WeakMap,wp=new WeakMap,xp=new WeakMap,_p=new WeakMap,Ep=new WeakMap,Op=new WeakMap,kp=new WeakMap,jp=new WeakMap,Sp=new WeakMap,yp=new WeakSet,Symbol.asyncIterator)](){const t=[],e=[];let r=!1;return this.on("event",(r=>{const n=e.shift();n?n.resolve(r):t.push(r)})),this.on("end",(()=>{r=!0;for(const t of e)t.resolve(void 0);e.length=0})),this.on("abort",(t=>{r=!0;for(const r of e)r.reject(t);e.length=0})),this.on("error",(t=>{r=!0;for(const r of e)r.reject(t);e.length=0})),{next:async()=>t.length?{value:t.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise(((t,r)=>e.push({resolve:t,reject:r}))).then((t=>t?{value:t,done:!1}:{value:void 0,done:!0})),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(t){const e=new Gp;return e._run((()=>e._fromReadableStream(t))),e}async _fromReadableStream(t,e){const r=e?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",(()=>this.controller.abort()))),this._connected();const n=Vc.fromReadableStream(t,this.controller);for await(const t of n)Mp(this,yp,"m",Ap).call(this,t);if(n.controller.signal?.aborted)throw new Ic;return this._addRun(Mp(this,yp,"m",Dp).call(this))}toReadableStream(){return new Vc(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(t,e,r,n,o){const i=new Gp;return i._run((()=>i._runToolAssistantStream(t,e,r,n,{...o,headers:{...o?.headers,"X-Stainless-Helper-Method":"stream"}}))),i}async _createToolAssistantStream(t,e,r,n,o){const i=o?.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",(()=>this.controller.abort())));const a={...n,stream:!0},u=await t.submitToolOutputs(e,r,a,{...o,signal:this.controller.signal});this._connected();for await(const t of u)Mp(this,yp,"m",Ap).call(this,t);if(u.controller.signal?.aborted)throw new Ic;return this._addRun(Mp(this,yp,"m",Dp).call(this))}static createThreadAssistantStream(t,e,r){const n=new Gp;return n._run((()=>n._threadAssistantStream(t,e,{...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"stream"}}))),n}static createAssistantStream(t,e,r,n){const o=new Gp;return o._run((()=>o._runAssistantStream(t,e,r,{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}}))),o}currentEvent(){return Mp(this,kp,"f")}currentRun(){return Mp(this,jp,"f")}currentMessageSnapshot(){return Mp(this,gp,"f")}currentRunStepSnapshot(){return Mp(this,Sp,"f")}async finalRunSteps(){return await this.done(),Object.values(Mp(this,mp,"f"))}async finalMessages(){return await this.done(),Object.values(Mp(this,bp,"f"))}async finalRun(){if(await this.done(),!Mp(this,wp,"f"))throw Error("Final run was not received.");return Mp(this,wp,"f")}async _createThreadAssistantStream(t,e,r){const n=r?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",(()=>this.controller.abort())));const o={...e,stream:!0},i=await t.createAndRun(o,{...r,signal:this.controller.signal});this._connected();for await(const t of i)Mp(this,yp,"m",Ap).call(this,t);if(i.controller.signal?.aborted)throw new Ic;return this._addRun(Mp(this,yp,"m",Dp).call(this))}async _createAssistantStream(t,e,r,n){const o=n?.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",(()=>this.controller.abort())));const i={...r,stream:!0},a=await t.create(e,i,{...n,signal:this.controller.signal});this._connected();for await(const t of a)Mp(this,yp,"m",Ap).call(this,t);if(a.controller.signal?.aborted)throw new Ic;return this._addRun(Mp(this,yp,"m",Dp).call(this))}static accumulateDelta(t,e){for(const[r,n]of Object.entries(e)){if(!t.hasOwnProperty(r)){t[r]=n;continue}let e=t[r];if(null!=e)if("index"!==r&&"type"!==r){if("string"==typeof e&&"string"==typeof n)e+=n;else if("number"==typeof e&&"number"==typeof n)e+=n;else{if(!Nl(e)||!Nl(n)){if(Array.isArray(e)&&Array.isArray(n)){if(e.every((t=>"string"==typeof t||"number"==typeof t))){e.push(...n);continue}for(const t of n){if(!Nl(t))throw new Error(`Expected array delta entry to be an object but got: ${t}`);const r=t.index;if(null==r)throw console.error(t),new Error("Expected array delta entry to have an `index` property");if("number"!=typeof r)throw new Error(`Expected array delta entry \`index\` property to be a number but got ${r}`);const n=e[r];null==n?e.push(t):e[r]=this.accumulateDelta(n,t)}continue}throw Error(`Unhandled record type: ${r}, deltaValue: ${n}, accValue: ${e}`)}e=this.accumulateDelta(e,n)}t[r]=e}else t[r]=n;else t[r]=n}return t}_addRun(t){return t}async _threadAssistantStream(t,e,r){return await this._createThreadAssistantStream(e,t,r)}async _runAssistantStream(t,e,r,n){return await this._createAssistantStream(e,t,r,n)}async _runToolAssistantStream(t,e,r,n,o){return await this._createToolAssistantStream(r,t,e,n,o)}}Ap=function(t){if(!this.ended)switch(Bp(this,kp,t,"f"),Mp(this,yp,"m",Lp).call(this,t),t.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":Mp(this,yp,"m",Np).call(this,t);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":Mp(this,yp,"m",Cp).call(this,t);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":Mp(this,yp,"m",Pp).call(this,t);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},Dp=function(){if(this.ended)throw new Tc("stream has ended, this shouldn't happen");if(!Mp(this,wp,"f"))throw Error("Final run has not been received");return Mp(this,wp,"f")},Pp=function(t){const[e,r]=Mp(this,yp,"m",Fp).call(this,t,Mp(this,gp,"f"));Bp(this,gp,e,"f"),Mp(this,bp,"f")[e.id]=e;for(const t of r){const r=e.content[t.index];"text"==r?.type&&this._emit("textCreated",r.text)}switch(t.event){case"thread.message.created":this._emit("messageCreated",t.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",t.data.delta,e),t.data.delta.content)for(const r of t.data.delta.content){if("text"==r.type&&r.text){let t=r.text,n=e.content[r.index];if(!n||"text"!=n.type)throw Error("The snapshot associated with this text delta is not text or missing");this._emit("textDelta",t,n.text)}if(r.index!=Mp(this,xp,"f")){if(Mp(this,_p,"f"))switch(Mp(this,_p,"f").type){case"text":this._emit("textDone",Mp(this,_p,"f").text,Mp(this,gp,"f"));break;case"image_file":this._emit("imageFileDone",Mp(this,_p,"f").image_file,Mp(this,gp,"f"))}Bp(this,xp,r.index,"f")}Bp(this,_p,e.content[r.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(void 0!==Mp(this,xp,"f")){const e=t.data.content[Mp(this,xp,"f")];if(e)switch(e.type){case"image_file":this._emit("imageFileDone",e.image_file,Mp(this,gp,"f"));break;case"text":this._emit("textDone",e.text,Mp(this,gp,"f"))}}Mp(this,gp,"f")&&this._emit("messageDone",t.data),Bp(this,gp,void 0,"f")}},Cp=function(t){const e=Mp(this,yp,"m",Tp).call(this,t);switch(Bp(this,Sp,e,"f"),t.event){case"thread.run.step.created":this._emit("runStepCreated",t.data);break;case"thread.run.step.delta":const r=t.data.delta;if(r.step_details&&"tool_calls"==r.step_details.type&&r.step_details.tool_calls&&"tool_calls"==e.step_details.type)for(const t of r.step_details.tool_calls)t.index==Mp(this,Ep,"f")?this._emit("toolCallDelta",t,e.step_details.tool_calls[t.index]):(Mp(this,Op,"f")&&this._emit("toolCallDone",Mp(this,Op,"f")),Bp(this,Ep,t.index,"f"),Bp(this,Op,e.step_details.tool_calls[t.index],"f"),Mp(this,Op,"f")&&this._emit("toolCallCreated",Mp(this,Op,"f")));this._emit("runStepDelta",t.data.delta,e);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":Bp(this,Sp,void 0,"f"),"tool_calls"==t.data.step_details.type&&Mp(this,Op,"f")&&(this._emit("toolCallDone",Mp(this,Op,"f")),Bp(this,Op,void 0,"f")),this._emit("runStepDone",t.data,e)}},Lp=function(t){Mp(this,vp,"f").push(t),this._emit("event",t)},Tp=function(t){switch(t.event){case"thread.run.step.created":return Mp(this,mp,"f")[t.data.id]=t.data,t.data;case"thread.run.step.delta":let e=Mp(this,mp,"f")[t.data.id];if(!e)throw Error("Received a RunStepDelta before creation of a snapshot");let r=t.data;if(r.delta){const n=Gp.accumulateDelta(e,r.delta);Mp(this,mp,"f")[t.data.id]=n}return Mp(this,mp,"f")[t.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":Mp(this,mp,"f")[t.data.id]=t.data}if(Mp(this,mp,"f")[t.data.id])return Mp(this,mp,"f")[t.data.id];throw new Error("No snapshot available")},Fp=function(t,e){let r=[];switch(t.event){case"thread.message.created":return[t.data,r];case"thread.message.delta":if(!e)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let n=t.data;if(n.delta.content)for(const t of n.delta.content)if(t.index in e.content){let r=e.content[t.index];e.content[t.index]=Mp(this,yp,"m",Ip).call(this,t,r)}else e.content[t.index]=t,r.push(t);return[e,r];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(e)return[e,r];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},Ip=function(t,e){return Gp.accumulateDelta(e,t)},Np=function(t){switch(Bp(this,jp,t.data,"f"),t.event){case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.cancelling":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":Bp(this,wp,t.data,"f"),Mp(this,Op,"f")&&(this._emit("toolCallDone",Mp(this,Op,"f")),Bp(this,Op,void 0,"f"))}};class Up extends Rl{create(t,e,r){return this._client.post(`/threads/${t}/messages`,{body:e,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}retrieve(t,e,r){return this._client.get(`/threads/${t}/messages/${e}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}update(t,e,r,n){return this._client.post(`/threads/${t}/messages/${e}`,{body:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}list(t,e={},r){return bl(e)?this.list(t,{},e):this._client.getAPIList(`/threads/${t}/messages`,zp,{query:e,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}del(t,e,r){return this._client.delete(`/threads/${t}/messages/${e}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}}class zp extends $l{}Up.MessagesPage=zp;class $p extends Rl{retrieve(t,e,r,n={},o){return bl(n)?this.retrieve(t,e,r,{},n):this._client.get(`/threads/${t}/runs/${e}/steps/${r}`,{query:n,...o,headers:{"OpenAI-Beta":"assistants=v2",...o?.headers}})}list(t,e,r={},n){return bl(r)?this.list(t,e,{},r):this._client.getAPIList(`/threads/${t}/runs/${e}/steps`,qp,{query:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}}class qp extends $l{}$p.RunStepsPage=qp;class Kp extends Rl{constructor(){super(...arguments),this.steps=new $p(this._client)}create(t,e,r){const{include:n,...o}=e;return this._client.post(`/threads/${t}/runs`,{query:{include:n},body:o,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers},stream:e.stream??!1})}retrieve(t,e,r){return this._client.get(`/threads/${t}/runs/${e}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}update(t,e,r,n){return this._client.post(`/threads/${t}/runs/${e}`,{body:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}list(t,e={},r){return bl(e)?this.list(t,{},e):this._client.getAPIList(`/threads/${t}/runs`,Hp,{query:e,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}cancel(t,e,r){return this._client.post(`/threads/${t}/runs/${e}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}async createAndPoll(t,e,r){const n=await this.create(t,e,r);return await this.poll(t,n.id,r)}createAndStream(t,e,r){return Gp.createAssistantStream(t,this._client.beta.threads.runs,e,r)}async poll(t,e,r){const n={...r?.headers,"X-Stainless-Poll-Helper":"true"};for(r?.pollIntervalMs&&(n["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:o,response:i}=await this.retrieve(t,e,{...r,headers:{...r?.headers,...n}}).withResponse();switch(o.status){case"queued":case"in_progress":case"cancelling":let t=5e3;if(r?.pollIntervalMs)t=r.pollIntervalMs;else{const e=i.headers.get("openai-poll-after-ms");if(e){const r=parseInt(e);isNaN(r)||(t=r)}}await jl(t);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return o}}}stream(t,e,r){return Gp.createAssistantStream(t,this._client.beta.threads.runs,e,r)}submitToolOutputs(t,e,r,n){return this._client.post(`/threads/${t}/runs/${e}/submit_tool_outputs`,{body:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers},stream:r.stream??!1})}async submitToolOutputsAndPoll(t,e,r,n){const o=await this.submitToolOutputs(t,e,r,n);return await this.poll(t,o.id,n)}submitToolOutputsStream(t,e,r,n){return Gp.createToolAssistantStream(t,e,this._client.beta.threads.runs,r,n)}}class Hp extends $l{}Kp.RunsPage=Hp,Kp.Steps=$p,Kp.RunStepsPage=qp;class Zp extends Rl{constructor(){super(...arguments),this.runs=new Kp(this._client),this.messages=new Up(this._client)}create(t={},e){return bl(t)?this.create({},t):this._client.post("/threads",{body:t,...e,headers:{"OpenAI-Beta":"assistants=v2",...e?.headers}})}retrieve(t,e){return this._client.get(`/threads/${t}`,{...e,headers:{"OpenAI-Beta":"assistants=v2",...e?.headers}})}update(t,e,r){return this._client.post(`/threads/${t}`,{body:e,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}del(t,e){return this._client.delete(`/threads/${t}`,{...e,headers:{"OpenAI-Beta":"assistants=v2",...e?.headers}})}createAndRun(t,e){return this._client.post("/threads/runs",{body:t,...e,headers:{"OpenAI-Beta":"assistants=v2",...e?.headers},stream:t.stream??!1})}async createAndRunPoll(t,e){const r=await this.createAndRun(t,e);return await this.runs.poll(r.thread_id,r.id,e)}createAndRunStream(t,e){return Gp.createThreadAssistantStream(t,this._client.beta.threads,e)}}Zp.Runs=Kp,Zp.RunsPage=Hp,Zp.Messages=Up,Zp.MessagesPage=zp;class Yp extends Rl{create(t,e,r){return this._client.post(`/vector_stores/${t}/files`,{body:e,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}retrieve(t,e,r){return this._client.get(`/vector_stores/${t}/files/${e}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}list(t,e={},r){return bl(e)?this.list(t,{},e):this._client.getAPIList(`/vector_stores/${t}/files`,Vp,{query:e,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}del(t,e,r){return this._client.delete(`/vector_stores/${t}/files/${e}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}async createAndPoll(t,e,r){const n=await this.create(t,e,r);return await this.poll(t,n.id,r)}async poll(t,e,r){const n={...r?.headers,"X-Stainless-Poll-Helper":"true"};for(r?.pollIntervalMs&&(n["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const o=await this.retrieve(t,e,{...r,headers:n}).withResponse(),i=o.data;switch(i.status){case"in_progress":let t=5e3;if(r?.pollIntervalMs)t=r.pollIntervalMs;else{const e=o.response.headers.get("openai-poll-after-ms");if(e){const r=parseInt(e);isNaN(r)||(t=r)}}await jl(t);break;case"failed":case"completed":return i}}}async upload(t,e,r){const n=await this._client.files.create({file:e,purpose:"assistants"},r);return this.create(t,{file_id:n.id},r)}async uploadAndPoll(t,e,r){const n=await this.upload(t,e,r);return await this.poll(t,n.id,r)}}class Vp extends $l{}Yp.VectorStoreFilesPage=Vp;class Wp extends Rl{create(t,e,r){return this._client.post(`/vector_stores/${t}/file_batches`,{body:e,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}retrieve(t,e,r){return this._client.get(`/vector_stores/${t}/file_batches/${e}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}cancel(t,e,r){return this._client.post(`/vector_stores/${t}/file_batches/${e}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}async createAndPoll(t,e,r){const n=await this.create(t,e);return await this.poll(t,n.id,r)}listFiles(t,e,r={},n){return bl(r)?this.listFiles(t,e,{},r):this._client.getAPIList(`/vector_stores/${t}/file_batches/${e}/files`,Vp,{query:r,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}async poll(t,e,r){const n={...r?.headers,"X-Stainless-Poll-Helper":"true"};for(r?.pollIntervalMs&&(n["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:o,response:i}=await this.retrieve(t,e,{...r,headers:n}).withResponse();switch(o.status){case"in_progress":let t=5e3;if(r?.pollIntervalMs)t=r.pollIntervalMs;else{const e=i.headers.get("openai-poll-after-ms");if(e){const r=parseInt(e);isNaN(r)||(t=r)}}await jl(t);break;case"failed":case"cancelled":case"completed":return o}}}async uploadAndPoll(t,{files:e,fileIds:r=[]},n){if(null==e||0==e.length)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const o=n?.maxConcurrency??5,i=Math.min(o,e.length),a=this._client,u=e.values(),s=[...r],c=Array(i).fill(u).map((async function(t){for(let e of t){const t=await a.files.create({file:e,purpose:"assistants"},n);s.push(t.id)}}));return await(async t=>{const e=await Promise.allSettled(t),r=e.filter((t=>"rejected"===t.status));if(r.length){for(const t of r)console.error(t.reason);throw new Error(`${r.length} promise(s) failed - see the above errors`)}const n=[];for(const t of e)"fulfilled"===t.status&&n.push(t.value);return n})(c),await this.createAndPoll(t,{file_ids:s})}}class Jp extends Rl{constructor(){super(...arguments),this.files=new Yp(this._client),this.fileBatches=new Wp(this._client)}create(t,e){return this._client.post("/vector_stores",{body:t,...e,headers:{"OpenAI-Beta":"assistants=v2",...e?.headers}})}retrieve(t,e){return this._client.get(`/vector_stores/${t}`,{...e,headers:{"OpenAI-Beta":"assistants=v2",...e?.headers}})}update(t,e,r){return this._client.post(`/vector_stores/${t}`,{body:e,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}list(t={},e){return bl(t)?this.list({},t):this._client.getAPIList("/vector_stores",Xp,{query:t,...e,headers:{"OpenAI-Beta":"assistants=v2",...e?.headers}})}del(t,e){return this._client.delete(`/vector_stores/${t}`,{...e,headers:{"OpenAI-Beta":"assistants=v2",...e?.headers}})}}class Xp extends $l{}Jp.VectorStoresPage=Xp,Jp.Files=Yp,Jp.VectorStoreFilesPage=Vp,Jp.FileBatches=Wp;class Qp extends Rl{constructor(){super(...arguments),this.vectorStores=new Jp(this._client),this.chat=new dp(this._client),this.assistants=new uf(this._client),this.threads=new Zp(this._client)}}Qp.VectorStores=Jp,Qp.VectorStoresPage=Xp,Qp.Assistants=uf,Qp.AssistantsPage=sf,Qp.Threads=Zp;class th extends Rl{create(t,e){return this._client.post("/batches",{body:t,...e})}retrieve(t,e){return this._client.get(`/batches/${t}`,e)}list(t={},e){return bl(t)?this.list({},t):this._client.getAPIList("/batches",eh,{query:t,...e})}cancel(t,e){return this._client.post(`/batches/${t}/cancel`,e)}}class eh extends $l{}th.BatchesPage=eh;class rh extends Rl{create(t,e,r){return this._client.post(`/uploads/${t}/parts`,al({body:e,...r}))}}class nh extends Rl{constructor(){super(...arguments),this.parts=new rh(this._client)}create(t,e){return this._client.post("/uploads",{body:t,...e})}cancel(t,e){return this._client.post(`/uploads/${t}/cancel`,e)}complete(t,e,r){return this._client.post(`/uploads/${t}/complete`,{body:e,...r})}}nh.Parts=rh;class oh extends hl{constructor({baseURL:t=Dl("OPENAI_BASE_URL"),apiKey:e=Dl("OPENAI_API_KEY"),organization:r=Dl("OPENAI_ORG_ID")??null,project:n=Dl("OPENAI_PROJECT_ID")??null,...o}={}){if(void 0===e)throw new Tc("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const i={apiKey:e,organization:r,project:n,...o,baseURL:t||"https://api.openai.com/v1"};if(!i.dangerouslyAllowBrowser&&"undefined"!=typeof window&&void 0!==window.document&&"undefined"!=typeof navigator)throw new Tc("It looks like you're running in a browser-like environment.\n\nThis is disabled by default, as it risks exposing your secret API credentials to attackers.\nIf you understand the risks and have appropriate mitigations in place,\nyou can set the `dangerouslyAllowBrowser` option to `true`, e.g.,\n\nnew OpenAI({ apiKey, dangerouslyAllowBrowser: true });\n\nhttps://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety\n");super({baseURL:i.baseURL,timeout:i.timeout??6e5,httpAgent:i.httpAgent,maxRetries:i.maxRetries,fetch:i.fetch}),this.completions=new Ml(this),this.chat=new Gl(this),this.embeddings=new Ul(this),this.files=new ql(this),this.images=new Hl(this),this.audio=new Wl(this),this.moderations=new Jl(this),this.models=new Xl(this),this.fineTuning=new af(this),this.beta=new Qp(this),this.batches=new th(this),this.uploads=new nh(this),this._options=i,this.apiKey=e,this.organization=r,this.project=n}defaultQuery(){return this._options.defaultQuery}defaultHeaders(t){return{...super.defaultHeaders(t),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(t){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(t){return function(t,e={}){let r=t;const n=function(t=dc){if(void 0!==t.allowEmptyArrays&&"boolean"!=typeof t.allowEmptyArrays)throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(void 0!==t.encodeDotInKeys&&"boolean"!=typeof t.encodeDotInKeys)throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(null!==t.encoder&&void 0!==t.encoder&&"function"!=typeof t.encoder)throw new TypeError("Encoder has to be a function.");const e=t.charset||dc.charset;if(void 0!==t.charset&&"utf-8"!==t.charset&&"iso-8859-1"!==t.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let r=rc;if(void 0!==t.format){if(!sc.call(nc,t.format))throw new TypeError("Unknown format option provided.");r=t.format}const n=nc[r];let o,i=dc.filter;if(("function"==typeof t.filter||lc(t.filter))&&(i=t.filter),o=t.arrayFormat&&t.arrayFormat in cc?t.arrayFormat:"indices"in t?t.indices?"indices":"repeat":dc.arrayFormat,"commaRoundTrip"in t&&"boolean"!=typeof t.commaRoundTrip)throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const a=void 0===t.allowDots?1==!!t.encodeDotInKeys||dc.allowDots:!!t.allowDots;return{addQueryPrefix:"boolean"==typeof t.addQueryPrefix?t.addQueryPrefix:dc.addQueryPrefix,allowDots:a,allowEmptyArrays:"boolean"==typeof t.allowEmptyArrays?!!t.allowEmptyArrays:dc.allowEmptyArrays,arrayFormat:o,charset:e,charsetSentinel:"boolean"==typeof t.charsetSentinel?t.charsetSentinel:dc.charsetSentinel,commaRoundTrip:!!t.commaRoundTrip,delimiter:void 0===t.delimiter?dc.delimiter:t.delimiter,encode:"boolean"==typeof t.encode?t.encode:dc.encode,encodeDotInKeys:"boolean"==typeof t.encodeDotInKeys?t.encodeDotInKeys:dc.encodeDotInKeys,encoder:"function"==typeof t.encoder?t.encoder:dc.encoder,encodeValuesOnly:"boolean"==typeof t.encodeValuesOnly?t.encodeValuesOnly:dc.encodeValuesOnly,filter:i,format:r,formatter:n,serializeDate:"function"==typeof t.serializeDate?t.serializeDate:dc.serializeDate,skipNulls:"boolean"==typeof t.skipNulls?t.skipNulls:dc.skipNulls,sort:"function"==typeof t.sort?t.sort:null,strictNullHandling:"boolean"==typeof t.strictNullHandling?t.strictNullHandling:dc.strictNullHandling}}(e);let o,i;"function"==typeof n.filter?(i=n.filter,r=i("",r)):lc(n.filter)&&(i=n.filter,o=i);const a=[];if("object"!=typeof r||null===r)return"";const u=cc[n.arrayFormat],s="comma"===u&&n.commaRoundTrip;o||(o=Object.keys(r)),n.sort&&o.sort(n.sort);const c=new WeakMap;for(let t=0;t<o.length;++t){const e=o[t];n.skipNulls&&null===r[e]||pc(a,vc(r[e],e,u,s,n.allowEmptyArrays,n.strictNullHandling,n.skipNulls,n.encodeDotInKeys,n.encode?n.encoder:null,n.filter,n.sort,n.allowDots,n.serializeDate,n.format,n.formatter,n.encodeValuesOnly,n.charset,c))}const l=a.join(n.delimiter);let f=!0===n.addQueryPrefix?"?":"";return n.charsetSentinel&&("iso-8859-1"===n.charset?f+="utf8=%26%2310003%3B&":f+="utf8=%E2%9C%93&"),l.length>0?f+l:""}(t,{arrayFormat:"brackets"})}}Rp=oh,oh.OpenAI=Rp,oh.DEFAULT_TIMEOUT=6e5,oh.OpenAIError=Tc,oh.APIError=Fc,oh.APIConnectionError=Nc,oh.APIConnectionTimeoutError=Rc,oh.APIUserAbortError=Ic,oh.NotFoundError=Uc,oh.ConflictError=zc,oh.RateLimitError=qc,oh.BadRequestError=Mc,oh.AuthenticationError=Bc,oh.InternalServerError=Kc,oh.PermissionDeniedError=Gc,oh.UnprocessableEntityError=$c,oh.toFile=rl,oh.fileFromPath=kc,oh.Completions=Ml,oh.Chat=Gl,oh.Embeddings=Ul,oh.Files=ql,oh.FileObjectsPage=Kl,oh.Images=Hl,oh.Audio=Wl,oh.Moderations=Jl,oh.Models=Xl,oh.ModelsPage=Ql,oh.FineTuning=af,oh.Beta=Qp,oh.Batches=th,oh.BatchesPage=eh,oh.Uploads=nh,new Set(["/completions","/chat/completions","/embeddings","/audio/transcriptions","/audio/translations","/audio/speech","/images/generations"]);var ih=o(5681),ah=o(4054),uh=o(1041),sh=o(7247),ch=o(2613),lh=o(5520);function fh(t){return fh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fh(t)}function ph(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=wh(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}function hh(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function dh(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?hh(Object(r),!0).forEach((function(e){yh(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):hh(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function yh(t,e,r){return(e=Eh(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vh(){vh=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new P(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function b(){}function g(){}var w={};c(w,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(w=_);var E=g.prototype=m.prototype=Object.create(w);function O(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,i,a,u){var s=f(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==fh(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=S(u,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?y:h,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=y,n.method="throw",n.arg=c.arg)}}}function S(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,S(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function C(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(fh(e)+" is not iterable")}return b.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=c(g,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,c(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},O(k.prototype),c(k.prototype,u,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(E),c(E,s,"Generator"),c(E,a,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=C,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),D(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;D(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:C(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function mh(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function bh(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){mh(i,n,o,a,u,"next",t)}function u(t){mh(i,n,o,a,u,"throw",t)}a(void 0)}))}}function gh(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],s=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);s=!0);}catch(t){c=!0,o=t}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(t,e)||wh(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function wh(t,e){if(t){if("string"==typeof t)return xh(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?xh(t,e):void 0}}function xh(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function _h(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Eh(n.key),n)}}function Eh(t){var e=function(t){if("object"!=fh(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=fh(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==fh(e)?e:e+""}function Oh(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Oh=function(){return!!t})()}function kh(){return kh="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=jh(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},kh.apply(null,arguments)}function jh(t){return jh=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},jh(t)}function Sh(t,e){return Sh=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Sh(t,e)}function Ah(t){var e,r,n,o=2;for("undefined"!=typeof Symbol&&(r=Symbol.asyncIterator,n=Symbol.iterator);o--;){if(r&&null!=(e=t[r]))return e.call(t);if(n&&null!=(e=t[n]))return new Dh(e.call(t));r="@@asyncIterator",n="@@iterator"}throw new TypeError("Object is not async iterable")}function Dh(t){function e(t){if(Object(t)!==t)return Promise.reject(new TypeError(t+" is not an object."));var e=t.done;return Promise.resolve(t.value).then((function(t){return{value:t,done:e}}))}return Dh=function(t){this.s=t,this.n=t.next},Dh.prototype={s:null,n:null,next:function(){return e(this.n.apply(this.s,arguments))},return:function(t){var r=this.s.return;return void 0===r?Promise.resolve({value:t,done:!0}):e(r.apply(this.s,arguments))},throw:function(t){var r=this.s.return;return void 0===r?Promise.reject(t):e(r.apply(this.s,arguments))}},new Dh(t)}function Ph(t){return new Th(t,0)}function Ch(t){return function(){return new Lh(t.apply(this,arguments))}}function Lh(t){var e,r;function n(e,r){try{var i=t[e](r),a=i.value,u=a instanceof Th;Promise.resolve(u?a.v:a).then((function(r){if(u){var s="return"===e?"return":"next";if(!a.k||r.done)return n(s,r);r=t[s](r).value}o(i.done?"return":"normal",r)}),(function(t){n("throw",t)}))}catch(t){o("throw",t)}}function o(t,o){switch(t){case"return":e.resolve({value:o,done:!0});break;case"throw":e.reject(o);break;default:e.resolve({value:o,done:!1})}(e=e.next)?n(e.key,e.arg):r=null}this._invoke=function(t,o){return new Promise((function(i,a){var u={key:t,arg:o,resolve:i,reject:a,next:null};r?r=r.next=u:(e=r=u,n(t,o))}))},"function"!=typeof t.return&&(this.return=void 0)}function Th(t,e){this.v=t,this.k=e}Lh.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},Lh.prototype.next=function(t){return this._invoke("next",t)},Lh.prototype.throw=function(t){return this._invoke("throw",t)},Lh.prototype.return=function(t){return this._invoke("return",t)};var Fh=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=function(t,e,r){return e=jh(e),function(t,e){if(e&&("object"==fh(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Oh()?Reflect.construct(e,r||[],jh(t).constructor):e.apply(t,r))}(this,e,[t]),Object.defineProperty(r,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","chat_models",r._llmType()]}),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Sh(t,e)}(e,t),r=e,n=[{key:"_separateRunnableConfigFromCallOptionsCompat",value:function(t){var r,n,o=gh((r=this,"function"==typeof(n=kh(jh(e.prototype),"_separateRunnableConfigFromCallOptions",r))?function(t){return n.apply(r,t)}:n)([t]),2),i=o[0],a=o[1];return a.signal=i.signal,[i,a]}},{key:"invoke",value:(h=bh(vh().mark((function t(r,n){var o,i,a;return vh().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=e._convertInputToPromptValue(r),t.next=3,this.generatePrompt([o],n,null==n?void 0:n.callbacks);case 3:return i=t.sent,a=i.generations[0][0],t.abrupt("return",a.message);case 6:case"end":return t.stop()}}),t,this)}))),function(t,e){return h.apply(this,arguments)})},{key:"_streamResponseChunks",value:function(t,e,r){return Ch(vh().mark((function t(){return vh().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:throw new Error("Not implemented.");case 1:case"end":return t.stop()}}),t)})))()}},{key:"_streamIterator",value:function(t,r){var n=this;return Ch(vh().mark((function o(){var i,a,u,s,c,l,f,p,h,d,y,v,m,b,g,w,x,_,E;return vh().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(n._streamResponseChunks!==e.prototype._streamResponseChunks){o.next=5;break}return o.next=3,n.invoke(t,r);case 3:o.next=58;break;case 5:return i=e._convertInputToPromptValue(t),a=i.toChatMessages(),u=n._separateRunnableConfigFromCallOptionsCompat(r),s=gh(u,2),c=s[0],l=s[1],f=dh(dh({},c.metadata),n.getLsParams(l)),o.next=11,Ph(zr.Td.configure(c.callbacks,n.callbacks,c.tags,n.tags,f,n.metadata,{verbose:n.verbose}));case 11:return p=o.sent,h={options:l,invocation_params:null==n?void 0:n.invocationParams(l),batch_size:1},o.next=15,Ph(null==p?void 0:p.handleChatModelStart(n.toJSON(),[a],c.runId,void 0,h,void 0,void 0,c.runName));case 15:d=o.sent,o.prev=16,v=!1,m=!1,o.prev=19,g=Ah(n._streamResponseChunks(a,l,null==d?void 0:d[0]));case 21:return o.next=23,Ph(g.next());case 23:if(!(v=!(w=o.sent).done)){o.next=33;break}return null==(x=w.value).message.id&&null!=(E=null==d||null===(_=d.at(0))||void 0===_?void 0:_.runId)&&x.message._updateId("run-".concat(E)),x.message.response_metadata=dh(dh({},x.generationInfo),x.message.response_metadata),o.next=29,x.message;case 29:y=y?y.concat(x):x;case 30:v=!1,o.next=21;break;case 33:o.next=39;break;case 35:o.prev=35,o.t0=o.catch(19),m=!0,b=o.t0;case 39:if(o.prev=39,o.prev=40,!v||null==g.return){o.next=44;break}return o.next=44,Ph(g.return());case 44:if(o.prev=44,!m){o.next=47;break}throw b;case 47:return o.finish(44);case 48:return o.finish(39);case 49:o.next=56;break;case 51:return o.prev=51,o.t1=o.catch(16),o.next=55,Ph(Promise.all((null!=d?d:[]).map((function(t){return null==t?void 0:t.handleLLMError(o.t1)}))));case 55:throw o.t1;case 56:return o.next=58,Ph(Promise.all((null!=d?d:[]).map((function(t){return null==t?void 0:t.handleLLMEnd({generations:[[y]]})}))));case 58:case"end":return o.stop()}}),o,null,[[16,51],[19,35,39,49],[40,,44,48]])})))()}},{key:"getLsParams",value:function(t){return{ls_model_type:"chat",ls_stop:t.stop}}},{key:"_generateUncached",value:(p=bh(vh().mark((function t(r,n,o){var i,a,u,s,c,l,f,p,h,d,y,v,m,b,g,w,x,_,E,O,k=this;return vh().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=r.map((function(t){return t.map(to.K0)})),u=dh(dh({},o.metadata),this.getLsParams(n)),t.next=4,zr.Td.configure(o.callbacks,this.callbacks,o.tags,this.tags,u,this.metadata,{verbose:this.verbose});case 4:return s=t.sent,c={options:n,invocation_params:null==this?void 0:this.invocationParams(n),batch_size:1},t.next=8,null==s?void 0:s.handleChatModelStart(this.toJSON(),a,o.runId,void 0,c,void 0,void 0,o.runName);case 8:if(l=t.sent,f=[],p=[],null==l||!l[0].handlers.find((function(t){return(0,uh.K)(t)||(0,sh.l7)(t)}))||1!==a.length||this._streamResponseChunks===e.prototype._streamResponseChunks){t.next=60;break}return t.prev=13,t.next=16,this._streamResponseChunks(a[0],n,null==l?void 0:l[0]);case 16:h=t.sent,y=!1,v=!1,t.prev=19,b=Ah(h);case 21:return t.next=23,b.next();case 23:if(!(y=!(g=t.sent).done)){t.next=30;break}null==(w=g.value).message.id&&null!=(_=null==l||null===(x=l.at(0))||void 0===x?void 0:x.runId)&&w.message._updateId("run-".concat(_)),d=void 0===d?w:(0,ch.xW)(d,w);case 27:y=!1,t.next=21;break;case 30:t.next=36;break;case 32:t.prev=32,t.t0=t.catch(19),v=!0,m=t.t0;case 36:if(t.prev=36,t.prev=37,!y||null==b.return){t.next=41;break}return t.next=41,b.return();case 41:if(t.prev=41,!v){t.next=44;break}throw m;case 44:return t.finish(41);case 45:return t.finish(36);case 46:if(void 0!==d){t.next=48;break}throw new Error("Received empty response from chat model call.");case 48:return f.push([d]),t.next=51,null==l?void 0:l[0].handleLLMEnd({generations:f,llmOutput:{}});case 51:t.next=58;break;case 53:return t.prev=53,t.t1=t.catch(13),t.next=57,null==l?void 0:l[0].handleLLMError(t.t1);case 57:throw t.t1;case 58:t.next=65;break;case 60:return t.next=62,Promise.allSettled(a.map((function(t,e){return k._generate(t,dh(dh({},n),{},{promptIndex:e}),null==l?void 0:l[e])})));case 62:return E=t.sent,t.next=65,Promise.all(E.map(function(){var t=bh(vh().mark((function t(e,r){var n,o,i,a,u,s,c,h;return vh().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("fulfilled"!==e.status){t.next=10;break}o=e.value,i=ph(o.generations);try{for(i.s();!(a=i.n()).done;)null==(u=a.value).message.id&&null!=(c=null==l||null===(s=l.at(0))||void 0===s?void 0:s.runId)&&u.message._updateId("run-".concat(c)),u.message.response_metadata=dh(dh({},u.generationInfo),u.message.response_metadata)}catch(t){i.e(t)}finally{i.f()}return 1===o.generations.length&&(o.generations[0].message.response_metadata=dh(dh({},o.llmOutput),o.generations[0].message.response_metadata)),f[r]=o.generations,p[r]=o.llmOutput,t.abrupt("return",null==l||null===(n=l[r])||void 0===n?void 0:n.handleLLMEnd({generations:[o.generations],llmOutput:o.llmOutput}));case 10:return t.next=12,null==l||null===(h=l[r])||void 0===h?void 0:h.handleLLMError(e.reason);case 12:return t.abrupt("return",Promise.reject(e.reason));case 13:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}()));case 65:return O={generations:f,llmOutput:p.length?null===(i=this._combineLLMOutput)||void 0===i?void 0:i.call.apply(i,[this].concat(p)):void 0},Object.defineProperty(O,ih.SP,{value:l?{runIds:null==l?void 0:l.map((function(t){return t.runId}))}:void 0,configurable:!0}),t.abrupt("return",O);case 68:case"end":return t.stop()}}),t,this,[[13,53],[19,32,36,46],[37,,41,45]])}))),function(t,e,r){return p.apply(this,arguments)})},{key:"_generateCached",value:(f=bh(vh().mark((function t(r){var n,o,i,a,u,s,c,l,f,p,h,d,y,v,m;return vh().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=r.messages,o=r.cache,i=r.llmStringKey,a=r.parsedOptions,u=r.handledOptions,s=n.map((function(t){return t.map(to.K0)})),c=dh(dh({},u.metadata),this.getLsParams(a)),t.next=5,zr.Td.configure(u.callbacks,this.callbacks,u.tags,this.tags,c,this.metadata,{verbose:this.verbose});case 5:return l=t.sent,f={options:a,invocation_params:null==this?void 0:this.invocationParams(a),batch_size:1,cached:!0},t.next=9,null==l?void 0:l.handleChatModelStart(this.toJSON(),s,u.runId,void 0,f,void 0,void 0,u.runName);case 9:return p=t.sent,h=[],t.next=13,Promise.allSettled(s.map(function(){var t=bh(vh().mark((function t(r,n){var a,u;return vh().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e._convertInputToPromptValue(r).toString(),t.next=3,o.lookup(a,i);case 3:return null==(u=t.sent)&&h.push(n),t.abrupt("return",u);case 6:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}()));case 13:return d=t.sent,y=d.map((function(t,e){return{result:t,runManager:null==p?void 0:p[e]}})).filter((function(t){var e=t.result;return"fulfilled"===e.status&&null!=e.value||"rejected"===e.status})),v=[],t.next=18,Promise.all(y.map(function(){var t=bh(vh().mark((function t(e,r){var n,o,i;return vh().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.result,o=e.runManager,"fulfilled"!==n.status){t.next=10;break}if(i=n.value,v[r]=i,!i.length){t.next=7;break}return t.next=7,null==o?void 0:o.handleLLMNewToken(i[0].text);case 7:return t.abrupt("return",null==o?void 0:o.handleLLMEnd({generations:[i]}));case 10:return t.next=12,null==o?void 0:o.handleLLMError(n.reason);case 12:return t.abrupt("return",Promise.reject(n.reason));case 13:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}()));case 18:return m={generations:v,missingPromptIndices:h},Object.defineProperty(m,ih.SP,{value:p?{runIds:null==p?void 0:p.map((function(t){return t.runId}))}:void 0,configurable:!0}),t.abrupt("return",m);case 21:case"end":return t.stop()}}),t,this)}))),function(t){return f.apply(this,arguments)})},{key:"generate",value:(l=bh(vh().mark((function t(r,n,o){var i,a,u,s,c,l,f,p,h,d,y,v,m,b,g;return vh().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=Array.isArray(n)?{stop:n}:n,u=r.map((function(t){return t.map(to.K0)})),s=this._separateRunnableConfigFromCallOptionsCompat(a),c=gh(s,2),l=c[0],f=c[1],l.callbacks=null!==(i=l.callbacks)&&void 0!==i?i:o,this.cache){t.next=6;break}return t.abrupt("return",this._generateUncached(u,f,l));case 6:return p=this.cache,h=this._getSerializedCacheKeyParametersForCall(f),t.next=10,this._generateCached({messages:u,cache:p,llmStringKey:h,parsedOptions:f,handledOptions:l});case 10:if(d=t.sent,y=d.generations,v=d.missingPromptIndices,m={},!(v.length>0)){t.next=21;break}return t.next=17,this._generateUncached(v.map((function(t){return u[t]})),f,l);case 17:return g=t.sent,t.next=20,Promise.all(g.generations.map(function(){var t=bh(vh().mark((function t(r,n){var o,i;return vh().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=v[n],y[o]=r,i=e._convertInputToPromptValue(u[o]).toString(),t.abrupt("return",p.update(i,h,r));case 4:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}()));case 20:m=null!==(b=g.llmOutput)&&void 0!==b?b:{};case 21:return t.abrupt("return",{generations:y,llmOutput:m});case 22:case"end":return t.stop()}}),t,this)}))),function(t,e,r){return l.apply(this,arguments)})},{key:"invocationParams",value:function(t){return{}}},{key:"_modelType",value:function(){return"base_chat_model"}},{key:"serialize",value:function(){return dh(dh({},this.invocationParams()),{},{_type:this._llmType(),_model:this._modelType()})}},{key:"generatePrompt",value:(c=bh(vh().mark((function t(e,r,n){var o;return vh().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=e.map((function(t){return t.toChatMessages()})),t.abrupt("return",this.generate(o,r,n));case 2:case"end":return t.stop()}}),t,this)}))),function(t,e,r){return c.apply(this,arguments)})},{key:"call",value:(s=bh(vh().mark((function t(e,r,n){var o,i;return vh().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.generate([e.map(to.K0)],r,n);case 2:return o=t.sent,i=o.generations,t.abrupt("return",i[0][0].message);case 5:case"end":return t.stop()}}),t,this)}))),function(t,e,r){return s.apply(this,arguments)})},{key:"callPrompt",value:(u=bh(vh().mark((function t(e,r,n){var o;return vh().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=e.toChatMessages(),t.abrupt("return",this.call(o,r,n));case 2:case"end":return t.stop()}}),t,this)}))),function(t,e,r){return u.apply(this,arguments)})},{key:"predictMessages",value:(a=bh(vh().mark((function t(e,r,n){return vh().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.call(e,r,n));case 1:case"end":return t.stop()}}),t,this)}))),function(t,e,r){return a.apply(this,arguments)})},{key:"predict",value:(i=bh(vh().mark((function t(e,r,n){var o,i;return vh().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=new to.xc(e),t.next=3,this.call([o],r,n);case 3:if("string"==typeof(i=t.sent).content){t.next=6;break}throw new Error("Cannot use predict when output is not a string.");case 6:return t.abrupt("return",i.content);case 7:case"end":return t.stop()}}),t,this)}))),function(t,e,r){return i.apply(this,arguments)})},{key:"withStructuredOutput",value:function(t,e){var r;if("function"!=typeof this.bindTools)throw new Error('Chat model must implement ".bindTools()" to use withStructuredOutput.');var n=t,o=null==e?void 0:e.name,i=null!==(r=n.description)&&void 0!==r?r:"A function available to call.",a=null==e?void 0:e.method,u=null==e?void 0:e.includeRaw;if("jsonMode"===a)throw new Error('Base withStructuredOutput implementation only supports "functionCalling" as a method.');var s,c=null!=o?o:"extract";Zr(n)?s=[{type:"function",function:{name:c,description:i,parameters:(0,Mo.Ik)(n)}}]:("name"in n&&(c=n.name),s=[{type:"function",function:{name:c,description:i,parameters:n}}]);var l=this.bindTools(s),f=Go.jY.from((function(t){if(!t.tool_calls||0===t.tool_calls.length)throw new Error("No tool calls found in the response.");var e=t.tool_calls.find((function(t){return t.name===c}));if(!e)throw new Error("No tool call found with name ".concat(c,"."));return e.args}));if(!u)return l.pipe(f).withConfig({runName:"StructuredOutput"});var p=lh.k.assign({parsed:function(t,e){return f.invoke(t.raw,e)}}),h=lh.k.assign({parsed:function(){return null}}),d=p.withFallbacks({fallbacks:[h]});return Go.zZ.from([{raw:l},d]).withConfig({runName:"StructuredOutputRunnable"})}}],n&&_h(r.prototype,n),o&&_h(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o,i,a,u,s,c,l,f,p,h}($r.j_),Ih=o(9445),Nh=o(9190),Rh=o(1176),Mh=o(1260);function Bh(t){return Bh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bh(t)}var Gh=["id"];function Uh(t,e,r,n){var o=zh(od(1&n?t.prototype:t),e,r);return 2&n&&"function"==typeof o?function(t){return o.apply(r,t)}:o}function zh(){return zh="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=od(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},zh.apply(null,arguments)}function $h(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return qh(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?qh(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}function qh(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Kh(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Hh(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Kh(Object(r),!0).forEach((function(e){Zh(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Kh(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Zh(t,e,r){return(e=ed(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Yh(t,e){if(null==t)return{};var r,n,o=function(t,e){if(null==t)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.includes(n))continue;r[n]=t[n]}return r}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.includes(r)||{}.propertyIsEnumerable.call(t,r)&&(o[r]=t[r])}return o}function Vh(){Vh=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new P(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function b(){}function g(){}var w={};c(w,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(w=_);var E=g.prototype=m.prototype=Object.create(w);function O(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,i,a,u){var s=f(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==Bh(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=S(u,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?y:h,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=y,n.method="throw",n.arg=c.arg)}}}function S(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,S(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function C(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(Bh(e)+" is not iterable")}return b.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=c(g,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,c(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},O(k.prototype),c(k.prototype,u,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(E),c(E,s,"Generator"),c(E,a,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=C,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),D(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;D(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:C(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function Wh(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function Jh(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Wh(i,n,o,a,u,"next",t)}function u(t){Wh(i,n,o,a,u,"throw",t)}a(void 0)}))}}function Xh(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Qh(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ed(n.key),n)}}function td(t,e,r){return e&&Qh(t.prototype,e),r&&Qh(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function ed(t){var e=function(t){if("object"!=Bh(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Bh(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Bh(e)?e:e+""}function rd(t,e,r){return e=od(e),function(t,e){if(e&&("object"==Bh(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,nd()?Reflect.construct(e,r||[],od(t).constructor):e.apply(t,r))}function nd(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(nd=function(){return!!t})()}function od(t){return od=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},od(t)}function id(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ad(t,e)}function ad(t,e){return ad=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ad(t,e)}function ud(t,e){if(void 0!==t.function){var r;if(null!=e&&e.partial)try{var n;r=(0,Nh.d1)(null!==(n=t.function.arguments)&&void 0!==n?n:"{}")}catch(t){return}else try{r=JSON.parse(t.function.arguments)}catch(e){throw new Ih.CC(['Function "'.concat(t.function.name,'" arguments:'),"",t.function.arguments,"","are not valid JSON.","Error: ".concat(e.message)].join("\n"))}var o={name:t.function.name,args:r,type:"tool_call"};return null!=e&&e.returnId&&(o.id=t.id),o}}function sd(t){if(void 0===t.id)throw new Error('All OpenAI tool calls must have an "id" field.');return{id:t.id,type:"function",function:{name:t.name,arguments:JSON.stringify(t.args)}}}function cd(t,e){var r,n;return{name:null===(r=t.function)||void 0===r?void 0:r.name,args:null===(n=t.function)||void 0===n?void 0:n.arguments,id:t.id,error:e,type:"invalid_tool_call"}}var ld=function(t){function e(t){var r,n;return Xh(this,e),n=rd(this,e,[t]),Object.defineProperty(n,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","openai_tools"]}),Object.defineProperty(n,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(n,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(n,"keyName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(n,"returnSingle",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(n,"zodSchema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),n.keyName=t.keyName,n.returnSingle=null!==(r=t.returnSingle)&&void 0!==r?r:n.returnSingle,n.zodSchema=t.zodSchema,n}return id(e,t),td(e,[{key:"_validateResult",value:(o=Jh(Vh().mark((function t(e){var r;return Vh().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0!==this.zodSchema){t.next=2;break}return t.abrupt("return",e);case 2:return t.next=4,this.zodSchema.safeParseAsync(e);case 4:if(!(r=t.sent).success){t.next=9;break}return t.abrupt("return",r.data);case 9:throw new Ih.CC('Failed to parse. Text: "'.concat(JSON.stringify(e,null,2),'". Error: ').concat(JSON.stringify(r.error.errors)),JSON.stringify(e,null,2));case 10:case"end":return t.stop()}}),t,this)}))),function(t){return o.apply(this,arguments)})},{key:"parsePartialResult",value:(n=Jh(Vh().mark((function t(r){var n,o,i,a=this;return Vh().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Uh(e,"parsePartialResult",this,3)([r]);case 2:if(n=t.sent,o=n.filter((function(t){return t.type===a.keyName})),i=o,o.length){t.next=7;break}return t.abrupt("return",void 0);case 7:if(this.returnId||(i=o.map((function(t){return t.args}))),!this.returnSingle){t.next=10;break}return t.abrupt("return",i[0]);case 10:return t.abrupt("return",i);case 11:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"parseResult",value:(r=Jh(Vh().mark((function t(r){var n,o,i,a,u=this;return Vh().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Uh(e,"parsePartialResult",this,3)([r,!1]);case 2:if(n=t.sent,o=n.filter((function(t){return t.type===u.keyName})),i=o,o.length){t.next=7;break}return t.abrupt("return",void 0);case 7:if(this.returnId||(i=o.map((function(t){return t.args}))),!this.returnSingle){t.next=10;break}return t.abrupt("return",this._validateResult(i[0]));case 10:return t.next=12,Promise.all(i.map((function(t){return u._validateResult(t)})));case 12:return a=t.sent,t.abrupt("return",a);case 14:case"end":return t.stop()}}),t,this)}))),function(t){return r.apply(this,arguments)})}],[{key:"lc_name",value:function(){return"JsonOutputKeyToolsParser"}}]);var r,n,o}(function(t){function e(t){var r,n;return Xh(this,e),n=rd(this,e,[t]),Object.defineProperty(n,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(n,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","openai_tools"]}),Object.defineProperty(n,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),n.returnId=null!==(r=null==t?void 0:t.returnId)&&void 0!==r?r:n.returnId,n}return id(e,t),td(e,[{key:"_diff",value:function(){throw new Error("Not supported.")}},{key:"parse",value:(o=Jh(Vh().mark((function t(){return Vh().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:throw new Error("Not implemented.");case 1:case"end":return t.stop()}}),t)}))),function(){return o.apply(this,arguments)})},{key:"parseResult",value:(n=Jh(Vh().mark((function t(e){var r;return Vh().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.parsePartialResult(e,!1);case 2:return r=t.sent,t.abrupt("return",r);case 4:case"end":return t.stop()}}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"parsePartialResult",value:(r=Jh(Vh().mark((function t(e){var r,n,o,i,a,u,s,c,l,f,p=this,h=arguments;return Vh().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=!(h.length>1&&void 0!==h[1])||h[1],o=e[0].message,(0,Mh.KX)(o)&&null!==(r=o.tool_calls)&&void 0!==r&&r.length?i=o.tool_calls.map((function(t){var e=t.id,r=Yh(t,Gh);return p.returnId?Hh({id:e},r):r})):void 0!==o.additional_kwargs.tool_calls&&(a=JSON.parse(JSON.stringify(o.additional_kwargs.tool_calls)),i=a.map((function(t){return ud(t,{returnId:p.returnId,partial:n})}))),i){t.next=5;break}return t.abrupt("return",[]);case 5:u=[],s=$h(i);try{for(s.s();!(c=s.n()).done;)void 0!==(l=c.value)&&(f={type:l.name,args:l.args,id:l.id},Object.defineProperty(f,"name",{get:function(){return this.type}}),Object.defineProperty(f,"arguments",{get:function(){return this.args}}),u.push(f))}catch(t){s.e(t)}finally{s.f()}return t.abrupt("return",u);case 9:case"end":return t.stop()}}),t)}))),function(t){return r.apply(this,arguments)})}],[{key:"lc_name",value:function(){return"JsonOutputToolsParser"}}]);var r,n,o}(Rh.T));function fd(t,e,r,n){n?.errorMessages&&r&&(t.errorMessage={...t.errorMessage,[e]:r})}function pd(t,e,r,n,o){t[e]=r,fd(t,e,n,o)}function hd(t,e,r){const n=r??e.dateStrategy;if(Array.isArray(n))return{anyOf:n.map(((r,n)=>hd(t,e,r)))};switch(n){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return dd(t,e)}}const dd=(t,e)=>{const r={type:"integer",format:"unix-time"};if("openApi3"===e.target)return r;for(const n of t.checks)switch(n.kind){case"min":pd(r,"minimum",n.value,n.message,e);break;case"max":pd(r,"maximum",n.value,n.message,e)}return r};let yd;const vd=/^[cC][^\s-]{8,}$/,md=/^[0-9a-z]+$/,bd=/^[0-9A-HJKMNP-TV-Z]{26}$/,gd=/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,wd=()=>(void 0===yd&&(yd=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),yd),xd=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,_d=/^[a-zA-Z0-9_-]{21}$/;function Ed(t,e){const r={type:"string"};function n(t){return"escape"===e.patternStrategy?Od(t):t}if(t.checks)for(const o of t.checks)switch(o.kind){case"min":pd(r,"minLength","number"==typeof r.minLength?Math.max(r.minLength,o.value):o.value,o.message,e);break;case"max":pd(r,"maxLength","number"==typeof r.maxLength?Math.min(r.maxLength,o.value):o.value,o.message,e);break;case"email":switch(e.emailStrategy){case"format:email":kd(r,"email",o.message,e);break;case"format:idn-email":kd(r,"idn-email",o.message,e);break;case"pattern:zod":jd(r,gd,o.message,e)}break;case"url":kd(r,"uri",o.message,e);break;case"uuid":kd(r,"uuid",o.message,e);break;case"regex":jd(r,o.regex,o.message,e);break;case"cuid":jd(r,vd,o.message,e);break;case"cuid2":jd(r,md,o.message,e);break;case"startsWith":jd(r,RegExp(`^${n(o.value)}`),o.message,e);break;case"endsWith":jd(r,RegExp(`${n(o.value)}$`),o.message,e);break;case"datetime":kd(r,"date-time",o.message,e);break;case"date":kd(r,"date",o.message,e);break;case"time":kd(r,"time",o.message,e);break;case"duration":kd(r,"duration",o.message,e);break;case"length":pd(r,"minLength","number"==typeof r.minLength?Math.max(r.minLength,o.value):o.value,o.message,e),pd(r,"maxLength","number"==typeof r.maxLength?Math.min(r.maxLength,o.value):o.value,o.message,e);break;case"includes":jd(r,RegExp(n(o.value)),o.message,e);break;case"ip":"v6"!==o.version&&kd(r,"ipv4",o.message,e),"v4"!==o.version&&kd(r,"ipv6",o.message,e);break;case"emoji":jd(r,wd,o.message,e);break;case"ulid":jd(r,bd,o.message,e);break;case"base64":switch(e.base64Strategy){case"format:binary":kd(r,"binary",o.message,e);break;case"contentEncoding:base64":pd(r,"contentEncoding","base64",o.message,e);break;case"pattern:zod":jd(r,xd,o.message,e)}break;case"nanoid":jd(r,_d,o.message,e)}return r}const Od=t=>Array.from(t).map((t=>/[a-zA-Z0-9]/.test(t)?t:`\\${t}`)).join(""),kd=(t,e,r,n)=>{t.format||t.anyOf?.some((t=>t.format))?(t.anyOf||(t.anyOf=[]),t.format&&(t.anyOf.push({format:t.format,...t.errorMessage&&n.errorMessages&&{errorMessage:{format:t.errorMessage.format}}}),delete t.format,t.errorMessage&&(delete t.errorMessage.format,0===Object.keys(t.errorMessage).length&&delete t.errorMessage)),t.anyOf.push({format:e,...r&&n.errorMessages&&{errorMessage:{format:r}}})):pd(t,"format",e,r,n)},jd=(t,e,r,n)=>{t.pattern||t.allOf?.some((t=>t.pattern))?(t.allOf||(t.allOf=[]),t.pattern&&(t.allOf.push({pattern:t.pattern,...t.errorMessage&&n.errorMessages&&{errorMessage:{pattern:t.errorMessage.pattern}}}),delete t.pattern,t.errorMessage&&(delete t.errorMessage.pattern,0===Object.keys(t.errorMessage).length&&delete t.errorMessage)),t.allOf.push({pattern:Sd(e,n),...r&&n.errorMessages&&{errorMessage:{pattern:r}}})):pd(t,"pattern",Sd(e,n),r,n)},Sd=(t,e)=>{const r="function"==typeof t?t():t;if(!e.applyRegexFlags||!r.flags)return r.source;const n=r.flags.includes("i"),o=r.flags.includes("m"),i=r.flags.includes("s"),a=n?r.source.toLowerCase():r.source;let u="",s=!1,c=!1,l=!1;for(let t=0;t<a.length;t++)if(s)u+=a[t],s=!1;else{if(n)if(c){if(a[t].match(/[a-z]/)){l?(u+=a[t],u+=`${a[t-2]}-${a[t]}`.toUpperCase(),l=!1):"-"===a[t+1]&&a[t+2]?.match(/[a-z]/)?(u+=a[t],l=!0):u+=`${a[t]}${a[t].toUpperCase()}`;continue}}else if(a[t].match(/[a-z]/)){u+=`[${a[t]}${a[t].toUpperCase()}]`;continue}if(o){if("^"===a[t]){u+="(^|(?<=[\r\n]))";continue}if("$"===a[t]){u+="($|(?=[\r\n]))";continue}}i&&"."===a[t]?u+=c?`${a[t]}\r\n`:`[${a[t]}\r\n]`:(u+=a[t],"\\"===a[t]?s=!0:c&&"]"===a[t]?c=!1:c||"["!==a[t]||(c=!0))}try{new RegExp(u)}catch{return console.warn(`Could not convert regex pattern at ${e.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),r.source}return u};function Ad(t,e){if("openApi3"===e.target&&t.keyType?._def.typeName===Ur.kY.ZodEnum)return{type:"object",required:t.keyType._def.values,properties:t.keyType._def.values.reduce(((r,n)=>({...r,[n]:Fd(t.valueType._def,{...e,currentPath:[...e.currentPath,"properties",n]})??{}})),{}),additionalProperties:!1};const r={type:"object",additionalProperties:Fd(t.valueType._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??{}};if("openApi3"===e.target)return r;if(t.keyType?._def.typeName===Ur.kY.ZodString&&t.keyType._def.checks?.length){const n=Object.entries(Ed(t.keyType._def,e)).reduce(((t,[e,r])=>"type"===e?t:{...t,[e]:r}),{});return{...r,propertyNames:n}}return t.keyType?._def.typeName===Ur.kY.ZodEnum?{...r,propertyNames:{enum:t.keyType._def.values}}:r}const Dd={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"},Pd=(t,e)=>{const r=(t.options instanceof Map?Array.from(t.options.values()):t.options).map(((t,r)=>Fd(t._def,{...e,currentPath:[...e.currentPath,"anyOf",`${r}`]}))).filter((t=>!!t&&(!e.strictUnions||"object"==typeof t&&Object.keys(t).length>0)));return r.length?{anyOf:r}:void 0};function Cd(t,e){return"strict"===e.removeAdditionalStrategy?"ZodNever"===t.catchall._def.typeName?"strict"!==t.unknownKeys:Fd(t.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0:"ZodNever"===t.catchall._def.typeName?"passthrough"===t.unknownKeys:Fd(t.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0}const Ld=Symbol("Let zodToJsonSchema decide on which parser to use"),Td={name:void 0,$refStrategy:"root",effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",nullableStrategy:"from-target",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"};function Fd(t,e,r=!1){const n=e.seen.get(t);if(e.override){const o=e.override?.(t,e,n,r);if(o!==Ld)return o}if(n&&!r){const t=Id(n,e);if(void 0!==t)return"$ref"in t&&e.seenRefs.add(t.$ref),t}const o={def:t,path:e.currentPath,jsonSchema:void 0};e.seen.set(t,o);const i=Rd(t,t.typeName,e,r);return i&&Md(t,e,i),o.jsonSchema=i,i}const Id=(t,e)=>{switch(e.$refStrategy){case"root":return{$ref:t.path.join("/")};case"extract-to-root":const r=t.path.slice(e.basePath.length+1).join("_");return r!==e.name&&"duplicate-ref"===e.nameStrategy&&(e.definitions[r]=t.def),{$ref:[...e.basePath,e.definitionPath,r].join("/")};case"relative":return{$ref:Nd(e.currentPath,t.path)};case"none":case"seen":return t.path.length<e.currentPath.length&&t.path.every(((t,r)=>e.currentPath[r]===t))?(console.warn(`Recursive reference detected at ${e.currentPath.join("/")}! Defaulting to any`),{}):"seen"===e.$refStrategy?{}:void 0}},Nd=(t,e)=>{let r=0;for(;r<t.length&&r<e.length&&t[r]===e[r];r++);return[(t.length-r).toString(),...e.slice(r)].join("/")},Rd=(t,e,r,n)=>{switch(e){case Ur.kY.ZodString:return Ed(t,r);case Ur.kY.ZodNumber:return function(t,e){const r={type:"number"};if(!t.checks)return r;for(const n of t.checks)switch(n.kind){case"int":r.type="integer",fd(r,"type",n.message,e);break;case"min":"jsonSchema7"===e.target?n.inclusive?pd(r,"minimum",n.value,n.message,e):pd(r,"exclusiveMinimum",n.value,n.message,e):(n.inclusive||(r.exclusiveMinimum=!0),pd(r,"minimum",n.value,n.message,e));break;case"max":"jsonSchema7"===e.target?n.inclusive?pd(r,"maximum",n.value,n.message,e):pd(r,"exclusiveMaximum",n.value,n.message,e):(n.inclusive||(r.exclusiveMaximum=!0),pd(r,"maximum",n.value,n.message,e));break;case"multipleOf":pd(r,"multipleOf",n.value,n.message,e)}return r}(t,r);case Ur.kY.ZodObject:return function(t,e){const r={type:"object",...Object.entries(t.shape()).reduce(((t,[r,n])=>{if(void 0===n||void 0===n._def)return t;const o=Fd(n._def,{...e,currentPath:[...e.currentPath,"properties",r],propertyPath:[...e.currentPath,"properties",r]});return void 0===o?t:{properties:{...t.properties,[r]:o},required:n.isOptional()&&!e.openaiStrictMode?t.required:[...t.required,r]}}),{properties:{},required:[]}),additionalProperties:Cd(t,e)};return r.required.length||delete r.required,r}(t,r);case Ur.kY.ZodBigInt:return function(t,e){const r={type:"integer",format:"int64"};if(!t.checks)return r;for(const n of t.checks)switch(n.kind){case"min":"jsonSchema7"===e.target?n.inclusive?pd(r,"minimum",n.value,n.message,e):pd(r,"exclusiveMinimum",n.value,n.message,e):(n.inclusive||(r.exclusiveMinimum=!0),pd(r,"minimum",n.value,n.message,e));break;case"max":"jsonSchema7"===e.target?n.inclusive?pd(r,"maximum",n.value,n.message,e):pd(r,"exclusiveMaximum",n.value,n.message,e):(n.inclusive||(r.exclusiveMaximum=!0),pd(r,"maximum",n.value,n.message,e));break;case"multipleOf":pd(r,"multipleOf",n.value,n.message,e)}return r}(t,r);case Ur.kY.ZodBoolean:return{type:"boolean"};case Ur.kY.ZodDate:return hd(t,r);case Ur.kY.ZodUndefined:return{not:{}};case Ur.kY.ZodNull:return function(t){return"openApi3"===t.target?{enum:["null"],nullable:!0}:{type:"null"}}(r);case Ur.kY.ZodArray:return function(t,e){const r={type:"array"};return t.type?._def?.typeName!==Ur.kY.ZodAny&&(r.items=Fd(t.type._def,{...e,currentPath:[...e.currentPath,"items"]})),t.minLength&&pd(r,"minItems",t.minLength.value,t.minLength.message,e),t.maxLength&&pd(r,"maxItems",t.maxLength.value,t.maxLength.message,e),t.exactLength&&(pd(r,"minItems",t.exactLength.value,t.exactLength.message,e),pd(r,"maxItems",t.exactLength.value,t.exactLength.message,e)),r}(t,r);case Ur.kY.ZodUnion:case Ur.kY.ZodDiscriminatedUnion:return function(t,e){if("openApi3"===e.target)return Pd(t,e);const r=t.options instanceof Map?Array.from(t.options.values()):t.options;if(r.every((t=>t._def.typeName in Dd&&(!t._def.checks||!t._def.checks.length)))){const t=r.reduce(((t,e)=>{const r=Dd[e._def.typeName];return r&&!t.includes(r)?[...t,r]:t}),[]);return{type:t.length>1?t:t[0]}}if(r.every((t=>"ZodLiteral"===t._def.typeName&&!t.description))){const t=r.reduce(((t,e)=>{const r=typeof e._def.value;switch(r){case"string":case"number":case"boolean":return[...t,r];case"bigint":return[...t,"integer"];case"object":if(null===e._def.value)return[...t,"null"];default:return t}}),[]);if(t.length===r.length){const e=t.filter(((t,e,r)=>r.indexOf(t)===e));return{type:e.length>1?e:e[0],enum:r.reduce(((t,e)=>t.includes(e._def.value)?t:[...t,e._def.value]),[])}}}else if(r.every((t=>"ZodEnum"===t._def.typeName)))return{type:"string",enum:r.reduce(((t,e)=>[...t,...e._def.values.filter((e=>!t.includes(e)))]),[])};return Pd(t,e)}(t,r);case Ur.kY.ZodIntersection:return function(t,e){const r=[Fd(t.left._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),Fd(t.right._def,{...e,currentPath:[...e.currentPath,"allOf","1"]})].filter((t=>!!t));let n="jsonSchema2019-09"===e.target?{unevaluatedProperties:!1}:void 0;const o=[];return r.forEach((t=>{if("type"in(e=t)&&"string"===e.type||!("allOf"in e)){let e=t;if("additionalProperties"in t&&!1===t.additionalProperties){const{additionalProperties:r,...n}=t;e=n}else n=void 0;o.push(e)}else o.push(...t.allOf),void 0===t.unevaluatedProperties&&(n=void 0);var e})),o.length?{allOf:o,...n}:void 0}(t,r);case Ur.kY.ZodTuple:return function(t,e){return t.rest?{type:"array",minItems:t.items.length,items:t.items.map(((t,r)=>Fd(t._def,{...e,currentPath:[...e.currentPath,"items",`${r}`]}))).reduce(((t,e)=>void 0===e?t:[...t,e]),[]),additionalItems:Fd(t.rest._def,{...e,currentPath:[...e.currentPath,"additionalItems"]})}:{type:"array",minItems:t.items.length,maxItems:t.items.length,items:t.items.map(((t,r)=>Fd(t._def,{...e,currentPath:[...e.currentPath,"items",`${r}`]}))).reduce(((t,e)=>void 0===e?t:[...t,e]),[])}}(t,r);case Ur.kY.ZodRecord:return Ad(t,r);case Ur.kY.ZodLiteral:return function(t,e){const r=typeof t.value;return"bigint"!==r&&"number"!==r&&"boolean"!==r&&"string"!==r?{type:Array.isArray(t.value)?"array":"object"}:"openApi3"===e.target?{type:"bigint"===r?"integer":r,enum:[t.value]}:{type:"bigint"===r?"integer":r,const:t.value}}(t,r);case Ur.kY.ZodEnum:return function(t){return{type:"string",enum:[...t.values]}}(t);case Ur.kY.ZodNativeEnum:return function(t){const e=t.values,r=Object.keys(t.values).filter((t=>"number"!=typeof e[e[t]])).map((t=>e[t])),n=Array.from(new Set(r.map((t=>typeof t))));return{type:1===n.length?"string"===n[0]?"string":"number":["string","number"],enum:r}}(t);case Ur.kY.ZodNullable:return function(t,e){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(t.innerType._def.typeName)&&(!t.innerType._def.checks||!t.innerType._def.checks.length))return"openApi3"===e.target||"property"===e.nullableStrategy?{type:Dd[t.innerType._def.typeName],nullable:!0}:{type:[Dd[t.innerType._def.typeName],"null"]};if("openApi3"===e.target){const r=Fd(t.innerType._def,{...e,currentPath:[...e.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}const r=Fd(t.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","0"]});return r&&{anyOf:[r,{type:"null"}]}}(t,r);case Ur.kY.ZodOptional:return((t,e)=>{if(e.currentPath.toString()===e.propertyPath?.toString())return Fd(t.innerType._def,e);const r=Fd(t.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","1"]});return r?{anyOf:[{not:{}},r]}:{}})(t,r);case Ur.kY.ZodMap:return function(t,e){return"record"===e.mapStrategy?Ad(t,e):{type:"array",maxItems:125,items:{type:"array",items:[Fd(t.keyType._def,{...e,currentPath:[...e.currentPath,"items","items","0"]})||{},Fd(t.valueType._def,{...e,currentPath:[...e.currentPath,"items","items","1"]})||{}],minItems:2,maxItems:2}}}(t,r);case Ur.kY.ZodSet:return function(t,e){const r={type:"array",uniqueItems:!0,items:Fd(t.valueType._def,{...e,currentPath:[...e.currentPath,"items"]})};return t.minSize&&pd(r,"minItems",t.minSize.value,t.minSize.message,e),t.maxSize&&pd(r,"maxItems",t.maxSize.value,t.maxSize.message,e),r}(t,r);case Ur.kY.ZodLazy:return Fd(t.getter()._def,r);case Ur.kY.ZodPromise:return function(t,e){return Fd(t.type._def,e)}(t,r);case Ur.kY.ZodNaN:case Ur.kY.ZodNever:return{not:{}};case Ur.kY.ZodEffects:return function(t,e,r){return"input"===e.effectStrategy?Fd(t.schema._def,e,r):{}}(t,r,n);case Ur.kY.ZodAny:case Ur.kY.ZodUnknown:return{};case Ur.kY.ZodDefault:return function(t,e){return{...Fd(t.innerType._def,e),default:t.defaultValue()}}(t,r);case Ur.kY.ZodBranded:return function(t,e){return Fd(t.type._def,e)}(t,r);case Ur.kY.ZodReadonly:case Ur.kY.ZodCatch:return((t,e)=>Fd(t.innerType._def,e))(t,r);case Ur.kY.ZodPipeline:return((t,e)=>{if("input"===e.pipeStrategy)return Fd(t.in._def,e);if("output"===e.pipeStrategy)return Fd(t.out._def,e);const r=Fd(t.in._def,{...e,currentPath:[...e.currentPath,"allOf","0"]});return{allOf:[r,Fd(t.out._def,{...e,currentPath:[...e.currentPath,"allOf",r?"1":"0"]})].filter((t=>void 0!==t))}})(t,r);case Ur.kY.ZodFunction:case Ur.kY.ZodVoid:case Ur.kY.ZodSymbol:default:return}},Md=(t,e,r)=>(t.description&&(r.description=t.description,e.markdownDescription&&(r.markdownDescription=t.description)),r),Bd=t=>"_def"in t?t._def:t;function Gd(t,e){return((t,e)=>{const r=(t=>{const e=(t=>"string"==typeof t?{...Td,basePath:["#"],definitions:{},name:t}:{...Td,basePath:["#"],definitions:{},...t})(t),r=void 0!==e.name?[...e.basePath,e.definitionPath,e.name]:e.basePath;return{...e,currentPath:r,propertyPath:void 0,seenRefs:new Set,seen:new Map(Object.entries(e.definitions).map((([t,r])=>[Bd(r),{def:Bd(r),path:[...e.basePath,e.definitionPath,t],jsonSchema:void 0}])))}})(e),n="title"===e?.nameStrategy?void 0:e?.name,o=Fd(t._def,void 0===n?r:{...r,currentPath:[...r.basePath,r.definitionPath,n]},!1)??{},i=void 0!==e.name&&"title"===e.nameStrategy?e.name:void 0;void 0!==i&&(o.title=i);const a=(()=>{if(function(t){if(!t)return!0;for(const e in t)return!1;return!0}(r.definitions))return;const t={},e=new Set;for(let n=0;n<500;n++){const n=Object.entries(r.definitions).filter((([t])=>!e.has(t)));if(0===n.length)break;for(const[o,i]of n)t[o]=Fd(Bd(i),{...r,currentPath:[...r.basePath,r.definitionPath,o]},!0)??{},e.add(o)}return t})(),u=void 0===n?a?{...o,[r.definitionPath]:a}:o:"duplicate-ref"===r.nameStrategy?{...o,...a||r.seenRefs.size?{[r.definitionPath]:{...a,...r.seenRefs.size?{[n]:o}:void 0}}:void 0}:{$ref:[..."relative"===r.$refStrategy?[]:r.basePath,r.definitionPath,n].join("/"),[r.definitionPath]:{...a,[n]:o}};return"jsonSchema7"===r.target?u.$schema="http://json-schema.org/draft-07/schema#":"jsonSchema2019-09"===r.target&&(u.$schema="https://json-schema.org/draft/2019-09/schema#"),u})(t,{openaiStrictMode:!0,name:e.name,nameStrategy:"duplicate-ref",$refStrategy:"extract-to-root",nullableStrategy:"property"})}function Ud(t,e,r){return function(e){const r={...e};return Object.defineProperties(r,{$brand:{value:"auto-parseable-response-format",enumerable:!1},$parseRaw:{value:e=>t.parse(JSON.parse(e)),enumerable:!1}}),r}({type:"json_schema",json_schema:{...r,name:e,strict:!0,schema:Gd(t,{name:e})}})}function zd(t){var e;return t.constructor.name===Rc.name?(e=new Error(t.message)).name="TimeoutError":t.constructor.name===Ic.name?(e=new Error(t.message)).name="AbortError":e=t,e}function $d(t,e){if(t){if("string"==typeof t)return qd(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?qd(t,e):void 0}}function qd(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Kd(t){var e,r=["namespace functions {",""],n=function(t){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=$d(t))){e&&(t=e);var r=0,n=function(){};return{s:n,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,a=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return i=t.done,t},e:function(t){a=!0,o=t},f:function(){try{i||null==e.return||e.return()}finally{if(a)throw o}}}}(t);try{for(n.s();!(e=n.n()).done;){var o,i=e.value;i.description&&r.push("// ".concat(i.description)),Object.keys(null!==(o=i.parameters.properties)&&void 0!==o?o:{}).length>0?(r.push("type ".concat(i.name," = (_: {")),r.push(Hd(i.parameters,0)),r.push("}) => any;")):r.push("type ".concat(i.name," = () => any;")),r.push("")}}catch(t){n.e(t)}finally{n.f()}return r.push("} // namespace functions"),r.join("\n")}function Hd(t,e){for(var r=[],n=0,o=Object.entries(null!==(i=t.properties)&&void 0!==i?i:{});n<o.length;n++){var i,a,u=(l=o[n],f=2,function(t){if(Array.isArray(t))return t}(l)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],s=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);s=!0);}catch(t){c=!0,o=t}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(l,f)||$d(l,f)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),s=u[0],c=u[1];c.description&&e<2&&r.push("// ".concat(c.description)),null!==(a=t.required)&&void 0!==a&&a.includes(s)?r.push("".concat(s,": ").concat(Zd(c,e),",")):r.push("".concat(s,"?: ").concat(Zd(c,e),","))}var l,f;return r.map((function(t){return" ".repeat(e)+t})).join("\n")}function Zd(t,e){if(void 0!==(r=t).anyOf&&Array.isArray(r.anyOf))return t.anyOf.map((function(t){return Zd(t,e)})).join(" | ");var r;switch(t.type){case"string":return t.enum?t.enum.map((function(t){return'"'.concat(t,'"')})).join(" | "):"string";case"number":case"integer":return t.enum?t.enum.map((function(t){return"".concat(t)})).join(" | "):"number";case"boolean":return"boolean";case"null":return"null";case"object":return["{",Hd(t,e+2),"}"].join("\n");case"array":return t.items?"".concat(Zd(t.items,e),"[]"):"any[]";default:return""}}function Yd(t){return Yd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yd(t)}function Vd(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Wd(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Vd(Object(r),!0).forEach((function(e){Jd(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Vd(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Jd(t,e,r){return(e=function(t){var e=function(t){if("object"!=Yd(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Yd(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Yd(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Xd(t){return Xd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xd(t)}function Qd(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],s=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);s=!0);}catch(t){c=!0,o=t}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(t,e)||hy(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ty(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function ey(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){ty(i,n,o,a,u,"next",t)}function u(t){ty(i,n,o,a,u,"throw",t)}a(void 0)}))}}function ry(){ry=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new P(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function b(){}function g(){}var w={};c(w,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(w=_);var E=g.prototype=m.prototype=Object.create(w);function O(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,i,a,u){var s=f(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==Xd(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=S(u,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?y:h,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=y,n.method="throw",n.arg=c.arg)}}}function S(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,S(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function C(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(Xd(e)+" is not iterable")}return b.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=c(g,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,c(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},O(k.prototype),c(k.prototype,u,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(E),c(E,s,"Generator"),c(E,a,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=C,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),D(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;D(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:C(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function ny(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,fy(n.key),n)}}function oy(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(oy=function(){return!!t})()}function iy(t,e){return iy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},iy(t,e)}function ay(){return ay="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=uy(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},ay.apply(null,arguments)}function uy(t){return uy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},uy(t)}function sy(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function cy(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?sy(Object(r),!0).forEach((function(e){ly(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):sy(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function ly(t,e,r){return(e=fy(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function fy(t){var e=function(t){if("object"!=Xd(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Xd(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Xd(e)?e:e+""}function py(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=hy(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}function hy(t,e){if(t){if("string"==typeof t)return dy(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?dy(t,e):void 0}}function dy(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function yy(t){return new my(t,0)}function vy(t){var e,r;function n(e,r){try{var i=t[e](r),a=i.value,u=a instanceof my;Promise.resolve(u?a.v:a).then((function(r){if(u){var s="return"===e?"return":"next";if(!a.k||r.done)return n(s,r);r=t[s](r).value}o(i.done?"return":"normal",r)}),(function(t){n("throw",t)}))}catch(t){o("throw",t)}}function o(t,o){switch(t){case"return":e.resolve({value:o,done:!0});break;case"throw":e.reject(o);break;default:e.resolve({value:o,done:!1})}(e=e.next)?n(e.key,e.arg):r=null}this._invoke=function(t,o){return new Promise((function(i,a){var u={key:t,arg:o,resolve:i,reject:a,next:null};r?r=r.next=u:(e=r=u,n(t,o))}))},"function"!=typeof t.return&&(this.return=void 0)}function my(t,e){this.v=t,this.k=e}function by(t){var e,r,n,o=2;for("undefined"!=typeof Symbol&&(r=Symbol.asyncIterator,n=Symbol.iterator);o--;){if(r&&null!=(e=t[r]))return e.call(t);if(n&&null!=(e=t[n]))return new gy(e.call(t));r="@@asyncIterator",n="@@iterator"}throw new TypeError("Object is not async iterable")}function gy(t){function e(t){if(Object(t)!==t)return Promise.reject(new TypeError(t+" is not an object."));var e=t.done;return Promise.resolve(t.value).then((function(t){return{value:t,done:e}}))}return gy=function(t){this.s=t,this.n=t.next},gy.prototype={s:null,n:null,next:function(){return e(this.n.apply(this.s,arguments))},return:function(t){var r=this.s.return;return void 0===r?Promise.resolve({value:t,done:!0}):e(r.apply(this.s,arguments))},throw:function(t){var r=this.s.return;return void 0===r?Promise.reject(t):e(r.apply(this.s,arguments))}},new gy(t)}function wy(t){var e=t._getType();switch(e){case"system":return"system";case"ai":return"assistant";case"human":return"user";case"function":return"function";case"tool":return"tool";case"generic":if(!to.cM.isInstance(t))throw new Error("Invalid generic chat message");return function(t){return"system"!==t.role&&"assistant"!==t.role&&"user"!==t.role&&"function"!==t.role&&"tool"!==t.role&&console.warn("Unknown message role: ".concat(t.role)),t.role}(t);default:throw new Error("Unknown message type: ".concat(e))}}function xy(t,e,r){var n,o=t.tool_calls;if("assistant"===t.role){var i,a=[],u=[],s=py(null!=o?o:[]);try{for(s.s();!(i=s.n()).done;){var c=i.value;try{a.push(ud(c,{returnId:!0}))}catch(t){u.push(cd(c,t.message))}}}catch(t){s.e(t)}finally{s.f()}var l,f={function_call:t.function_call,tool_calls:o};return void 0!==r&&(f.__raw_response=e),e.system_fingerprint&&(l={system_fingerprint:e.system_fingerprint}),new to.Od({content:t.content||"",tool_calls:a,invalid_tool_calls:u,additional_kwargs:f,response_metadata:l,id:e.id})}return new to.cM(t.content||"",null!==(n=t.role)&&void 0!==n?n:"unknown")}function _y(t,e,r,n){var o,i,a,u=null!==(o=t.role)&&void 0!==o?o:r,s=null!==(i=t.content)&&void 0!==i?i:"";if(a=t.function_call?{function_call:t.function_call}:t.tool_calls?{tool_calls:t.tool_calls}:{},n&&(a.__raw_response=e),"user"===u)return new to.a7({content:s});if("assistant"===u){var c=[];if(Array.isArray(t.tool_calls)){var l,f=py(t.tool_calls);try{for(f.s();!(l=f.n()).done;){var p,h,d=l.value;c.push({name:null===(p=d.function)||void 0===p?void 0:p.name,args:null===(h=d.function)||void 0===h?void 0:h.arguments,id:d.id,index:d.index,type:"tool_call_chunk"})}}catch(t){f.e(t)}finally{f.f()}}return new to.H({content:s,tool_call_chunks:c,additional_kwargs:a,id:e.id})}return"system"===u?new to.uU({content:s}):"function"===u?new to.FK({content:s,additional_kwargs:a,name:t.name}):"tool"===u?new to.dr({content:s,additional_kwargs:a,tool_call_id:t.tool_call_id}):new to.XU({content:s,role:u})}function Ey(t){return t.map((function(t){var e,r={role:wy(t),content:t.content};return null!=t.name&&(r.name=t.name),null!=t.additional_kwargs.function_call&&(r.function_call=t.additional_kwargs.function_call,r.content=null),(0,to.KX)(t)&&null!==(e=t.tool_calls)&&void 0!==e&&e.length?(r.tool_calls=t.tool_calls.map(sd),r.content=null):(null!=t.additional_kwargs.tool_calls&&(r.tool_calls=t.additional_kwargs.tool_calls),null!=t.tool_call_id&&(r.tool_call_id=t.tool_call_id)),r}))}function Oy(t,e){return(0,Bo.VC)(t)?void 0!==(null==e?void 0:e.strict)?cy(cy({},t),{},{function:cy(cy({},t.function),{},{strict:e.strict})}):t:function(t,e){var r,n;if(Ko(t)){var o=function(t,{parser:e,callback:r}){const n={...t};return Object.defineProperties(n,{$brand:{value:"auto-parseable-tool",enumerable:!1},$parseRaw:{value:e,enumerable:!1},$callback:{value:r,enumerable:!1}}),n}({type:"function",function:{name:(n={name:t.name,parameters:t.schema,description:t.description}).name,parameters:Gd(n.parameters,{name:n.name}),strict:!0,...n.description?{description:n.description}:void 0}},{callback:n.function,parser:t=>n.parameters.parse(JSON.parse(t))});r=o.function.parameters?{type:o.type,function:Wd({name:o.function.name,description:o.function.description,parameters:o.function.parameters},void 0!==(null==e?void 0:e.strict)?{strict:e.strict}:{})}:{type:"function",function:qo(t,e)}}else r=t;return void 0!==(null==e?void 0:e.strict)&&(r.function.strict=e.strict),r}(t,e)}vy.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},vy.prototype.next=function(t){return this._invoke("next",t)},vy.prototype.throw=function(t){return this._invoke("throw",t)},vy.prototype.return=function(t){return this._invoke("return",t)};var ky=function(t){function e(t,r){var n,o,i,a,u,s,c,l,f,p,h,d,y,v,m,b,g,w,x,_,E,O,k,j,S,A,D,P,C,L,T,F,I;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),I=function(t,e,r){return e=uy(e),function(t,e){if(e&&("object"==Xd(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,oy()?Reflect.construct(e,r||[],uy(t).constructor):e.apply(t,r))}(this,e,[null!=t?t:{}]),Object.defineProperty(I,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(I,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(I,"topP",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(I,"frequencyPenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(I,"presencePenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(I,"n",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(I,"logitBias",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(I,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"gpt-3.5-turbo"}),Object.defineProperty(I,"model",{enumerable:!0,configurable:!0,writable:!0,value:"gpt-3.5-turbo"}),Object.defineProperty(I,"modelKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(I,"stop",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(I,"stopSequences",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(I,"user",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(I,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(I,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(I,"streamUsage",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(I,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(I,"logprobs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(I,"topLogprobs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(I,"openAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(I,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(I,"azureOpenAIApiVersion",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(I,"azureOpenAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(I,"azureADTokenProvider",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(I,"azureOpenAIApiInstanceName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(I,"azureOpenAIApiDeploymentName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(I,"azureOpenAIBasePath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(I,"organization",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(I,"__includeRawResponse",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(I,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(I,"clientConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(I,"supportsStrictToolCalling",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),I.openAIApiKey=null!==(n=null!==(o=null!==(i=null==t?void 0:t.apiKey)&&void 0!==i?i:null==t?void 0:t.openAIApiKey)&&void 0!==o?o:null==t||null===(a=t.configuration)||void 0===a?void 0:a.apiKey)&&void 0!==n?n:(0,ah.Az)("OPENAI_API_KEY"),I.apiKey=I.openAIApiKey,I.azureOpenAIApiKey=null!==(u=null==t?void 0:t.azureOpenAIApiKey)&&void 0!==u?u:(0,ah.Az)("AZURE_OPENAI_API_KEY"),I.azureADTokenProvider=null!==(s=null==t?void 0:t.azureADTokenProvider)&&void 0!==s?s:void 0,!I.azureOpenAIApiKey&&!I.apiKey&&!I.azureADTokenProvider)throw new Error("OpenAI or Azure OpenAI API key or Token Provider not found");if(I.azureOpenAIApiInstanceName=null!==(c=null==t?void 0:t.azureOpenAIApiInstanceName)&&void 0!==c?c:(0,ah.Az)("AZURE_OPENAI_API_INSTANCE_NAME"),I.azureOpenAIApiDeploymentName=null!==(l=null==t?void 0:t.azureOpenAIApiDeploymentName)&&void 0!==l?l:(0,ah.Az)("AZURE_OPENAI_API_DEPLOYMENT_NAME"),I.azureOpenAIApiVersion=null!==(f=null==t?void 0:t.azureOpenAIApiVersion)&&void 0!==f?f:(0,ah.Az)("AZURE_OPENAI_API_VERSION"),I.azureOpenAIBasePath=null!==(p=null==t?void 0:t.azureOpenAIBasePath)&&void 0!==p?p:(0,ah.Az)("AZURE_OPENAI_BASE_PATH"),I.organization=null!==(h=null==t||null===(d=t.configuration)||void 0===d?void 0:d.organization)&&void 0!==h?h:(0,ah.Az)("OPENAI_ORGANIZATION"),I.modelName=null!==(y=null!==(v=null==t?void 0:t.model)&&void 0!==v?v:null==t?void 0:t.modelName)&&void 0!==y?y:I.model,I.model=I.modelName,I.modelKwargs=null!==(m=null==t?void 0:t.modelKwargs)&&void 0!==m?m:{},I.timeout=null==t?void 0:t.timeout,I.temperature=null!==(b=null==t?void 0:t.temperature)&&void 0!==b?b:I.temperature,I.topP=null!==(g=null==t?void 0:t.topP)&&void 0!==g?g:I.topP,I.frequencyPenalty=null!==(w=null==t?void 0:t.frequencyPenalty)&&void 0!==w?w:I.frequencyPenalty,I.presencePenalty=null!==(x=null==t?void 0:t.presencePenalty)&&void 0!==x?x:I.presencePenalty,I.maxTokens=null==t?void 0:t.maxTokens,I.logprobs=null==t?void 0:t.logprobs,I.topLogprobs=null==t?void 0:t.topLogprobs,I.n=null!==(_=null==t?void 0:t.n)&&void 0!==_?_:I.n,I.logitBias=null==t?void 0:t.logitBias,I.stop=null!==(E=null==t?void 0:t.stopSequences)&&void 0!==E?E:null==t?void 0:t.stop,I.stopSequences=null===(O=I)||void 0===O?void 0:O.stop,I.user=null==t?void 0:t.user,I.__includeRawResponse=null==t?void 0:t.__includeRawResponse,I.azureOpenAIApiKey||I.azureADTokenProvider){var N;if(!I.azureOpenAIApiInstanceName&&!I.azureOpenAIBasePath)throw new Error("Azure OpenAI API instance name not found");if(!I.azureOpenAIApiDeploymentName)throw new Error("Azure OpenAI API deployment name not found");if(!I.azureOpenAIApiVersion)throw new Error("Azure OpenAI API version not found");I.apiKey=null!==(N=I.apiKey)&&void 0!==N?N:"",I.streamUsage=!1}return I.streaming=null!==(k=null==t?void 0:t.streaming)&&void 0!==k&&k,I.streamUsage=null!==(j=null==t?void 0:t.streamUsage)&&void 0!==j?j:I.streamUsage,I.clientConfig=cy(cy({apiKey:I.apiKey,organization:I.organization,baseURL:null!==(S=null==r?void 0:r.basePath)&&void 0!==S?S:null==t||null===(A=t.configuration)||void 0===A?void 0:A.basePath,dangerouslyAllowBrowser:!0,defaultHeaders:null!==(D=null==r||null===(P=r.baseOptions)||void 0===P?void 0:P.headers)&&void 0!==D?D:null==t||null===(C=t.configuration)||void 0===C||null===(C=C.baseOptions)||void 0===C?void 0:C.headers,defaultQuery:null!==(L=null==r||null===(T=r.baseOptions)||void 0===T?void 0:T.params)&&void 0!==L?L:null==t||null===(F=t.configuration)||void 0===F||null===(F=F.baseOptions)||void 0===F?void 0:F.params},r),null==t?void 0:t.configuration),void 0!==(null==t?void 0:t.supportsStrictToolCalling)&&(I.supportsStrictToolCalling=t.supportsStrictToolCalling),I}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&iy(t,e)}(e,t),r=e,n=[{key:"callKeys",get:function(){return[].concat(function(t){return function(t){if(Array.isArray(t))return dy(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||hy(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(function(t,e,r){var n=ay(uy(t.prototype),"callKeys",r);return n}(e,0,this)),["options","function_call","functions","tools","tool_choice","promptIndex","response_format","seed"])}},{key:"lc_secrets",get:function(){return{openAIApiKey:"OPENAI_API_KEY",apiKey:"OPENAI_API_KEY",azureOpenAIApiKey:"AZURE_OPENAI_API_KEY",organization:"OPENAI_ORGANIZATION"}}},{key:"lc_aliases",get:function(){return{modelName:"model",openAIApiKey:"openai_api_key",apiKey:"openai_api_key",azureOpenAIApiVersion:"azure_openai_api_version",azureOpenAIApiKey:"azure_openai_api_key",azureOpenAIApiInstanceName:"azure_openai_api_instance_name",azureOpenAIApiDeploymentName:"azure_openai_api_deployment_name"}}},{key:"getLsParams",value:function(t){var e,r,n=this.invocationParams(t);return{ls_provider:"openai",ls_model_name:this.model,ls_model_type:"chat",ls_temperature:null!==(e=n.temperature)&&void 0!==e?e:void 0,ls_max_tokens:null!==(r=n.max_tokens)&&void 0!==r?r:void 0,ls_stop:t.stop}}},{key:"bindTools",value:function(t,e){var r;return void 0!==(null==e?void 0:e.strict)?r=e.strict:void 0!==this.supportsStrictToolCalling&&(r=this.supportsStrictToolCalling),this.bind(cy({tools:t.map((function(t){return Oy(t,{strict:r})}))},e))}},{key:"createResponseFormat",value:function(t){return t&&"json_schema"===t.type&&t.json_schema.schema&&jy(t.json_schema.schema)?Ud(t.json_schema.schema,t.json_schema.name,{description:t.json_schema.description}):t}},{key:"invocationParams",value:function(t,e){var r,n,o;void 0!==(null==t?void 0:t.strict)?o=t.strict:void 0!==this.supportsStrictToolCalling&&(o=this.supportsStrictToolCalling);var i={};void 0!==(null==t?void 0:t.stream_options)?i={stream_options:t.stream_options}:this.streamUsage&&(this.streaming||null!=e&&e.streaming)&&(i={stream_options:{include_usage:!0}});var a,u=cy(cy({model:this.model,temperature:this.temperature,top_p:this.topP,frequency_penalty:this.frequencyPenalty,presence_penalty:this.presencePenalty,max_tokens:-1===this.maxTokens?void 0:this.maxTokens,logprobs:this.logprobs,top_logprobs:this.topLogprobs,n:this.n,logit_bias:this.logitBias,stop:null!==(r=null==t?void 0:t.stop)&&void 0!==r?r:this.stopSequences,user:this.user,stream:this.streaming,functions:null==t?void 0:t.functions,function_call:null==t?void 0:t.function_call,tools:null!=t&&null!==(n=t.tools)&&void 0!==n&&n.length?t.tools.map((function(t){return Oy(t,{strict:o})})):void 0,tool_choice:(a=null==t?void 0:t.tool_choice,a?"any"===a||"required"===a?"required":"auto"===a?"auto":"none"===a?"none":"string"==typeof a?{type:"function",function:{name:a}}:a:void 0),response_format:this.createResponseFormat(null==t?void 0:t.response_format),seed:null==t?void 0:t.seed},i),{},{parallel_tool_calls:null==t?void 0:t.parallel_tool_calls},this.modelKwargs);return u}},{key:"_identifyingParams",value:function(){return cy(cy({model_name:this.model},this.invocationParams()),this.clientConfig)}},{key:"_streamResponseChunks",value:function(t,e,r){var n,o=this;return(n=ry().mark((function n(){var i,a,u,s,c,l,f,p,h,d,y,v,m,b,g,w,x,_,E,O,k,j,S,A,D,P,C,L;return ry().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!o.model.includes("o1-")){n.next=9;break}return console.warn("[WARNING]: OpenAI o1 models do not yet support token-level streaming. Streaming will yield single chunk."),n.next=4,yy(o._generate(t,e,r));case 4:return a=n.sent,u=(0,to.ih)(a.generations[0].message),n.next=8,new ih.Cf({message:u,text:"string"==typeof u.content?u.content:""});case 8:return n.abrupt("return");case 9:if(s=Ey(t),!(c=cy(cy({},o.invocationParams(e,{streaming:!0})),{},{messages:s,stream:!0})).response_format||"json_schema"!==c.response_format.type){n.next=20;break}return console.warn('OpenAI does not yet support streaming with "response_format" set to "json_schema". Falling back to non-streaming mode.'),n.next=15,yy(o._generate(t,e,r));case 15:return p=n.sent,h=new ih.Cf({message:new to.H(cy({},p.generations[0].message)),text:p.generations[0].text,generationInfo:p.generations[0].generationInfo}),n.next=19,h;case 19:return n.abrupt("return",null==r?void 0:r.handleLLMNewToken(null!==(f=p.generations[0].text)&&void 0!==f?f:"",void 0,void 0,void 0,void 0,{chunk:h}));case 20:return n.next=22,yy(o.completionWithRetry(c,e));case 22:d=n.sent,v=!1,m=!1,n.prev=25,g=by(d);case 27:return n.next=29,yy(g.next());case 29:if(!(v=!(w=n.sent).done)){n.next=55;break}if(x=w.value,j=null==x?void 0:x.choices[0],x.usage&&(y=x.usage),j){n.next=35;break}return n.abrupt("continue",52);case 35:if(S=j.delta){n.next=38;break}return n.abrupt("continue",52);case 38:if(A=_y(S,x,l,o.__includeRawResponse),l=null!==(_=S.role)&&void 0!==_?_:l,D={prompt:null!==(E=e.promptIndex)&&void 0!==E?E:0,completion:null!==(O=j.index)&&void 0!==O?O:0},"string"==typeof A.content){n.next=44;break}return console.log("[WARNING]: Received non-string content from OpenAI. This is currently not supported."),n.abrupt("continue",52);case 44:return P=cy({},D),null!=j.finish_reason&&(P.finish_reason=j.finish_reason,P.system_fingerprint=x.system_fingerprint),o.logprobs&&(P.logprobs=j.logprobs),C=new ih.Cf({message:A,text:A.content,generationInfo:P}),n.next=50,C;case 50:return n.next=52,yy(null==r?void 0:r.handleLLMNewToken(null!==(k=C.text)&&void 0!==k?k:"",D,void 0,void 0,void 0,{chunk:C}));case 52:v=!1,n.next=27;break;case 55:n.next=61;break;case 57:n.prev=57,n.t0=n.catch(25),m=!0,b=n.t0;case 61:if(n.prev=61,n.prev=62,!v||null==g.return){n.next=66;break}return n.next=66,yy(g.return());case 66:if(n.prev=66,!m){n.next=69;break}throw b;case 69:return n.finish(66);case 70:return n.finish(61);case 71:if(!y){n.next=75;break}return L=new ih.Cf({message:new to.H({content:"",usage_metadata:{input_tokens:y.prompt_tokens,output_tokens:y.completion_tokens,total_tokens:y.total_tokens}}),text:""}),n.next=75,L;case 75:if(null===(i=e.signal)||void 0===i||!i.aborted){n.next=77;break}throw new Error("AbortError");case 77:case"end":return n.stop()}}),n,null,[[25,57,61,71],[62,,66,70]])})),function(){return new vy(n.apply(this,arguments))})()}},{key:"identifyingParams",value:function(){return this._identifyingParams()}},{key:"_generate",value:(l=ey(ry().mark((function t(e,r,n){var o,i,a,u,s,c,l,f,p,h,d,y,v,m,b,g,w,x,_,E,O,k,j,S,A,D,P,C,L,T,F,I,N,R,M,B,G,U,z,$,q,K,H,Z;return ry().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o={},i=this.invocationParams(r),a=Ey(e),!i.stream){t.next=50;break}u=this._streamResponseChunks(e,r,n),s={},c=!1,l=!1,t.prev=8,p=by(u);case 10:return t.next=12,p.next();case 12:if(!(c=!(h=t.sent).done)){t.next=20;break}(d=h.value).message.response_metadata=cy(cy({},d.generationInfo),d.message.response_metadata),m=null!==(y=null===(v=d.generationInfo)||void 0===v?void 0:v.completion)&&void 0!==y?y:0,void 0===s[m]?s[m]=d:s[m]=s[m].concat(d);case 17:c=!1,t.next=10;break;case 20:t.next=26;break;case 22:t.prev=22,t.t0=t.catch(8),l=!0,f=t.t0;case 26:if(t.prev=26,t.prev=27,!c||null==p.return){t.next=31;break}return t.next=31,p.return();case 31:if(t.prev=31,!l){t.next=34;break}throw f;case 34:return t.finish(31);case 35:return t.finish(26);case 36:return b=Object.entries(s).sort((function(t,e){var r=Qd(t,1)[0],n=Qd(e,1)[0];return parseInt(r,10)-parseInt(n,10)})).map((function(t){var e=Qd(t,2);return e[0],e[1]})),g=this.invocationParams(r),w=g.functions,x=g.function_call,t.next=40,this.getEstimatedTokenCountFromPrompt(e,w,x);case 40:return _=t.sent,t.next=43,this.getNumTokensFromGenerations(b);case 43:return E=t.sent,o.promptTokens=_,o.completionTokens=E,o.totalTokens=_+E,t.abrupt("return",{generations:b,llmOutput:{estimatedTokenUsage:o}});case 50:if(!r.response_format||"json_schema"!==r.response_format.type){t.next=56;break}return t.next=53,this.betaParsedCompletionWithRetry(cy(cy({},i),{},{stream:!1,messages:a}),cy({signal:null==r?void 0:r.signal},null==r?void 0:r.options));case 53:A=t.sent,t.next=59;break;case 56:return t.next=58,this.completionWithRetry(cy(cy({},i),{},{stream:!1,messages:a}),cy({signal:null==r?void 0:r.signal},null==r?void 0:r.options));case 58:A=t.sent;case 59:D=null!==(O=null===(k=A)||void 0===k?void 0:k.usage)&&void 0!==O?O:{},P=D.completion_tokens,C=D.prompt_tokens,L=D.total_tokens,P&&(o.completionTokens=(null!==(T=o.completionTokens)&&void 0!==T?T:0)+P),C&&(o.promptTokens=(null!==(F=o.promptTokens)&&void 0!==F?F:0)+C),L&&(o.totalTokens=(null!==(I=o.totalTokens)&&void 0!==I?I:0)+L),N=[],R=py(null!==(j=null===(S=A)||void 0===S?void 0:S.choices)&&void 0!==j?j:[]);try{for(R.s();!(M=R.n()).done;)z=M.value,$=null!==(B=null===(G=z.message)||void 0===G?void 0:G.content)&&void 0!==B?B:"",(q={text:$,message:xy(null!==(U=z.message)&&void 0!==U?U:{role:"assistant"},A,this.__includeRawResponse)}).generationInfo=cy(cy({},z.finish_reason?{finish_reason:z.finish_reason}:{}),z.logprobs?{logprobs:z.logprobs}:{}),(0,to.KX)(q.message)&&(q.message.usage_metadata={input_tokens:null!==(K=o.promptTokens)&&void 0!==K?K:0,output_tokens:null!==(H=o.completionTokens)&&void 0!==H?H:0,total_tokens:null!==(Z=o.totalTokens)&&void 0!==Z?Z:0}),N.push(q)}catch(t){R.e(t)}finally{R.f()}return t.abrupt("return",{generations:N,llmOutput:{tokenUsage:o}});case 67:case"end":return t.stop()}}),t,this,[[8,22,26,36],[27,,31,35]])}))),function(t,e,r){return l.apply(this,arguments)})},{key:"getEstimatedTokenCountFromPrompt",value:(c=ey(ry().mark((function t(e,r,n){var o,i;return ry().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getNumTokensFromMessages(e);case 2:if(o=t.sent.totalCount,!r||"auto"===n){t.next=10;break}return i=Kd(r),t.t0=o,t.next=8,this.getNumTokens(i);case 8:o=t.t0+=t.sent,o+=9;case 10:if(r&&e.find((function(t){return"system"===t._getType()}))&&(o-=4),"none"!==n){t.next=15;break}o+=1,t.next=21;break;case 15:if("object"!==Xd(n)){t.next=21;break}return t.t1=o,t.next=19,this.getNumTokens(n.name);case 19:t.t2=t.sent,o=t.t1+=t.t2+4;case 21:return t.abrupt("return",o);case 22:case"end":return t.stop()}}),t,this)}))),function(t,e,r){return c.apply(this,arguments)})},{key:"getNumTokensFromGenerations",value:(s=ey(ry().mark((function t(e){var r,n=this;return ry().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(e.map(function(){var t=ey(ry().mark((function t(e){var r;return ry().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null===(r=e.message.additional_kwargs)||void 0===r||!r.function_call){t.next=6;break}return t.next=3,n.getNumTokensFromMessages([e.message]);case 3:return t.abrupt("return",t.sent.countPerMessage[0]);case 6:return t.next=8,n.getNumTokens(e.message.content);case 8:return t.abrupt("return",t.sent);case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 2:return r=t.sent,t.abrupt("return",r.reduce((function(t,e){return t+e}),0));case 4:case"end":return t.stop()}}),t)}))),function(t){return s.apply(this,arguments)})},{key:"getNumTokensFromMessages",value:(u=ey(ry().mark((function t(e){var r,n,o,i,a=this;return ry().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=0,n=0,o=0,"gpt-3.5-turbo-0301"===this.model?(n=4,o=-1):(n=3,o=1),t.next=6,Promise.all(e.map(function(){var t=ey(ry().mark((function t(e){var i,u,s,c,l,f,p,h,d,y,v;return ry().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.getNumTokens(e.content);case 2:return c=t.sent,t.next=5,a.getNumTokens(wy(e));case 5:if(l=t.sent,void 0===e.name){t.next=14;break}return t.t1=o,t.next=10,a.getNumTokens(e.name);case 10:t.t2=t.sent,t.t0=t.t1+t.t2,t.next=15;break;case 14:t.t0=0;case 15:if(f=t.t0,p=c+n+l+f,"function"===(h=e)._getType()&&(p-=2),null!==(i=h.additional_kwargs)&&void 0!==i&&i.function_call&&(p+=3),null==h||null===(u=h.additional_kwargs.function_call)||void 0===u||!u.name){t.next=25;break}return t.t3=p,t.next=24,a.getNumTokens(null===(d=h.additional_kwargs.function_call)||void 0===d?void 0:d.name);case 24:p=t.t3+=t.sent;case 25:if(null===(s=h.additional_kwargs.function_call)||void 0===s||!s.arguments){t.next=40;break}return t.prev=26,t.t4=p,t.next=30,a.getNumTokens(JSON.stringify(JSON.parse(null===(y=h.additional_kwargs.function_call)||void 0===y?void 0:y.arguments)));case 30:p=t.t4+=t.sent,t.next=40;break;case 33:return t.prev=33,t.t5=t.catch(26),console.error("Error parsing function arguments",t.t5,JSON.stringify(h.additional_kwargs.function_call)),t.t6=p,t.next=39,a.getNumTokens(null===(v=h.additional_kwargs.function_call)||void 0===v?void 0:v.arguments);case 39:p=t.t6+=t.sent;case 40:return r+=p,t.abrupt("return",p);case 42:case"end":return t.stop()}}),t,null,[[26,33]])})));return function(e){return t.apply(this,arguments)}}()));case 6:return i=t.sent,r+=3,t.abrupt("return",{totalCount:r,countPerMessage:i});case 9:case"end":return t.stop()}}),t,this)}))),function(t){return u.apply(this,arguments)})},{key:"completionWithRetry",value:(a=ey(ry().mark((function t(e,r){var n,o=this;return ry().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this._getClientOptions(r),t.abrupt("return",this.caller.call(ey(ry().mark((function t(){var r;return ry().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,o.client.chat.completions.create(e,n);case 3:return r=t.sent,t.abrupt("return",r);case 7:throw t.prev=7,t.t0=t.catch(0),zd(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,7]])})))));case 2:case"end":return t.stop()}}),t,this)}))),function(t,e){return a.apply(this,arguments)})},{key:"betaParsedCompletionWithRetry",value:(i=ey(ry().mark((function t(e,r){var n,o=this;return ry().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this._getClientOptions(r),t.abrupt("return",this.caller.call(ey(ry().mark((function t(){var r;return ry().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,o.client.beta.chat.completions.parse(e,n);case 3:return r=t.sent,t.abrupt("return",r);case 7:throw t.prev=7,t.t0=t.catch(0),zd(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,7]])})))));case 2:case"end":return t.stop()}}),t,this)}))),function(t,e){return i.apply(this,arguments)})},{key:"_getClientOptions",value:function(t){if(!this.client){var e=function(t){var e=t.azureOpenAIApiDeploymentName,r=t.azureOpenAIApiInstanceName,n=t.azureOpenAIApiKey,o=t.azureOpenAIBasePath,i=t.baseURL,a=t.azureADTokenProvider;if((n||a)&&o&&e)return"".concat(o,"/").concat(e);if(n||a){if(!r)throw new Error("azureOpenAIApiInstanceName is required when using azureOpenAIApiKey");if(!e)throw new Error("azureOpenAIApiDeploymentName is a required parameter when using azureOpenAIApiKey");return"https://".concat(r,".openai.azure.com/openai/deployments/").concat(e)}return i}({azureOpenAIApiDeploymentName:this.azureOpenAIApiDeploymentName,azureOpenAIApiInstanceName:this.azureOpenAIApiInstanceName,azureOpenAIApiKey:this.azureOpenAIApiKey,azureOpenAIBasePath:this.azureOpenAIBasePath,baseURL:this.clientConfig.baseURL}),r=cy(cy({},this.clientConfig),{},{baseURL:e,timeout:this.timeout,maxRetries:0});r.baseURL||delete r.baseURL,this.client=new oh(r)}var n=cy(cy({},this.clientConfig),t);return this.azureOpenAIApiKey&&(n.headers=cy({"api-key":this.azureOpenAIApiKey},n.headers),n.query=cy({"api-version":this.azureOpenAIApiVersion},n.query)),n}},{key:"_llmType",value:function(){return"openai"}},{key:"_combineLLMOutput",value:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return e.reduce((function(t,e){var r,n,o;return e&&e.tokenUsage&&(t.tokenUsage.completionTokens+=null!==(r=e.tokenUsage.completionTokens)&&void 0!==r?r:0,t.tokenUsage.promptTokens+=null!==(n=e.tokenUsage.promptTokens)&&void 0!==n?n:0,t.tokenUsage.totalTokens+=null!==(o=e.tokenUsage.totalTokens)&&void 0!==o?o:0),t}),{tokenUsage:{completionTokens:0,promptTokens:0,totalTokens:0}})}},{key:"withStructuredOutput",value:function(t,e){var r,n,o,i,a,u,s;if(void 0!==(a=t)&&"object"===Xd(a.schema)?(r=t.schema,n=t.name,o=t.method,i=t.includeRaw):(r=t,n=null==e?void 0:e.name,o=null==e?void 0:e.method,i=null==e?void 0:e.includeRaw),void 0!==(null==e?void 0:e.strict)&&"jsonMode"===o)throw new Error("Argument `strict` is only supported for `method` = 'function_calling'");if("jsonMode"===o)u=this.bind({response_format:{type:"json_object"}}),s=jy(r)?En._6.fromZodSchema(r):new En.hU;else if("jsonSchema"===o){var c;u=this.bind({response_format:{type:"json_schema",json_schema:{name:null!==(c=n)&&void 0!==c?c:"extract",description:r.description,schema:r,strict:null==e?void 0:e.strict}}}),s=jy(r)?En._6.fromZodSchema(r):new En.hU}else{var l,f=null!==(l=n)&&void 0!==l?l:"extract";if(jy(r)){var p=(0,Mo.Ik)(r);u=this.bind(cy({tools:[{type:"function",function:{name:f,description:p.description,parameters:p}}],tool_choice:{type:"function",function:{name:f}}},void 0!==(null==e?void 0:e.strict)?{strict:e.strict}:{})),s=new ld({returnSingle:!0,keyName:f,zodSchema:r})}else{var h,d,y;"string"==typeof r.name&&"object"===Xd(r.parameters)&&null!=r.parameters?(h=r,f=r.name):h={name:f=null!==(d=r.title)&&void 0!==d?d:f,description:null!==(y=r.description)&&void 0!==y?y:"",parameters:r},u=this.bind(cy({tools:[{type:"function",function:h}],tool_choice:{type:"function",function:{name:f}}},void 0!==(null==e?void 0:e.strict)?{strict:e.strict}:{})),s=new ld({returnSingle:!0,keyName:f})}}if(!i)return u.pipe(s);var v=xn.kI.assign({parsed:function(t,e){return s.invoke(t.raw,e)}}),m=xn.kI.assign({parsed:function(){return null}}),b=v.withFallbacks({fallbacks:[m]});return xn.zZ.from([{raw:u},b])}}],o=[{key:"lc_name",value:function(){return"ChatOpenAI"}}],n&&ny(r.prototype,n),o&&ny(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o,i,a,u,s,c,l}(Fh);function jy(t){return"function"==typeof(null==t?void 0:t.parse)}function Sy(t){var e,r;function n(e,r){try{var i=t[e](r),a=i.value,u=a instanceof Ay;Promise.resolve(u?a.v:a).then((function(r){if(u){var s="return"===e?"return":"next";if(!a.k||r.done)return n(s,r);r=t[s](r).value}o(i.done?"return":"normal",r)}),(function(t){n("throw",t)}))}catch(t){o("throw",t)}}function o(t,o){switch(t){case"return":e.resolve({value:o,done:!0});break;case"throw":e.reject(o);break;default:e.resolve({value:o,done:!1})}(e=e.next)?n(e.key,e.arg):r=null}this._invoke=function(t,o){return new Promise((function(i,a){var u={key:t,arg:o,resolve:i,reject:a,next:null};r?r=r.next=u:(e=r=u,n(t,o))}))},"function"!=typeof t.return&&(this.return=void 0)}function Ay(t,e){this.v=t,this.k=e}function Dy(t){var e,r;function n(e,r){try{var i=t[e](r),a=i.value,u=a instanceof Py;Promise.resolve(u?a.v:a).then((function(r){if(u){var s="return"===e?"return":"next";if(!a.k||r.done)return n(s,r);r=t[s](r).value}o(i.done?"return":"normal",r)}),(function(t){n("throw",t)}))}catch(t){o("throw",t)}}function o(t,o){switch(t){case"return":e.resolve({value:o,done:!0});break;case"throw":e.reject(o);break;default:e.resolve({value:o,done:!1})}(e=e.next)?n(e.key,e.arg):r=null}this._invoke=function(t,o){return new Promise((function(i,a){var u={key:t,arg:o,resolve:i,reject:a,next:null};r?r=r.next=u:(e=r=u,n(t,o))}))},"function"!=typeof t.return&&(this.return=void 0)}function Py(t,e){this.v=t,this.k=e}function Cy(t){var e,r;function n(e,r){try{var i=t[e](r),a=i.value,u=a instanceof Ly;Promise.resolve(u?a.v:a).then((function(r){if(u){var s="return"===e?"return":"next";if(!a.k||r.done)return n(s,r);r=t[s](r).value}o(i.done?"return":"normal",r)}),(function(t){n("throw",t)}))}catch(t){o("throw",t)}}function o(t,o){switch(t){case"return":e.resolve({value:o,done:!0});break;case"throw":e.reject(o);break;default:e.resolve({value:o,done:!1})}(e=e.next)?n(e.key,e.arg):r=null}this._invoke=function(t,o){return new Promise((function(i,a){var u={key:t,arg:o,resolve:i,reject:a,next:null};r?r=r.next=u:(e=r=u,n(t,o))}))},"function"!=typeof t.return&&(this.return=void 0)}function Ly(t,e){this.v=t,this.k=e}function Ty(){Ty=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new P(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function b(){}function g(){}var w={};c(w,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(w=_);var E=g.prototype=m.prototype=Object.create(w);function O(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,i,a,u){var s=f(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==Ry(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=S(u,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?y:h,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=y,n.method="throw",n.arg=c.arg)}}}function S(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,S(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function C(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(Ry(e)+" is not iterable")}return b.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=c(g,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,c(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},O(k.prototype),c(k.prototype,u,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(E),c(E,s,"Generator"),c(E,a,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=C,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),D(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;D(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:C(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function Fy(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],s=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);s=!0);}catch(t){c=!0,o=t}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Iy(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Iy(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Iy(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Ny(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function Ry(t){return Ry="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ry(t)}function My(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,By(n.key),n)}}function By(t){var e=function(t){if("object"!=Ry(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Ry(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ry(e)?e:e+""}function Gy(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Gy=function(){return!!t})()}function Uy(t){return Uy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Uy(t)}function zy(t,e){return zy=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},zy(t,e)}Sy.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},Sy.prototype.next=function(t){return this._invoke("next",t)},Sy.prototype.throw=function(t){return this._invoke("throw",t)},Sy.prototype.return=function(t){return this._invoke("return",t)},Dy.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},Dy.prototype.next=function(t){return this._invoke("next",t)},Dy.prototype.throw=function(t){return this._invoke("throw",t)},Dy.prototype.return=function(t){return this._invoke("return",t)},Cy.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},Cy.prototype.next=function(t){return this._invoke("next",t)},Cy.prototype.throw=function(t){return this._invoke("throw",t)},Cy.prototype.return=function(t){return this._invoke("return",t)},o(6463);var $y=function(t){function e(t){var r,n,o,i,a,u,s,c,l,f,p;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),void 0!==(null==t?void 0:t.responseFormat)&&["url","b64_json"].includes(t.responseFormat)&&(t.dallEResponseFormat=t.responseFormat,t.responseFormat="content"),p=function(t,e,r){return e=Uy(e),function(t,e){if(e&&("object"==Ry(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Gy()?Reflect.construct(e,r||[],Uy(t).constructor):e.apply(t,r))}(this,e,[t]),Object.defineProperty(p,"name",{enumerable:!0,configurable:!0,writable:!0,value:"dalle_api_wrapper"}),Object.defineProperty(p,"description",{enumerable:!0,configurable:!0,writable:!0,value:"A wrapper around OpenAI DALL-E API. Useful for when you need to generate images from a text description. Input should be an image description."}),Object.defineProperty(p,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(p,"model",{enumerable:!0,configurable:!0,writable:!0,value:"dall-e-3"}),Object.defineProperty(p,"style",{enumerable:!0,configurable:!0,writable:!0,value:"vivid"}),Object.defineProperty(p,"quality",{enumerable:!0,configurable:!0,writable:!0,value:"standard"}),Object.defineProperty(p,"n",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(p,"size",{enumerable:!0,configurable:!0,writable:!0,value:"1024x1024"}),Object.defineProperty(p,"dallEResponseFormat",{enumerable:!0,configurable:!0,writable:!0,value:"url"}),Object.defineProperty(p,"user",{enumerable:!0,configurable:!0,writable:!0,value:void 0});var h={apiKey:null!==(r=null!==(n=null==t?void 0:t.apiKey)&&void 0!==n?n:null==t?void 0:t.openAIApiKey)&&void 0!==r?r:(0,ah.Az)("OPENAI_API_KEY"),organization:null!==(o=null==t?void 0:t.organization)&&void 0!==o?o:(0,ah.Az)("OPENAI_ORGANIZATION"),dangerouslyAllowBrowser:!0,baseUrl:null==t?void 0:t.baseUrl};return p.client=new oh(h),p.model=null!==(i=null!==(a=null==t?void 0:t.model)&&void 0!==a?a:null==t?void 0:t.modelName)&&void 0!==i?i:p.model,p.style=null!==(u=null==t?void 0:t.style)&&void 0!==u?u:p.style,p.quality=null!==(s=null==t?void 0:t.quality)&&void 0!==s?s:p.quality,p.n=null!==(c=null==t?void 0:t.n)&&void 0!==c?c:p.n,p.size=null!==(l=null==t?void 0:t.size)&&void 0!==l?l:p.size,p.dallEResponseFormat=null!==(f=null==t?void 0:t.dallEResponseFormat)&&void 0!==f?f:p.dallEResponseFormat,p.user=null==t?void 0:t.user,p}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&zy(t,e)}(e,t),r=e,n=[{key:"processMultipleGeneratedUrls",value:function(t){return"url"===this.dallEResponseFormat?t.flatMap((function(t){return t.data.flatMap((function(t){return t.url?{type:"image_url",image_url:t.url}:[]})).filter((function(t){return void 0!==t&&"image_url"===t.type&&"string"==typeof t.image_url&&void 0!==t.image_url}))})):t.flatMap((function(t){return t.data.flatMap((function(t){return t.b64_json?{type:"image_url",image_url:{url:t.b64_json}}:[]})).filter((function(t){return void 0!==t&&"image_url"===t.type&&"object"===Ry(t.image_url)&&"url"in t.image_url&&"string"==typeof t.image_url.url&&void 0!==t.image_url.url}))}))}},{key:"_call",value:(i=function(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Ny(i,n,o,a,u,"next",t)}function u(t){Ny(i,n,o,a,u,"throw",t)}a(void 0)}))}}(Ty().mark((function t(e){var r,n,o,i,a,u,s,c,l=this;return Ty().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r={model:this.model,prompt:e,n:1,size:this.size,response_format:this.dallEResponseFormat,style:this.style,quality:this.quality,user:this.user},!(this.n>1)){t.next=6;break}return t.next=4,Promise.all(Array.from({length:this.n}).map((function(){return l.client.images.generate(r)})));case 4:return n=t.sent,t.abrupt("return",this.processMultipleGeneratedUrls(n));case 6:return t.next=8,this.client.images.generate(r);case 8:return o=t.sent,i="","url"===this.dallEResponseFormat?(a=o.data.map((function(t){return t.url})).filter((function(t){return"undefined"!==t})),u=Fy(a,1),i=u[0]):(s=o.data.map((function(t){return t.b64_json})).filter((function(t){return"undefined"!==t})),c=Fy(s,1),i=c[0]),t.abrupt("return",i);case 12:case"end":return t.stop()}}),t,this)}))),function(t){return i.apply(this,arguments)})}],o=[{key:"lc_name",value:function(){return"DallEAPIWrapper"}}],n&&My(r.prototype,n),o&&My(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o,i}(yn);Object.defineProperty($y,"toolName",{enumerable:!0,configurable:!0,writable:!0,value:"dalle_api_wrapper"});const qy="0.27.3";let Ky,Hy,Zy,Yy,Vy,Wy,Jy=!1,Xy=null,Qy=null,tv=null,ev=null,rv=null,nv=null,ov=null;class iv{constructor(t){this.body=t}get[Symbol.toStringTag](){return"MultipartBody"}}Ky||function(t,e={auto:!1}){if(Jy)throw new Error(`you must \`import '@anthropic-ai/sdk/shims/${t.kind}'\` before importing anything else from @anthropic-ai/sdk`);if(Ky)throw new Error(`can't \`import '@anthropic-ai/sdk/shims/${t.kind}'\` after \`import '@anthropic-ai/sdk/shims/${Ky}'\``);Jy=e.auto,Ky=t.kind,Hy=t.fetch,Xy=t.Request,Qy=t.Response,tv=t.Headers,ev=t.FormData,rv=t.Blob,Zy=t.File,Yy=t.ReadableStream,nv=t.getMultipartRequestOptions,Vy=t.getDefaultAgent,Wy=t.fileFromPath,ov=t.isFsReadStream}(function({manuallyImported:t}={}){const e=t?"You may need to use polyfills":"Add one of these imports before your first `import … from '@anthropic-ai/sdk'`:\n- `import '@anthropic-ai/sdk/shims/node'` (if you're running on Node)\n- `import '@anthropic-ai/sdk/shims/web'` (otherwise)\n";let r,n,o,i;try{r=fetch,n=Request,o=Response,i=Headers}catch(t){throw new Error(`this environment is missing the following Web Fetch API type: ${t.message}. ${e}`)}return{kind:"web",fetch:r,Request:n,Response:o,Headers:i,FormData:"undefined"!=typeof FormData?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:"undefined"!=typeof Blob?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:"undefined"!=typeof File?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:"undefined"!=typeof ReadableStream?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(t,e)=>({...e,body:new iv(t)}),getDefaultAgent:t=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/anthropics/anthropic-sdk-typescript#file-uploads")},isFsReadStream:t=>!1}}(),{auto:!0});class av{constructor(t,e){this.iterator=t,this.controller=e}static fromSSEResponse(t,e){let r=!1;return new av((async function*(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let n=!1;try{for await(const r of async function*(t,e){if(!t.body)throw e.abort(),new Iv("Attempted to iterate over a response with no body");const r=new sv,n=new cv,o=lv(t.body);for await(const t of async function*(t){let e=new Uint8Array;for await(const r of t){if(null==r)continue;const t=r instanceof ArrayBuffer?new Uint8Array(r):"string"==typeof r?(new TextEncoder).encode(r):r;let n,o=new Uint8Array(e.length+t.length);for(o.set(e),o.set(t,e.length),e=o;-1!==(n=uv(e));)yield e.slice(0,n),e=e.slice(n)}e.length>0&&(yield e)}(o))for(const e of n.decode(t)){const t=r.decode(e);t&&(yield t)}for(const t of n.flush()){const e=r.decode(t);e&&(yield e)}}(t,e)){if("completion"===r.event)try{yield JSON.parse(r.data)}catch(t){throw console.error("Could not parse message into JSON:",r.data),console.error("From chunk:",r.raw),t}if("message_start"===r.event||"message_delta"===r.event||"message_stop"===r.event||"content_block_start"===r.event||"content_block_delta"===r.event||"content_block_stop"===r.event)try{yield JSON.parse(r.data)}catch(t){throw console.error("Could not parse message into JSON:",r.data),console.error("From chunk:",r.raw),t}if("ping"!==r.event&&"error"===r.event)throw Nv.generate(void 0,`SSE Error: ${r.data}`,r.data,gv(t.headers))}n=!0}catch(t){if(t instanceof Error&&"AbortError"===t.name)return;throw t}finally{n||e.abort()}}),e)}static fromReadableStream(t,e){let r=!1;return new av((async function*(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let n=!1;try{for await(const e of async function*(){const e=new cv,r=lv(t);for await(const t of r)for(const r of e.decode(t))yield r;for(const t of e.flush())yield t}())n||e&&(yield JSON.parse(e));n=!0}catch(t){if(t instanceof Error&&"AbortError"===t.name)return;throw t}finally{n||e.abort()}}),e)}[Symbol.asyncIterator](){return this.iterator()}tee(){const t=[],e=[],r=this.iterator(),n=n=>({next:()=>{if(0===n.length){const n=r.next();t.push(n),e.push(n)}return n.shift()}});return[new av((()=>n(t)),this.controller),new av((()=>n(e)),this.controller)]}toReadableStream(){const t=this;let e;const r=new TextEncoder;return new Yy({async start(){e=t[Symbol.asyncIterator]()},async pull(t){try{const{value:n,done:o}=await e.next();if(o)return t.close();const i=r.encode(JSON.stringify(n)+"\n");t.enqueue(i)}catch(e){t.error(e)}},async cancel(){await(e.return?.())}})}}function uv(t){for(let e=0;e<t.length-2;e++){if(10===t[e]&&10===t[e+1])return e+2;if(13===t[e]&&13===t[e+1])return e+2;if(13===t[e]&&10===t[e+1]&&e+3<t.length&&13===t[e+2]&&10===t[e+3])return e+4}return-1}class sv{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(t){if(t.endsWith("\r")&&(t=t.substring(0,t.length-1)),!t){if(!this.event&&!this.data.length)return null;const t={event:this.event,data:this.data.join("\n"),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],t}if(this.chunks.push(t),t.startsWith(":"))return null;let[e,r,n]=function(t){const e=t.indexOf(":");return-1!==e?[t.substring(0,e),":",t.substring(e+1)]:[t,"",""]}(t);return n.startsWith(" ")&&(n=n.substring(1)),"event"===e?this.event=n:"data"===e&&this.data.push(n),null}}class cv{constructor(){this.buffer=[],this.trailingCR=!1}decode(t){let e=this.decodeText(t);if(this.trailingCR&&(e="\r"+e,this.trailingCR=!1),e.endsWith("\r")&&(this.trailingCR=!0,e=e.slice(0,-1)),!e)return[];const r=cv.NEWLINE_CHARS.has(e[e.length-1]||"");let n=e.split(cv.NEWLINE_REGEXP);return r&&n.pop(),1!==n.length||r?(this.buffer.length>0&&(n=[this.buffer.join("")+n[0],...n.slice(1)],this.buffer=[]),r||(this.buffer=[n.pop()||""]),n):(this.buffer.push(n[0]),[])}decodeText(t){if(null==t)return"";if("string"==typeof t)return t;if("undefined"!=typeof Buffer){if(t instanceof Buffer)return t.toString();if(t instanceof Uint8Array)return Buffer.from(t).toString();throw new Iv(`Unexpected: received non-Uint8Array (${t.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if("undefined"!=typeof TextDecoder){if(t instanceof Uint8Array||t instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(t);throw new Iv(`Unexpected: received non-Uint8Array/ArrayBuffer (${t.constructor.name}) in a web platform. Please report this error.`)}throw new Iv("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const t=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,t}}function lv(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const t=await e.read();return t?.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}cv.NEWLINE_CHARS=new Set(["\n","\r"]),cv.NEWLINE_REGEXP=/\r\n|[\n\r]/g;const fv=t=>null!=t&&"object"==typeof t&&"number"==typeof t.size&&"string"==typeof t.type&&"function"==typeof t.text&&"function"==typeof t.slice&&"function"==typeof t.arrayBuffer;const pv=t=>"string"==typeof t?t:"undefined"!=typeof Buffer&&t instanceof Buffer?String(t):void 0,hv=t=>null!=t&&"object"==typeof t&&"function"==typeof t[Symbol.asyncIterator],dv=t=>t&&"object"==typeof t&&t.body&&"MultipartBody"===t[Symbol.toStringTag];async function yv(t){const{response:e}=t;if(t.options.stream)return Tv("response",e.status,e.url,e.headers,e.body),t.options.__streamClass?t.options.__streamClass.fromSSEResponse(e,t.controller):av.fromSSEResponse(e,t.controller);if(204===e.status)return null;if(t.options.__binaryResponse)return e;const r=e.headers.get("content-type");if(r?.includes("application/json")||r?.includes("application/vnd.api+json")){const t=await e.json();return Tv("response",e.status,e.url,e.headers,t),t}const n=await e.text();return Tv("response",e.status,e.url,e.headers,n),n}class vv extends Promise{constructor(t,e=yv){super((t=>{t(null)})),this.responsePromise=t,this.parseResponse=e}_thenUnwrap(t){return new vv(this.responsePromise,(async e=>t(await this.parseResponse(e))))}asResponse(){return this.responsePromise.then((t=>t.response))}async withResponse(){const[t,e]=await Promise.all([this.parse(),this.asResponse()]);return{data:t,response:e}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(t,e){return this.parse().then(t,e)}catch(t){return this.parse().catch(t)}finally(t){return this.parse().finally(t)}}class mv{constructor({baseURL:t,maxRetries:e=2,timeout:r=6e5,httpAgent:n,fetch:o}){this.baseURL=t,this.maxRetries=Av("maxRetries",e),this.timeout=Av("timeout",r),this.httpAgent=n,this.fetch=o??Hy}authHeaders(t){return{}}defaultHeaders(t){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...Ev(),...this.authHeaders(t)}}validateHeaders(t,e){}defaultIdempotencyKey(){return`stainless-node-retry-${Fv()}`}get(t,e){return this.methodRequest("get",t,e)}post(t,e){return this.methodRequest("post",t,e)}patch(t,e){return this.methodRequest("patch",t,e)}put(t,e){return this.methodRequest("put",t,e)}delete(t,e){return this.methodRequest("delete",t,e)}methodRequest(t,e,r){return this.request(Promise.resolve(r).then((async r=>{const n=r&&fv(r?.body)?new DataView(await r.body.arrayBuffer()):r?.body instanceof DataView?r.body:r?.body instanceof ArrayBuffer?new DataView(r.body):r&&ArrayBuffer.isView(r?.body)?new DataView(r.body.buffer):r?.body;return{method:t,path:e,...r,body:n}})))}getAPIList(t,e,r){return this.requestAPIList(e,{method:"get",path:t,...r})}calculateContentLength(t){if("string"==typeof t){if("undefined"!=typeof Buffer)return Buffer.byteLength(t,"utf8").toString();if("undefined"!=typeof TextEncoder)return(new TextEncoder).encode(t).length.toString()}else if(ArrayBuffer.isView(t))return t.byteLength.toString();return null}buildRequest(t){const{method:e,path:r,query:n,headers:o={}}=t,i=ArrayBuffer.isView(t.body)||t.__binaryRequest&&"string"==typeof t.body?t.body:dv(t.body)?t.body.body:t.body?JSON.stringify(t.body,null,2):null,a=this.calculateContentLength(i),u=this.buildURL(r,n);"timeout"in t&&Av("timeout",t.timeout);const s=t.timeout??this.timeout,c=t.httpAgent??this.httpAgent??Vy(u),l=s+1e3;return"number"==typeof c?.options?.timeout&&l>(c.options.timeout??0)&&(c.options.timeout=l),this.idempotencyHeader&&"get"!==e&&(t.idempotencyKey||(t.idempotencyKey=this.defaultIdempotencyKey()),o[this.idempotencyHeader]=t.idempotencyKey),{req:{method:e,...i&&{body:i},headers:this.buildHeaders({options:t,headers:o,contentLength:a}),...c&&{agent:c},signal:t.signal??null},url:u,timeout:s}}buildHeaders({options:t,headers:e,contentLength:r}){const n={};return r&&(n["content-length"]=r),Lv(n,this.defaultHeaders(t)),Lv(n,e),dv(t.body)&&"node"!==Ky&&delete n["content-type"],this.validateHeaders(n,e),n}async prepareOptions(t){}async prepareRequest(t,{url:e,options:r}){}parseHeaders(t){return t?Symbol.iterator in t?Object.fromEntries(Array.from(t).map((t=>[...t]))):{...t}:{}}makeStatusError(t,e,r,n){return Nv.generate(t,e,r,n)}request(t,e=null){return new vv(this.makeRequest(t,e))}async makeRequest(t,e){const r=await t;null==e&&(e=r.maxRetries??this.maxRetries),await this.prepareOptions(r);const{req:n,url:o,timeout:i}=this.buildRequest(r);if(await this.prepareRequest(n,{url:o,options:r}),Tv("request",o,r,n.headers),r.signal?.aborted)throw new Rv;const a=new AbortController,u=await this.fetchWithTimeout(o,n,i,a).catch(Dv);if(u instanceof Error){if(r.signal?.aborted)throw new Rv;if(e)return this.retryRequest(r,e);if("AbortError"===u.name)throw new Bv;throw new Mv({cause:u})}const s=gv(u.headers);if(!u.ok){if(e&&this.shouldRetry(u))return Tv(`response (error; retrying, ${e} attempts remaining)`,u.status,o,s),this.retryRequest(r,e,s);const t=await u.text().catch((t=>Dv(t).message)),n=Ov(t),i=n?void 0:t;throw Tv(`response (error; ${e?"(error; no more retries left)":"(error; not retryable)"})`,u.status,o,s,i),this.makeStatusError(u.status,n,i,s)}return{response:u,options:r,controller:a}}requestAPIList(t,e){const r=this.makeRequest(e,null);return new bv(this,r,t)}buildURL(t,e){const r=jv(t)?new URL(t):new URL(this.baseURL+(this.baseURL.endsWith("/")&&t.startsWith("/")?t.slice(1):t)),n=this.defaultQuery();return Cv(n)||(e={...n,...e}),"object"==typeof e&&e&&!Array.isArray(e)&&(r.search=this.stringifyQuery(e)),r.toString()}stringifyQuery(t){return Object.entries(t).filter((([t,e])=>void 0!==e)).map((([t,e])=>{if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return`${encodeURIComponent(t)}=${encodeURIComponent(e)}`;if(null===e)return`${encodeURIComponent(t)}=`;throw new Iv(`Cannot stringify type ${typeof e}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)})).join("&")}async fetchWithTimeout(t,e,r,n){const{signal:o,...i}=e||{};o&&o.addEventListener("abort",(()=>n.abort()));const a=setTimeout((()=>n.abort()),r);return this.getRequestClient().fetch.call(void 0,t,{signal:n.signal,...i}).finally((()=>{clearTimeout(a)}))}getRequestClient(){return{fetch:this.fetch}}shouldRetry(t){const e=t.headers.get("x-should-retry");return"true"===e||"false"!==e&&(408===t.status||409===t.status||429===t.status||t.status>=500)}async retryRequest(t,e,r){let n;const o=r?.["retry-after-ms"];if(o){const t=parseFloat(o);Number.isNaN(t)||(n=t)}const i=r?.["retry-after"];if(i&&!n){const t=parseFloat(i);n=Number.isNaN(t)?Date.parse(i)-Date.now():1e3*t}if(!(n&&0<=n&&n<6e4)){const r=t.maxRetries??this.maxRetries;n=this.calculateDefaultRetryTimeoutMillis(e,r)}return await Sv(n),this.makeRequest(t,e-1)}calculateDefaultRetryTimeoutMillis(t,e){const r=e-t;return Math.min(.5*Math.pow(2,r),8)*(1-.25*Math.random())*1e3}getUserAgent(){return`${this.constructor.name}/JS ${qy}`}}new WeakMap,Symbol.asyncIterator;class bv extends vv{constructor(t,e,r){super(e,(async e=>new r(t,e.response,await yv(e),e.options)))}async*[Symbol.asyncIterator](){const t=await(this);for await(const e of t)yield e}}const gv=t=>new Proxy(Object.fromEntries(t.entries()),{get(t,e){const r=e.toString();return t[r.toLowerCase()]||t[r]}}),wv=t=>"x32"===t?"x32":"x86_64"===t||"x64"===t?"x64":"arm"===t?"arm":"aarch64"===t||"arm64"===t?"arm64":t?`other:${t}`:"unknown",xv=t=>(t=t.toLowerCase()).includes("ios")?"iOS":"android"===t?"Android":"darwin"===t?"MacOS":"win32"===t?"Windows":"freebsd"===t?"FreeBSD":"openbsd"===t?"OpenBSD":"linux"===t?"Linux":t?`Other:${t}`:"Unknown";let _v;const Ev=()=>_v??(_v=(()=>{if("undefined"!=typeof Deno&&null!=Deno.build)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":qy,"X-Stainless-OS":xv(Deno.build.os),"X-Stainless-Arch":wv(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":"string"==typeof Deno.version?Deno.version:Deno.version?.deno??"unknown"};if("undefined"!=typeof EdgeRuntime)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":qy,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if("[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0))return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":qy,"X-Stainless-OS":xv(process.platform),"X-Stainless-Arch":wv(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const t=function(){if("undefined"==typeof navigator||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:r}of t){const t=r.exec(navigator.userAgent);if(t)return{browser:e,version:`${t[1]||0}.${t[2]||0}.${t[3]||0}`}}return null}();return t?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":qy,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${t.browser}`,"X-Stainless-Runtime-Version":t.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":qy,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}})()),Ov=t=>{try{return JSON.parse(t)}catch(t){return}},kv=new RegExp("^(?:[a-z]+:)?//","i"),jv=t=>kv.test(t),Sv=t=>new Promise((e=>setTimeout(e,t))),Av=(t,e)=>{if("number"!=typeof e||!Number.isInteger(e))throw new Iv(`${t} must be an integer`);if(e<0)throw new Iv(`${t} must be a positive integer`);return e},Dv=t=>t instanceof Error?t:new Error(t),Pv=t=>"undefined"!=typeof process?process.env?.[t]?.trim()??void 0:"undefined"!=typeof Deno?Deno.env?.get?.(t)?.trim():void 0;function Cv(t){if(!t)return!0;for(const e in t)return!1;return!0}function Lv(t,e){for(const o in e){if(r=e,n=o,!Object.prototype.hasOwnProperty.call(r,n))continue;const i=o.toLowerCase();if(!i)continue;const a=e[o];null===a?delete t[i]:void 0!==a&&(t[i]=a)}var r,n}function Tv(t,...e){"undefined"!=typeof process&&"true"===process?.env?.DEBUG&&console.log(`Anthropic:DEBUG:${t}`,...e)}const Fv=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}));class Iv extends Error{}class Nv extends Iv{constructor(t,e,r,n){super(`${Nv.makeMessage(t,e,r)}`),this.status=t,this.headers=n,this.request_id=n?.["request-id"],this.error=e}static makeMessage(t,e,r){const n=e?.message?"string"==typeof e.message?e.message:JSON.stringify(e.message):e?JSON.stringify(e):r;return t&&n?`${t} ${n}`:t?`${t} status code (no body)`:n||"(no status code or body)"}static generate(t,e,r,n){if(!t)return new Mv({message:r,cause:Dv(e)});const o=e;return 400===t?new Gv(t,o,r,n):401===t?new Uv(t,o,r,n):403===t?new zv(t,o,r,n):404===t?new $v(t,o,r,n):409===t?new qv(t,o,r,n):422===t?new Kv(t,o,r,n):429===t?new Hv(t,o,r,n):t>=500?new Zv(t,o,r,n):new Nv(t,o,r,n)}}class Rv extends Nv{constructor({message:t}={}){super(void 0,void 0,t||"Request was aborted.",void 0),this.status=void 0}}class Mv extends Nv{constructor({message:t,cause:e}){super(void 0,void 0,t||"Connection error.",void 0),this.status=void 0,e&&(this.cause=e)}}class Bv extends Mv{constructor({message:t}={}){super({message:t??"Request timed out."})}}class Gv extends Nv{constructor(){super(...arguments),this.status=400}}class Uv extends Nv{constructor(){super(...arguments),this.status=401}}class zv extends Nv{constructor(){super(...arguments),this.status=403}}class $v extends Nv{constructor(){super(...arguments),this.status=404}}class qv extends Nv{constructor(){super(...arguments),this.status=409}}class Kv extends Nv{constructor(){super(...arguments),this.status=422}}class Hv extends Nv{constructor(){super(...arguments),this.status=429}}class Zv extends Nv{}class Yv{constructor(t){this._client=t}}class Vv extends Yv{create(t,e){return this._client.post("/v1/complete",{body:t,timeout:this._client._options.timeout??6e5,...e,stream:t.stream??!1})}}Vv||(Vv={});const Wv=t=>{if(0===t.length)return t;let e=t[t.length-1];switch(e.type){case"separator":return t=t.slice(0,t.length-1),Wv(t);case"number":let r=e.value[e.value.length-1];if("."===r||"-"===r)return t=t.slice(0,t.length-1),Wv(t);case"string":let n=t[t.length-2];if("delimiter"===n?.type)return t=t.slice(0,t.length-1),Wv(t);if("brace"===n?.type&&"{"===n.value)return t=t.slice(0,t.length-1),Wv(t);break;case"delimiter":return t=t.slice(0,t.length-1),Wv(t)}return t},Jv=t=>JSON.parse((t=>{let e="";return t.map((t=>{"string"===t.type?e+='"'+t.value+'"':e+=t.value})),e})((t=>{let e=[];return t.map((t=>{"brace"===t.type&&("{"===t.value?e.push("}"):e.splice(e.lastIndexOf("}"),1)),"paren"===t.type&&("["===t.value?e.push("]"):e.splice(e.lastIndexOf("]"),1))})),e.length>0&&e.reverse().map((e=>{"}"===e?t.push({type:"brace",value:"}"}):"]"===e&&t.push({type:"paren",value:"]"})})),t})(Wv((t=>{let e=0,r=[];for(;e<t.length;){let n=t[e];if("\\"===n){e++;continue}if("{"===n){r.push({type:"brace",value:"{"}),e++;continue}if("}"===n){r.push({type:"brace",value:"}"}),e++;continue}if("["===n){r.push({type:"paren",value:"["}),e++;continue}if("]"===n){r.push({type:"paren",value:"]"}),e++;continue}if(":"===n){r.push({type:"separator",value:":"}),e++;continue}if(","===n){r.push({type:"delimiter",value:","}),e++;continue}if('"'===n){let o="",i=!1;for(n=t[++e];'"'!==n;){if(e===t.length){i=!0;break}if("\\"===n){if(e++,e===t.length){i=!0;break}o+=n+t[e],n=t[++e]}else o+=n,n=t[++e]}n=t[++e],i||r.push({type:"string",value:o});continue}if(n&&/\s/.test(n)){e++;continue}let o=/[0-9]/;if(n&&o.test(n)||"-"===n||"."===n){let i="";for("-"===n&&(i+=n,n=t[++e]);n&&o.test(n)||"."===n;)i+=n,n=t[++e];r.push({type:"number",value:i});continue}let i=/[a-z]/i;if(n&&i.test(n)){let o="";for(;n&&i.test(n)&&e!==t.length;)o+=n,n=t[++e];if("true"!=o&&"false"!=o&&"null"!==o){e++;continue}r.push({type:"name",value:o})}else e++}return r})(t)))));var Xv,Qv,tm,em,rm,nm,om,im,am,um,sm,cm,lm,fm,pm,hm,dm,ym,vm,mm,bm=function(t,e,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!o:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(t,r):o?o.value=r:e.set(t,r),r},gm=function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)};const wm="__json_buf";class xm{constructor(){Xv.add(this),this.messages=[],this.receivedMessages=[],Qv.set(this,void 0),this.controller=new AbortController,tm.set(this,void 0),em.set(this,(()=>{})),rm.set(this,(()=>{})),nm.set(this,void 0),om.set(this,(()=>{})),im.set(this,(()=>{})),am.set(this,{}),um.set(this,!1),sm.set(this,!1),cm.set(this,!1),lm.set(this,!1),hm.set(this,(t=>{if(bm(this,sm,!0,"f"),t instanceof Error&&"AbortError"===t.name&&(t=new Rv),t instanceof Rv)return bm(this,cm,!0,"f"),this._emit("abort",t);if(t instanceof Iv)return this._emit("error",t);if(t instanceof Error){const e=new Iv(t.message);return e.cause=t,this._emit("error",e)}return this._emit("error",new Iv(String(t)))})),bm(this,tm,new Promise(((t,e)=>{bm(this,em,t,"f"),bm(this,rm,e,"f")})),"f"),bm(this,nm,new Promise(((t,e)=>{bm(this,om,t,"f"),bm(this,im,e,"f")})),"f"),gm(this,tm,"f").catch((()=>{})),gm(this,nm,"f").catch((()=>{}))}static fromReadableStream(t){const e=new xm;return e._run((()=>e._fromReadableStream(t))),e}static createMessage(t,e,r){const n=new xm;for(const t of e.messages)n._addMessageParam(t);return n._run((()=>n._createMessage(t,{...e,stream:!0},{...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"stream"}}))),n}_run(t){t().then((()=>{this._emitFinal(),this._emit("end")}),gm(this,hm,"f"))}_addMessageParam(t){this.messages.push(t)}_addMessage(t,e=!0){this.receivedMessages.push(t),e&&this._emit("message",t)}async _createMessage(t,e,r){const n=r?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",(()=>this.controller.abort()))),gm(this,Xv,"m",dm).call(this);const o=await t.create({...e,stream:!0},{...r,signal:this.controller.signal});this._connected();for await(const t of o)gm(this,Xv,"m",ym).call(this,t);if(o.controller.signal?.aborted)throw new Rv;gm(this,Xv,"m",vm).call(this)}_connected(){this.ended||(gm(this,em,"f").call(this),this._emit("connect"))}get ended(){return gm(this,um,"f")}get errored(){return gm(this,sm,"f")}get aborted(){return gm(this,cm,"f")}abort(){this.controller.abort()}on(t,e){return(gm(this,am,"f")[t]||(gm(this,am,"f")[t]=[])).push({listener:e}),this}off(t,e){const r=gm(this,am,"f")[t];if(!r)return this;const n=r.findIndex((t=>t.listener===e));return n>=0&&r.splice(n,1),this}once(t,e){return(gm(this,am,"f")[t]||(gm(this,am,"f")[t]=[])).push({listener:e,once:!0}),this}emitted(t){return new Promise(((e,r)=>{bm(this,lm,!0,"f"),"error"!==t&&this.once("error",r),this.once(t,e)}))}async done(){bm(this,lm,!0,"f"),await gm(this,nm,"f")}get currentMessage(){return gm(this,Qv,"f")}async finalMessage(){return await this.done(),gm(this,Xv,"m",fm).call(this)}async finalText(){return await this.done(),gm(this,Xv,"m",pm).call(this)}_emit(t,...e){if(gm(this,um,"f"))return;"end"===t&&(bm(this,um,!0,"f"),gm(this,om,"f").call(this));const r=gm(this,am,"f")[t];if(r&&(gm(this,am,"f")[t]=r.filter((t=>!t.once)),r.forEach((({listener:t})=>t(...e)))),"abort"===t){const t=e[0];return gm(this,lm,"f")||r?.length||Promise.reject(t),gm(this,rm,"f").call(this,t),gm(this,im,"f").call(this,t),void this._emit("end")}if("error"===t){const t=e[0];gm(this,lm,"f")||r?.length||Promise.reject(t),gm(this,rm,"f").call(this,t),gm(this,im,"f").call(this,t),this._emit("end")}}_emitFinal(){this.receivedMessages.at(-1)&&this._emit("finalMessage",gm(this,Xv,"m",fm).call(this))}async _fromReadableStream(t,e){const r=e?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",(()=>this.controller.abort()))),gm(this,Xv,"m",dm).call(this),this._connected();const n=av.fromReadableStream(t,this.controller);for await(const t of n)gm(this,Xv,"m",ym).call(this,t);if(n.controller.signal?.aborted)throw new Rv;gm(this,Xv,"m",vm).call(this)}[(Qv=new WeakMap,tm=new WeakMap,em=new WeakMap,rm=new WeakMap,nm=new WeakMap,om=new WeakMap,im=new WeakMap,am=new WeakMap,um=new WeakMap,sm=new WeakMap,cm=new WeakMap,lm=new WeakMap,hm=new WeakMap,Xv=new WeakSet,fm=function(){if(0===this.receivedMessages.length)throw new Iv("stream ended without producing a Message with role=assistant");return this.receivedMessages.at(-1)},pm=function(){if(0===this.receivedMessages.length)throw new Iv("stream ended without producing a Message with role=assistant");const t=this.receivedMessages.at(-1).content.filter((t=>"text"===t.type)).map((t=>t.text));if(0===t.length)throw new Iv("stream ended without producing a content block with type=text");return t.join(" ")},dm=function(){this.ended||bm(this,Qv,void 0,"f")},ym=function(t){if(this.ended)return;const e=gm(this,Xv,"m",mm).call(this,t);switch(this._emit("streamEvent",t,e),t.type){case"content_block_delta":{const r=e.content.at(-1);"text_delta"===t.delta.type&&"text"===r.type?this._emit("text",t.delta.text,r.text||""):"input_json_delta"===t.delta.type&&"tool_use"===r.type&&r.input&&this._emit("inputJson",t.delta.partial_json,r.input);break}case"message_stop":this._addMessageParam(e),this._addMessage(e,!0);break;case"content_block_stop":this._emit("contentBlock",e.content.at(-1));break;case"message_start":bm(this,Qv,e,"f")}},vm=function(){if(this.ended)throw new Iv("stream has ended, this shouldn't happen");const t=gm(this,Qv,"f");if(!t)throw new Iv("request ended without sending any chunks");return bm(this,Qv,void 0,"f"),t},mm=function(t){let e=gm(this,Qv,"f");if("message_start"===t.type){if(e)throw new Iv(`Unexpected event order, got ${t.type} before receiving "message_stop"`);return t.message}if(!e)throw new Iv(`Unexpected event order, got ${t.type} before "message_start"`);switch(t.type){case"message_stop":case"content_block_stop":return e;case"message_delta":return e.stop_reason=t.delta.stop_reason,e.stop_sequence=t.delta.stop_sequence,e.usage.output_tokens=t.usage.output_tokens,e;case"content_block_start":return e.content.push(t.content_block),e;case"content_block_delta":{const r=e.content.at(t.index);if("text"===r?.type&&"text_delta"===t.delta.type)r.text+=t.delta.text;else if("tool_use"===r?.type&&"input_json_delta"===t.delta.type){let e=r[wm]||"";e+=t.delta.partial_json,Object.defineProperty(r,wm,{value:e,enumerable:!1,writable:!0}),e&&(r.input=Jv(e))}return e}}},Symbol.asyncIterator)](){const t=[],e=[];let r=!1;return this.on("streamEvent",(r=>{const n=e.shift();n?n.resolve(r):t.push(r)})),this.on("end",(()=>{r=!0;for(const t of e)t.resolve(void 0);e.length=0})),this.on("abort",(t=>{r=!0;for(const r of e)r.reject(t);e.length=0})),this.on("error",(t=>{r=!0;for(const r of e)r.reject(t);e.length=0})),{next:async()=>t.length?{value:t.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise(((t,r)=>e.push({resolve:t,reject:r}))).then((t=>t?{value:t,done:!1}:{value:void 0,done:!0})),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new av(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}class _m extends Yv{create(t,e){return t.model in Em&&console.warn(`The model '${t.model}' is deprecated and will reach end-of-life on ${Em[t.model]}\nPlease migrate to a newer model. Visit https://docs.anthropic.com/en/docs/resources/model-deprecations for more information.`),this._client.post("/v1/messages",{body:t,timeout:this._client._options.timeout??6e5,...e,stream:t.stream??!1})}stream(t,e){return xm.createMessage(this,t,e)}}const Em={"claude-1.3":"November 6th, 2024","claude-1.3-100k":"November 6th, 2024","claude-instant-1.1":"November 6th, 2024","claude-instant-1.1-100k":"November 6th, 2024","claude-instant-1.2":"November 6th, 2024"};_m||(_m={});var Om,km,jm,Sm,Am,Dm,Pm,Cm,Lm,Tm,Fm,Im,Nm,Rm,Mm,Bm,Gm,Um,zm,$m,qm=function(t,e,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!o:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(t,r):o?o.value=r:e.set(t,r),r},Km=function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)};const Hm="__json_buf";class Zm{constructor(){Om.add(this),this.messages=[],this.receivedMessages=[],km.set(this,void 0),this.controller=new AbortController,jm.set(this,void 0),Sm.set(this,(()=>{})),Am.set(this,(()=>{})),Dm.set(this,void 0),Pm.set(this,(()=>{})),Cm.set(this,(()=>{})),Lm.set(this,{}),Tm.set(this,!1),Fm.set(this,!1),Im.set(this,!1),Nm.set(this,!1),Bm.set(this,(t=>{if(qm(this,Fm,!0,"f"),t instanceof Error&&"AbortError"===t.name&&(t=new Rv),t instanceof Rv)return qm(this,Im,!0,"f"),this._emit("abort",t);if(t instanceof Iv)return this._emit("error",t);if(t instanceof Error){const e=new Iv(t.message);return e.cause=t,this._emit("error",e)}return this._emit("error",new Iv(String(t)))})),qm(this,jm,new Promise(((t,e)=>{qm(this,Sm,t,"f"),qm(this,Am,e,"f")})),"f"),qm(this,Dm,new Promise(((t,e)=>{qm(this,Pm,t,"f"),qm(this,Cm,e,"f")})),"f"),Km(this,jm,"f").catch((()=>{})),Km(this,Dm,"f").catch((()=>{}))}static fromReadableStream(t){const e=new Zm;return e._run((()=>e._fromReadableStream(t))),e}static createMessage(t,e,r){const n=new Zm;for(const t of e.messages)n._addPromptCachingBetaMessageParam(t);return n._run((()=>n._createPromptCachingBetaMessage(t,{...e,stream:!0},{...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"stream"}}))),n}_run(t){t().then((()=>{this._emitFinal(),this._emit("end")}),Km(this,Bm,"f"))}_addPromptCachingBetaMessageParam(t){this.messages.push(t)}_addPromptCachingBetaMessage(t,e=!0){this.receivedMessages.push(t),e&&this._emit("message",t)}async _createPromptCachingBetaMessage(t,e,r){const n=r?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",(()=>this.controller.abort()))),Km(this,Om,"m",Gm).call(this);const o=await t.create({...e,stream:!0},{...r,signal:this.controller.signal});this._connected();for await(const t of o)Km(this,Om,"m",Um).call(this,t);if(o.controller.signal?.aborted)throw new Rv;Km(this,Om,"m",zm).call(this)}_connected(){this.ended||(Km(this,Sm,"f").call(this),this._emit("connect"))}get ended(){return Km(this,Tm,"f")}get errored(){return Km(this,Fm,"f")}get aborted(){return Km(this,Im,"f")}abort(){this.controller.abort()}on(t,e){return(Km(this,Lm,"f")[t]||(Km(this,Lm,"f")[t]=[])).push({listener:e}),this}off(t,e){const r=Km(this,Lm,"f")[t];if(!r)return this;const n=r.findIndex((t=>t.listener===e));return n>=0&&r.splice(n,1),this}once(t,e){return(Km(this,Lm,"f")[t]||(Km(this,Lm,"f")[t]=[])).push({listener:e,once:!0}),this}emitted(t){return new Promise(((e,r)=>{qm(this,Nm,!0,"f"),"error"!==t&&this.once("error",r),this.once(t,e)}))}async done(){qm(this,Nm,!0,"f"),await Km(this,Dm,"f")}get currentMessage(){return Km(this,km,"f")}async finalMessage(){return await this.done(),Km(this,Om,"m",Rm).call(this)}async finalText(){return await this.done(),Km(this,Om,"m",Mm).call(this)}_emit(t,...e){if(Km(this,Tm,"f"))return;"end"===t&&(qm(this,Tm,!0,"f"),Km(this,Pm,"f").call(this));const r=Km(this,Lm,"f")[t];if(r&&(Km(this,Lm,"f")[t]=r.filter((t=>!t.once)),r.forEach((({listener:t})=>t(...e)))),"abort"===t){const t=e[0];return Km(this,Nm,"f")||r?.length||Promise.reject(t),Km(this,Am,"f").call(this,t),Km(this,Cm,"f").call(this,t),void this._emit("end")}if("error"===t){const t=e[0];Km(this,Nm,"f")||r?.length||Promise.reject(t),Km(this,Am,"f").call(this,t),Km(this,Cm,"f").call(this,t),this._emit("end")}}_emitFinal(){this.receivedMessages.at(-1)&&this._emit("finalPromptCachingBetaMessage",Km(this,Om,"m",Rm).call(this))}async _fromReadableStream(t,e){const r=e?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",(()=>this.controller.abort()))),Km(this,Om,"m",Gm).call(this),this._connected();const n=av.fromReadableStream(t,this.controller);for await(const t of n)Km(this,Om,"m",Um).call(this,t);if(n.controller.signal?.aborted)throw new Rv;Km(this,Om,"m",zm).call(this)}[(km=new WeakMap,jm=new WeakMap,Sm=new WeakMap,Am=new WeakMap,Dm=new WeakMap,Pm=new WeakMap,Cm=new WeakMap,Lm=new WeakMap,Tm=new WeakMap,Fm=new WeakMap,Im=new WeakMap,Nm=new WeakMap,Bm=new WeakMap,Om=new WeakSet,Rm=function(){if(0===this.receivedMessages.length)throw new Iv("stream ended without producing a PromptCachingBetaMessage with role=assistant");return this.receivedMessages.at(-1)},Mm=function(){if(0===this.receivedMessages.length)throw new Iv("stream ended without producing a PromptCachingBetaMessage with role=assistant");const t=this.receivedMessages.at(-1).content.filter((t=>"text"===t.type)).map((t=>t.text));if(0===t.length)throw new Iv("stream ended without producing a content block with type=text");return t.join(" ")},Gm=function(){this.ended||qm(this,km,void 0,"f")},Um=function(t){if(this.ended)return;const e=Km(this,Om,"m",$m).call(this,t);switch(this._emit("streamEvent",t,e),t.type){case"content_block_delta":{const r=e.content.at(-1);"text_delta"===t.delta.type&&"text"===r.type?this._emit("text",t.delta.text,r.text||""):"input_json_delta"===t.delta.type&&"tool_use"===r.type&&r.input&&this._emit("inputJson",t.delta.partial_json,r.input);break}case"message_stop":this._addPromptCachingBetaMessageParam(e),this._addPromptCachingBetaMessage(e,!0);break;case"content_block_stop":this._emit("contentBlock",e.content.at(-1));break;case"message_start":qm(this,km,e,"f")}},zm=function(){if(this.ended)throw new Iv("stream has ended, this shouldn't happen");const t=Km(this,km,"f");if(!t)throw new Iv("request ended without sending any chunks");return qm(this,km,void 0,"f"),t},$m=function(t){let e=Km(this,km,"f");if("message_start"===t.type){if(e)throw new Iv(`Unexpected event order, got ${t.type} before receiving "message_stop"`);return t.message}if(!e)throw new Iv(`Unexpected event order, got ${t.type} before "message_start"`);switch(t.type){case"message_stop":case"content_block_stop":return e;case"message_delta":return e.stop_reason=t.delta.stop_reason,e.stop_sequence=t.delta.stop_sequence,e.usage.output_tokens=t.usage.output_tokens,e;case"content_block_start":return e.content.push(t.content_block),e;case"content_block_delta":{const r=e.content.at(t.index);if("text"===r?.type&&"text_delta"===t.delta.type)r.text+=t.delta.text;else if("tool_use"===r?.type&&"input_json_delta"===t.delta.type){let e=r[Hm]||"";e+=t.delta.partial_json,Object.defineProperty(r,Hm,{value:e,enumerable:!1,writable:!0}),e&&(r.input=Jv(e))}return e}}},Symbol.asyncIterator)](){const t=[],e=[];let r=!1;return this.on("streamEvent",(r=>{const n=e.shift();n?n.resolve(r):t.push(r)})),this.on("end",(()=>{r=!0;for(const t of e)t.resolve(void 0);e.length=0})),this.on("abort",(t=>{r=!0;for(const r of e)r.reject(t);e.length=0})),this.on("error",(t=>{r=!0;for(const r of e)r.reject(t);e.length=0})),{next:async()=>t.length?{value:t.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise(((t,r)=>e.push({resolve:t,reject:r}))).then((t=>t?{value:t,done:!1}:{value:void 0,done:!0})),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new av(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}class Ym extends Yv{create(t,e){return this._client.post("/v1/messages?beta=prompt_caching",{body:t,timeout:this._client._options.timeout??6e5,...e,headers:{"anthropic-beta":"prompt-caching-2024-07-31",...e?.headers},stream:t.stream??!1})}stream(t,e){return Zm.createMessage(this,t,e)}}Ym||(Ym={});class Vm extends Yv{constructor(){super(...arguments),this.messages=new Ym(this._client)}}!function(t){t.Messages=Ym}(Vm||(Vm={}));class Wm extends Yv{constructor(){super(...arguments),this.promptCaching=new Vm(this._client)}}var Jm;!function(t){t.PromptCaching=Vm}(Wm||(Wm={}));class Xm extends mv{constructor({baseURL:t=Pv("ANTHROPIC_BASE_URL"),apiKey:e=Pv("ANTHROPIC_API_KEY")??null,authToken:r=Pv("ANTHROPIC_AUTH_TOKEN")??null,...n}={}){const o={apiKey:e,authToken:r,...n,baseURL:t||"https://api.anthropic.com"};if(!o.dangerouslyAllowBrowser&&"undefined"!=typeof window&&void 0!==window.document&&"undefined"!=typeof navigator)throw new Iv("It looks like you're running in a browser-like environment.\n\nThis is disabled by default, as it risks exposing your secret API credentials to attackers.\nIf you understand the risks and have appropriate mitigations in place,\nyou can set the `dangerouslyAllowBrowser` option to `true`, e.g.,\n\nnew Anthropic({ apiKey, dangerouslyAllowBrowser: true });\n\nTODO: link!\n");super({baseURL:o.baseURL,timeout:o.timeout??6e5,httpAgent:o.httpAgent,maxRetries:o.maxRetries,fetch:o.fetch}),this.completions=new Vv(this),this.messages=new _m(this),this.beta=new Wm(this),this._options=o,this.apiKey=e,this.authToken=r}defaultQuery(){return this._options.defaultQuery}defaultHeaders(t){return{...super.defaultHeaders(t),...this._options.dangerouslyAllowBrowser?{"anthropic-dangerous-direct-browser-access":"true"}:void 0,"anthropic-version":"2023-06-01",...this._options.defaultHeaders}}validateHeaders(t,e){if(!(this.apiKey&&t["x-api-key"]||null===e["x-api-key"]||this.authToken&&t.authorization||null===e.authorization))throw new Error('Could not resolve authentication method. Expected either apiKey or authToken to be set. Or for one of the "X-Api-Key" or "Authorization" headers to be explicitly omitted')}authHeaders(t){const e=this.apiKeyAuth(t),r=this.bearerAuth(t);return null==e||Cv(e)?null==r||Cv(r)?{}:r:e}apiKeyAuth(t){return null==this.apiKey?{}:{"X-Api-Key":this.apiKey}}bearerAuth(t){return null==this.authToken?{}:{Authorization:`Bearer ${this.authToken}`}}}Jm=Xm,Xm.Anthropic=Jm,Xm.HUMAN_PROMPT="\n\nHuman:",Xm.AI_PROMPT="\n\nAssistant:",Xm.DEFAULT_TIMEOUT=6e5,Xm.AnthropicError=Iv,Xm.APIError=Nv,Xm.APIConnectionError=Mv,Xm.APIConnectionTimeoutError=Bv,Xm.APIUserAbortError=Rv,Xm.NotFoundError=$v,Xm.ConflictError=qv,Xm.RateLimitError=Hv,Xm.BadRequestError=Gv,Xm.AuthenticationError=Uv,Xm.InternalServerError=Zv,Xm.PermissionDeniedError=zv,Xm.UnprocessableEntityError=Kv,Xm.toFile=async function(t,e,r){if((t=>null!=t&&"object"==typeof t&&"string"==typeof t.name&&"number"==typeof t.lastModified&&fv(t))(t=await t))return t;if((t=>null!=t&&"object"==typeof t&&"string"==typeof t.url&&"function"==typeof t.blob)(t)){const n=await t.blob();e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()??"unknown_file");const o=fv(n)?[await n.arrayBuffer()]:[n];return new Zy(o,e,r)}const n=await async function(t){let e=[];if("string"==typeof t||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)e.push(t);else if(fv(t))e.push(await t.arrayBuffer());else{if(!hv(t))throw new Error(`Unexpected data type: ${typeof t}; constructor: ${t?.constructor?.name}; props: ${function(t){return`[${Object.getOwnPropertyNames(t).map((t=>`"${t}"`)).join(", ")}]`}(t)}`);for await(const r of t)e.push(r)}return e}(t);if(e||(e=function(t){return pv(t.name)||pv(t.filename)||pv(t.path)?.split(/[\\/]/).pop()}(t)??"unknown_file"),!r?.type){const t=n[0]?.type;"string"==typeof t&&(r={...r,type:t})}return new Zy(n,e,r)},Xm.fileFromPath=Wy;const{HUMAN_PROMPT:Qm,AI_PROMPT:tb}=Xm,{pJ:eb,LG:rb,xX:nb,qA:ob,cH:ib,m_:ab,fK:ub,OE:sb,v7:cb,v3:lb,PO:fb,Ll:pb,Is:hb}=t;function db(t){return db="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},db(t)}function yb(t,e){if(t){if("string"==typeof t)return vb(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?vb(t,e):void 0}}function vb(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function mb(){mb=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new P(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function b(){}function g(){}var w={};c(w,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(w=_);var E=g.prototype=m.prototype=Object.create(w);function O(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,i,a,u){var s=f(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==db(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=S(u,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?y:h,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=y,n.method="throw",n.arg=c.arg)}}}function S(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,S(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function C(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(db(e)+" is not iterable")}return b.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=c(g,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,c(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},O(k.prototype),c(k.prototype,u,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(E),c(E,s,"Generator"),c(E,a,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=C,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),D(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;D(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:C(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function bb(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function gb(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){bb(i,n,o,a,u,"next",t)}function u(t){bb(i,n,o,a,u,"throw",t)}a(void 0)}))}}function wb(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,xb(n.key),n)}}function xb(t){var e=function(t){if("object"!=db(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=db(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==db(e)?e:e+""}function _b(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_b=function(){return!!t})()}function Eb(t){return Eb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Eb(t)}function Ob(t,e){return Ob=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ob(t,e)}!function(t){t.Completions=Vv,t.Messages=_m,t.Beta=Wm}(Xm||(Xm={}));var kb=function(t){function e(t){var r,n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=function(t,e,r){return e=Eb(e),function(t,e){if(e&&("object"==db(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,_b()?Reflect.construct(e,r||[],Eb(t).constructor):e.apply(t,r))}(this,e,[t]),Object.defineProperty(n,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","anthropic","output_parsers"]}),Object.defineProperty(n,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(n,"keyName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(n,"returnSingle",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(n,"zodSchema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),n.keyName=t.keyName,n.returnSingle=null!==(r=t.returnSingle)&&void 0!==r?r:n.returnSingle,n.zodSchema=t.zodSchema,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ob(t,e)}(e,t),r=e,n=[{key:"_validateResult",value:(a=gb(mb().mark((function t(e){var r,n;return mb().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e,"string"!=typeof e){t.next=11;break}t.prev=2,r=JSON.parse(e),t.next=9;break;case 6:throw t.prev=6,t.t0=t.catch(2),new En.CC('Failed to parse. Text: "'.concat(JSON.stringify(e,null,2),'". Error: ').concat(JSON.stringify(t.t0.message)),e);case 9:t.next=12;break;case 11:r=e;case 12:if(void 0!==this.zodSchema){t.next=14;break}return t.abrupt("return",r);case 14:return t.next=16,this.zodSchema.safeParseAsync(r);case 16:if(!(n=t.sent).success){t.next=21;break}return t.abrupt("return",n.data);case 21:throw new En.CC('Failed to parse. Text: "'.concat(JSON.stringify(e,null,2),'". Error: ').concat(JSON.stringify(n.error.errors)),JSON.stringify(r,null,2));case 22:case"end":return t.stop()}}),t,this,[[2,6]])}))),function(t){return a.apply(this,arguments)})},{key:"parseResult",value:(i=gb(mb().mark((function t(e){var r,n,o,i;return mb().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0!==(r=e.flatMap((function(t){var e=t.message;return Array.isArray(e.content)?jb(e.content)[0]:[]})))[0]){t.next=3;break}throw new Error("No parseable tool calls provided to AnthropicToolsOutputParser.");case 3:return u=1,n=function(t){if(Array.isArray(t))return t}(a=r)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],s=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);s=!0);}catch(t){c=!0,o=t}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(a,u)||yb(a,u)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),o=n[0],t.next=6,this._validateResult(o.args);case 6:return i=t.sent,t.abrupt("return",i);case 8:case"end":return t.stop()}var a,u}),t,this)}))),function(t){return i.apply(this,arguments)})}],o=[{key:"lc_name",value:function(){return"AnthropicToolsOutputParser"}}],n&&wb(r.prototype,n),o&&wb(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o,i,a}(En.vd);function jb(t){var e,r=[],n=function(t){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=yb(t))){e&&(t=e);var r=0,n=function(){};return{s:n,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,a=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return i=t.done,t},e:function(t){a=!0,o=t},f:function(){try{i||null==e.return||e.return()}finally{if(a)throw o}}}}(t);try{for(n.s();!(e=n.n()).done;){var o=e.value;"tool_use"===o.type&&r.push({name:o.name,args:o.input,id:o.id,type:"tool_call"})}}catch(t){n.e(t)}finally{n.f()}return r}function Sb(t){var e,r=Array.isArray(t.content)?t.content.find((function(t){return"tool_use"===t.type})):void 0;r&&"index"in r&&"name"in r&&"id"in r&&(e={args:"",id:r.id,name:r.name,index:r.index,type:"tool_call_chunk"});var n=Array.isArray(t.content)?t.content.find((function(t){return"input_json_delta"===t.type})):void 0;return n&&"index"in n&&"input"in n&&(e="string"==typeof n.input?{id:n.id,name:n.name,args:n.input,index:n.index,type:"tool_call_chunk"}:{id:n.id,name:n.name,args:JSON.stringify(n.input,null,2),index:n.index,type:"tool_call_chunk"}),e}function Ab(t){return Ab="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ab(t)}function Db(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Pb(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Db(Object(r),!0).forEach((function(e){Cb(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Db(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Cb(t,e,r){return(e=function(t){var e=function(t){if("object"!=Ab(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Ab(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ab(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Lb(t,e){if(t){if("string"==typeof t)return Tb(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Tb(t,e):void 0}}function Tb(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Fb(t){var e,r,n=t.match(/^data:(image\/.+);base64,(.+)$/);if(null===n)throw new Error(["Anthropic only supports base64-encoded images currently.","Example: data:image/png;base64,/9j/4AAQSk..."].join("\n\n"));return{type:"base64",media_type:null!==(e=n[1])&&void 0!==e?e:"",data:null!==(r=n[2])&&void 0!==r?r:""}}function Ib(t){if(void 0===t.id)throw new Error('Anthropic requires all tool calls to have an "id".');return{type:"tool_use",id:t.id,name:t.name,input:t.args}}function Nb(t){var e=["tool_use","tool_result","input_json_delta"],r=["text","text_delta"];return"string"==typeof t?t:t.map((function(t){var n="cache_control"in t?t.cache_control:void 0;if("image_url"===t.type)return Pb({type:"image",source:"string"==typeof t.image_url?Fb(t.image_url):Fb(t.image_url.url)},n?{cache_control:n}:{});if(r.find((function(e){return e===t.type}))&&"text"in t)return Pb({type:"text",text:t.text},n?{cache_control:n}:{});if(e.find((function(e){return e===t.type}))){var o=Pb({},t);if("index"in o&&delete o.index,"input_json_delta"===o.type&&(o.type="tool_use"),"input"in o)try{o.input=JSON.parse(o.input)}catch(t){}return Pb(Pb({},o),n?{cache_control:n}:{})}throw new Error("Unsupported message content format")}))}function Rb(t){var e,r=function(t){var e,r=[],n=function(t){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=Lb(t))){e&&(t=e);var r=0,n=function(){};return{s:n,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,a=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return i=t.done,t},e:function(t){a=!0,o=t},f:function(){try{i||null==e.return||e.return()}finally{if(a)throw o}}}}(t);try{for(n.s();!(e=n.n()).done;){var o=e.value;if("tool"===o._getType())if("string"==typeof o.content){var i=r[r.length-1];"human"===(null==i?void 0:i._getType())&&Array.isArray(i.content)&&"type"in i.content[0]&&"tool_result"===i.content[0].type?i.content.push({type:"tool_result",content:o.content,tool_use_id:o.tool_call_id}):r.push(new to.xc({content:[{type:"tool_result",content:o.content,tool_use_id:o.tool_call_id}]}))}else r.push(new to.xc({content:o.content}));else{var a=r[r.length-1];if("human"===(null==a?void 0:a._getType())&&"human"===o._getType()){var u=void 0;u="string"==typeof a.content?[{type:"text",text:a.content}]:a.content,"string"==typeof o.content?u.push({type:"text",text:o.content}):u=u.concat(o.content),a.content=u}else r.push(o)}}}catch(t){n.e(t)}finally{n.f()}return r}(t);return r.length>0&&"system"===r[0]._getType()&&(e=t[0].content),{messages:(void 0!==e?r.slice(1):r).map((function(t){var e,r,n;if("human"===t._getType())r="user";else if("ai"===t._getType())r="assistant";else{if("tool"!==t._getType())throw"system"===t._getType()?new Error("System messages are only permitted as the first passed message."):new Error('Message type "'.concat(t._getType(),'" is not supported.'));r="user"}if((0,to.KX)(t)&&null!==(e=t.tool_calls)&&void 0!==e&&e.length){if("string"==typeof t.content)return""===t.content?{role:r,content:t.tool_calls.map(Ib)}:{role:r,content:[{type:"text",text:t.content}].concat((n=t.tool_calls.map(Ib),function(t){if(Array.isArray(t))return Tb(t)}(n)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(n)||Lb(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()))};var o=t.content;return!t.tool_calls.every((function(t){return o.find((function(e){return("tool_use"===e.type||"input_json_delta"===e.type)&&e.id===t.id}))}))&&console.warn('The "tool_calls" field on a message is only respected if content is a string.'),{role:r,content:Nb(t.content)}}return{role:r,content:Nb(t.content)}})),system:e}}function Mb(t){return Mb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mb(t)}var Bb=["content","usage"];function Gb(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Ub(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Gb(Object(r),!0).forEach((function(e){zb(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Gb(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function zb(t,e,r){return(e=function(t){var e=function(t){if("object"!=Mb(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Mb(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Mb(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $b(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function qb(t,e){if("message_start"===t.type){for(var r=t.message,n=(r.content,r.usage),o=function(t,e){if(null==t)return{};var r,n,o=function(t,e){if(null==t)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.includes(n))continue;r[n]=t[n]}return r}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.includes(r)||{}.propertyIsEnumerable.call(t,r)&&(o[r]=t[r])}return o}(r,Bb),i={},a=0,u=Object.entries(o);a<u.length;a++){var s=(p=u[a],h=2,function(t){if(Array.isArray(t))return t}(p)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],s=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);s=!0);}catch(t){c=!0,o=t}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(p,h)||function(t,e){if(t){if("string"==typeof t)return $b(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?$b(t,e):void 0}}(p,h)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),c=s[0],l=s[1];null!=l&&(i[c]=l)}var f={input_tokens:n.input_tokens,output_tokens:n.output_tokens,total_tokens:n.input_tokens+n.output_tokens};return{chunk:new to.H({content:e.coerceContentToString?"":[],additional_kwargs:i,usage_metadata:e.streamUsage?f:void 0,id:t.message.id})}}var p,h;if("message_delta"===t.type){var d={input_tokens:0,output_tokens:t.usage.output_tokens,total_tokens:t.usage.output_tokens};return{chunk:new to.H({content:e.coerceContentToString?"":[],additional_kwargs:Ub({},t.delta),usage_metadata:e.streamUsage?d:void 0})}}if("content_block_start"===t.type&&"tool_use"===t.content_block.type)return{chunk:new to.H({content:e.coerceContentToString?"":[Ub(Ub({index:t.index},t.content_block),{},{input:""})],additional_kwargs:{}})};if("content_block_delta"===t.type&&"text_delta"===t.delta.type){var y,v=null===(y=t.delta)||void 0===y?void 0:y.text;if(void 0!==v)return{chunk:new to.H({content:e.coerceContentToString?v:[Ub({index:t.index},t.delta)],additional_kwargs:{}})}}else{if("content_block_delta"===t.type&&"input_json_delta"===t.delta.type)return{chunk:new to.H({content:e.coerceContentToString?"":[{index:t.index,input:t.delta.partial_json,type:t.delta.type}],additional_kwargs:{}})};if("content_block_start"===t.type&&"text"===t.content_block.type){var m,b=null===(m=t.content_block)||void 0===m?void 0:m.text;if(void 0!==b)return{chunk:new to.H({content:e.coerceContentToString?b:[Ub({index:t.index},t.content_block)],additional_kwargs:{}})}}}return null}function Kb(t,e){var r,n,o,i,a=e.usage,u=null!=a?{input_tokens:null!==(r=a.input_tokens)&&void 0!==r?r:0,output_tokens:null!==(n=a.output_tokens)&&void 0!==n?n:0,total_tokens:(null!==(o=a.input_tokens)&&void 0!==o?o:0)+(null!==(i=a.output_tokens)&&void 0!==i?i:0)}:void 0;if(1===t.length&&"text"===t[0].type)return[{text:t[0].text,message:new to.Od({content:t[0].text,additional_kwargs:e,usage_metadata:u,response_metadata:e,id:e.id})}];var s=jb(t);return[{text:"",message:new to.Od({content:t,additional_kwargs:e,tool_calls:s,usage_metadata:u,response_metadata:e,id:e.id})}]}var Hb=["content"],Zb=["role","type"];function Yb(t){return Yb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yb(t)}function Vb(t,e){if(null==t)return{};var r,n,o=function(t,e){if(null==t)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.includes(n))continue;r[n]=t[n]}return r}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.includes(r)||{}.propertyIsEnumerable.call(t,r)&&(o[r]=t[r])}return o}function Wb(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function Jb(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Wb(i,n,o,a,u,"next",t)}function u(t){Wb(i,n,o,a,u,"throw",t)}a(void 0)}))}}function Xb(){Xb=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new P(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function b(){}function g(){}var w={};c(w,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(w=_);var E=g.prototype=m.prototype=Object.create(w);function O(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,i,a,u){var s=f(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==Yb(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=S(u,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?y:h,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=y,n.method="throw",n.arg=c.arg)}}}function S(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,S(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function C(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(Yb(e)+" is not iterable")}return b.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=c(g,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,c(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},O(k.prototype),c(k.prototype,u,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(E),c(E,s,"Generator"),c(E,a,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=C,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),D(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;D(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:C(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function Qb(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function tg(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Qb(Object(r),!0).forEach((function(e){eg(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Qb(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function eg(t,e,r){return(e=ig(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rg(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ng(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ig(n.key),n)}}function og(t,e,r){return e&&ng(t.prototype,e),r&&ng(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function ig(t){var e=function(t){if("object"!=Yb(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Yb(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Yb(e)?e:e+""}function ag(t,e,r){return e=sg(e),function(t,e){if(e&&("object"==Yb(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,ug()?Reflect.construct(e,r||[],sg(t).constructor):e.apply(t,r))}function ug(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(ug=function(){return!!t})()}function sg(t){return sg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},sg(t)}function cg(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&lg(t,e)}function lg(t,e){return lg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},lg(t,e)}function fg(t){return new hg(t,0)}function pg(t){var e,r;function n(e,r){try{var i=t[e](r),a=i.value,u=a instanceof hg;Promise.resolve(u?a.v:a).then((function(r){if(u){var s="return"===e?"return":"next";if(!a.k||r.done)return n(s,r);r=t[s](r).value}o(i.done?"return":"normal",r)}),(function(t){n("throw",t)}))}catch(t){o("throw",t)}}function o(t,o){switch(t){case"return":e.resolve({value:o,done:!0});break;case"throw":e.reject(o);break;default:e.resolve({value:o,done:!1})}(e=e.next)?n(e.key,e.arg):r=null}this._invoke=function(t,o){return new Promise((function(i,a){var u={key:t,arg:o,resolve:i,reject:a,next:null};r?r=r.next=u:(e=r=u,n(t,o))}))},"function"!=typeof t.return&&(this.return=void 0)}function hg(t,e){this.v=t,this.k=e}function dg(t){var e,r,n,o=2;for("undefined"!=typeof Symbol&&(r=Symbol.asyncIterator,n=Symbol.iterator);o--;){if(r&&null!=(e=t[r]))return e.call(t);if(n&&null!=(e=t[n]))return new yg(e.call(t));r="@@asyncIterator",n="@@iterator"}throw new TypeError("Object is not async iterable")}function yg(t){function e(t){if(Object(t)!==t)return Promise.reject(new TypeError(t+" is not an object."));var e=t.done;return Promise.resolve(t.value).then((function(t){return{value:t,done:e}}))}return yg=function(t){this.s=t,this.n=t.next},yg.prototype={s:null,n:null,next:function(){return e(this.n.apply(this.s,arguments))},return:function(t){var r=this.s.return;return void 0===r?Promise.resolve({value:t,done:!0}):e(r.apply(this.s,arguments))},throw:function(t){var r=this.s.return;return void 0===r?Promise.reject(t):e(r.apply(this.s,arguments))}},new yg(t)}function vg(t){return!!(t.tools&&t.tools.length>0)}function mg(t){return"string"==typeof t.content?t.content:Array.isArray(t.content)&&t.content.length>=1&&"input"in t.content[0]?"string"==typeof t.content[0].input?t.content[0].input:JSON.stringify(t.content[0].input):Array.isArray(t.content)&&t.content.length>=1&&"text"in t.content[0]?t.content[0].text:void 0}pg.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},pg.prototype.next=function(t){return this._invoke("next",t)},pg.prototype.throw=function(t){return this._invoke("throw",t)},pg.prototype.return=function(t){return this._invoke("return",t)};var bg=function(t){function e(t){var r,n,o,i,a,u,s,c,l,f,p,h,d,y,v,m;if(rg(this,e),m=ag(this,e,[null!=t?t:{}]),Object.defineProperty(m,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(m,"anthropicApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(m,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(m,"apiUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(m,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(m,"topK",{enumerable:!0,configurable:!0,writable:!0,value:-1}),Object.defineProperty(m,"topP",{enumerable:!0,configurable:!0,writable:!0,value:-1}),Object.defineProperty(m,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:2048}),Object.defineProperty(m,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"claude-2.1"}),Object.defineProperty(m,"model",{enumerable:!0,configurable:!0,writable:!0,value:"claude-2.1"}),Object.defineProperty(m,"invocationKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(m,"stopSequences",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(m,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(m,"clientOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(m,"batchClient",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(m,"streamingClient",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(m,"streamUsage",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(m,"createClient",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),m.anthropicApiKey=null!==(r=null!==(n=null==t?void 0:t.apiKey)&&void 0!==n?n:null==t?void 0:t.anthropicApiKey)&&void 0!==r?r:(0,ah.Az)("ANTHROPIC_API_KEY"),!(m.anthropicApiKey||null!=t&&t.createClient))throw new Error("Anthropic API key not found");return m.clientOptions=null!==(o=null==t?void 0:t.clientOptions)&&void 0!==o?o:{},m.apiKey=m.anthropicApiKey,m.apiUrl=null==t?void 0:t.anthropicApiUrl,m.modelName=null!==(i=null!==(a=null==t?void 0:t.model)&&void 0!==a?a:null==t?void 0:t.modelName)&&void 0!==i?i:m.model,m.model=m.modelName,m.invocationKwargs=null!==(u=null==t?void 0:t.invocationKwargs)&&void 0!==u?u:{},m.temperature=null!==(s=null==t?void 0:t.temperature)&&void 0!==s?s:m.temperature,m.topK=null!==(c=null==t?void 0:t.topK)&&void 0!==c?c:m.topK,m.topP=null!==(l=null==t?void 0:t.topP)&&void 0!==l?l:m.topP,m.maxTokens=null!==(f=null!==(p=null==t?void 0:t.maxTokensToSample)&&void 0!==p?p:null==t?void 0:t.maxTokens)&&void 0!==f?f:m.maxTokens,m.stopSequences=null!==(h=null==t?void 0:t.stopSequences)&&void 0!==h?h:m.stopSequences,m.streaming=null!==(d=null==t?void 0:t.streaming)&&void 0!==d&&d,m.streamUsage=null!==(y=null==t?void 0:t.streamUsage)&&void 0!==y?y:m.streamUsage,m.createClient=null!==(v=null==t?void 0:t.createClient)&&void 0!==v?v:function(t){return new Xm(t)},m}return cg(e,t),og(e,[{key:"lc_secrets",get:function(){return{anthropicApiKey:"ANTHROPIC_API_KEY",apiKey:"ANTHROPIC_API_KEY"}}},{key:"lc_aliases",get:function(){return{modelName:"model"}}},{key:"getLsParams",value:function(t){var e,r,n=this.invocationParams(t);return{ls_provider:"anthropic",ls_model_name:this.model,ls_model_type:"chat",ls_temperature:null!==(e=n.temperature)&&void 0!==e?e:void 0,ls_max_tokens:null!==(r=n.max_tokens)&&void 0!==r?r:void 0,ls_stop:t.stop}}},{key:"formatStructuredToolToAnthropic",value:function(t){if(t&&t.length)return t.map((function(t){if(function(t){return"input_schema"in t}(t))return t;if((0,Bo.VC)(t))return{name:t.function.name,description:t.function.description,input_schema:t.function.parameters};if(Ko(t))return{name:t.name,description:t.description,input_schema:(0,Mo.Ik)(t.schema)};throw new Error("Unknown tool type passed to ChatAnthropic: ".concat(JSON.stringify(t,null,2)))}))}},{key:"bindTools",value:function(t,e){return this.bind(tg({tools:this.formatStructuredToolToAnthropic(t)},e))}},{key:"invocationParams",value:function(t){var e,r,n=(r=null==t?void 0:t.tool_choice)?"any"===r?{type:"any"}:"auto"===r?{type:"auto"}:"string"==typeof r?{type:"tool",name:r}:r:void 0;return tg({model:this.model,temperature:this.temperature,top_k:this.topK,top_p:this.topP,stop_sequences:null!==(e=null==t?void 0:t.stop)&&void 0!==e?e:this.stopSequences,stream:this.streaming,max_tokens:this.maxTokens,tools:this.formatStructuredToolToAnthropic(null==t?void 0:t.tools),tool_choice:n},this.invocationKwargs)}},{key:"_identifyingParams",value:function(){return tg({model_name:this.model},this.invocationParams())}},{key:"identifyingParams",value:function(){return tg({model_name:this.model},this.invocationParams())}},{key:"_streamResponseChunks",value:function(t,e,r){var n,o=this;return(n=Xb().mark((function n(){var i,a,u,s,c,l,f,p,h,d,y,v,m,b,g,w,x;return Xb().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=o.invocationParams(e),a=Rb(t),u=!vg(tg(tg(tg({},i),a),{},{stream:!1})),n.next=5,fg(o.createStreamWithRetry(tg(tg(tg({},i),a),{},{stream:!0}),{headers:e.headers}));case 5:s=n.sent,c=!1,l=!1,n.prev=8,p=dg(s);case 10:return n.next=12,fg(p.next());case 12:if(!(c=!(h=n.sent).done)){n.next=32;break}if(d=h.value,null===(y=e.signal)||void 0===y||!y.aborted){n.next=17;break}throw s.controller.abort(),new Error("AbortError: User aborted the request.");case 17:if(m=null!==(v=o.streamUsage)&&void 0!==v?v:e.streamUsage,b=qb(d,{streamUsage:m,coerceContentToString:u})){n.next=21;break}return n.abrupt("continue",29);case 21:return g=b.chunk,w=Sb(g),x=mg(g),n.next=26,new ih.Cf({message:new to.H({content:g.content,additional_kwargs:g.additional_kwargs,tool_call_chunks:w?[w]:void 0,usage_metadata:m?g.usage_metadata:void 0,response_metadata:g.response_metadata,id:g.id}),text:null!=x?x:""});case 26:if(!x){n.next=29;break}return n.next=29,fg(null==r?void 0:r.handleLLMNewToken(x));case 29:c=!1,n.next=10;break;case 32:n.next=38;break;case 34:n.prev=34,n.t0=n.catch(8),l=!0,f=n.t0;case 38:if(n.prev=38,n.prev=39,!c||null==p.return){n.next=43;break}return n.next=43,fg(p.return());case 43:if(n.prev=43,!l){n.next=46;break}throw f;case 46:return n.finish(43);case 47:return n.finish(38);case 48:case"end":return n.stop()}}),n,null,[[8,34,38,48],[39,,43,47]])})),function(){return new pg(n.apply(this,arguments))})()}},{key:"_generateNonStreaming",value:(i=Jb(Xb().mark((function t(e,r,n){var o,i,a,u,s;return Xb().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.completionWithRetry(tg(tg({},r),{},{stream:!1},Rb(e)),n);case 2:return o=t.sent,i=o.content,a=Vb(o,Hb),u=Kb(i,a),a.role,a.type,s=Vb(a,Zb),t.abrupt("return",{generations:u,llmOutput:s});case 7:case"end":return t.stop()}}),t,this)}))),function(t,e,r){return i.apply(this,arguments)})},{key:"_generate",value:(o=Jb(Xb().mark((function t(e,r,n){var o,i,a,u,s,c,l,f,p;return Xb().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.stopSequences||!r.stop){t.next=2;break}throw new Error('"stopSequence" parameter found in input and default params');case 2:if(!(o=this.invocationParams(r)).stream){t.next=38;break}a=this._streamResponseChunks(e,r,n),u=!1,s=!1,t.prev=7,l=dg(a);case 9:return t.next=11,l.next();case 11:if(!(u=!(f=t.sent).done)){t.next=17;break}p=f.value,i=void 0===i?p:i.concat(p);case 14:u=!1,t.next=9;break;case 17:t.next=23;break;case 19:t.prev=19,t.t0=t.catch(7),s=!0,c=t.t0;case 23:if(t.prev=23,t.prev=24,!u||null==l.return){t.next=28;break}return t.next=28,l.return();case 28:if(t.prev=28,!s){t.next=31;break}throw c;case 31:return t.finish(28);case 32:return t.finish(23);case 33:if(void 0!==i){t.next=35;break}throw new Error("No chunks returned from Anthropic API.");case 35:return t.abrupt("return",{generations:[{text:i.text,message:i.message}]});case 38:return t.abrupt("return",this._generateNonStreaming(e,o,{signal:r.signal,headers:r.headers}));case 39:case"end":return t.stop()}}),t,this,[[7,19,23,33],[24,,28,32]])}))),function(t,e,r){return o.apply(this,arguments)})},{key:"createStreamWithRetry",value:(n=Jb(Xb().mark((function t(e,r){var n,o,i=this;return Xb().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.streamingClient||(n=this.apiUrl?{baseURL:this.apiUrl}:void 0,this.streamingClient=this.createClient(tg(tg(tg({},this.clientOptions),n),{},{apiKey:this.apiKey,maxRetries:0}))),o=function(){var t=Jb(Xb().mark((function t(){return Xb().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",i.streamingClient.messages.create(tg(tg(tg({},e),i.invocationKwargs),{},{stream:!0}),r));case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),t.abrupt("return",this.caller.call(o));case 3:case"end":return t.stop()}}),t,this)}))),function(t,e){return n.apply(this,arguments)})},{key:"completionWithRetry",value:(r=Jb(Xb().mark((function t(e,r){var n,o,i,a=this;return Xb().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.batchClient||(o=this.apiUrl?{baseURL:this.apiUrl}:void 0,this.batchClient=this.createClient(tg(tg(tg({},this.clientOptions),o),{},{apiKey:this.apiKey,maxRetries:0}))),i=function(){var t=Jb(Xb().mark((function t(){return Xb().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",a.batchClient.messages.create(tg(tg({},e),a.invocationKwargs),r));case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),t.abrupt("return",this.caller.callWithOptions({signal:null!==(n=r.signal)&&void 0!==n?n:void 0},i));case 3:case"end":return t.stop()}}),t,this)}))),function(t,e){return r.apply(this,arguments)})},{key:"_llmType",value:function(){return"anthropic"}},{key:"withStructuredOutput",value:function(t,e){var r=t,n=null==e?void 0:e.name,o=null==e?void 0:e.method,i=null==e?void 0:e.includeRaw;if("jsonMode"===o)throw new Error('Anthropic only supports "functionCalling" as a method.');var a,u,s=null!=n?n:"extract";if(Zr(r)){var c,l=(0,Mo.Ik)(r);u=[{name:s,description:null!==(c=l.description)&&void 0!==c?c:"A function available to call.",input_schema:l}],a=new kb({returnSingle:!0,keyName:s,zodSchema:r})}else{var f,p;"string"==typeof r.name&&"string"==typeof r.description&&"object"===Yb(r.input_schema)&&null!=r.input_schema?(f=r,s=r.name):f={name:s,description:null!==(p=r.description)&&void 0!==p?p:"",input_schema:r},u=[f],a=new kb({returnSingle:!0,keyName:s})}var h=this.bind({tools:u,tool_choice:{type:"tool",name:s}});if(!i)return h.pipe(a).withConfig({runName:"ChatAnthropicStructuredOutput"});var d=xn.kI.assign({parsed:function(t,e){return a.invoke(t.raw,e)}}),y=xn.kI.assign({parsed:function(){return null}}),v=d.withFallbacks({fallbacks:[y]});return xn.zZ.from([{raw:h},v]).withConfig({runName:"StructuredOutputRunnable"})}}],[{key:"lc_name",value:function(){return"ChatAnthropic"}}]);var r,n,o,i}(Fh),gg=function(t){function e(){return rg(this,e),ag(this,e,arguments)}return cg(e,t),og(e)}(bg);function wg(t){return wg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wg(t)}var xg=jo.prototype.addAIChatMessage;function _g(t){return _g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_g(t)}function Eg(){Eg=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new P(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function b(){}function g(){}var w={};c(w,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(w=_);var E=g.prototype=m.prototype=Object.create(w);function O(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,i,a,u){var s=f(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==_g(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=S(u,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?y:h,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=y,n.method="throw",n.arg=c.arg)}}}function S(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,S(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function C(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(_g(e)+" is not iterable")}return b.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=c(g,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,c(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},O(k.prototype),c(k.prototype,u,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(E),c(E,s,"Generator"),c(E,a,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=C,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),D(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;D(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:C(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function Og(t){return new jg(t,0)}function kg(t){var e,r;function n(e,r){try{var i=t[e](r),a=i.value,u=a instanceof jg;Promise.resolve(u?a.v:a).then((function(r){if(u){var s="return"===e?"return":"next";if(!a.k||r.done)return n(s,r);r=t[s](r).value}o(i.done?"return":"normal",r)}),(function(t){n("throw",t)}))}catch(t){o("throw",t)}}function o(t,o){switch(t){case"return":e.resolve({value:o,done:!0});break;case"throw":e.reject(o);break;default:e.resolve({value:o,done:!1})}(e=e.next)?n(e.key,e.arg):r=null}this._invoke=function(t,o){return new Promise((function(i,a){var u={key:t,arg:o,resolve:i,reject:a,next:null};r?r=r.next=u:(e=r=u,n(t,o))}))},"function"!=typeof t.return&&(this.return=void 0)}function jg(t,e){this.v=t,this.k=e}function Sg(t){var e,r,n,o=2;for("undefined"!=typeof Symbol&&(r=Symbol.asyncIterator,n=Symbol.iterator);o--;){if(r&&null!=(e=t[r]))return e.call(t);if(n&&null!=(e=t[n]))return new Ag(e.call(t));r="@@asyncIterator",n="@@iterator"}throw new TypeError("Object is not async iterable")}function Ag(t){function e(t){if(Object(t)!==t)return Promise.reject(new TypeError(t+" is not an object."));var e=t.done;return Promise.resolve(t.value).then((function(t){return{value:t,done:e}}))}return Ag=function(t){this.s=t,this.n=t.next},Ag.prototype={s:null,n:null,next:function(){return e(this.n.apply(this.s,arguments))},return:function(t){var r=this.s.return;return void 0===r?Promise.resolve({value:t,done:!0}):e(r.apply(this.s,arguments))},throw:function(t){var r=this.s.return;return void 0===r?Promise.reject(t):e(r.apply(this.s,arguments))}},new Ag(t)}jo.prototype.addAIChatMessage=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return Array.isArray(e)&&e.length>0&&"object"===wg(e[0])&&null!==e[0]&&"text"in e[0][0]?xg.call(this,e[0][0].text):xg.call.apply(xg,[this].concat(e))},kg.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},kg.prototype.next=function(t){return this._invoke("next",t)},kg.prototype.throw=function(t){return this._invoke("throw",t)},kg.prototype.return=function(t){return this._invoke("return",t)};var Dg=bg.prototype._streamResponseChunks;function Pg(t){return Pg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pg(t)}function Cg(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Lg(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Cg(Object(r),!0).forEach((function(e){Mg(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Cg(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Tg(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Fg(){Fg=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new P(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function b(){}function g(){}var w={};c(w,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(w=_);var E=g.prototype=m.prototype=Object.create(w);function O(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,i,a,u){var s=f(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==Pg(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=S(u,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?y:h,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=y,n.method="throw",n.arg=c.arg)}}}function S(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,S(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function C(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(Pg(e)+" is not iterable")}return b.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=c(g,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,c(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},O(k.prototype),c(k.prototype,u,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(E),c(E,s,"Generator"),c(E,a,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=C,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),D(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;D(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:C(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function Ig(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function Ng(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Ig(i,n,o,a,u,"next",t)}function u(t){Ig(i,n,o,a,u,"throw",t)}a(void 0)}))}}function Rg(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Bg(n.key),n)}}function Mg(t,e,r){return(e=Bg(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Bg(t){var e=function(t){if("object"!=Pg(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Pg(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Pg(e)?e:e+""}bg.prototype._streamResponseChunks=function(){var t,e=(t=Eg().mark((function t(e,r,n){var o,i,a,u,s,c,l;return Eg().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:o=Dg.call(this,e,r,n),i=!1,a=!1,t.prev=3,s=Sg(o);case 5:return t.next=7,Og(s.next());case 7:if(!(i=!(c=t.sent).done)){t.next=16;break}return l=c.value,t.next=11,Og(null==n?void 0:n.handleLLMNewToken(l.token,void 0,void 0,void 0,void 0,{chunk:l}));case 11:return t.next=13,l;case 13:i=!1,t.next=5;break;case 16:t.next=22;break;case 18:t.prev=18,t.t0=t.catch(3),a=!0,u=t.t0;case 22:if(t.prev=22,t.prev=23,!i||null==s.return){t.next=27;break}return t.next=27,Og(s.return());case 27:if(t.prev=27,!a){t.next=30;break}throw u;case 30:return t.finish(27);case 31:return t.finish(22);case 32:case"end":return t.stop()}}),t,this,[[3,18,22,32],[23,,27,31]])})),function(){return new kg(t.apply(this,arguments))});return function(t,r,n){return e.apply(this,arguments)}}();var Gg=function(){function t(e){var r,n,o,i=e.llmModel,a=e.sqlite,u=e.agentOptions;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Mg(this,"llmModel",void 0),Mg(this,"provider",void 0),Mg(this,"systemMessageString",void 0),Mg(this,"systemMessageTemplate",void 0),Mg(this,"sqlToolkit",void 0),Mg(this,"tools",[]),Mg(this,"fuzzySearchInstance",void 0),Mg(this,"fuzzySearchTool",void 0),Mg(this,"runnableAgent",void 0),Mg(this,"executor",void 0),Mg(this,"memory",void 0),Mg(this,"db",void 0),Mg(this,"decimalSeparator",void 0),Mg(this,"customSystemMessage",void 0),Mg(this,"language",void 0),Mg(this,"languageCode",void 0),this.llmModel=i,this.provider=function(t){if(t instanceof gg)return"anthropic";if(t instanceof ky)return"openai";throw new Error("Invalid provider.")}(this.llmModel),this.db=a,this.decimalSeparator=null!==(r=null==u?void 0:u.decimalSeparator)&&void 0!==r?r:"auto",this.customSystemMessage=null==u?void 0:u.customSystemMessage,this.language=null!==(n=null==u?void 0:u.language)&&void 0!==n?n:"auto",this.languageCode=null!==(o=null==u?void 0:u.languageCode)&&void 0!==o?o:"auto"}return e=t,r=[{key:"init",value:(u=Ng(Fg().mark((function t(){return Fg().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._initFuzzySearch(),this._initTools(),t.next=4,this._initExecutor();case 4:case"end":return t.stop()}}),t,this)}))),function(){return u.apply(this,arguments)})},{key:"_initTools",value:function(){var t,e,r,n;this.tools=[],this.sqlToolkit=new ki(this.db,this.decimalSeparator),(t=this.tools).push.apply(t,function(t){if(Array.isArray(t))return Tg(t)}(n=this.sqlToolkit.tools)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(n)||function(t,e){if(t){if("string"==typeof t)return Tg(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Tg(t,e):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),this.tools.push(Us),this.fuzzySearchTool=function(t,e){return new mn({name:"fuzzy-search",description:"descFunc3",schema:Ur.z.object({fuzzySearch:Ur.z.array(Ur.z.string()).describe("desc")}),func:(r=Ha().mark((function t(r){var n,o;return Ha().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=r.fuzzySearch,t.prev=1,o=[],n.forEach((function(t){var r=e.search(t);r.length>0&&o.push(r)})),t.abrupt("return",JSON.stringify(o.flat()));case 7:return t.prev=7,t.t0=t.catch(1),t.abrupt("return","error: ".concat(t.t0.message));case 10:case"end":return t.stop()}}),t,null,[[1,7]])})),n=function(){var t=this,e=arguments;return new Promise((function(n,o){var i=r.apply(t,e);function a(t){Za(i,n,o,a,u,"next",t)}function u(t){Za(i,n,o,a,u,"throw",t)}a(void 0)}))},function(t){return n.apply(this,arguments)})});var r,n}(this.db,this.fuzzySearchInstance),this.tools.push(this.fuzzySearchTool),this.tools.push(Hs),this.tools.push(Js),this.tools.push((e=this.decimalSeparator,r=this.languageCode,new mn({name:"format-number",description:"descFunc6",schema:Ur.z.object({numbers:Ur.z.array(Ur.z.number()).describe("desc"),percentage:Ur.z.array(Ur.z.boolean()).describe("desc"),multiplyBy100:Ur.z.array(Ur.z.boolean()).describe("desc"),language:Ur.z.string().describe("desc")}),func:function(){var t=function(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){tc(i,n,o,a,u,"next",t)}function u(t){tc(i,n,o,a,u,"throw",t)}a(void 0)}))}}(Qs().mark((function t(n){var o,i,a,u;return Qs().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=n.numbers,i=n.percentage,a=n.multiplyBy100,u=n.language,t.prev=1,t.abrupt("return",JSON.stringify(o.map((function(t,n){try{var o,s,c=Number(zs(String(a[n]?100*Number(t):t))),l=i[n]?"%":"";if(o=ec(c)?2:(null===(s=c.toString().split(".")[1])||void 0===s?void 0:s.length)||0,"auto"!==e){var f=c.toLocaleString("en-US",{minimumFractionDigits:o});return("."===e?f:f.replace(".","||").replace(/,/g,".").replace("||",","))+l}return("auto"!==r?c.toLocaleString(r,{minimumFractionDigits:o}):c.toLocaleString(null!=u?u:"en-US",{minimumFractionDigits:o}))+l}catch(t){return"Not a valid number."}}))));case 5:return t.prev=5,t.t0=t.catch(1),t.abrupt("return","error: ".concat(t.t0.message));case 8:case"end":return t.stop()}}),t,null,[[1,5]])})));return function(e){return t.apply(this,arguments)}}()})))}},{key:"_initFuzzySearch",value:function(){this.fuzzySearchInstance=new qa(this.db.pbiData)}},{key:"_initExecutor",value:(a=Ng(Fg().mark((function t(){var e,r;return Fg().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=this.db.DESCRIPTION?"\nTABLE DESCRIPTION\n".concat(this.db.DESCRIPTION):"",r=this.customSystemMessage?"ADDITIONAL GUIDANCE\n"+this.customSystemMessage:"",this.systemMessageString=(0,eo.Xm)("<<sysPrompt1>>\n'''tableName\n{table_name}\n'''\n{table_description}\n\n<<sysPrompt2>>\n\n<<sysPrompt3>>\n\n<<sysPrompt4>>\n\n<<sysPrompt5>>\n\n<<sysPrompt6>>\n\n<<sysPrompt7>>\n\n<<sysPrompt8>>\n'''columnList\n<_column_list_>\n'''\n'''rowsDescription\n<_rows_description_>\n'''\n\n<<sysPrompt9>>\n\n<<sysPrompt10>>\n'''language\n{language}\n'''\n\n{custom_system_message}\n","f-string",{table_name:this.db.TABLENAME,table_description:e,custom_system_message:r,language:this.language}),this.memory=new di({returnMessages:!0,memoryKey:"chat_history",inputKey:"input",outputKey:"output",k:3}),this.systemMessageTemplate=eo.BJ.fromTemplate(this.systemMessageString),this.runnableAgent=oi({llm:this.llmModel,tools:this.tools,prompt:eo.RZ.fromMessages([this.systemMessageTemplate,new eo.GL("chat_history"),["human","{input}"],new eo.GL("agent_scratchpad")]),streamRunnable:!0}),this.executor=new Qn({agent:this.runnableAgent,tools:this.tools,maxIterations:7,memory:this.memory,returnIntermediateSteps:!1});case 7:case"end":return t.stop()}}),t,this)}))),function(){return a.apply(this,arguments)})},{key:"_updateSystemMessage",value:function(){var t=this.systemMessageString;t=(t=t.replace("<_rows_description_>",this._gen_row_description())).replace("<_column_list_>",this.db.getStringSchema(!0,!0)),this.systemMessageTemplate.prompt.template=t}},{key:"ask",value:(i=Ng(Fg().mark((function t(e,r,n){var o;return Fg().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._updateSystemMessage(),t.next=3,this.executor.invoke({input:e,signal:n?n.signal:void 0},r?{callbacks:[r]}:void 0);case 3:return o=t.sent,t.abrupt("return",Lg({},o));case 5:case"end":return t.stop()}}),t,this)}))),function(t,e,r){return i.apply(this,arguments)})},{key:"_gen_row_description",value:function(){var t=this,e=[],r=[];Object.keys(this.db.pbiData).forEach((function(n){("measure"===t.db.pbiData[n].origin?e:r).push(n)}));var n=function(t,e){var r=e?"'":"";if(1===t.length)return"".concat(r).concat(t[0]).concat(r);var n=t.slice(0,t.length-1),o=t[t.length-1];return"'".concat(n.join("".concat(r,", ").concat(r)),"' and ").concat(r).concat(o).concat(r)},o="";return e.length>0&&r.length>0?o="1/<|||>/".concat(n(r,!0),"/<|||>/").concat(n(e,!0)):0===e.length&&r.length>0?o="2/<|||>/".concat(n(r,!0)):e.length>0&&0===r.length&&(o="3/<|||>/".concat(n(e,!0))),Object.keys(this.db.columnsDecimal).length>0&&this.db.decimalAsInteger&&(o+="\n\nWhen working with values from the columns below you must take a breath and do these operations:"+Object.keys(this.db.columnsDecimal).map((function(e){return"\n"+"".concat(e,": divide by ").concat(Math.pow(10,t.db.columnsDecimal[e]),".0")})).join("\n")),Object.keys(this.db.pbiData).some((function(e){return"BOOLEAN"===t.db.pbiData[e].type}))&&(o+="\n\nWhen returning values from columns of boolean type, replace 1 with 'True' and 0 with 'False'."),Object.keys(this.db.pbiData).some((function(e){return"TIME"===t.db.pbiData[e].type}))&&(o+="\n\n"+"When returning values from columns of time type, always use the '".concat(Ws,"' function to return the correct time.")),o}}],n=[{key:"build",value:(o=Ng(Fg().mark((function e(r){var n,o,i,a;return Fg().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.llmModel,o=r.sqlite,i=r.agentOptions,a=new t({llmModel:n,sqlite:o,agentOptions:i}),e.next=4,a.init();case 4:return e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)}))),function(t){return o.apply(this,arguments)})}],r&&Rg(e.prototype,r),n&&Rg(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,n,o,i,a,u}();function Ug(t){return Ug="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ug(t)}function zg(){zg=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new P(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function b(){}function g(){}var w={};c(w,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(w=_);var E=g.prototype=m.prototype=Object.create(w);function O(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,i,a,u){var s=f(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==Ug(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=S(u,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?y:h,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=y,n.method="throw",n.arg=c.arg)}}}function S(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,S(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function C(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(Ug(e)+" is not iterable")}return b.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=c(g,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,c(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},O(k.prototype),c(k.prototype,u,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(E),c(E,s,"Generator"),c(E,a,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=C,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),D(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;D(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:C(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function $g(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function qg(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Vg(n.key),n)}}function Kg(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Kg=function(){return!!t})()}function Hg(t){return Hg=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Hg(t)}function Zg(t,e){return Zg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Zg(t,e)}function Yg(t,e,r){return(e=Vg(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Vg(t){var e=function(t){if("object"!=Ug(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Ug(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ug(e)?e:e+""}var Wg=function(t){function e(t){var r,n=t.streamMessage,o=t.messageIdx,i=t.controller;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Yg(r=function(t,e,r){return e=Hg(e),function(t,e){if(e&&("object"==Ug(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Kg()?Reflect.construct(e,r||[],Hg(t).constructor):e.apply(t,r))}(this,e),"name","stream_callback_handler"),Yg(r,"streamMessage",void 0),Yg(r,"messageIdx",void 0),Yg(r,"controller",void 0),r.streamMessage=n,r.messageIdx=o,r.controller=i,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Zg(t,e)}(e,t),r=e,n=[{key:"handleLLMNewToken",value:(o=function(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){$g(i,n,o,a,u,"next",t)}function u(t){$g(i,n,o,a,u,"throw",t)}a(void 0)}))}}(zg().mark((function t(e,r,n,o,i,a){var u,s,c;return zg().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s=!a,c=a&&(null===(u=a.chunk)||void 0===u||null===(u=u.message)||void 0===u||null===(u=u.tool_call_chunks)||void 0===u?void 0:u.length)>0,!s&&!c){t.next=3;break}return t.abrupt("return");case 3:if(this.controller.signal.aborted){t.next=6;break}return t.next=6,this.streamMessage(this.messageIdx,a.chunk.text);case 6:case"end":return t.stop()}}),t,this)}))),function(t,e,r,n,i,a){return o.apply(this,arguments)})}],n&&qg(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(o(491).N),Jg=["temperature","basePath","apiKeyLlm","licenseKey","visualVersion","suffix","token","ref","byollmHeaders","byollmModel","byollmUrl","byollmInst"];function Xg(t){return Xg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xg(t)}function Qg(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function tw(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Qg(Object(r),!0).forEach((function(e){rw(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Qg(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function ew(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,nw(n.key),n)}}function rw(t,e,r){return(e=nw(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nw(t){var e=function(t){if("object"!=Xg(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Xg(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Xg(e)?e:e+""}var ow=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),rw(this,"model",void 0),rw(this,"defaultModelName",void 0),rw(this,"baseUrl",void 0),rw(this,"maxRetries",void 0),rw(this,"options",void 0),rw(this,"chatId",void 0),rw(this,"lastMessageIdx",void 0),this.options=tw(tw({},e),{},{apiKeyLlm:e.apiKeyLlm||"x"}),this.initProperties(),this.initModel()},e=[{key:"initModel",value:function(){var t=this.options,e=t.temperature,r=t.basePath,n=t.apiKeyLlm,o=t.licenseKey,i=t.visualVersion,a=t.suffix,u=t.token,s=t.ref,c=(t.byollmHeaders,t.byollmModel),l=t.byollmUrl,f=(t.byollmInst,function(t,e){if(null==t)return{};var r,n,o=function(t,e){if(null==t)return{};var r={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(e.includes(n))continue;r[n]=t[n]}return r}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)r=i[n],e.includes(r)||{}.propertyIsEnumerable.call(t,r)&&(o[r]=t[r])}return o}(t,Jg)),p=l?void 0:{"Content-Type":"application/json","x-license-key":o,"x-visual-version":i,"x-cpbi-token":u,"x-cpbi-ref":s};this.baseUrl=new URL(l?"":null!=a?a:"",l||r).toString(),this.model=this.createModelInstance(tw({model:null!=c?c:this.defaultModelName,temperature:e,apiKey:n,streaming:!0,maxRetries:this.maxRetries,configuration:{baseURL:this.baseUrl,defaultHeaders:p,fetch:this.wrapperFetch.bind(this)}},f))}}],e&&ew(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function iw(t){return iw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},iw(t)}function aw(){aw=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new P(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function b(){}function g(){}var w={};c(w,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(w=_);var E=g.prototype=m.prototype=Object.create(w);function O(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,i,a,u){var s=f(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==iw(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=S(u,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?y:h,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=y,n.method="throw",n.arg=c.arg)}}}function S(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,S(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function C(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(iw(e)+" is not iterable")}return b.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=c(g,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,c(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},O(k.prototype),c(k.prototype,u,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(E),c(E,s,"Generator"),c(E,a,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=C,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),D(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;D(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:C(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function uw(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function sw(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?uw(Object(r),!0).forEach((function(e){cw(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):uw(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function cw(t,e,r){return(e=pw(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function lw(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function fw(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,pw(n.key),n)}}function pw(t){var e=function(t){if("object"!=iw(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=iw(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==iw(e)?e:e+""}function hw(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(hw=function(){return!!t})()}function dw(t){return dw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},dw(t)}function yw(t,e){return yw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},yw(t,e)}var vw=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=dw(e),function(t,e){if(e&&("object"==iw(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,hw()?Reflect.construct(e,r||[],dw(t).constructor):e.apply(t,r))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&yw(t,e)}(e,t),r=e,n=[{key:"initProperties",value:function(){this.defaultModelName="gpt-4o-mini"}},{key:"createModelInstance",value:function(t){var e=t.model,r=t.temperature,n=t.apiKey,o=t.streaming,i=t.maxRetries,a=t.configuration,u=a.baseURL,s=a.defaultHeaders,c=a.fetch;return new ky({model:e,temperature:r,apiKey:n,streaming:o,maxRetries:i,configuration:{baseURL:u,defaultHeaders:s,fetch:c}})}},{key:"wrapperFetch",value:(o=function(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){lw(i,n,o,a,u,"next",t)}function u(t){lw(i,n,o,a,u,"throw",t)}a(void 0)}))}}(aw().mark((function t(){var e,r,n,o,i,a,u,s,c,l=this,f=arguments;return aw().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=f.length<=0?void 0:f[0],r=f.length<=1?void 0:f[1],(n=this.options.byollmUrl)&&this.options.byollmInst)try{(i=JSON.parse(null==r?void 0:r.body)).messages&&(i.messages=this.treatSystemMessage(i.messages,this.options.byollmInst.systemPlaceholders)),i.tools&&(i.tools=this.treatTools(i.tools,this.options.byollmInst.functionsPlaceholders)),o=JSON.stringify(i,null,2)}catch(t){console.error(t),o=null==r?void 0:r.body}else o=null==r?void 0:r.body;return a={},n?(delete(s=sw({},null==r?void 0:r.headers)).authorization,a=sw(sw({},s),{},{"content-length":this.calculateContentLength(o)},Object.keys(null!==(u=this.options.byollmHeaders)&&void 0!==u?u:{}).reduce((function(t,e){return t[e.toLowerCase()]=l.options.byollmHeaders[e].replace("<key_placeholder>",l.options.apiKeyLlm),t}),{}))):a=sw(sw({},null!==(c=null==r?void 0:r.headers)&&void 0!==c?c:{}),{},{"x-cpbi-user":"".concat(this.chatId,"-").concat(this.lastMessageIdx)}),t.abrupt("return",fetch(this.options.byollmUrl?this.baseUrl:e.toString(),sw(sw({},r),{},{headers:sw({},a),body:o})));case 6:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"calculateContentLength",value:function(t){if("string"==typeof t){if("undefined"!=typeof Buffer)return Buffer.byteLength(t,"utf8").toString();if("undefined"!=typeof TextEncoder)return(new TextEncoder).encode(t).length.toString()}else if(ArrayBuffer.isView(t))return t.byteLength.toString();return""}},{key:"treatTools",value:function(t,e){return t.map((function(t){if("function"===t.type){var r=t.function,n=e[r.name];if(!n)return t;r.description=n.description,r.parameters&&Object.keys(r.parameters.properties).forEach((function(t){var e;null!==(e=n.parameters)&&void 0!==e&&e.properties&&n.parameters.properties[t]&&(r.parameters.properties[t].description=n.parameters.properties[t].description)}))}return t}))}},{key:"treatSystemMessage",value:function(t,e){var r=/<<([a-zA-Z0-9]+)>>/g;return t.map((function(t){if("system"===t.role){t.content=t.content.replace(r,(function(t,r){return e[r]?e[r]:t}));var n=Di(t.content,"tableName");n&&(t.content=Pi(t.content,"tableName"),t.content=t.content.replace("{table_name}",n));var o=Di(t.content,"columnList");o&&(t.content=Pi(t.content,"columnList"),t.content=t.content.replace("<_column_list_>",o));var i=Di(t.content,"rowsDescription");if(i){t.content=Pi(t.content,"rowsDescription");var a=i.split("/<|||>/"),u="";"1"===a[0]?u="For the same ".concat(a[1]," there is more than one row with ").concat(a[2]," values. Therefore, always summarize the data (use 'GROUP BY' statement)."):"2"!==a[0]&&"3"!==a[0]||(u="There is more than one row with ".concat(a[1]," values. Therefore, always summarize the data (use 'GROUP BY' statement).")),t.content=t.content.replace("<_rows_description_>",u)}var s=Di(t.content,"language");if(s){var c="auto"===s?"Provide the answer to the question in the same language as the input question.":"You must only answer and communicate in '".concat(s,"', regardless of the language used by the user.");t.content=Pi(t.content,"language"),t.content=t.content.replace("<_language_>",c)}}return t}))}}],n&&fw(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(ow);function mw(t){return mw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mw(t)}function bw(){bw=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new P(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function b(){}function g(){}var w={};c(w,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(w=_);var E=g.prototype=m.prototype=Object.create(w);function O(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,i,a,u){var s=f(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==mw(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=S(u,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?y:h,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=y,n.method="throw",n.arg=c.arg)}}}function S(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,S(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function C(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(mw(e)+" is not iterable")}return b.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=c(g,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,c(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},O(k.prototype),c(k.prototype,u,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(E),c(E,s,"Generator"),c(E,a,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=C,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),D(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;D(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:C(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function gw(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function ww(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?gw(Object(r),!0).forEach((function(e){xw(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):gw(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function xw(t,e,r){return(e=Ow(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _w(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function Ew(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ow(n.key),n)}}function Ow(t){var e=function(t){if("object"!=mw(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=mw(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==mw(e)?e:e+""}function kw(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(kw=function(){return!!t})()}function jw(t){return jw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},jw(t)}function Sw(t,e){return Sw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Sw(t,e)}var Aw=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,r){return e=jw(e),function(t,e){if(e&&("object"==mw(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,kw()?Reflect.construct(e,r||[],jw(t).constructor):e.apply(t,r))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Sw(t,e)}(e,t),r=e,n=[{key:"initProperties",value:function(){this.defaultModelName="claude-3-haiku-20240307"}},{key:"createModelInstance",value:function(t){var e=t.model,r=t.temperature,n=t.apiKey,o=t.streaming,i=t.maxRetries,a=t.configuration,u=a.baseURL,s=a.defaultHeaders,c=a.fetch;return new gg({model:e,temperature:r,apiKey:n,streaming:o,maxRetries:i,maxTokens:8192,clientOptions:{baseURL:u,defaultHeaders:s,fetch:c,dangerouslyAllowBrowser:!0}})}},{key:"wrapperFetch",value:(o=function(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){_w(i,n,o,a,u,"next",t)}function u(t){_w(i,n,o,a,u,"throw",t)}a(void 0)}))}}(bw().mark((function t(){var e,r,n,o,i,a,u,s,c,l=this,f=arguments;return bw().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=f.length<=0?void 0:f[0],r=f.length<=1?void 0:f[1],(n=this.options.byollmUrl)&&this.options.byollmInst)try{(i=JSON.parse(null==r?void 0:r.body)).system&&(i.system=this.treatSystemMessage(i.system,this.options.byollmInst.systemPlaceholders)),i.tools&&(i.tools=this.treatTools(i.tools,this.options.byollmInst.functionsPlaceholders)),o=JSON.stringify(i,null,2)}catch(t){console.error(t),o=null==r?void 0:r.body}else o=null==r?void 0:r.body;return a={},n?(delete(s=ww({},null==r?void 0:r.headers)).authorization,a=ww(ww({},s),{},{"content-length":this.calculateContentLength(o)},Object.keys(null!==(u=this.options.byollmHeaders)&&void 0!==u?u:{}).reduce((function(t,e){return t[e.toLowerCase()]=l.options.byollmHeaders[e].replace("<key_placeholder>",l.options.apiKeyLlm),t}),{}))):a=ww(ww({},null!==(c=null==r?void 0:r.headers)&&void 0!==c?c:{}),{},{"x-cpbi-user":"".concat(this.chatId,"-").concat(this.lastMessageIdx)}),t.abrupt("return",fetch(this.options.byollmUrl?this.baseUrl:e.toString(),ww(ww({},r),{},{headers:ww({},a),body:o})));case 6:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"calculateContentLength",value:function(t){if("string"==typeof t){if("undefined"!=typeof Buffer)return Buffer.byteLength(t,"utf8").toString();if("undefined"!=typeof TextEncoder)return(new TextEncoder).encode(t).length.toString()}else if(ArrayBuffer.isView(t))return t.byteLength.toString();return""}},{key:"treatTools",value:function(t,e){return t.map((function(t){var r=e[t.name];if(!r)return t;t.description=r.description;var n=t.input_schema;return n&&n.properties&&Object.keys(n.properties).forEach((function(t){var e;null!==(e=r.parameters)&&void 0!==e&&e.properties&&r.parameters.properties[t]&&(n.properties[t].description=r.parameters.properties[t].description)})),t}))}},{key:"treatSystemMessage",value:function(t,e){var r=t.replace(/<<([a-zA-Z0-9]+)>>/g,(function(t,r){return e[r]?e[r]:t})),n=Di(r,"tableName");n&&(r=(r=Pi(r,"tableName")).replace("{table_name}",n));var o=Di(r,"columnList");o&&(r=(r=Pi(r,"columnList")).replace("<_column_list_>",o));var i=Di(r,"rowsDescription");if(i){r=Pi(r,"rowsDescription");var a=i.split("/<|||>/"),u="";"1"===a[0]?u="For the same ".concat(a[1]," there is more than one row with ").concat(a[2]," values. Therefore, always summarize the data (use 'GROUP BY' statement)."):"2"!==a[0]&&"3"!==a[0]||(u="There is more than one row with ".concat(a[1]," values. Therefore, always summarize the data (use 'GROUP BY' statement).")),r=r.replace("<_rows_description_>",u)}var s=Di(r,"language");if(s){var c="auto"===s?"Provide the answer to the question in the same language as the input question.":"You must only answer and communicate in '".concat(s,"', regardless of the language used by the user.");r=(r=Pi(r,"language")).replace("<_language_>",c)}return r}}],n&&Ew(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}(ow);function Dw(t){return Dw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dw(t)}function Pw(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Cw(){Cw=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new P(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function b(){}function g(){}var w={};c(w,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(w=_);var E=g.prototype=m.prototype=Object.create(w);function O(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,i,a,u){var s=f(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==Dw(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=S(u,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?y:h,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=y,n.method="throw",n.arg=c.arg)}}}function S(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,S(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function C(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(Dw(e)+" is not iterable")}return b.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=c(g,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,c(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},O(k.prototype),c(k.prototype,u,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(E),c(E,s,"Generator"),c(E,a,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=C,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),D(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;D(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:C(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function Lw(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function Tw(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Lw(i,n,o,a,u,"next",t)}function u(t){Lw(i,n,o,a,u,"throw",t)}a(void 0)}))}}function Fw(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Nw(n.key),n)}}function Iw(t,e,r){return(e=Nw(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Nw(t){var e=function(t){if("object"!=Dw(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Dw(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Dw(e)?e:e+""}var Rw="newMessageEvent",Mw="clearChat",Bw=function(){return t=function t(e){var r=this,n=e.elRoot,o=e.visualVersion,i=e.host;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Iw(this,"chatId",void 0),Iw(this,"lastMessageIdx",void 0),Iw(this,"visualVersion",void 0),Iw(this,"getToken",ot),Iw(this,"token",void 0),Iw(this,"ref",void 0),Iw(this,"sessionErrorMsg",void 0),Iw(this,"eCode","vv-visual-version"),Iw(this,"host",void 0),Iw(this,"elRoot",void 0),Iw(this,"elSpinnerWrapper",void 0),Iw(this,"elRowsLoading",void 0),Iw(this,"container",void 0),Iw(this,"goBottom",void 0),Iw(this,"messagesChat",void 0),Iw(this,"writeMessage",void 0),Iw(this,"sendButton",void 0),Iw(this,"eventEmitter",void 0),Iw(this,"rowsLoading",void 0),Iw(this,"settingsMenu",void 0),Iw(this,"conversationStarters",void 0),Iw(this,"db",void 0),Iw(this,"llm",void 0),Iw(this,"agent",void 0),Iw(this,"apiBasePath","https://backend.chatpowerbi.ai/"),Iw(this,"apiVersion","v6-ga"),Iw(this,"suffix",void 0),Iw(this,"licenseKey",void 0),Iw(this,"apiKeyBYOLLM",void 0),Iw(this,"language","auto"),Iw(this,"languageCode","auto"),Iw(this,"decimalSeparator","auto"),Iw(this,"tableDescription",void 0),Iw(this,"initialMessage",void 0),Iw(this,"customSystemMessage",void 0),Iw(this,"propConversationStarters",void 0),Iw(this,"propIsConversationStartersIsDropdown",void 0),Iw(this,"propIsConversationStartersIsFixed",void 0),Iw(this,"propConversationStartersLabel",void 0),Iw(this,"controller",void 0),Iw(this,"_initElements",(function(){r.eventEmitter=new At;var t=document.createElement("section");t.classList.add("chat"),t.addEventListener("mousedown",(function(t){r.eventEmitter.emit(ct,t),r.eventEmitter.emit(Dr,t)})),r.container=new Ft(t);var e=document.createElement("div");e.classList.add("settings-menu"),t.append(e),r.settingsMenu=new lt(e,r.eventEmitter);var n=document.createElement("button");n.classList.add("go-bottom"),Object.assign(n,{title:"Go to the bottom",type:"button"}),t.append(n),r.goBottom=new _r(n,r.eventEmitter);var o=document.createElement("div");o.classList.add("messages-chat"),t.append(o),r.messagesChat=new yr({elMessagesChat:o,goBottom:r.goBottom,eventEmitter:r.eventEmitter,host:r.host});var i=document.createElement("div");t.append(i),r.conversationStarters=new Pr({elMessagesChat:o,elConversationStartersContainer:i,eventEmitter:r.eventEmitter});var a=document.createElement("div");a.classList.add("character-count");var u=document.createElement("textarea");u.setAttribute("type","text"),u.setAttribute("rows","1"),u.classList.add("write-message"),r.writeMessage=new Ot(u,a,r.eventEmitter),r.writeMessage.placeholder="Ask a question..";var s=document.createElement("button");Object.assign(s,{title:"Stop",type:"button"}),s.classList.add("stop-button","hidden");var c=document.createElement("button");Object.assign(c,{title:"Send message",type:"button"}),c.classList.add("send-button"),r.sendButton=new gt(c,s,r.eventEmitter);var l=document.createElement("div");l.classList.add("footer-chat"),l.append(u,c,s,a),t.append(l);var f=document.createElement("div"),p=document.createElement("span"),h=document.createElement("div");r.elSpinnerWrapper=f,r.elRowsLoading=h,f.classList.add("loader-wrapper","hidden"),p.classList.add("loader"),h.classList.add("loading-rows","hidden"),h.innerText="Loading rows: ",h.setAttribute("count","0"),f.append(p,h),t.append(f),r.elRoot.append(t)})),Iw(this,"clearAndSetInitialMessage",(function(){r._clearChatMessages(),r._clearChatMemory(),r._initConversationStarters(),r.initialMessage&&r.messagesChat.addMessage({role:"ai",content:r.initialMessage})})),Iw(this,"_clearChatMessages",(function(){r.messagesChat.clearAllMessages()})),Iw(this,"_clearChatMemory",(function(){var t;null!==(t=r.agent)&&void 0!==t&&t.memory&&r.agent.memory.clear()})),Iw(this,"_initConversationStarters",(function(){r.conversationStarters.setConfigs({isDropdown:r.propIsConversationStartersIsDropdown,isFixedQuestions:r.propIsConversationStartersIsFixed,topicsLabel:r.propConversationStartersLabel}),r.conversationStarters.setConversationStarters(r.propConversationStarters);var t=r.elRoot.querySelector(".chat");t&&t.classList[r.propIsConversationStartersIsFixed?"add":"remove"]("fixed-conversation-starters")})),Iw(this,"_createLllmInstance",(function(t){var e=t.ref,n=t.provider,o=t.token,i=t.byollmHeaders,a=t.byollmModel,u=t.byollmUrl,s=t.byollmInst;return new("anthropic"===n?Aw:vw)({temperature:0,basePath:r.apiBasePath,apiKeyLlm:r.apiKeyBYOLLM,licenseKey:r.licenseKey,visualVersion:r.visualVersion,suffix:r.suffix,ref:e,token:o,byollmHeaders:i,byollmModel:a,byollmUrl:u,byollmInst:s})})),Iw(this,"_createAgentInstance",function(){var t=Tw(Cw().mark((function t(e){var r,n,o,i,a,u;return Cw().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.llmModel,n=e.sqlite,o=e.decimalSeparator,i=e.customSystemMessage,a=e.language,u=e.languageCode,t.next=3,Gg.build({llmModel:r,sqlite:n,agentOptions:{decimalSeparator:o,customSystemMessage:i,language:a,languageCode:u}});case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),Iw(this,"initAgent",function(){var t=Tw(Cw().mark((function t(e){var n;return Cw().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r.licenseKey){t.next=4;break}return r.clearAndSetInitialMessage(),r.isLoading(!1),t.abrupt("return");case 4:if(r.isLoading(!0),r.clearAndSetInitialMessage(),n=new Br(null!=e?e:{},r.tableDescription,!1),!e){t.next=10;break}return t.next=10,n.init();case 10:return r.db=n,t.next=13,r._startNewSession();case 13:r.isLoading(!1);case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),Iw(this,"_startNewSession",Tw(Cw().mark((function t(){var e,n,o,i,a,u,s,c,l,f;return Cw().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=Math.floor(Math.random()*Math.floor(Math.random()*Date.now())).toString(16),r.licenseKey){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,r.getToken({licenseKey:r.licenseKey,basePath:r.apiBasePath,chatId:e,suffix:"api/".concat(r.apiVersion),eCode:r.eCode});case 5:return n=t.sent,o=n.token,i=n.provider,a=n.ref,u=n.byollmHeaders,s=n.byollmUrl,c=n.byollmModel,l=n.byollmInst,f=n.sessionErrorMsg,r.sessionErrorMsg=f,r.suffix="api/".concat(r.apiVersion,"/").concat(null!=i?i:"openai"),r.llm=r._createLllmInstance({ref:a,provider:i,token:o,byollmHeaders:u,byollmModel:c,byollmUrl:s,byollmInst:l}),t.next=19,r._createAgentInstance({llmModel:r.llm.model,sqlite:r.db,decimalSeparator:r.decimalSeparator,customSystemMessage:r.customSystemMessage,language:r.language,languageCode:r.languageCode});case 19:r.agent=t.sent,r._updateLastMessageIdx(r.lastMessageIdx),r._updateLlmChatId(e);case 22:case"end":return t.stop()}}),t)})))),Iw(this,"_updateLastMessageIdx",(function(t){r.lastMessageIdx=t,r.llm&&(r.llm.lastMessageIdx=t)})),Iw(this,"_handleNewQuestion",function(){var t=Tw(Cw().mark((function t(e){var n,o,i,a,u,s,c;return Cw().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0!==e.length&&!r.sendButton.isLoading){t.next=3;break}return r.writeMessage.elTextarea.focus(),t.abrupt("return");case 3:return r.propIsConversationStartersIsFixed?r.conversationStarters.closeDropdown():r.conversationStarters.hide(),t.next=6,r.messagesChat.addMessage({role:"user",content:e});case 6:if(r.writeMessage.clear(),r.writeMessage.elTextarea.focus(),r.sendButton.updateState(r.sendButton.isEnable,!0),r.chatId&&!r.sessionErrorMsg){t.next=12;break}return t.next=12,r._startNewSession();case 12:if(r.licenseKey){t.next=16;break}r.messagesChat.addMessage({role:"ai",content:'You need to **add the license key** in the visual settings.<br><br>Create a **free license key** in the "License key" section on your chatPowerBI website account (`https://chatpowerbi.ai`) then add it to this visual\'s settings.'}),t.next=75;break;case 16:if(0!==Object.keys(r.db.pbiData).length){t.next=20;break}r.messagesChat.addMessage({role:"ai",content:"I have no data to answer your questions. Please drag some data into this visual. For more details, see the knowledge base at `https://chatpowerbi.ai`"}),t.next=75;break;case 20:if(!r.llm.options.byollmUrl||r.apiKeyBYOLLM){t.next=24;break}r.messagesChat.addMessage({role:"ai",content:'This license key is configured to **use your own LLM**. You need to **enable** this usage in this visual by following these steps:\n1. Go to Settings in this visual;\n2. Select the "AI Model" section;\n3. Enable the "Use my own LLM" option;\n4. Enter your API key in the appropriate field.'}),t.next=75;break;case 24:if(!r.sessionErrorMsg){t.next=28;break}r.messagesChat.addMessage({role:"ai",content:r.sessionErrorMsg}),t.next=75;break;case 28:return t.next=30,r.messagesChat.addMessage({role:"ai",content:""});case 30:return n=t.sent,f=1,o=function(t){if(Array.isArray(t))return t}(l=n)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],s=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);s=!0);}catch(t){c=!0,o=t}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(l,f)||function(t,e){if(t){if("string"==typeof t)return Pw(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Pw(t,e):void 0}}(l,f)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),i=o[0],r._updateLastMessageIdx(String(i)),t.next=36,r.messagesChat.streamMessage(i,"");case 36:return r.controller=new AbortController,a=new Wg({messageIdx:i,streamMessage:r.messagesChat.streamMessage,controller:r.controller}),t.prev=38,t.next=41,r.agent.ask(e,a,r.controller);case 41:t.sent,t.next=74;break;case 44:if(t.prev=44,t.t0=t.catch(38),console.error(t.t0),s="object"===Dw(null===t.t0||void 0===t.t0?void 0:t.t0.error)?null===t.t0||void 0===t.t0||null===(u=t.t0.error)||void 0===u?void 0:u.error:null===t.t0||void 0===t.t0?void 0:t.t0.error,0!==t.t0.retriesLeft){t.next=53;break}return t.next=51,r.messagesChat.streamMessage(i,"Unable to establish a connection to the server. Check your internet connection.");case 51:t.next=74;break;case 53:if("AbortError"!==t.t0.message){t.next=56;break}t.next=74;break;case 56:if("Ref not found"!==s&&"Token not found"!==s&&"chatId not found"!==s&&"Invalid token. Try clearing the chat from the settings icon to restart it."!==s&&"Invalid AI Mode."!==s){t.next=71;break}return t.prev=57,t.next=60,r._startNewSession();case 60:return t.next=62,r.agent.ask(e,a,r.controller);case 62:t.next=69;break;case 64:return t.prev=64,t.t1=t.catch(57),console.error(t.t1),t.next=69,r.messagesChat.streamMessage(i,s);case 69:t.next=74;break;case 71:return c=function(t){return t instanceof Error?{name:t.name,cause:t.cause,message:t.message,stack:t.stack}:{message:String(t)}},t.next=74,r.messagesChat.streamMessage(i,s||"Error:\n\n ".concat(JSON.stringify(c(t.t0),null,2)));case 74:r.messagesChat.streamMessage(i,"",!0);case 75:r.sendButton.updateState(r.sendButton.isEnable,!1);case 76:case"end":return t.stop()}var l,f}),t,null,[[38,44],[57,64]])})));return function(e){return t.apply(this,arguments)}}()),this.elRoot=n,this.visualVersion=o,this.host=i,document&&(this._initElements(),this.eventEmitter.on(Rw,this._handleNewQuestion),this.eventEmitter.on(xr,Tw(Cw().mark((function t(){return Cw().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.messagesChat.scrollToBottom();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))),this.eventEmitter.on(mt,(function(t){return r.sendButton.updateState(t,r.sendButton.isLoading)})),this.eventEmitter.on(bt,(function(t){t?r.controller&&r.controller.abort():r.writeMessage.sendMessage()})),this.eventEmitter.on(Mw,Tw(Cw().mark((function t(){return Cw().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r._clearChatMemory(),r._clearChatMessages(),r._initConversationStarters(),t.next=5,r._startNewSession();case 5:case"end":return t.stop()}}),t)})))),this.eventEmitter.on(Ar,this._handleNewQuestion),this.clearAndSetInitialMessage())},e=[{key:"updateData",value:(r=Tw(Cw().mark((function t(e){return Cw().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.agent){t.next=4;break}this.initAgent(e),t.next=11;break;case 4:return this.isLoading(!0),this.clearAndSetInitialMessage(),this.db.pbiData=e,t.next=9,this.db.init();case 9:this.agent.init(),this.isLoading(!1);case 11:case"end":return t.stop()}}),t,this)}))),function(t){return r.apply(this,arguments)})},{key:"isLoading",value:function(t){this.elSpinnerWrapper.classList[t?"remove":"add"]("hidden"),this.elRowsLoading.classList[this.rowsLoading?"remove":"add"]("hidden"),t?this.rowsLoading&&this._animateRowsLoading():this.elRowsLoading.setAttribute("count","0")}},{key:"_animateRowsLoading",value:function(){var t=this,e=Number(this.elRowsLoading.getAttribute("count"))+Math.ceil(this.rowsLoading/50);this.rowsLoading>e?(this.elRowsLoading.setAttribute("count","".concat(e.toLocaleString())),requestAnimationFrame((function(){return t._animateRowsLoading()}))):this.elRowsLoading.setAttribute("count","".concat(this.rowsLoading.toLocaleString()))}},{key:"_updateLlmChatId",value:function(t){this.chatId=t,this.llm&&(this.llm.chatId=this.chatId)}}],e&&Fw(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();function Gw(t){var e={},r={};if(t&&t.table){var n,o=t.table;o.columns.forEach((function(t,n){var o,i;e[t.displayName]={type:(o=t,i=o.type,i.text?"TEXT":i.bool?"BOOLEAN":i.dateTime&&"T"!==o.format?"DATE":i.dateTime&&"T"===o.format?"TIME":i.integer?"INTEGER":i.numeric?"NUMERIC":"TEXT"),origin:t.isMeasure?"measure":"categorical",values:[]},r[n]=t.displayName})),null===(n=o.rows)||void 0===n||n.forEach((function(t){return t.forEach((function(t,n){return e[r[n]].values.push(t)}))}))}return e}function Uw(t,e,r,n){if(t){var o=t[e];if(o){var i=o[r];if(void 0!==i)return i}}return n}function zw(t){return zw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zw(t)}function $w(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Xw(n.key),n)}}function qw(t,e,r){return e&&$w(t.prototype,e),r&&$w(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function Kw(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Hw(t,e,r){return e=Yw(e),function(t,e){if(e&&("object"==zw(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Zw()?Reflect.construct(e,r||[],Yw(t).constructor):e.apply(t,r))}function Zw(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Zw=function(){return!!t})()}function Yw(t){return Yw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Yw(t)}function Vw(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ww(t,e)}function Ww(t,e){return Ww=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ww(t,e)}function Jw(t,e,r){return(e=Xw(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Xw(t){var e=function(t){if("object"!=zw(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=zw(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==zw(e)?e:e+""}var Qw=_,tx=w,ex=g,rx=x,nx=function(t){function e(){var t;Kw(this,e);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Jw(t=Hw(this,e,[].concat(n)),"licenseKey",new A({name:"licenseKey",displayName:"License key ❔",description:"Log in to your account on the chatPowerBI website and copy the license key.",placeholder:"Enter your license key here..",value:""})),Jw(t,"name","license"),Jw(t,"displayName","License"),Jw(t,"description","License settings"),Jw(t,"slices",[t.licenseKey]),t}return Vw(e,t),qw(e)}(Qw),ox=function(t){function e(){var t;Kw(this,e);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Jw(t=Hw(this,e,[].concat(n)),"conversationStartersPredefinedQuestions",new D({name:"conversationStartersPredefinedQuestions",displayName:"Predefined questions ❔",description:"Predefined questions to guide or inspire users to start a conversation. Each question should be separated by a semicolon (;).",placeholder:"Separate questions with a semicolon (;). E.g.: What are this month's top products? ; How to improve retention?",value:""})),Jw(t,"conversationStartersDisplayMode",new S({name:"conversationStartersDisplayMode",displayName:"Display mode ❔",description:"Defines how the predefined questions are displayed: as separate bubbles or within a single dropdown menu.",items:[{value:"bubbles",displayName:"Bubbles"},{value:"dropdown",displayName:"Dropdown"}],value:{value:"bubbles",displayName:"Bubbles"}})),Jw(t,"conversationStartersTopicsLabel",new A({name:"conversationStartersTopicsLabel",displayName:"Dropdown label ❔",description:'Defines the label displayed on the dropdown when the display mode is set to "dropdown"',placeholder:"",value:"Topics"})),Jw(t,"conversationStartersIsFixed",new O({name:"conversationStartersIsFixed",displayName:"Restrict questions ❔",description:"Restrict your audience to only select predefined questions, preventing them from asking custom ones.",value:!1})),Jw(t,"name","conversationStarters"),Jw(t,"displayName","Conversation starters"),Jw(t,"description","Set up suggested questions to guide your audience's interactions"),Jw(t,"analyticsPane",!1),Jw(t,"visible",!0),Jw(t,"slices",[t.conversationStartersPredefinedQuestions,t.conversationStartersDisplayMode,t.conversationStartersTopicsLabel,t.conversationStartersIsFixed]),t}return Vw(e,t),qw(e)}(Qw),ix=function(t){function e(){var t;Kw(this,e);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Jw(t=Hw(this,e,[].concat(n)),"language",new S({name:"language",displayName:"Language ❔",description:"The language in which the assistant will answer. The value 'auto' means answer in the same language as the question.",items:[{value:"auto|auto",displayName:"auto"},{value:"العربية (Arabic ar-SA)|ar-SA",displayName:"العربية (Arabic)"},{value:"български (Bulgarian bg-BG)|bg-BG",displayName:"български (Bulgarian)"},{value:"català (Catalan ca-ES)|ca-ES",displayName:"català (Catalan)"},{value:"čeština (Czech cs-CZ)|cs-CZ",displayName:"čeština (Czech)"},{value:"dansk (Danish da-DK)|da-DK",displayName:"dansk (Danish)"},{value:"Deutsche (German de-DE)|de-DE",displayName:"Deutsche (German)"},{value:"ελληνικά (Greek el-GR)|el-GR",displayName:"ελληνικά (Greek)"},{value:"English (English en-US)|en-US",displayName:"English (English)"},{value:"español service (Spanish es-ES)|es-ES",displayName:"español service (Spanish)"},{value:"eesti (Estonian et-EE)|et-EE",displayName:"eesti (Estonian)"},{value:"Euskal (Basque eu-ES)|eu-ES",displayName:"Euskal (Basque)"},{value:"suomi (Finnish fi-FI)|fi-FI",displayName:"suomi (Finnish)"},{value:"français (French fr-FR)|fr-FR",displayName:"français (French)"},{value:"galego (Galician gl-ES)|gl-ES",displayName:"galego (Galician)"},{value:"עברית (Hebrew he-IL)|he-IL",displayName:"עברית (Hebrew)"},{value:"हिन्दी (Hindi hi-IN)|hi-IN",displayName:"हिन्दी (Hindi)"},{value:"hrvatski (Croatian hr-HR)|hr-HR",displayName:"hrvatski (Croatian)"},{value:"magyar (Hungarian hu-HU)|hu-HU",displayName:"magyar (Hungarian)"},{value:"Bahasa Indonesia (Indonesian id-ID)|id-ID",displayName:"Bahasa Indonesia (Indonesian)"},{value:"italiano (Italian it-IT)|it-IT",displayName:"italiano (Italian)"},{value:"日本の (Japanese ja-JP)|ja-JP",displayName:"日本の (Japanese)"},{value:"Қазақ (Kazakh kk-KZ)|kk-KZ",displayName:"Қазақ (Kazakh)"},{value:"한국의 (Korean ko-KR)|ko-KR",displayName:"한국의 (Korean)"},{value:"Lietuvos (Lithuanian lt-LT)|lt-LT",displayName:"Lietuvos (Lithuanian)"},{value:"Latvijas (Latvian lv-LV)|lv-LV",displayName:"Latvijas (Latvian)"},{value:"Bahasa Melayu (Malay ms-MY)|ms-MY",displayName:"Bahasa Melayu (Malay)"},{value:"norsk (Norwegian nb-NO)|nb-NO",displayName:"norsk (Norwegian)"},{value:"Nederlands (Dutch nl-NL)|nl-NL",displayName:"Nederlands (Dutch)"},{value:"polski (Polish pl-PL)|pl-PL",displayName:"polski (Polish)"},{value:"português (Brazilian Portuguese pt-BR)|pt-BR",displayName:"português (Portuguese BR)"},{value:"português (Portuguese pt-PT)|pt-PT",displayName:"português (Portuguese PT)"},{value:"românesc (Romanian ro-RO)|ro-RO",displayName:"românesc (Romanian)"},{value:"русский (Russian ru-RU)|ru-RU",displayName:"русский (Russian)"},{value:"slovenský (Slovak sk-SK)|sk-SK",displayName:"slovenský (Slovak)"},{value:"slovenski (Slovenian sl-SI)|sl-SI",displayName:"slovenski (Slovenian)"},{value:"српски (Serbian Cyrillic sr-Cyrl-RS)|sr-Cyrl-RS",displayName:"српски (Serbian Cyrillic)"},{value:"srpski (Serbian Latin sr-Latn-RS)|sr-Latn-RS",displayName:"srpski (Serbian Latin)"},{value:"svenska (Swedish sv-SE)|sv-SE",displayName:"svenska (Swedish)"},{value:"ไทย (Thai th-TH)|th-TH",displayName:"ไทย (Thai)"},{value:"Türk (Turkish tr-TR)|tr-TR",displayName:"Türk (Turkish)"},{value:"український (Ukrainian uk-UA)|uk-UA",displayName:"український (Ukrainian)"},{value:"tiếng Việt (Vietnamese vi-VN)|vi-VN",displayName:"tiếng Việt (Vietnamese)"},{value:"中国 (Chinese-Simplified zh-CN)|zh-CN",displayName:"中国 (Chinese-Simplified)"},{value:"中國 (Chinese-Tranditional zh-TW)|zh-TW",displayName:"中國 (Chinese-Tranditional)"}],value:{value:"auto",displayName:"auto"}})),Jw(t,"tableDescription",new D({name:"tableDescription",displayName:"Table description ❔",description:"Describe the table content, including the information found in each column, so the assistant can better understand your data.",placeholder:"Table description here",value:""})),Jw(t,"initialMessage",new D({name:"initialMessage",displayName:"Initial message ❔",description:"Initial message from the assistant that will appear in the chat.",placeholder:"Greeting message here",value:""})),Jw(t,"customSystemMessage",new D({name:"customSystemMessage",displayName:"Additional instructions ❔",description:"Additional instructions for the assistant to follow when answering a question.",placeholder:"Your instructions here..",value:""})),Jw(t,"name","guidelines"),Jw(t,"displayName","Guidelines"),Jw(t,"description","Guidelines for the assistant to follow when answering a question."),Jw(t,"slices",[t.language,t.tableDescription,t.initialMessage,t.customSystemMessage]),t}return Vw(e,t),qw(e)}(Qw),ax=function(t){function e(){var t;Kw(this,e);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Jw(t=Hw(this,e,[].concat(n)),"fontFamily",new P({name:"fontFamily",displayName:"Font family",value:"sans-serif"})),Jw(t,"fontSize",new j({name:"fontSize",displayName:"Font size",visible:!0,options:{minValue:{type:0,value:8},maxValue:{type:1,value:40}},value:16})),Jw(t,"chatBackground",new k({name:"chatBackground",displayName:"Chat background",value:{value:"#F5F5F5"}})),Jw(t,"loadingSpinnerBackground",new k({name:"loadingSpinnerBackground",displayName:"Loading spinner background",value:{value:"rgb(131 131 131 / 72%)"}})),Jw(t,"loadingSpinnerColor",new k({name:"loadingSpinnerColor",displayName:"Loading spinner fill",value:{value:"#FFF"}})),Jw(t,"settingsButtonColor",new k({name:"settingsButtonColor",displayName:"Settings button",value:{value:"#A7A7A7"}})),Jw(t,"name","general"),Jw(t,"displayName","General"),Jw(t,"description","General style settings"),Jw(t,"slices",[t.fontFamily,t.fontSize,t.chatBackground,t.loadingSpinnerBackground,t.loadingSpinnerColor,t.settingsButtonColor]),t}return Vw(e,t),qw(e)}(rx),ux=function(t){function e(){var t;Kw(this,e);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Jw(t=Hw(this,e,[].concat(n)),"aiIcon",new A({name:"aiIcon",displayName:"Icon ❔",description:"URL of a public image or base64 string to be used as an icon for assistant messages.",placeholder:"Enter image URL or base64 code here..",value:""})),Jw(t,"aiMessageColor",new k({name:"aiMessageColor",displayName:"Text",value:{value:"#000"}})),Jw(t,"aiMessageBackground",new k({name:"aiMessageBackground",displayName:"Background",value:{value:"#FFF"}})),Jw(t,"aiMessagePulseCircle",new k({name:"aiMessagePulseCircle",displayName:"Loading message",value:{value:"rgb(207, 207, 207)"}})),Jw(t,"name","aiMessage"),Jw(t,"displayName","AI message"),Jw(t,"description","AI assistant message style settings"),Jw(t,"slices",[t.aiIcon,t.aiMessageColor,t.aiMessageBackground,t.aiMessagePulseCircle]),t}return Vw(e,t),qw(e)}(rx),sx=function(t){function e(){var t;Kw(this,e);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Jw(t=Hw(this,e,[].concat(n)),"userMessageColor",new k({name:"userMessageColor",displayName:"Text",value:{value:"#FFF"}})),Jw(t,"userMessageBackground",new k({name:"userMessageBackground",displayName:"Background",value:{value:"#704ae8"}})),Jw(t,"name","userMessage"),Jw(t,"displayName","User message"),Jw(t,"description","User message style settings"),Jw(t,"slices",[t.userMessageColor,t.userMessageBackground]),t}return Vw(e,t),qw(e)}(rx),cx=function(t){function e(){var t;Kw(this,e);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Jw(t=Hw(this,e,[].concat(n)),"footerBackground",new k({name:"footerBackground",displayName:"Background",value:{value:"#F5F5F5"}})),Jw(t,"inputBackground",new k({name:"inputBackground",displayName:"Input message background",value:{value:"#FFF"}})),Jw(t,"inputColor",new k({name:"inputColor",displayName:"Input message text",value:{value:"#000"}})),Jw(t,"inputPlaceholderColor",new k({name:"inputPlaceholderColor",displayName:"Input message placeholder",value:{value:"#C0C0C0"}})),Jw(t,"inputFocusBorder",new k({name:"inputFocusBorder",displayName:"Input message focus border",value:{value:"rgb(201, 201, 201)"}})),Jw(t,"arrowColor",new k({name:"arrowColor",displayName:"Active send button",value:{value:"#704ae8"}})),Jw(t,"arrowColorDisable",new k({name:"arrowColorDisable",displayName:"Disable send button",value:{value:"rgb(201 201 207)"}})),Jw(t,"stopButtonColor",new k({name:"stopButtonColor",displayName:"Stop button",value:{value:"#704ae8"}})),Jw(t,"characterCountcolor",new k({name:"characterCountcolor",displayName:"Character counter",value:{value:"rgb(212, 212, 216)"}})),Jw(t,"name","footer"),Jw(t,"displayName","Footer"),Jw(t,"description","Footer style settings"),Jw(t,"slices",[t.footerBackground,t.inputBackground,t.inputColor,t.inputPlaceholderColor,t.inputFocusBorder,t.arrowColor,t.arrowColorDisable,t.stopButtonColor,t.characterCountcolor]),t}return Vw(e,t),qw(e)}(rx),lx=function(t){function e(){var t;Kw(this,e);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Jw(t=Hw(this,e,[].concat(n)),"conversationStartersBtnBg",new k({name:"conversationStartersBtnBg",displayName:"Button background",value:{value:"#FFF"}})),Jw(t,"conversationStartersBtnBorder",new k({name:"conversationStartersBtnBorder",displayName:"Button border",value:{value:"#d1d1f1"}})),Jw(t,"conversationStartersIconFill",new k({name:"conversationStartersIconFill",displayName:"Icon fill",value:{value:"#7B71CC"}})),Jw(t,"conversationStartersIconBg",new k({name:"conversationStartersIconBg",displayName:"Icon background",value:{value:"#F2F0FF"}})),Jw(t,"conversationStartersLabelColor",new k({name:"conversationStartersLabelColor",displayName:"Button text",value:{value:"#4a4a4a"}})),Jw(t,"name","conversationStarter"),Jw(t,"displayName","Conversation starters"),Jw(t,"description","Conversation starters style settings"),Jw(t,"slices",[t.conversationStartersBtnBg,t.conversationStartersBtnBorder,t.conversationStartersIconFill,t.conversationStartersIconBg,t.conversationStartersLabelColor]),t}return Vw(e,t),qw(e)}(rx),fx=function(t){function e(){var t;Kw(this,e);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Jw(t=Hw(this,e,[].concat(n)),"styleGeneral",new ax(Object())),Jw(t,"styleAiMessage",new ux(Object())),Jw(t,"styleUserMessage",new sx(Object())),Jw(t,"styleFooter",new cx(Object())),Jw(t,"styleConversationStarter",new lx(Object())),Jw(t,"name","style"),Jw(t,"displayName","Style"),Jw(t,"description","Style settings"),Jw(t,"groups",[t.styleGeneral,t.styleAiMessage,t.styleUserMessage,t.styleFooter,t.styleConversationStarter]),t}return Vw(e,t),qw(e)}(tx),px=function(t){function e(){var t;Kw(this,e);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Jw(t=Hw(this,e,[].concat(n)),"activeBYOLLM",new O({name:"activeBYOLLM",displayName:"Use my own LLM ❔",description:'Bring your own LLM (AI model), you need to configure the URL in the user panel on our website ("BYO LLM" section)',value:!1})),Jw(t,"apiKeyBYOLLM",new A({name:"apiKeyBYOLLM",displayName:"API key ❔",description:"API Key of your own LLM model",placeholder:"Your API key here..",value:""})),Jw(t,"name","aiModel"),Jw(t,"displayName","AI Model"),Jw(t,"description","Artificial intelligence model settings"),Jw(t,"slices",[t.activeBYOLLM,t.apiKeyBYOLLM]),t}return Vw(e,t),qw(e)}(Qw),hx=function(t){function e(){var t;Kw(this,e);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return Jw(t=Hw(this,e,[].concat(n)),"license",new nx),Jw(t,"guidelines",new ix),Jw(t,"style",new fx),Jw(t,"aiModel",new px),Jw(t,"conversationStarters",new ox),Jw(t,"cards",[t.license,t.guidelines,t.conversationStarters,t.style,t.aiModel]),t}return Vw(e,t),qw(e)}(ex);function dx(t){return dx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dx(t)}function yx(){yx=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),u=new P(n||[]);return o(a,"_invoke",{value:j(t,r,u)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function b(){}function g(){}var w={};c(w,a,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(C([])));_&&_!==r&&n.call(_,a)&&(w=_);var E=g.prototype=m.prototype=Object.create(w);function O(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,i,a,u){var s=f(t[o],t,i);if("throw"!==s.type){var c=s.arg,l=c.value;return l&&"object"==dx(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(l).then((function(t){c.value=t,a(c)}),(function(t){return r("throw",t,a,u)}))}u(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var s=S(u,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var c=f(e,r,n);if("normal"===c.type){if(o=n.done?y:h,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(o=y,n.method="throw",n.arg=c.arg)}}}function S(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,S(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,v;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function C(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(dx(e)+" is not iterable")}return b.prototype=g,o(E,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:b,configurable:!0}),b.displayName=c(g,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,c(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},O(k.prototype),c(k.prototype,u,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(E),c(E,s,"Generator"),c(E,a,(function(){return this})),c(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=C,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),D(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;D(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:C(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},e}function vx(t,e,r,n,o,i,a){try{var u=t[i](a),s=u.value}catch(t){return void r(t)}u.done?e(s):Promise.resolve(s).then(n,o)}function mx(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){vx(i,n,o,a,u,"next",t)}function u(t){vx(i,n,o,a,u,"throw",t)}a(void 0)}))}}function bx(t,e){if(t){if("string"==typeof t)return gx(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?gx(t,e):void 0}}function gx(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function wx(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_x(n.key),n)}}function xx(t,e,r){return(e=_x(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _x(t){var e=function(t){if("object"!=dx(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=dx(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==dx(e)?e:e+""}var Ex=function(){return t=function t(e){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),xx(this,"formattingSettings",void 0),xx(this,"formattingSettingsService",void 0),xx(this,"host",void 0),xx(this,"handler",void 0),xx(this,"visualVersion","1.6.0.0"),xx(this,"selectionManager",void 0),xx(this,"mapPropertyVarName",{fontFamily:"--font-family",fontSize:"--font-size",chatBackground:"--chat-bg-color",aiIconBgColor:"--ai-icon-bg-color",aiIconBgSize:"--ai-icon-bg-size",aiIcon:"--ai-icon",aiMessageColor:"--ai-message-color",aiMessageBackground:"--ai-message-bg-color",aiMessagePulseCircle:"--ai-message-pulse-circle",userMessageColor:"--user-message-color",userMessageBackground:"--user-message-bg-color",footerBackground:"--footer-chat-bg-color",inputBackground:"--write-message-bg-color",inputColor:"--write-message-color",inputPlaceholderColor:"--write-message-placeholder-color",inputFocusBorder:"--write-message-focus-border-color",characterCountcolor:"--character-count-color",loadingSpinnerBackground:"--loading-spinner-bg-color",loadingSpinnerColor:"--loading-spinner-color",settingsButtonColor:"--settings-button-color",stopButtonColor:"--stop-button-color",conversationStartersBtnBg:"--conversation-starters-btn-bg",conversationStartersBtnBorder:"--conversation-starters-btn-border",conversationStartersIconFill:"--conversation-starters-icon-fill",conversationStartersIconBg:"--conversation-starters-icon-bg",conversationStartersLabelColor:"--conversation-starters-label-color"}),xx(this,"defaultSyle",{}),xx(this,"defaultGuidelines",{licenseKey:"",language:"auto|auto",decimalSeparator:"auto",tableDescription:"",initialMessage:"",customSystemMessage:"",conversationStartersPredefinedQuestions:"",conversationStartersDisplayMode:"bubbles",conversationStartersIsFixed:!1,conversationStartersTopicsLabel:"Topics",apiKeyBYOLLM:""}),xx(this,"isIncrementalUpdate",!1),xx(this,"dataviewTable",void 0),xx(this,"_setStyle",(function(t){var e=r.handler.container.elContainer;["fontFamily","fontSize"].forEach((function(n){var o=r.mapPropertyVarName[n],i=r.defaultSyle[n],a=String(Uw(t,"style",n,i));e.style.setProperty(o,"fontSize"===n?"".concat(a.toString().replace("px",""),"px"):a)}));var n=Uw(t,"style","aiIcon","");n?(e.style.setProperty(r.mapPropertyVarName.aiIcon,"URL(".concat(n,")")),e.style.setProperty(r.mapPropertyVarName.aiIconBgColor,"unset"),e.style.setProperty(r.mapPropertyVarName.aiIconBgSize,"cover")):(e.style.setProperty(r.mapPropertyVarName.aiIcon,r.defaultSyle.aiIcon),e.style.setProperty(r.mapPropertyVarName.aiIconBgColor,r.defaultSyle.aiIconBgColor),e.style.setProperty(r.mapPropertyVarName.aiIconBgSize,r.defaultSyle.aiIconBgSize)),["chatBackground","aiMessageColor","aiMessageBackground","aiMessagePulseCircle","userMessageColor","userMessageBackground","footerBackground","inputBackground","inputColor","inputPlaceholderColor","inputFocusBorder","characterCountcolor","loadingSpinnerBackground","loadingSpinnerColor","settingsButtonColor","stopButtonColor","conversationStartersBtnBg","conversationStartersBtnBorder","conversationStartersIconFill","conversationStartersIconBg","conversationStartersLabelColor"].forEach((function(n){var o=r.mapPropertyVarName[n],i={solid:{color:r.defaultSyle[n]}},a=Uw(t,"style",n,i).solid.color;e.style.setProperty(o,a)})),["arrowColor","arrowColorDisable"].forEach((function(e){var n={solid:{color:r.defaultSyle[e]}},o=Uw(t,"style",e,n).solid.color;r.handler.sendButton[e]=o})),r.handler.sendButton.updateStyle()})),xx(this,"_setLicenseAndGuidelinesAndConversationStartersAndAiModel",(function(t){var e=!1,n=Uw(t,"license","licenseKey",r.defaultGuidelines.licenseKey);r.handler.licenseKey!==n&&(r.handler.licenseKey=n,e=!0),["decimalSeparator","tableDescription","initialMessage","customSystemMessage"].forEach((function(n){var o=Uw(t,"guidelines",n,r.defaultGuidelines[n]);r.handler[n]!==o&&(r.handler[n]=o,e=!0)}));var o,i,a=(o=Uw(t,"guidelines","language",r.defaultGuidelines.language).split("|"),i=2,function(t){if(Array.isArray(t))return t}(o)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],s=!0,c=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);s=!0);}catch(t){c=!0,o=t}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw o}}return u}}(o,i)||bx(o,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),u=a[0],s=a[1];u!==r.handler.language&&(r.handler.language=u,r.handler.languageCode=s,e=!0);var c={conversationStartersPredefinedQuestions:"propConversationStarters",conversationStartersDisplayMode:"propIsConversationStartersIsDropdown",conversationStartersIsFixed:"propIsConversationStartersIsFixed",conversationStartersTopicsLabel:"propConversationStartersLabel"};["conversationStartersPredefinedQuestions","conversationStartersDisplayMode","conversationStartersIsFixed","conversationStartersTopicsLabel"].forEach((function(n){var o=Uw(t,"conversationStarters",n,r.defaultGuidelines[n]),i="conversationStartersDisplayMode"===n?"dropdown"===o:o,a=c[n];r.handler[a]!==i&&(r.handler[a]=i,e=!0)}));var l=r.formattingSettings.aiModel.activeBYOLLM.value?Uw(t,"aiModel","apiKeyBYOLLM",r.defaultGuidelines.apiKeyBYOLLM):r.defaultGuidelines.apiKeyBYOLLM;return r.handler.apiKeyBYOLLM!==l&&(r.handler.apiKeyBYOLLM=l,e=!0),e})),this.formattingSettingsService=new R,this.host=e.host,this.selectionManager=e.host.createSelectionManager(),document&&(this.handler=new Bw({elRoot:e.element,visualVersion:this.visualVersion,host:this.host}),this._getDefaultStyle()),this.handleContextMenu()},e=[{key:"update",value:(i=mx(yx().mark((function t(e){return yx().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(16&~e.type&&2&~e.type||!e.dataViews||!e.dataViews[0]){t.next=5;break}return t.next=3,this.isIncrementalUpdate?this.incrementalRefresh(e):this.segmentsAggregation(e);case 3:t.next=6;break;case 5:this.formattingSettings=this.formattingSettingsService.populateFormattingSettingsModel(hx,e.dataViews[0]);case 6:case 7:case"end":return t.stop()}}),t,this)}))),function(t){return i.apply(this,arguments)})},{key:"segmentsAggregation",value:(o=mx(yx().mark((function t(e){var r,n;return yx().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.dataViews[0],n=!0,r.metadata.segment&&(this.handler.rowsLoading=r.table.rows.length,this.handler.isLoading(!0),n=!this.host.fetchMoreData(!0)),!n){t.next=8;break}return this.formattingSettings=this.formattingSettingsService.populateFormattingSettingsModel(hx,e.dataViews[0]),t.next=7,this._updateDataAndStyle(r);case 7:this.handler.isLoading(!1);case 8:case"end":return t.stop()}}),t,this)}))),function(t){return o.apply(this,arguments)})},{key:"incrementalRefresh",value:(n=mx(yx().mark((function t(e){var r,n,o,i,a,u,s,c;return yx().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=e.dataViews[0],i=!0,a=0==e.operationKind,u=null!==(r=null===(n=o.table)||void 0===n||null===(n=n.rows)||void 0===n?void 0:n.length)&&void 0!==r?r:0,a?(this.handler.rowsLoading=u,this.dataviewTable=o.table):(c=void 0===o.table.lastMergeIndex?0:o.table.lastMergeIndex+1,(s=this.dataviewTable.rows).push.apply(s,function(t){if(Array.isArray(t))return gx(t)}(l=o.table.rows.slice(c))||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(l)||bx(l)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),this.handler.rowsLoading+=u),this.handler.isLoading(!0),!!o.metadata.segment&&(i=!this.host.fetchMoreData(!1)),!i){t.next=13;break}return this.formattingSettings=this.formattingSettingsService.populateFormattingSettingsModel(hx,e.dataViews[0]),o.table=this.dataviewTable,t.next=12,this._updateDataAndStyle(o);case 12:this.handler.isLoading(!1);case 13:case"end":return t.stop()}var l}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"_updateDataAndStyle",value:(r=mx(yx().mark((function t(e){var r,n,o,i;return yx().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=null===(r=e.metadata)||void 0===r?void 0:r.objects,o=this._setLicenseAndGuidelinesAndConversationStartersAndAiModel(n),this.handler.container.elContainer&&this._setStyle(n),i=Gw(e),t.next=6,this.handler[o?"initAgent":"updateData"](null!=i?i:{});case 6:case"end":return t.stop()}}),t,this)}))),function(t){return r.apply(this,arguments)})},{key:"_getDefaultStyle",value:function(){var t=this,e=this.handler.container.elContainer,r=getComputedStyle(e);["fontFamily","fontSize","chatBackground","aiIconBgColor","aiIconBgSize","aiIcon","aiMessageColor","aiMessageBackground","aiMessagePulseCircle","userMessageColor","userMessageBackground","footerBackground","inputBackground","inputColor","inputPlaceholderColor","inputFocusBorder","characterCountcolor","loadingSpinnerBackground","loadingSpinnerColor","settingsButtonColor","stopButtonColor","conversationStartersBtnBg","conversationStartersBtnBorder","conversationStartersIconFill","conversationStartersIconBg","conversationStartersLabelColor"].forEach((function(e){var n=t.mapPropertyVarName[e],o=r.getPropertyValue(n);t.defaultSyle[e]=o})),this.defaultSyle.arrowColor=this.handler.sendButton.arrowColor,this.defaultSyle.arrowColorDisable=this.handler.sendButton.arrowColorDisable}},{key:"getFormattingModel",value:function(){var t=this.formattingSettings,e=t.aiModel,r=t.conversationStarters;return e.apiKeyBYOLLM.visible=e.activeBYOLLM.value,"dropdown"!==r.conversationStartersDisplayMode.value.value&&(r.conversationStartersTopicsLabel.visible=!1),this.formattingSettingsService.buildFormattingModel(this.formattingSettings)}},{key:"handleContextMenu",value:function(){var t=this;this.handler.elRoot.oncontextmenu=function(e){t.selectionManager.showContextMenu({},{x:e.clientX,y:e.clientY}),e.preventDefault()}}}],e&&wx(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,i}(),Ox=window.powerbi,kx={name:"chatpowerbi_ai",displayName:"chat Power BI AI",class:"Visual",apiVersion:"5.11.0",create:function(t){if(Ex)return new Ex(t);throw"Visual instance not found"},createModalDialog:function(t,e,r){var n=globalThis.dialogRegistry;t in n&&new n[t](e,r)},custom:!0};void 0!==Ox&&(Ox.visuals=Ox.visuals||{},Ox.visuals.plugins=Ox.visuals.plugins||{},Ox.visuals.plugins.chatpowerbi_ai=kx);const jx=kx})(),chatpowerbi_ai=i})();
//# sourceMappingURL=visual.js.map