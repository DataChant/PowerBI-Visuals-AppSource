var myCustomVisual12345;(()=>{"use strict";var e={242:(e,t,n)=>{n.d(t,{b:()=>o});class o{target;selectionManager;host;selectionIds=[];colorPalette=["#0078D7","#E81123","#FFB900","#107C10","#5C2D91","#00B294","#FF8C00"];barHeight=25;showTooltips=!0;enableAnimation=!0;constructor(e){this.target=e.element,this.host=e.host,this.selectionManager=this.host.createSelectionManager(),this.target.style.padding="10px",this.target.style.fontFamily="Segoe UI, sans-serif",this.target.style.background="#f4f4f4",this.target.style.borderRadius="8px",this.target.style.boxSizing="border-box",this.target.style.overflow="hidden",this.target.style.position="relative",this.target.style.width="100%",this.target.style.height="100%",this.target.addEventListener("click",()=>{this.selectionManager.clear();const e=this.target.querySelector(".chartContainer");e&&this.highlightSelection([],e),this.removeContextMenu()}),this.target.addEventListener("contextmenu",e=>{e.preventDefault(),e.stopPropagation(),this.createChartContextMenu(e.pageX,e.pageY)})}update(e){const t=e.viewport.width,n=e.viewport.height;this.target.style.width=t+"px",this.target.style.height=n+"px";const o=e.dataViews?.[0]?.metadata?.objects;if(o){const e=o.general?.barHeight;void 0!==e&&(this.barHeight=e);const t=o.tooltips?.showTooltips;void 0!==t&&(this.showTooltips=t);const n=o.animation?.enableAnimation;void 0!==n&&(this.enableAnimation=n)}const s=e.dataViews;if(s&&s.length>0&&s[0].categorical){const e=s[0].categorical,o=e.categories?.[0]?.values||[],i=e.values?.[0]?.values||[];o.length&&i.length&&(this.selectionIds=o.map((t,n)=>this.host.createSelectionIdBuilder().withCategory(e.categories[0],n).createSelectionId()),this.renderChart(o,i,t,n))}}renderChart(e,t,n,o){this.target.innerHTML="";const s=document.createElement("div");s.style.height="100%",s.style.overflowY="auto",s.style.overflowX="auto",s.style.boxSizing="border-box";const i=document.createElement("div");i.className="chartContainer",i.style.display="flex",i.style.flexDirection="column",i.style.gap="6px",i.style.width="100%";const l=Math.max(...t.map(Number)),a=(n||this.target.clientWidth||400)-140;e.forEach((e,n)=>{const o=document.createElement("div");o.style.display="flex",o.style.alignItems="center",o.style.width="100%";const s=document.createElement("span");s.textContent=e,s.style.width="120px",s.style.fontSize="clamp(10px, 1vw, 14px)",s.style.whiteSpace="nowrap",s.style.overflow="hidden",s.style.textOverflow="ellipsis",s.title=e;const r=document.createElement("div"),d=t[n]/l*a,c=this.colorPalette[n%this.colorPalette.length];r.style.background=c,r.style.height=`${this.barHeight}px`,r.style.marginLeft="5px",r.style.width=`${d}px`,r.style.color="white",r.style.fontSize="clamp(10px, 1vw, 12px)",r.style.lineHeight=`${this.barHeight}px`,r.style.paddingLeft="8px",r.style.borderRadius="4px",r.style.transition="width 0.3s ease, opacity 0.3s ease",r.style.cursor="pointer",this.showTooltips&&(r.title=`${e}: ${t[n].toLocaleString()}`),r.textContent=t[n].toString(),r.addEventListener("click",e=>{const t=e.ctrlKey||e.metaKey;this.selectionManager.select(this.selectionIds[n],t).then(e=>{this.highlightSelection(e,i)}),e.stopPropagation()}),o.appendChild(s),o.appendChild(r),i.appendChild(o)}),s.appendChild(i),this.target.appendChild(s)}highlightSelection(e,t){t.querySelectorAll("div[style*='background']").forEach((t,n)=>{t.style.opacity=0===e.length||e.includes(this.selectionIds[n])?"1":"0.4"})}createChartContextMenu(e,t){const n=document.getElementById("customContextMenu");n&&n.remove();const o=document.createElement("div");o.id="customContextMenu",o.style.position="absolute",o.style.background="#fff",o.style.border="1px solid #ccc",o.style.borderRadius="4px",o.style.boxShadow="0 2px 6px rgba(0,0,0,0.2)",o.style.padding="5px 0",o.style.zIndex="9999",o.style.minWidth="150px",o.style.fontSize="13px",o.style.left=`${e}px`,o.style.top=`${t}px`,[{text:"Reset All Selections",action:()=>this.selectionManager.clear()},{text:"Summarize",action:()=>this.showSummaryTable()},{text:"Analyze",action:()=>this.showSummaryTable()},{text:"Show as Table",action:()=>this.showSummaryTable()}].forEach(e=>{const t=document.createElement("div");t.textContent=e.text,t.style.padding="5px 10px",t.style.cursor="pointer",t.addEventListener("click",()=>{e.action(),o.remove()}),t.addEventListener("mouseover",()=>t.style.background="#f0f0f0"),t.addEventListener("mouseout",()=>t.style.background="transparent"),o.appendChild(t)}),document.body.appendChild(o);const s=e=>{o.contains(e.target)||(o.remove(),document.removeEventListener("click",s))};setTimeout(()=>document.addEventListener("click",s),0)}showSummaryTable(){const e=document.getElementById("summaryTableOverlay");e&&e.remove();const t=document.createElement("div");t.id="summaryTableOverlay",t.style.position="fixed",t.style.top="0",t.style.left="0",t.style.width="100%",t.style.height="100%",t.style.background="rgba(0,0,0,0.5)",t.style.display="flex",t.style.justifyContent="center",t.style.alignItems="center",t.style.zIndex="10000";const n=document.createElement("div");n.style.background="#fff",n.style.padding="20px",n.style.borderRadius="8px",n.style.maxHeight="80%",n.style.overflowY="auto",n.style.minWidth="300px";const o=document.createElement("h3");o.textContent="Summary Table",o.style.marginTop="0",n.appendChild(o);const s=document.createElement("table");s.style.width="100%",s.style.borderCollapse="collapse";const i=document.createElement("thead"),l=document.createElement("tr");["Category","Value"].forEach(e=>{const t=document.createElement("th");t.textContent=e,t.style.borderBottom="1px solid #ccc",t.style.textAlign="left",t.style.padding="5px",l.appendChild(t)}),i.appendChild(l),s.appendChild(i);const a=document.createElement("tbody"),r=this.target.querySelector(".chartContainer");r&&r.querySelectorAll("div[style*='background']").forEach(e=>{const t=document.createElement("tr"),n=document.createElement("td");n.textContent=e.previousSibling?.textContent||"",n.style.padding="5px",t.appendChild(n);const o=document.createElement("td");o.textContent=e.textContent||"",o.style.padding="5px",t.appendChild(o),a.appendChild(t)}),s.appendChild(a),n.appendChild(s);const d=document.createElement("button");d.textContent="Close",d.style.marginTop="10px",d.style.padding="5px 10px",d.style.cursor="pointer",d.addEventListener("click",()=>t.remove()),n.appendChild(d),t.appendChild(n),document.body.appendChild(t)}removeContextMenu(){const e=document.getElementById("customContextMenu");e&&e.remove()}}}},t={};function n(o){var s=t[o];if(void 0!==s)return s.exports;var i=t[o]={exports:{}};return e[o](i,i.exports,n),i.exports}n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o={};(()=>{n.r(o),n.d(o,{default:()=>i});var e=n(242),t=window.powerbi,s={name:"myCustomVisual12345",displayName:"My Custom Visual",class:"Visual",apiVersion:"5.11.0",create:t=>{if(e.b)return new e.b(t);throw"Visual instance not found"},createModalDialog:(e,t,n)=>{const o=globalThis.dialogRegistry;e in o&&new o[e](t,n)},custom:!0};void 0!==t&&(t.visuals=t.visuals||{},t.visuals.plugins=t.visuals.plugins||{},t.visuals.plugins.myCustomVisual12345=s);const i=s})(),myCustomVisual12345=o})();