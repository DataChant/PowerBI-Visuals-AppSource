var p6GanttChartVisual23D4F5A6B7C8D9E0F1A2B3C4D5E6F7A8;(()=>{"use strict";var t={848:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Visual=void 0,n(916);var i=function(){function t(t){var e=this;this.updateCount=0,this.viewState={scrollLeft:0,scrollTop:0,zoom:1,expandedNodes:new Set},this.allTasks=[],this.visibleTasks=[],this.settings={showProgress:!0,barHeight:24,dateFormat:"%m/%d/%Y",showDataDate:!0,showYears:!0,showMonths:!0,showWeeks:!1,showDays:!1,timelineAutoSize:!1,fitToSize:!0,level0Color:"#000000",level1Color:"#2e8b57",level2Color:"#1e3a8a",level3Color:"#b45309",level4Color:"#20c997",level5Color:"#6f42c1",level6Color:"#fd7e14",level7Color:"#20c997",level8Color:"#e83e8c",level9Color:"#6610f2",progressColor:"#00bcf2",columnFontSize:12,columnFontFamily:"Segoe UI",showBarText:!0,barTextSize:10,barTextFont:"Segoe UI",dataDateLineColor:"#dc3545",dataDateLineWidth:2,dataDateLabelOffset:0,showSignature:!0,signatureSize:10,showStartDate:!0,showFinishDate:!0,showProgressColumn:!0,showLevelText:!1,showTaskCount:!0,showHeaderTaskCount:!0,columnWidth:350,taskHeaderColor:"#28a745",ganttHeaderColor:"#495057",headerHeight:60,headerText:"Project Tasks",ganttHeaderText:"Timeline",showToday:!0,todayLineColor:"#ff4444",todayLineWidth:2,showHoverEffects:!0,showAnimations:!0,gridLineColor:"#797676ff",showGridLines:!0,compactMode:!1,showSummaryBars:!1,milestoneSize:20,showBaseline:!0,baselineColor:"#808080",baselineHeight:8,showPlannedProgress:!0,plannedProgressColor:"#87CEEB",showLevelIndicators:!0,showPlannedProgressColumn:!0,showBaselineStartDate:!1,showBaselineFinishDate:!1,showVariance:!0,positiveVarianceColor:"#28a745",negativeVarianceColor:"#dc3545",taskNameSize:12,startDateSize:10,finishDateSize:10,baselineStartSize:10,baselineFinishSize:10,varianceSize:10,actualProgressSize:10,plannedProgressSize:10,taskDetailsText:"Task Details",p6Format:!1},this.contextMenuHandler=function(t){t.preventDefault(),t.stopPropagation(),console.log("Context menu triggered");var n=t.target.closest("[data-task-bar]"),i=t.target.closest("[data-task-row]"),s={};if(n)(o=parseInt(n.getAttribute("data-task-bar")||"0"))>=0&&o<e.visibleTasks.length&&(s={displayName:(a=e.visibleTasks[o]).originalName||a.name,identity:null,selected:!1});else if(i){var o,a;(o=parseInt(i.getAttribute("data-task-row")||"0"))>=0&&o<e.visibleTasks.length&&(s={displayName:(a=e.visibleTasks[o]).originalName||a.name,identity:null,selected:!1})}try{e.selectionManager.showContextMenu(s,{x:t.clientX,y:t.clientY}),console.log("Context menu should appear now")}catch(t){console.error("Error showing context menu:",t)}},this.handleTaskToggle=function(t){t.preventDefault(),t.stopPropagation();var n=t.currentTarget.getAttribute("data-task-toggle");n&&e.toggleTaskExpansion(n)},console.log("üîß Professional Gantt Chart - Visual constructor called"),this.target=t.element,this.host=t.host,this.selectionManager=this.host.createSelectionManager(),this.target.innerHTML='\n            <div style="\n                width: 100%; height: 100%; display: flex; align-items: center; justify-content: center;\n                font-family: \'Segoe UI\', Arial, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n                color: white; font-size: 16px; border-radius: 8px; position: relative; overflow: hidden;\n            ">\n                <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.1);"></div>\n                <div style="text-align: center; z-index: 1;">\n                    <div style="font-size: 64px; margin-bottom: 20px; animation: pulse 2s infinite;">üìä</div>\n                    <div style="font-weight: 600; margin-bottom: 12px; font-size: 24px;">Professional Gantt Chart</div>\n                    <div style="font-size: 14px; opacity: 0.9; margin-bottom: 20px;">\n                        Advanced Project Management Visualization\n                    </div>\n                    <div style="font-size: 12px; opacity: 0.7;">\n                        Waiting for your project data...\n                    </div>\n                </div>\n                <style>\n                    @keyframes pulse {\n                        0%, 100% { transform: scale(1); }\n                        50% { transform: scale(1.1); }\n                    }\n                </style>\n            </div>\n        '}return t.prototype.update=function(t){var e,n,i;try{if(this.updateCount++,console.log("üéâ PROFESSIONAL UPDATE CALLED! #"+this.updateCount),!t||!t.dataViews||0===t.dataViews.length)return console.log("‚ùå No dataViews in options"),void this.showNoData();var s=t.dataViews[0];console.log("üìä DataView received:",s),this.parseSettings(s);var o=this.extractTasks(s),a=o.tasks,r=o.dataDate;if(r?this.currentDataDate=r:!this.currentDataDate&&this.viewState.dataDate&&(this.currentDataDate=this.viewState.dataDate),console.log("üìã Tasks extracted:",a.length),0===a.length)console.log("‚ö†Ô∏è No tasks found"),this.showNoData();else{if(this.allTasks=a,null===(i=null===(n=null===(e=null==s?void 0:s.metadata)||void 0===e?void 0:e.objects)||void 0===n?void 0:n.general)||void 0===i?void 0:i.expandedNodes)try{var l=JSON.parse(s.metadata.objects.general.expandedNodes);this.viewState.expandedNodes=new Set(l),this.applyExpandedStateToTasks(this.allTasks)}catch(t){console.warn("Could not restore expanded state:",t)}this.updateVisibleTasks(),console.log("‚úÖ Rendering professional data"),this.renderChart(this.visibleTasks,r),this.setupEventListeners(),this.addProfessionalFeatures()}}catch(t){console.error("‚ùå Update error:",t),this.showError("Error: "+t.message)}},t.prototype.parseSettings=function(t){try{if(t&&t.metadata&&t.metadata.objects){var e,n=t.metadata.objects;if(n.gantt&&(void 0!==n.gantt.showProgress&&(this.settings.showProgress=n.gantt.showProgress),void 0!==n.gantt.barHeight&&(this.settings.barHeight=n.gantt.barHeight),void 0!==n.gantt.milestoneSize&&(this.settings.milestoneSize=n.gantt.milestoneSize)),n.timeline&&(void 0!==n.timeline.dateFormat&&(this.settings.dateFormat=n.timeline.dateFormat),void 0!==n.timeline.showDataDate&&(this.settings.showDataDate=n.timeline.showDataDate),void 0!==n.timeline.showYears&&(this.settings.showYears=n.timeline.showYears),void 0!==n.timeline.showMonths&&(this.settings.showMonths=n.timeline.showMonths),void 0!==n.timeline.showWeeks&&(this.settings.showWeeks=n.timeline.showWeeks),void 0!==n.timeline.showDays&&(this.settings.showDays=n.timeline.showDays),void 0!==n.timeline.timelineAutoSize&&(this.settings.timelineAutoSize=n.timeline.timelineAutoSize),void 0!==n.timeline.fitToSize&&(this.settings.fitToSize=n.timeline.fitToSize),n.timeline.dataDateLineColor&&(e=n.timeline.dataDateLineColor).solid&&e.solid.color&&(this.settings.dataDateLineColor=e.solid.color),void 0!==n.timeline.dataDateLineWidth&&(this.settings.dataDateLineWidth=n.timeline.dataDateLineWidth),void 0!==n.timeline.dataDateLabelOffset&&(this.settings.dataDateLabelOffset=n.timeline.dataDateLabelOffset)),n.professional&&(void 0!==n.professional.showToday&&(this.settings.showToday=n.professional.showToday),n.professional.todayLineColor&&(e=n.professional.todayLineColor).solid&&e.solid.color&&(this.settings.todayLineColor=e.solid.color),void 0!==n.professional.todayLineWidth&&(this.settings.todayLineWidth=n.professional.todayLineWidth),void 0!==n.professional.showHoverEffects&&(this.settings.showHoverEffects=n.professional.showHoverEffects),void 0!==n.professional.showAnimations&&(this.settings.showAnimations=n.professional.showAnimations),n.professional.gridLineColor&&(e=n.professional.gridLineColor).solid&&e.solid.color&&(this.settings.gridLineColor=e.solid.color),void 0!==n.professional.showGridLines&&(this.settings.showGridLines=n.professional.showGridLines),void 0!==n.professional.compactMode&&(this.settings.compactMode=n.professional.compactMode),void 0!==n.professional.showSummaryBars&&(this.settings.showSummaryBars=n.professional.showSummaryBars),void 0!==n.professional.p6Format&&(this.settings.p6Format=n.professional.p6Format)),n.baseline&&(void 0!==n.baseline.showBaseline&&(this.settings.showBaseline=n.baseline.showBaseline),n.baseline.baselineColor&&(e=n.baseline.baselineColor).solid&&e.solid.color&&(this.settings.baselineColor=e.solid.color),void 0!==n.baseline.baselineHeight&&(this.settings.baselineHeight=n.baseline.baselineHeight),void 0!==n.baseline.showPlannedProgress&&(this.settings.showPlannedProgress=n.baseline.showPlannedProgress),n.baseline.plannedProgressColor&&(e=n.baseline.plannedProgressColor).solid&&e.solid.color&&(this.settings.plannedProgressColor=e.solid.color)),n.colors&&(n.colors.level0Color&&(e=n.colors.level0Color).solid&&e.solid.color&&(this.settings.level0Color=e.solid.color),n.colors.level1Color&&(e=n.colors.level1Color).solid&&e.solid.color&&(this.settings.level1Color=e.solid.color),n.colors.level2Color&&(e=n.colors.level2Color).solid&&e.solid.color&&(this.settings.level2Color=e.solid.color),n.colors.level3Color&&(e=n.colors.level3Color).solid&&e.solid.color&&(this.settings.level3Color=e.solid.color),n.colors.level4Color&&(e=n.colors.level4Color).solid&&e.solid.color&&(this.settings.level4Color=e.solid.color),n.colors.level5Color&&(e=n.colors.level5Color).solid&&e.solid.color&&(this.settings.level5Color=e.solid.color),n.colors.level6Color&&(e=n.colors.level6Color).solid&&e.solid.color&&(this.settings.level6Color=e.solid.color),n.colors.level7Color&&(e=n.colors.level7Color).solid&&e.solid.color&&(this.settings.level7Color=e.solid.color),n.colors.level8Color&&(e=n.colors.level8Color).solid&&e.solid.color&&(this.settings.level8Color=e.solid.color),n.colors.level9Color&&(e=n.colors.level9Color).solid&&e.solid.color&&(this.settings.level9Color=e.solid.color),n.colors.progressColor&&(e=n.colors.progressColor).solid&&e.solid.color&&(this.settings.progressColor=e.solid.color)),n.formatting&&(void 0!==n.formatting.columnFontSize&&(this.settings.columnFontSize=n.formatting.columnFontSize),void 0!==n.formatting.columnFontFamily&&(this.settings.columnFontFamily=n.formatting.columnFontFamily),void 0!==n.formatting.showBarText&&(this.settings.showBarText=n.formatting.showBarText),void 0!==n.formatting.barTextSize&&(this.settings.barTextSize=n.formatting.barTextSize),void 0!==n.formatting.barTextFont&&(this.settings.barTextFont=n.formatting.barTextFont),void 0!==n.formatting.showSignature&&(this.settings.showSignature=n.formatting.showSignature),void 0!==n.formatting.signatureSize&&(this.settings.signatureSize=n.formatting.signatureSize),void 0!==n.formatting.showStartDate&&(this.settings.showStartDate=n.formatting.showStartDate),void 0!==n.formatting.showFinishDate&&(this.settings.showFinishDate=n.formatting.showFinishDate),void 0!==n.formatting.showProgressColumn&&(this.settings.showProgressColumn=n.formatting.showProgressColumn),void 0!==n.formatting.showLevelText&&(this.settings.showLevelText=n.formatting.showLevelText),void 0!==n.formatting.showTaskCount&&(this.settings.showTaskCount=n.formatting.showTaskCount),void 0!==n.formatting.showHeaderTaskCount&&(this.settings.showHeaderTaskCount=n.formatting.showHeaderTaskCount),void 0!==n.formatting.columnWidth&&(this.settings.columnWidth=n.formatting.columnWidth),void 0!==n.formatting.showLevelIndicators&&(this.settings.showLevelIndicators=n.formatting.showLevelIndicators),void 0!==n.formatting.showBaselineStartDate&&(this.settings.showBaselineStartDate=n.formatting.showBaselineStartDate),void 0!==n.formatting.showBaselineFinishDate&&(this.settings.showBaselineFinishDate=n.formatting.showBaselineFinishDate),void 0!==n.formatting.showVariance&&(this.settings.showVariance=n.formatting.showVariance),n.formatting.positiveVarianceColor&&(e=n.formatting.positiveVarianceColor).solid&&e.solid.color&&(this.settings.positiveVarianceColor=e.solid.color),n.formatting.negativeVarianceColor&&(e=n.formatting.negativeVarianceColor).solid&&e.solid.color&&(this.settings.negativeVarianceColor=e.solid.color),void 0!==n.formatting.showPlannedProgressColumn&&(this.settings.showPlannedProgressColumn=n.formatting.showPlannedProgressColumn),void 0!==n.formatting.taskNameSize&&(this.settings.taskNameSize=n.formatting.taskNameSize),void 0!==n.formatting.startDateSize&&(this.settings.startDateSize=n.formatting.startDateSize),void 0!==n.formatting.finishDateSize&&(this.settings.finishDateSize=n.formatting.finishDateSize),void 0!==n.formatting.baselineStartSize&&(this.settings.baselineStartSize=n.formatting.baselineStartSize),void 0!==n.formatting.baselineFinishSize&&(this.settings.baselineFinishSize=n.formatting.baselineFinishSize),void 0!==n.formatting.varianceSize&&(this.settings.varianceSize=n.formatting.varianceSize),void 0!==n.formatting.actualProgressSize&&(this.settings.actualProgressSize=n.formatting.actualProgressSize),void 0!==n.formatting.plannedProgressSize&&(this.settings.plannedProgressSize=n.formatting.plannedProgressSize)),n.headerSettings&&(void 0!==n.headerSettings.headerHeight&&(this.settings.headerHeight=n.headerSettings.headerHeight),void 0!==n.headerSettings.headerText&&(this.settings.headerText=n.headerSettings.headerText),void 0!==n.headerSettings.ganttHeaderText&&(this.settings.ganttHeaderText=n.headerSettings.ganttHeaderText),void 0!==n.headerSettings.taskDetailsText&&(this.settings.taskDetailsText=n.headerSettings.taskDetailsText)),n.headerColors)n.headerColors.taskHeaderColor&&(e=n.headerColors.taskHeaderColor).solid&&e.solid.color&&(this.settings.taskHeaderColor=e.solid.color),n.headerColors.ganttHeaderColor&&(e=n.headerColors.ganttHeaderColor).solid&&e.solid.color&&(this.settings.ganttHeaderColor=e.solid.color)}}catch(t){console.warn("Settings parsing error:",t)}},t.prototype.extractTasks=function(t){console.log("üîç Extracting tasks from dataView");try{if(!t.categorical)return console.log("‚ùå No categorical data"),{tasks:[]};var e=t.categorical;if(!e.categories||0===e.categories.length)return console.log("‚ùå No categories"),{tasks:[]};var n=e.categories;if(console.log("üìä Found ".concat(n.length," category level(s)")),!e.values||0===e.values.length)return console.log("‚ùå No values data"),{tasks:[]};var i=[],s=[],o=[],a=[],r=[],l=[],h=[];if(e.values.forEach(function(t){if(t.source&&t.source.roles){var e=t.source.roles;e.startDate?i=t.values||[]:e.finishDate?s=t.values||[]:e.progress?o=t.values||[]:e.dataDate?a=t.values||[]:e.baselineStartDate?r=t.values||[]:e.baselineFinishDate?l=t.values||[]:e.plannedProgress&&(h=t.values||[])}}),0===i.length&&0===s.length)return console.log("‚ùå Missing date columns"),{tasks:[]};var c=void 0;if(a.length>0)for(var d=0,g=a;d<g.length;d++){var p=g[d],f=this.parseDate(p);if(f){c=f;break}}return{tasks:this.buildMultiLevelHierarchy(n,i,s,o,r,l,h),dataDate:c}}catch(t){return console.error("‚ùå Task extraction failed:",t),{tasks:[]}}},t.prototype.buildMultiLevelHierarchy=function(t,e,n,i,s,o,a){var r,l,h=[],c=new Map,d=(null===(l=null===(r=t[0])||void 0===r?void 0:r.values)||void 0===l?void 0:l.length)||0;console.log("üìä Processing ".concat(d," rows with ").concat(t.length," levels"));for(var g=0;g<d;g++){for(var p=[],f=0;f<t.length;f++){var u=t[f].values[g];null!=u&&""!==String(u).trim()&&p.push(String(u).trim())}if(0!==p.length){var v=this.parseDate(e[g]),m=this.parseDate(n[g]),x=this.parseDate(s[g]),w=this.parseDate(o[g]);if(v||m||x||w){var b=this.parseProgress(i[g]),y=this.parseProgress(a[g]),D=(Boolean(v&&!m||!v&&m),!(!v||m)||!(!m||v)),C=v||m||new Date,S=D?C:m||v||new Date,T=void 0;m&&w&&(T=Math.floor((m.getTime()-w.getTime())/864e5));for(var k=void 0,z=function(t){var e=p[t],n=p.slice(0,t+1).join(" > "),i=c.get(n);i?(C<i.startDate&&(i.startDate=C),S>i.finishDate&&(i.finishDate=S),x&&(!i.baselineStartDate||x<i.baselineStartDate)&&(i.baselineStartDate=x),w&&(!i.baselineFinishDate||w>i.baselineFinishDate)&&(i.baselineFinishDate=w),i.progress=(i.progress+b)/2,void 0!==i.variance&&void 0!==T&&(i.variance=(i.variance+T)/2)):(i={id:"task_".concat(n.replace(/[^a-zA-Z0-9]/g,"_")),name:e,originalName:e,startDate:C,finishDate:S,progress:t===p.length-1?b:0,level:"Level ".concat(t+1),levelIndex:t,rawLevelNumber:t+1,hierarchyLevel:t,children:[],isExpanded:L.viewState.expandedNodes.has(n)||0===t,displayDepth:t,dataIndex:g,levelNames:p.slice(0,t+1),fullPath:n,baselineStartDate:x,baselineFinishDate:w,plannedProgress:t===p.length-1?y:0,isMilestone:t===p.length-1&&D,variance:t===p.length-1?T:void 0},c.set(n,i),k?(k.children||(k.children=[]),k.children.find(function(t){return t.fullPath===i.fullPath})||(k.children.push(i),i.parentTask=k)):h.find(function(t){return t.fullPath===i.fullPath})||h.push(i)),k=i},L=this,P=0;P<p.length;P++)z(P)}}}return this.updateParentDatesAndVariance(h),console.log("üèÅ Final hierarchy structure:"),this.logHierarchyStructure(h,""),h},t.prototype.updateParentDatesAndVariance=function(t){var e=this;t.forEach(function(t){if(t.children&&t.children.length>0){e.updateParentDatesAndVariance(t.children);var n=t.children.flatMap(function(t){return[t.startDate,t.finishDate]}),i=new Date(Math.min.apply(Math,n.map(function(t){return t.getTime()}))),s=new Date(Math.max.apply(Math,n.map(function(t){return t.getTime()})));t.startDate=i,t.finishDate=s,t.aggregatedDates={start:i,finish:s};var o=t.children.reduce(function(t,e){return t+e.progress},0);t.progress=o/t.children.length;var a=t.children.filter(function(t){return void 0!==t.variance});if(a.length>0){var r=a.reduce(function(t,e){return t+(e.variance||0)},0);t.variance=Math.round(r/a.length)}}})},t.prototype.updateParentDates=function(t){var e=this;t.forEach(function(t){if(t.children&&t.children.length>0){e.updateParentDates(t.children);var n=t.children.flatMap(function(t){return[t.startDate,t.finishDate]}),i=new Date(Math.min.apply(Math,n.map(function(t){return t.getTime()}))),s=new Date(Math.max.apply(Math,n.map(function(t){return t.getTime()})));t.startDate=i,t.finishDate=s,t.aggregatedDates={start:i,finish:s};var o=t.children.reduce(function(t,e){return t+e.progress},0);t.progress=o/t.children.length}})},t.prototype.logHierarchyStructure=function(t,e){var n=this;t.forEach(function(t){var i;console.log("".concat(e).concat(t.originalName," (Level ").concat(t.rawLevelNumber,") - Children: ").concat((null===(i=t.children)||void 0===i?void 0:i.length)||0)),t.children&&t.children.length>0&&n.logHierarchyStructure(t.children,e+"  ")})},t.prototype.updateVisibleTasks=function(){var t=this;this.visibleTasks=[];var e=function(n,i){void 0===i&&(i=0),n.displayDepth=i,t.visibleTasks.push(n),n.isExpanded&&n.children&&n.children.length>0&&n.children.forEach(function(t){return e(t,i+1)})};this.allTasks.forEach(function(t){e(t,0)}),console.log("üëÅÔ∏è Visible tasks after update:",this.visibleTasks.map(function(t,e){return"".concat(e,": ").concat(t.originalName," (Depth: ").concat(t.displayDepth,")")}))},t.prototype.toggleTaskExpansion=function(t){var e=this;console.log("üîÑ Toggling expansion for task:",t);var n=function(i){for(var s=0,o=i;s<o.length;s++){var a=o[s];if(a.id===t)return a.isExpanded=!a.isExpanded,a.isExpanded?e.viewState.expandedNodes.add(a.fullPath||a.id):e.viewState.expandedNodes.delete(a.fullPath||a.id),console.log('   ‚úÖ Toggled "'.concat(a.originalName,'" to ').concat(a.isExpanded?"EXPANDED":"COLLAPSED")),!0;if(a.children&&n(a.children))return!0}return!1};if(n(this.allTasks)&&(this.updateVisibleTasks(),this.renderChart(this.visibleTasks,this.currentDataDate),this.setupEventListeners(),this.addProfessionalFeatures(),this.host.persistProperties)){var i=Array.from(this.viewState.expandedNodes);this.host.persistProperties({merge:[{objectName:"general",properties:{expandedNodes:JSON.stringify(i)},selector:null}]})}},t.prototype.parseDate=function(t){if(!t)return null;try{if(t instanceof Date)return isNaN(t.getTime())?null:t;if("string"==typeof t){var e=new Date(t);return isNaN(e.getTime())?null:e}if("number"==typeof t){if(t>1e9&&t<1e10)return new Date(1e3*t);if(t>1e12)return new Date(t);if(t>1&&t<1e5){var n=new Date(1900,0,1);return new Date(n.getTime()+24*(t-2)*60*60*1e3)}}return null}catch(t){return null}},t.prototype.parseProgress=function(t){if(null==t)return 0;var e=Number(t);return isNaN(e)?0:e<=1?100*e:Math.min(100,Math.max(0,e))},t.prototype.renderChart=function(t,e){var n=this,i=e||this.currentDataDate,s=this.getAllTasksFlattened(this.allTasks),o=s.flatMap(function(t){return[t.startDate,t.finishDate]});this.settings.showBaseline&&s.forEach(function(t){t.baselineStartDate&&o.push(t.baselineStartDate),t.baselineFinishDate&&o.push(t.baselineFinishDate)});var a=new Date(Math.min.apply(Math,o.map(function(t){return t.getTime()}))-1728e5),r=new Date(Math.max.apply(Math,o.map(function(t){return t.getTime()}))+1728e5),l=this.calculateChartWidth(a,r),h=this.calculateTimelineHeaderHeight();this.target.innerHTML="\n            <div style=\"\n                width: 100%; height: 100%; display: flex;\n                font-family: 'Segoe UI', Arial, sans-serif; \n                background: white; border: 2px solid #28a745; position: relative;\n                ".concat(this.settings.showAnimations?"transition: all 0.3s ease;":"",'\n            ">\n                ').concat(this.renderTaskList(t),"\n                ").concat(this.renderGanttArea(t,a,r,l,i,h),"\n                ").concat(this.settings.showSignature?this.renderSignature():"","\n                ").concat(this.renderProfessionalStyles(),"\n            </div>\n        "),this.setupScrolling(),this.restoreViewState(),setTimeout(function(){n.handleContextMenu()},100)},t.prototype.calculateTimelineHeaderHeight=function(){var t=0;return this.settings.showYears&&(t+=30),this.settings.showMonths&&(t+=25),this.settings.showWeeks&&(t+=20),this.settings.showDays&&(t+=20),Math.max(30,t)},t.prototype.getAllTasksFlattened=function(t){var e=[],n=function(t){e.push(t),t.children&&t.children.forEach(n)};return t.forEach(n),e},t.prototype.calculateChartWidth=function(t,e){var n=this.target.clientWidth-this.settings.columnWidth-40;if(this.settings.fitToSize)return Math.max(400,n);if(this.settings.timelineAutoSize){var i=(e.getTime()-t.getTime())/864e5,s=3;this.settings.showDays?s=25:this.settings.showWeeks?s=8:this.settings.showMonths?s=4:this.settings.showYears&&(s=2);var o=i*s;return Math.max(n,o)}var a=(e.getTime()-t.getTime())/864e5,r=Math.max(15*a,3*n,1200);return console.log("üìè Chart width: Available=".concat(n,", Expanded=").concat(r,", TotalDays=").concat(a)),r},t.prototype.renderTaskList=function(t){var e=this,n=this.settings.compactMode?40:58,i=this.calculateTimelineHeaderHeight();return'\n            <div style="\n                width: '.concat(this.settings.columnWidth,'px; height: 100%; \n                border-right: 2px solid #dee2e6;\n                background: linear-gradient(to bottom, #f8f9fa, #e9ecef); display: flex; flex-direction: column;\n                box-shadow: 2px 0 4px rgba(0,0,0,0.1);\n            ">\n                <div style="\n                    height: ').concat(this.settings.headerHeight,"px; \n                    background: linear-gradient(135deg, ").concat(this.settings.taskHeaderColor,", ").concat(this.darkenColor(this.settings.taskHeaderColor,20),');\n                    color: white; display: flex; align-items: center; padding: 0 15px;\n                    font-weight: 600; font-size: 14px; box-shadow: 0 2px 4px rgba(0,0,0,0.2);\n                    text-shadow: 0 1px 2px rgba(0,0,0,0.3);\n                ">\n                    <div style="display: flex; align-items: center; gap: 8px;">\n                        <span style="font-size: 18px;">üìä</span>\n                        <span>').concat(this.settings.headerText,"</span>\n                        ").concat(this.settings.showHeaderTaskCount?'\n                            <span style="background: rgba(255,255,255,0.2); padding: 2px 8px; border-radius: 12px; font-size: 11px;">\n                                '.concat(t.length,"\n                            </span>\n                        "):"",'\n                    </div>\n                </div>\n                \n                \x3c!-- Spacer to align with timeline header --\x3e\n                <div style="\n                    height: ').concat(i,'px;\n                    background: #f8f9fa; border-bottom: 2px solid #dee2e6;\n                    display: flex; align-items: center; padding: 0 15px;\n                    font-size: 12px; color: #666; font-weight: 500;\n                ">\n                    ').concat(this.settings.taskDetailsText,'\n                </div>\n                \n                <div class="task-list-scroll" style="\n                    flex: 1; overflow-y: auto; overflow-x: hidden;\n                    scrollbar-width: thin; scrollbar-color: #ccc #f0f0f0;\n                    padding: 0;  /* Add this */\n                    margin: 0;   /* Add this */\n                ">\n                    ').concat(t.map(function(t,i){var s=t.children&&t.children.length>0,o=t.displayDepth||0;return'\n\n                        <div class="task-row" data-task-row="'.concat(i,'" style="\n                            height: ').concat(n,"px; \n                            box-sizing: border-box;\n                            display: flex; \n                            align-items: center; \n                            padding: 0 15px;\n                            border-bottom: 1px solid #dee2e6;\n                            background: ").concat(i%2==0?"#ffffff":"#f8f9fa",";\n                            font-size: 12px;\n                            padding-left: ").concat(15+20*o,"px;\n                            ").concat(e.settings.showAnimations?"transition: all 0.2s ease;":"",'\n                            position: relative;\n                        ">\n                            ').concat(o>0?'<div style="position: absolute; left: '.concat(15+20*(o-1),'px; top: 0; bottom: 0; width: 1px; background: #ddd;"></div>'):"","\n                            \n                            \x3c!-- Expand/Collapse Button --\x3e\n                            ").concat(s?'\n                            <div \n                                data-task-toggle="'.concat(t.id,'" \n                                style="\n                                    width: 16px; height: 16px; margin-right: 8px;\n                                    flex-shrink: 0; display: flex; align-items: center; justify-content: center;\n                                    background: #ffffff; border: 1px solid #999;\n                                    cursor: pointer; font-size: 11px; color: #333;\n                                    user-select: none;\n                                ">\n                                ').concat(t.isExpanded?"‚àí":"+","\n                            </div>\n                            "):'\n                            <div style="\n                                width: 16px; height: 16px; margin-right: 8px;\n                                flex-shrink: 0; display: flex; align-items: center; justify-content: center;\n                            ">\n                                '.concat(e.settings.showLevelIndicators&&o>0?'\n                                    <div style="\n                                        width: 6px; height: 6px;\n                                        background: '.concat(e.getLevelColor(t.levelIndex),'; \n                                        border-radius: 50%;\n                                    "></div>\n                                '):"","\n                            </div>\n                            "),'\n                            \n                            <div style="flex: 1; min-width: 0; display: flex; flex-direction: column; justify-content: center;">\n                                \x3c!-- TASK NAME WITH CUSTOM SIZE --\x3e\n                                <div style="font-weight: ').concat(s?"600":"500","; color: #495057; margin-bottom: 2px; \n                                        white-space: nowrap; overflow: hidden; text-overflow: ellipsis;\n                                        font-size: ").concat(e.settings.taskNameSize,"px; font-family: ").concat(e.settings.columnFontFamily,';">\n                                    ').concat(t.isMilestone?"‚óÜ ":"").concat(t.originalName,"\n                                    ").concat(e.settings.showTaskCount&&(t.taskCount||0)>1?'<span style="background: #007bff; color: white; padding: 1px 6px; border-radius: 8px; font-size: 9px; margin-left: 8px;">'.concat(t.taskCount,"</span>"):"",'\n                                </div>\n                                \n                                \x3c!-- TASK DETAILS WITH INDIVIDUAL SIZES --\x3e\n                                <div style="display: flex; flex-wrap: wrap; gap: 8px; color: #6c757d; font-family: ').concat(e.settings.columnFontFamily,';">\n                                    \n                                    ').concat(e.settings.showLevelText?'<span style="color: '.concat(e.getLevelColor(t.levelIndex),"; font-weight: 500; font-size: ").concat(e.settings.columnFontSize,'px;">').concat(t.level,"</span>"):"","\n                                    \n                                    ").concat(e.settings.showStartDate?'<span style="font-size: '.concat(e.settings.startDateSize,'px;"><span style="color: #28a745;">‚ñ∂</span> ').concat(e.formatDate(t.startDate),"</span>"):"","\n                                    \n                                    ").concat(e.settings.showFinishDate?'<span style="font-size: '.concat(e.settings.finishDateSize,'px;"><span style="color: #dc3545;">‚óÄ</span> ').concat(e.formatDate(t.finishDate),"</span>"):"","\n                                    \n                                    ").concat(e.settings.showBaselineStartDate&&t.baselineStartDate?'<span style="font-size: '.concat(e.settings.baselineStartSize,'px;"><span style="color: #6c757d;">‚ö°</span> B.Start: ').concat(e.formatDate(t.baselineStartDate),"</span>"):"","\n                                    \n                                    ").concat(e.settings.showBaselineFinishDate&&t.baselineFinishDate?'<span style="font-size: '.concat(e.settings.baselineFinishSize,'px;"><span style="color: #6c757d;">‚ö°</span> B.Finish: ').concat(e.formatDate(t.baselineFinishDate),"</span>"):"","\n                                    \n                                    ").concat(e.settings.showVariance&&void 0!==t.variance?'\n                                        <span style="\n                                            color: '.concat(t.variance>0?e.settings.negativeVarianceColor:e.settings.positiveVarianceColor,";\n                                            font-weight: 600;\n                                            font-size: ").concat(e.settings.varianceSize,'px;\n                                        ">\n                                            Var: ').concat(Math.round(Math.abs(t.variance)),"d\n                                        </span>\n                                    "):"","\n                                    \n                                    ").concat(e.settings.showProgressColumn?'\n                                        <span style="display: flex; align-items: center; gap: 4px;">\n                                            <span style="font-size: '.concat(e.settings.actualProgressSize,'px; color: #6c757d;">Actual:</span>\n                                            <div style="width: 30px; height: 3px; background: #e9ecef; border-radius: 2px; overflow: hidden;">\n                                                <div style="height: 100%; background: ').concat(e.settings.progressColor,"; width: ").concat(Math.round(t.progress),'%; transition: width 0.3s ease;"></div>\n                                            </div>\n                                            <span style="font-size: ').concat(e.settings.actualProgressSize,'px; color: #666;">').concat(Math.round(t.progress),"%</span>\n                                        </span>\n                                    "):"","\n\n                                    ").concat(e.settings.showPlannedProgressColumn&&(t.plannedProgress||0)>0?'\n                                        <span style="display: flex; align-items: center; gap: 4px;">\n                                            <span style="font-size: '.concat(e.settings.plannedProgressSize,'px; color: #6c757d;">Planned:</span>\n                                            <div style="width: 30px; height: 3px; background: #e9ecef; border-radius: 2px; overflow: hidden;">\n                                                <div style="height: 100%; background: ').concat(e.settings.plannedProgressColor,"; width: ").concat(Math.round(t.plannedProgress||0),'%; transition: width 0.3s ease;"></div>\n                                            </div>\n                                            <span style="font-size: ').concat(e.settings.plannedProgressSize,'px; color: #666;">').concat(Math.round(t.plannedProgress||0),"%</span>\n                                        </span>\n                                    "):"","\n                                </div>\n                            </div>\n                        </div>\n                    ")}).join(""),"\n                </div>\n            </div>\n        ")},t.prototype.setupEventListeners=function(){var t=this;this.target.querySelectorAll("[data-task-toggle]").forEach(function(e){e.removeEventListener("click",t.handleTaskToggle)}),this.target.querySelectorAll("[data-task-toggle]").forEach(function(e){e.addEventListener("click",t.handleTaskToggle.bind(t))}),this.settings.showHoverEffects&&this.setupHoverEffects()},t.prototype.handleContextMenu=function(){this.target.removeEventListener("contextmenu",this.contextMenuHandler),this.target.addEventListener("contextmenu",this.contextMenuHandler.bind(this))},t.prototype.setupHoverEffects=function(){var t=this.target.querySelectorAll("[data-task-row]"),e=this.target.querySelectorAll("[data-task-bar]");t.forEach(function(t,n){var i=e[n];t.addEventListener("mouseenter",function(){t.classList.add("hovered"),i&&i.classList.add("hovered")}),t.addEventListener("mouseleave",function(){t.classList.remove("hovered"),i&&i.classList.remove("hovered")})}),e.forEach(function(e,n){var i=t[n];e.addEventListener("mouseenter",function(){e.classList.add("hovered"),i&&i.classList.add("hovered")}),e.addEventListener("mouseleave",function(){e.classList.remove("hovered"),i&&i.classList.remove("hovered")})})},t.prototype.setupScrolling=function(){var t=this;if(this.taskListContainer=this.target.querySelector(".task-list-scroll"),this.ganttContainer=this.target.querySelector(".gantt-scroll"),this.timelineContainer=this.target.querySelector(".timeline-header"),this.taskListContainer&&this.ganttContainer){this.taskListContainer.onscroll=null,this.ganttContainer.onscroll=null;var e=!1,n=!1;this.taskListContainer.addEventListener("scroll",function(){n||(e=!0,t.ganttContainer.scrollTop=t.taskListContainer.scrollTop,setTimeout(function(){e=!1},0)),t.saveViewState()}),this.ganttContainer.addEventListener("scroll",function(){e||(n=!0,t.taskListContainer.scrollTop=t.ganttContainer.scrollTop,setTimeout(function(){n=!1},0)),t.timelineContainer&&(t.timelineContainer.scrollLeft=t.ganttContainer.scrollLeft),t.saveViewState()})}},t.prototype.saveViewState=function(){this.ganttContainer&&(this.viewState.scrollLeft=this.ganttContainer.scrollLeft,this.viewState.scrollTop=this.ganttContainer.scrollTop),this.currentDataDate&&(this.viewState.dataDate=this.currentDataDate)},t.prototype.restoreViewState=function(){var t=this;setTimeout(function(){t.ganttContainer&&(t.ganttContainer.scrollLeft=t.viewState.scrollLeft,t.ganttContainer.scrollTop=t.viewState.scrollTop),t.taskListContainer&&(t.taskListContainer.scrollTop=t.viewState.scrollTop),t.timelineContainer&&(t.timelineContainer.scrollLeft=t.viewState.scrollLeft),t.viewState.dataDate&&(t.currentDataDate=t.viewState.dataDate)},100)},t.prototype.renderGanttArea=function(t,e,n,i,s,o){var a=this;void 0===o&&(o=30);var r=this.target.clientWidth-this.settings.columnWidth,l=!this.settings.fitToSize&&i>r,h=this.settings.compactMode?40:58;return'\n            <div style="flex: 1; height: 100%; display: flex; flex-direction: column;">\n                <div style="\n                    height: '.concat(this.settings.headerHeight,"px; \n                    background: linear-gradient(135deg, ").concat(this.settings.ganttHeaderColor,", ").concat(this.darkenColor(this.settings.ganttHeaderColor,20),');\n                    color: white; display: flex; align-items: center; padding: 0 20px;\n                    font-weight: 600; font-size: 14px; box-shadow: 0 2px 4px rgba(0,0,0,0.2);\n                    text-shadow: 0 1px 2px rgba(0,0,0,0.3); position: relative; z-index: 10;\n                ">\n                    <div style="display: flex; align-items: center; gap: 8px;">\n                        <span style="font-size: 18px;">üìÖ</span>\n                        <span>').concat(this.settings.ganttHeaderText,": ").concat(this.formatDate(e)," ‚Üí ").concat(this.formatDate(n),"</span>\n                        ").concat(s?'<span style="background: rgba(255,255,255,0.2); padding: 2px 8px; border-radius: 12px; font-size: 11px;">Data: '.concat(this.formatDate(s),"</span>"):"",'\n                    </div>\n                </div>\n                \n                \x3c!-- Sticky Timeline Header --\x3e\n                <div class="timeline-header" style="\n                    height: ').concat(o,'px;\n                    background: #f8f9fa; border-bottom: 2px solid #dee2e6;\n                    position: sticky; top: 0; z-index: 20;\n                    overflow-x: hidden; overflow-y: hidden;\n                    box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n                ">\n                    ').concat(this.renderMultiLayerTimelineHeaders(e,n,i),'\n                </div>\n                \n                <div class="gantt-scroll" style="\n                    flex: 1; \n                    overflow-y: auto; \n                    overflow-x: ').concat(l?"auto":"hidden",';\n                    background: white; position: relative;\n                    scrollbar-width: thin; scrollbar-color: #ccc #f0f0f0;\n                    padding: 0;  /* Add this */\n                    margin: 0;   /* Add this */    \n                ">\n\n                    <div style="\n                        position: relative; \n                        width: ').concat(i,"px;\n                        height: ").concat(t.length*h,'px;\n                        padding: 0;\n                        margin: 0;\n                        box-sizing: content-box;\n                    ">\n                        ').concat(this.settings.showGridLines?t.map(function(t,e){return'\n                            <div style="\n                                position: absolute;\n                                top: '.concat((e+1)*h-1,"px;\n                                left: 0;\n                                right: 0;\n                                height: 1px;\n                                background: ").concat(a.settings.gridLineColor,';\n                            "></div>\n                        ')}).join(""):"","\n                        ").concat(this.settings.showDataDate&&s?this.renderDataDateLine(e,n,i,t.length*h,s):"","\n                        ").concat(this.settings.showToday?this.renderTodayLine(e,n,i,t.length*h):"","\n                        ").concat(this.settings.showGridLines?this.renderVerticalGridLines(e,n,i,t.length*h):"","\n                        ").concat(t.map(function(t,s){return a.renderTaskBar(t,s,e,n,i,h)}).join(""),"\n                    </div>\n                </div>\n            </div>\n        ")},t.prototype.renderMultiLayerTimelineHeaders=function(t,e,n){var i='<div style="position: relative; width: '+n+'px; height: 100%;">',s=0;return this.settings.showYears&&(i+='<div style="position: absolute; top: '+s+'px; left: 0; right: 0; height: 30px; border-bottom: 1px solid #ccc;">',i+=this.renderYearsHeader(t,e,n),i+="</div>",s+=30),this.settings.showMonths&&(i+='<div style="position: absolute; top: '+s+'px; left: 0; right: 0; height: 25px; border-bottom: 1px solid #ddd;">',i+=this.renderMonthsHeader(t,e,n),i+="</div>",s+=25),this.settings.showWeeks&&(i+='<div style="position: absolute; top: '+s+'px; left: 0; right: 0; height: 20px; border-bottom: 1px solid #ddd;">',i+=this.renderWeeksHeader(t,e,n),i+="</div>",s+=20),this.settings.showDays&&(i+='<div style="position: absolute; top: '+s+'px; left: 0; right: 0; height: 20px;">',i+=this.renderDaysHeader(t,e,n),i+="</div>"),i+"</div>"},t.prototype.renderYearsHeader=function(t,e,n){for(var i="",s=[],o=t.getFullYear();o<=e.getFullYear();o++)s.push(o);return s.forEach(function(s){var o=new Date(s,0,1),a=new Date(s,11,31),r=Math.max(0,(o.getTime()-t.getTime())/(e.getTime()-t.getTime())*n),l=Math.min(n,(a.getTime()-t.getTime())/(e.getTime()-t.getTime())*n)-r;l>30&&(i+='<div style="position: absolute; left: '.concat(r,"px; width: ").concat(l,'px; height: 30px; display: flex; align-items: center; justify-content: center; font-size: 12px; font-weight: bold; border-right: 1px solid #bbb; background: linear-gradient(to bottom, #f0f0f0, #e0e0e0);">').concat(s,"</div>"))}),i},t.prototype.renderMonthsHeader=function(t,e,n){for(var i="",s=[],o=new Date(t.getFullYear(),t.getMonth(),1);o<=e;o.setMonth(o.getMonth()+1))s.push(new Date(o));return s.forEach(function(s){var o=s,a=new Date(s.getFullYear(),s.getMonth()+1,0),r=Math.max(0,(o.getTime()-t.getTime())/(e.getTime()-t.getTime())*n),l=Math.min(n,(a.getTime()-t.getTime())/(e.getTime()-t.getTime())*n)-r;l>20&&(i+='<div style="position: absolute; left: '.concat(r,"px; width: ").concat(l,'px; height: 25px; display: flex; align-items: center; justify-content: center; font-size: 10px; border-right: 1px solid #ccc; background: #f8f8f8;">').concat(s.toLocaleDateString("en-US",{month:"short",year:"2-digit"}),"</div>"))}),i},t.prototype.renderWeeksHeader=function(t,e,n){for(var i=(e.getTime()-t.getTime())/864e5,s=Math.ceil(i/7),o=n/s,a="",r=0;r<s;r++)a+='<div style="position: absolute; left: '.concat(r*o,"px; width: ").concat(o,'px; height: 20px; display: flex; align-items: center; justify-content: center; font-size: 9px; border-right: 1px solid #ddd; background: #fafafa;">W').concat(r+1,"</div>");return a},t.prototype.renderDaysHeader=function(t,e,n){for(var i=n/((e.getTime()-t.getTime())/864e5),s="",o=new Date(t);o<=e;o.setDate(o.getDate()+1)){var a=(o.getTime()-t.getTime())/(e.getTime()-t.getTime())*n,r=0===o.getDay()||6===o.getDay();s+='<div style="position: absolute; left: '.concat(a,"px; width: ").concat(i,"px; height: 20px; display: flex; align-items: center; justify-content: center; font-size: 8px; border-right: 1px solid #eee; background: ").concat(r?"#ffe6e6":"#ffffff",';">').concat(o.getDate(),"</div>")}return s},t.prototype.renderVerticalGridLines=function(t,e,n,i){var s=this;if(!this.settings.showMonths&&!this.settings.showWeeks&&!this.settings.showDays)return"";var o="";if(this.settings.showMonths){for(var a=[],r=new Date(t.getFullYear(),t.getMonth(),1);r<=e;r.setMonth(r.getMonth()+1))a.push(new Date(r));a.forEach(function(a){var r=(a.getTime()-t.getTime())/(e.getTime()-t.getTime())*n;o+='<div style="position: absolute; left: '.concat(r,"px; top: 0; width: 1px; height: ").concat(i,"px; background: ").concat(s.settings.gridLineColor,'; opacity: 0.3;"></div>')})}return o},t.prototype.renderDataDateLine=function(t,e,n,i,s){if(s<t||s>e)return"";var o=(s.getTime()-t.getTime())/(e.getTime()-t.getTime())*n;return'\n            <div style="\n                position: absolute; left: '.concat(o,"px; top: 0;\n                width: ").concat(this.settings.dataDateLineWidth,"px; height: ").concat(i,"px;\n                background: ").concat(this.settings.dataDateLineColor,'; z-index: 15;\n                box-shadow: 0 0 4px rgba(220,53,69,0.5);\n            " title="Data Date: ').concat(this.formatDate(s),'">\n                <div style="\n                    position: absolute; top: ').concat(this.settings.dataDateLabelOffset,"px; left: -25px; width: 50px; height: 20px;\n                    background: ").concat(this.settings.dataDateLineColor,'; color: white;\n                    font-size: 9px; display: flex; align-items: center; justify-content: center;\n                    border-radius: 4px; font-weight: bold; z-index: 16;\n                    box-shadow: 0 2px 4px rgba(0,0,0,0.3);\n                ">DATA DATE</div>\n            </div>\n        ')},t.prototype.renderTodayLine=function(t,e,n,i){var s=new Date;if(s<t||s>e)return"";var o=(s.getTime()-t.getTime())/(e.getTime()-t.getTime())*n;return'\n            <div style="\n                position: absolute; left: '.concat(o,"px; top: 0;\n                width: ").concat(this.settings.todayLineWidth,"px; height: ").concat(i,"px;\n                background: ").concat(this.settings.todayLineColor,"; z-index: 10;\n                box-shadow: 0 0 6px rgba(255,68,68,0.6);\n                animation: ").concat(this.settings.showAnimations?"pulse 2s infinite":"none",';\n            " title="Today: ').concat(this.formatDate(s),'">\n                <div style="\n                    position: absolute; top: 20px; left: -20px; width: 40px; height: 20px;\n                    background: ').concat(this.settings.todayLineColor,'; color: white;\n                    font-size: 9px; display: flex; align-items: center; justify-content: center;\n                    border-radius: 4px; font-weight: bold; z-index: 11;\n                    box-shadow: 0 2px 4px rgba(0,0,0,0.3);\n                ">TODAY</div>\n            </div>\n        ')},t.prototype.renderTaskBar=function(t,e,n,i,s,o){var a=e*o+(o-this.settings.barHeight)/2,r=this.getLevelColor(t.levelIndex),l=t.children&&t.children.length>0;if(t.isMilestone)return this.renderMilestone(t,e,n,i,s,o);var h=(t.startDate.getTime()-n.getTime())/(i.getTime()-n.getTime())*s,c=(t.finishDate.getTime()-n.getTime())/(i.getTime()-n.getTime())*s,d=Math.max(6,c-h),g=t.progress/100*d,p=r,f=g,u=!1;if(this.settings.p6Format&&this.currentDataDate){var v=(this.currentDataDate.getTime()-n.getTime())/(i.getTime()-n.getTime())*s-h;t.startDate<=this.currentDataDate&&(t.finishDate<=this.currentDataDate?(p=this.settings.progressColor,u=!1):(f=v,u=!0))}var m=l&&this.settings.showSummaryBars,x=m&&t.aggregatedDates?(t.aggregatedDates.start.getTime()-n.getTime())/(i.getTime()-n.getTime())*s:h,w=m&&t.aggregatedDates?(t.aggregatedDates.finish.getTime()-n.getTime())/(i.getTime()-n.getTime())*s:c,b=m?Math.max(6,w-x):d,y=m?x:h,D=m?b:d,C="";if(this.settings.showBaseline&&(t.baselineStartDate||t.baselineFinishDate)){var S=t.baselineStartDate||t.startDate,T=t.baselineFinishDate||t.finishDate,k=(S.getTime()-n.getTime())/(i.getTime()-n.getTime())*s,z=(T.getTime()-n.getTime())/(i.getTime()-n.getTime())*s,L=Math.max(6,z-k),P=a+this.settings.barHeight+2,F=this.settings.showPlannedProgress?(t.plannedProgress||0)/100*L:0;C='\n                <div style="\n                    position: absolute; left: '.concat(k,"px; top: ").concat(P,"px;\n                    width: ").concat(L,"px; height: ").concat(this.settings.baselineHeight,"px;\n                    background: ").concat(this.settings.baselineColor,'; \n                    border-radius: 2px; opacity: 0.8;\n                    box-shadow: 0 1px 3px rgba(0,0,0,0.2);\n                    cursor: pointer; z-index: 4;\n                " \n                title="Baseline: ').concat(this.formatDate(S)," - ").concat(this.formatDate(T),"\n    Planned Progress: ").concat(Math.round(t.plannedProgress||0),'%">\n                    ').concat(this.settings.showPlannedProgress&&(t.plannedProgress||0)>0?'\n                    <div style="\n                        width: '.concat(F,"px; height: 100%;\n                        background: ").concat(this.settings.plannedProgressColor,';\n                        border-radius: 1px; opacity: 0.9;\n                    "></div>\n                    '):"","\n                </div>\n            ")}return"\n            ".concat(C,'\n\n            <div class="task-bar" data-task-bar="').concat(e,'" style="\n                position: absolute; left: ').concat(y,"px; top: ").concat(a,"px;\n                width: ").concat(D,"px; height: ").concat(this.settings.barHeight,"px;\n                background: ").concat(m?"linear-gradient(to right, ".concat(p,", ").concat(this.darkenColor(p,30),")"):"linear-gradient(to right, ".concat(p,", ").concat(this.darkenColor(p,15),")"),"; \n                border-radius: ").concat(m?"0":"4px",";\n                border: ").concat(m?"none":"1px solid white","; \n                box-shadow: 0 2px 6px rgba(0,0,0,0.2);\n                cursor: pointer; overflow: hidden;\n                ").concat(this.settings.showAnimations?"transition: all 0.3s ease;":"","\n                ").concat(m?"border-top: 3px solid "+this.darkenColor(p,40)+"; border-bottom: 3px solid "+this.darkenColor(p,40)+";":"","\n                z-index: ").concat(m?"8":"5",';\n            " \n            title="').concat(t.originalName||t.name," (").concat(t.level,")\n    Start: ").concat(this.formatDate(t.startDate),"\n    End: ").concat(this.formatDate(t.finishDate),"\n    Progress: ").concat(Math.round(t.progress),"%\n    ").concat(void 0!==t.variance?"Variance: "+t.variance+" days":"","\n    ").concat(t.taskCount&&t.taskCount>1?"Tasks: "+t.taskCount:"",'">\n                \n                ').concat(this.settings.showProgress&&t.progress>0&&!m||this.settings.p6Format&&u?'\n                <div style="\n                    width: '.concat(this.settings.p6Format&&u?f:g,"px; \n                    height: 100%;\n                    background: linear-gradient(to right, ").concat(this.settings.progressColor,", ").concat(this.darkenColor(this.settings.progressColor,20),");\n                    opacity: ").concat(this.settings.p6Format?"1":"0.8","; \n                    border-radius: 2px;\n                    ").concat(this.settings.showAnimations?"transition: width 0.5s ease;":"",'\n                "></div>\n                '):"","\n                \n                ").concat(m?'\n                    <div style="\n                        position: absolute; left: '.concat(h-y,"px; top: 2px;\n                        width: ").concat(d,"px; height: ").concat(this.settings.barHeight-4,"px;\n                        background: ").concat(this.lightenColor(p,30),';\n                        border-radius: 2px; opacity: 0.7;\n                    "></div>\n                '):"","\n                \n                ").concat(this.settings.showBarText&&D>60?'\n                <div style="\n                    position: absolute; top: 50%; left: 8px; transform: translateY(-50%);\n                    color: white; font-size: '.concat(this.settings.barTextSize,"px; font-weight: 600;\n                    font-family: ").concat(this.settings.barTextFont,";\n                    white-space: nowrap; overflow: hidden; text-overflow: ellipsis;\n                    max-width: ").concat(D-16,'px; text-shadow: 0 1px 2px rgba(0,0,0,0.7);\n                    z-index: 10;\n                ">\n                    ').concat((t.originalName||t.name).replace(/^[\s‚ñ∫‚ñº‚Ä¢üîΩ‚ñ∂Ô∏è]*/,""),"\n                    ").concat(t.taskCount&&t.taskCount>1?" (".concat(t.taskCount,")"):"","\n                </div>\n                "):"","\n                \n                ").concat(m?'\n                    <div style="\n                        position: absolute; left: 2px; top: 2px; width: 4px; height: '.concat(this.settings.barHeight-4,"px;\n                        background: ").concat(this.darkenColor(p,50),'; border-radius: 2px;\n                    "></div>\n                    <div style="\n                        position: absolute; right: 2px; top: 2px; width: 4px; height: ').concat(this.settings.barHeight-4,"px;\n                        background: ").concat(this.darkenColor(p,50),'; border-radius: 2px;\n                    "></div>\n                '):"","\n            </div>\n        ")},t.prototype.renderMilestone=function(t,e,n,i,s,o){var a=t.startDate||t.finishDate,r=(a.getTime()-n.getTime())/(i.getTime()-n.getTime())*s,l=e*o+(o-this.settings.milestoneSize)/2,h=this.getLevelColor(t.levelIndex),c=this.settings.milestoneSize;return'\n            <div class="task-bar milestone" data-task-bar="'.concat(e,'" style="\n                position: absolute; left: ').concat(r-c/2,"px; top: ").concat(l,"px;\n                width: ").concat(c,"px; height: ").concat(c,"px;\n                background: ").concat(h,";\n                transform: rotate(45deg);\n                border: 2px solid white;\n                box-shadow: 0 2px 6px rgba(0,0,0,0.3);\n                cursor: pointer; z-index: 6;\n                ").concat(this.settings.showAnimations?"transition: all 0.3s ease;":"",'\n            " \n            title="Milestone: ').concat(t.originalName||t.name,"\n    Date: ").concat(this.formatDate(a),'">\n                ').concat(this.settings.showBarText?'\n                <div style="\n                    position: absolute; top: '.concat(c+5,"px; left: 50%; transform: translateX(-50%) rotate(-45deg);\n                    color: ").concat(h,"; font-size: ").concat(Math.max(8,this.settings.barTextSize-2),"px; font-weight: 600;\n                    font-family: ").concat(this.settings.barTextFont,'; white-space: nowrap;\n                    text-shadow: 1px 1px 2px rgba(255,255,255,0.8);\n                    z-index: 10; background: rgba(255,255,255,0.9); padding: 2px 4px; border-radius: 2px;\n                ">\n                    ').concat((t.originalName||t.name).replace(/^[\s‚ñ∫‚ñº‚Ä¢üîΩ‚ñ∂Ô∏è]*/,""),"\n                </div>\n                "):"","\n            </div>\n        ")},t.prototype.getLevelColor=function(t){var e=[this.settings.level0Color,this.settings.level1Color,this.settings.level2Color,this.settings.level3Color,this.settings.level4Color,this.settings.level5Color,this.settings.level6Color,this.settings.level7Color,this.settings.level8Color,this.settings.level9Color];return e[t%e.length]},t.prototype.darkenColor=function(t,e){var n=parseInt(t.replace("#",""),16),i=Math.round(2.55*e),s=(n>>16)-i,o=(n>>8&255)-i,a=(255&n)-i;return"#"+(16777216+65536*(s<255?s<1?0:s:255)+256*(o<255?o<1?0:o:255)+(a<255?a<1?0:a:255)).toString(16).slice(1)},t.prototype.lightenColor=function(t,e){var n=parseInt(t.replace("#",""),16),i=Math.round(2.55*e),s=(n>>16)+i,o=(n>>8&255)+i,a=(255&n)+i;return"#"+(16777216+65536*(s<255?s<1?0:s:255)+256*(o<255?o<1?0:o:255)+(a<255?a<1?0:a:255)).toString(16).slice(1)},t.prototype.formatDate=function(t){try{for(var e=this.settings.dateFormat,n={"%d":String(t.getDate()).padStart(2,"0"),"%m":String(t.getMonth()+1).padStart(2,"0"),"%Y":String(t.getFullYear()),"%y":String(t.getFullYear()).slice(-2),"%b":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][t.getMonth()],"%B":t.toLocaleDateString("en-US",{month:"long"})},i=e,s=0,o=Object.entries(n);s<o.length;s++){var a=o[s],r=a[0],l=a[1];i=i.replace(new RegExp(r,"g"),l)}return i}catch(e){return t.toLocaleDateString("en-US")}},t.prototype.renderProfessionalStyles=function(){return"\n            <style>\n                .task-row.hovered {\n                    background: #e3f2fd !important;\n                    transform: translateX(2px);\n                    box-shadow: 2px 0 8px rgba(0,0,0,0.1);\n                }\n                \n                .task-bar.hovered {\n                    transform: translateY(-2px);\n                    box-shadow: 0 4px 12px rgba(0,0,0,0.3) !important;\n                    z-index: 20 !important;\n                }\n                \n                .milestone.hovered {\n                    transform: translateY(-2px) rotate(45deg);\n                    box-shadow: 0 4px 12px rgba(0,0,0,0.4) !important;\n                }\n                \n                .gantt-scroll::-webkit-scrollbar,\n                .task-list-scroll::-webkit-scrollbar {\n                    width: 8px;\n                    height: 8px;\n                }\n                \n                .gantt-scroll::-webkit-scrollbar-track,\n                .task-list-scroll::-webkit-scrollbar-track {\n                    background: #f0f0f0;\n                    border-radius: 4px;\n                }\n                \n                .gantt-scroll::-webkit-scrollbar-thumb,\n                .task-list-scroll::-webkit-scrollbar-thumb {\n                    background: linear-gradient(to bottom, #ccc, #999);\n                    border-radius: 4px;\n                }\n                \n                .gantt-scroll::-webkit-scrollbar-thumb:hover,\n                .task-list-scroll::-webkit-scrollbar-thumb:hover {\n                    background: linear-gradient(to bottom, #999, #666);\n                }\n                \n                @keyframes pulse {\n                    0%, 100% { opacity: 1; }\n                    50% { opacity: 0.7; }\n                }\n                \n                @keyframes slideIn {\n                    from { opacity: 0; transform: translateX(-20px); }\n                    to { opacity: 1; transform: translateX(0); }\n                }\n                \n                .task-row {\n                    animation: ".concat(this.settings.showAnimations?"slideIn 0.3s ease forwards":"none",";\n                }\n                \n                .timeline-header {\n                    backdrop-filter: blur(5px);\n                }\n                /* Context menu styles */\n                .task-row, .task-bar {\n                    cursor: context-menu;\n                }\n                \n                .task-row:hover, .task-bar:hover {\n                    background-color: rgba(0,123,255,0.1) !important;\n                }                    \n            </style>\n        ")},t.prototype.addProfessionalFeatures=function(){this.settings.showAnimations&&this.target.querySelectorAll(".task-row").forEach(function(t,e){t.style.animationDelay="".concat(.05*e,"s")}),this.target.addEventListener("keydown",function(t){"ArrowUp"!==t.key&&"ArrowDown"!==t.key||t.preventDefault()}),this.target.addEventListener("contextmenu",function(t){t.preventDefault()})},t.prototype.renderSignature=function(){return'\n            <div style="\n                position: absolute; bottom: 8px; right: 8px; \n                font-size: '.concat(this.settings.signatureSize,'px; color: #666; \n                background: rgba(255,255,255,0.95); \n                padding: 6px 12px; border-radius: 6px;\n                z-index: 1000; font-weight: 500;\n                box-shadow: 0 2px 8px rgba(0,0,0,0.15);\n                border: 1px solid #e0e0e0;\n                backdrop-filter: blur(5px);\n            ">\n                <div style="display: flex; align-items: center; gap: 6px;">\n                    <span style="font-size: 14px;">‚ö°</span>\n                    <span>Developed by Abdalla Dabes, P.E, PSP, PMP</span>\n                </div>\n            </div>\n        ')},t.prototype.showNoData=function(){this.target.innerHTML='\n            <div style="\n                width: 100%; height: 100%; display: flex; align-items: center; justify-content: center;\n                font-family: \'Segoe UI\', Arial, sans-serif; \n                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n                color: white; font-size: 16px; border-radius: 8px; position: relative; overflow: hidden;\n            ">\n                <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.1);"></div>\n                <div style="text-align: center; padding: 40px; z-index: 1;">\n                    <div style="font-size: 64px; margin-bottom: 24px; animation: bounce 2s infinite;">üìä</div>\n                    <div style="font-weight: 600; margin-bottom: 16px; font-size: 24px;">Professional Gantt Chart</div>\n                    <div style="font-size: 16px; opacity: 0.9; margin-bottom: 24px;">Ready for Your Project Data</div>\n                    <div style="font-size: 14px; opacity: 0.8; line-height: 1.6; max-width: 400px;">\n                        Please add data to the following fields:<br><br>\n                        <strong>üìã Task Names</strong> (Multiple levels supported)<br>\n                        <strong>üìÖ Start Date</strong> (set to "Don\'t Summarize")<br>\n                        <strong>üìÖ Finish Date</strong> (set to "Don\'t Summarize")<br>\n                        <strong>üìä Progress</strong> (optional)<br>\n                        <strong>üìç Data Date</strong> (optional)<br>\n                        <strong>üìÖ Baseline Start Date</strong> (optional)<br>\n                        <strong>üìÖ Baseline Finish Date</strong> (optional)<br>\n                        <strong>üìä Planned Progress</strong> (optional)\n                    </div>\n                </div>\n                <style>\n                    @keyframes bounce {\n                        0%, 20%, 50%, 80%, 100% { transform: translateY(0); }\n                        40% { transform: translateY(-20px); }\n                        60% { transform: translateY(-10px); }\n                    }\n                </style>\n            </div>\n        '},t.prototype.showError=function(t){this.target.innerHTML='\n            <div style="\n                width: 100%; height: 100%; display: flex; align-items: center; justify-content: center;\n                font-family: \'Segoe UI\', Arial, sans-serif; \n                background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%);\n                color: white; font-size: 16px; border-radius: 8px; position: relative; overflow: hidden;\n            ">\n                <div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.1);"></div>\n                <div style="text-align: center; padding: 40px; z-index: 1;">\n                    <div style="font-size: 64px; margin-bottom: 24px;">‚ö†Ô∏è</div>\n                    <div style="font-weight: 600; margin-bottom: 16px; font-size: 24px;">System Error</div>\n                    <div style="font-size: 14px; line-height: 1.5; background: rgba(255,255,255,0.1); padding: 16px; border-radius: 6px;">\n                        '.concat(t,"\n                    </div>\n                </div>\n            </div>\n        ")},t.prototype.applyExpandedStateToTasks=function(t){var e=this,n=function(t){t.fullPath&&e.viewState.expandedNodes.has(t.fullPath)&&(t.isExpanded=!0),t.children&&t.children.length>0&&t.children.forEach(n)};t.forEach(n)},t.prototype.enumerateObjectInstances=function(t){var e=[];switch(t.objectName){case"timeline":e.push({objectName:"timeline",properties:{dateFormat:this.settings.dateFormat,showDataDate:this.settings.showDataDate,showYears:this.settings.showYears,showMonths:this.settings.showMonths,showWeeks:this.settings.showWeeks,showDays:this.settings.showDays,timelineAutoSize:this.settings.timelineAutoSize,fitToSize:this.settings.fitToSize,dataDateLineColor:{solid:{color:this.settings.dataDateLineColor}},dataDateLineWidth:this.settings.dataDateLineWidth,dataDateLabelOffset:this.settings.dataDateLabelOffset},selector:null});break;case"professional":e.push({objectName:"professional",properties:{showToday:this.settings.showToday,todayLineColor:{solid:{color:this.settings.todayLineColor}},todayLineWidth:this.settings.todayLineWidth,showHoverEffects:this.settings.showHoverEffects,showAnimations:this.settings.showAnimations,gridLineColor:{solid:{color:this.settings.gridLineColor}},showGridLines:this.settings.showGridLines,compactMode:this.settings.compactMode,showSummaryBars:this.settings.showSummaryBars,p6Format:this.settings.p6Format},selector:null});break;case"baseline":e.push({objectName:"baseline",properties:{showBaseline:this.settings.showBaseline,baselineColor:{solid:{color:this.settings.baselineColor}},baselineHeight:this.settings.baselineHeight,showPlannedProgress:this.settings.showPlannedProgress,plannedProgressColor:{solid:{color:this.settings.plannedProgressColor}}},selector:null});break;case"colors":e.push({objectName:"colors",properties:{level0Color:{solid:{color:this.settings.level0Color}},level1Color:{solid:{color:this.settings.level1Color}},level2Color:{solid:{color:this.settings.level2Color}},level3Color:{solid:{color:this.settings.level3Color}},level4Color:{solid:{color:this.settings.level4Color}},level5Color:{solid:{color:this.settings.level5Color}},level6Color:{solid:{color:this.settings.level6Color}},level7Color:{solid:{color:this.settings.level7Color}},level8Color:{solid:{color:this.settings.level8Color}},level9Color:{solid:{color:this.settings.level9Color}},progressColor:{solid:{color:this.settings.progressColor}}},selector:null});break;case"headerColors":e.push({objectName:"headerColors",properties:{taskHeaderColor:{solid:{color:this.settings.taskHeaderColor}},ganttHeaderColor:{solid:{color:this.settings.ganttHeaderColor}}},selector:null});break;case"headerSettings":e.push({objectName:"headerSettings",properties:{headerHeight:this.settings.headerHeight,headerText:this.settings.headerText,ganttHeaderText:this.settings.ganttHeaderText,taskDetailsText:this.settings.taskDetailsText},selector:null});break;case"gantt":e.push({objectName:"gantt",properties:{showProgress:this.settings.showProgress,barHeight:this.settings.barHeight,milestoneSize:this.settings.milestoneSize},selector:null});break;case"formatting":e.push({objectName:"formatting",properties:{columnFontFamily:this.settings.columnFontFamily,showBarText:this.settings.showBarText,barTextSize:this.settings.barTextSize,barTextFont:this.settings.barTextFont,showSignature:this.settings.showSignature,signatureSize:this.settings.signatureSize,showStartDate:this.settings.showStartDate,showFinishDate:this.settings.showFinishDate,showProgressColumn:this.settings.showProgressColumn,showPlannedProgressColumn:this.settings.showPlannedProgressColumn,showLevelText:this.settings.showLevelText,showTaskCount:this.settings.showTaskCount,showHeaderTaskCount:this.settings.showHeaderTaskCount,columnWidth:this.settings.columnWidth,showLevelIndicators:this.settings.showLevelIndicators,showBaselineStartDate:this.settings.showBaselineStartDate,showBaselineFinishDate:this.settings.showBaselineFinishDate,showVariance:this.settings.showVariance,positiveVarianceColor:{solid:{color:this.settings.positiveVarianceColor}},negativeVarianceColor:{solid:{color:this.settings.negativeVarianceColor}},taskNameSize:this.settings.taskNameSize,startDateSize:this.settings.startDateSize,finishDateSize:this.settings.finishDateSize,baselineStartSize:this.settings.baselineStartSize,baselineFinishSize:this.settings.baselineFinishSize,varianceSize:this.settings.varianceSize,actualProgressSize:this.settings.actualProgressSize,plannedProgressSize:this.settings.plannedProgressSize},selector:null});break;case"general":e.push({objectName:"general",properties:{expandedNodes:JSON.stringify(Array.from(this.viewState.expandedNodes))},selector:null})}return e},t}();e.Visual=i},916:(t,e,n)=>{n.r(e)}},e={};function n(i){var s=e[i];if(void 0!==s)return s.exports;var o=e[i]={exports:{}};return t[i](o,o.exports,n),o.exports}n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var i={};(()=>{var t=i;Object.defineProperty(t,"__esModule",{value:!0});var e=n(848),s=window.powerbi,o={name:"p6GanttChartVisual23D4F5A6B7C8D9E0F1A2B3C4D5E6F7A8",displayName:"P6-Gantt Chart Visual",class:"Visual",apiVersion:"5.11.0",create:function(t){if(e.Visual)return new e.Visual(t);throw"Visual instance not found"},createModalDialog:function(t,e,n){var i=globalThis.dialogRegistry;t in i&&new i[t](e,n)},custom:!0};void 0!==s&&(s.visuals=s.visuals||{},s.visuals.plugins=s.visuals.plugins||{},s.visuals.plugins.p6GanttChartVisual23D4F5A6B7C8D9E0F1A2B3C4D5E6F7A8=o),t.default=o})(),p6GanttChartVisual23D4F5A6B7C8D9E0F1A2B3C4D5E6F7A8=i})();