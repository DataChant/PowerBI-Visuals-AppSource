var vpservice_store;(()=>{var t={1991:t=>{t.exports={dataRoles:[{displayName:"Values",name:"measure",kind:"Measure"}],dataViewMappings:[{categorical:{values:{select:[{bind:{to:"measure"}}]}}}],privileges:[{name:"AADAuthentication",parameters:{COM:"https://poweronbi.com/"}},{name:"WebAccess",essential:!0,parameters:["http://*","https://*"]}],suppressDefaultTitle:!0,objects:{DataEntry:{displayName:"Service",properties:{WebServiceInternal:{displayName:"Service Address",type:{text:!0}},initialRefresh:{displayName:"Initial Refresh",type:{bool:!0}},initDelay:{displayName:"Init Delay",type:{numeric:!0}},useAAD:{displayName:"Use SSO",type:{bool:!0}}}}},supportsLandingPage:!0,supportsEmptyDataView:!0}},1888:(t,e,n)=>{"use strict";function r(t,e,n){if(!t)return n;const r=t[e];return void 0===r?n:r}n.d(e,{_:()=>r})},6271:(t,e,n)=>{"use strict";n.d(e,{Bl:()=>i});var r=n(1888);function i(t,e,n){const i=function(t,e,n){return t?r._(t[e.objectName],e.propertyName,n):n}(t,e,n);return i&&i.solid?i.solid.color:null==i||"object"==typeof i&&!i.solid?n:i}},3116:(t,e,n)=>{"use strict";n.d(e,{P:()=>i});var r=n(6271);class i{static getDefault(){return new this}static createPropertyIdentifier(t,e){return{objectName:t,propertyName:e}}static parse(t){const e=this.getDefault();if(!t||!t.metadata||!t.metadata.objects)return e;const n=e.getProperties();for(const i in n)for(const s in n[i]){const o=e[i][s];e[i][s]=r.Bl(t.metadata.objects,n[i][s],o)}return e}static isPropertyEnumerable(t){return!i.InnumerablePropertyPrefix.test(t)}static enumerateObjectInstances(t,e){const n=t&&t[e.objectName];if(!n)return[];const r={objectName:e.objectName,selector:null,properties:{}};for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&(r.properties[t]=n[t]);return{instances:[r]}}getProperties(){const t={};return Object.keys(this).forEach((e=>{if(i.isPropertyEnumerable(e)){const n=Object.keys(this[e]);t[e]={},n.forEach((n=>{i.isPropertyEnumerable(e)&&(t[e][n]=i.createPropertyIdentifier(e,n))}))}})),t}}i.InnumerablePropertyPrefix=/^_/},9754:(t,e,n)=>{"use strict";n.d(e,{Kx:()=>o,PA:()=>d,St:()=>a,Tn:()=>c,iB:()=>h,jF:()=>l,ks:()=>p});var r=n(8639);class i{}class s extends i{}class o{}class a extends i{}class c extends s{}class u extends i{constructor(t){super(),Object.assign(this,t)}getFormattingSlice(t,e){const n=this.type,r=this.name,i={displayName:e&&this.displayNameKey?e.getDisplayName(this.displayNameKey):this.displayName,description:e&&this.descriptionKey?e.getDisplayName(this.descriptionKey):this.description,uid:t+"-"+r};return Object.assign(Object.assign({},i),{control:{type:n,properties:this.getFormattingComponent(t,e)}})}getFormattingComponent(t,e){return{descriptor:r.y(t,this),value:this.value}}getRevertToDefaultDescriptor(t){return[{objectName:t,propertyName:this.name}]}setPropertiesValues(t,e){var n;const i=null===(n=null==t?void 0:t[e])||void 0===n?void 0:n[this.name];this.value=r.D(this,i,this.value)}}class l extends u{constructor(t){super(t),this.type="ToggleSwitch"}}class h extends u{constructor(t){super(t),this.type="NumUpDown"}getFormattingComponent(t){return Object.assign(Object.assign({},super.getFormattingComponent(t)),{options:this.options})}}class d extends u{constructor(t){super(t),this.type="Dropdown"}getFormattingComponent(t){return Object.assign(Object.assign({},super.getFormattingComponent(t)),{items:this.items})}}class p extends u{constructor(t){super(t),this.type="TextInput"}getFormattingComponent(t){return Object.assign(Object.assign({},super.getFormattingComponent(t)),{placeholder:this.placeholder})}}},6667:(t,e,n)=>{"use strict";n.d(e,{A:()=>i});var r=n(9754);const i=class{constructor(t){this.localizationManager=t}populateFormattingSettingsModel(t,e){var n,i;const s=new t,o=null===(n=null==e?void 0:e.metadata)||void 0===n?void 0:n.objects;return o&&(null===(i=s.cards)||void 0===i||i.forEach((t=>{var e;t instanceof r.St&&(null===(e=t.topLevelSlice)||void 0===e||e.setPropertiesValues(o,t.name)),(t instanceof r.Tn?[t]:t.groups).forEach((e=>{var n,r,i,s;null===(n=e.topLevelSlice)||void 0===n||n.setPropertiesValues(o,t.name),null===(r=null==e?void 0:e.slices)||void 0===r||r.forEach((e=>{null==e||e.setPropertiesValues(o,t.name)})),null===(s=null===(i=null==e?void 0:e.container)||void 0===i?void 0:i.containerItems)||void 0===s||s.forEach((e=>{var n;null===(n=null==e?void 0:e.slices)||void 0===n||n.forEach((e=>{null==e||e.setPropertiesValues(o,t.name)}))}))}))}))),s}buildFormattingModel(t){const e={cards:[]};return t.cards.filter((({visible:t=!0})=>t)).forEach((t=>{var n;const i={displayName:this.localizationManager&&t.displayNameKey?this.localizationManager.getDisplayName(t.displayNameKey):t.displayName,description:this.localizationManager&&t.descriptionKey?this.localizationManager.getDisplayName(t.descriptionKey):t.description,groups:[],uid:t.name+"-card",analyticsPane:t.analyticsPane},s=t.name;if(t.topLevelSlice){const e=t.topLevelSlice.getFormattingSlice(s,this.localizationManager);e.suppressDisplayName=!0,i.topLevelToggle=e}null===(n=t.onPreProcess)||void 0===n||n.call(t);const o=t instanceof r.Tn;(o?[t].filter((({visible:t=!0})=>t)):t.groups.filter((({visible:t=!0})=>t))).forEach((t=>{const e=t.name+"-group",n={displayName:o?void 0:this.localizationManager&&t.displayNameKey?this.localizationManager.getDisplayName(t.displayNameKey):t.displayName,description:o?void 0:this.localizationManager&&t.descriptionKey?this.localizationManager.getDisplayName(t.descriptionKey):t.description,slices:[],uid:e,collapsible:t.collapsible,delaySaveSlices:t.delaySaveSlices,disabled:t.disabled,disabledReason:t.disabledReason};i.groups.push(n);const r={};if(t.container){const i=t.container,o=e+"-container",a={displayName:this.localizationManager&&i.displayNameKey?this.localizationManager.getDisplayName(i.displayNameKey):i.displayName,description:this.localizationManager&&i.descriptionKey?this.localizationManager.getDisplayName(i.descriptionKey):i.description,containerItems:[],uid:o};i.containerItems.forEach((t=>{const e=t.displayNameKey?t.displayNameKey:t.displayName,n=o+e,i={displayName:this.localizationManager&&t.displayNameKey?this.localizationManager.getDisplayName(t.displayNameKey):t.displayName,slices:[],uid:n};this.buildFormattingSlices({slices:t.slices,objectName:s,sliceNames:r,formattingSlices:i.slices}),a.containerItems.push(i)})),n.container=a}if(t.slices){if(t.topLevelSlice){const e=t.topLevelSlice.getFormattingSlice(s,this.localizationManager);e.suppressDisplayName=!0,(null==n.displayName?i:n).topLevelToggle=e}this.buildFormattingSlices({slices:t.slices,objectName:s,sliceNames:r,formattingSlices:n.slices})}})),i.revertToDefaultDescriptors=this.getRevertToDefaultDescriptor(t),e.cards.push(i)})),e}buildFormattingSlices({slices:t,objectName:e,sliceNames:n,formattingSlices:r}){null==t||t.filter((({visible:t=!0})=>t)).forEach((t=>{const i=null==t?void 0:t.getFormattingSlice(e,this.localizationManager);i&&(void 0===n[t.name]?n[t.name]=0:(n[t.name]++,i.uid=`${i.uid}-${n[t.name]}`),r.push(i))}))}getRevertToDefaultDescriptor(t){var e;const n={},i=[];let s,o=[];return t instanceof r.St&&t.topLevelSlice&&i.push(...null===(e=t.topLevelSlice)||void 0===e?void 0:e.getRevertToDefaultDescriptor(t.name)),(t instanceof r.Tn?[t].filter((({visible:t=!0})=>t)):t.groups.filter((({visible:t=!0})=>t))).forEach((e=>{var r,a;s=this.getSlicesRevertToDefaultDescriptor(t.name,e.slices,n,e.topLevelSlice),null===(a=null===(r=e.container)||void 0===r?void 0:r.containerItems)||void 0===a||a.forEach((e=>{o=o.concat(this.getSlicesRevertToDefaultDescriptor(t.name,e.slices,n))})),i.push(...s.concat(o))})),i}getSlicesRevertToDefaultDescriptor(t,e,n,r){let i=[];return r&&(n[r.name]=!0,i=i.concat(r.getRevertToDefaultDescriptor(t))),null==e||e.forEach((e=>{e&&!n[e.name]&&(n[e.name]=!0,i=i.concat(e.getRevertToDefaultDescriptor(t)))})),i}}},7674:(t,e,n)=>{"use strict";n.d(e,{O:()=>i.A,z:()=>r});var r=n(9754),i=n(6667)},8639:(t,e,n)=>{"use strict";function r(t,e){return{objectName:t,propertyName:e.name,selector:e.selector,altConstantValueSelector:e.altConstantSelector,instanceKind:e.instanceKind}}function i(t,e,n){return null==e||"object"==typeof e&&!e.solid?n:e.solid?{value:null==e?void 0:e.solid.color}:(null==t?void 0:t.items)?t.items.find((t=>t.value==e)):e}n.d(e,{D:()=>i,y:()=>r})},7452:t=>{var e=function(t){"use strict";var e,n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},s="function"==typeof Symbol?Symbol:{},o=s.iterator||"@@iterator",a=s.asyncIterator||"@@asyncIterator",c=s.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var s=e&&e.prototype instanceof v?e:v,o=Object.create(s.prototype),a=new R(r||[]);return i(o,"_invoke",{value:D(t,n,a)}),o}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var d="suspendedStart",p="suspendedYield",f="executing",g="completed",m={};function v(){}function y(){}function A(){}var w={};u(w,o,(function(){return this}));var N=Object.getPrototypeOf,S=N&&N(N(V([])));S&&S!==n&&r.call(S,o)&&(w=S);var b=A.prototype=v.prototype=Object.create(w);function _(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function n(i,s,o,a){var c=h(t[i],t,s);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==typeof l&&r.call(l,"__await")?e.resolve(l.__await).then((function(t){n("next",t,o,a)}),(function(t){n("throw",t,o,a)})):e.resolve(l).then((function(t){u.value=t,o(u)}),(function(t){return n("throw",t,o,a)}))}a(c.arg)}var s;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return s=s?s.then(i,i):i()}})}function D(t,n,r){var i=d;return function(s,o){if(i===f)throw new Error("Generator is already running");if(i===g){if("throw"===s)throw o;return{value:e,done:!0}}for(r.method=s,r.arg=o;;){var a=r.delegate;if(a){var c=x(a,r);if(c){if(c===m)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===d)throw i=g,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=f;var u=h(t,n,r);if("normal"===u.type){if(i=r.done?g:p,u.arg===m)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(i=g,r.method="throw",r.arg=u.arg)}}}function x(t,n){var r=n.method,i=t.iterator[r];if(i===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,x(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),m;var s=h(i,t.iterator,n.arg);if("throw"===s.type)return n.method="throw",n.arg=s.arg,n.delegate=null,m;var o=s.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,m):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function R(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function V(t){if(null!=t){var n=t[o];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,s=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return s.next=s}}throw new TypeError(typeof t+" is not iterable")}return y.prototype=A,i(b,"constructor",{value:A,configurable:!0}),i(A,"constructor",{value:y,configurable:!0}),y.displayName=u(A,c,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,A):(t.__proto__=A,u(t,c,"GeneratorFunction")),t.prototype=Object.create(b),t},t.awrap=function(t){return{__await:t}},_(E.prototype),u(E.prototype,a,(function(){return this})),t.AsyncIterator=E,t.async=function(e,n,r,i,s){void 0===s&&(s=Promise);var o=new E(l(e,n,r,i),s);return t.isGeneratorFunction(n)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},_(b),u(b,c,"Generator"),u(b,o,(function(){return this})),u(b,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},t.values=V,R.prototype={constructor:R,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(k),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return a.type="throw",a.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var s=this.tryEntries.length-1;s>=0;--s){var o=this.tryEntries[s],a=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var c=r.call(o,"catchLoc"),u=r.call(o,"finallyLoc");if(c&&u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=t,o.arg=e,s?(this.method="next",this.next=s.finallyLoc,m):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),k(n),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;k(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:V(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),m}},t}(t.exports);try{regeneratorRuntime=e}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}},9727:(t,e,n)=>{"use strict";n.d(e,{p:()=>o});var r=n(7674),i=n(1991);class s extends r.z.Tn{constructor(t,e,n){super(),this.name=t,this.displayName=e,this.slices=n,this.analyticsPane=!1,this.slices=n}}class o{constructor(){this.formattingSettingsService=new r.O,this.formattingSettingsModel=new r.z.Kx,this.formattingSettingsModel.cards=[]}getFormattingModel(){return this.formattingSettingsService.buildFormattingModel(this.formattingSettingsModel)}populate(t){this.formattingSettingsModel=new r.z.Kx,this.formattingSettingsModel.cards=this.createCards(t)}createCards(t){return[this.createDataEntryCard(t)]}createDataEntryCard(t){const e=[];for(const n in i.objects.DataEntry.properties){const r=n;let i;"WebServiceInternal"===r&&(i=3),e.push(this.createPropertySlice("DataEntry",r,t.DataEntry[r],void 0,i))}return this.createSimpleCard("DataEntry",e)}createSimpleCard(t,e){return new s(t,i.objects[t].displayName,e)}createPropertySlice(t,e,n,s,o){const a=i.objects[t].properties[e],c=void 0===s?void 0:{metadata:s};return a.type.numeric?new r.z.iB({name:e,displayName:a.displayName,value:null!=n?n:0,selector:c}):a.type.bool?new r.z.jF({name:e,displayName:a.displayName,value:null!=n&&n,selector:c}):a.type.enumeration?new r.z.PA({name:e,displayName:a.displayName,value:a.type.enumeration.find((t=>t.value===n)),items:a.type.enumeration,selector:c}):new r.z.ks({name:e,displayName:a.displayName,value:String(n),placeholder:"",selector:c,instanceKind:o})}}},980:(t,e,n)=>{"use strict";n.d(e,{Mb:()=>i});var r=n(3116).P;class i extends r{constructor(){super(...arguments),this.DataEntry=new s}}class s{constructor(){this.WebServiceInternal="",this.initialRefresh=!1,this.initDelay=500,this.useAAD=!0}}new i},5789:(t,e,n)=>{"use strict";n.d(e,{b:()=>a});var r=n(183),i=(n(7452),n(980)),s=n(9727),o=function(t,e,n,r){return new(n||(n=Promise))((function(i,s){function o(t){try{c(r.next(t))}catch(t){s(t)}}function a(t){try{c(r.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((r=r.apply(t,e||[])).next())}))};class a{constructor(t){this.enableLogging=!1,this.windowPostMessageSlicers=null,this.isInServiceMode=!1,this.areServiceEventListenersSet=!1,this.url=null,this.isInEditMode=!1,this.authTokenFailed=!1,this.formattingSettings=new s.p,this.authTokenNotified={authStart:!1,authGetTokenNew:!1,authGetTokenOld:!1,authentication:!1,acquireAADTokenNotAllowed:!1,acquireAADTokenWasUnsuccessful:!1},this.getPowerBiAADAccessToken=t=>o(this,void 0,void 0,(function*(){if(this.authTokenNotified.authStart||console.log("Authentication process started."),this.authTokenNotified.authStart=!0,!this.authTokenFailed){if(this.powerBiAADAccessToken&&this.powerBiAADAccessToken.accessToken&&this.powerBiAADAccessToken.expiresOn&&this.powerBiAADAccessToken.expiresOn>Date.now())return{token:this.powerBiAADAccessToken.accessToken,tokenError:null};if(yield this.getAADTokenWithNewMethod(t),this.powerBiAADAccessToken&&this.powerBiAADAccessToken.accessToken)return{token:this.powerBiAADAccessToken.accessToken,tokenError:null}}return{token:null,tokenError:"Failed to acquire AAD token."}})),this.getAADTokenWithNewMethod=t=>o(this,void 0,void 0,(function*(){0===(yield t.acquireAADTokenService.acquireAADTokenstatus())?(this.powerBiAADAccessToken=yield t.acquireAADTokenService.acquireAADToken(),this.powerBiAADAccessToken.accessToken?(this.authTokenNotified.authGetTokenNew||console.log("Getting AADToken token with new method was successful."),this.authTokenNotified.authGetTokenNew=!0):this.authTokenNotified.acquireAADTokenWasUnsuccessful||(console.log("Getting AADToken with new method was unsuccessful."),this.authTokenNotified.acquireAADTokenWasUnsuccessful=!0)):this.authTokenNotified.acquireAADTokenNotAllowed||(console.log("Getting AADToken with new method is not allowed in the current environment."),this.authTokenNotified.acquireAADTokenNotAllowed=!0)})),this.host=t.host,this.target=t.element,this.selectionManager=t.host.createSelectionManager(),this.locale=t.host.locale,this.svg=(0,r.A)(t.element).append("svg").classed("Visual",!0);const e=this.createHelpLinkElement();t.element.appendChild(e),this.helpLinkElement=(0,r.A)(e),this.handleContextMenu(),this.events=t.host.eventService}update(t){this.events.renderingStarted(t),console.log("update"),this.settings=a.parseSettings(t&&t.dataViews&&t.dataViews[0]),this.settings&&this.formattingSettings.populate(this.settings),1==t.viewMode||2==t.viewMode?this.isInEditMode=!0:this.isInEditMode=!1,this.url=this.settings.DataEntry.WebServiceInternal;let e=t.viewport.width,n=t.viewport.height;this.svg.attr("width",e).attr("height",n),this.settings.DataEntry.WebServiceInternal?(this.helpLinkElement.classed("hidden",!0),this.enterServiceMode()):(this.helpLinkElement.classed("hidden",!1),this.isInServiceMode=!1),t&&t.dataViews&&t.dataViews[0]&&t.dataViews[0].metadata&&t.dataViews[0].metadata.columns&&t.dataViews[0].metadata.columns.length>0&&t.dataViews[0].categorical&&t.dataViews[0].categorical.values&&((this.endsWith(t.dataViews[0].metadata.columns[0].queryName,".User")||this.endsWith(t.dataViews[0].metadata.columns[0].queryName,".User)"))&&(this.userID=""+t.dataViews[0].categorical.values[0].values[0]),t.dataViews[0].metadata.columns.length>1&&(this.endsWith(t.dataViews[0].metadata.columns[0].queryName,".UserName")||this.endsWith(t.dataViews[0].metadata.columns[0].queryName,".UserName)"))&&(this.userName=""+t.dataViews[0].categorical.values[1].values[0])),this.events.renderingFinished(t)}static parseSettings(t){return i.Mb.parse(t)}handleContextMenu(){this.svg.on("contextmenu",(t=>{const e=t,n=e.target,i=(0,r.A)(n).datum();this.selectionManager.showContextMenu(i?i.selectionId:{},{x:e.clientX,y:e.clientY}),e.preventDefault()}))}getFormattingModel(){return this.formattingSettings.getFormattingModel()}destroy(){}createHelpLinkElement(){let t=document.createElement("a");return t.textContent="?",t.setAttribute("title","Please set the Service connection in the visuals settings"),t.setAttribute("class","helpLink"),t}isEmptyString(t){return""===t&&0===t.length}hasValue(t){return null!=t&&(this.isEmptyString(t),!0)}extendObject(t,e,n){if(0==e.length)return n;let r=e.shift();return("string"==typeof t||t instanceof String)&&(t=JSON.parse(t)),t[r]||(t[r]={}),t[r]=this.extendObject(t[r],e,n),t}handleVPRequest(t){var e,n,r;let i=this,s=null,o=null,a=null,c=null,u=null,l=!1;if(i.url&&(null===(r=null===(n=null===(e=null==t?void 0:t.data)||void 0===e?void 0:e.internalArgs)||void 0===n?void 0:n.tag)||void 0===r?void 0:r.toLocaleLowerCase())===i.url.toLocaleLowerCase())switch((null==t?void 0:t.data)&&(t.data.internalArgs&&(s=t.data.internalArgs.actionName,o=t.data.internalArgs.actionId,a=t.data.internalArgs.tag),c=t.data.externalArgs,c&&(l=c.debug)),l&&console.warn("SERVER: request object: ",t),s){case"VPRefreshHostData":l&&console.warn("SERVER: VPRefreshHostData request confirmed"),u={success:!0,action:c.action},i.refresh();break;case"VPGetUserInfo":if(l&&console.warn("SERVER: VPGetUserInfo request confirmed"),i.settings.DataEntry.useAAD)i.getPowerBiAADAccessToken(i.host).then((e=>{if(!e.token)return console.error("SERVER: The privilege is not allowed in the current environment."),console.error("SERVER: Token PrivilegeStatus is: ",e.tokenError),void this.handleGetUserInfoNoTenant(o,a,t);i.powerBIAccessToken=e.token;try{let t=i.powerBIAccessToken.split(".")[1].replace("-","+").replace("_","/"),e=JSON.parse(window.atob(t));i.userID=e.upn,i.userName=e.name}catch(t){return void console.error("SERVER: Invalid Authentication Token.")}u={userInfo:{userId:i.userID,userDisplayName:i.userName},success:!0},this.writelog("SERVER: Get User Info"),t.source.postMessage({eventName:"VPResponse",arguments:{actionId:o,tag:a,result:u}},"*")})).catch((t=>console.error("SERVER: Getting Authentication Token failed. Error: ",t)));else{let e=i.userName;e||(e=i.userID),u={userInfo:{userId:i.userID,userDisplayName:e},success:!0},this.writelog("SERVER: Get User Info"),t.source.postMessage({eventName:"VPResponse",arguments:{actionId:o,tag:a,result:u}},"*")}return;case"VPGetSlicers":return l&&console.warn("SERVER: VPGetSlicers request confirmed"),u={slicers:i.Slicers,success:!0},this.writelog("SERVER: Get Slicers"),void t.source.postMessage({eventName:"VPResponse",arguments:{actionId:o,tag:a,result:u}},"*");case"VPAjaxRequest":if(l&&console.warn("SERVER: VPAjaxRequest request confirmed"),i.settings.DataEntry.useAAD)i.getPowerBiAADAccessToken(i.host).then((e=>{if(!e.token)return console.error("SERVER: The privilege is not allowed in the current environment."),console.error("SERVER: Token PrivilegeStatus is: ",e.tokenError),void this.handleAjaxRequestNoTenant(c,l,o,a,t);i.powerBIAccessToken=e.token;try{let t=i.powerBIAccessToken.split(".")[1].replace("-","+").replace("_","/"),e=JSON.parse(window.atob(t));i.userID=e.upn,i.userName=e.name}catch(t){return void console.error("SERVER: Invalid Authentication Token.")}let n=c.baseRequest;if(c.addAuthorizationHeaders&&(i.powerBIAccessToken&&"any"!=i.powerBIAccessToken&&(n.headers?n.headers.Authorization="Bearer "+i.powerBIAccessToken:n.headers={Authorization:"Bearer "+i.powerBIAccessToken}),n.xhrFields&&delete n.xhrFields.withCredentials),i.hasValue(c.userIdAttribute)){let t=c.userIdAttribute.split("."),e=i.userID;n.data||(n.data={}),n.data=i.extendObject(n.data,t,e)}if(i.hasValue(c.userDisplayNameAttribute)){let t=c.userDisplayNameAttribute.split("."),e=i.userName;n.data||(n.data={}),n.data=i.extendObject(n.data,t,e)}l&&console.warn("SERVER: VPAjaxRequest baseRequest: ",n),c.binaryData||(n.data=JSON.stringify(n.data)),n.error=function(e,n,r){401===e.status&&i.authenticationFailed(),t.source.postMessage({eventName:"VPResponse",arguments:{actionId:o,tag:a,result:{success:!1,data:JSON.stringify(r),textStatus:n,xhr:JSON.stringify(e)}}},"*")},n.success=function(e,n,r){i.authTokenNotified.authentication||(i.authTokenNotified.authGetTokenOld?console.log("Authentication was successful with unsupported method."):console.log("Authentication was successful with new method.")),i.authTokenNotified.authentication=!0,t.source.postMessage({eventName:"VPResponse",arguments:{actionId:o,tag:a,result:{success:!0,data:e,textStatus:n,xhr:JSON.stringify(r)}}},"*")},$.ajax(n)})).catch((t=>console.error("SERVER: Getting Authentication Token failed. Error: ",t)));else{let e=c.baseRequest;if(i.hasValue(c.userIdAttribute)){let t=c.userIdAttribute.split("."),n=i.userID;e.data||(e.data={}),e.data=i.extendObject(e.data,t,n)}let n=i.userName;if(n||(n=i.userID),i.hasValue(c.userDisplayNameAttribute)){let t=c.userDisplayNameAttribute.split("."),r=n;e.data||(e.data={}),e.data=i.extendObject(e.data,t,r)}l&&console.warn("SERVER: VPAjaxRequest baseRequest: ",e),c.binaryData||(e.data=JSON.stringify(e.data)),e.error=function(e,n,r){t.source.postMessage({eventName:"VPResponse",arguments:{actionId:o,tag:a,result:{success:!1,data:JSON.stringify(r),textStatus:n,xhr:JSON.stringify(e)}}},"*")},e.success=function(e,n,r){t.source.postMessage({eventName:"VPResponse",arguments:{actionId:o,tag:a,result:{success:!0,data:e,textStatus:n,xhr:JSON.stringify(r)}}},"*")},$.ajax(e)}return;default:return void(l&&console.error("SERVER: Unsupported request: "+s))}}get Slicers(){return this.windowPostMessageSlicers}isEmptyObject(t){let e=0===Object.keys(t).length,n=(t.constructor,t.constructor&&"function"==typeof t.constructor);return e&&n}addToBroadcastArgument(t,e){this.broadcastArguments[t]=e}broadcast(){let t=this.isInEditMode,e=this,n=Object.assign({isInEditMode:t,isStoreVersion:!0},this.broadcastArguments);for(let t=0;t<100;t++)try{window.parent.frames[t].postMessage({eventName:"VPInit",arguments:n},"*")}catch(t){}this.broadcastArguments={};let r=500;try{r=this.settings.DataEntry.initDelay}catch(t){}setTimeout((function(){e.broadcast()}),r)}enterServiceMode(){if(this.isInServiceMode)return;let t=this;this.writelog("SERVER: Enable Service Mode"),console.warn("SERVER: Entering Service Mode"),this.isInServiceMode=!0,this.setEventListener_serviceMode(),this.broadcast(),t.settings.DataEntry.initialRefresh&&setTimeout((function(){console.log("init refresh"),t.refresh()}),1e3)}writelog(t){this.enableLogging&&console.log(t)}refresh(){this.writelog("SERVER: Refresh"),this.host.refreshHostData()}setEventListener_serviceMode(){let t=this;this.areServiceEventListenersSet||(this.areServiceEventListenersSet=!0,window.addEventListener("message",(function(e){if(e.data&&"SetSlicers"==e.data.eventName&&e.data&&e.data.arguments){t.windowPostMessageSlicers||(t.windowPostMessageSlicers={});let n=e.data.arguments;for(let e in n)n.hasOwnProperty(e)&&(t.windowPostMessageSlicers[e]=n[e]);console.warn("SERVER: Received Slicers",t.windowPostMessageSlicers)}t.handleVPRequest(e)})))}endsWith(t,e){return-1!==t.indexOf(e,t.length-e.length)}authenticationFailed(){this.authTokenFailed||(console.log("Authentication failed with new method."),this.authTokenFailed=!0)}handleGetUserInfoNoTenant(t,e,n){n.source.postMessage({eventName:"VPResponse",arguments:{actionId:t,tag:e,result:{userInfo:{userId:"nouser",userDisplayName:"nouser"},success:!0}}},"*")}handleAjaxRequestNoTenant(t,e,n,r,i){this.userID="nouser",this.userName="nouser";let s=t.baseRequest;if(this.hasValue(t.userIdAttribute)){let e=t.userIdAttribute.split("."),n=this.userID;s.data||(s.data={}),s.data=this.extendObject(s.data,e,n)}if(this.hasValue(t.userDisplayNameAttribute)){let e=t.userDisplayNameAttribute.split("."),n=this.userName;s.data||(s.data={}),s.data=this.extendObject(s.data,e,n)}e&&console.warn("SERVER: VPAjaxRequest baseRequest: ",s),t.binaryData||(s.data=JSON.stringify(s.data)),s.error=(t,e,s)=>{401===t.status&&this.authenticationFailed(),i.source.postMessage({eventName:"VPResponse",arguments:{actionId:n,tag:r,result:{success:!1,data:JSON.stringify(s),textStatus:e,xhr:JSON.stringify(t)}}},"*")},s.success=(t,e,s)=>{this.authTokenNotified.authentication||(this.authTokenNotified.authGetTokenOld?console.log("Authentication was successful with unsupported method."):console.log("Authentication was successful with new method.")),this.authTokenNotified.authentication=!0,i.source.postMessage({eventName:"VPResponse",arguments:{actionId:n,tag:r,result:{success:!0,data:t,textStatus:e,xhr:JSON.stringify(s)}}},"*")},$.ajax(s)}}},5478:(t,e,n)=>{"use strict";function r(t){return null==t?[]:Array.isArray(t)?t:Array.from(t)}n.d(e,{A:()=>r})},9731:(t,e,n)=>{"use strict";function r(t){return function(){return t}}n.d(e,{A:()=>r})},3663:(t,e,n)=>{"use strict";n.d(e,{A:()=>a});var r=n(7268),i=n(7947);function s(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===i.g&&e.documentElement.namespaceURI===i.g?e.createElement(t):e.createElementNS(n,t)}}function o(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function a(t){var e=(0,r.A)(t);return(e.local?o:s)(e)}},6541:(t,e,n)=>{"use strict";function r(t){return function(){return this.matches(t)}}function i(t){return function(e){return e.matches(t)}}n.d(e,{A:()=>r,j:()=>i})},7268:(t,e,n)=>{"use strict";n.d(e,{A:()=>i});var r=n(7947);function i(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),r.A.hasOwnProperty(e)?{space:r.A[e],local:t}:t}},7947:(t,e,n)=>{"use strict";n.d(e,{A:()=>i,g:()=>r});var r="http://www.w3.org/1999/xhtml";const i={svg:"http://www.w3.org/2000/svg",xhtml:r,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"}},183:(t,e,n)=>{"use strict";n.d(e,{A:()=>i});var r=n(1882);function i(t){return"string"==typeof t?new r.LN([[document.querySelector(t)]],[document.documentElement]):new r.LN([[t]],r.zr)}},8072:(t,e,n)=>{"use strict";n.d(e,{A:()=>i});var r=n(3663);function i(t){var e="function"==typeof t?t:(0,r.A)(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))}},7339:(t,e,n)=>{"use strict";n.d(e,{A:()=>l});var r=n(7268);function i(t){return function(){this.removeAttribute(t)}}function s(t){return function(){this.removeAttributeNS(t.space,t.local)}}function o(t,e){return function(){this.setAttribute(t,e)}}function a(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function c(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function u(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function l(t,e){var n=(0,r.A)(t);if(arguments.length<2){var l=this.node();return n.local?l.getAttributeNS(n.space,n.local):l.getAttribute(n)}return this.each((null==e?n.local?s:i:"function"==typeof e?n.local?u:c:n.local?a:o)(n,e))}},5152:(t,e,n)=>{"use strict";function r(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}n.d(e,{A:()=>r})},8235:(t,e,n)=>{"use strict";function r(t){return t.trim().split(/^|\s+/)}function i(t){return t.classList||new s(t)}function s(t){this._node=t,this._names=r(t.getAttribute("class")||"")}function o(t,e){for(var n=i(t),r=-1,s=e.length;++r<s;)n.add(e[r])}function a(t,e){for(var n=i(t),r=-1,s=e.length;++r<s;)n.remove(e[r])}function c(t){return function(){o(this,t)}}function u(t){return function(){a(this,t)}}function l(t,e){return function(){(e.apply(this,arguments)?o:a)(this,t)}}function h(t,e){var n=r(t+"");if(arguments.length<2){for(var s=i(this.node()),o=-1,a=n.length;++o<a;)if(!s.contains(n[o]))return!1;return!0}return this.each(("function"==typeof e?l:e?c:u)(n,e))}n.d(e,{A:()=>h}),s.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}}},9063:(t,e,n)=>{"use strict";function r(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function i(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function s(t){return this.select(t?i:r)}n.d(e,{A:()=>s})},8664:(t,e,n)=>{"use strict";n.d(e,{A:()=>u});var r=n(1882),i=n(4916),s=n(9731);function o(t,e,n,r,s,o){for(var a,c=0,u=e.length,l=o.length;c<l;++c)(a=e[c])?(a.__data__=o[c],r[c]=a):n[c]=new i.L(t,o[c]);for(;c<u;++c)(a=e[c])&&(s[c]=a)}function a(t,e,n,r,s,o,a){var c,u,l,h=new Map,d=e.length,p=o.length,f=new Array(d);for(c=0;c<d;++c)(u=e[c])&&(f[c]=l=a.call(u,u.__data__,c,e)+"",h.has(l)?s[c]=u:h.set(l,u));for(c=0;c<p;++c)l=a.call(t,o[c],c,o)+"",(u=h.get(l))?(r[c]=u,u.__data__=o[c],h.delete(l)):n[c]=new i.L(t,o[c]);for(c=0;c<d;++c)(u=e[c])&&h.get(f[c])===u&&(s[c]=u)}function c(t){return t.__data__}function u(t,e){if(!arguments.length)return Array.from(this,c);var n=e?a:o,i=this._parents,u=this._groups;"function"!=typeof t&&(t=(0,s.A)(t));for(var h=u.length,d=new Array(h),p=new Array(h),f=new Array(h),g=0;g<h;++g){var m=i[g],v=u[g],y=v.length,A=l(t.call(m,m&&m.__data__,g,i)),w=A.length,N=p[g]=new Array(w),S=d[g]=new Array(w);n(m,v,N,S,f[g]=new Array(y),A,e);for(var b,_,E=0,D=0;E<w;++E)if(b=N[E]){for(E>=D&&(D=E+1);!(_=S[D])&&++D<w;);b._next=_||null}}return(d=new r.LN(d,i))._enter=p,d._exit=f,d}function l(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}},9433:(t,e,n)=>{"use strict";function r(t){return arguments.length?this.property("__data__",t):this.node().__data__}n.d(e,{A:()=>r})},202:(t,e,n)=>{"use strict";n.d(e,{A:()=>a});var r=n(6747);function i(t,e,n){var i=(0,r.A)(t),s=i.CustomEvent;"function"==typeof s?s=new s(e,n):(s=i.document.createEvent("Event"),n?(s.initEvent(e,n.bubbles,n.cancelable),s.detail=n.detail):s.initEvent(e,!1,!1)),t.dispatchEvent(s)}function s(t,e){return function(){return i(this,t,e)}}function o(t,e){return function(){return i(this,t,e.apply(this,arguments))}}function a(t,e){return this.each(("function"==typeof e?o:s)(t,e))}},2901:(t,e,n)=>{"use strict";function r(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i,s=e[n],o=0,a=s.length;o<a;++o)(i=s[o])&&t.call(i,i.__data__,o,s);return this}n.d(e,{A:()=>r})},807:(t,e,n)=>{"use strict";function r(){return!this.node()}n.d(e,{A:()=>r})},4916:(t,e,n)=>{"use strict";n.d(e,{A:()=>s,L:()=>o});var r=n(6732),i=n(1882);function s(){return new i.LN(this._enter||this._groups.map(r.A),this._parents)}function o(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}o.prototype={constructor:o,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}}},2672:(t,e,n)=>{"use strict";n.d(e,{A:()=>s});var r=n(6732),i=n(1882);function s(){return new i.LN(this._exit||this._groups.map(r.A),this._parents)}},9734:(t,e,n)=>{"use strict";n.d(e,{A:()=>s});var r=n(1882),i=n(6541);function s(t){"function"!=typeof t&&(t=(0,i.A)(t));for(var e=this._groups,n=e.length,s=new Array(n),o=0;o<n;++o)for(var a,c=e[o],u=c.length,l=s[o]=[],h=0;h<u;++h)(a=c[h])&&t.call(a,a.__data__,h,c)&&l.push(a);return new r.LN(s,this._parents)}},697:(t,e,n)=>{"use strict";function r(){this.innerHTML=""}function i(t){return function(){this.innerHTML=t}}function s(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function o(t){return arguments.length?this.each(null==t?r:("function"==typeof t?s:i)(t)):this.node().innerHTML}n.d(e,{A:()=>o})},1882:(t,e,n)=>{"use strict";n.d(e,{LN:()=>q,zr:()=>O});var r=n(7952),i=n(9713),s=n(7408),o=n(7867),a=n(9734),c=n(8664),u=n(4916),l=n(2672),h=n(5232),d=n(7610),p=n(4510),f=n(2920),g=n(5152),m=n(3455),v=n(4784),y=n(165),A=n(807),w=n(2901),N=n(7339),S=n(3683),b=n(461),_=n(8235),E=n(7499),D=n(697),x=n(2582),T=n(9215),k=n(8072),R=n(1429),V=n(3900),M=n(9063),P=n(9433),I=n(5233),L=n(202),j=n(1322),O=[null];function q(t,e){this._groups=t,this._parents=e}q.prototype=function(){return new q([[document.documentElement]],O)}.prototype={constructor:q,select:r.A,selectAll:i.A,selectChild:s.A,selectChildren:o.A,filter:a.A,data:c.A,enter:u.A,exit:l.A,join:h.A,merge:d.A,selection:function(){return this},order:p.A,sort:f.A,call:g.A,nodes:m.A,node:v.A,size:y.A,empty:A.A,each:w.A,attr:N.A,style:S.A,property:b.A,classed:_.A,text:E.A,html:D.A,raise:x.A,lower:T.A,append:k.A,insert:R.A,remove:V.A,clone:M.A,datum:P.A,on:I.A,dispatch:L.A,[Symbol.iterator]:j.A}},1429:(t,e,n)=>{"use strict";n.d(e,{A:()=>o});var r=n(3663),i=n(574);function s(){return null}function o(t,e){var n="function"==typeof t?t:(0,r.A)(t),o=null==e?s:"function"==typeof e?e:(0,i.A)(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),o.apply(this,arguments)||null)}))}},1322:(t,e,n)=>{"use strict";function*r(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r,i=t[e],s=0,o=i.length;s<o;++s)(r=i[s])&&(yield r)}n.d(e,{A:()=>r})},5232:(t,e,n)=>{"use strict";function r(t,e,n){var r=this.enter(),i=this,s=this.exit();return"function"==typeof t?(r=t(r))&&(r=r.selection()):r=r.append(t+""),null!=e&&(i=e(i))&&(i=i.selection()),null==n?s.remove():n(s),r&&i?r.merge(i).order():i}n.d(e,{A:()=>r})},9215:(t,e,n)=>{"use strict";function r(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function i(){return this.each(r)}n.d(e,{A:()=>i})},7610:(t,e,n)=>{"use strict";n.d(e,{A:()=>i});var r=n(1882);function i(t){for(var e=t.selection?t.selection():t,n=this._groups,i=e._groups,s=n.length,o=i.length,a=Math.min(s,o),c=new Array(s),u=0;u<a;++u)for(var l,h=n[u],d=i[u],p=h.length,f=c[u]=new Array(p),g=0;g<p;++g)(l=h[g]||d[g])&&(f[g]=l);for(;u<s;++u)c[u]=n[u];return new r.LN(c,this._parents)}},4784:(t,e,n)=>{"use strict";function r(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,s=r.length;i<s;++i){var o=r[i];if(o)return o}return null}n.d(e,{A:()=>r})},3455:(t,e,n)=>{"use strict";function r(){return Array.from(this)}n.d(e,{A:()=>r})},5233:(t,e,n)=>{"use strict";function r(t){return function(){var e=this.__on;if(e){for(var n,r=0,i=-1,s=e.length;r<s;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++i]=n:this.removeEventListener(n.type,n.listener,n.options);++i?e.length=i:delete this.__on}}}function i(t,e,n){return function(){var r,i=this.__on,s=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(i)for(var o=0,a=i.length;o<a;++o)if((r=i[o]).type===t.type&&r.name===t.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=s,r.options=n),void(r.value=e);this.addEventListener(t.type,s,n),r={type:t.type,name:t.name,value:e,listener:s,options:n},i?i.push(r):this.__on=[r]}}function s(t,e,n){var s,o,a=function(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}(t+""),c=a.length;if(!(arguments.length<2)){for(u=e?i:r,s=0;s<c;++s)this.each(u(a[s],e,n));return this}var u=this.node().__on;if(u)for(var l,h=0,d=u.length;h<d;++h)for(s=0,l=u[h];s<c;++s)if((o=a[s]).type===l.type&&o.name===l.name)return l.value}n.d(e,{A:()=>s})},4510:(t,e,n)=>{"use strict";function r(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,i=t[e],s=i.length-1,o=i[s];--s>=0;)(r=i[s])&&(o&&4^r.compareDocumentPosition(o)&&o.parentNode.insertBefore(r,o),o=r);return this}n.d(e,{A:()=>r})},461:(t,e,n)=>{"use strict";function r(t){return function(){delete this[t]}}function i(t,e){return function(){this[t]=e}}function s(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function o(t,e){return arguments.length>1?this.each((null==e?r:"function"==typeof e?s:i)(t,e)):this.node()[t]}n.d(e,{A:()=>o})},2582:(t,e,n)=>{"use strict";function r(){this.nextSibling&&this.parentNode.appendChild(this)}function i(){return this.each(r)}n.d(e,{A:()=>i})},3900:(t,e,n)=>{"use strict";function r(){var t=this.parentNode;t&&t.removeChild(this)}function i(){return this.each(r)}n.d(e,{A:()=>i})},7952:(t,e,n)=>{"use strict";n.d(e,{A:()=>s});var r=n(1882),i=n(574);function s(t){"function"!=typeof t&&(t=(0,i.A)(t));for(var e=this._groups,n=e.length,s=new Array(n),o=0;o<n;++o)for(var a,c,u=e[o],l=u.length,h=s[o]=new Array(l),d=0;d<l;++d)(a=u[d])&&(c=t.call(a,a.__data__,d,u))&&("__data__"in a&&(c.__data__=a.__data__),h[d]=c);return new r.LN(s,this._parents)}},9713:(t,e,n)=>{"use strict";n.d(e,{A:()=>o});var r=n(1882),i=n(5478),s=n(747);function o(t){t="function"==typeof t?function(t){return function(){return(0,i.A)(t.apply(this,arguments))}}(t):(0,s.A)(t);for(var e=this._groups,n=e.length,o=[],a=[],c=0;c<n;++c)for(var u,l=e[c],h=l.length,d=0;d<h;++d)(u=l[d])&&(o.push(t.call(u,u.__data__,d,l)),a.push(u));return new r.LN(o,a)}},7408:(t,e,n)=>{"use strict";n.d(e,{A:()=>o});var r=n(6541),i=Array.prototype.find;function s(){return this.firstElementChild}function o(t){return this.select(null==t?s:function(t){return function(){return i.call(this.children,t)}}("function"==typeof t?t:(0,r.j)(t)))}},7867:(t,e,n)=>{"use strict";n.d(e,{A:()=>o});var r=n(6541),i=Array.prototype.filter;function s(){return Array.from(this.children)}function o(t){return this.selectAll(null==t?s:function(t){return function(){return i.call(this.children,t)}}("function"==typeof t?t:(0,r.j)(t)))}},165:(t,e,n)=>{"use strict";function r(){let t=0;for(const e of this)++t;return t}n.d(e,{A:()=>r})},2920:(t,e,n)=>{"use strict";n.d(e,{A:()=>i});var r=n(1882);function i(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=s);for(var n=this._groups,i=n.length,o=new Array(i),a=0;a<i;++a){for(var c,u=n[a],l=u.length,h=o[a]=new Array(l),d=0;d<l;++d)(c=u[d])&&(h[d]=c);h.sort(e)}return new r.LN(o,this._parents).order()}function s(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}},6732:(t,e,n)=>{"use strict";function r(t){return new Array(t.length)}n.d(e,{A:()=>r})},3683:(t,e,n)=>{"use strict";n.d(e,{A:()=>a});var r=n(6747);function i(t){return function(){this.style.removeProperty(t)}}function s(t,e,n){return function(){this.style.setProperty(t,e,n)}}function o(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function a(t,e,n){return arguments.length>1?this.each((null==e?i:"function"==typeof e?o:s)(t,e,null==n?"":n)):function(t,e){return t.style.getPropertyValue(e)||(0,r.A)(t).getComputedStyle(t,null).getPropertyValue(e)}(this.node(),t)}},7499:(t,e,n)=>{"use strict";function r(){this.textContent=""}function i(t){return function(){this.textContent=t}}function s(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function o(t){return arguments.length?this.each(null==t?r:("function"==typeof t?s:i)(t)):this.node().textContent}n.d(e,{A:()=>o})},574:(t,e,n)=>{"use strict";function r(){}function i(t){return null==t?r:function(){return this.querySelector(t)}}n.d(e,{A:()=>i})},747:(t,e,n)=>{"use strict";function r(){return[]}function i(t){return null==t?r:function(){return this.querySelectorAll(t)}}n.d(e,{A:()=>i})},6747:(t,e,n)=>{"use strict";function r(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}n.d(e,{A:()=>r})}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var s=e[r]={exports:{}};return t[r](s,s.exports,n),s.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var r={};(()=>{"use strict";n.r(r),n.d(r,{default:()=>s});var t=n(5789),e=window.powerbi,i={name:"vpservice_store",displayName:"VP Service",class:"Visual",apiVersion:"5.9.0",create:e=>{if(t.b)return new t.b(e);throw"Visual instance not found"},createModalDialog:(t,e,n)=>{const r=globalThis.dialogRegistry;t in r&&new r[t](e,n)},custom:!0};void 0!==e&&(e.visuals=e.visuals||{},e.visuals.plugins=e.visuals.plugins||{},e.visuals.plugins.vpservice_store=i);const s=i})(),vpservice_store=r})();